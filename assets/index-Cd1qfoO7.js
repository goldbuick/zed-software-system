var YEe=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var ebt=YEe((Lg,kh)=>{function XEe(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var k0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Pae(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var l5={exports:{}},NR={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B$;function KEe(){if(B$)return NR;B$=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:a,ref:i!==void 0?i:null,props:s}}return NR.Fragment=e,NR.jsx=t,NR.jsxs=t,NR}var F$;function ZEe(){return F$||(F$=1,l5.exports=KEe()),l5.exports}var Le=ZEe();function JEe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Dae={exports:{}},$u=Dae.exports={},dv,pv;function S7(){throw new Error("setTimeout has not been defined")}function E7(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?dv=setTimeout:dv=S7}catch{dv=S7}try{typeof clearTimeout=="function"?pv=clearTimeout:pv=E7}catch{pv=E7}})();function Lae(n){if(dv===setTimeout)return setTimeout(n,0);if((dv===S7||!dv)&&setTimeout)return dv=setTimeout,setTimeout(n,0);try{return dv(n,0)}catch{try{return dv.call(null,n,0)}catch{return dv.call(this,n,0)}}}function QEe(n){if(pv===clearTimeout)return clearTimeout(n);if((pv===E7||!pv)&&clearTimeout)return pv=clearTimeout,clearTimeout(n);try{return pv(n)}catch{try{return pv.call(null,n)}catch{return pv.call(this,n)}}}var $y=[],NT=!1,ZS,JN=-1;function exe(){!NT||!ZS||(NT=!1,ZS.length?$y=ZS.concat($y):JN=-1,$y.length&&Uae())}function Uae(){if(!NT){var n=Lae(exe);NT=!0;for(var e=$y.length;e;){for(ZS=$y,$y=[];++JN<e;)ZS&&ZS[JN].run();JN=-1,e=$y.length}ZS=null,NT=!1,QEe(n)}}$u.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];$y.push(new Bae(n,e)),$y.length===1&&!NT&&Lae(Uae)};function Bae(n,e){this.fun=n,this.array=e}Bae.prototype.run=function(){this.fun.apply(null,this.array)};$u.title="browser";$u.browser=!0;$u.env={};$u.argv=[];$u.version="";$u.versions={};function _b(){}$u.on=_b;$u.addListener=_b;$u.once=_b;$u.off=_b;$u.removeListener=_b;$u.removeAllListeners=_b;$u.emit=_b;$u.prependListener=_b;$u.prependOnceListener=_b;$u.listeners=function(n){return[]};$u.binding=function(n){throw new Error("process.binding is not supported")};$u.cwd=function(){return"/"};$u.chdir=function(n){throw new Error("process.chdir is not supported")};$u.umask=function(){return 0};var txe=Dae.exports;const Tl=JEe(txe);var c5={exports:{}},gs={},z$;function nxe(){if(z$)return gs;z$=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;function h(Z){return Z===null||typeof Z!="object"?null:(Z=f&&Z[f]||Z["@@iterator"],typeof Z=="function"?Z:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,_={};function y(Z,K,ne){this.props=Z,this.context=K,this.refs=_,this.updater=ne||g}y.prototype.isReactComponent={},y.prototype.setState=function(Z,K){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,K,"setState")},y.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function v(){}v.prototype=y.prototype;function x(Z,K,ne){this.props=Z,this.context=K,this.refs=_,this.updater=ne||g}var E=x.prototype=new v;E.constructor=x,p(E,y.prototype),E.isPureReactComponent=!0;var M=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function I(Z,K,ne,le,ce,de){return ne=de.ref,{$$typeof:n,type:Z,key:K,ref:ne!==void 0?ne:null,props:de}}function D(Z,K){return I(Z.type,K,void 0,void 0,void 0,Z.props)}function V(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===n}function G(Z){var K={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(ne){return K[ne]})}var J=/\/+/g;function B(Z,K){return typeof Z=="object"&&Z!==null&&Z.key!=null?G(""+Z.key):K.toString(36)}function $(){}function U(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then($,$):(Z.status="pending",Z.then(function(K){Z.status==="pending"&&(Z.status="fulfilled",Z.value=K)},function(K){Z.status==="pending"&&(Z.status="rejected",Z.reason=K)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function Q(Z,K,ne,le,ce){var de=typeof Z;(de==="undefined"||de==="boolean")&&(Z=null);var Me=!1;if(Z===null)Me=!0;else switch(de){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(Z.$$typeof){case n:case e:Me=!0;break;case u:return Me=Z._init,Q(Me(Z._payload),K,ne,le,ce)}}if(Me)return ce=ce(Z),Me=le===""?"."+B(Z,0):le,M(ce)?(ne="",Me!=null&&(ne=Me.replace(J,"$&/")+"/"),Q(ce,K,ne,"",function(Ae){return Ae})):ce!=null&&(V(ce)&&(ce=D(ce,ne+(ce.key==null||Z&&Z.key===ce.key?"":(""+ce.key).replace(J,"$&/")+"/")+Me)),K.push(ce)),1;Me=0;var qe=le===""?".":le+":";if(M(Z))for(var Ne=0;Ne<Z.length;Ne++)le=Z[Ne],de=qe+B(le,Ne),Me+=Q(le,K,ne,de,ce);else if(Ne=h(Z),typeof Ne=="function")for(Z=Ne.call(Z),Ne=0;!(le=Z.next()).done;)le=le.value,de=qe+B(le,Ne++),Me+=Q(le,K,ne,de,ce);else if(de==="object"){if(typeof Z.then=="function")return Q(U(Z),K,ne,le,ce);throw K=String(Z),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return Me}function W(Z,K,ne){if(Z==null)return Z;var le=[],ce=0;return Q(Z,le,"","",function(de){return K.call(ne,de,ce++)}),le}function q(Z){if(Z._status===-1){var K=Z._result;K=K(),K.then(function(ne){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=ne)},function(ne){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=ne)}),Z._status===-1&&(Z._status=0,Z._result=K)}if(Z._status===1)return Z._result.default;throw Z._result}var Y=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(K))return}else if(typeof Tl=="object"&&typeof Tl.emit=="function"){Tl.emit("uncaughtException",Z);return}console.error(Z)};function ae(){}return gs.Children={map:W,forEach:function(Z,K,ne){W(Z,function(){K.apply(this,arguments)},ne)},count:function(Z){var K=0;return W(Z,function(){K++}),K},toArray:function(Z){return W(Z,function(K){return K})||[]},only:function(Z){if(!V(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},gs.Component=y,gs.Fragment=t,gs.Profiler=i,gs.PureComponent=x,gs.StrictMode=r,gs.Suspense=l,gs.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,gs.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return k.H.useMemoCache(Z)}},gs.cache=function(Z){return function(){return Z.apply(null,arguments)}},gs.cloneElement=function(Z,K,ne){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var le=p({},Z.props),ce=Z.key,de=void 0;if(K!=null)for(Me in K.ref!==void 0&&(de=void 0),K.key!==void 0&&(ce=""+K.key),K)!N.call(K,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&K.ref===void 0||(le[Me]=K[Me]);var Me=arguments.length-2;if(Me===1)le.children=ne;else if(1<Me){for(var qe=Array(Me),Ne=0;Ne<Me;Ne++)qe[Ne]=arguments[Ne+2];le.children=qe}return I(Z.type,ce,void 0,void 0,de,le)},gs.createContext=function(Z){return Z={$$typeof:a,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:s,_context:Z},Z},gs.createElement=function(Z,K,ne){var le,ce={},de=null;if(K!=null)for(le in K.key!==void 0&&(de=""+K.key),K)N.call(K,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(ce[le]=K[le]);var Me=arguments.length-2;if(Me===1)ce.children=ne;else if(1<Me){for(var qe=Array(Me),Ne=0;Ne<Me;Ne++)qe[Ne]=arguments[Ne+2];ce.children=qe}if(Z&&Z.defaultProps)for(le in Me=Z.defaultProps,Me)ce[le]===void 0&&(ce[le]=Me[le]);return I(Z,de,void 0,void 0,null,ce)},gs.createRef=function(){return{current:null}},gs.forwardRef=function(Z){return{$$typeof:o,render:Z}},gs.isValidElement=V,gs.lazy=function(Z){return{$$typeof:u,_payload:{_status:-1,_result:Z},_init:q}},gs.memo=function(Z,K){return{$$typeof:c,type:Z,compare:K===void 0?null:K}},gs.startTransition=function(Z){var K=k.T,ne={};k.T=ne;try{var le=Z(),ce=k.S;ce!==null&&ce(ne,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(ae,Y)}catch(de){Y(de)}finally{k.T=K}},gs.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},gs.use=function(Z){return k.H.use(Z)},gs.useActionState=function(Z,K,ne){return k.H.useActionState(Z,K,ne)},gs.useCallback=function(Z,K){return k.H.useCallback(Z,K)},gs.useContext=function(Z){return k.H.useContext(Z)},gs.useDebugValue=function(){},gs.useDeferredValue=function(Z,K){return k.H.useDeferredValue(Z,K)},gs.useEffect=function(Z,K,ne){var le=k.H;if(typeof ne=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return le.useEffect(Z,K)},gs.useId=function(){return k.H.useId()},gs.useImperativeHandle=function(Z,K,ne){return k.H.useImperativeHandle(Z,K,ne)},gs.useInsertionEffect=function(Z,K){return k.H.useInsertionEffect(Z,K)},gs.useLayoutEffect=function(Z,K){return k.H.useLayoutEffect(Z,K)},gs.useMemo=function(Z,K){return k.H.useMemo(Z,K)},gs.useOptimistic=function(Z,K){return k.H.useOptimistic(Z,K)},gs.useReducer=function(Z,K,ne){return k.H.useReducer(Z,K,ne)},gs.useRef=function(Z){return k.H.useRef(Z)},gs.useState=function(Z){return k.H.useState(Z)},gs.useSyncExternalStore=function(Z,K,ne){return k.H.useSyncExternalStore(Z,K,ne)},gs.useTransition=function(){return k.H.useTransition()},gs.version="19.1.1",gs}var j$;function jw(){return j$||(j$=1,c5.exports=nxe()),c5.exports}var it=jw();const Ng=Bh(it);var u5={exports:{}},fy={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H$;function rxe(){return H$||(H$=1,fy.ConcurrentRoot=1,fy.ContinuousEventPriority=8,fy.DefaultEventPriority=32,fy.DiscreteEventPriority=2,fy.IdleEventPriority=268435456,fy.LegacyRoot=0,fy.NoEventPriority=0),fy}var q$;function ixe(){return q$||(q$=1,u5.exports=rxe()),u5.exports}var QN=ixe();/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Hw="176",sxe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},axe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Fae=0,x7=1,zae=2,oxe=3,jae=0,x4=1,C2=2,v_=3,Fv=0,Yf=1,$f=2,Ih=0,lE=1,T7=2,w7=3,R7=4,Hae=5,c1=100,qae=101,Vae=102,Gae=103,$ae=104,Wae=200,Yae=201,Xae=202,Kae=203,ZP=204,JP=205,Zae=206,Jae=207,Qae=208,eoe=209,toe=210,noe=211,roe=212,ioe=213,soe=214,QP=0,eD=1,tD=2,bE=3,nD=4,rD=5,iD=6,sD=7,dk=0,aoe=1,ooe=2,Iv=0,loe=1,coe=2,uoe=3,Jz=4,foe=5,hoe=6,doe=7,A7="attached",poe="detached",T4=300,lb=301,C1=302,Z2=303,J2=304,qw=306,YT=1e3,I0=1001,Q2=1002,bf=1003,Qz=1004,lxe=1004,ET=1005,cxe=1005,sc=1006,M2=1007,uxe=1007,Rv=1008,fxe=1008,ql=1009,ej=1010,tj=1011,XT=1012,w4=1013,zv=1014,Pp=1015,vb=1016,R4=1017,A4=1018,SE=1020,nj=35902,rj=1021,ij=1022,Xf=1023,KT=1026,EE=1027,Vw=1028,pk=1029,C4=1030,M4=1031,hxe=1032,mk=1033,O2=33776,k2=33777,I2=33778,N2=33779,aD=35840,oD=35841,lD=35842,cD=35843,uD=36196,fD=37492,hD=37496,dD=37808,pD=37809,mD=37810,gD=37811,_D=37812,vD=37813,yD=37814,bD=37815,SD=37816,ED=37817,xD=37818,TD=37819,wD=37820,RD=37821,P2=36492,AD=36494,CD=36495,sj=36283,MD=36284,OD=36285,kD=36286,moe=2200,goe=2201,_oe=2202,eO=2300,ID=2301,eP=2302,JS=2400,QS=2401,tO=2402,O4=2500,aj=2501,dxe=0,pxe=1,mxe=2,q1=3200,voe=3201,gxe=3202,_xe=3203,V1=0,yoe=1,x_="",na="srgb",jv="srgb-linear",nO="linear",Po="srgb",vxe=0,BS=7680,yxe=7681,bxe=7682,Sxe=7683,Exe=34055,xxe=34056,Txe=5386,wxe=512,Rxe=513,Axe=514,Cxe=515,Mxe=516,Oxe=517,kxe=518,C7=519,boe=512,Soe=513,Eoe=514,oj=515,xoe=516,Toe=517,woe=518,Roe=519,rO=35044,M7=35048,Ixe=35040,Nxe=35045,Pxe=35049,Dxe=35041,Lxe=35046,Uxe=35050,Bxe=35042,Fxe="100",O7="300 es",N0=2e3,iO=2001,zxe={COMPUTE:"compute",RENDER:"render"},jxe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Hxe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class $g{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const r=t[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const Hd=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let V$=1234567;const cE=Math.PI/180,ZT=180/Math.PI;function Ug(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Hd[n&255]+Hd[n>>8&255]+Hd[n>>16&255]+Hd[n>>24&255]+"-"+Hd[e&255]+Hd[e>>8&255]+"-"+Hd[e>>16&15|64]+Hd[e>>24&255]+"-"+Hd[t&63|128]+Hd[t>>8&255]+"-"+Hd[t>>16&255]+Hd[t>>24&255]+Hd[r&255]+Hd[r>>8&255]+Hd[r>>16&255]+Hd[r>>24&255]).toLowerCase()}function Wi(n,e,t){return Math.max(e,Math.min(t,n))}function lj(n,e){return(n%e+e)%e}function qxe(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function Vxe(n,e,t){return n!==e?(t-n)/(e-n):0}function D2(n,e,t){return(1-t)*n+t*e}function Gxe(n,e,t,r){return D2(n,e,1-Math.exp(-t*r))}function $xe(n,e=1){return e-Math.abs(lj(n,e*2)-e)}function Wxe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Yxe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Xxe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Kxe(n,e){return n+Math.random()*(e-n)}function Zxe(n){return n*(.5-Math.random())}function Jxe(n){n!==void 0&&(V$=n);let e=V$+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Qxe(n){return n*cE}function eTe(n){return n*ZT}function tTe(n){return(n&n-1)===0&&n!==0}function nTe(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function rTe(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function iTe(n,e,t,r,i){const s=Math.cos,a=Math.sin,o=s(t/2),l=a(t/2),c=s((e+r)/2),u=a((e+r)/2),f=s((e-r)/2),h=a((e-r)/2),g=s((r-e)/2),p=a((r-e)/2);switch(i){case"XYX":n.set(o*u,l*f,l*h,o*c);break;case"YZY":n.set(l*h,o*u,l*f,o*c);break;case"ZXZ":n.set(l*f,l*h,o*u,o*c);break;case"XZX":n.set(o*u,l*p,l*g,o*c);break;case"YXY":n.set(l*g,o*u,l*p,o*c);break;case"ZYZ":n.set(l*p,l*g,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function kp(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ss(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Aoe={DEG2RAD:cE,RAD2DEG:ZT,generateUUID:Ug,clamp:Wi,euclideanModulo:lj,mapLinear:qxe,inverseLerp:Vxe,lerp:D2,damp:Gxe,pingpong:$xe,smoothstep:Wxe,smootherstep:Yxe,randInt:Xxe,randFloat:Kxe,randFloatSpread:Zxe,seededRandom:Jxe,degToRad:Qxe,radToDeg:eTe,isPowerOfTwo:tTe,ceilPowerOfTwo:nTe,floorPowerOfTwo:rTe,setQuaternionFromProperEuler:iTe,normalize:ss,denormalize:kp};class an{constructor(e=0,t=0){an.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Wi(this.x,e.x,t.x),this.y=Wi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Wi(this.x,e,t),this.y=Wi(this.y,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Wi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class es{constructor(e,t,r,i,s,a,o,l,c){es.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c)}set(e,t,r,i,s,a,o,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],l=r[6],c=r[1],u=r[4],f=r[7],h=r[2],g=r[5],p=r[8],_=i[0],y=i[3],v=i[6],x=i[1],E=i[4],M=i[7],k=i[2],N=i[5],I=i[8];return s[0]=a*_+o*x+l*k,s[3]=a*y+o*E+l*N,s[6]=a*v+o*M+l*I,s[1]=c*_+u*x+f*k,s[4]=c*y+u*E+f*N,s[7]=c*v+u*M+f*I,s[2]=h*_+g*x+p*k,s[5]=h*y+g*E+p*N,s[8]=h*v+g*M+p*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-r*s*u+r*o*l+i*s*c-i*a*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=u*a-o*c,h=o*l-u*s,g=c*s-a*l,p=t*f+r*h+i*g;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=f*_,e[1]=(i*c-u*r)*_,e[2]=(o*r-i*a)*_,e[3]=h*_,e[4]=(u*t-i*l)*_,e[5]=(i*s-o*t)*_,e[6]=g*_,e[7]=(r*l-c*t)*_,e[8]=(a*t-r*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*a+c*o)+a+e,-i*c,i*l,-i*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(f5.makeScale(e,t)),this}rotate(e){return this.premultiply(f5.makeRotation(-e)),this}translate(e,t){return this.premultiply(f5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const f5=new es;function Coe(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const sTe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function xT(n,e){return new sTe[n](e)}function sO(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Moe(){const n=sO("canvas");return n.style.display="block",n}const G$={};function tP(n){n in G$||(G$[n]=!0,console.warn(n))}function aTe(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}function oTe(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function lTe(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const $$=new es().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),W$=new es().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function cTe(){const n={enabled:!0,workingColorSpace:jv,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Po&&(i.r=Qy(i.r),i.g=Qy(i.g),i.b=Qy(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Po&&(i.r=PT(i.r),i.g=PT(i.g),i.b=PT(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===x_?nO:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[jv]:{primaries:e,whitePoint:r,transfer:nO,toXYZ:$$,fromXYZ:W$,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:na},outputColorSpaceConfig:{drawingBufferColorSpace:na}},[na]:{primaries:e,whitePoint:r,transfer:Po,toXYZ:$$,fromXYZ:W$,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:na}}}),n}const Ea=cTe();function Qy(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function PT(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Ox;class Ooe{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{Ox===void 0&&(Ox=sO("canvas")),Ox.width=e.width,Ox.height=e.height;const i=Ox.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=Ox}return r.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=sO("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Qy(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Qy(t[r]/255)*255):t[r]=Qy(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let uTe=0,p1=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:uTe++}),this.uuid=Ug(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(h5(i[a].image)):s.push(h5(i[a]))}else s=h5(i);r.url=s}return t||(e.images[this.uuid]=r),r}};function h5(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Ooe.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let fTe=0;class wc extends $g{constructor(e=wc.DEFAULT_IMAGE,t=wc.DEFAULT_MAPPING,r=I0,i=I0,s=sc,a=Rv,o=Xf,l=ql,c=wc.DEFAULT_ANISOTROPY,u=x_){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fTe++}),this.uuid=Ug(),this.name="",this.source=new p1(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new an(0,0),this.repeat=new an(1,1),this.center=new an(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new es,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==T4)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case YT:e.x=e.x-Math.floor(e.x);break;case I0:e.x=e.x<0?0:1;break;case Q2:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case YT:e.y=e.y-Math.floor(e.y);break;case I0:e.y=e.y<0?0:1;break;case Q2:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}wc.DEFAULT_IMAGE=null;wc.DEFAULT_MAPPING=T4;wc.DEFAULT_ANISOTROPY=1;class Ta{constructor(e=0,t=0,r=0,i=1){Ta.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],f=l[8],h=l[1],g=l[5],p=l[9],_=l[2],y=l[6],v=l[10];if(Math.abs(u-h)<.01&&Math.abs(f-_)<.01&&Math.abs(p-y)<.01){if(Math.abs(u+h)<.1&&Math.abs(f+_)<.1&&Math.abs(p+y)<.1&&Math.abs(c+g+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(c+1)/2,M=(g+1)/2,k=(v+1)/2,N=(u+h)/4,I=(f+_)/4,D=(p+y)/4;return E>M&&E>k?E<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(E),i=N/r,s=I/r):M>k?M<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(M),r=N/i,s=D/i):k<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(k),r=I/s,i=D/s),this.set(r,i,s,t),this}let x=Math.sqrt((y-p)*(y-p)+(f-_)*(f-_)+(h-u)*(h-u));return Math.abs(x)<.001&&(x=1),this.x=(y-p)/x,this.y=(f-_)/x,this.z=(h-u)/x,this.w=Math.acos((c+g+v-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Wi(this.x,e.x,t.x),this.y=Wi(this.y,e.y,t.y),this.z=Wi(this.z,e.z,t.z),this.w=Wi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Wi(this.x,e,t),this.y=Wi(this.y,e,t),this.z=Wi(this.z,e,t),this.w=Wi(this.w,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class k4 extends $g{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth?r.depth:1,this.scissor=new Ta(0,0,e,t),this.scissorTest=!1,this.viewport=new Ta(0,0,e,t);const i={width:e,height:t,depth:this.depth};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:sc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},r);const s=new wc(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new p1(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sf extends k4{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class gk extends wc{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=bf,this.minFilter=bf,this.wrapR=I0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class hTe extends Sf{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new gk(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class I4 extends wc{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=bf,this.minFilter=bf,this.wrapR=I0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class dTe extends Sf{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new I4(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class zp{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let l=r[i+0],c=r[i+1],u=r[i+2],f=r[i+3];const h=s[a+0],g=s[a+1],p=s[a+2],_=s[a+3];if(o===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f;return}if(o===1){e[t+0]=h,e[t+1]=g,e[t+2]=p,e[t+3]=_;return}if(f!==_||l!==h||c!==g||u!==p){let y=1-o;const v=l*h+c*g+u*p+f*_,x=v>=0?1:-1,E=1-v*v;if(E>Number.EPSILON){const k=Math.sqrt(E),N=Math.atan2(k,v*x);y=Math.sin(y*N)/k,o=Math.sin(o*N)/k}const M=o*x;if(l=l*y+h*M,c=c*y+g*M,u=u*y+p*M,f=f*y+_*M,y===1-o){const k=1/Math.sqrt(l*l+c*c+u*u+f*f);l*=k,c*=k,u*=k,f*=k}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],l=r[i+1],c=r[i+2],u=r[i+3],f=s[a],h=s[a+1],g=s[a+2],p=s[a+3];return e[t]=o*p+u*f+l*g-c*h,e[t+1]=l*p+u*h+c*f-o*g,e[t+2]=c*p+u*g+o*h-l*f,e[t+3]=u*p-o*f-l*h-c*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(r/2),u=o(i/2),f=o(s/2),h=l(r/2),g=l(i/2),p=l(s/2);switch(a){case"XYZ":this._x=h*u*f+c*g*p,this._y=c*g*f-h*u*p,this._z=c*u*p+h*g*f,this._w=c*u*f-h*g*p;break;case"YXZ":this._x=h*u*f+c*g*p,this._y=c*g*f-h*u*p,this._z=c*u*p-h*g*f,this._w=c*u*f+h*g*p;break;case"ZXY":this._x=h*u*f-c*g*p,this._y=c*g*f+h*u*p,this._z=c*u*p+h*g*f,this._w=c*u*f-h*g*p;break;case"ZYX":this._x=h*u*f-c*g*p,this._y=c*g*f+h*u*p,this._z=c*u*p-h*g*f,this._w=c*u*f+h*g*p;break;case"YZX":this._x=h*u*f+c*g*p,this._y=c*g*f+h*u*p,this._z=c*u*p-h*g*f,this._w=c*u*f-h*g*p;break;case"XZY":this._x=h*u*f-c*g*p,this._y=c*g*f-h*u*p,this._z=c*u*p+h*g*f,this._w=c*u*f+h*g*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],u=t[6],f=t[10],h=r+o+f;if(h>0){const g=.5/Math.sqrt(h+1);this._w=.25/g,this._x=(u-l)*g,this._y=(s-c)*g,this._z=(a-i)*g}else if(r>o&&r>f){const g=2*Math.sqrt(1+r-o-f);this._w=(u-l)/g,this._x=.25*g,this._y=(i+a)/g,this._z=(s+c)/g}else if(o>f){const g=2*Math.sqrt(1+o-r-f);this._w=(s-c)/g,this._x=(i+a)/g,this._y=.25*g,this._z=(l+u)/g}else{const g=2*Math.sqrt(1+f-r-o);this._w=(a-i)/g,this._x=(s+c)/g,this._y=(l+u)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+a*o+i*c-s*l,this._y=i*u+a*l+s*o-r*c,this._z=s*u+a*c+r*l-i*o,this._w=a*u-r*o-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let o=a*e._w+r*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const g=1-t;return this._w=g*a+t*this._w,this._x=g*r+t*this._x,this._y=g*i+t*this._y,this._z=g*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,o),f=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=a*f+this._w*h,this._x=r*f+this._x*h,this._y=i*f+this._y*h,this._z=s*f+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ut{constructor(e=0,t=0,r=0){ut.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Y$.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Y$.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*i-o*r),u=2*(o*t-s*i),f=2*(s*r-a*t);return this.x=t+l*c+a*f-o*u,this.y=r+l*u+o*c-s*f,this.z=i+l*f+s*u-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Wi(this.x,e.x,t.x),this.y=Wi(this.y,e.y,t.y),this.z=Wi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Wi(this.x,e,t),this.y=Wi(this.y,e,t),this.z=Wi(this.z,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Wi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return d5.copy(this).projectOnVector(e),this.sub(d5)}reflect(e){return this.sub(d5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Wi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const d5=new ut,Y$=new zp;class Zd{constructor(e=new ut(1/0,1/0,1/0),t=new ut(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(c_.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(c_.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=c_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,c_):c_.fromBufferAttribute(s,a),c_.applyMatrix4(e.matrixWorld),this.expandByPoint(c_);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),J3.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),J3.copy(r.boundingBox)),J3.applyMatrix4(e.matrixWorld),this.union(J3)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,c_),c_.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(PR),Q3.subVectors(this.max,PR),kx.subVectors(e.a,PR),Ix.subVectors(e.b,PR),Nx.subVectors(e.c,PR),Bb.subVectors(Ix,kx),Fb.subVectors(Nx,Ix),cS.subVectors(kx,Nx);let t=[0,-Bb.z,Bb.y,0,-Fb.z,Fb.y,0,-cS.z,cS.y,Bb.z,0,-Bb.x,Fb.z,0,-Fb.x,cS.z,0,-cS.x,-Bb.y,Bb.x,0,-Fb.y,Fb.x,0,-cS.y,cS.x,0];return!p5(t,kx,Ix,Nx,Q3)||(t=[1,0,0,0,1,0,0,0,1],!p5(t,kx,Ix,Nx,Q3))?!1:(eI.crossVectors(Bb,Fb),t=[eI.x,eI.y,eI.z],p5(t,kx,Ix,Nx,Q3))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,c_).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(c_).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hy[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hy[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hy[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hy[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hy[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hy[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hy[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hy[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hy),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hy=[new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut],c_=new ut,J3=new Zd,kx=new ut,Ix=new ut,Nx=new ut,Bb=new ut,Fb=new ut,cS=new ut,PR=new ut,Q3=new ut,eI=new ut,uS=new ut;function p5(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){uS.fromArray(n,s);const o=i.x*Math.abs(uS.x)+i.y*Math.abs(uS.y)+i.z*Math.abs(uS.z),l=e.dot(uS),c=t.dot(uS),u=r.dot(uS);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const pTe=new Zd,DR=new ut,m5=new ut;class xd{constructor(e=new ut,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):pTe.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;DR.subVectors(e,this.center);const t=DR.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(DR,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(m5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(DR.copy(e.center).add(m5)),this.expandByPoint(DR.copy(e.center).sub(m5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const dy=new ut,g5=new ut,tI=new ut,zb=new ut,_5=new ut,nI=new ut,v5=new ut;class Gw{constructor(e=new ut,t=new ut(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,dy)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=dy.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(dy.copy(this.origin).addScaledVector(this.direction,t),dy.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){g5.copy(e).add(t).multiplyScalar(.5),tI.copy(t).sub(e).normalize(),zb.copy(this.origin).sub(g5);const s=e.distanceTo(t)*.5,a=-this.direction.dot(tI),o=zb.dot(this.direction),l=-zb.dot(tI),c=zb.lengthSq(),u=Math.abs(1-a*a);let f,h,g,p;if(u>0)if(f=a*l-o,h=a*o-l,p=s*u,f>=0)if(h>=-p)if(h<=p){const _=1/u;f*=_,h*=_,g=f*(f+a*h+2*o)+h*(a*f+h+2*l)+c}else h=s,f=Math.max(0,-(a*h+o)),g=-f*f+h*(h+2*l)+c;else h=-s,f=Math.max(0,-(a*h+o)),g=-f*f+h*(h+2*l)+c;else h<=-p?(f=Math.max(0,-(-a*s+o)),h=f>0?-s:Math.min(Math.max(-s,-l),s),g=-f*f+h*(h+2*l)+c):h<=p?(f=0,h=Math.min(Math.max(-s,-l),s),g=h*(h+2*l)+c):(f=Math.max(0,-(a*s+o)),h=f>0?s:Math.min(Math.max(-s,-l),s),g=-f*f+h*(h+2*l)+c);else h=a>0?-s:s,f=Math.max(0,-(a*h+o)),g=-f*f+h*(h+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(g5).addScaledVector(tI,h),g}intersectSphere(e,t){dy.subVectors(e.center,this.origin);const r=dy.dot(this.direction),i=dy.dot(dy)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,i=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,i=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),f>=0?(o=(e.min.z-h.z)*f,l=(e.max.z-h.z)*f):(o=(e.max.z-h.z)*f,l=(e.min.z-h.z)*f),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,dy)!==null}intersectTriangle(e,t,r,i,s){_5.subVectors(t,e),nI.subVectors(r,e),v5.crossVectors(_5,nI);let a=this.direction.dot(v5),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;zb.subVectors(this.origin,e);const l=o*this.direction.dot(nI.crossVectors(zb,nI));if(l<0)return null;const c=o*this.direction.dot(_5.cross(zb));if(c<0||l+c>a)return null;const u=-o*zb.dot(v5);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Qr{constructor(e,t,r,i,s,a,o,l,c,u,f,h,g,p,_,y){Qr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c,u,f,h,g,p,_,y)}set(e,t,r,i,s,a,o,l,c,u,f,h,g,p,_,y){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=c,v[6]=u,v[10]=f,v[14]=h,v[3]=g,v[7]=p,v[11]=_,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/Px.setFromMatrixColumn(e,0).length(),s=1/Px.setFromMatrixColumn(e,1).length(),a=1/Px.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const h=a*u,g=a*f,p=o*u,_=o*f;t[0]=l*u,t[4]=-l*f,t[8]=c,t[1]=g+p*c,t[5]=h-_*c,t[9]=-o*l,t[2]=_-h*c,t[6]=p+g*c,t[10]=a*l}else if(e.order==="YXZ"){const h=l*u,g=l*f,p=c*u,_=c*f;t[0]=h+_*o,t[4]=p*o-g,t[8]=a*c,t[1]=a*f,t[5]=a*u,t[9]=-o,t[2]=g*o-p,t[6]=_+h*o,t[10]=a*l}else if(e.order==="ZXY"){const h=l*u,g=l*f,p=c*u,_=c*f;t[0]=h-_*o,t[4]=-a*f,t[8]=p+g*o,t[1]=g+p*o,t[5]=a*u,t[9]=_-h*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const h=a*u,g=a*f,p=o*u,_=o*f;t[0]=l*u,t[4]=p*c-g,t[8]=h*c+_,t[1]=l*f,t[5]=_*c+h,t[9]=g*c-p,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const h=a*l,g=a*c,p=o*l,_=o*c;t[0]=l*u,t[4]=_-h*f,t[8]=p*f+g,t[1]=f,t[5]=a*u,t[9]=-o*u,t[2]=-c*u,t[6]=g*f+p,t[10]=h-_*f}else if(e.order==="XZY"){const h=a*l,g=a*c,p=o*l,_=o*c;t[0]=l*u,t[4]=-f,t[8]=c*u,t[1]=h*f+_,t[5]=a*u,t[9]=g*f-p,t[2]=p*f-g,t[6]=o*u,t[10]=_*f+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(mTe,e,gTe)}lookAt(e,t,r){const i=this.elements;return bg.subVectors(e,t),bg.lengthSq()===0&&(bg.z=1),bg.normalize(),jb.crossVectors(r,bg),jb.lengthSq()===0&&(Math.abs(r.z)===1?bg.x+=1e-4:bg.z+=1e-4,bg.normalize(),jb.crossVectors(r,bg)),jb.normalize(),rI.crossVectors(bg,jb),i[0]=jb.x,i[4]=rI.x,i[8]=bg.x,i[1]=jb.y,i[5]=rI.y,i[9]=bg.y,i[2]=jb.z,i[6]=rI.z,i[10]=bg.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],l=r[8],c=r[12],u=r[1],f=r[5],h=r[9],g=r[13],p=r[2],_=r[6],y=r[10],v=r[14],x=r[3],E=r[7],M=r[11],k=r[15],N=i[0],I=i[4],D=i[8],V=i[12],G=i[1],J=i[5],B=i[9],$=i[13],U=i[2],Q=i[6],W=i[10],q=i[14],Y=i[3],ae=i[7],Z=i[11],K=i[15];return s[0]=a*N+o*G+l*U+c*Y,s[4]=a*I+o*J+l*Q+c*ae,s[8]=a*D+o*B+l*W+c*Z,s[12]=a*V+o*$+l*q+c*K,s[1]=u*N+f*G+h*U+g*Y,s[5]=u*I+f*J+h*Q+g*ae,s[9]=u*D+f*B+h*W+g*Z,s[13]=u*V+f*$+h*q+g*K,s[2]=p*N+_*G+y*U+v*Y,s[6]=p*I+_*J+y*Q+v*ae,s[10]=p*D+_*B+y*W+v*Z,s[14]=p*V+_*$+y*q+v*K,s[3]=x*N+E*G+M*U+k*Y,s[7]=x*I+E*J+M*Q+k*ae,s[11]=x*D+E*B+M*W+k*Z,s[15]=x*V+E*$+M*q+k*K,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],u=e[2],f=e[6],h=e[10],g=e[14],p=e[3],_=e[7],y=e[11],v=e[15];return p*(+s*l*f-i*c*f-s*o*h+r*c*h+i*o*g-r*l*g)+_*(+t*l*g-t*c*h+s*a*h-i*a*g+i*c*u-s*l*u)+y*(+t*c*f-t*o*g-s*a*f+r*a*g+s*o*u-r*c*u)+v*(-i*o*u-t*l*f+t*o*h+i*a*f-r*a*h+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],g=e[11],p=e[12],_=e[13],y=e[14],v=e[15],x=f*y*c-_*h*c+_*l*g-o*y*g-f*l*v+o*h*v,E=p*h*c-u*y*c-p*l*g+a*y*g+u*l*v-a*h*v,M=u*_*c-p*f*c+p*o*g-a*_*g-u*o*v+a*f*v,k=p*f*l-u*_*l-p*o*h+a*_*h+u*o*y-a*f*y,N=t*x+r*E+i*M+s*k;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/N;return e[0]=x*I,e[1]=(_*h*s-f*y*s-_*i*g+r*y*g+f*i*v-r*h*v)*I,e[2]=(o*y*s-_*l*s+_*i*c-r*y*c-o*i*v+r*l*v)*I,e[3]=(f*l*s-o*h*s-f*i*c+r*h*c+o*i*g-r*l*g)*I,e[4]=E*I,e[5]=(u*y*s-p*h*s+p*i*g-t*y*g-u*i*v+t*h*v)*I,e[6]=(p*l*s-a*y*s-p*i*c+t*y*c+a*i*v-t*l*v)*I,e[7]=(a*h*s-u*l*s+u*i*c-t*h*c-a*i*g+t*l*g)*I,e[8]=M*I,e[9]=(p*f*s-u*_*s-p*r*g+t*_*g+u*r*v-t*f*v)*I,e[10]=(a*_*s-p*o*s+p*r*c-t*_*c-a*r*v+t*o*v)*I,e[11]=(u*o*s-a*f*s-u*r*c+t*f*c+a*r*g-t*o*g)*I,e[12]=k*I,e[13]=(u*_*i-p*f*i+p*r*h-t*_*h-u*r*y+t*f*y)*I,e[14]=(p*o*i-a*_*i-p*r*l+t*_*l+a*r*y-t*o*y)*I,e[15]=(a*f*i-u*o*i+u*r*l-t*f*l-a*r*h+t*o*h)*I,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,l=e.z,c=s*a,u=s*o;return this.set(c*a+r,c*o-i*l,c*l+i*o,0,c*o+i*l,u*o+r,u*l-i*a,0,c*l-i*o,u*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,u=a+a,f=o+o,h=s*c,g=s*u,p=s*f,_=a*u,y=a*f,v=o*f,x=l*c,E=l*u,M=l*f,k=r.x,N=r.y,I=r.z;return i[0]=(1-(_+v))*k,i[1]=(g+M)*k,i[2]=(p-E)*k,i[3]=0,i[4]=(g-M)*N,i[5]=(1-(h+v))*N,i[6]=(y+x)*N,i[7]=0,i[8]=(p+E)*I,i[9]=(y-x)*I,i[10]=(1-(h+_))*I,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=Px.set(i[0],i[1],i[2]).length();const a=Px.set(i[4],i[5],i[6]).length(),o=Px.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],u_.copy(this);const c=1/s,u=1/a,f=1/o;return u_.elements[0]*=c,u_.elements[1]*=c,u_.elements[2]*=c,u_.elements[4]*=u,u_.elements[5]*=u,u_.elements[6]*=u,u_.elements[8]*=f,u_.elements[9]*=f,u_.elements[10]*=f,t.setFromRotationMatrix(u_),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=N0){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),f=(t+e)/(t-e),h=(r+i)/(r-i);let g,p;if(o===N0)g=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===iO)g=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=N0){const l=this.elements,c=1/(t-e),u=1/(r-i),f=1/(a-s),h=(t+e)*c,g=(r+i)*u;let p,_;if(o===N0)p=(a+s)*f,_=-2*f;else if(o===iO)p=s*f,_=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=_,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Px=new ut,u_=new Qr,mTe=new ut(0,0,0),gTe=new ut(1,1,1),jb=new ut,rI=new ut,bg=new ut,X$=new Qr,K$=new zp;class Bm{constructor(e=0,t=0,r=0,i=Bm.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],c=i[5],u=i[9],f=i[2],h=i[6],g=i[10];switch(t){case"XYZ":this._y=Math.asin(Wi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Wi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,g),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(Wi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Wi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(h,g),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Wi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,g));break;case"XZY":this._z=Math.asin(-Wi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return X$.makeRotationFromQuaternion(e),this.setFromRotationMatrix(X$,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return K$.setFromEuler(this),this.setFromQuaternion(K$,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Bm.DEFAULT_ORDER="XYZ";class JT{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let _Te=0;const Z$=new ut,Dx=new zp,py=new Qr,iI=new ut,LR=new ut,vTe=new ut,yTe=new zp,J$=new ut(1,0,0),Q$=new ut(0,1,0),eW=new ut(0,0,1),tW={type:"added"},bTe={type:"removed"},Lx={type:"childadded",child:null},y5={type:"childremoved",child:null};class ja extends $g{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_Te++}),this.uuid=Ug(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ja.DEFAULT_UP.clone();const e=new ut,t=new Bm,r=new zp,i=new ut(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Qr},normalMatrix:{value:new es}}),this.matrix=new Qr,this.matrixWorld=new Qr,this.matrixAutoUpdate=ja.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ja.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new JT,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Dx.setFromAxisAngle(e,t),this.quaternion.multiply(Dx),this}rotateOnWorldAxis(e,t){return Dx.setFromAxisAngle(e,t),this.quaternion.premultiply(Dx),this}rotateX(e){return this.rotateOnAxis(J$,e)}rotateY(e){return this.rotateOnAxis(Q$,e)}rotateZ(e){return this.rotateOnAxis(eW,e)}translateOnAxis(e,t){return Z$.copy(e).applyQuaternion(this.quaternion),this.position.add(Z$.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(J$,e)}translateY(e){return this.translateOnAxis(Q$,e)}translateZ(e){return this.translateOnAxis(eW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(py.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?iI.copy(e):iI.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),LR.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?py.lookAt(LR,iI,this.up):py.lookAt(iI,LR,this.up),this.quaternion.setFromRotationMatrix(py),i&&(py.extractRotation(i.matrixWorld),Dx.setFromRotationMatrix(py),this.quaternion.premultiply(Dx.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(tW),Lx.child=e,this.dispatchEvent(Lx),Lx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(bTe),y5.child=e,this.dispatchEvent(y5),y5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),py.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),py.multiply(e.parent.matrixWorld)),e.applyMatrix4(py),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(tW),Lx.child=e,this.dispatchEvent(Lx),Lx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(LR,e,vTe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(LR,yTe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),u=a(e.images),f=a(e.shapes),h=a(e.skeletons),g=a(e.animations),p=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),f.length>0&&(r.shapes=f),h.length>0&&(r.skeletons=h),g.length>0&&(r.animations=g),p.length>0&&(r.nodes=p)}return r.object=i,r;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}ja.DEFAULT_UP=new ut(0,1,0);ja.DEFAULT_MATRIX_AUTO_UPDATE=!0;ja.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const f_=new ut,my=new ut,b5=new ut,gy=new ut,Ux=new ut,Bx=new ut,nW=new ut,S5=new ut,E5=new ut,x5=new ut,T5=new Ta,w5=new Ta,R5=new Ta;class Rm{constructor(e=new ut,t=new ut,r=new ut){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),f_.subVectors(e,t),i.cross(f_);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){f_.subVectors(i,t),my.subVectors(r,t),b5.subVectors(e,t);const a=f_.dot(f_),o=f_.dot(my),l=f_.dot(b5),c=my.dot(my),u=my.dot(b5),f=a*c-o*o;if(f===0)return s.set(0,0,0),null;const h=1/f,g=(c*l-o*u)*h,p=(a*u-o*l)*h;return s.set(1-g-p,p,g)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,gy)===null?!1:gy.x>=0&&gy.y>=0&&gy.x+gy.y<=1}static getInterpolation(e,t,r,i,s,a,o,l){return this.getBarycoord(e,t,r,i,gy)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,gy.x),l.addScaledVector(a,gy.y),l.addScaledVector(o,gy.z),l)}static getInterpolatedAttribute(e,t,r,i,s,a){return T5.setScalar(0),w5.setScalar(0),R5.setScalar(0),T5.fromBufferAttribute(e,t),w5.fromBufferAttribute(e,r),R5.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector(T5,s.x),a.addScaledVector(w5,s.y),a.addScaledVector(R5,s.z),a}static isFrontFacing(e,t,r,i){return f_.subVectors(r,t),my.subVectors(e,t),f_.cross(my).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return f_.subVectors(this.c,this.b),my.subVectors(this.a,this.b),f_.cross(my).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rm.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rm.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return Rm.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Rm.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rm.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;Ux.subVectors(i,r),Bx.subVectors(s,r),S5.subVectors(e,r);const l=Ux.dot(S5),c=Bx.dot(S5);if(l<=0&&c<=0)return t.copy(r);E5.subVectors(e,i);const u=Ux.dot(E5),f=Bx.dot(E5);if(u>=0&&f<=u)return t.copy(i);const h=l*f-u*c;if(h<=0&&l>=0&&u<=0)return a=l/(l-u),t.copy(r).addScaledVector(Ux,a);x5.subVectors(e,s);const g=Ux.dot(x5),p=Bx.dot(x5);if(p>=0&&g<=p)return t.copy(s);const _=g*c-l*p;if(_<=0&&c>=0&&p<=0)return o=c/(c-p),t.copy(r).addScaledVector(Bx,o);const y=u*p-g*f;if(y<=0&&f-u>=0&&g-p>=0)return nW.subVectors(s,i),o=(f-u)/(f-u+(g-p)),t.copy(i).addScaledVector(nW,o);const v=1/(y+_+h);return a=_*v,o=h*v,t.copy(r).addScaledVector(Ux,a).addScaledVector(Bx,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const koe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Hb={h:0,s:0,l:0},sI={h:0,s:0,l:0};function A5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class cr{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=na){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ea.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Ea.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ea.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Ea.workingColorSpace){if(e=lj(e,1),t=Wi(t,0,1),r=Wi(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=A5(a,s,e+1/3),this.g=A5(a,s,e),this.b=A5(a,s,e-1/3)}return Ea.toWorkingColorSpace(this,i),this}setStyle(e,t=na){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=na){const r=koe[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Qy(e.r),this.g=Qy(e.g),this.b=Qy(e.b),this}copyLinearToSRGB(e){return this.r=PT(e.r),this.g=PT(e.g),this.b=PT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=na){return Ea.fromWorkingColorSpace(qd.copy(this),e),Math.round(Wi(qd.r*255,0,255))*65536+Math.round(Wi(qd.g*255,0,255))*256+Math.round(Wi(qd.b*255,0,255))}getHexString(e=na){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ea.workingColorSpace){Ea.fromWorkingColorSpace(qd.copy(this),t);const r=qd.r,i=qd.g,s=qd.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const f=a-o;switch(c=u<=.5?f/(a+o):f/(2-a-o),a){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Ea.workingColorSpace){return Ea.fromWorkingColorSpace(qd.copy(this),t),e.r=qd.r,e.g=qd.g,e.b=qd.b,e}getStyle(e=na){Ea.fromWorkingColorSpace(qd.copy(this),e);const t=qd.r,r=qd.g,i=qd.b;return e!==na?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Hb),this.setHSL(Hb.h+e,Hb.s+t,Hb.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Hb),e.getHSL(sI);const r=D2(Hb.h,sI.h,t),i=D2(Hb.s,sI.s,t),s=D2(Hb.l,sI.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qd=new cr;cr.NAMES=koe;let STe=0;class nh extends $g{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:STe++}),this.uuid=Ug(),this.name="",this.type="Material",this.blending=lE,this.side=Fv,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ZP,this.blendDst=JP,this.blendEquation=c1,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new cr(0,0,0),this.blendAlpha=0,this.depthFunc=bE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=C7,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=BS,this.stencilZFail=BS,this.stencilZPass=BS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==lE&&(r.blending=this.blending),this.side!==Fv&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==ZP&&(r.blendSrc=this.blendSrc),this.blendDst!==JP&&(r.blendDst=this.blendDst),this.blendEquation!==c1&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==bE&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==C7&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==BS&&(r.stencilFail=this.stencilFail),this.stencilZFail!==BS&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==BS&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class G1 extends nh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=dk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const jy=ETe();function ETe(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function vm(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Wi(n,-65504,65504),jy.floatView[0]=n;const e=jy.uint32View[0],t=e>>23&511;return jy.baseTable[t]+((e&8388607)>>jy.shiftTable[t])}function h2(n){const e=n>>10;return jy.uint32View[0]=jy.mantissaTable[jy.offsetTable[e]+(n&1023)]+jy.exponentTable[e],jy.floatView[0]}class xTe{static toHalfFloat(e){return vm(e)}static fromHalfFloat(e){return h2(e)}}const hf=new ut,aI=new an;let TTe=0;class Ds{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:TTe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=rO,this.updateRanges=[],this.gpuType=Pp,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)aI.fromBufferAttribute(this,t),aI.applyMatrix3(e),this.setXY(t,aI.x,aI.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)hf.fromBufferAttribute(this,t),hf.applyMatrix3(e),this.setXYZ(t,hf.x,hf.y,hf.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)hf.fromBufferAttribute(this,t),hf.applyMatrix4(e),this.setXYZ(t,hf.x,hf.y,hf.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)hf.fromBufferAttribute(this,t),hf.applyNormalMatrix(e),this.setXYZ(t,hf.x,hf.y,hf.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)hf.fromBufferAttribute(this,t),hf.transformDirection(e),this.setXYZ(t,hf.x,hf.y,hf.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=kp(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=ss(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=kp(t,this.array)),t}setX(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=kp(t,this.array)),t}setY(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=kp(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=kp(t,this.array)),t}setW(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array),s=ss(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==rO&&(e.usage=this.usage),e}}class wTe extends Ds{constructor(e,t,r){super(new Int8Array(e),t,r)}}class RTe extends Ds{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class ATe extends Ds{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class CTe extends Ds{constructor(e,t,r){super(new Int16Array(e),t,r)}}class cj extends Ds{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class MTe extends Ds{constructor(e,t,r){super(new Int32Array(e),t,r)}}class uj extends Ds{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class OTe extends Ds{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=h2(this.array[e*this.itemSize]);return this.normalized&&(t=kp(t,this.array)),t}setX(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize]=vm(t),this}getY(e){let t=h2(this.array[e*this.itemSize+1]);return this.normalized&&(t=kp(t,this.array)),t}setY(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+1]=vm(t),this}getZ(e){let t=h2(this.array[e*this.itemSize+2]);return this.normalized&&(t=kp(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+2]=vm(t),this}getW(e){let t=h2(this.array[e*this.itemSize+3]);return this.normalized&&(t=kp(t,this.array)),t}setW(e,t){return this.normalized&&(t=ss(t,this.array)),this.array[e*this.itemSize+3]=vm(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this.array[e+2]=vm(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array),s=ss(s,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this.array[e+2]=vm(i),this.array[e+3]=vm(s),this}}class Ir extends Ds{constructor(e,t,r){super(new Float32Array(e),t,r)}}let kTe=0;const d0=new Qr,C5=new ja,Fx=new ut,Sg=new Zd,UR=new Zd,xh=new ut;class ns extends $g{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:kTe++}),this.uuid=Ug(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Coe(e)?uj:cj)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new es().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return d0.makeRotationFromQuaternion(e),this.applyMatrix4(d0),this}rotateX(e){return d0.makeRotationX(e),this.applyMatrix4(d0),this}rotateY(e){return d0.makeRotationY(e),this.applyMatrix4(d0),this}rotateZ(e){return d0.makeRotationZ(e),this.applyMatrix4(d0),this}translate(e,t,r){return d0.makeTranslation(e,t,r),this.applyMatrix4(d0),this}scale(e,t,r){return d0.makeScale(e,t,r),this.applyMatrix4(d0),this}lookAt(e){return C5.lookAt(e),C5.updateMatrix(),this.applyMatrix4(C5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fx).negate(),this.translate(Fx.x,Fx.y,Fx.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Ir(r,3))}else{const r=Math.min(e.length,t.count);for(let i=0;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ut(-1/0,-1/0,-1/0),new ut(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Sg.setFromBufferAttribute(s),this.morphTargetsRelative?(xh.addVectors(this.boundingBox.min,Sg.min),this.boundingBox.expandByPoint(xh),xh.addVectors(this.boundingBox.max,Sg.max),this.boundingBox.expandByPoint(xh)):(this.boundingBox.expandByPoint(Sg.min),this.boundingBox.expandByPoint(Sg.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ut,1/0);return}if(e){const r=this.boundingSphere.center;if(Sg.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];UR.setFromBufferAttribute(o),this.morphTargetsRelative?(xh.addVectors(Sg.min,UR.min),Sg.expandByPoint(xh),xh.addVectors(Sg.max,UR.max),Sg.expandByPoint(xh)):(Sg.expandByPoint(UR.min),Sg.expandByPoint(UR.max))}Sg.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)xh.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(xh));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)xh.fromBufferAttribute(o,c),l&&(Fx.fromBufferAttribute(e,c),xh.add(Fx)),i=Math.max(i,r.distanceToSquared(xh))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ds(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let D=0;D<r.count;D++)o[D]=new ut,l[D]=new ut;const c=new ut,u=new ut,f=new ut,h=new an,g=new an,p=new an,_=new ut,y=new ut;function v(D,V,G){c.fromBufferAttribute(r,D),u.fromBufferAttribute(r,V),f.fromBufferAttribute(r,G),h.fromBufferAttribute(s,D),g.fromBufferAttribute(s,V),p.fromBufferAttribute(s,G),u.sub(c),f.sub(c),g.sub(h),p.sub(h);const J=1/(g.x*p.y-p.x*g.y);isFinite(J)&&(_.copy(u).multiplyScalar(p.y).addScaledVector(f,-g.y).multiplyScalar(J),y.copy(f).multiplyScalar(g.x).addScaledVector(u,-p.x).multiplyScalar(J),o[D].add(_),o[V].add(_),o[G].add(_),l[D].add(y),l[V].add(y),l[G].add(y))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let D=0,V=x.length;D<V;++D){const G=x[D],J=G.start,B=G.count;for(let $=J,U=J+B;$<U;$+=3)v(e.getX($+0),e.getX($+1),e.getX($+2))}const E=new ut,M=new ut,k=new ut,N=new ut;function I(D){k.fromBufferAttribute(i,D),N.copy(k);const V=o[D];E.copy(V),E.sub(k.multiplyScalar(k.dot(V))).normalize(),M.crossVectors(N,V);const J=M.dot(l[D])<0?-1:1;a.setXYZW(D,E.x,E.y,E.z,J)}for(let D=0,V=x.length;D<V;++D){const G=x[D],J=G.start,B=G.count;for(let $=J,U=J+B;$<U;$+=3)I(e.getX($+0)),I(e.getX($+1)),I(e.getX($+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ds(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,g=r.count;h<g;h++)r.setXYZ(h,0,0,0);const i=new ut,s=new ut,a=new ut,o=new ut,l=new ut,c=new ut,u=new ut,f=new ut;if(e)for(let h=0,g=e.count;h<g;h+=3){const p=e.getX(h+0),_=e.getX(h+1),y=e.getX(h+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),a.fromBufferAttribute(t,y),u.subVectors(a,s),f.subVectors(i,s),u.cross(f),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,_),c.fromBufferAttribute(r,y),o.add(u),l.add(u),c.add(u),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(_,l.x,l.y,l.z),r.setXYZ(y,c.x,c.y,c.z)}else for(let h=0,g=t.count;h<g;h+=3)i.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),a.fromBufferAttribute(t,h+2),u.subVectors(a,s),f.subVectors(i,s),u.cross(f),r.setXYZ(h+0,u.x,u.y,u.z),r.setXYZ(h+1,u.x,u.y,u.z),r.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)xh.fromBufferAttribute(e,t),xh.normalize(),e.setXYZ(t,xh.x,xh.y,xh.z)}toNonIndexed(){function e(o,l){const c=o.array,u=o.itemSize,f=o.normalized,h=new c.constructor(l.length*u);let g=0,p=0;for(let _=0,y=l.length;_<y;_++){o.isInterleavedBufferAttribute?g=l[_]*o.data.stride+o.offset:g=l[_]*u;for(let v=0;v<u;v++)h[p++]=c[g++]}return new Ds(h,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ns,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],c=e(l,r);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,f=c.length;u<f;u++){const h=c[u],g=e(h,r);l.push(g)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let f=0,h=c.length;f<h;f++){const g=c[f];u.push(g.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],f=s[c];for(let h=0,g=f.length;h<g;h++)u.push(f[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,u=a.length;c<u;c++){const f=a[c];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const rW=new Qr,fS=new Gw,oI=new xd,iW=new ut,lI=new ut,cI=new ut,uI=new ut,M5=new ut,fI=new ut,sW=new ut,hI=new ut;class bu extends ja{constructor(e=new ns,t=new G1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){fI.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],f=s[l];u!==0&&(M5.fromBufferAttribute(f,e),a?fI.addScaledVector(M5,u):fI.addScaledVector(M5.sub(t),u))}t.add(fI)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),oI.copy(r.boundingSphere),oI.applyMatrix4(s),fS.copy(e.ray).recast(e.near),!(oI.containsPoint(fS.origin)===!1&&(fS.intersectSphere(oI,iW)===null||fS.origin.distanceToSquared(iW)>(e.far-e.near)**2))&&(rW.copy(s).invert(),fS.copy(e.ray).applyMatrix4(rW),!(r.boundingBox!==null&&fS.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,fS)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,f=s.attributes.normal,h=s.groups,g=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,_=h.length;p<_;p++){const y=h[p],v=a[y.materialIndex],x=Math.max(y.start,g.start),E=Math.min(o.count,Math.min(y.start+y.count,g.start+g.count));for(let M=x,k=E;M<k;M+=3){const N=o.getX(M),I=o.getX(M+1),D=o.getX(M+2);i=dI(this,v,e,r,c,u,f,N,I,D),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,g.start),_=Math.min(o.count,g.start+g.count);for(let y=p,v=_;y<v;y+=3){const x=o.getX(y),E=o.getX(y+1),M=o.getX(y+2);i=dI(this,a,e,r,c,u,f,x,E,M),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let p=0,_=h.length;p<_;p++){const y=h[p],v=a[y.materialIndex],x=Math.max(y.start,g.start),E=Math.min(l.count,Math.min(y.start+y.count,g.start+g.count));for(let M=x,k=E;M<k;M+=3){const N=M,I=M+1,D=M+2;i=dI(this,v,e,r,c,u,f,N,I,D),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,g.start),_=Math.min(l.count,g.start+g.count);for(let y=p,v=_;y<v;y+=3){const x=y,E=y+1,M=y+2;i=dI(this,a,e,r,c,u,f,x,E,M),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}}}function ITe(n,e,t,r,i,s,a,o){let l;if(e.side===Yf?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===Fv,o),l===null)return null;hI.copy(o),hI.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(hI);return c<t.near||c>t.far?null:{distance:c,point:hI.clone(),object:n}}function dI(n,e,t,r,i,s,a,o,l,c){n.getVertexPosition(o,lI),n.getVertexPosition(l,cI),n.getVertexPosition(c,uI);const u=ITe(n,e,t,r,lI,cI,uI,sW);if(u){const f=new ut;Rm.getBarycoord(sW,lI,cI,uI,f),i&&(u.uv=Rm.getInterpolatedAttribute(i,o,l,c,f,new an)),s&&(u.uv1=Rm.getInterpolatedAttribute(s,o,l,c,f,new an)),a&&(u.normal=Rm.getInterpolatedAttribute(a,o,l,c,f,new ut),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const h={a:o,b:l,c,normal:new ut,materialIndex:0};Rm.getNormal(lI,cI,uI,h.normal),u.face=h,u.barycoord=f}return u}class ZE extends ns{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],f=[];let h=0,g=0;p("z","y","x",-1,-1,r,t,e,a,s,0),p("z","y","x",1,-1,r,t,-e,a,s,1),p("x","z","y",1,1,e,r,t,i,a,2),p("x","z","y",1,-1,e,r,-t,i,a,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Ir(c,3)),this.setAttribute("normal",new Ir(u,3)),this.setAttribute("uv",new Ir(f,2));function p(_,y,v,x,E,M,k,N,I,D,V){const G=M/I,J=k/D,B=M/2,$=k/2,U=N/2,Q=I+1,W=D+1;let q=0,Y=0;const ae=new ut;for(let Z=0;Z<W;Z++){const K=Z*J-$;for(let ne=0;ne<Q;ne++){const le=ne*G-B;ae[_]=le*x,ae[y]=K*E,ae[v]=U,c.push(ae.x,ae.y,ae.z),ae[_]=0,ae[y]=0,ae[v]=N>0?1:-1,u.push(ae.x,ae.y,ae.z),f.push(ne/I),f.push(1-Z/D),q+=1}}for(let Z=0;Z<D;Z++)for(let K=0;K<I;K++){const ne=h+K+Q*Z,le=h+K+Q*(Z+1),ce=h+(K+1)+Q*(Z+1),de=h+(K+1)+Q*Z;l.push(ne,le,de),l.push(le,ce,de),Y+=6}o.addGroup(g,Y,V),g+=Y,h+=q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ZE(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function QT(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function wp(n){const e={};for(let t=0;t<n.length;t++){const r=QT(n[t]);for(const i in r)e[i]=r[i]}return e}function NTe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function Ioe(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ea.workingColorSpace}const Noe={clone:QT,merge:wp};var PTe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,DTe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Vl extends nh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PTe,this.fragmentShader=DTe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=QT(e.uniforms),this.uniformsGroups=NTe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class _k extends ja{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qr,this.projectionMatrix=new Qr,this.projectionMatrixInverse=new Qr,this.coordinateSystem=N0}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const qb=new ut,aW=new an,oW=new an;class yf extends _k{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=ZT*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(cE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return ZT*2*Math.atan(Math.tan(cE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){qb.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(qb.x,qb.y).multiplyScalar(-e/qb.z),qb.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(qb.x,qb.y).multiplyScalar(-e/qb.z)}getViewSize(e,t){return this.getViewBounds(e,aW,oW),t.subVectors(oW,aW)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(cE*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*r/c,i*=a.width/l,r*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const zx=-90,jx=1;class Poe extends ja{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new yf(zx,jx,e,t);i.layers=this.layers,this.add(i);const s=new yf(zx,jx,e,t);s.layers=this.layers,this.add(s);const a=new yf(zx,jx,e,t);a.layers=this.layers,this.add(a);const o=new yf(zx,jx,e,t);o.layers=this.layers,this.add(o);const l=new yf(zx,jx,e,t);l.layers=this.layers,this.add(l);const c=new yf(zx,jx,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===N0)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===iO)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,u]=this.children,f=e.getRenderTarget(),h=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const _=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=_,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(f,h,g),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class vk extends wc{constructor(e=[],t=lb,r,i,s,a,o,l,c,u){super(e,t,r,i,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Doe extends Sf{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new vk(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:sc}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ZE(5,5,5),s=new Vl({name:"CubemapFromEquirect",uniforms:QT(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Yf,blending:Ih});s.uniforms.tEquirect.value=t;const a=new bu(i,s),o=t.minFilter;return t.minFilter===Rv&&(t.minFilter=sc),new Poe(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}class eE extends ja{constructor(){super(),this.isGroup=!0,this.type="Group"}}const LTe={type:"move"};class nP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new eE,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new eE,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ut,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ut),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new eE,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ut,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ut),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const _ of e.hand.values()){const y=t.getJointPose(_,r),v=this._getHandJoint(c,_);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const u=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],h=u.position.distanceTo(f.position),g=.02,p=.005;c.inputState.pinching&&h>g+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=g-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(LTe)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new eE;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class N4{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new cr(e),this.density=t}clone(){return new N4(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class P4{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new cr(e),this.near=t,this.far=r}clone(){return new P4(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class ew extends ja{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Bm,this.environmentIntensity=1,this.environmentRotation=new Bm,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class D4{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=rO,this.updateRanges=[],this.version=0,this.uuid=Ug()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ug()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ug()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const xp=new ut;class xE{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)xp.fromBufferAttribute(this,t),xp.applyMatrix4(e),this.setXYZ(t,xp.x,xp.y,xp.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)xp.fromBufferAttribute(this,t),xp.applyNormalMatrix(e),this.setXYZ(t,xp.x,xp.y,xp.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)xp.fromBufferAttribute(this,t),xp.transformDirection(e),this.setXYZ(t,xp.x,xp.y,xp.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=kp(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=ss(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=ss(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ss(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ss(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ss(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=kp(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=kp(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=kp(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=kp(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ss(t,this.array),r=ss(r,this.array),i=ss(i,this.array),s=ss(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Ds(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xE(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class fj extends nh{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new cr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Hx;const BR=new ut,qx=new ut,Vx=new ut,Gx=new an,FR=new an,Loe=new Qr,pI=new ut,zR=new ut,mI=new ut,lW=new an,O5=new an,cW=new an;class Uoe extends ja{constructor(e=new fj){if(super(),this.isSprite=!0,this.type="Sprite",Hx===void 0){Hx=new ns;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new D4(t,5);Hx.setIndex([0,1,2,0,2,3]),Hx.setAttribute("position",new xE(r,3,0,!1)),Hx.setAttribute("uv",new xE(r,2,3,!1))}this.geometry=Hx,this.material=e,this.center=new an(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),qx.setFromMatrixScale(this.matrixWorld),Loe.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vx.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&qx.multiplyScalar(-Vx.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;gI(pI.set(-.5,-.5,0),Vx,a,qx,i,s),gI(zR.set(.5,-.5,0),Vx,a,qx,i,s),gI(mI.set(.5,.5,0),Vx,a,qx,i,s),lW.set(0,0),O5.set(1,0),cW.set(1,1);let o=e.ray.intersectTriangle(pI,zR,mI,!1,BR);if(o===null&&(gI(zR.set(-.5,.5,0),Vx,a,qx,i,s),O5.set(0,1),o=e.ray.intersectTriangle(pI,mI,zR,!1,BR),o===null))return;const l=e.ray.origin.distanceTo(BR);l<e.near||l>e.far||t.push({distance:l,point:BR.clone(),uv:Rm.getInterpolation(BR,pI,zR,mI,lW,O5,cW,new an),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function gI(n,e,t,r,i,s){Gx.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(FR.x=s*Gx.x-i*Gx.y,FR.y=i*Gx.x+s*Gx.y):FR.copy(Gx),n.copy(e),n.x+=FR.x,n.y+=FR.y,n.applyMatrix4(Loe)}const _I=new ut,uW=new ut;class Boe extends ja{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let r=0;r<t.length;r++)if(t[r].distance===e){const i=t.splice(r,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){_I.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(_I);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){_I.setFromMatrixPosition(e.matrixWorld),uW.setFromMatrixPosition(this.matrixWorld);const r=_I.distanceTo(uW)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),r>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const fW=new ut,hW=new Ta,dW=new Ta,UTe=new ut,pW=new Qr,vI=new ut,k5=new xd,mW=new Qr,I5=new Gw;class Foe extends bu{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=A7,this.bindMatrix=new Qr,this.bindMatrixInverse=new Qr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Zd),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,vI),this.boundingBox.expandByPoint(vI)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new xd),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,vI),this.boundingSphere.expandByPoint(vI)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),k5.copy(this.boundingSphere),k5.applyMatrix4(i),e.ray.intersectsSphere(k5)!==!1&&(mW.copy(i).invert(),I5.copy(e.ray).applyMatrix4(mW),!(this.boundingBox!==null&&I5.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,I5)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ta,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===A7?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===poe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;hW.fromBufferAttribute(i.attributes.skinIndex,e),dW.fromBufferAttribute(i.attributes.skinWeight,e),fW.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=dW.getComponent(s);if(a!==0){const o=hW.getComponent(s);pW.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(UTe.copy(fW).applyMatrix4(pW),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hj extends ja{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Bg extends wc{constructor(e=null,t=1,r=1,i,s,a,o,l,c=bf,u=bf,f,h){super(null,a,o,l,c,u,i,s,f,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const gW=new Qr,BTe=new Qr;class L4{constructor(e=[],t=[]){this.uuid=Ug(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Qr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Qr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:BTe;gW.multiplyMatrices(o,t[s]),gW.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new L4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Bg(t,e,e,Xf,Pp);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new hj),this.bones.push(a),this.boneInverses.push(new Qr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const o=r[i];e.boneInverses.push(o.toArray())}return e}}class tw extends Ds{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const $x=new Qr,_W=new Qr,yI=[],vW=new Zd,FTe=new Qr,jR=new bu,HR=new xd;class zoe extends bu{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new tw(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,FTe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Zd),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,$x),vW.copy(e.boundingBox).applyMatrix4($x),this.boundingBox.union(vW)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new xd),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,$x),HR.copy(e.boundingSphere).applyMatrix4($x),this.boundingSphere.union(HR)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,a=e*s+1;for(let o=0;o<r.length;o++)r[o]=i[a+o]}raycast(e,t){const r=this.matrixWorld,i=this.count;if(jR.geometry=this.geometry,jR.material=this.material,jR.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),HR.copy(this.boundingSphere),HR.applyMatrix4(r),e.ray.intersectsSphere(HR)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,$x),_W.multiplyMatrices(r,$x),jR.matrixWorld=_W,jR.raycast(e,yI);for(let a=0,o=yI.length;a<o;a++){const l=yI[a];l.instanceId=s,l.object=this,t.push(l)}yI.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new tw(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new Bg(new Float32Array(i*this.count),i,this.count,Vw,Pp));const s=this.morphTexture.source.data.data;let a=0;for(let c=0;c<r.length;c++)a+=r[c];const o=this.geometry.morphTargetsRelative?1:1-a,l=i*e;s[l]=o,s.set(r,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const N5=new ut,zTe=new ut,jTe=new es;let r1=class{constructor(e=new ut(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=N5.subVectors(r,t).cross(zTe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(N5),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||jTe.getNormalMatrix(e),i=this.coplanarPoint(N5).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const hS=new xd,bI=new ut;class $w{constructor(e=new r1,t=new r1,r=new r1,i=new r1,s=new r1,a=new r1){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=N0){const r=this.planes,i=e.elements,s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],g=i[8],p=i[9],_=i[10],y=i[11],v=i[12],x=i[13],E=i[14],M=i[15];if(r[0].setComponents(l-s,h-c,y-g,M-v).normalize(),r[1].setComponents(l+s,h+c,y+g,M+v).normalize(),r[2].setComponents(l+a,h+u,y+p,M+x).normalize(),r[3].setComponents(l-a,h-u,y-p,M-x).normalize(),r[4].setComponents(l-o,h-f,y-_,M-E).normalize(),t===N0)r[5].setComponents(l+o,h+f,y+_,M+E).normalize();else if(t===iO)r[5].setComponents(o,f,_,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),hS.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),hS.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(hS)}intersectsSprite(e){return hS.center.set(0,0,0),hS.radius=.7071067811865476,hS.applyMatrix4(e.matrixWorld),this.intersectsSphere(hS)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(bI.x=i.normal.x>0?e.max.x:e.min.x,bI.y=i.normal.y>0?e.max.y:e.min.y,bI.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(bI)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const nv=new Qr,rv=new $w;class U4{constructor(){this.coordinateSystem=N0}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(nv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),rv.setFromProjectionMatrix(nv,this.coordinateSystem),rv.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(nv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),rv.setFromProjectionMatrix(nv,this.coordinateSystem),rv.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(nv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),rv.setFromProjectionMatrix(nv,this.coordinateSystem),rv.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(nv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),rv.setFromProjectionMatrix(nv,this.coordinateSystem),rv.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(nv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),rv.setFromProjectionMatrix(nv,this.coordinateSystem),rv.containsPoint(e))return!0}return!1}clone(){return new U4}}function P5(n,e){return n-e}function HTe(n,e){return n.z-e.z}function qTe(n,e){return e.z-n.z}class VTe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r,i){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=r,o.index=i}reset(){this.list.length=0,this.index=0}}const dm=new Qr,GTe=new cr(1,1,1),yW=new $w,$Te=new U4,SI=new Zd,dS=new xd,qR=new ut,bW=new ut,WTe=new ut,D5=new VTe,Vd=new bu,EI=[];function YTe(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let a=0;a<r;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*r);e.needsUpdate=!0}function pS(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++)e[r]=n[r]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class joe extends bu{constructor(e,t,r=t*2,i){super(new ns,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Bg(t,e,e,Xf,Pp);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new Bg(t,e,e,pk,zv);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new Bg(t,e,e,Xf,Pp);r.colorSpace=Ea.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:l,normalized:c}=a,u=new o.constructor(r*l),f=new Ds(u,l,c);t.setAttribute(s,f)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Ds(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`THREE.BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Zd);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,dm),this.getBoundingBoxAt(s,SI).applyMatrix4(dm),e.union(SI)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xd);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,dm),this.getBoundingSphereAt(s,dS).applyMatrix4(dm),e.union(dS)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const r={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(P5),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));const s=this._matricesTexture;dm.identity().toArray(s.image.data,i*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(GTe.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,r=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=r===-1?a.count:r),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(P5),l=this._availableGeometryIds.shift(),s[l]=i):(l=this._geometryCount,this._geometryCount++,s.push(i)),this.setGeometryAt(l,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(i&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const u in r.attributes){const f=t.getAttribute(u),h=r.getAttribute(u);YTe(f,h,l);const g=f.itemSize;for(let p=f.count,_=c;p<_;p++){const y=l+p;for(let v=0;v<g;v++)h.setComponent(y,v,0)}h.needsUpdate=!0,h.addUpdateRange(l*g,c*g)}if(i){const u=o.indexStart,f=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let h=0;h<a.count;h++)s.setX(u+h,l+a.getX(h));for(let h=a.count,g=f;h<g;h++)s.setX(u+h,l);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=i?o.indexStart:o.vertexStart,o.count=i?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const r=this._instanceInfo;for(let i=0,s=r.length;i<s;i++)r[i].active&&r[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const r=this._geometryInfo,i=r.map((a,o)=>o).sort((a,o)=>r[a].vertexStart-r[o].vertexStart),s=this.geometry;for(let a=0,o=r.length;a<o;a++){const l=i[a],c=r[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==t){const{indexStart:u,vertexStart:f,reservedIndexCount:h}=c,g=s.index,p=g.array,_=e-f;for(let y=u;y<u+h;y++)p[y]=p[y]+_;g.array.copyWithin(t,u,u+h),g.addUpdateRange(t,h),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:f}=c,h=s.attributes;for(const g in h){const p=h[g],{array:_,itemSize:y}=p;_.copyWithin(e*y,u*y,(u+f)*y),p.addUpdateRange(e*y,f*y)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const s=new Zd,a=r.index,o=r.attributes.position;for(let l=i.start,c=i.start+i.count;l<c;l++){let u=l;a&&(u=a.getX(u)),s.expandByPoint(qR.fromBufferAttribute(o,u))}i.boundingBox=s}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const s=new xd;this.getBoundingBoxAt(e,SI),SI.getCenter(s.center);const a=r.index,o=r.attributes.position;let l=0;for(let c=i.start,u=i.start+i.count;c<u;c++){let f=c;a&&(f=a.getX(f)),qR.fromBufferAttribute(o,f),l=Math.max(l,s.center.distanceToSquared(qR))}s.radius=Math.sqrt(l),i.boundingSphere=s}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const r=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),r.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const r=this._geometryInfo[e];return t.vertexStart=r.vertexStart,t.vertexCount=r.vertexCount,t.reservedVertexCount=r.reservedVertexCount,t.indexStart=r.indexStart,t.indexCount=r.indexCount,t.reservedIndexCount=r.reservedIndexCount,t.start=r.start,t.count=r.count,t}setInstanceCount(e){const t=this._availableInstanceIds,r=this._instanceInfo;for(t.sort(P5);t[t.length-1]===r.length;)r.pop(),t.pop();if(e<r.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),s=new Int32Array(e);pS(this._multiDrawCounts,i),pS(this._multiDrawStarts,s),this._multiDrawCounts=i,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),pS(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),pS(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),pS(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const r=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...r.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...r.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new ns,this._initializeGeometry(s));const a=this.geometry;s.index&&pS(s.index.array,a.index.array);for(const o in s.attributes)pS(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const r=this._instanceInfo,i=this._geometryInfo,s=this.matrixWorld,a=this.geometry;Vd.material=this.material,Vd.geometry.index=a.index,Vd.geometry.attributes=a.attributes,Vd.geometry.boundingBox===null&&(Vd.geometry.boundingBox=new Zd),Vd.geometry.boundingSphere===null&&(Vd.geometry.boundingSphere=new xd);for(let o=0,l=r.length;o<l;o++){if(!r[o].visible||!r[o].active)continue;const c=r[o].geometryIndex,u=i[c];Vd.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,Vd.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Vd.geometry.boundingBox),this.getBoundingSphereAt(c,Vd.geometry.boundingSphere),Vd.raycast(e,EI);for(let f=0,h=EI.length;f<h;f++){const g=EI[f];g.object=this,g.batchId=o,t.push(g)}EI.length=0}Vd.material=null,Vd.geometry.index=null,Vd.geometry.attributes={},Vd.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,f=this._geometryInfo,h=this.perObjectFrustumCulled,g=this._indirectTexture,p=g.image.data,_=r.isArrayCamera?$Te:yW;h&&!r.isArrayCamera&&(dm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),yW.setFromProjectionMatrix(dm,e.coordinateSystem));let y=0;if(this.sortObjects){dm.copy(this.matrixWorld).invert(),qR.setFromMatrixPosition(r.matrixWorld).applyMatrix4(dm),bW.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(dm);for(let E=0,M=l.length;E<M;E++)if(l[E].visible&&l[E].active){const k=l[E].geometryIndex;this.getMatrixAt(E,dm),this.getBoundingSphereAt(k,dS).applyMatrix4(dm);let N=!1;if(h&&(N=!_.intersectsSphere(dS,r)),!N){const I=f[k],D=WTe.subVectors(dS.center,qR).dot(bW);D5.push(I.start,I.count,D,E)}}const v=D5.list,x=this.customSort;x===null?v.sort(s.transparent?qTe:HTe):x.call(this,v,r);for(let E=0,M=v.length;E<M;E++){const k=v[E];c[y]=k.start*o,u[y]=k.count,p[y]=k.index,y++}D5.reset()}else for(let v=0,x=l.length;v<x;v++)if(l[v].visible&&l[v].active){const E=l[v].geometryIndex;let M=!1;if(h&&(this.getMatrixAt(v,dm),this.getBoundingSphereAt(E,dS).applyMatrix4(dm),M=!_.intersectsSphere(dS,r)),!M){const k=f[E];c[y]=k.start*o,u[y]=k.count,p[y]=v,y++}}g.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class qp extends nh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new cr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ND=new ut,PD=new ut,SW=new Qr,VR=new Gw,xI=new xd,L5=new ut,EW=new ut;class M1 extends ja{constructor(e=new ns,t=new qp){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)ND.fromBufferAttribute(t,i-1),PD.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=ND.distanceTo(PD);e.setAttribute("lineDistance",new Ir(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),xI.copy(r.boundingSphere),xI.applyMatrix4(i),xI.radius+=s,e.ray.intersectsSphere(xI)===!1)return;SW.copy(i).invert(),VR.copy(e.ray).applyMatrix4(SW);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,u=r.index,h=r.attributes.position;if(u!==null){const g=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let _=g,y=p-1;_<y;_+=c){const v=u.getX(_),x=u.getX(_+1),E=TI(this,e,VR,l,v,x,_);E&&t.push(E)}if(this.isLineLoop){const _=u.getX(p-1),y=u.getX(g),v=TI(this,e,VR,l,_,y,p-1);v&&t.push(v)}}else{const g=Math.max(0,a.start),p=Math.min(h.count,a.start+a.count);for(let _=g,y=p-1;_<y;_+=c){const v=TI(this,e,VR,l,_,_+1,_);v&&t.push(v)}if(this.isLineLoop){const _=TI(this,e,VR,l,p-1,g,p-1);_&&t.push(_)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function TI(n,e,t,r,i,s,a){const o=n.geometry.attributes.position;if(ND.fromBufferAttribute(o,i),PD.fromBufferAttribute(o,s),t.distanceSqToSegment(ND,PD,L5,EW)>r)return;L5.applyMatrix4(n.matrixWorld);const c=e.ray.origin.distanceTo(L5);if(!(c<e.near||c>e.far))return{distance:c,point:EW.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const xW=new ut,TW=new ut;class Kv extends M1{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)xW.fromBufferAttribute(t,i),TW.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+xW.distanceTo(TW);e.setAttribute("lineDistance",new Ir(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Hoe extends M1{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class dj extends nh{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new cr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const wW=new Qr,k7=new Gw,wI=new xd,RI=new ut;class qoe extends ja{constructor(e=new ns,t=new dj){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),wI.copy(r.boundingSphere),wI.applyMatrix4(i),wI.radius+=s,e.ray.intersectsSphere(wI)===!1)return;wW.copy(i).invert(),k7.copy(e.ray).applyMatrix4(wW);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=r.index,f=r.attributes.position;if(c!==null){const h=Math.max(0,a.start),g=Math.min(c.count,a.start+a.count);for(let p=h,_=g;p<_;p++){const y=c.getX(p);RI.fromBufferAttribute(f,y),RW(RI,y,l,i,e,t,this)}}else{const h=Math.max(0,a.start),g=Math.min(f.count,a.start+a.count);for(let p=h,_=g;p<_;p++)RI.fromBufferAttribute(f,p),RW(RI,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function RW(n,e,t,r,i,s,a){const o=k7.distanceSqToPoint(n);if(o<t){const l=new ut;k7.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class Voe extends wc{constructor(e,t,r,i,s=sc,a=sc,o,l,c){super(e,t,r,i,s,a,o,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class XTe extends Voe{constructor(e,t,r,i,s,a,o,l){super({},e,t,r,i,s,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class KTe extends wc{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=bf,this.minFilter=bf,this.generateMipmaps=!1,this.needsUpdate=!0}}class B4 extends wc{constructor(e,t,r,i,s,a,o,l,c,u,f,h){super(null,a,o,l,c,u,i,s,f,h),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class ZTe extends B4{constructor(e,t,r,i,s,a){super(e,t,r,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=I0,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class JTe extends B4{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,lb),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Goe extends wc{constructor(e,t,r,i,s,a,o,l,c){super(e,t,r,i,s,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ww extends wc{constructor(e,t,r=zv,i,s,a,o=bf,l=bf,c,u=KT){if(u!==KT&&u!==EE)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,s,a,o,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new p1(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class QTe extends Ww{constructor(e=1,t=1,r=1){super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:r},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class F4 extends ns{constructor(e=1,t=1,r=4,i=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:r,radialSegments:i,heightSegments:s},t=Math.max(0,t),r=Math.max(1,Math.floor(r)),i=Math.max(3,Math.floor(i)),s=Math.max(1,Math.floor(s));const a=[],o=[],l=[],c=[],u=t/2,f=Math.PI/2*e,h=t,g=2*f+h,p=r*2+s,_=i+1,y=new ut,v=new ut;for(let x=0;x<=p;x++){let E=0,M=0,k=0,N=0;if(x<=r){const V=x/r,G=V*Math.PI/2;M=-u-e*Math.cos(G),k=e*Math.sin(G),N=-e*Math.cos(G),E=V*f}else if(x<=r+s){const V=(x-r)/s;M=-u+V*t,k=e,N=0,E=f+V*h}else{const V=(x-r-s)/r,G=V*Math.PI/2;M=u+e*Math.sin(G),k=e*Math.cos(G),N=e*Math.sin(G),E=f+h+V*f}const I=Math.max(0,Math.min(1,E/g));let D=0;x===0?D=.5/i:x===p&&(D=-.5/i);for(let V=0;V<=i;V++){const G=V/i,J=G*Math.PI*2,B=Math.sin(J),$=Math.cos(J);v.x=-k*$,v.y=M,v.z=k*B,o.push(v.x,v.y,v.z),y.set(-k*$,N,k*B),y.normalize(),l.push(y.x,y.y,y.z),c.push(G+D,I)}if(x>0){const V=(x-1)*_;for(let G=0;G<i;G++){const J=V+G,B=V+G+1,$=x*_+G,U=x*_+G+1;a.push(J,B,$),a.push(B,U,$)}}}this.setIndex(a),this.setAttribute("position",new Ir(o,3)),this.setAttribute("normal",new Ir(l,3)),this.setAttribute("uv",new Ir(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new F4(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class z4 extends ns{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],a=[],o=[],l=[],c=new ut,u=new an;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let f=0,h=3;f<=t;f++,h+=3){const g=r+f/t*i;c.x=e*Math.cos(g),c.y=e*Math.sin(g),a.push(c.x,c.y,c.z),o.push(0,0,1),u.x=(a[h]/e+1)/2,u.y=(a[h+1]/e+1)/2,l.push(u.x,u.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Ir(a,3)),this.setAttribute("normal",new Ir(o,3)),this.setAttribute("uv",new Ir(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new z4(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class yk extends ns{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],f=[],h=[],g=[];let p=0;const _=[],y=r/2;let v=0;x(),a===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(u),this.setAttribute("position",new Ir(f,3)),this.setAttribute("normal",new Ir(h,3)),this.setAttribute("uv",new Ir(g,2));function x(){const M=new ut,k=new ut;let N=0;const I=(t-e)/r;for(let D=0;D<=s;D++){const V=[],G=D/s,J=G*(t-e)+e;for(let B=0;B<=i;B++){const $=B/i,U=$*l+o,Q=Math.sin(U),W=Math.cos(U);k.x=J*Q,k.y=-G*r+y,k.z=J*W,f.push(k.x,k.y,k.z),M.set(Q,I,W).normalize(),h.push(M.x,M.y,M.z),g.push($,1-G),V.push(p++)}_.push(V)}for(let D=0;D<i;D++)for(let V=0;V<s;V++){const G=_[V][D],J=_[V+1][D],B=_[V+1][D+1],$=_[V][D+1];(e>0||V!==0)&&(u.push(G,J,$),N+=3),(t>0||V!==s-1)&&(u.push(J,B,$),N+=3)}c.addGroup(v,N,0),v+=N}function E(M){const k=p,N=new an,I=new ut;let D=0;const V=M===!0?e:t,G=M===!0?1:-1;for(let B=1;B<=i;B++)f.push(0,y*G,0),h.push(0,G,0),g.push(.5,.5),p++;const J=p;for(let B=0;B<=i;B++){const U=B/i*l+o,Q=Math.cos(U),W=Math.sin(U);I.x=V*W,I.y=y*G,I.z=V*Q,f.push(I.x,I.y,I.z),h.push(0,G,0),N.x=Q*.5+.5,N.y=W*.5*G+.5,g.push(N.x,N.y),p++}for(let B=0;B<i;B++){const $=k+B,U=J+B;M===!0?u.push(U,U+1,$):u.push(U+1,U,$),D+=3}c.addGroup(v,D,M===!0?1:2),v+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yk(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class bk extends yk{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new bk(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class $1 extends ns{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],a=[];o(i),c(r),u(),this.setAttribute("position",new Ir(s,3)),this.setAttribute("normal",new Ir(s.slice(),3)),this.setAttribute("uv",new Ir(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(x){const E=new ut,M=new ut,k=new ut;for(let N=0;N<t.length;N+=3)g(t[N+0],E),g(t[N+1],M),g(t[N+2],k),l(E,M,k,x)}function l(x,E,M,k){const N=k+1,I=[];for(let D=0;D<=N;D++){I[D]=[];const V=x.clone().lerp(M,D/N),G=E.clone().lerp(M,D/N),J=N-D;for(let B=0;B<=J;B++)B===0&&D===N?I[D][B]=V:I[D][B]=V.clone().lerp(G,B/J)}for(let D=0;D<N;D++)for(let V=0;V<2*(N-D)-1;V++){const G=Math.floor(V/2);V%2===0?(h(I[D][G+1]),h(I[D+1][G]),h(I[D][G])):(h(I[D][G+1]),h(I[D+1][G+1]),h(I[D+1][G]))}}function c(x){const E=new ut;for(let M=0;M<s.length;M+=3)E.x=s[M+0],E.y=s[M+1],E.z=s[M+2],E.normalize().multiplyScalar(x),s[M+0]=E.x,s[M+1]=E.y,s[M+2]=E.z}function u(){const x=new ut;for(let E=0;E<s.length;E+=3){x.x=s[E+0],x.y=s[E+1],x.z=s[E+2];const M=y(x)/2/Math.PI+.5,k=v(x)/Math.PI+.5;a.push(M,1-k)}p(),f()}function f(){for(let x=0;x<a.length;x+=6){const E=a[x+0],M=a[x+2],k=a[x+4],N=Math.max(E,M,k),I=Math.min(E,M,k);N>.9&&I<.1&&(E<.2&&(a[x+0]+=1),M<.2&&(a[x+2]+=1),k<.2&&(a[x+4]+=1))}}function h(x){s.push(x.x,x.y,x.z)}function g(x,E){const M=x*3;E.x=e[M+0],E.y=e[M+1],E.z=e[M+2]}function p(){const x=new ut,E=new ut,M=new ut,k=new ut,N=new an,I=new an,D=new an;for(let V=0,G=0;V<s.length;V+=9,G+=6){x.set(s[V+0],s[V+1],s[V+2]),E.set(s[V+3],s[V+4],s[V+5]),M.set(s[V+6],s[V+7],s[V+8]),N.set(a[G+0],a[G+1]),I.set(a[G+2],a[G+3]),D.set(a[G+4],a[G+5]),k.copy(x).add(E).add(M).divideScalar(3);const J=y(k);_(N,G+0,x,J),_(I,G+2,E,J),_(D,G+4,M,J)}}function _(x,E,M,k){k<0&&x.x===1&&(a[E]=x.x-1),M.x===0&&M.z===0&&(a[E]=k/2/Math.PI+.5)}function y(x){return Math.atan2(x.z,-x.x)}function v(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $1(e.vertices,e.indices,e.radius,e.details)}}class j4 extends $1{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new j4(e.radius,e.detail)}}const AI=new ut,CI=new ut,U5=new ut,MI=new Rm;class $oe extends ns{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(cE*t),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],u=["a","b","c"],f=new Array(3),h={},g=[];for(let p=0;p<l;p+=3){a?(c[0]=a.getX(p),c[1]=a.getX(p+1),c[2]=a.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:_,b:y,c:v}=MI;if(_.fromBufferAttribute(o,c[0]),y.fromBufferAttribute(o,c[1]),v.fromBufferAttribute(o,c[2]),MI.getNormal(U5),f[0]=`${Math.round(_.x*i)},${Math.round(_.y*i)},${Math.round(_.z*i)}`,f[1]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,f[2]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let x=0;x<3;x++){const E=(x+1)%3,M=f[x],k=f[E],N=MI[u[x]],I=MI[u[E]],D=`${M}_${k}`,V=`${k}_${M}`;V in h&&h[V]?(U5.dot(h[V].normal)<=s&&(g.push(N.x,N.y,N.z),g.push(I.x,I.y,I.z)),h[V]=null):D in h||(h[D]={index0:c[x],index1:c[E],normal:U5.clone()})}}for(const p in h)if(h[p]){const{index0:_,index1:y}=h[p];AI.fromBufferAttribute(o,_),CI.fromBufferAttribute(o,y),g.push(AI.x,AI.y,AI.z),g.push(CI.x,CI.y,CI.z)}this.setAttribute("position",new Ir(g,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class F_{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const r=this.getLengths();let i=0;const s=r.length;let a;t?a=t:a=e*r[s-1];let o=0,l=s-1,c;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),c=r[i]-a,c<0)o=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===a)return i/(s-1);const u=r[i],h=r[i+1]-u,g=(a-u)/h;return(i+g)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),l=t||(a.isVector2?new an:new ut);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t=!1){const r=new ut,i=[],s=[],a=[],o=new ut,l=new Qr;for(let g=0;g<=e;g++){const p=g/e;i[g]=this.getTangentAt(p,new ut)}s[0]=new ut,a[0]=new ut;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),f=Math.abs(i[0].y),h=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),f<=c&&(c=f,r.set(0,1,0)),h<=c&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let g=1;g<=e;g++){if(s[g]=s[g-1].clone(),a[g]=a[g-1].clone(),o.crossVectors(i[g-1],i[g]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(Wi(i[g-1].dot(i[g]),-1,1));s[g].applyMatrix4(l.makeRotationAxis(o,p))}a[g].crossVectors(i[g],s[g])}if(t===!0){let g=Math.acos(Wi(s[0].dot(s[e]),-1,1));g/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(g=-g);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],g*p)),a[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class H4 extends F_{constructor(e=0,t=0,r=1,i=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new an){const r=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),h=l-this.aX,g=c-this.aY;l=h*u-g*f+this.aX,c=h*f+g*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Woe extends H4{constructor(e,t,r,i,s,a){super(e,t,r,r,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function pj(){let n=0,e=0,t=0,r=0;function i(s,a,o,l){n=s,e=o,t=-3*s+3*a-2*o-l,r=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){i(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,f){let h=(a-s)/c-(o-s)/(c+u)+(o-a)/u,g=(o-a)/u-(l-a)/(u+f)+(l-o)/f;h*=u,g*=u,i(a,o,h,g)},calc:function(s){const a=s*s,o=a*s;return n+e*s+t*a+r*o}}}const OI=new ut,B5=new pj,F5=new pj,z5=new pj;class Yoe extends F_{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new ut){const r=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,u;this.closed||o>0?c=i[(o-1)%s]:(OI.subVectors(i[0],i[1]).add(i[0]),c=OI);const f=i[o%s],h=i[(o+1)%s];if(this.closed||o+2<s?u=i[(o+2)%s]:(OI.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=OI),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(f),g),_=Math.pow(f.distanceToSquared(h),g),y=Math.pow(h.distanceToSquared(u),g);_<1e-4&&(_=1),p<1e-4&&(p=_),y<1e-4&&(y=_),B5.initNonuniformCatmullRom(c.x,f.x,h.x,u.x,p,_,y),F5.initNonuniformCatmullRom(c.y,f.y,h.y,u.y,p,_,y),z5.initNonuniformCatmullRom(c.z,f.z,h.z,u.z,p,_,y)}else this.curveType==="catmullrom"&&(B5.initCatmullRom(c.x,f.x,h.x,u.x,this.tension),F5.initCatmullRom(c.y,f.y,h.y,u.y,this.tension),z5.initCatmullRom(c.z,f.z,h.z,u.z,this.tension));return r.set(B5.calc(l),F5.calc(l),z5.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ut().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function AW(n,e,t,r,i){const s=(r-e)*.5,a=(i-t)*.5,o=n*n,l=n*o;return(2*t-2*r+s+a)*l+(-3*t+3*r-2*s-a)*o+s*n+t}function ewe(n,e){const t=1-n;return t*t*e}function twe(n,e){return 2*(1-n)*n*e}function nwe(n,e){return n*n*e}function L2(n,e,t,r){return ewe(n,e)+twe(n,t)+nwe(n,r)}function rwe(n,e){const t=1-n;return t*t*t*e}function iwe(n,e){const t=1-n;return 3*t*t*n*e}function swe(n,e){return 3*(1-n)*n*n*e}function awe(n,e){return n*n*n*e}function U2(n,e,t,r,i){return rwe(n,e)+iwe(n,t)+swe(n,r)+awe(n,i)}class mj extends F_{constructor(e=new an,t=new an,r=new an,i=new an){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new an){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(U2(e,i.x,s.x,a.x,o.x),U2(e,i.y,s.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Xoe extends F_{constructor(e=new ut,t=new ut,r=new ut,i=new ut){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(U2(e,i.x,s.x,a.x,o.x),U2(e,i.y,s.y,a.y,o.y),U2(e,i.z,s.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class gj extends F_{constructor(e=new an,t=new an){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new an){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new an){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Koe extends F_{constructor(e=new ut,t=new ut){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ut){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ut){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _j extends F_{constructor(e=new an,t=new an,r=new an){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new an){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(L2(e,i.x,s.x,a.x),L2(e,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vj extends F_{constructor(e=new ut,t=new ut,r=new ut){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(L2(e,i.x,s.x,a.x),L2(e,i.y,s.y,a.y),L2(e,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yj extends F_{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new an){const r=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,l=i[a===0?a:a-1],c=i[a],u=i[a>i.length-2?i.length-1:a+1],f=i[a>i.length-3?i.length-1:a+2];return r.set(AW(o,l.x,c.x,u.x,f.x),AW(o,l.y,c.y,u.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new an().fromArray(i))}return this}}var DD=Object.freeze({__proto__:null,ArcCurve:Woe,CatmullRomCurve3:Yoe,CubicBezierCurve:mj,CubicBezierCurve3:Xoe,EllipseCurve:H4,LineCurve:gj,LineCurve3:Koe,QuadraticBezierCurve:_j,QuadraticBezierCurve3:vj,SplineCurve:yj});class Zoe extends F_{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new DD[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const a=i[s]-r,o=this.curves[s],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new DD[i.type]().fromJSON(i))}return this}}class LD extends Zoe{constructor(e){super(),this.type="Path",this.currentPoint=new an,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new gj(this.currentPoint.clone(),new an(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new _j(this.currentPoint.clone(),new an(e,t),new an(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,a){const o=new mj(this.currentPoint.clone(),new an(e,t),new an(r,i),new an(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new yj(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,r,i,s,a),this}absarc(e,t,r,i,s,a){return this.absellipse(e,t,r,r,i,s,a),this}ellipse(e,t,r,i,s,a,o,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,r,i,s,a,o,l),this}absellipse(e,t,r,i,s,a,o,l){const c=new H4(e,t,r,i,s,a,o,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class uE extends LD{constructor(e){super(e),this.uuid=Ug(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new LD().fromJSON(i))}return this}}function owe(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=Joe(n,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(r&&(s=hwe(n,e,s,t)),n.length>80*t){o=1/0,l=1/0;let u=-1/0,f=-1/0;for(let h=t;h<i;h+=t){const g=n[h],p=n[h+1];g<o&&(o=g),p<l&&(l=p),g>u&&(u=g),p>f&&(f=p)}c=Math.max(u-o,f-l),c=c!==0?32767/c:0}return aO(s,a,t,o,l,c,0),a}function Joe(n,e,t,r,i){let s;if(i===xwe(n,e,t,r)>0)for(let a=e;a<t;a+=r)s=CW(a/r|0,n[a],n[a+1],s);else for(let a=t-r;a>=e;a-=r)s=CW(a/r|0,n[a],n[a+1],s);return s&&nw(s,s.next)&&(lO(s),s=s.next),s}function TE(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(nw(t,t.next)||qc(t.prev,t,t.next)===0)){if(lO(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function aO(n,e,t,r,i,s,a){if(!n)return;!a&&s&&_we(n,r,i,s);let o=n;for(;n.prev!==n.next;){const l=n.prev,c=n.next;if(s?cwe(n,r,i,s):lwe(n)){e.push(l.i,n.i,c.i),lO(n),n=c.next,o=c.next;continue}if(n=c,n===o){a?a===1?(n=uwe(TE(n),e),aO(n,e,t,r,i,s,2)):a===2&&fwe(n,e,t,r,i,s):aO(TE(n),e,t,r,i,s,1);break}}}function lwe(n){const e=n.prev,t=n,r=n.next;if(qc(e,t,r)>=0)return!1;const i=e.x,s=t.x,a=r.x,o=e.y,l=t.y,c=r.y,u=Math.min(i,s,a),f=Math.min(o,l,c),h=Math.max(i,s,a),g=Math.max(o,l,c);let p=r.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=f&&p.y<=g&&d2(i,o,s,l,a,c,p.x,p.y)&&qc(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function cwe(n,e,t,r){const i=n.prev,s=n,a=n.next;if(qc(i,s,a)>=0)return!1;const o=i.x,l=s.x,c=a.x,u=i.y,f=s.y,h=a.y,g=Math.min(o,l,c),p=Math.min(u,f,h),_=Math.max(o,l,c),y=Math.max(u,f,h),v=I7(g,p,e,t,r),x=I7(_,y,e,t,r);let E=n.prevZ,M=n.nextZ;for(;E&&E.z>=v&&M&&M.z<=x;){if(E.x>=g&&E.x<=_&&E.y>=p&&E.y<=y&&E!==i&&E!==a&&d2(o,u,l,f,c,h,E.x,E.y)&&qc(E.prev,E,E.next)>=0||(E=E.prevZ,M.x>=g&&M.x<=_&&M.y>=p&&M.y<=y&&M!==i&&M!==a&&d2(o,u,l,f,c,h,M.x,M.y)&&qc(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;E&&E.z>=v;){if(E.x>=g&&E.x<=_&&E.y>=p&&E.y<=y&&E!==i&&E!==a&&d2(o,u,l,f,c,h,E.x,E.y)&&qc(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;M&&M.z<=x;){if(M.x>=g&&M.x<=_&&M.y>=p&&M.y<=y&&M!==i&&M!==a&&d2(o,u,l,f,c,h,M.x,M.y)&&qc(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function uwe(n,e){let t=n;do{const r=t.prev,i=t.next.next;!nw(r,i)&&ele(r,t,t.next,i)&&oO(r,i)&&oO(i,r)&&(e.push(r.i,t.i,i.i),lO(t),lO(t.next),t=n=i),t=t.next}while(t!==n);return TE(t)}function fwe(n,e,t,r,i,s){let a=n;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&bwe(a,o)){let l=tle(a,o);a=TE(a,a.next),l=TE(l,l.next),aO(a,e,t,r,i,s,0),aO(l,e,t,r,i,s,0);return}o=o.next}a=a.next}while(a!==n)}function hwe(n,e,t,r){const i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*r,l=s<a-1?e[s+1]*r:n.length,c=Joe(n,o,l,r,!1);c===c.next&&(c.steiner=!0),i.push(ywe(c))}i.sort(dwe);for(let s=0;s<i.length;s++)t=pwe(i[s],t);return t}function dwe(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=r-i}return t}function pwe(n,e){const t=mwe(n,e);if(!t)return e;const r=tle(t,n);return TE(r,r.next),TE(t,t.next)}function mwe(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,a;if(nw(n,t))return t;do{if(nw(n,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=r&&f>s&&(s=f,a=t.x<t.next.x?t:t.next,f===r))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;t=a;do{if(r>=t.x&&t.x>=l&&r!==t.x&&Qoe(i<c?r:s,i,l,c,i<c?s:r,i,t.x,t.y)){const f=Math.abs(i-t.y)/(r-t.x);oO(t,n)&&(f<u||f===u&&(t.x>a.x||t.x===a.x&&gwe(a,t)))&&(a=t,u=f)}t=t.next}while(t!==o);return a}function gwe(n,e){return qc(n.prev,n,e.prev)<0&&qc(e.next,n,n.next)<0}function _we(n,e,t,r){let i=n;do i.z===0&&(i.z=I7(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,vwe(i)}function vwe(n){let e,t=1;do{let r=n,i;n=null;let s=null;for(e=0;r;){e++;let a=r,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=a}s.nextZ=null,t*=2}while(e>1);return n}function I7(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function ywe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Qoe(n,e,t,r,i,s,a,o){return(i-a)*(e-o)>=(n-a)*(s-o)&&(n-a)*(r-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(i-a)*(r-o)}function d2(n,e,t,r,i,s,a,o){return!(n===a&&e===o)&&Qoe(n,e,t,r,i,s,a,o)}function bwe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Swe(n,e)&&(oO(n,e)&&oO(e,n)&&Ewe(n,e)&&(qc(n.prev,n,e.prev)||qc(n,e.prev,e))||nw(n,e)&&qc(n.prev,n,n.next)>0&&qc(e.prev,e,e.next)>0)}function qc(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function nw(n,e){return n.x===e.x&&n.y===e.y}function ele(n,e,t,r){const i=II(qc(n,e,t)),s=II(qc(n,e,r)),a=II(qc(t,r,n)),o=II(qc(t,r,e));return!!(i!==s&&a!==o||i===0&&kI(n,t,e)||s===0&&kI(n,r,e)||a===0&&kI(t,n,r)||o===0&&kI(t,e,r))}function kI(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function II(n){return n>0?1:n<0?-1:0}function Swe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&ele(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function oO(n,e){return qc(n.prev,n,n.next)<0?qc(n,e,n.next)>=0&&qc(n,n.prev,e)>=0:qc(n,e,n.prev)<0||qc(n,n.next,e)<0}function Ewe(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function tle(n,e){const t=N7(n.i,n.x,n.y),r=N7(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function CW(n,e,t,r){const i=N7(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function lO(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function N7(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function xwe(n,e,t,r){let i=0;for(let s=e,a=t-r;s<t;s+=r)i+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return i}class Twe{static triangulate(e,t,r=2){return owe(e,t,r)}}class R_{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return R_.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];MW(e),OW(r,e);let a=e.length;t.forEach(MW);for(let l=0;l<t.length;l++)i.push(a),a+=t[l].length,OW(r,t[l]);const o=Twe.triangulate(r,i);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function MW(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function OW(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class q4 extends ns{constructor(e=new uE([new an(.5,.5),new an(-.5,.5),new an(-.5,-.5),new an(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new Ir(i,3)),this.setAttribute("uv",new Ir(s,2)),this.computeVertexNormals();function a(o){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,g=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:g-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3;const v=t.extrudePath,x=t.UVGenerator!==void 0?t.UVGenerator:wwe;let E,M=!1,k,N,I,D;v&&(E=v.getSpacedPoints(u),M=!0,h=!1,k=v.computeFrenetFrames(u,!1),N=new ut,I=new ut,D=new ut),h||(y=0,g=0,p=0,_=0);const V=o.extractPoints(c);let G=V.shape;const J=V.holes;if(!R_.isClockWise(G)){G=G.reverse();for(let oe=0,Ue=J.length;oe<Ue;oe++){const Ge=J[oe];R_.isClockWise(Ge)&&(J[oe]=Ge.reverse())}}function $(oe){const Ge=10000000000000001e-36;let ze=oe[0];for(let Be=1;Be<=oe.length;Be++){const me=Be%oe.length,Se=oe[me],ke=Se.x-ze.x,be=Se.y-ze.y,Ke=ke*ke+be*be,ot=Math.max(Math.abs(Se.x),Math.abs(Se.y),Math.abs(ze.x),Math.abs(ze.y)),lt=Ge*ot*ot;if(Ke<=lt){oe.splice(me,1),Be--;continue}ze=Se}}$(G),J.forEach($);const U=J.length,Q=G;for(let oe=0;oe<U;oe++){const Ue=J[oe];G=G.concat(Ue)}function W(oe,Ue,Ge){return Ue||console.error("THREE.ExtrudeGeometry: vec does not exist"),oe.clone().addScaledVector(Ue,Ge)}const q=G.length;function Y(oe,Ue,Ge){let ze,Be,me;const Se=oe.x-Ue.x,ke=oe.y-Ue.y,be=Ge.x-oe.x,Ke=Ge.y-oe.y,ot=Se*Se+ke*ke,lt=Se*Ke-ke*be;if(Math.abs(lt)>Number.EPSILON){const ct=Math.sqrt(ot),Vt=Math.sqrt(be*be+Ke*Ke),Ot=Ue.x-ke/ct,Ut=Ue.y+Se/ct,je=Ge.x-Ke/Vt,ge=Ge.y+be/Vt,se=((je-Ot)*Ke-(ge-Ut)*be)/(Se*Ke-ke*be);ze=Ot+Se*se-oe.x,Be=Ut+ke*se-oe.y;const _e=ze*ze+Be*Be;if(_e<=2)return new an(ze,Be);me=Math.sqrt(_e/2)}else{let ct=!1;Se>Number.EPSILON?be>Number.EPSILON&&(ct=!0):Se<-Number.EPSILON?be<-Number.EPSILON&&(ct=!0):Math.sign(ke)===Math.sign(Ke)&&(ct=!0),ct?(ze=-ke,Be=Se,me=Math.sqrt(ot)):(ze=Se,Be=ke,me=Math.sqrt(ot/2))}return new an(ze/me,Be/me)}const ae=[];for(let oe=0,Ue=Q.length,Ge=Ue-1,ze=oe+1;oe<Ue;oe++,Ge++,ze++)Ge===Ue&&(Ge=0),ze===Ue&&(ze=0),ae[oe]=Y(Q[oe],Q[Ge],Q[ze]);const Z=[];let K,ne=ae.concat();for(let oe=0,Ue=U;oe<Ue;oe++){const Ge=J[oe];K=[];for(let ze=0,Be=Ge.length,me=Be-1,Se=ze+1;ze<Be;ze++,me++,Se++)me===Be&&(me=0),Se===Be&&(Se=0),K[ze]=Y(Ge[ze],Ge[me],Ge[Se]);Z.push(K),ne=ne.concat(K)}let le;if(y===0)le=R_.triangulateShape(Q,J);else{const oe=[],Ue=[];for(let Ge=0;Ge<y;Ge++){const ze=Ge/y,Be=g*Math.cos(ze*Math.PI/2),me=p*Math.sin(ze*Math.PI/2)+_;for(let Se=0,ke=Q.length;Se<ke;Se++){const be=W(Q[Se],ae[Se],me);Ae(be.x,be.y,-Be),ze===0&&oe.push(be)}for(let Se=0,ke=U;Se<ke;Se++){const be=J[Se];K=Z[Se];const Ke=[];for(let ot=0,lt=be.length;ot<lt;ot++){const ct=W(be[ot],K[ot],me);Ae(ct.x,ct.y,-Be),ze===0&&Ke.push(ct)}ze===0&&Ue.push(Ke)}}le=R_.triangulateShape(oe,Ue)}const ce=le.length,de=p+_;for(let oe=0;oe<q;oe++){const Ue=h?W(G[oe],ne[oe],de):G[oe];M?(I.copy(k.normals[0]).multiplyScalar(Ue.x),N.copy(k.binormals[0]).multiplyScalar(Ue.y),D.copy(E[0]).add(I).add(N),Ae(D.x,D.y,D.z)):Ae(Ue.x,Ue.y,0)}for(let oe=1;oe<=u;oe++)for(let Ue=0;Ue<q;Ue++){const Ge=h?W(G[Ue],ne[Ue],de):G[Ue];M?(I.copy(k.normals[oe]).multiplyScalar(Ge.x),N.copy(k.binormals[oe]).multiplyScalar(Ge.y),D.copy(E[oe]).add(I).add(N),Ae(D.x,D.y,D.z)):Ae(Ge.x,Ge.y,f/u*oe)}for(let oe=y-1;oe>=0;oe--){const Ue=oe/y,Ge=g*Math.cos(Ue*Math.PI/2),ze=p*Math.sin(Ue*Math.PI/2)+_;for(let Be=0,me=Q.length;Be<me;Be++){const Se=W(Q[Be],ae[Be],ze);Ae(Se.x,Se.y,f+Ge)}for(let Be=0,me=J.length;Be<me;Be++){const Se=J[Be];K=Z[Be];for(let ke=0,be=Se.length;ke<be;ke++){const Ke=W(Se[ke],K[ke],ze);M?Ae(Ke.x,Ke.y+E[u-1].y,E[u-1].x+Ge):Ae(Ke.x,Ke.y,f+Ge)}}}Me(),qe();function Me(){const oe=i.length/3;if(h){let Ue=0,Ge=q*Ue;for(let ze=0;ze<ce;ze++){const Be=le[ze];Xe(Be[2]+Ge,Be[1]+Ge,Be[0]+Ge)}Ue=u+y*2,Ge=q*Ue;for(let ze=0;ze<ce;ze++){const Be=le[ze];Xe(Be[0]+Ge,Be[1]+Ge,Be[2]+Ge)}}else{for(let Ue=0;Ue<ce;Ue++){const Ge=le[Ue];Xe(Ge[2],Ge[1],Ge[0])}for(let Ue=0;Ue<ce;Ue++){const Ge=le[Ue];Xe(Ge[0]+q*u,Ge[1]+q*u,Ge[2]+q*u)}}r.addGroup(oe,i.length/3-oe,0)}function qe(){const oe=i.length/3;let Ue=0;Ne(Q,Ue),Ue+=Q.length;for(let Ge=0,ze=J.length;Ge<ze;Ge++){const Be=J[Ge];Ne(Be,Ue),Ue+=Be.length}r.addGroup(oe,i.length/3-oe,1)}function Ne(oe,Ue){let Ge=oe.length;for(;--Ge>=0;){const ze=Ge;let Be=Ge-1;Be<0&&(Be=oe.length-1);for(let me=0,Se=u+y*2;me<Se;me++){const ke=q*me,be=q*(me+1),Ke=Ue+ze+ke,ot=Ue+Be+ke,lt=Ue+Be+be,ct=Ue+ze+be;$e(Ke,ot,lt,ct)}}}function Ae(oe,Ue,Ge){l.push(oe),l.push(Ue),l.push(Ge)}function Xe(oe,Ue,Ge){at(oe),at(Ue),at(Ge);const ze=i.length/3,Be=x.generateTopUV(r,i,ze-3,ze-2,ze-1);pt(Be[0]),pt(Be[1]),pt(Be[2])}function $e(oe,Ue,Ge,ze){at(oe),at(Ue),at(ze),at(Ue),at(Ge),at(ze);const Be=i.length/3,me=x.generateSideWallUV(r,i,Be-6,Be-3,Be-2,Be-1);pt(me[0]),pt(me[1]),pt(me[3]),pt(me[1]),pt(me[2]),pt(me[3])}function at(oe){i.push(l[oe*3+0]),i.push(l[oe*3+1]),i.push(l[oe*3+2])}function pt(oe){s.push(oe.x),s.push(oe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return Rwe(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];r.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new DD[i.type]().fromJSON(i)),new q4(r,e.options)}}const wwe={generateTopUV:function(n,e,t,r,i){const s=e[t*3],a=e[t*3+1],o=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new an(s,a),new an(o,l),new an(c,u)]},generateSideWallUV:function(n,e,t,r,i,s){const a=e[t*3],o=e[t*3+1],l=e[t*3+2],c=e[r*3],u=e[r*3+1],f=e[r*3+2],h=e[i*3],g=e[i*3+1],p=e[i*3+2],_=e[s*3],y=e[s*3+1],v=e[s*3+2];return Math.abs(o-u)<Math.abs(a-c)?[new an(a,1-l),new an(c,1-f),new an(h,1-p),new an(_,1-v)]:[new an(o,1-l),new an(u,1-f),new an(g,1-p),new an(y,1-v)]}};function Rwe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class V4 extends $1{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new V4(e.radius,e.detail)}}class G4 extends ns{constructor(e=[new an(0,-.5),new an(.5,0),new an(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Wi(i,0,Math.PI*2);const s=[],a=[],o=[],l=[],c=[],u=1/t,f=new ut,h=new an,g=new ut,p=new ut,_=new ut;let y=0,v=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:y=e[x+1].x-e[x].x,v=e[x+1].y-e[x].y,g.x=v*1,g.y=-y,g.z=v*0,_.copy(g),g.normalize(),l.push(g.x,g.y,g.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:y=e[x+1].x-e[x].x,v=e[x+1].y-e[x].y,g.x=v*1,g.y=-y,g.z=v*0,p.copy(g),g.x+=_.x,g.y+=_.y,g.z+=_.z,g.normalize(),l.push(g.x,g.y,g.z),_.copy(p)}for(let x=0;x<=t;x++){const E=r+x*u*i,M=Math.sin(E),k=Math.cos(E);for(let N=0;N<=e.length-1;N++){f.x=e[N].x*M,f.y=e[N].y,f.z=e[N].x*k,a.push(f.x,f.y,f.z),h.x=x/t,h.y=N/(e.length-1),o.push(h.x,h.y);const I=l[3*N+0]*M,D=l[3*N+1],V=l[3*N+0]*k;c.push(I,D,V)}}for(let x=0;x<t;x++)for(let E=0;E<e.length-1;E++){const M=E+x*e.length,k=M,N=M+e.length,I=M+e.length+1,D=M+1;s.push(k,N,D),s.push(I,D,N)}this.setIndex(s),this.setAttribute("position",new Ir(a,3)),this.setAttribute("uv",new Ir(o,2)),this.setAttribute("normal",new Ir(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new G4(e.points,e.segments,e.phiStart,e.phiLength)}}class Sk extends $1{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Sk(e.radius,e.detail)}}class Yw extends ns{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),l=Math.floor(i),c=o+1,u=l+1,f=e/o,h=t/l,g=[],p=[],_=[],y=[];for(let v=0;v<u;v++){const x=v*h-a;for(let E=0;E<c;E++){const M=E*f-s;p.push(M,-x,0),_.push(0,0,1),y.push(E/o),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let x=0;x<o;x++){const E=x+c*v,M=x+c*(v+1),k=x+1+c*(v+1),N=x+1+c*v;g.push(E,M,N),g.push(M,k,N)}this.setIndex(g),this.setAttribute("position",new Ir(p,3)),this.setAttribute("normal",new Ir(_,3)),this.setAttribute("uv",new Ir(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yw(e.width,e.height,e.widthSegments,e.heightSegments)}}class $4 extends ns{constructor(e=.5,t=1,r=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:a},r=Math.max(3,r),i=Math.max(1,i);const o=[],l=[],c=[],u=[];let f=e;const h=(t-e)/i,g=new ut,p=new an;for(let _=0;_<=i;_++){for(let y=0;y<=r;y++){const v=s+y/r*a;g.x=f*Math.cos(v),g.y=f*Math.sin(v),l.push(g.x,g.y,g.z),c.push(0,0,1),p.x=(g.x/t+1)/2,p.y=(g.y/t+1)/2,u.push(p.x,p.y)}f+=h}for(let _=0;_<i;_++){const y=_*(r+1);for(let v=0;v<r;v++){const x=v+y,E=x,M=x+r+1,k=x+r+2,N=x+1;o.push(E,M,N),o.push(M,k,N)}}this.setIndex(o),this.setAttribute("position",new Ir(l,3)),this.setAttribute("normal",new Ir(c,3)),this.setAttribute("uv",new Ir(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $4(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class W4 extends ns{constructor(e=new uE([new an(0,.5),new an(-.5,-.5),new an(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(o,l,u),o+=l,l=0;this.setIndex(r),this.setAttribute("position",new Ir(i,3)),this.setAttribute("normal",new Ir(s,3)),this.setAttribute("uv",new Ir(a,2));function c(u){const f=i.length/3,h=u.extractPoints(t);let g=h.shape;const p=h.holes;R_.isClockWise(g)===!1&&(g=g.reverse());for(let y=0,v=p.length;y<v;y++){const x=p[y];R_.isClockWise(x)===!0&&(p[y]=x.reverse())}const _=R_.triangulateShape(g,p);for(let y=0,v=p.length;y<v;y++){const x=p[y];g=g.concat(x)}for(let y=0,v=g.length;y<v;y++){const x=g[y];i.push(x.x,x.y,0),s.push(0,0,1),a.push(x.x,x.y)}for(let y=0,v=_.length;y<v;y++){const x=_[y],E=x[0]+f,M=x[1]+f,k=x[2]+f;r.push(E,M,k),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Awe(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];r.push(a)}return new W4(r,e.curveSegments)}}function Awe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class Ek extends ns{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(a+o,Math.PI);let c=0;const u=[],f=new ut,h=new ut,g=[],p=[],_=[],y=[];for(let v=0;v<=r;v++){const x=[],E=v/r;let M=0;v===0&&a===0?M=.5/t:v===r&&l===Math.PI&&(M=-.5/t);for(let k=0;k<=t;k++){const N=k/t;f.x=-e*Math.cos(i+N*s)*Math.sin(a+E*o),f.y=e*Math.cos(a+E*o),f.z=e*Math.sin(i+N*s)*Math.sin(a+E*o),p.push(f.x,f.y,f.z),h.copy(f).normalize(),_.push(h.x,h.y,h.z),y.push(N+M,1-E),x.push(c++)}u.push(x)}for(let v=0;v<r;v++)for(let x=0;x<t;x++){const E=u[v][x+1],M=u[v][x],k=u[v+1][x],N=u[v+1][x+1];(v!==0||a>0)&&g.push(E,M,N),(v!==r-1||l<Math.PI)&&g.push(M,k,N)}this.setIndex(g),this.setAttribute("position",new Ir(p,3)),this.setAttribute("normal",new Ir(_,3)),this.setAttribute("uv",new Ir(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ek(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Y4 extends $1{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Y4(e.radius,e.detail)}}class X4 extends ns{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],l=[],c=[],u=new ut,f=new ut,h=new ut;for(let g=0;g<=r;g++)for(let p=0;p<=i;p++){const _=p/i*s,y=g/r*Math.PI*2;f.x=(e+t*Math.cos(y))*Math.cos(_),f.y=(e+t*Math.cos(y))*Math.sin(_),f.z=t*Math.sin(y),o.push(f.x,f.y,f.z),u.x=e*Math.cos(_),u.y=e*Math.sin(_),h.subVectors(f,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/i),c.push(g/r)}for(let g=1;g<=r;g++)for(let p=1;p<=i;p++){const _=(i+1)*g+p-1,y=(i+1)*(g-1)+p-1,v=(i+1)*(g-1)+p,x=(i+1)*g+p;a.push(_,y,x),a.push(y,v,x)}this.setIndex(a),this.setAttribute("position",new Ir(o,3)),this.setAttribute("normal",new Ir(l,3)),this.setAttribute("uv",new Ir(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new X4(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class K4 extends ns{constructor(e=1,t=.4,r=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:a},r=Math.floor(r),i=Math.floor(i);const o=[],l=[],c=[],u=[],f=new ut,h=new ut,g=new ut,p=new ut,_=new ut,y=new ut,v=new ut;for(let E=0;E<=r;++E){const M=E/r*s*Math.PI*2;x(M,s,a,e,g),x(M+.01,s,a,e,p),y.subVectors(p,g),v.addVectors(p,g),_.crossVectors(y,v),v.crossVectors(_,y),_.normalize(),v.normalize();for(let k=0;k<=i;++k){const N=k/i*Math.PI*2,I=-t*Math.cos(N),D=t*Math.sin(N);f.x=g.x+(I*v.x+D*_.x),f.y=g.y+(I*v.y+D*_.y),f.z=g.z+(I*v.z+D*_.z),l.push(f.x,f.y,f.z),h.subVectors(f,g).normalize(),c.push(h.x,h.y,h.z),u.push(E/r),u.push(k/i)}}for(let E=1;E<=r;E++)for(let M=1;M<=i;M++){const k=(i+1)*(E-1)+(M-1),N=(i+1)*E+(M-1),I=(i+1)*E+M,D=(i+1)*(E-1)+M;o.push(k,N,D),o.push(N,I,D)}this.setIndex(o),this.setAttribute("position",new Ir(l,3)),this.setAttribute("normal",new Ir(c,3)),this.setAttribute("uv",new Ir(u,2));function x(E,M,k,N,I){const D=Math.cos(E),V=Math.sin(E),G=k/M*E,J=Math.cos(G);I.x=N*(2+J)*.5*D,I.y=N*(2+J)*V*.5,I.z=N*Math.sin(G)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new K4(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Z4 extends ns{constructor(e=new vj(new ut(-1,-1,0),new ut(-1,1,0),new ut(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new ut,l=new ut,c=new an;let u=new ut;const f=[],h=[],g=[],p=[];_(),this.setIndex(p),this.setAttribute("position",new Ir(f,3)),this.setAttribute("normal",new Ir(h,3)),this.setAttribute("uv",new Ir(g,2));function _(){for(let E=0;E<t;E++)y(E);y(s===!1?t:0),x(),v()}function y(E){u=e.getPointAt(E/t,u);const M=a.normals[E],k=a.binormals[E];for(let N=0;N<=i;N++){const I=N/i*Math.PI*2,D=Math.sin(I),V=-Math.cos(I);l.x=V*M.x+D*k.x,l.y=V*M.y+D*k.y,l.z=V*M.z+D*k.z,l.normalize(),h.push(l.x,l.y,l.z),o.x=u.x+r*l.x,o.y=u.y+r*l.y,o.z=u.z+r*l.z,f.push(o.x,o.y,o.z)}}function v(){for(let E=1;E<=t;E++)for(let M=1;M<=i;M++){const k=(i+1)*(E-1)+(M-1),N=(i+1)*E+(M-1),I=(i+1)*E+M,D=(i+1)*(E-1)+M;p.push(k,N,D),p.push(N,I,D)}}function x(){for(let E=0;E<=t;E++)for(let M=0;M<=i;M++)c.x=E/t,c.y=M/i,g.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Z4(new DD[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nle extends ns{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new ut,s=new ut;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const f=l[c],h=f.start,g=f.count;for(let p=h,_=h+g;p<_;p+=3)for(let y=0;y<3;y++){const v=o.getX(p+y),x=o.getX(p+(y+1)%3);i.fromBufferAttribute(a,v),s.fromBufferAttribute(a,x),kW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const u=3*o+c,f=3*o+(c+1)%3;i.fromBufferAttribute(a,u),s.fromBufferAttribute(a,f),kW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ir(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function kW(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var IW=Object.freeze({__proto__:null,BoxGeometry:ZE,CapsuleGeometry:F4,CircleGeometry:z4,ConeGeometry:bk,CylinderGeometry:yk,DodecahedronGeometry:j4,EdgesGeometry:$oe,ExtrudeGeometry:q4,IcosahedronGeometry:V4,LatheGeometry:G4,OctahedronGeometry:Sk,PlaneGeometry:Yw,PolyhedronGeometry:$1,RingGeometry:$4,ShapeGeometry:W4,SphereGeometry:Ek,TetrahedronGeometry:Y4,TorusGeometry:X4,TorusKnotGeometry:K4,TubeGeometry:Z4,WireframeGeometry:nle});class rle extends nh{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new cr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class ile extends Vl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class bj extends nh{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new cr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class sle extends bj{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new an(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new cr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new cr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new cr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class ale extends nh{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new cr(16777215),this.specular=new cr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=dk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ole extends nh{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new cr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class lle extends nh{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class cle extends nh{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Bm,this.combine=dk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Sj extends nh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=q1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Ej extends nh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class ule extends nh{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new cr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=V1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fle extends qp{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function tE(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function hle(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function dle(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function P7(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,a=0;a!==r;++s){const o=t[s]*e;for(let l=0;l!==e;++l)i[a++]=n[o+l]}return i}function xj(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(e.push(s.time),t.push(...a)),s=n[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do a=s[r],a!==void 0&&(e.push(s.time),t.push(a)),s=n[i++];while(s!==void 0)}function Cwe(n,e,t,r,i=30){const s=n.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),f=[],h=[];for(let g=0;g<c.times.length;++g){const p=c.times[g]*i;if(!(p<t||p>=r)){f.push(c.times[g]);for(let _=0;_<u;++_)h.push(c.values[g*u+_])}}f.length!==0&&(c.times=tE(f,c.times.constructor),c.values=tE(h,c.values.constructor),a.push(c))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function Mwe(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let a=0;a<i;++a){const o=t.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(v){return v.name===o.name&&v.ValueTypeName===l});if(c===void 0)continue;let u=0;const f=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let h=0;const g=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=g/3);const p=o.times.length-1;let _;if(s<=o.times[0]){const v=u,x=f-u;_=o.values.slice(v,x)}else if(s>=o.times[p]){const v=p*f+u,x=v+f-u;_=o.values.slice(v,x)}else{const v=o.createInterpolant(),x=u,E=f-u;v.evaluate(s),_=v.resultBuffer.slice(x,E)}l==="quaternion"&&new zp().fromArray(_).normalize().conjugate().toArray(_);const y=c.times.length;for(let v=0;v<y;++v){const x=v*g+h;if(l==="quaternion")zp.multiplyQuaternionsFlat(c.values,x,_,0,c.values,x);else{const E=g-h*2;for(let M=0;M<E;++M)c.values[x+M]-=_[M]}}}return n.blendMode=aj,n}class Owe{static convertArray(e,t){return tE(e,t)}static isTypedArray(e){return hle(e)}static getKeyframeOrder(e){return dle(e)}static sortedArray(e,t,r){return P7(e,t,r)}static flattenJSON(e,t,r,i){xj(e,t,r,i)}static subclip(e,t,r,i,s=30){return Cwe(e,t,r,i,s)}static makeClipAdditive(e,t=0,r=e,i=30){return Mwe(e,t,r,i)}}class xk{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let a;n:{r:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(s=i,i=t[++r],e<i)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(r=2,s=o);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}a=r,r=0;break n}break e}for(;r<a;){const o=r+a>>>1;e<t[o]?a=o:r=o+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=r[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ple extends xk{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:JS,endingEnd:JS}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],l=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case QS:s=e,o=2*t-r;break;case tO:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=r}if(l===void 0)switch(this.getSettings_().endingEnd){case QS:a=e,l=2*r-t;break;case tO:a=1,l=r+i[1]-i[0];break;default:a=e-1,l=t}const c=(r-t)*.5,u=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=this._offsetPrev,f=this._offsetNext,h=this._weightPrev,g=this._weightNext,p=(r-t)/(i-t),_=p*p,y=_*p,v=-h*y+2*h*_-h*p,x=(1+h)*y+(-1.5-2*h)*_+(-.5+h)*p+1,E=(-1-g)*y+(1.5+g)*_+.5*p,M=g*y-g*_;for(let k=0;k!==o;++k)s[k]=v*a[u+k]+x*a[c+k]+E*a[l+k]+M*a[f+k];return s}}class Tj extends xk{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=(r-t)/(i-t),f=1-u;for(let h=0;h!==o;++h)s[h]=a[c+h]*f+a[l+h]*u;return s}}class mle extends xk{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Y0{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=tE(t,this.TimeBufferType),this.values=tE(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:tE(e.times,Array),values:tE(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new mle(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Tj(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ple(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case eO:t=this.InterpolantFactoryMethodDiscrete;break;case ID:t=this.InterpolantFactoryMethodLinear;break;case eP:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return eO;case this.InterpolantFactoryMethodLinear:return ID;case this.InterpolantFactoryMethodSmooth:return eP}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,a=i-1;for(;s!==i&&r[s]<e;)++s;for(;a!==-1&&r[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=r[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(i!==void 0&&hle(i))for(let o=0,l=i.length;o!==l;++o){const c=i[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===eP,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const c=e[o],u=e[o+1];if(c!==u&&(o!==1||c!==e[0]))if(i)l=!0;else{const f=o*r,h=f-r,g=f+r;for(let p=0;p!==r;++p){const _=t[f+p];if(_!==t[h+p]||_!==t[g+p]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const f=o*r,h=a*r;for(let g=0;g!==r;++g)t[h+g]=t[f+g]}++a}}if(s>0){e[a]=e[s];for(let o=s*r,l=a*r,c=0;c!==r;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Y0.prototype.ValueTypeName="";Y0.prototype.TimeBufferType=Float32Array;Y0.prototype.ValueBufferType=Float32Array;Y0.prototype.DefaultInterpolation=ID;class JE extends Y0{constructor(e,t,r){super(e,t,r)}}JE.prototype.ValueTypeName="bool";JE.prototype.ValueBufferType=Array;JE.prototype.DefaultInterpolation=eO;JE.prototype.InterpolantFactoryMethodLinear=void 0;JE.prototype.InterpolantFactoryMethodSmooth=void 0;class wj extends Y0{constructor(e,t,r,i){super(e,t,r,i)}}wj.prototype.ValueTypeName="color";class cO extends Y0{constructor(e,t,r,i){super(e,t,r,i)}}cO.prototype.ValueTypeName="number";class gle extends xk{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(r-t)/(i-t);let c=e*o;for(let u=c+o;c!==u;c+=4)zp.slerpFlat(s,0,a,c-o,a,c,l);return s}}class Tk extends Y0{constructor(e,t,r,i){super(e,t,r,i)}InterpolantFactoryMethodLinear(e){return new gle(this.times,this.values,this.getValueSize(),e)}}Tk.prototype.ValueTypeName="quaternion";Tk.prototype.InterpolantFactoryMethodSmooth=void 0;class QE extends Y0{constructor(e,t,r){super(e,t,r)}}QE.prototype.ValueTypeName="string";QE.prototype.ValueBufferType=Array;QE.prototype.DefaultInterpolation=eO;QE.prototype.InterpolantFactoryMethodLinear=void 0;QE.prototype.InterpolantFactoryMethodSmooth=void 0;class uO extends Y0{constructor(e,t,r,i){super(e,t,r,i)}}uO.prototype.ValueTypeName="vector";class fO{constructor(e="",t=-1,r=[],i=O4){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Ug(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)t.push(Iwe(r[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=r.length;s!==a;++s)t.push(Y0.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,a=[];for(let o=0;o<s;o++){let l=[],c=[];l.push((o+s-1)%s,o,(o+1)%s),c.push(0,1,0);const u=dle(l);l=P7(l,1,u),c=P7(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),a.push(new cO(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],u=c.name.match(s);if(u&&u.length>1){const f=u[1];let h=i[f];h||(i[f]=h=[]),h.push(c)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,h,g,p,_){if(g.length!==0){const y=[],v=[];xj(g,y,v,p),y.length!==0&&_.push(new f(h,y,v))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const h=c[f].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const g={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let _=0;_<h[p].morphTargets.length;_++)g[h[p].morphTargets[_]]=-1;for(const _ in g){const y=[],v=[];for(let x=0;x!==h[p].morphTargets.length;++x){const E=h[p];y.push(E.time),v.push(E.morphTarget===_?1:0)}i.push(new cO(".morphTargetInfluence["+_+"]",y,v))}l=g.length*a}else{const g=".bones["+t[f].name+"]";r(uO,g+".position",h,"pos",i),r(Tk,g+".quaternion",h,"rot",i),r(uO,g+".scale",h,"scl",i)}}return i.length===0?null:new this(s,l,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function kwe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cO;case"vector":case"vector2":case"vector3":case"vector4":return uO;case"color":return wj;case"quaternion":return Tk;case"bool":case"boolean":return JE;case"string":return QE}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Iwe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=kwe(n.type);if(n.times===void 0){const t=[],r=[];xj(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Wy={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Rj{constructor(e,t,r){const i=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){o++,s===!1&&i.onStart!==void 0&&i.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,i.onProgress!==void 0&&i.onProgress(u,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,f){return c.push(u,f),this},this.removeHandler=function(u){const f=c.indexOf(u);return f!==-1&&c.splice(f,2),this},this.getHandler=function(u){for(let f=0,h=c.length;f<h;f+=2){const g=c[f],p=c[f+1];if(g.global&&(g.lastIndex=0),g.test(u))return p}return null}}}const _le=new Rj;class Ym{constructor(e){this.manager=e!==void 0?e:_le,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Ym.DEFAULT_MATERIAL_NAME="__DEFAULT";const _y={};class Nwe extends Error{constructor(e,t){super(e),this.response=t}}class cb extends Ym{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Wy.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(_y[e]!==void 0){_y[e].push({onLoad:t,onProgress:r,onError:i});return}_y[e]=[],_y[e].push({onLoad:t,onProgress:r,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=_y[e],f=c.body.getReader(),h=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),g=h?parseInt(h):0,p=g!==0;let _=0;const y=new ReadableStream({start(v){x();function x(){f.read().then(({done:E,value:M})=>{if(E)v.close();else{_+=M.byteLength;const k=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:g});for(let N=0,I=u.length;N<I;N++){const D=u[N];D.onProgress&&D.onProgress(k)}v.enqueue(M),x()}},E=>{v.error(E)})}}});return new Response(y)}else throw new Nwe(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return c.json();default:if(o==="")return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(o),h=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(h);return c.arrayBuffer().then(p=>g.decode(p))}}}).then(c=>{Wy.add(e,c);const u=_y[e];delete _y[e];for(let f=0,h=u.length;f<h;f++){const g=u[f];g.onLoad&&g.onLoad(c)}}).catch(c=>{const u=_y[e];if(u===void 0)throw this.manager.itemError(e),c;delete _y[e];for(let f=0,h=u.length;f<h;f++){const g=u[f];g.onError&&g.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Pwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new cb(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=fO.parse(e[r]);t.push(i)}return t}}class Dwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=[],o=new B4,l=new cb(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(f){l.load(e[f],function(h){const g=s.parse(h,!0);a[f]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},c+=1,c===6&&(g.mipmapCount===1&&(o.minFilter=sc),o.image=a,o.format=g.format,o.needsUpdate=!0,t&&t(o))},r,i)}if(Array.isArray(e))for(let f=0,h=e.length;f<h;++f)u(f);else l.load(e,function(f){const h=s.parse(f,!0);if(h.isCubemap){const g=h.mipmaps.length/h.mipmapCount;for(let p=0;p<g;p++){a[p]={mipmaps:[]};for(let _=0;_<h.mipmapCount;_++)a[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+_]),a[p].format=h.format,a[p].width=h.width,a[p].height=h.height}o.image=a}else o.image.width=h.width,o.image.height=h.height,o.mipmaps=h.mipmaps;h.mipmapCount===1&&(o.minFilter=sc),o.format=h.format,o.needsUpdate=!0,t&&t(o)},r,i);return o}}class hO extends Ym{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Wy.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o=sO("img");function l(){u(),Wy.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(f){u(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class Lwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=new vk;s.colorSpace=na;const a=new hO(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(u){s.images[c]=u,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class Uwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Bg,o=new cb(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:I0,a.wrapT=c.wrapT!==void 0?c.wrapT:I0,a.magFilter=c.magFilter!==void 0?c.magFilter:sc,a.minFilter=c.minFilter!==void 0?c.minFilter:sc,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=Rv),c.mipmapCount===1&&(a.minFilter=sc),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,t&&t(a,c)},r,i),a}}class vle extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=new wc,a=new hO(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class W1 extends ja{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new cr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class yle extends W1{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ja.DEFAULT_UP),this.updateMatrix(),this.groundColor=new cr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const j5=new Qr,NW=new ut,PW=new ut;class Aj{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new an(512,512),this.mapType=ql,this.map=null,this.mapPass=null,this.matrix=new Qr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $w,this._frameExtents=new an(1,1),this._viewportCount=1,this._viewports=[new Ta(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;NW.setFromMatrixPosition(e.matrixWorld),t.position.copy(NW),PW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(PW),t.updateMatrixWorld(),j5.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(j5),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(j5)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Bwe extends Aj{constructor(){super(new yf(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=ZT*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class ble extends W1{constructor(e,t,r=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ja.DEFAULT_UP),this.updateMatrix(),this.target=new ja,this.distance=r,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Bwe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const DW=new Qr,GR=new ut,H5=new ut;class Fwe extends Aj{constructor(){super(new yf(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new an(4,2),this._viewportCount=6,this._viewports=[new Ta(2,1,1,1),new Ta(0,1,1,1),new Ta(3,1,1,1),new Ta(1,1,1,1),new Ta(3,0,1,1),new Ta(1,0,1,1)],this._cubeDirections=[new ut(1,0,0),new ut(-1,0,0),new ut(0,0,1),new ut(0,0,-1),new ut(0,1,0),new ut(0,-1,0)],this._cubeUps=[new ut(0,1,0),new ut(0,1,0),new ut(0,1,0),new ut(0,1,0),new ut(0,0,1),new ut(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),GR.setFromMatrixPosition(e.matrixWorld),r.position.copy(GR),H5.copy(r.position),H5.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(H5),r.updateMatrixWorld(),i.makeTranslation(-GR.x,-GR.y,-GR.z),DW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(DW)}}class Sle extends W1{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Fwe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let wk=class extends _k{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};class zwe extends Aj{constructor(){super(new wk(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Ele extends W1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ja.DEFAULT_UP),this.updateMatrix(),this.target=new ja,this.shadow=new zwe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xle extends W1{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Tle extends W1{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class wle{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ut)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],1.092548*(r*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(r*s)),t.addScaledVector(a[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*r),t.addScaledVector(a[4],2*.429043*r*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*r*s),t.addScaledVector(a[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class Rle extends W1{constructor(e=new wle,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class J4 extends Ym{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,a=new cb(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new cr().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=r(a.value);break;case"c":i.uniforms[s].value=new cr().setHex(a.value);break;case"v2":i.uniforms[s].value=new an().fromArray(a.value);break;case"v3":i.uniforms[s].value=new ut().fromArray(a.value);break;case"v4":i.uniforms[s].value=new Ta().fromArray(a.value);break;case"m3":i.uniforms[s].value=new es().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Qr().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new an().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new an().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return J4.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:rle,SpriteMaterial:fj,RawShaderMaterial:ile,ShaderMaterial:Vl,PointsMaterial:dj,MeshPhysicalMaterial:sle,MeshStandardMaterial:bj,MeshPhongMaterial:ale,MeshToonMaterial:ole,MeshNormalMaterial:lle,MeshLambertMaterial:cle,MeshDepthMaterial:Sj,MeshDistanceMaterial:Ej,MeshBasicMaterial:G1,MeshMatcapMaterial:ule,LineDashedMaterial:fle,LineBasicMaterial:qp,Material:nh};return new t[e]}}class D7{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Ale extends ns{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Cle extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new cb(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(g,p){if(t[p]!==void 0)return t[p];const y=g.interleavedBuffers[p],v=s(g,y.buffer),x=xT(y.type,v),E=new D4(x,y.stride);return E.uuid=y.uuid,t[p]=E,E}function s(g,p){if(r[p]!==void 0)return r[p];const y=g.arrayBuffers[p],v=new Uint32Array(y).buffer;return r[p]=v,v}const a=e.isInstancedBufferGeometry?new Ale:new ns,o=e.data.index;if(o!==void 0){const g=xT(o.type,o.array);a.setIndex(new Ds(g,1))}const l=e.data.attributes;for(const g in l){const p=l[g];let _;if(p.isInterleavedBufferAttribute){const y=i(e.data,p.data);_=new xE(y,p.itemSize,p.offset,p.normalized)}else{const y=xT(p.type,p.array),v=p.isInstancedBufferAttribute?tw:Ds;_=new v(y,p.itemSize,p.normalized)}p.name!==void 0&&(_.name=p.name),p.usage!==void 0&&_.setUsage(p.usage),a.setAttribute(g,_)}const c=e.data.morphAttributes;if(c)for(const g in c){const p=c[g],_=[];for(let y=0,v=p.length;y<v;y++){const x=p[y];let E;if(x.isInterleavedBufferAttribute){const M=i(e.data,x.data);E=new xE(M,x.itemSize,x.offset,x.normalized)}else{const M=xT(x.type,x.array);E=new Ds(M,x.itemSize,x.normalized)}x.name!==void 0&&(E.name=x.name),_.push(E)}a.morphAttributes[g]=_}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let g=0,p=f.length;g!==p;++g){const _=f[g];a.addGroup(_.start,_.count,_.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const g=new ut;h.center!==void 0&&g.fromArray(h.center),a.boundingSphere=new xd(g,h.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class jwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=this.path===""?D7.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new cb(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?D7.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new cb(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(o)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),t!==void 0){let f=!1;for(const h in a)if(a[h].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,o,a,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new uE().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new L4().fromJSON(e[s],i);r[o.uuid]=o}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new Cle;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(l);break;default:l.type in IW?o=IW[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),r[l.uuid]=o}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new J4;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const l=e[a];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=fO.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function a(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return a(u)}else return l.data?{data:xT(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new Rj(t);s=new hO(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const f=e[c],h=f.url;if(Array.isArray(h)){const g=[];for(let p=0,_=h.length;p<_;p++){const y=h[p],v=o(y);v!==null&&(v instanceof HTMLImageElement?g.push(v):g.push(new Bg(v.data,v.width,v.height)))}i[f.uuid]=new p1(g)}else{const g=o(f.url);i[f.uuid]=new p1(g)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await i.loadAsync(l)}else return a.data?{data:xT(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new hO(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const u=[];for(let f=0,h=c.length;f<h;f++){const g=c[f],p=await s(g);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Bg(p.data,p.width,p.height)))}r[l.uuid]=new p1(u)}else{const u=await s(l.url);r[l.uuid]=new p1(u)}}}return r}parseTextures(e,t){function r(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const l=t[o.image],c=l.data;let u;Array.isArray(c)?(u=new vk,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Bg:u=new wc,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=r(o.mapping,Hwe)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=r(o.wrap[0],LW),u.wrapT=r(o.wrap[1],LW)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=r(o.minFilter,UW)),o.magFilter!==void 0&&(u.magFilter=r(o.magFilter,UW)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),i[o.uuid]=u}return i}parseObject(e,t,r,i,s){let a;function o(h){return t[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const g=[];for(let p=0,_=h.length;p<_;p++){const y=h[p];r[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),g.push(r[y])}return g}return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),r[h]}}function c(h){return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),i[h]}let u,f;switch(e.type){case"Scene":a=new ew,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new cr(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new P4(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new N4(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new yf(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new wk(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new xle(e.color,e.intensity);break;case"DirectionalLight":a=new Ele(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new Sle(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Tle(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new ble(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new yle(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new Rle().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),f=l(e.material),a=new Foe(u,f),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),f=l(e.material),a=new bu(u,f);break;case"InstancedMesh":u=o(e.geometry),f=l(e.material);const h=e.count,g=e.instanceMatrix,p=e.instanceColor;a=new zoe(u,f,h),a.instanceMatrix=new tw(new Float32Array(g.array),16),p!==void 0&&(a.instanceColor=new tw(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),f=l(e.material),a=new joe(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,f),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(_=>{let y=null,v=null;return _.boundingBox!==void 0&&(y=new Zd,y.min.fromArray(_.boundingBox.min),y.max.fromArray(_.boundingBox.max)),_.boundingSphere!==void 0&&(v=new xd,v.radius=_.boundingSphere.radius,v.center.fromArray(_.boundingSphere.center)),{..._,boundingBox:y,boundingSphere:v}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new xd,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new Zd,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new Boe;break;case"Line":a=new M1(o(e.geometry),l(e.material));break;case"LineLoop":a=new Hoe(o(e.geometry),l(e.material));break;case"LineSegments":a=new Kv(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new qoe(o(e.geometry),l(e.material));break;case"Sprite":a=new Uoe(l(e.material));break;case"Group":a=new eE;break;case"Bone":a=new hj;break;default:a=new ja}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let g=0;g<h.length;g++)a.add(this.parseObject(h[g],t,r,i,s))}if(e.animations!==void 0){const h=e.animations;for(let g=0;g<h.length;g++){const p=h[g];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const h=e.levels;for(let g=0;g<h.length;g++){const p=h[g],_=a.getObjectByProperty("uuid",p.object);_!==void 0&&a.addLevel(_,p.distance,p.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,i=e.getObjectByProperty("uuid",r);i!==void 0?t.target=i:t.target=new ja}})}}const Hwe={UVMapping:T4,CubeReflectionMapping:lb,CubeRefractionMapping:C1,EquirectangularReflectionMapping:Z2,EquirectangularRefractionMapping:J2,CubeUVReflectionMapping:qw},LW={RepeatWrapping:YT,ClampToEdgeWrapping:I0,MirroredRepeatWrapping:Q2},UW={NearestFilter:bf,NearestMipmapNearestFilter:Qz,NearestMipmapLinearFilter:ET,LinearFilter:sc,LinearMipmapNearestFilter:M2,LinearMipmapLinearFilter:Rv};class qwe extends Ym{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Wy.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Wy.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),Wy.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Wy.add(e,l),s.manager.itemStart(e)}}let NI,Cj=class{static getContext(){return NI===void 0&&(NI=new(window.AudioContext||window.webkitAudioContext)),NI}static setContext(e){NI=e}};class Vwe extends Ym{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new cb(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);Cj.getContext().decodeAudioData(c,function(f){t(f)}).catch(o)}catch(c){o(c)}},r,i);function o(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const BW=new Qr,FW=new Qr,mS=new Qr;class Gwe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new yf,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new yf,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,mS.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(cE*t.fov*.5)/t.zoom;let o,l;FW.elements[12]=-i,BW.elements[12]=i,o=-a*t.aspect+s,l=a*t.aspect+s,mS.elements[0]=2*t.near/(l-o),mS.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(mS),o=-a*t.aspect-s,l=a*t.aspect-s,mS.elements[0]=2*t.near/(l-o),mS.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(mS)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(FW),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(BW)}}class Mle extends yf{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let Mj=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=zW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=zW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function zW(){return performance.now()}const gS=new ut,jW=new zp,$we=new ut,_S=new ut;class Wwe extends ja{constructor(){super(),this.type="AudioListener",this.context=Cj.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Mj}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gS,jW,$we),_S.set(0,0,-1).applyQuaternion(jW),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(gS.x,i),t.positionY.linearRampToValueAtTime(gS.y,i),t.positionZ.linearRampToValueAtTime(gS.z,i),t.forwardX.linearRampToValueAtTime(_S.x,i),t.forwardY.linearRampToValueAtTime(_S.y,i),t.forwardZ.linearRampToValueAtTime(_S.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(gS.x,gS.y,gS.z),t.setOrientation(_S.x,_S.y,_S.z,r.x,r.y,r.z)}}class Ole extends ja{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const vS=new ut,HW=new zp,Ywe=new ut,yS=new ut;class Xwe extends Ole{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(vS,HW,Ywe),yS.set(0,0,1).applyQuaternion(HW);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(vS.x,r),t.positionY.linearRampToValueAtTime(vS.y,r),t.positionZ.linearRampToValueAtTime(vS.z,r),t.orientationX.linearRampToValueAtTime(yS.x,r),t.orientationY.linearRampToValueAtTime(yS.y,r),t.orientationZ.linearRampToValueAtTime(yS.z,r)}else t.setPosition(vS.x,vS.y,vS.z),t.setOrientation(yS.x,yS.y,yS.z)}}class Kwe{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class kle{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[s+o]=r[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(r,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(r[l]!==r[l+t]){o.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,a=i;s!==a;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){zp.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const a=this._workIndex*s;zp.multiplyQuaternionsFlat(e,a,e,t,e,r),zp.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,s){const a=1-i;for(let o=0;o!==s;++o){const l=t+o;e[l]=e[l]*a+e[r+o]*i}}_lerpAdditive(e,t,r,i,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[r+a]*i}}}const Oj="\\[\\]\\.:\\/",Zwe=new RegExp("["+Oj+"]","g"),kj="[^"+Oj+"]",Jwe="[^"+Oj.replace("\\.","")+"]",Qwe=/((?:WC+[\/:])*)/.source.replace("WC",kj),eRe=/(WCOD+)?/.source.replace("WCOD",Jwe),tRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kj),nRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kj),rRe=new RegExp("^"+Qwe+eRe+tRe+nRe+"$"),iRe=["material","materials","bones","map"];class sRe{constructor(e,t,r){const i=r||Fa.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class Fa{constructor(e,t,r){this.path=t,this.parsedPath=r||Fa.parseTrackName(t),this.node=Fa.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Fa.Composite(e,t,r):new Fa(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Zwe,"")}static parseTrackName(e){const t=rRe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);iRe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const l=r(o.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Fa.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[i];if(a===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Fa.Composite=sRe;Fa.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Fa.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Fa.prototype.GetterByBindingType=[Fa.prototype._getValue_direct,Fa.prototype._getValue_array,Fa.prototype._getValue_arrayElement,Fa.prototype._getValue_toArray];Fa.prototype.SetterByBindingTypeAndVersioning=[[Fa.prototype._setValue_direct,Fa.prototype._setValue_direct_setNeedsUpdate,Fa.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fa.prototype._setValue_array,Fa.prototype._setValue_array_setNeedsUpdate,Fa.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fa.prototype._setValue_arrayElement,Fa.prototype._setValue_arrayElement_setNeedsUpdate,Fa.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fa.prototype._setValue_fromArray,Fa.prototype._setValue_fromArray_setNeedsUpdate,Fa.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class aRe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Ug(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const h=arguments[u],g=h.uuid;let p=t[g];if(p===void 0){p=l++,t[g]=p,e.push(h);for(let _=0,y=a;_!==y;++_)s[_].push(new Fa(h,r[_],i[_]))}else if(p<c){o=e[p];const _=--c,y=e[_];t[y.uuid]=p,e[p]=y,t[g]=_,e[_]=h;for(let v=0,x=a;v!==x;++v){const E=s[v],M=E[_];let k=E[p];E[p]=M,k===void 0&&(k=new Fa(h,r[v],i[v])),E[_]=k}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const f=s++,h=e[f];t[h.uuid]=u,e[u]=h,t[c]=f,e[f]=l;for(let g=0,p=i;g!==p;++g){const _=r[g],y=_[f],v=_[u];_[u]=y,_[f]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],u=c.uuid,f=t[u];if(f!==void 0)if(delete t[u],f<s){const h=--s,g=e[h],p=--a,_=e[p];t[g.uuid]=f,e[f]=g,t[_.uuid]=h,e[h]=_,e.pop();for(let y=0,v=i;y!==v;++y){const x=r[y],E=x[h],M=x[p];x[f]=E,x[h]=M,x.pop()}}else{const h=--a,g=e[h];h>0&&(t[g.uuid]=f),e[f]=g,e.pop();for(let p=0,_=i;p!==_;++p){const y=r[p];y[f]=y[h],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,f=new Array(c);i=s.length,r[e]=i,a.push(e),o.push(t),s.push(f);for(let h=u,g=l.length;h!==g;++h){const p=l[h];f[h]=new Fa(p,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=r,a[r]=l,a.pop(),s[r]=s[o],s.pop(),i[r]=i[o],i.pop()}}}class Ile{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,a=s.length,o=new Array(a),l={endingStart:JS,endingEnd:JS};for(let c=0;c!==a;++c){const u=s[c].createInterpolant(null);o[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=goe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r=!1){if(e.fadeOut(t),this.fadeIn(t),r===!0){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,r=!1){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/a,c[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case aj:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(a),c[u].accumulateAdditive(o);break;case O4:default:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(a),c[u].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const a=r===_oe;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(r===moe){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const o=Math.floor(i/t);i-=t*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=QS,i.endingEnd=QS):(e?i.endingStart=this.zeroSlopeAtStart?QS:JS:i.endingStart=tO,t?i.endingEnd=this.zeroSlopeAtEnd?QS:JS:i.endingEnd=tO)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=t,o[1]=s+e,l[1]=r,this}}const oRe=new Float32Array(1);class lRe extends $g{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let f=0;f!==s;++f){const h=i[f],g=h.name;let p=u[g];if(p!==void 0)++p.referenceCount,a[f]=p;else{if(p=a[f],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,g));continue}const _=t&&t._propertyBindings[f].binding.parsedPath;p=new kle(Fa.create(r,g,_),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,g),a[f]=p}o[f].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const f=o.actionByRoot,h=(e._localRoot||this._root).uuid;delete f[h],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,o=a[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new Tj(new Float32Array(2),new Float32Array(2),1,oRe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?fO.findByName(i,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(r===void 0&&(a!==null?r=a.blendMode:r=O4),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const u=new Ile(this,a,t,r);return this._bindAction(u,c),this._addInactiveAction(u,o,s),u}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?fO.findByName(r,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(i,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const u=c._cacheIndex,f=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=u,t[u]=f,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const a in r){const o=r[a].actionByRoot,l=o[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class cRe extends k4{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=r,this.texture=new I4(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class uRe extends k4{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isRenderTargetArray=!0,this.depth=r,this.texture=new gk(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class jn{constructor(e){this.value=e}clone(){return new jn(this.value.clone===void 0?this.value:this.value.clone())}}let fRe=0;class hRe extends $g{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:fRe++}),this.name="",this.usage=rO,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class dRe extends D4{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class pRe{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const qW=new Qr;class Ij{constructor(e,t,r=0,i=1/0){this.ray=new Gw(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new JT,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return qW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(qW),this}intersectObject(e,t=!0,r=[]){return L7(e,this,r,t),r.sort(VW),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)L7(e[i],this,r,t);return r.sort(VW),r}}function VW(n,e){return n.distance-e.distance}function L7(n,e,t,r){let i=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(i=!1),i===!0&&r===!0){const s=n.children;for(let a=0,o=s.length;a<o;a++)L7(s[a],e,t,!0)}}class mRe{constructor(e=1,t=0,r=0){this.radius=e,this.phi=t,this.theta=r}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Wi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Wi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class gRe{constructor(e=1,t=0,r=0){this.radius=e,this.theta=t,this.y=r}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Nj{constructor(e,t,r,i){Nj.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,r,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let r=0;r<4;r++)this.elements[r]=e[r+t];return this}set(e,t,r,i){const s=this.elements;return s[0]=e,s[2]=t,s[1]=r,s[3]=i,this}}const GW=new an;class Nle{constructor(e=new an(1/0,1/0),t=new an(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=GW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,GW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $W=new ut,PI=new ut;class _Re{constructor(e=new ut,t=new ut){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){$W.subVectors(e,this.start),PI.subVectors(this.end,this.start);const r=PI.dot(PI);let s=PI.dot($W)/r;return t&&(s=Wi(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const WW=new ut;class vRe extends ja{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new ns,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,u=o/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Ir(i,3));const s=new qp({fog:!1,toneMapped:!1});this.cone=new Kv(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),WW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(WW),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Vb=new ut,DI=new Qr,q5=new Qr;class yRe extends Kv{constructor(e){const t=Ple(e),r=new ns,i=[],s=[],a=new cr(0,0,1),o=new cr(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}r.setAttribute("position",new Ir(i,3)),r.setAttribute("color",new Ir(s,3));const l=new qp({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");q5.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(DI.multiplyMatrices(q5,o.matrixWorld),Vb.setFromMatrixPosition(DI),i.setXYZ(a,Vb.x,Vb.y,Vb.z),DI.multiplyMatrices(q5,o.parent.matrixWorld),Vb.setFromMatrixPosition(DI),i.setXYZ(a+1,Vb.x,Vb.y,Vb.z),a+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ple(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...Ple(n.children[t]));return e}class bRe extends bu{constructor(e,t,r){const i=new Ek(t,4,2),s=new G1({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const SRe=new ut,YW=new cr,XW=new cr;class ERe extends ja{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new Sk(t);i.rotateY(Math.PI*.5),this.material=new G1({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new Ds(a,3)),this.add(new bu(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");YW.copy(this.light.color),XW.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?YW:XW;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(SRe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class xRe extends Kv{constructor(e=10,t=10,r=4473924,i=8947848){r=new cr(r),i=new cr(i);const s=t/2,a=e/t,o=e/2,l=[],c=[];for(let h=0,g=0,p=-o;h<=t;h++,p+=a){l.push(-o,0,p,o,0,p),l.push(p,0,-o,p,0,o);const _=h===s?r:i;_.toArray(c,g),g+=3,_.toArray(c,g),g+=3,_.toArray(c,g),g+=3,_.toArray(c,g),g+=3}const u=new ns;u.setAttribute("position",new Ir(l,3)),u.setAttribute("color",new Ir(c,3));const f=new qp({vertexColors:!0,toneMapped:!1});super(u,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class TRe extends Kv{constructor(e=10,t=16,r=8,i=64,s=4473924,a=8947848){s=new cr(s),a=new cr(a);const o=[],l=[];if(t>1)for(let f=0;f<t;f++){const h=f/t*(Math.PI*2),g=Math.sin(h)*e,p=Math.cos(h)*e;o.push(0,0,0),o.push(g,0,p);const _=f&1?s:a;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let f=0;f<r;f++){const h=f&1?s:a,g=e-e/r*f;for(let p=0;p<i;p++){let _=p/i*(Math.PI*2),y=Math.sin(_)*g,v=Math.cos(_)*g;o.push(y,0,v),l.push(h.r,h.g,h.b),_=(p+1)/i*(Math.PI*2),y=Math.sin(_)*g,v=Math.cos(_)*g,o.push(y,0,v),l.push(h.r,h.g,h.b)}}const c=new ns;c.setAttribute("position",new Ir(o,3)),c.setAttribute("color",new Ir(l,3));const u=new qp({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const KW=new ut,LI=new ut,ZW=new ut;class wRe extends ja{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new ns;i.setAttribute("position",new Ir([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new qp({fog:!1,toneMapped:!1});this.lightPlane=new M1(i,s),this.add(this.lightPlane),i=new ns,i.setAttribute("position",new Ir([0,0,0,0,0,1],3)),this.targetLine=new M1(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),KW.setFromMatrixPosition(this.light.matrixWorld),LI.setFromMatrixPosition(this.light.target.matrixWorld),ZW.subVectors(LI,KW),this.lightPlane.lookAt(LI),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(LI),this.targetLine.scale.z=ZW.length()}}const UI=new ut,fu=new _k;class RRe extends Kv{constructor(e){const t=new ns,r=new qp({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,_){l(p),l(_)}function l(p){i.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(i.length/3-1)}t.setAttribute("position",new Ir(i,3)),t.setAttribute("color",new Ir(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new cr(16755200),u=new cr(16711680),f=new cr(43775),h=new cr(16777215),g=new cr(3355443);this.setColors(c,u,f,h,g)}setColors(e,t,r,i,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,r.r,r.g,r.b),o.setXYZ(33,r.r,r.g,r.b),o.setXYZ(34,r.r,r.g,r.b),o.setXYZ(35,r.r,r.g,r.b),o.setXYZ(36,r.r,r.g,r.b),o.setXYZ(37,r.r,r.g,r.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;fu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===N0?-1:0;Fu("c",t,e,fu,0,0,s),Fu("t",t,e,fu,0,0,1),Fu("n1",t,e,fu,-1,-1,s),Fu("n2",t,e,fu,r,-1,s),Fu("n3",t,e,fu,-1,i,s),Fu("n4",t,e,fu,r,i,s),Fu("f1",t,e,fu,-1,-1,1),Fu("f2",t,e,fu,r,-1,1),Fu("f3",t,e,fu,-1,i,1),Fu("f4",t,e,fu,r,i,1),Fu("u1",t,e,fu,r*.7,i*1.1,s),Fu("u2",t,e,fu,-1*.7,i*1.1,s),Fu("u3",t,e,fu,0,i*2,s),Fu("cf1",t,e,fu,-1,0,1),Fu("cf2",t,e,fu,r,0,1),Fu("cf3",t,e,fu,0,-1,1),Fu("cf4",t,e,fu,0,i,1),Fu("cn1",t,e,fu,-1,0,s),Fu("cn2",t,e,fu,r,0,s),Fu("cn3",t,e,fu,0,-1,s),Fu("cn4",t,e,fu,0,i,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Fu(n,e,t,r,i,s,a){UI.set(i,s,a).unproject(r);const o=e[n];if(o!==void 0){const l=t.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],UI.x,UI.y,UI.z)}}const BI=new Zd;class ARe extends Kv{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),s=new ns;s.setIndex(new Ds(r,1)),s.setAttribute("position",new Ds(i,3)),super(s,new qp({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&BI.setFromObject(this.object),BI.isEmpty())return;const e=BI.min,t=BI.max,r=this.geometry.attributes.position,i=r.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class CRe extends Kv{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new ns;s.setIndex(new Ds(r,1)),s.setAttribute("position",new Ir(i,3)),super(s,new qp({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class MRe extends M1{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new ns;a.setAttribute("position",new Ir(s,3)),a.computeBoundingSphere(),super(a,new qp({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new ns;l.setAttribute("position",new Ir(o,3)),l.computeBoundingSphere(),this.add(new bu(l,new G1({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const JW=new ut;let FI,V5;class ORe extends ja{constructor(e=new ut(0,0,1),t=new ut(0,0,0),r=1,i=16776960,s=r*.2,a=s*.2){super(),this.type="ArrowHelper",FI===void 0&&(FI=new ns,FI.setAttribute("position",new Ir([0,0,0,0,1,0],3)),V5=new bk(.5,1,5,1),V5.translate(0,-.5,0)),this.position.copy(t),this.line=new M1(FI,new qp({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new bu(V5,new G1({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{JW.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(JW,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class kRe extends Kv{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new ns;i.setAttribute("position",new Ir(t,3)),i.setAttribute("color",new Ir(r,3));const s=new qp({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new cr,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class IRe{constructor(){this.type="ShapePath",this.color=new cr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new LD,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,a){return this.currentPath.bezierCurveTo(e,t,r,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(v){const x=[];for(let E=0,M=v.length;E<M;E++){const k=v[E],N=new uE;N.curves=k.curves,x.push(N)}return x}function r(v,x){const E=x.length;let M=!1;for(let k=E-1,N=0;N<E;k=N++){let I=x[k],D=x[N],V=D.x-I.x,G=D.y-I.y;if(Math.abs(G)>Number.EPSILON){if(G<0&&(I=x[N],V=-V,D=x[k],G=-G),v.y<I.y||v.y>D.y)continue;if(v.y===I.y){if(v.x===I.x)return!0}else{const J=G*(v.x-I.x)-V*(v.y-I.y);if(J===0)return!0;if(J<0)continue;M=!M}}else{if(v.y!==I.y)continue;if(D.x<=v.x&&v.x<=I.x||I.x<=v.x&&v.x<=D.x)return!0}}return M}const i=R_.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const c=[];if(s.length===1)return o=s[0],l=new uE,l.curves=o.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const f=[],h=[];let g=[],p=0,_;h[p]=void 0,g[p]=[];for(let v=0,x=s.length;v<x;v++)o=s[v],_=o.getPoints(),a=i(_),a=e?!a:a,a?(!u&&h[p]&&p++,h[p]={s:new uE,p:_},h[p].s.curves=o.curves,u&&p++,g[p]=[]):g[p].push({h:o,p:_[0]});if(!h[0])return t(s);if(h.length>1){let v=!1,x=0;for(let E=0,M=h.length;E<M;E++)f[E]=[];for(let E=0,M=h.length;E<M;E++){const k=g[E];for(let N=0;N<k.length;N++){const I=k[N];let D=!0;for(let V=0;V<h.length;V++)r(I.p,h[V].p)&&(E!==V&&x++,D?(D=!1,f[V].push(I)):v=!0);D&&f[E].push(I)}}x>0&&v===!1&&(g=f)}let y;for(let v=0,x=h.length;v<x;v++){l=h[v].s,c.push(l),y=g[v];for(let E=0,M=y.length;E<M;E++)l.holes.push(y[E].h)}return c}}class NRe extends $g{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function PRe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function DRe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function LRe(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function U7(n,e,t,r){const i=URe(r);switch(t){case rj:return n*e;case Vw:return n*e/i.components*i.byteLength;case pk:return n*e/i.components*i.byteLength;case C4:return n*e*2/i.components*i.byteLength;case M4:return n*e*2/i.components*i.byteLength;case ij:return n*e*3/i.components*i.byteLength;case Xf:return n*e*4/i.components*i.byteLength;case mk:return n*e*4/i.components*i.byteLength;case O2:case k2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case I2:case N2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case oD:case cD:return Math.max(n,16)*Math.max(e,8)/4;case aD:case lD:return Math.max(n,8)*Math.max(e,8)/2;case uD:case fD:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case hD:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case dD:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case pD:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case mD:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case gD:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case _D:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case vD:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case yD:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case bD:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case SD:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case ED:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case xD:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case TD:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case wD:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case RD:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case P2:case AD:case CD:return Math.ceil(n/4)*Math.ceil(e/4)*16;case sj:case MD:return Math.ceil(n/4)*Math.ceil(e/4)*8;case OD:case kD:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function URe(n){switch(n){case ql:case ej:return{byteLength:1,components:1};case XT:case tj:case vb:return{byteLength:2,components:1};case R4:case A4:return{byteLength:2,components:4};case zv:case w4:case Pp:return{byteLength:4,components:1};case nj:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}class BRe{static contain(e,t){return PRe(e,t)}static cover(e,t){return DRe(e,t)}static fill(e){return LRe(e)}static getByteLength(e,t,r,i){return U7(e,t,r,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Hw}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Hw);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Dle(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function FRe(n){const e=new WeakMap;function t(o,l){const c=o.array,u=o.usage,f=c.byteLength,h=n.createBuffer();n.bindBuffer(l,h),n.bufferData(l,c,u),o.onUploadCallback();let g;if(c instanceof Float32Array)g=n.FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?g=n.HALF_FLOAT:g=n.UNSIGNED_SHORT;else if(c instanceof Int16Array)g=n.SHORT;else if(c instanceof Uint32Array)g=n.UNSIGNED_INT;else if(c instanceof Int32Array)g=n.INT;else if(c instanceof Int8Array)g=n.BYTE;else if(c instanceof Uint8Array)g=n.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)g=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:h,type:g,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:f}}function r(o,l,c){const u=l.array,f=l.updateRanges;if(n.bindBuffer(c,o),f.length===0)n.bufferSubData(c,0,u);else{f.sort((g,p)=>g.start-p.start);let h=0;for(let g=1;g<f.length;g++){const p=f[h],_=f[g];_.start<=p.start+p.count+1?p.count=Math.max(p.count,_.start+_.count-p.start):(++h,f[h]=_)}f.length=h+1;for(let g=0,p=f.length;g<p;g++){const _=f[g];n.bufferSubData(c,_.start*u.BYTES_PER_ELEMENT,u,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(n.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(c.buffer,o,l),c.version=o.version}}return{get:i,remove:s,update:a}}var zRe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,jRe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,HRe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,qRe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,VRe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,GRe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,$Re=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,WRe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,YRe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,XRe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,KRe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,ZRe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,JRe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,QRe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,eAe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,tAe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,nAe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,rAe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,iAe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,sAe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,aAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,oAe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,lAe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,cAe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,uAe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,fAe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,hAe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,dAe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,pAe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,mAe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,gAe="gl_FragColor = linearToOutputTexel( gl_FragColor );",_Ae=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,vAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,yAe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,bAe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,SAe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,EAe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,xAe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,TAe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,wAe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,RAe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,AAe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,CAe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,MAe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,OAe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,kAe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,IAe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,NAe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,PAe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,DAe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,LAe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,UAe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,BAe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,FAe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,zAe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,jAe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,HAe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,qAe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,VAe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,GAe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,$Ae=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,WAe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,YAe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,XAe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,KAe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,ZAe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,JAe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,QAe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,eCe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,tCe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,nCe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,rCe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,iCe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,sCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,aCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,oCe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,lCe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,cCe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,uCe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,fCe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,hCe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,dCe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,pCe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,mCe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,gCe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,_Ce=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,vCe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,yCe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,bCe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,SCe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,ECe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xCe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,TCe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,wCe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,RCe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,ACe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,CCe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,MCe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,OCe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,kCe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,ICe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,NCe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,PCe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,DCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,LCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,BCe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const FCe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,zCe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,HCe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,VCe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,$Ce=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,WCe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,YCe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,XCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,KCe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ZCe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,JCe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,QCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,eMe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tMe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nMe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rMe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,iMe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sMe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,aMe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,oMe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lMe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cMe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,uMe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fMe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hMe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dMe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,pMe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mMe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gMe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_Me=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,vMe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_s={alphahash_fragment:zRe,alphahash_pars_fragment:jRe,alphamap_fragment:HRe,alphamap_pars_fragment:qRe,alphatest_fragment:VRe,alphatest_pars_fragment:GRe,aomap_fragment:$Re,aomap_pars_fragment:WRe,batching_pars_vertex:YRe,batching_vertex:XRe,begin_vertex:KRe,beginnormal_vertex:ZRe,bsdfs:JRe,iridescence_fragment:QRe,bumpmap_pars_fragment:eAe,clipping_planes_fragment:tAe,clipping_planes_pars_fragment:nAe,clipping_planes_pars_vertex:rAe,clipping_planes_vertex:iAe,color_fragment:sAe,color_pars_fragment:aAe,color_pars_vertex:oAe,color_vertex:lAe,common:cAe,cube_uv_reflection_fragment:uAe,defaultnormal_vertex:fAe,displacementmap_pars_vertex:hAe,displacementmap_vertex:dAe,emissivemap_fragment:pAe,emissivemap_pars_fragment:mAe,colorspace_fragment:gAe,colorspace_pars_fragment:_Ae,envmap_fragment:vAe,envmap_common_pars_fragment:yAe,envmap_pars_fragment:bAe,envmap_pars_vertex:SAe,envmap_physical_pars_fragment:IAe,envmap_vertex:EAe,fog_vertex:xAe,fog_pars_vertex:TAe,fog_fragment:wAe,fog_pars_fragment:RAe,gradientmap_pars_fragment:AAe,lightmap_pars_fragment:CAe,lights_lambert_fragment:MAe,lights_lambert_pars_fragment:OAe,lights_pars_begin:kAe,lights_toon_fragment:NAe,lights_toon_pars_fragment:PAe,lights_phong_fragment:DAe,lights_phong_pars_fragment:LAe,lights_physical_fragment:UAe,lights_physical_pars_fragment:BAe,lights_fragment_begin:FAe,lights_fragment_maps:zAe,lights_fragment_end:jAe,logdepthbuf_fragment:HAe,logdepthbuf_pars_fragment:qAe,logdepthbuf_pars_vertex:VAe,logdepthbuf_vertex:GAe,map_fragment:$Ae,map_pars_fragment:WAe,map_particle_fragment:YAe,map_particle_pars_fragment:XAe,metalnessmap_fragment:KAe,metalnessmap_pars_fragment:ZAe,morphinstance_vertex:JAe,morphcolor_vertex:QAe,morphnormal_vertex:eCe,morphtarget_pars_vertex:tCe,morphtarget_vertex:nCe,normal_fragment_begin:rCe,normal_fragment_maps:iCe,normal_pars_fragment:sCe,normal_pars_vertex:aCe,normal_vertex:oCe,normalmap_pars_fragment:lCe,clearcoat_normal_fragment_begin:cCe,clearcoat_normal_fragment_maps:uCe,clearcoat_pars_fragment:fCe,iridescence_pars_fragment:hCe,opaque_fragment:dCe,packing:pCe,premultiplied_alpha_fragment:mCe,project_vertex:gCe,dithering_fragment:_Ce,dithering_pars_fragment:vCe,roughnessmap_fragment:yCe,roughnessmap_pars_fragment:bCe,shadowmap_pars_fragment:SCe,shadowmap_pars_vertex:ECe,shadowmap_vertex:xCe,shadowmask_pars_fragment:TCe,skinbase_vertex:wCe,skinning_pars_vertex:RCe,skinning_vertex:ACe,skinnormal_vertex:CCe,specularmap_fragment:MCe,specularmap_pars_fragment:OCe,tonemapping_fragment:kCe,tonemapping_pars_fragment:ICe,transmission_fragment:NCe,transmission_pars_fragment:PCe,uv_pars_fragment:DCe,uv_pars_vertex:LCe,uv_vertex:UCe,worldpos_vertex:BCe,background_vert:FCe,background_frag:zCe,backgroundCube_vert:jCe,backgroundCube_frag:HCe,cube_vert:qCe,cube_frag:VCe,depth_vert:GCe,depth_frag:$Ce,distanceRGBA_vert:WCe,distanceRGBA_frag:YCe,equirect_vert:XCe,equirect_frag:KCe,linedashed_vert:ZCe,linedashed_frag:JCe,meshbasic_vert:QCe,meshbasic_frag:eMe,meshlambert_vert:tMe,meshlambert_frag:nMe,meshmatcap_vert:rMe,meshmatcap_frag:iMe,meshnormal_vert:sMe,meshnormal_frag:aMe,meshphong_vert:oMe,meshphong_frag:lMe,meshphysical_vert:cMe,meshphysical_frag:uMe,meshtoon_vert:fMe,meshtoon_frag:hMe,points_vert:dMe,points_frag:pMe,shadow_vert:mMe,shadow_frag:gMe,sprite_vert:_Me,sprite_frag:vMe},or={common:{diffuse:{value:new cr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new es},alphaMap:{value:null},alphaMapTransform:{value:new es},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new es}},envmap:{envMap:{value:null},envMapRotation:{value:new es},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new es}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new es}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new es},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new es},normalScale:{value:new an(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new es},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new es}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new es}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new es}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new cr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new cr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new es},alphaTest:{value:0},uvTransform:{value:new es}},sprite:{diffuse:{value:new cr(16777215)},opacity:{value:1},center:{value:new an(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new es},alphaMap:{value:null},alphaMapTransform:{value:new es},alphaTest:{value:0}}},b_={basic:{uniforms:wp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.fog]),vertexShader:_s.meshbasic_vert,fragmentShader:_s.meshbasic_frag},lambert:{uniforms:wp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new cr(0)}}]),vertexShader:_s.meshlambert_vert,fragmentShader:_s.meshlambert_frag},phong:{uniforms:wp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new cr(0)},specular:{value:new cr(1118481)},shininess:{value:30}}]),vertexShader:_s.meshphong_vert,fragmentShader:_s.meshphong_frag},standard:{uniforms:wp([or.common,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.roughnessmap,or.metalnessmap,or.fog,or.lights,{emissive:{value:new cr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_s.meshphysical_vert,fragmentShader:_s.meshphysical_frag},toon:{uniforms:wp([or.common,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.gradientmap,or.fog,or.lights,{emissive:{value:new cr(0)}}]),vertexShader:_s.meshtoon_vert,fragmentShader:_s.meshtoon_frag},matcap:{uniforms:wp([or.common,or.bumpmap,or.normalmap,or.displacementmap,or.fog,{matcap:{value:null}}]),vertexShader:_s.meshmatcap_vert,fragmentShader:_s.meshmatcap_frag},points:{uniforms:wp([or.points,or.fog]),vertexShader:_s.points_vert,fragmentShader:_s.points_frag},dashed:{uniforms:wp([or.common,or.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_s.linedashed_vert,fragmentShader:_s.linedashed_frag},depth:{uniforms:wp([or.common,or.displacementmap]),vertexShader:_s.depth_vert,fragmentShader:_s.depth_frag},normal:{uniforms:wp([or.common,or.bumpmap,or.normalmap,or.displacementmap,{opacity:{value:1}}]),vertexShader:_s.meshnormal_vert,fragmentShader:_s.meshnormal_frag},sprite:{uniforms:wp([or.sprite,or.fog]),vertexShader:_s.sprite_vert,fragmentShader:_s.sprite_frag},background:{uniforms:{uvTransform:{value:new es},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:_s.background_vert,fragmentShader:_s.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new es}},vertexShader:_s.backgroundCube_vert,fragmentShader:_s.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_s.cube_vert,fragmentShader:_s.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_s.equirect_vert,fragmentShader:_s.equirect_frag},distanceRGBA:{uniforms:wp([or.common,or.displacementmap,{referencePosition:{value:new ut},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_s.distanceRGBA_vert,fragmentShader:_s.distanceRGBA_frag},shadow:{uniforms:wp([or.lights,or.fog,{color:{value:new cr(0)},opacity:{value:1}}]),vertexShader:_s.shadow_vert,fragmentShader:_s.shadow_frag}};b_.physical={uniforms:wp([b_.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new es},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new es},clearcoatNormalScale:{value:new an(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new es},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new es},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new es},sheen:{value:0},sheenColor:{value:new cr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new es},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new es},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new es},transmissionSamplerSize:{value:new an},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new es},attenuationDistance:{value:0},attenuationColor:{value:new cr(0)},specularColor:{value:new cr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new es},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new es},anisotropyVector:{value:new an},anisotropyMap:{value:null},anisotropyMapTransform:{value:new es}}]),vertexShader:_s.meshphysical_vert,fragmentShader:_s.meshphysical_frag};const zI={r:0,b:0,g:0},bS=new Bm,yMe=new Qr;function bMe(n,e,t,r,i,s,a){const o=new cr(0);let l=s===!0?0:1,c,u,f=null,h=0,g=null;function p(E){let M=E.isScene===!0?E.background:null;return M&&M.isTexture&&(M=(E.backgroundBlurriness>0?t:e).get(M)),M}function _(E){let M=!1;const k=p(E);k===null?v(o,l):k&&k.isColor&&(v(k,1),M=!0);const N=n.xr.getEnvironmentBlendMode();N==="additive"?r.buffers.color.setClear(0,0,0,1,a):N==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||M)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function y(E,M){const k=p(M);k&&(k.isCubeTexture||k.mapping===qw)?(u===void 0&&(u=new bu(new ZE(1,1,1),new Vl({name:"BackgroundCubeMaterial",uniforms:QT(b_.backgroundCube.uniforms),vertexShader:b_.backgroundCube.vertexShader,fragmentShader:b_.backgroundCube.fragmentShader,side:Yf,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(N,I,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),bS.copy(M.backgroundRotation),bS.x*=-1,bS.y*=-1,bS.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(bS.y*=-1,bS.z*=-1),u.material.uniforms.envMap.value=k,u.material.uniforms.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=M.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(yMe.makeRotationFromEuler(bS)),u.material.toneMapped=Ea.getTransfer(k.colorSpace)!==Po,(f!==k||h!==k.version||g!==n.toneMapping)&&(u.material.needsUpdate=!0,f=k,h=k.version,g=n.toneMapping),u.layers.enableAll(),E.unshift(u,u.geometry,u.material,0,0,null)):k&&k.isTexture&&(c===void 0&&(c=new bu(new Yw(2,2),new Vl({name:"BackgroundMaterial",uniforms:QT(b_.background.uniforms),vertexShader:b_.background.vertexShader,fragmentShader:b_.background.fragmentShader,side:Fv,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=k,c.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,c.material.toneMapped=Ea.getTransfer(k.colorSpace)!==Po,k.matrixAutoUpdate===!0&&k.updateMatrix(),c.material.uniforms.uvTransform.value.copy(k.matrix),(f!==k||h!==k.version||g!==n.toneMapping)&&(c.material.needsUpdate=!0,f=k,h=k.version,g=n.toneMapping),c.layers.enableAll(),E.unshift(c,c.geometry,c.material,0,0,null))}function v(E,M){E.getRGB(zI,Ioe(n)),r.buffers.color.setClear(zI.r,zI.g,zI.b,M,a)}function x(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(E,M=1){o.set(E),l=M,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(E){l=E,v(o,l)},render:_,addToRenderList:y,dispose:x}}function SMe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=h(null);let s=i,a=!1;function o(G,J,B,$,U){let Q=!1;const W=f($,B,J);s!==W&&(s=W,c(s.object)),Q=g(G,$,B,U),Q&&p(G,$,B,U),U!==null&&e.update(U,n.ELEMENT_ARRAY_BUFFER),(Q||a)&&(a=!1,M(G,J,B,$),U!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(U).buffer))}function l(){return n.createVertexArray()}function c(G){return n.bindVertexArray(G)}function u(G){return n.deleteVertexArray(G)}function f(G,J,B){const $=B.wireframe===!0;let U=r[G.id];U===void 0&&(U={},r[G.id]=U);let Q=U[J.id];Q===void 0&&(Q={},U[J.id]=Q);let W=Q[$];return W===void 0&&(W=h(l()),Q[$]=W),W}function h(G){const J=[],B=[],$=[];for(let U=0;U<t;U++)J[U]=0,B[U]=0,$[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:J,enabledAttributes:B,attributeDivisors:$,object:G,attributes:{},index:null}}function g(G,J,B,$){const U=s.attributes,Q=J.attributes;let W=0;const q=B.getAttributes();for(const Y in q)if(q[Y].location>=0){const Z=U[Y];let K=Q[Y];if(K===void 0&&(Y==="instanceMatrix"&&G.instanceMatrix&&(K=G.instanceMatrix),Y==="instanceColor"&&G.instanceColor&&(K=G.instanceColor)),Z===void 0||Z.attribute!==K||K&&Z.data!==K.data)return!0;W++}return s.attributesNum!==W||s.index!==$}function p(G,J,B,$){const U={},Q=J.attributes;let W=0;const q=B.getAttributes();for(const Y in q)if(q[Y].location>=0){let Z=Q[Y];Z===void 0&&(Y==="instanceMatrix"&&G.instanceMatrix&&(Z=G.instanceMatrix),Y==="instanceColor"&&G.instanceColor&&(Z=G.instanceColor));const K={};K.attribute=Z,Z&&Z.data&&(K.data=Z.data),U[Y]=K,W++}s.attributes=U,s.attributesNum=W,s.index=$}function _(){const G=s.newAttributes;for(let J=0,B=G.length;J<B;J++)G[J]=0}function y(G){v(G,0)}function v(G,J){const B=s.newAttributes,$=s.enabledAttributes,U=s.attributeDivisors;B[G]=1,$[G]===0&&(n.enableVertexAttribArray(G),$[G]=1),U[G]!==J&&(n.vertexAttribDivisor(G,J),U[G]=J)}function x(){const G=s.newAttributes,J=s.enabledAttributes;for(let B=0,$=J.length;B<$;B++)J[B]!==G[B]&&(n.disableVertexAttribArray(B),J[B]=0)}function E(G,J,B,$,U,Q,W){W===!0?n.vertexAttribIPointer(G,J,B,U,Q):n.vertexAttribPointer(G,J,B,$,U,Q)}function M(G,J,B,$){_();const U=$.attributes,Q=B.getAttributes(),W=J.defaultAttributeValues;for(const q in Q){const Y=Q[q];if(Y.location>=0){let ae=U[q];if(ae===void 0&&(q==="instanceMatrix"&&G.instanceMatrix&&(ae=G.instanceMatrix),q==="instanceColor"&&G.instanceColor&&(ae=G.instanceColor)),ae!==void 0){const Z=ae.normalized,K=ae.itemSize,ne=e.get(ae);if(ne===void 0)continue;const le=ne.buffer,ce=ne.type,de=ne.bytesPerElement,Me=ce===n.INT||ce===n.UNSIGNED_INT||ae.gpuType===w4;if(ae.isInterleavedBufferAttribute){const qe=ae.data,Ne=qe.stride,Ae=ae.offset;if(qe.isInstancedInterleavedBuffer){for(let Xe=0;Xe<Y.locationSize;Xe++)v(Y.location+Xe,qe.meshPerAttribute);G.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=qe.meshPerAttribute*qe.count)}else for(let Xe=0;Xe<Y.locationSize;Xe++)y(Y.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,le);for(let Xe=0;Xe<Y.locationSize;Xe++)E(Y.location+Xe,K/Y.locationSize,ce,Z,Ne*de,(Ae+K/Y.locationSize*Xe)*de,Me)}else{if(ae.isInstancedBufferAttribute){for(let qe=0;qe<Y.locationSize;qe++)v(Y.location+qe,ae.meshPerAttribute);G.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let qe=0;qe<Y.locationSize;qe++)y(Y.location+qe);n.bindBuffer(n.ARRAY_BUFFER,le);for(let qe=0;qe<Y.locationSize;qe++)E(Y.location+qe,K/Y.locationSize,ce,Z,K*de,K/Y.locationSize*qe*de,Me)}}else if(W!==void 0){const Z=W[q];if(Z!==void 0)switch(Z.length){case 2:n.vertexAttrib2fv(Y.location,Z);break;case 3:n.vertexAttrib3fv(Y.location,Z);break;case 4:n.vertexAttrib4fv(Y.location,Z);break;default:n.vertexAttrib1fv(Y.location,Z)}}}}x()}function k(){D();for(const G in r){const J=r[G];for(const B in J){const $=J[B];for(const U in $)u($[U].object),delete $[U];delete J[B]}delete r[G]}}function N(G){if(r[G.id]===void 0)return;const J=r[G.id];for(const B in J){const $=J[B];for(const U in $)u($[U].object),delete $[U];delete J[B]}delete r[G.id]}function I(G){for(const J in r){const B=r[J];if(B[G.id]===void 0)continue;const $=B[G.id];for(const U in $)u($[U].object),delete $[U];delete B[G.id]}}function D(){V(),a=!0,s!==i&&(s=i,c(s.object))}function V(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:D,resetDefaultState:V,dispose:k,releaseStatesOfGeometry:N,releaseStatesOfProgram:I,initAttributes:_,enableAttribute:y,disableUnusedAttributes:x}}function EMe(n,e,t){let r;function i(c){r=c}function s(c,u){n.drawArrays(r,c,u),t.update(u,r,1)}function a(c,u,f){f!==0&&(n.drawArraysInstanced(r,c,u,f),t.update(u,r,f))}function o(c,u,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,c,0,u,0,f);let g=0;for(let p=0;p<f;p++)g+=u[p];t.update(g,r,1)}function l(c,u,f,h){if(f===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let p=0;p<c.length;p++)a(c[p],u[p],h[p]);else{g.multiDrawArraysInstancedWEBGL(r,c,0,u,0,h,0,f);let p=0;for(let _=0;_<f;_++)p+=u[_]*h[_];t.update(p,r,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function xMe(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(I){return!(I!==Xf&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const D=I===vb&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==ql&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==Pp&&!D)}function l(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const f=t.logarithmicDepthBuffer===!0,h=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),E=n.getParameter(n.MAX_VARYING_VECTORS),M=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),k=p>0,N=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:f,reverseDepthBuffer:h,maxTextures:g,maxVertexTextures:p,maxTextureSize:_,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:x,maxVaryings:E,maxFragmentUniforms:M,vertexTextures:k,maxSamples:N}}function TMe(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new r1,o=new es,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,h){const g=f.length!==0||h||r!==0||i;return i=h,r=f.length,g},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,h){t=u(f,h,0)},this.setState=function(f,h,g){const p=f.clippingPlanes,_=f.clipIntersection,y=f.clipShadows,v=n.get(f);if(!i||p===null||p.length===0||s&&!y)s?u(null):c();else{const x=s?0:r,E=x*4;let M=v.clippingState||null;l.value=M,M=u(p,h,E,g);for(let k=0;k!==E;++k)M[k]=t[k];v.clippingState=M,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(f,h,g,p){const _=f!==null?f.length:0;let y=null;if(_!==0){if(y=l.value,p!==!0||y===null){const v=g+_*4,x=h.matrixWorldInverse;o.getNormalMatrix(x),(y===null||y.length<v)&&(y=new Float32Array(v));for(let E=0,M=g;E!==_;++E,M+=4)a.copy(f[E]).applyMatrix4(x,o),a.normal.toArray(y,M),y[M+3]=a.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}}function wMe(n){let e=new WeakMap;function t(a,o){return o===Z2?a.mapping=lb:o===J2&&(a.mapping=C1),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===Z2||o===J2)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new Doe(l.height);return c.fromEquirectangularTexture(n,a),e.set(a,c),a.addEventListener("dispose",i),t(c.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const TT=4,QW=[.125,.215,.35,.446,.526,.582],WS=20,G5=new wk,eY=new cr;let $5=null,W5=0,Y5=0,X5=!1;const FS=(1+Math.sqrt(5))/2,Wx=1/FS,tY=[new ut(-FS,Wx,0),new ut(FS,Wx,0),new ut(-Wx,0,FS),new ut(Wx,0,FS),new ut(0,FS,-Wx),new ut(0,FS,Wx),new ut(-1,1,-1),new ut(1,1,-1),new ut(-1,1,1),new ut(1,1,1)],RMe=new ut;class B7{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100,s={}){const{size:a=256,position:o=RMe}=s;$5=this._renderer.getRenderTarget(),W5=this._renderer.getActiveCubeFace(),Y5=this._renderer.getActiveMipmapLevel(),X5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,i,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=iY(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=rY(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget($5,W5,Y5),this._renderer.xr.enabled=X5,e.scissorTest=!1,jI(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===lb||e.mapping===C1?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),$5=this._renderer.getRenderTarget(),W5=this._renderer.getActiveCubeFace(),Y5=this._renderer.getActiveMipmapLevel(),X5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:sc,minFilter:sc,generateMipmaps:!1,type:vb,format:Xf,colorSpace:jv,depthBuffer:!1},i=nY(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=nY(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=AMe(s)),this._blurMaterial=CMe(s,e,t)}return i}_compileMaterial(e){const t=new bu(this._lodPlanes[0],e);this._renderer.compile(t,G5)}_sceneToCubeUV(e,t,r,i,s){const l=new yf(90,1,t,r),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],f=this._renderer,h=f.autoClear,g=f.toneMapping;f.getClearColor(eY),f.toneMapping=Iv,f.autoClear=!1;const p=new G1({name:"PMREM.Background",side:Yf,depthWrite:!1,depthTest:!1}),_=new bu(new ZE,p);let y=!1;const v=e.background;v?v.isColor&&(p.color.copy(v),e.background=null,y=!0):(p.color.copy(eY),y=!0);for(let x=0;x<6;x++){const E=x%3;E===0?(l.up.set(0,c[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[x],s.y,s.z)):E===1?(l.up.set(0,0,c[x]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[x],s.z)):(l.up.set(0,c[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[x]));const M=this._cubeSize;jI(i,E*M,x>2?M:0,M,M),f.setRenderTarget(i),y&&f.render(_,l),f.render(e,l)}_.geometry.dispose(),_.material.dispose(),f.toneMapping=g,f.autoClear=h,e.background=v}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===lb||e.mapping===C1;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=iY()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=rY());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new bu(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;jI(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(a,G5)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=tY[(i-s-1)%tY.length];this._blur(e,s-1,s,a,o)}t.autoClear=r}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,f=new bu(this._lodPlanes[i],c),h=c.uniforms,g=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*WS-1),_=s/p,y=isFinite(s)?1+Math.floor(u*_):WS;y>WS&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${WS}`);const v=[];let x=0;for(let I=0;I<WS;++I){const D=I/_,V=Math.exp(-D*D/2);v.push(V),I===0?x+=V:I<y&&(x+=2*V)}for(let I=0;I<v.length;I++)v[I]=v[I]/x;h.envMap.value=e.texture,h.samples.value=y,h.weights.value=v,h.latitudinal.value=a==="latitudinal",o&&(h.poleAxis.value=o);const{_lodMax:E}=this;h.dTheta.value=p,h.mipInt.value=E-r;const M=this._sizeLods[i],k=3*M*(i>E-TT?i-E+TT:0),N=4*(this._cubeSize-M);jI(t,k,N,3*M,2*M),l.setRenderTarget(t),l.render(f,G5)}}function AMe(n){const e=[],t=[],r=[];let i=n;const s=n-TT+1+QW.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);t.push(o);let l=1/o;a>n-TT?l=QW[a-n+TT-1]:a===0&&(l=0),r.push(l);const c=1/(o-2),u=-c,f=1+c,h=[u,u,f,u,f,f,u,u,f,f,u,f],g=6,p=6,_=3,y=2,v=1,x=new Float32Array(_*p*g),E=new Float32Array(y*p*g),M=new Float32Array(v*p*g);for(let N=0;N<g;N++){const I=N%3*2/3-1,D=N>2?0:-1,V=[I,D,0,I+2/3,D,0,I+2/3,D+1,0,I,D,0,I+2/3,D+1,0,I,D+1,0];x.set(V,_*p*N),E.set(h,y*p*N);const G=[N,N,N,N,N,N];M.set(G,v*p*N)}const k=new ns;k.setAttribute("position",new Ds(x,_)),k.setAttribute("uv",new Ds(E,y)),k.setAttribute("faceIndex",new Ds(M,v)),e.push(k),i>TT&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function nY(n,e,t){const r=new Sf(n,e,t);return r.texture.mapping=qw,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function jI(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function CMe(n,e,t){const r=new Float32Array(WS),i=new ut(0,1,0);return new Vl({name:"SphericalGaussianBlur",defines:{n:WS,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Pj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function rY(){return new Vl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Pj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function iY(){return new Vl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Pj(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function Pj(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function MMe(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,c=l===Z2||l===J2,u=l===lb||l===C1;if(c||u){let f=e.get(o);const h=f!==void 0?f.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==h)return t===null&&(t=new B7(n)),f=c?t.fromEquirectangular(o,f):t.fromCubemap(o,f),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),f.texture;if(f!==void 0)return f.texture;{const g=o.image;return c&&g&&g.height>0||u&&g&&i(g)?(t===null&&(t=new B7(n)),f=c?t.fromEquirectangular(o):t.fromCubemap(o),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),o.addEventListener("dispose",s),f.texture):null}}}return o}function i(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function OMe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&tP("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function kMe(n,e,t,r){const i={},s=new WeakMap;function a(f){const h=f.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",a),delete i[h.id];const g=s.get(h);g&&(e.remove(g),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function o(f,h){return i[h.id]===!0||(h.addEventListener("dispose",a),i[h.id]=!0,t.memory.geometries++),h}function l(f){const h=f.attributes;for(const g in h)e.update(h[g],n.ARRAY_BUFFER)}function c(f){const h=[],g=f.index,p=f.attributes.position;let _=0;if(g!==null){const x=g.array;_=g.version;for(let E=0,M=x.length;E<M;E+=3){const k=x[E+0],N=x[E+1],I=x[E+2];h.push(k,N,N,I,I,k)}}else if(p!==void 0){const x=p.array;_=p.version;for(let E=0,M=x.length/3-1;E<M;E+=3){const k=E+0,N=E+1,I=E+2;h.push(k,N,N,I,I,k)}}else return;const y=new(Coe(h)?uj:cj)(h,1);y.version=_;const v=s.get(f);v&&e.remove(v),s.set(f,y)}function u(f){const h=s.get(f);if(h){const g=f.index;g!==null&&h.version<g.version&&c(f)}else c(f);return s.get(f)}return{get:o,update:l,getWireframeAttribute:u}}function IMe(n,e,t){let r;function i(h){r=h}let s,a;function o(h){s=h.type,a=h.bytesPerElement}function l(h,g){n.drawElements(r,g,s,h*a),t.update(g,r,1)}function c(h,g,p){p!==0&&(n.drawElementsInstanced(r,g,s,h*a,p),t.update(g,r,p))}function u(h,g,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,g,0,s,h,0,p);let y=0;for(let v=0;v<p;v++)y+=g[v];t.update(y,r,1)}function f(h,g,p,_){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<h.length;v++)c(h[v]/a,g[v],_[v]);else{y.multiDrawElementsInstancedWEBGL(r,g,0,s,h,0,_,0,p);let v=0;for(let x=0;x<p;x++)v+=g[x]*_[x];t.update(v,r,1)}}this.setMode=i,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function NMe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function PMe(n,e,t){const r=new WeakMap,i=new Ta;function s(a,o,l){const c=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,f=u!==void 0?u.length:0;let h=r.get(o);if(h===void 0||h.count!==f){let G=function(){D.dispose(),r.delete(o),o.removeEventListener("dispose",G)};var g=G;h!==void 0&&h.texture.dispose();const p=o.morphAttributes.position!==void 0,_=o.morphAttributes.normal!==void 0,y=o.morphAttributes.color!==void 0,v=o.morphAttributes.position||[],x=o.morphAttributes.normal||[],E=o.morphAttributes.color||[];let M=0;p===!0&&(M=1),_===!0&&(M=2),y===!0&&(M=3);let k=o.attributes.position.count*M,N=1;k>e.maxTextureSize&&(N=Math.ceil(k/e.maxTextureSize),k=e.maxTextureSize);const I=new Float32Array(k*N*4*f),D=new gk(I,k,N,f);D.type=Pp,D.needsUpdate=!0;const V=M*4;for(let J=0;J<f;J++){const B=v[J],$=x[J],U=E[J],Q=k*N*4*J;for(let W=0;W<B.count;W++){const q=W*V;p===!0&&(i.fromBufferAttribute(B,W),I[Q+q+0]=i.x,I[Q+q+1]=i.y,I[Q+q+2]=i.z,I[Q+q+3]=0),_===!0&&(i.fromBufferAttribute($,W),I[Q+q+4]=i.x,I[Q+q+5]=i.y,I[Q+q+6]=i.z,I[Q+q+7]=0),y===!0&&(i.fromBufferAttribute(U,W),I[Q+q+8]=i.x,I[Q+q+9]=i.y,I[Q+q+10]=i.z,I[Q+q+11]=U.itemSize===4?i.w:1)}}h={count:f,texture:D,size:new an(k,N)},r.set(o,h),o.addEventListener("dispose",G)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let p=0;for(let y=0;y<c.length;y++)p+=c[y];const _=o.morphTargetsRelative?1:1-p;l.getUniforms().setValue(n,"morphTargetBaseInfluence",_),l.getUniforms().setValue(n,"morphTargetInfluences",c)}l.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}return{update:s}}function DMe(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,f=e.get(l,u);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==c&&(h.update(),i.set(h,c))}return f}function a(){i=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}const Lle=new wc,sY=new Ww(1,1),Ule=new gk,Ble=new I4,Fle=new vk,aY=[],oY=[],lY=new Float32Array(16),cY=new Float32Array(9),uY=new Float32Array(4);function Xw(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=aY[i];if(s===void 0&&(s=new Float32Array(i),aY[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function Zf(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Jf(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function Q4(n,e){let t=oY[e];t===void 0&&(t=new Int32Array(e),oY[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function LMe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function UMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2fv(this.addr,e),Jf(t,e)}}function BMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Zf(t,e))return;n.uniform3fv(this.addr,e),Jf(t,e)}}function FMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4fv(this.addr,e),Jf(t,e)}}function zMe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Jf(t,e)}else{if(Zf(t,r))return;uY.set(r),n.uniformMatrix2fv(this.addr,!1,uY),Jf(t,r)}}function jMe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Jf(t,e)}else{if(Zf(t,r))return;cY.set(r),n.uniformMatrix3fv(this.addr,!1,cY),Jf(t,r)}}function HMe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Jf(t,e)}else{if(Zf(t,r))return;lY.set(r),n.uniformMatrix4fv(this.addr,!1,lY),Jf(t,r)}}function qMe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function VMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2iv(this.addr,e),Jf(t,e)}}function GMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Zf(t,e))return;n.uniform3iv(this.addr,e),Jf(t,e)}}function $Me(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4iv(this.addr,e),Jf(t,e)}}function WMe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function YMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2uiv(this.addr,e),Jf(t,e)}}function XMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Zf(t,e))return;n.uniform3uiv(this.addr,e),Jf(t,e)}}function KMe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4uiv(this.addr,e),Jf(t,e)}}function ZMe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(sY.compareFunction=oj,s=sY):s=Lle,t.setTexture2D(e||s,i)}function JMe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||Ble,i)}function QMe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||Fle,i)}function e2e(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Ule,i)}function t2e(n){switch(n){case 5126:return LMe;case 35664:return UMe;case 35665:return BMe;case 35666:return FMe;case 35674:return zMe;case 35675:return jMe;case 35676:return HMe;case 5124:case 35670:return qMe;case 35667:case 35671:return VMe;case 35668:case 35672:return GMe;case 35669:case 35673:return $Me;case 5125:return WMe;case 36294:return YMe;case 36295:return XMe;case 36296:return KMe;case 35678:case 36198:case 36298:case 36306:case 35682:return ZMe;case 35679:case 36299:case 36307:return JMe;case 35680:case 36300:case 36308:case 36293:return QMe;case 36289:case 36303:case 36311:case 36292:return e2e}}function n2e(n,e){n.uniform1fv(this.addr,e)}function r2e(n,e){const t=Xw(e,this.size,2);n.uniform2fv(this.addr,t)}function i2e(n,e){const t=Xw(e,this.size,3);n.uniform3fv(this.addr,t)}function s2e(n,e){const t=Xw(e,this.size,4);n.uniform4fv(this.addr,t)}function a2e(n,e){const t=Xw(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function o2e(n,e){const t=Xw(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function l2e(n,e){const t=Xw(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function c2e(n,e){n.uniform1iv(this.addr,e)}function u2e(n,e){n.uniform2iv(this.addr,e)}function f2e(n,e){n.uniform3iv(this.addr,e)}function h2e(n,e){n.uniform4iv(this.addr,e)}function d2e(n,e){n.uniform1uiv(this.addr,e)}function p2e(n,e){n.uniform2uiv(this.addr,e)}function m2e(n,e){n.uniform3uiv(this.addr,e)}function g2e(n,e){n.uniform4uiv(this.addr,e)}function _2e(n,e,t){const r=this.cache,i=e.length,s=Q4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Jf(r,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||Lle,s[a])}function v2e(n,e,t){const r=this.cache,i=e.length,s=Q4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Jf(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||Ble,s[a])}function y2e(n,e,t){const r=this.cache,i=e.length,s=Q4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Jf(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||Fle,s[a])}function b2e(n,e,t){const r=this.cache,i=e.length,s=Q4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Jf(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||Ule,s[a])}function S2e(n){switch(n){case 5126:return n2e;case 35664:return r2e;case 35665:return i2e;case 35666:return s2e;case 35674:return a2e;case 35675:return o2e;case 35676:return l2e;case 5124:case 35670:return c2e;case 35667:case 35671:return u2e;case 35668:case 35672:return f2e;case 35669:case 35673:return h2e;case 5125:return d2e;case 36294:return p2e;case 36295:return m2e;case 36296:return g2e;case 35678:case 36198:case 36298:case 36306:case 35682:return _2e;case 35679:case 36299:case 36307:return v2e;case 35680:case 36300:case 36308:case 36293:return y2e;case 36289:case 36303:case 36311:case 36292:return b2e}}class E2e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=t2e(t.type)}}class x2e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=S2e(t.type)}}class T2e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const K5=/(\w+)(\])?(\[|\.)?/g;function fY(n,e){n.seq.push(e),n.map[e.id]=e}function w2e(n,e,t){const r=n.name,i=r.length;for(K5.lastIndex=0;;){const s=K5.exec(r),a=K5.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===i){fY(t,c===void 0?new E2e(o,n,e):new x2e(o,n,e));break}else{let f=t.map[o];f===void 0&&(f=new T2e(o),fY(t,f)),t=f}}}class rP{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);w2e(s,a,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function hY(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const R2e=37297;let A2e=0;function C2e(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}const dY=new es;function M2e(n){Ea._getMatrix(dY,Ea.workingColorSpace,n);const e=`mat3( ${dY.elements.map(t=>t.toFixed(4))} )`;switch(Ea.getTransfer(n)){case nO:return[e,"LinearTransferOETF"];case Po:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function pY(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+C2e(n.getShaderSource(e),a)}else return i}function O2e(n,e){const t=M2e(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function k2e(n,e){let t;switch(e){case loe:t="Linear";break;case coe:t="Reinhard";break;case uoe:t="Cineon";break;case Jz:t="ACESFilmic";break;case hoe:t="AgX";break;case doe:t="Neutral";break;case foe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const HI=new ut;function I2e(){Ea.getLuminanceCoefficients(HI);const n=HI.x.toFixed(4),e=HI.y.toFixed(4),t=HI.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function N2e(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(p2).join(`
`)}function P2e(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function D2e(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function p2(n){return n!==""}function mY(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function gY(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const L2e=/^[ \t]*#include +<([\w\d./]+)>/gm;function F7(n){return n.replace(L2e,B2e)}const U2e=new Map;function B2e(n,e){let t=_s[e];if(t===void 0){const r=U2e.get(e);if(r!==void 0)t=_s[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return F7(t)}const F2e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _Y(n){return n.replace(F2e,z2e)}function z2e(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function vY(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function j2e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===x4?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===C2?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===v_&&(e="SHADOWMAP_TYPE_VSM"),e}function H2e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case lb:case C1:e="ENVMAP_TYPE_CUBE";break;case qw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function q2e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case C1:e="ENVMAP_MODE_REFRACTION";break}return e}function V2e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case dk:e="ENVMAP_BLENDING_MULTIPLY";break;case aoe:e="ENVMAP_BLENDING_MIX";break;case ooe:e="ENVMAP_BLENDING_ADD";break}return e}function G2e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}function $2e(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=j2e(t),c=H2e(t),u=q2e(t),f=V2e(t),h=G2e(t),g=N2e(t),p=P2e(s),_=i.createProgram();let y,v,x=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(p2).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(p2).join(`
`),v.length>0&&(v+=`
`)):(y=[vY(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(p2).join(`
`),v=[vY(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Iv?"#define TONE_MAPPING":"",t.toneMapping!==Iv?_s.tonemapping_pars_fragment:"",t.toneMapping!==Iv?k2e("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",_s.colorspace_pars_fragment,O2e("linearToOutputTexel",t.outputColorSpace),I2e(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(p2).join(`
`)),a=F7(a),a=mY(a,t),a=gY(a,t),o=F7(o),o=mY(o,t),o=gY(o,t),a=_Y(a),o=_Y(o),t.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,y=[g,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",t.glslVersion===O7?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===O7?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const E=x+y+a,M=x+v+o,k=hY(i,i.VERTEX_SHADER,E),N=hY(i,i.FRAGMENT_SHADER,M);i.attachShader(_,k),i.attachShader(_,N),t.index0AttributeName!==void 0?i.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_);function I(J){if(n.debug.checkShaderErrors){const B=i.getProgramInfoLog(_).trim(),$=i.getShaderInfoLog(k).trim(),U=i.getShaderInfoLog(N).trim();let Q=!0,W=!0;if(i.getProgramParameter(_,i.LINK_STATUS)===!1)if(Q=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,_,k,N);else{const q=pY(i,k,"vertex"),Y=pY(i,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,i.VALIDATE_STATUS)+`

Material Name: `+J.name+`
Material Type: `+J.type+`

Program Info Log: `+B+`
`+q+`
`+Y)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):($===""||U==="")&&(W=!1);W&&(J.diagnostics={runnable:Q,programLog:B,vertexShader:{log:$,prefix:y},fragmentShader:{log:U,prefix:v}})}i.deleteShader(k),i.deleteShader(N),D=new rP(i,_),V=D2e(i,_)}let D;this.getUniforms=function(){return D===void 0&&I(this),D};let V;this.getAttributes=function(){return V===void 0&&I(this),V};let G=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return G===!1&&(G=i.getProgramParameter(_,R2e)),G},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=A2e++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=k,this.fragmentShader=N,this}let W2e=0;class Y2e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new X2e(e),t.set(e,r)),r}}class X2e{constructor(e){this.id=W2e++,this.code=e,this.usedTimes=0}}function K2e(n,e,t,r,i,s,a){const o=new JT,l=new Y2e,c=new Set,u=[],f=i.logarithmicDepthBuffer,h=i.vertexTextures;let g=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(V){return c.add(V),V===0?"uv":`uv${V}`}function y(V,G,J,B,$){const U=B.fog,Q=$.geometry,W=V.isMeshStandardMaterial?B.environment:null,q=(V.isMeshStandardMaterial?t:e).get(V.envMap||W),Y=q&&q.mapping===qw?q.image.height:null,ae=p[V.type];V.precision!==null&&(g=i.getMaxPrecision(V.precision),g!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",g,"instead."));const Z=Q.morphAttributes.position||Q.morphAttributes.normal||Q.morphAttributes.color,K=Z!==void 0?Z.length:0;let ne=0;Q.morphAttributes.position!==void 0&&(ne=1),Q.morphAttributes.normal!==void 0&&(ne=2),Q.morphAttributes.color!==void 0&&(ne=3);let le,ce,de,Me;if(ae){const _t=b_[ae];le=_t.vertexShader,ce=_t.fragmentShader}else le=V.vertexShader,ce=V.fragmentShader,l.update(V),de=l.getVertexShaderID(V),Me=l.getFragmentShaderID(V);const qe=n.getRenderTarget(),Ne=n.state.buffers.depth.getReversed(),Ae=$.isInstancedMesh===!0,Xe=$.isBatchedMesh===!0,$e=!!V.map,at=!!V.matcap,pt=!!q,oe=!!V.aoMap,Ue=!!V.lightMap,Ge=!!V.bumpMap,ze=!!V.normalMap,Be=!!V.displacementMap,me=!!V.emissiveMap,Se=!!V.metalnessMap,ke=!!V.roughnessMap,be=V.anisotropy>0,Ke=V.clearcoat>0,ot=V.dispersion>0,lt=V.iridescence>0,ct=V.sheen>0,Vt=V.transmission>0,Ot=be&&!!V.anisotropyMap,Ut=Ke&&!!V.clearcoatMap,je=Ke&&!!V.clearcoatNormalMap,ge=Ke&&!!V.clearcoatRoughnessMap,se=lt&&!!V.iridescenceMap,_e=lt&&!!V.iridescenceThicknessMap,Ie=ct&&!!V.sheenColorMap,De=ct&&!!V.sheenRoughnessMap,Oe=!!V.specularMap,we=!!V.specularColorMap,st=!!V.specularIntensityMap,Ve=Vt&&!!V.transmissionMap,tt=Vt&&!!V.thicknessMap,Ze=!!V.gradientMap,nt=!!V.alphaMap,vt=V.alphaTest>0,Je=!!V.alphaHash,ht=!!V.extensions;let mt=Iv;V.toneMapped&&(qe===null||qe.isXRRenderTarget===!0)&&(mt=n.toneMapping);const ft={shaderID:ae,shaderType:V.type,shaderName:V.name,vertexShader:le,fragmentShader:ce,defines:V.defines,customVertexShaderID:de,customFragmentShaderID:Me,isRawShaderMaterial:V.isRawShaderMaterial===!0,glslVersion:V.glslVersion,precision:g,batching:Xe,batchingColor:Xe&&$._colorsTexture!==null,instancing:Ae,instancingColor:Ae&&$.instanceColor!==null,instancingMorph:Ae&&$.morphTexture!==null,supportsVertexTextures:h,outputColorSpace:qe===null?n.outputColorSpace:qe.isXRRenderTarget===!0?qe.texture.colorSpace:jv,alphaToCoverage:!!V.alphaToCoverage,map:$e,matcap:at,envMap:pt,envMapMode:pt&&q.mapping,envMapCubeUVHeight:Y,aoMap:oe,lightMap:Ue,bumpMap:Ge,normalMap:ze,displacementMap:h&&Be,emissiveMap:me,normalMapObjectSpace:ze&&V.normalMapType===yoe,normalMapTangentSpace:ze&&V.normalMapType===V1,metalnessMap:Se,roughnessMap:ke,anisotropy:be,anisotropyMap:Ot,clearcoat:Ke,clearcoatMap:Ut,clearcoatNormalMap:je,clearcoatRoughnessMap:ge,dispersion:ot,iridescence:lt,iridescenceMap:se,iridescenceThicknessMap:_e,sheen:ct,sheenColorMap:Ie,sheenRoughnessMap:De,specularMap:Oe,specularColorMap:we,specularIntensityMap:st,transmission:Vt,transmissionMap:Ve,thicknessMap:tt,gradientMap:Ze,opaque:V.transparent===!1&&V.blending===lE&&V.alphaToCoverage===!1,alphaMap:nt,alphaTest:vt,alphaHash:Je,combine:V.combine,mapUv:$e&&_(V.map.channel),aoMapUv:oe&&_(V.aoMap.channel),lightMapUv:Ue&&_(V.lightMap.channel),bumpMapUv:Ge&&_(V.bumpMap.channel),normalMapUv:ze&&_(V.normalMap.channel),displacementMapUv:Be&&_(V.displacementMap.channel),emissiveMapUv:me&&_(V.emissiveMap.channel),metalnessMapUv:Se&&_(V.metalnessMap.channel),roughnessMapUv:ke&&_(V.roughnessMap.channel),anisotropyMapUv:Ot&&_(V.anisotropyMap.channel),clearcoatMapUv:Ut&&_(V.clearcoatMap.channel),clearcoatNormalMapUv:je&&_(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ge&&_(V.clearcoatRoughnessMap.channel),iridescenceMapUv:se&&_(V.iridescenceMap.channel),iridescenceThicknessMapUv:_e&&_(V.iridescenceThicknessMap.channel),sheenColorMapUv:Ie&&_(V.sheenColorMap.channel),sheenRoughnessMapUv:De&&_(V.sheenRoughnessMap.channel),specularMapUv:Oe&&_(V.specularMap.channel),specularColorMapUv:we&&_(V.specularColorMap.channel),specularIntensityMapUv:st&&_(V.specularIntensityMap.channel),transmissionMapUv:Ve&&_(V.transmissionMap.channel),thicknessMapUv:tt&&_(V.thicknessMap.channel),alphaMapUv:nt&&_(V.alphaMap.channel),vertexTangents:!!Q.attributes.tangent&&(ze||be),vertexColors:V.vertexColors,vertexAlphas:V.vertexColors===!0&&!!Q.attributes.color&&Q.attributes.color.itemSize===4,pointsUvs:$.isPoints===!0&&!!Q.attributes.uv&&($e||nt),fog:!!U,useFog:V.fog===!0,fogExp2:!!U&&U.isFogExp2,flatShading:V.flatShading===!0,sizeAttenuation:V.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:Ne,skinning:$.isSkinnedMesh===!0,morphTargets:Q.morphAttributes.position!==void 0,morphNormals:Q.morphAttributes.normal!==void 0,morphColors:Q.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:ne,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numSpotLightMaps:G.spotLightMap.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numSpotLightShadowsWithMaps:G.numSpotLightShadowsWithMaps,numLightProbes:G.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:V.dithering,shadowMapEnabled:n.shadowMap.enabled&&J.length>0,shadowMapType:n.shadowMap.type,toneMapping:mt,decodeVideoTexture:$e&&V.map.isVideoTexture===!0&&Ea.getTransfer(V.map.colorSpace)===Po,decodeVideoTextureEmissive:me&&V.emissiveMap.isVideoTexture===!0&&Ea.getTransfer(V.emissiveMap.colorSpace)===Po,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===$f,flipSided:V.side===Yf,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionClipCullDistance:ht&&V.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ht&&V.extensions.multiDraw===!0||Xe)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:V.customProgramCacheKey()};return ft.vertexUv1s=c.has(1),ft.vertexUv2s=c.has(2),ft.vertexUv3s=c.has(3),c.clear(),ft}function v(V){const G=[];if(V.shaderID?G.push(V.shaderID):(G.push(V.customVertexShaderID),G.push(V.customFragmentShaderID)),V.defines!==void 0)for(const J in V.defines)G.push(J),G.push(V.defines[J]);return V.isRawShaderMaterial===!1&&(x(G,V),E(G,V),G.push(n.outputColorSpace)),G.push(V.customProgramCacheKey),G.join()}function x(V,G){V.push(G.precision),V.push(G.outputColorSpace),V.push(G.envMapMode),V.push(G.envMapCubeUVHeight),V.push(G.mapUv),V.push(G.alphaMapUv),V.push(G.lightMapUv),V.push(G.aoMapUv),V.push(G.bumpMapUv),V.push(G.normalMapUv),V.push(G.displacementMapUv),V.push(G.emissiveMapUv),V.push(G.metalnessMapUv),V.push(G.roughnessMapUv),V.push(G.anisotropyMapUv),V.push(G.clearcoatMapUv),V.push(G.clearcoatNormalMapUv),V.push(G.clearcoatRoughnessMapUv),V.push(G.iridescenceMapUv),V.push(G.iridescenceThicknessMapUv),V.push(G.sheenColorMapUv),V.push(G.sheenRoughnessMapUv),V.push(G.specularMapUv),V.push(G.specularColorMapUv),V.push(G.specularIntensityMapUv),V.push(G.transmissionMapUv),V.push(G.thicknessMapUv),V.push(G.combine),V.push(G.fogExp2),V.push(G.sizeAttenuation),V.push(G.morphTargetsCount),V.push(G.morphAttributeCount),V.push(G.numDirLights),V.push(G.numPointLights),V.push(G.numSpotLights),V.push(G.numSpotLightMaps),V.push(G.numHemiLights),V.push(G.numRectAreaLights),V.push(G.numDirLightShadows),V.push(G.numPointLightShadows),V.push(G.numSpotLightShadows),V.push(G.numSpotLightShadowsWithMaps),V.push(G.numLightProbes),V.push(G.shadowMapType),V.push(G.toneMapping),V.push(G.numClippingPlanes),V.push(G.numClipIntersection),V.push(G.depthPacking)}function E(V,G){o.disableAll(),G.supportsVertexTextures&&o.enable(0),G.instancing&&o.enable(1),G.instancingColor&&o.enable(2),G.instancingMorph&&o.enable(3),G.matcap&&o.enable(4),G.envMap&&o.enable(5),G.normalMapObjectSpace&&o.enable(6),G.normalMapTangentSpace&&o.enable(7),G.clearcoat&&o.enable(8),G.iridescence&&o.enable(9),G.alphaTest&&o.enable(10),G.vertexColors&&o.enable(11),G.vertexAlphas&&o.enable(12),G.vertexUv1s&&o.enable(13),G.vertexUv2s&&o.enable(14),G.vertexUv3s&&o.enable(15),G.vertexTangents&&o.enable(16),G.anisotropy&&o.enable(17),G.alphaHash&&o.enable(18),G.batching&&o.enable(19),G.dispersion&&o.enable(20),G.batchingColor&&o.enable(21),V.push(o.mask),o.disableAll(),G.fog&&o.enable(0),G.useFog&&o.enable(1),G.flatShading&&o.enable(2),G.logarithmicDepthBuffer&&o.enable(3),G.reverseDepthBuffer&&o.enable(4),G.skinning&&o.enable(5),G.morphTargets&&o.enable(6),G.morphNormals&&o.enable(7),G.morphColors&&o.enable(8),G.premultipliedAlpha&&o.enable(9),G.shadowMapEnabled&&o.enable(10),G.doubleSided&&o.enable(11),G.flipSided&&o.enable(12),G.useDepthPacking&&o.enable(13),G.dithering&&o.enable(14),G.transmission&&o.enable(15),G.sheen&&o.enable(16),G.opaque&&o.enable(17),G.pointsUvs&&o.enable(18),G.decodeVideoTexture&&o.enable(19),G.decodeVideoTextureEmissive&&o.enable(20),G.alphaToCoverage&&o.enable(21),V.push(o.mask)}function M(V){const G=p[V.type];let J;if(G){const B=b_[G];J=Noe.clone(B.uniforms)}else J=V.uniforms;return J}function k(V,G){let J;for(let B=0,$=u.length;B<$;B++){const U=u[B];if(U.cacheKey===G){J=U,++J.usedTimes;break}}return J===void 0&&(J=new $2e(n,G,V,s),u.push(J)),J}function N(V){if(--V.usedTimes===0){const G=u.indexOf(V);u[G]=u[u.length-1],u.pop(),V.destroy()}}function I(V){l.remove(V)}function D(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:M,acquireProgram:k,releaseProgram:N,releaseShaderCache:I,programs:u,dispose:D}}function Z2e(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function r(a){n.delete(a)}function i(a,o,l){n.get(a)[o]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:r,update:i,dispose:s}}function J2e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function yY(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function bY(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(f,h,g,p,_,y){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:h,material:g,groupOrder:p,renderOrder:f.renderOrder,z:_,group:y},n[e]=v):(v.id=f.id,v.object=f,v.geometry=h,v.material=g,v.groupOrder=p,v.renderOrder=f.renderOrder,v.z=_,v.group=y),e++,v}function o(f,h,g,p,_,y){const v=a(f,h,g,p,_,y);g.transmission>0?r.push(v):g.transparent===!0?i.push(v):t.push(v)}function l(f,h,g,p,_,y){const v=a(f,h,g,p,_,y);g.transmission>0?r.unshift(v):g.transparent===!0?i.unshift(v):t.unshift(v)}function c(f,h){t.length>1&&t.sort(f||J2e),r.length>1&&r.sort(h||yY),i.length>1&&i.sort(h||yY)}function u(){for(let f=e,h=n.length;f<h;f++){const g=n[f];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:u,sort:c}}function Q2e(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new bY,n.set(r,[a])):i>=s.length?(a=new bY,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function eOe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ut,color:new cr};break;case"SpotLight":t={position:new ut,direction:new ut,color:new cr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ut,color:new cr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ut,skyColor:new cr,groundColor:new cr};break;case"RectAreaLight":t={color:new cr,position:new ut,halfWidth:new ut,halfHeight:new ut};break}return n[e.id]=t,t}}}function tOe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let nOe=0;function rOe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function iOe(n){const e=new eOe,t=tOe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)r.probe.push(new ut);const i=new ut,s=new Qr,a=new Qr;function o(c){let u=0,f=0,h=0;for(let V=0;V<9;V++)r.probe[V].set(0,0,0);let g=0,p=0,_=0,y=0,v=0,x=0,E=0,M=0,k=0,N=0,I=0;c.sort(rOe);for(let V=0,G=c.length;V<G;V++){const J=c[V],B=J.color,$=J.intensity,U=J.distance,Q=J.shadow&&J.shadow.map?J.shadow.map.texture:null;if(J.isAmbientLight)u+=B.r*$,f+=B.g*$,h+=B.b*$;else if(J.isLightProbe){for(let W=0;W<9;W++)r.probe[W].addScaledVector(J.sh.coefficients[W],$);I++}else if(J.isDirectionalLight){const W=e.get(J);if(W.color.copy(J.color).multiplyScalar(J.intensity),J.castShadow){const q=J.shadow,Y=t.get(J);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,r.directionalShadow[g]=Y,r.directionalShadowMap[g]=Q,r.directionalShadowMatrix[g]=J.shadow.matrix,x++}r.directional[g]=W,g++}else if(J.isSpotLight){const W=e.get(J);W.position.setFromMatrixPosition(J.matrixWorld),W.color.copy(B).multiplyScalar($),W.distance=U,W.coneCos=Math.cos(J.angle),W.penumbraCos=Math.cos(J.angle*(1-J.penumbra)),W.decay=J.decay,r.spot[_]=W;const q=J.shadow;if(J.map&&(r.spotLightMap[k]=J.map,k++,q.updateMatrices(J),J.castShadow&&N++),r.spotLightMatrix[_]=q.matrix,J.castShadow){const Y=t.get(J);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,r.spotShadow[_]=Y,r.spotShadowMap[_]=Q,M++}_++}else if(J.isRectAreaLight){const W=e.get(J);W.color.copy(B).multiplyScalar($),W.halfWidth.set(J.width*.5,0,0),W.halfHeight.set(0,J.height*.5,0),r.rectArea[y]=W,y++}else if(J.isPointLight){const W=e.get(J);if(W.color.copy(J.color).multiplyScalar(J.intensity),W.distance=J.distance,W.decay=J.decay,J.castShadow){const q=J.shadow,Y=t.get(J);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,Y.shadowCameraNear=q.camera.near,Y.shadowCameraFar=q.camera.far,r.pointShadow[p]=Y,r.pointShadowMap[p]=Q,r.pointShadowMatrix[p]=J.shadow.matrix,E++}r.point[p]=W,p++}else if(J.isHemisphereLight){const W=e.get(J);W.skyColor.copy(J.color).multiplyScalar($),W.groundColor.copy(J.groundColor).multiplyScalar($),r.hemi[v]=W,v++}}y>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=or.LTC_FLOAT_1,r.rectAreaLTC2=or.LTC_FLOAT_2):(r.rectAreaLTC1=or.LTC_HALF_1,r.rectAreaLTC2=or.LTC_HALF_2)),r.ambient[0]=u,r.ambient[1]=f,r.ambient[2]=h;const D=r.hash;(D.directionalLength!==g||D.pointLength!==p||D.spotLength!==_||D.rectAreaLength!==y||D.hemiLength!==v||D.numDirectionalShadows!==x||D.numPointShadows!==E||D.numSpotShadows!==M||D.numSpotMaps!==k||D.numLightProbes!==I)&&(r.directional.length=g,r.spot.length=_,r.rectArea.length=y,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=E,r.spotLightMatrix.length=M+k-N,r.spotLightMap.length=k,r.numSpotLightShadowsWithMaps=N,r.numLightProbes=I,D.directionalLength=g,D.pointLength=p,D.spotLength=_,D.rectAreaLength=y,D.hemiLength=v,D.numDirectionalShadows=x,D.numPointShadows=E,D.numSpotShadows=M,D.numSpotMaps=k,D.numLightProbes=I,r.version=nOe++)}function l(c,u){let f=0,h=0,g=0,p=0,_=0;const y=u.matrixWorldInverse;for(let v=0,x=c.length;v<x;v++){const E=c[v];if(E.isDirectionalLight){const M=r.directional[f];M.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(y),f++}else if(E.isSpotLight){const M=r.spot[g];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),M.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(y),g++}else if(E.isRectAreaLight){const M=r.rectArea[p];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),a.identity(),s.copy(E.matrixWorld),s.premultiply(y),a.extractRotation(s),M.halfWidth.set(E.width*.5,0,0),M.halfHeight.set(0,E.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),p++}else if(E.isPointLight){const M=r.point[h];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),h++}else if(E.isHemisphereLight){const M=r.hemi[_];M.direction.setFromMatrixPosition(E.matrixWorld),M.direction.transformDirection(y),_++}}}return{setup:o,setupView:l,state:r}}function SY(n){const e=new iOe(n),t=[],r=[];function i(u){c.camera=u,t.length=0,r.length=0}function s(u){t.push(u)}function a(u){r.push(u)}function o(){e.setup(t)}function l(u){e.setupView(t,u)}const c={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function sOe(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new SY(n),e.set(i,[o])):s>=a.length?(o=new SY(n),a.push(o)):o=a[s],o}function r(){e=new WeakMap}return{get:t,dispose:r}}const aOe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,oOe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function lOe(n,e,t){let r=new $w;const i=new an,s=new an,a=new Ta,o=new Sj({depthPacking:voe}),l=new Ej,c={},u=t.maxTextureSize,f={[Fv]:Yf,[Yf]:Fv,[$f]:$f},h=new Vl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new an},radius:{value:4}},vertexShader:aOe,fragmentShader:oOe}),g=h.clone();g.defines.HORIZONTAL_PASS=1;const p=new ns;p.setAttribute("position",new Ds(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new bu(p,h),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=x4;let v=this.type;this.render=function(N,I,D){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||N.length===0)return;const V=n.getRenderTarget(),G=n.getActiveCubeFace(),J=n.getActiveMipmapLevel(),B=n.state;B.setBlending(Ih),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);const $=v!==v_&&this.type===v_,U=v===v_&&this.type!==v_;for(let Q=0,W=N.length;Q<W;Q++){const q=N[Q],Y=q.shadow;if(Y===void 0){console.warn("THREE.WebGLShadowMap:",q,"has no shadow.");continue}if(Y.autoUpdate===!1&&Y.needsUpdate===!1)continue;i.copy(Y.mapSize);const ae=Y.getFrameExtents();if(i.multiply(ae),s.copy(Y.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/ae.x),i.x=s.x*ae.x,Y.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/ae.y),i.y=s.y*ae.y,Y.mapSize.y=s.y)),Y.map===null||$===!0||U===!0){const K=this.type!==v_?{minFilter:bf,magFilter:bf}:{};Y.map!==null&&Y.map.dispose(),Y.map=new Sf(i.x,i.y,K),Y.map.texture.name=q.name+".shadowMap",Y.camera.updateProjectionMatrix()}n.setRenderTarget(Y.map),n.clear();const Z=Y.getViewportCount();for(let K=0;K<Z;K++){const ne=Y.getViewport(K);a.set(s.x*ne.x,s.y*ne.y,s.x*ne.z,s.y*ne.w),B.viewport(a),Y.updateMatrices(q,K),r=Y.getFrustum(),M(I,D,Y.camera,q,this.type)}Y.isPointLightShadow!==!0&&this.type===v_&&x(Y,D),Y.needsUpdate=!1}v=this.type,y.needsUpdate=!1,n.setRenderTarget(V,G,J)};function x(N,I){const D=e.update(_);h.defines.VSM_SAMPLES!==N.blurSamples&&(h.defines.VSM_SAMPLES=N.blurSamples,g.defines.VSM_SAMPLES=N.blurSamples,h.needsUpdate=!0,g.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new Sf(i.x,i.y)),h.uniforms.shadow_pass.value=N.map.texture,h.uniforms.resolution.value=N.mapSize,h.uniforms.radius.value=N.radius,n.setRenderTarget(N.mapPass),n.clear(),n.renderBufferDirect(I,null,D,h,_,null),g.uniforms.shadow_pass.value=N.mapPass.texture,g.uniforms.resolution.value=N.mapSize,g.uniforms.radius.value=N.radius,n.setRenderTarget(N.map),n.clear(),n.renderBufferDirect(I,null,D,g,_,null)}function E(N,I,D,V){let G=null;const J=D.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(J!==void 0)G=J;else if(G=D.isPointLight===!0?l:o,n.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const B=G.uuid,$=I.uuid;let U=c[B];U===void 0&&(U={},c[B]=U);let Q=U[$];Q===void 0&&(Q=G.clone(),U[$]=Q,I.addEventListener("dispose",k)),G=Q}if(G.visible=I.visible,G.wireframe=I.wireframe,V===v_?G.side=I.shadowSide!==null?I.shadowSide:I.side:G.side=I.shadowSide!==null?I.shadowSide:f[I.side],G.alphaMap=I.alphaMap,G.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,G.map=I.map,G.clipShadows=I.clipShadows,G.clippingPlanes=I.clippingPlanes,G.clipIntersection=I.clipIntersection,G.displacementMap=I.displacementMap,G.displacementScale=I.displacementScale,G.displacementBias=I.displacementBias,G.wireframeLinewidth=I.wireframeLinewidth,G.linewidth=I.linewidth,D.isPointLight===!0&&G.isMeshDistanceMaterial===!0){const B=n.properties.get(G);B.light=D}return G}function M(N,I,D,V,G){if(N.visible===!1)return;if(N.layers.test(I.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&G===v_)&&(!N.frustumCulled||r.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,N.matrixWorld);const $=e.update(N),U=N.material;if(Array.isArray(U)){const Q=$.groups;for(let W=0,q=Q.length;W<q;W++){const Y=Q[W],ae=U[Y.materialIndex];if(ae&&ae.visible){const Z=E(N,ae,V,G);N.onBeforeShadow(n,N,I,D,$,Z,Y),n.renderBufferDirect(D,null,$,Z,N,Y),N.onAfterShadow(n,N,I,D,$,Z,Y)}}}else if(U.visible){const Q=E(N,U,V,G);N.onBeforeShadow(n,N,I,D,$,Q,null),n.renderBufferDirect(D,null,$,Q,N,null),N.onAfterShadow(n,N,I,D,$,Q,null)}}const B=N.children;for(let $=0,U=B.length;$<U;$++)M(B[$],I,D,V,G)}function k(N){N.target.removeEventListener("dispose",k);for(const D in c){const V=c[D],G=N.target.uuid;G in V&&(V[G].dispose(),delete V[G])}}}const cOe={[QP]:eD,[tD]:iD,[nD]:sD,[bE]:rD,[eD]:QP,[iD]:tD,[sD]:nD,[rD]:bE};function uOe(n,e){function t(){let Ve=!1;const tt=new Ta;let Ze=null;const nt=new Ta(0,0,0,0);return{setMask:function(vt){Ze!==vt&&!Ve&&(n.colorMask(vt,vt,vt,vt),Ze=vt)},setLocked:function(vt){Ve=vt},setClear:function(vt,Je,ht,mt,ft){ft===!0&&(vt*=mt,Je*=mt,ht*=mt),tt.set(vt,Je,ht,mt),nt.equals(tt)===!1&&(n.clearColor(vt,Je,ht,mt),nt.copy(tt))},reset:function(){Ve=!1,Ze=null,nt.set(-1,0,0,0)}}}function r(){let Ve=!1,tt=!1,Ze=null,nt=null,vt=null;return{setReversed:function(Je){if(tt!==Je){const ht=e.get("EXT_clip_control");Je?ht.clipControlEXT(ht.LOWER_LEFT_EXT,ht.ZERO_TO_ONE_EXT):ht.clipControlEXT(ht.LOWER_LEFT_EXT,ht.NEGATIVE_ONE_TO_ONE_EXT),tt=Je;const mt=vt;vt=null,this.setClear(mt)}},getReversed:function(){return tt},setTest:function(Je){Je?qe(n.DEPTH_TEST):Ne(n.DEPTH_TEST)},setMask:function(Je){Ze!==Je&&!Ve&&(n.depthMask(Je),Ze=Je)},setFunc:function(Je){if(tt&&(Je=cOe[Je]),nt!==Je){switch(Je){case QP:n.depthFunc(n.NEVER);break;case eD:n.depthFunc(n.ALWAYS);break;case tD:n.depthFunc(n.LESS);break;case bE:n.depthFunc(n.LEQUAL);break;case nD:n.depthFunc(n.EQUAL);break;case rD:n.depthFunc(n.GEQUAL);break;case iD:n.depthFunc(n.GREATER);break;case sD:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}nt=Je}},setLocked:function(Je){Ve=Je},setClear:function(Je){vt!==Je&&(tt&&(Je=1-Je),n.clearDepth(Je),vt=Je)},reset:function(){Ve=!1,Ze=null,nt=null,vt=null,tt=!1}}}function i(){let Ve=!1,tt=null,Ze=null,nt=null,vt=null,Je=null,ht=null,mt=null,ft=null;return{setTest:function(_t){Ve||(_t?qe(n.STENCIL_TEST):Ne(n.STENCIL_TEST))},setMask:function(_t){tt!==_t&&!Ve&&(n.stencilMask(_t),tt=_t)},setFunc:function(_t,gn,_n){(Ze!==_t||nt!==gn||vt!==_n)&&(n.stencilFunc(_t,gn,_n),Ze=_t,nt=gn,vt=_n)},setOp:function(_t,gn,_n){(Je!==_t||ht!==gn||mt!==_n)&&(n.stencilOp(_t,gn,_n),Je=_t,ht=gn,mt=_n)},setLocked:function(_t){Ve=_t},setClear:function(_t){ft!==_t&&(n.clearStencil(_t),ft=_t)},reset:function(){Ve=!1,tt=null,Ze=null,nt=null,vt=null,Je=null,ht=null,mt=null,ft=null}}}const s=new t,a=new r,o=new i,l=new WeakMap,c=new WeakMap;let u={},f={},h=new WeakMap,g=[],p=null,_=!1,y=null,v=null,x=null,E=null,M=null,k=null,N=null,I=new cr(0,0,0),D=0,V=!1,G=null,J=null,B=null,$=null,U=null;const Q=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,q=0;const Y=n.getParameter(n.VERSION);Y.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec(Y)[1]),W=q>=1):Y.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),W=q>=2);let ae=null,Z={};const K=n.getParameter(n.SCISSOR_BOX),ne=n.getParameter(n.VIEWPORT),le=new Ta().fromArray(K),ce=new Ta().fromArray(ne);function de(Ve,tt,Ze,nt){const vt=new Uint8Array(4),Je=n.createTexture();n.bindTexture(Ve,Je),n.texParameteri(Ve,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Ve,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ht=0;ht<Ze;ht++)Ve===n.TEXTURE_3D||Ve===n.TEXTURE_2D_ARRAY?n.texImage3D(tt,0,n.RGBA,1,1,nt,0,n.RGBA,n.UNSIGNED_BYTE,vt):n.texImage2D(tt+ht,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,vt);return Je}const Me={};Me[n.TEXTURE_2D]=de(n.TEXTURE_2D,n.TEXTURE_2D,1),Me[n.TEXTURE_CUBE_MAP]=de(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Me[n.TEXTURE_2D_ARRAY]=de(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Me[n.TEXTURE_3D]=de(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),qe(n.DEPTH_TEST),a.setFunc(bE),Ge(!1),ze(x7),qe(n.CULL_FACE),oe(Ih);function qe(Ve){u[Ve]!==!0&&(n.enable(Ve),u[Ve]=!0)}function Ne(Ve){u[Ve]!==!1&&(n.disable(Ve),u[Ve]=!1)}function Ae(Ve,tt){return f[Ve]!==tt?(n.bindFramebuffer(Ve,tt),f[Ve]=tt,Ve===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=tt),Ve===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=tt),!0):!1}function Xe(Ve,tt){let Ze=g,nt=!1;if(Ve){Ze=h.get(tt),Ze===void 0&&(Ze=[],h.set(tt,Ze));const vt=Ve.textures;if(Ze.length!==vt.length||Ze[0]!==n.COLOR_ATTACHMENT0){for(let Je=0,ht=vt.length;Je<ht;Je++)Ze[Je]=n.COLOR_ATTACHMENT0+Je;Ze.length=vt.length,nt=!0}}else Ze[0]!==n.BACK&&(Ze[0]=n.BACK,nt=!0);nt&&n.drawBuffers(Ze)}function $e(Ve){return p!==Ve?(n.useProgram(Ve),p=Ve,!0):!1}const at={[c1]:n.FUNC_ADD,[qae]:n.FUNC_SUBTRACT,[Vae]:n.FUNC_REVERSE_SUBTRACT};at[Gae]=n.MIN,at[$ae]=n.MAX;const pt={[Wae]:n.ZERO,[Yae]:n.ONE,[Xae]:n.SRC_COLOR,[ZP]:n.SRC_ALPHA,[toe]:n.SRC_ALPHA_SATURATE,[Qae]:n.DST_COLOR,[Zae]:n.DST_ALPHA,[Kae]:n.ONE_MINUS_SRC_COLOR,[JP]:n.ONE_MINUS_SRC_ALPHA,[eoe]:n.ONE_MINUS_DST_COLOR,[Jae]:n.ONE_MINUS_DST_ALPHA,[noe]:n.CONSTANT_COLOR,[roe]:n.ONE_MINUS_CONSTANT_COLOR,[ioe]:n.CONSTANT_ALPHA,[soe]:n.ONE_MINUS_CONSTANT_ALPHA};function oe(Ve,tt,Ze,nt,vt,Je,ht,mt,ft,_t){if(Ve===Ih){_===!0&&(Ne(n.BLEND),_=!1);return}if(_===!1&&(qe(n.BLEND),_=!0),Ve!==Hae){if(Ve!==y||_t!==V){if((v!==c1||M!==c1)&&(n.blendEquation(n.FUNC_ADD),v=c1,M=c1),_t)switch(Ve){case lE:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case T7:n.blendFunc(n.ONE,n.ONE);break;case w7:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case R7:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}else switch(Ve){case lE:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case T7:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case w7:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case R7:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}x=null,E=null,k=null,N=null,I.set(0,0,0),D=0,y=Ve,V=_t}return}vt=vt||tt,Je=Je||Ze,ht=ht||nt,(tt!==v||vt!==M)&&(n.blendEquationSeparate(at[tt],at[vt]),v=tt,M=vt),(Ze!==x||nt!==E||Je!==k||ht!==N)&&(n.blendFuncSeparate(pt[Ze],pt[nt],pt[Je],pt[ht]),x=Ze,E=nt,k=Je,N=ht),(mt.equals(I)===!1||ft!==D)&&(n.blendColor(mt.r,mt.g,mt.b,ft),I.copy(mt),D=ft),y=Ve,V=!1}function Ue(Ve,tt){Ve.side===$f?Ne(n.CULL_FACE):qe(n.CULL_FACE);let Ze=Ve.side===Yf;tt&&(Ze=!Ze),Ge(Ze),Ve.blending===lE&&Ve.transparent===!1?oe(Ih):oe(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst,Ve.blendEquationAlpha,Ve.blendSrcAlpha,Ve.blendDstAlpha,Ve.blendColor,Ve.blendAlpha,Ve.premultipliedAlpha),a.setFunc(Ve.depthFunc),a.setTest(Ve.depthTest),a.setMask(Ve.depthWrite),s.setMask(Ve.colorWrite);const nt=Ve.stencilWrite;o.setTest(nt),nt&&(o.setMask(Ve.stencilWriteMask),o.setFunc(Ve.stencilFunc,Ve.stencilRef,Ve.stencilFuncMask),o.setOp(Ve.stencilFail,Ve.stencilZFail,Ve.stencilZPass)),me(Ve.polygonOffset,Ve.polygonOffsetFactor,Ve.polygonOffsetUnits),Ve.alphaToCoverage===!0?qe(n.SAMPLE_ALPHA_TO_COVERAGE):Ne(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ge(Ve){G!==Ve&&(Ve?n.frontFace(n.CW):n.frontFace(n.CCW),G=Ve)}function ze(Ve){Ve!==Fae?(qe(n.CULL_FACE),Ve!==J&&(Ve===x7?n.cullFace(n.BACK):Ve===zae?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Ne(n.CULL_FACE),J=Ve}function Be(Ve){Ve!==B&&(W&&n.lineWidth(Ve),B=Ve)}function me(Ve,tt,Ze){Ve?(qe(n.POLYGON_OFFSET_FILL),($!==tt||U!==Ze)&&(n.polygonOffset(tt,Ze),$=tt,U=Ze)):Ne(n.POLYGON_OFFSET_FILL)}function Se(Ve){Ve?qe(n.SCISSOR_TEST):Ne(n.SCISSOR_TEST)}function ke(Ve){Ve===void 0&&(Ve=n.TEXTURE0+Q-1),ae!==Ve&&(n.activeTexture(Ve),ae=Ve)}function be(Ve,tt,Ze){Ze===void 0&&(ae===null?Ze=n.TEXTURE0+Q-1:Ze=ae);let nt=Z[Ze];nt===void 0&&(nt={type:void 0,texture:void 0},Z[Ze]=nt),(nt.type!==Ve||nt.texture!==tt)&&(ae!==Ze&&(n.activeTexture(Ze),ae=Ze),n.bindTexture(Ve,tt||Me[Ve]),nt.type=Ve,nt.texture=tt)}function Ke(){const Ve=Z[ae];Ve!==void 0&&Ve.type!==void 0&&(n.bindTexture(Ve.type,null),Ve.type=void 0,Ve.texture=void 0)}function ot(){try{n.compressedTexImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function lt(){try{n.compressedTexImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function ct(){try{n.texSubImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Vt(){try{n.texSubImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ot(){try{n.compressedTexSubImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ut(){try{n.compressedTexSubImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function je(){try{n.texStorage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function ge(){try{n.texStorage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function se(){try{n.texImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function _e(){try{n.texImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ie(Ve){le.equals(Ve)===!1&&(n.scissor(Ve.x,Ve.y,Ve.z,Ve.w),le.copy(Ve))}function De(Ve){ce.equals(Ve)===!1&&(n.viewport(Ve.x,Ve.y,Ve.z,Ve.w),ce.copy(Ve))}function Oe(Ve,tt){let Ze=c.get(tt);Ze===void 0&&(Ze=new WeakMap,c.set(tt,Ze));let nt=Ze.get(Ve);nt===void 0&&(nt=n.getUniformBlockIndex(tt,Ve.name),Ze.set(Ve,nt))}function we(Ve,tt){const nt=c.get(tt).get(Ve);l.get(tt)!==nt&&(n.uniformBlockBinding(tt,nt,Ve.__bindingPointIndex),l.set(tt,nt))}function st(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},ae=null,Z={},f={},h=new WeakMap,g=[],p=null,_=!1,y=null,v=null,x=null,E=null,M=null,k=null,N=null,I=new cr(0,0,0),D=0,V=!1,G=null,J=null,B=null,$=null,U=null,le.set(0,0,n.canvas.width,n.canvas.height),ce.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:qe,disable:Ne,bindFramebuffer:Ae,drawBuffers:Xe,useProgram:$e,setBlending:oe,setMaterial:Ue,setFlipSided:Ge,setCullFace:ze,setLineWidth:Be,setPolygonOffset:me,setScissorTest:Se,activeTexture:ke,bindTexture:be,unbindTexture:Ke,compressedTexImage2D:ot,compressedTexImage3D:lt,texImage2D:se,texImage3D:_e,updateUBOMapping:Oe,uniformBlockBinding:we,texStorage2D:je,texStorage3D:ge,texSubImage2D:ct,texSubImage3D:Vt,compressedTexSubImage2D:Ot,compressedTexSubImage3D:Ut,scissor:Ie,viewport:De,reset:st}}function fOe(n,e,t,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new an,u=new WeakMap;let f;const h=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(ke,be){return g?new OffscreenCanvas(ke,be):sO("canvas")}function _(ke,be,Ke){let ot=1;const lt=Se(ke);if((lt.width>Ke||lt.height>Ke)&&(ot=Ke/Math.max(lt.width,lt.height)),ot<1)if(typeof HTMLImageElement<"u"&&ke instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ke instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ke instanceof ImageBitmap||typeof VideoFrame<"u"&&ke instanceof VideoFrame){const ct=Math.floor(ot*lt.width),Vt=Math.floor(ot*lt.height);f===void 0&&(f=p(ct,Vt));const Ot=be?p(ct,Vt):f;return Ot.width=ct,Ot.height=Vt,Ot.getContext("2d").drawImage(ke,0,0,ct,Vt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+lt.width+"x"+lt.height+") to ("+ct+"x"+Vt+")."),Ot}else return"data"in ke&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+lt.width+"x"+lt.height+")."),ke;return ke}function y(ke){return ke.generateMipmaps}function v(ke){n.generateMipmap(ke)}function x(ke){return ke.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:ke.isWebGL3DRenderTarget?n.TEXTURE_3D:ke.isWebGLArrayRenderTarget||ke.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function E(ke,be,Ke,ot,lt=!1){if(ke!==null){if(n[ke]!==void 0)return n[ke];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ke+"'")}let ct=be;if(be===n.RED&&(Ke===n.FLOAT&&(ct=n.R32F),Ke===n.HALF_FLOAT&&(ct=n.R16F),Ke===n.UNSIGNED_BYTE&&(ct=n.R8)),be===n.RED_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.R8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.R16UI),Ke===n.UNSIGNED_INT&&(ct=n.R32UI),Ke===n.BYTE&&(ct=n.R8I),Ke===n.SHORT&&(ct=n.R16I),Ke===n.INT&&(ct=n.R32I)),be===n.RG&&(Ke===n.FLOAT&&(ct=n.RG32F),Ke===n.HALF_FLOAT&&(ct=n.RG16F),Ke===n.UNSIGNED_BYTE&&(ct=n.RG8)),be===n.RG_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RG8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RG16UI),Ke===n.UNSIGNED_INT&&(ct=n.RG32UI),Ke===n.BYTE&&(ct=n.RG8I),Ke===n.SHORT&&(ct=n.RG16I),Ke===n.INT&&(ct=n.RG32I)),be===n.RGB_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RGB8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RGB16UI),Ke===n.UNSIGNED_INT&&(ct=n.RGB32UI),Ke===n.BYTE&&(ct=n.RGB8I),Ke===n.SHORT&&(ct=n.RGB16I),Ke===n.INT&&(ct=n.RGB32I)),be===n.RGBA_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RGBA8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RGBA16UI),Ke===n.UNSIGNED_INT&&(ct=n.RGBA32UI),Ke===n.BYTE&&(ct=n.RGBA8I),Ke===n.SHORT&&(ct=n.RGBA16I),Ke===n.INT&&(ct=n.RGBA32I)),be===n.RGB&&Ke===n.UNSIGNED_INT_5_9_9_9_REV&&(ct=n.RGB9_E5),be===n.RGBA){const Vt=lt?nO:Ea.getTransfer(ot);Ke===n.FLOAT&&(ct=n.RGBA32F),Ke===n.HALF_FLOAT&&(ct=n.RGBA16F),Ke===n.UNSIGNED_BYTE&&(ct=Vt===Po?n.SRGB8_ALPHA8:n.RGBA8),Ke===n.UNSIGNED_SHORT_4_4_4_4&&(ct=n.RGBA4),Ke===n.UNSIGNED_SHORT_5_5_5_1&&(ct=n.RGB5_A1)}return(ct===n.R16F||ct===n.R32F||ct===n.RG16F||ct===n.RG32F||ct===n.RGBA16F||ct===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ct}function M(ke,be){let Ke;return ke?be===null||be===zv||be===SE?Ke=n.DEPTH24_STENCIL8:be===Pp?Ke=n.DEPTH32F_STENCIL8:be===XT&&(Ke=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):be===null||be===zv||be===SE?Ke=n.DEPTH_COMPONENT24:be===Pp?Ke=n.DEPTH_COMPONENT32F:be===XT&&(Ke=n.DEPTH_COMPONENT16),Ke}function k(ke,be){return y(ke)===!0||ke.isFramebufferTexture&&ke.minFilter!==bf&&ke.minFilter!==sc?Math.log2(Math.max(be.width,be.height))+1:ke.mipmaps!==void 0&&ke.mipmaps.length>0?ke.mipmaps.length:ke.isCompressedTexture&&Array.isArray(ke.image)?be.mipmaps.length:1}function N(ke){const be=ke.target;be.removeEventListener("dispose",N),D(be),be.isVideoTexture&&u.delete(be)}function I(ke){const be=ke.target;be.removeEventListener("dispose",I),G(be)}function D(ke){const be=r.get(ke);if(be.__webglInit===void 0)return;const Ke=ke.source,ot=h.get(Ke);if(ot){const lt=ot[be.__cacheKey];lt.usedTimes--,lt.usedTimes===0&&V(ke),Object.keys(ot).length===0&&h.delete(Ke)}r.remove(ke)}function V(ke){const be=r.get(ke);n.deleteTexture(be.__webglTexture);const Ke=ke.source,ot=h.get(Ke);delete ot[be.__cacheKey],a.memory.textures--}function G(ke){const be=r.get(ke);if(ke.depthTexture&&(ke.depthTexture.dispose(),r.remove(ke.depthTexture)),ke.isWebGLCubeRenderTarget)for(let ot=0;ot<6;ot++){if(Array.isArray(be.__webglFramebuffer[ot]))for(let lt=0;lt<be.__webglFramebuffer[ot].length;lt++)n.deleteFramebuffer(be.__webglFramebuffer[ot][lt]);else n.deleteFramebuffer(be.__webglFramebuffer[ot]);be.__webglDepthbuffer&&n.deleteRenderbuffer(be.__webglDepthbuffer[ot])}else{if(Array.isArray(be.__webglFramebuffer))for(let ot=0;ot<be.__webglFramebuffer.length;ot++)n.deleteFramebuffer(be.__webglFramebuffer[ot]);else n.deleteFramebuffer(be.__webglFramebuffer);if(be.__webglDepthbuffer&&n.deleteRenderbuffer(be.__webglDepthbuffer),be.__webglMultisampledFramebuffer&&n.deleteFramebuffer(be.__webglMultisampledFramebuffer),be.__webglColorRenderbuffer)for(let ot=0;ot<be.__webglColorRenderbuffer.length;ot++)be.__webglColorRenderbuffer[ot]&&n.deleteRenderbuffer(be.__webglColorRenderbuffer[ot]);be.__webglDepthRenderbuffer&&n.deleteRenderbuffer(be.__webglDepthRenderbuffer)}const Ke=ke.textures;for(let ot=0,lt=Ke.length;ot<lt;ot++){const ct=r.get(Ke[ot]);ct.__webglTexture&&(n.deleteTexture(ct.__webglTexture),a.memory.textures--),r.remove(Ke[ot])}r.remove(ke)}let J=0;function B(){J=0}function $(){const ke=J;return ke>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ke+" texture units while this GPU supports only "+i.maxTextures),J+=1,ke}function U(ke){const be=[];return be.push(ke.wrapS),be.push(ke.wrapT),be.push(ke.wrapR||0),be.push(ke.magFilter),be.push(ke.minFilter),be.push(ke.anisotropy),be.push(ke.internalFormat),be.push(ke.format),be.push(ke.type),be.push(ke.generateMipmaps),be.push(ke.premultiplyAlpha),be.push(ke.flipY),be.push(ke.unpackAlignment),be.push(ke.colorSpace),be.join()}function Q(ke,be){const Ke=r.get(ke);if(ke.isVideoTexture&&Be(ke),ke.isRenderTargetTexture===!1&&ke.version>0&&Ke.__version!==ke.version){const ot=ke.image;if(ot===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ot.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ce(Ke,ke,be);return}}t.bindTexture(n.TEXTURE_2D,Ke.__webglTexture,n.TEXTURE0+be)}function W(ke,be){const Ke=r.get(ke);if(ke.version>0&&Ke.__version!==ke.version){ce(Ke,ke,be);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Ke.__webglTexture,n.TEXTURE0+be)}function q(ke,be){const Ke=r.get(ke);if(ke.version>0&&Ke.__version!==ke.version){ce(Ke,ke,be);return}t.bindTexture(n.TEXTURE_3D,Ke.__webglTexture,n.TEXTURE0+be)}function Y(ke,be){const Ke=r.get(ke);if(ke.version>0&&Ke.__version!==ke.version){de(Ke,ke,be);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Ke.__webglTexture,n.TEXTURE0+be)}const ae={[YT]:n.REPEAT,[I0]:n.CLAMP_TO_EDGE,[Q2]:n.MIRRORED_REPEAT},Z={[bf]:n.NEAREST,[Qz]:n.NEAREST_MIPMAP_NEAREST,[ET]:n.NEAREST_MIPMAP_LINEAR,[sc]:n.LINEAR,[M2]:n.LINEAR_MIPMAP_NEAREST,[Rv]:n.LINEAR_MIPMAP_LINEAR},K={[boe]:n.NEVER,[Roe]:n.ALWAYS,[Soe]:n.LESS,[oj]:n.LEQUAL,[Eoe]:n.EQUAL,[woe]:n.GEQUAL,[xoe]:n.GREATER,[Toe]:n.NOTEQUAL};function ne(ke,be){if(be.type===Pp&&e.has("OES_texture_float_linear")===!1&&(be.magFilter===sc||be.magFilter===M2||be.magFilter===ET||be.magFilter===Rv||be.minFilter===sc||be.minFilter===M2||be.minFilter===ET||be.minFilter===Rv)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(ke,n.TEXTURE_WRAP_S,ae[be.wrapS]),n.texParameteri(ke,n.TEXTURE_WRAP_T,ae[be.wrapT]),(ke===n.TEXTURE_3D||ke===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ke,n.TEXTURE_WRAP_R,ae[be.wrapR]),n.texParameteri(ke,n.TEXTURE_MAG_FILTER,Z[be.magFilter]),n.texParameteri(ke,n.TEXTURE_MIN_FILTER,Z[be.minFilter]),be.compareFunction&&(n.texParameteri(ke,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ke,n.TEXTURE_COMPARE_FUNC,K[be.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(be.magFilter===bf||be.minFilter!==ET&&be.minFilter!==Rv||be.type===Pp&&e.has("OES_texture_float_linear")===!1)return;if(be.anisotropy>1||r.get(be).__currentAnisotropy){const Ke=e.get("EXT_texture_filter_anisotropic");n.texParameterf(ke,Ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(be.anisotropy,i.getMaxAnisotropy())),r.get(be).__currentAnisotropy=be.anisotropy}}}function le(ke,be){let Ke=!1;ke.__webglInit===void 0&&(ke.__webglInit=!0,be.addEventListener("dispose",N));const ot=be.source;let lt=h.get(ot);lt===void 0&&(lt={},h.set(ot,lt));const ct=U(be);if(ct!==ke.__cacheKey){lt[ct]===void 0&&(lt[ct]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,Ke=!0),lt[ct].usedTimes++;const Vt=lt[ke.__cacheKey];Vt!==void 0&&(lt[ke.__cacheKey].usedTimes--,Vt.usedTimes===0&&V(be)),ke.__cacheKey=ct,ke.__webglTexture=lt[ct].texture}return Ke}function ce(ke,be,Ke){let ot=n.TEXTURE_2D;(be.isDataArrayTexture||be.isCompressedArrayTexture)&&(ot=n.TEXTURE_2D_ARRAY),be.isData3DTexture&&(ot=n.TEXTURE_3D);const lt=le(ke,be),ct=be.source;t.bindTexture(ot,ke.__webglTexture,n.TEXTURE0+Ke);const Vt=r.get(ct);if(ct.version!==Vt.__version||lt===!0){t.activeTexture(n.TEXTURE0+Ke);const Ot=Ea.getPrimaries(Ea.workingColorSpace),Ut=be.colorSpace===x_?null:Ea.getPrimaries(be.colorSpace),je=be.colorSpace===x_||Ot===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,be.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,be.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,je);let ge=_(be.image,!1,i.maxTextureSize);ge=me(be,ge);const se=s.convert(be.format,be.colorSpace),_e=s.convert(be.type);let Ie=E(be.internalFormat,se,_e,be.colorSpace,be.isVideoTexture);ne(ot,be);let De;const Oe=be.mipmaps,we=be.isVideoTexture!==!0,st=Vt.__version===void 0||lt===!0,Ve=ct.dataReady,tt=k(be,ge);if(be.isDepthTexture)Ie=M(be.format===EE,be.type),st&&(we?t.texStorage2D(n.TEXTURE_2D,1,Ie,ge.width,ge.height):t.texImage2D(n.TEXTURE_2D,0,Ie,ge.width,ge.height,0,se,_e,null));else if(be.isDataTexture)if(Oe.length>0){we&&st&&t.texStorage2D(n.TEXTURE_2D,tt,Ie,Oe[0].width,Oe[0].height);for(let Ze=0,nt=Oe.length;Ze<nt;Ze++)De=Oe[Ze],we?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,De.width,De.height,se,_e,De.data):t.texImage2D(n.TEXTURE_2D,Ze,Ie,De.width,De.height,0,se,_e,De.data);be.generateMipmaps=!1}else we?(st&&t.texStorage2D(n.TEXTURE_2D,tt,Ie,ge.width,ge.height),Ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ge.width,ge.height,se,_e,ge.data)):t.texImage2D(n.TEXTURE_2D,0,Ie,ge.width,ge.height,0,se,_e,ge.data);else if(be.isCompressedTexture)if(be.isCompressedArrayTexture){we&&st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,tt,Ie,Oe[0].width,Oe[0].height,ge.depth);for(let Ze=0,nt=Oe.length;Ze<nt;Ze++)if(De=Oe[Ze],be.format!==Xf)if(se!==null)if(we){if(Ve)if(be.layerUpdates.size>0){const vt=U7(De.width,De.height,be.format,be.type);for(const Je of be.layerUpdates){const ht=De.data.subarray(Je*vt/De.data.BYTES_PER_ELEMENT,(Je+1)*vt/De.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,Je,De.width,De.height,1,se,ht)}be.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,0,De.width,De.height,ge.depth,se,De.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ze,Ie,De.width,De.height,ge.depth,0,De.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else we?Ve&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,0,De.width,De.height,ge.depth,se,_e,De.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ze,Ie,De.width,De.height,ge.depth,0,se,_e,De.data)}else{we&&st&&t.texStorage2D(n.TEXTURE_2D,tt,Ie,Oe[0].width,Oe[0].height);for(let Ze=0,nt=Oe.length;Ze<nt;Ze++)De=Oe[Ze],be.format!==Xf?se!==null?we?Ve&&t.compressedTexSubImage2D(n.TEXTURE_2D,Ze,0,0,De.width,De.height,se,De.data):t.compressedTexImage2D(n.TEXTURE_2D,Ze,Ie,De.width,De.height,0,De.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):we?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,De.width,De.height,se,_e,De.data):t.texImage2D(n.TEXTURE_2D,Ze,Ie,De.width,De.height,0,se,_e,De.data)}else if(be.isDataArrayTexture)if(we){if(st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,tt,Ie,ge.width,ge.height,ge.depth),Ve)if(be.layerUpdates.size>0){const Ze=U7(ge.width,ge.height,be.format,be.type);for(const nt of be.layerUpdates){const vt=ge.data.subarray(nt*Ze/ge.data.BYTES_PER_ELEMENT,(nt+1)*Ze/ge.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,nt,ge.width,ge.height,1,se,_e,vt)}be.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ge.width,ge.height,ge.depth,se,_e,ge.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ie,ge.width,ge.height,ge.depth,0,se,_e,ge.data);else if(be.isData3DTexture)we?(st&&t.texStorage3D(n.TEXTURE_3D,tt,Ie,ge.width,ge.height,ge.depth),Ve&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ge.width,ge.height,ge.depth,se,_e,ge.data)):t.texImage3D(n.TEXTURE_3D,0,Ie,ge.width,ge.height,ge.depth,0,se,_e,ge.data);else if(be.isFramebufferTexture){if(st)if(we)t.texStorage2D(n.TEXTURE_2D,tt,Ie,ge.width,ge.height);else{let Ze=ge.width,nt=ge.height;for(let vt=0;vt<tt;vt++)t.texImage2D(n.TEXTURE_2D,vt,Ie,Ze,nt,0,se,_e,null),Ze>>=1,nt>>=1}}else if(Oe.length>0){if(we&&st){const Ze=Se(Oe[0]);t.texStorage2D(n.TEXTURE_2D,tt,Ie,Ze.width,Ze.height)}for(let Ze=0,nt=Oe.length;Ze<nt;Ze++)De=Oe[Ze],we?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,se,_e,De):t.texImage2D(n.TEXTURE_2D,Ze,Ie,se,_e,De);be.generateMipmaps=!1}else if(we){if(st){const Ze=Se(ge);t.texStorage2D(n.TEXTURE_2D,tt,Ie,Ze.width,Ze.height)}Ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,se,_e,ge)}else t.texImage2D(n.TEXTURE_2D,0,Ie,se,_e,ge);y(be)&&v(ot),Vt.__version=ct.version,be.onUpdate&&be.onUpdate(be)}ke.__version=be.version}function de(ke,be,Ke){if(be.image.length!==6)return;const ot=le(ke,be),lt=be.source;t.bindTexture(n.TEXTURE_CUBE_MAP,ke.__webglTexture,n.TEXTURE0+Ke);const ct=r.get(lt);if(lt.version!==ct.__version||ot===!0){t.activeTexture(n.TEXTURE0+Ke);const Vt=Ea.getPrimaries(Ea.workingColorSpace),Ot=be.colorSpace===x_?null:Ea.getPrimaries(be.colorSpace),Ut=be.colorSpace===x_||Vt===Ot?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,be.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,be.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);const je=be.isCompressedTexture||be.image[0].isCompressedTexture,ge=be.image[0]&&be.image[0].isDataTexture,se=[];for(let nt=0;nt<6;nt++)!je&&!ge?se[nt]=_(be.image[nt],!0,i.maxCubemapSize):se[nt]=ge?be.image[nt].image:be.image[nt],se[nt]=me(be,se[nt]);const _e=se[0],Ie=s.convert(be.format,be.colorSpace),De=s.convert(be.type),Oe=E(be.internalFormat,Ie,De,be.colorSpace),we=be.isVideoTexture!==!0,st=ct.__version===void 0||ot===!0,Ve=lt.dataReady;let tt=k(be,_e);ne(n.TEXTURE_CUBE_MAP,be);let Ze;if(je){we&&st&&t.texStorage2D(n.TEXTURE_CUBE_MAP,tt,Oe,_e.width,_e.height);for(let nt=0;nt<6;nt++){Ze=se[nt].mipmaps;for(let vt=0;vt<Ze.length;vt++){const Je=Ze[vt];be.format!==Xf?Ie!==null?we?Ve&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,0,0,Je.width,Je.height,Ie,Je.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,Oe,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):we?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,0,0,Je.width,Je.height,Ie,De,Je.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,Oe,Je.width,Je.height,0,Ie,De,Je.data)}}}else{if(Ze=be.mipmaps,we&&st){Ze.length>0&&tt++;const nt=Se(se[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,tt,Oe,nt.width,nt.height)}for(let nt=0;nt<6;nt++)if(ge){we?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,se[nt].width,se[nt].height,Ie,De,se[nt].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,Oe,se[nt].width,se[nt].height,0,Ie,De,se[nt].data);for(let vt=0;vt<Ze.length;vt++){const ht=Ze[vt].image[nt].image;we?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,0,0,ht.width,ht.height,Ie,De,ht.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,Oe,ht.width,ht.height,0,Ie,De,ht.data)}}else{we?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,Ie,De,se[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,Oe,Ie,De,se[nt]);for(let vt=0;vt<Ze.length;vt++){const Je=Ze[vt];we?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,0,0,Ie,De,Je.image[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,Oe,Ie,De,Je.image[nt])}}}y(be)&&v(n.TEXTURE_CUBE_MAP),ct.__version=lt.version,be.onUpdate&&be.onUpdate(be)}ke.__version=be.version}function Me(ke,be,Ke,ot,lt,ct){const Vt=s.convert(Ke.format,Ke.colorSpace),Ot=s.convert(Ke.type),Ut=E(Ke.internalFormat,Vt,Ot,Ke.colorSpace),je=r.get(be),ge=r.get(Ke);if(ge.__renderTarget=be,!je.__hasExternalTextures){const se=Math.max(1,be.width>>ct),_e=Math.max(1,be.height>>ct);lt===n.TEXTURE_3D||lt===n.TEXTURE_2D_ARRAY?t.texImage3D(lt,ct,Ut,se,_e,be.depth,0,Vt,Ot,null):t.texImage2D(lt,ct,Ut,se,_e,0,Vt,Ot,null)}t.bindFramebuffer(n.FRAMEBUFFER,ke),ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ot,lt,ge.__webglTexture,0,Ge(be)):(lt===n.TEXTURE_2D||lt>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&lt<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ot,lt,ge.__webglTexture,ct),t.bindFramebuffer(n.FRAMEBUFFER,null)}function qe(ke,be,Ke){if(n.bindRenderbuffer(n.RENDERBUFFER,ke),be.depthBuffer){const ot=be.depthTexture,lt=ot&&ot.isDepthTexture?ot.type:null,ct=M(be.stencilBuffer,lt),Vt=be.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ot=Ge(be);ze(be)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ot,ct,be.width,be.height):Ke?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ot,ct,be.width,be.height):n.renderbufferStorage(n.RENDERBUFFER,ct,be.width,be.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Vt,n.RENDERBUFFER,ke)}else{const ot=be.textures;for(let lt=0;lt<ot.length;lt++){const ct=ot[lt],Vt=s.convert(ct.format,ct.colorSpace),Ot=s.convert(ct.type),Ut=E(ct.internalFormat,Vt,Ot,ct.colorSpace),je=Ge(be);Ke&&ze(be)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,je,Ut,be.width,be.height):ze(be)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,je,Ut,be.width,be.height):n.renderbufferStorage(n.RENDERBUFFER,Ut,be.width,be.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ne(ke,be){if(be&&be.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,ke),!(be.depthTexture&&be.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ot=r.get(be.depthTexture);ot.__renderTarget=be,(!ot.__webglTexture||be.depthTexture.image.width!==be.width||be.depthTexture.image.height!==be.height)&&(be.depthTexture.image.width=be.width,be.depthTexture.image.height=be.height,be.depthTexture.needsUpdate=!0),Q(be.depthTexture,0);const lt=ot.__webglTexture,ct=Ge(be);if(be.depthTexture.format===KT)ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,lt,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,lt,0);else if(be.depthTexture.format===EE)ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,lt,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,lt,0);else throw new Error("Unknown depthTexture format")}function Ae(ke){const be=r.get(ke),Ke=ke.isWebGLCubeRenderTarget===!0;if(be.__boundDepthTexture!==ke.depthTexture){const ot=ke.depthTexture;if(be.__depthDisposeCallback&&be.__depthDisposeCallback(),ot){const lt=()=>{delete be.__boundDepthTexture,delete be.__depthDisposeCallback,ot.removeEventListener("dispose",lt)};ot.addEventListener("dispose",lt),be.__depthDisposeCallback=lt}be.__boundDepthTexture=ot}if(ke.depthTexture&&!be.__autoAllocateDepthBuffer){if(Ke)throw new Error("target.depthTexture not supported in Cube render targets");const ot=ke.texture.mipmaps;ot&&ot.length>0?Ne(be.__webglFramebuffer[0],ke):Ne(be.__webglFramebuffer,ke)}else if(Ke){be.__webglDepthbuffer=[];for(let ot=0;ot<6;ot++)if(t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer[ot]),be.__webglDepthbuffer[ot]===void 0)be.__webglDepthbuffer[ot]=n.createRenderbuffer(),qe(be.__webglDepthbuffer[ot],ke,!1);else{const lt=ke.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ct=be.__webglDepthbuffer[ot];n.bindRenderbuffer(n.RENDERBUFFER,ct),n.framebufferRenderbuffer(n.FRAMEBUFFER,lt,n.RENDERBUFFER,ct)}}else{const ot=ke.texture.mipmaps;if(ot&&ot.length>0?t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer),be.__webglDepthbuffer===void 0)be.__webglDepthbuffer=n.createRenderbuffer(),qe(be.__webglDepthbuffer,ke,!1);else{const lt=ke.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ct=be.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ct),n.framebufferRenderbuffer(n.FRAMEBUFFER,lt,n.RENDERBUFFER,ct)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Xe(ke,be,Ke){const ot=r.get(ke);be!==void 0&&Me(ot.__webglFramebuffer,ke,ke.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Ke!==void 0&&Ae(ke)}function $e(ke){const be=ke.texture,Ke=r.get(ke),ot=r.get(be);ke.addEventListener("dispose",I);const lt=ke.textures,ct=ke.isWebGLCubeRenderTarget===!0,Vt=lt.length>1;if(Vt||(ot.__webglTexture===void 0&&(ot.__webglTexture=n.createTexture()),ot.__version=be.version,a.memory.textures++),ct){Ke.__webglFramebuffer=[];for(let Ot=0;Ot<6;Ot++)if(be.mipmaps&&be.mipmaps.length>0){Ke.__webglFramebuffer[Ot]=[];for(let Ut=0;Ut<be.mipmaps.length;Ut++)Ke.__webglFramebuffer[Ot][Ut]=n.createFramebuffer()}else Ke.__webglFramebuffer[Ot]=n.createFramebuffer()}else{if(be.mipmaps&&be.mipmaps.length>0){Ke.__webglFramebuffer=[];for(let Ot=0;Ot<be.mipmaps.length;Ot++)Ke.__webglFramebuffer[Ot]=n.createFramebuffer()}else Ke.__webglFramebuffer=n.createFramebuffer();if(Vt)for(let Ot=0,Ut=lt.length;Ot<Ut;Ot++){const je=r.get(lt[Ot]);je.__webglTexture===void 0&&(je.__webglTexture=n.createTexture(),a.memory.textures++)}if(ke.samples>0&&ze(ke)===!1){Ke.__webglMultisampledFramebuffer=n.createFramebuffer(),Ke.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer);for(let Ot=0;Ot<lt.length;Ot++){const Ut=lt[Ot];Ke.__webglColorRenderbuffer[Ot]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Ke.__webglColorRenderbuffer[Ot]);const je=s.convert(Ut.format,Ut.colorSpace),ge=s.convert(Ut.type),se=E(Ut.internalFormat,je,ge,Ut.colorSpace,ke.isXRRenderTarget===!0),_e=Ge(ke);n.renderbufferStorageMultisample(n.RENDERBUFFER,_e,se,ke.width,ke.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ot,n.RENDERBUFFER,Ke.__webglColorRenderbuffer[Ot])}n.bindRenderbuffer(n.RENDERBUFFER,null),ke.depthBuffer&&(Ke.__webglDepthRenderbuffer=n.createRenderbuffer(),qe(Ke.__webglDepthRenderbuffer,ke,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ct){t.bindTexture(n.TEXTURE_CUBE_MAP,ot.__webglTexture),ne(n.TEXTURE_CUBE_MAP,be);for(let Ot=0;Ot<6;Ot++)if(be.mipmaps&&be.mipmaps.length>0)for(let Ut=0;Ut<be.mipmaps.length;Ut++)Me(Ke.__webglFramebuffer[Ot][Ut],ke,be,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,Ut);else Me(Ke.__webglFramebuffer[Ot],ke,be,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ot,0);y(be)&&v(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Vt){for(let Ot=0,Ut=lt.length;Ot<Ut;Ot++){const je=lt[Ot],ge=r.get(je);t.bindTexture(n.TEXTURE_2D,ge.__webglTexture),ne(n.TEXTURE_2D,je),Me(Ke.__webglFramebuffer,ke,je,n.COLOR_ATTACHMENT0+Ot,n.TEXTURE_2D,0),y(je)&&v(n.TEXTURE_2D)}t.unbindTexture()}else{let Ot=n.TEXTURE_2D;if((ke.isWebGL3DRenderTarget||ke.isWebGLArrayRenderTarget)&&(Ot=ke.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ot,ot.__webglTexture),ne(Ot,be),be.mipmaps&&be.mipmaps.length>0)for(let Ut=0;Ut<be.mipmaps.length;Ut++)Me(Ke.__webglFramebuffer[Ut],ke,be,n.COLOR_ATTACHMENT0,Ot,Ut);else Me(Ke.__webglFramebuffer,ke,be,n.COLOR_ATTACHMENT0,Ot,0);y(be)&&v(Ot),t.unbindTexture()}ke.depthBuffer&&Ae(ke)}function at(ke){const be=ke.textures;for(let Ke=0,ot=be.length;Ke<ot;Ke++){const lt=be[Ke];if(y(lt)){const ct=x(ke),Vt=r.get(lt).__webglTexture;t.bindTexture(ct,Vt),v(ct),t.unbindTexture()}}}const pt=[],oe=[];function Ue(ke){if(ke.samples>0){if(ze(ke)===!1){const be=ke.textures,Ke=ke.width,ot=ke.height;let lt=n.COLOR_BUFFER_BIT;const ct=ke.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Vt=r.get(ke),Ot=be.length>1;if(Ot)for(let je=0;je<be.length;je++)t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer);const Ut=ke.texture.mipmaps;Ut&&Ut.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglFramebuffer);for(let je=0;je<be.length;je++){if(ke.resolveDepthBuffer&&(ke.depthBuffer&&(lt|=n.DEPTH_BUFFER_BIT),ke.stencilBuffer&&ke.resolveStencilBuffer&&(lt|=n.STENCIL_BUFFER_BIT)),Ot){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Vt.__webglColorRenderbuffer[je]);const ge=r.get(be[je]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ge,0)}n.blitFramebuffer(0,0,Ke,ot,0,0,Ke,ot,lt,n.NEAREST),l===!0&&(pt.length=0,oe.length=0,pt.push(n.COLOR_ATTACHMENT0+je),ke.depthBuffer&&ke.resolveDepthBuffer===!1&&(pt.push(ct),oe.push(ct),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,oe)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,pt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ot)for(let je=0;je<be.length;je++){t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.RENDERBUFFER,Vt.__webglColorRenderbuffer[je]);const ge=r.get(be[je]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.TEXTURE_2D,ge,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer)}else if(ke.depthBuffer&&ke.resolveDepthBuffer===!1&&l){const be=ke.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[be])}}}function Ge(ke){return Math.min(i.maxSamples,ke.samples)}function ze(ke){const be=r.get(ke);return ke.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&be.__useRenderToTexture!==!1}function Be(ke){const be=a.render.frame;u.get(ke)!==be&&(u.set(ke,be),ke.update())}function me(ke,be){const Ke=ke.colorSpace,ot=ke.format,lt=ke.type;return ke.isCompressedTexture===!0||ke.isVideoTexture===!0||Ke!==jv&&Ke!==x_&&(Ea.getTransfer(Ke)===Po?(ot!==Xf||lt!==ql)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ke)),be}function Se(ke){return typeof HTMLImageElement<"u"&&ke instanceof HTMLImageElement?(c.width=ke.naturalWidth||ke.width,c.height=ke.naturalHeight||ke.height):typeof VideoFrame<"u"&&ke instanceof VideoFrame?(c.width=ke.displayWidth,c.height=ke.displayHeight):(c.width=ke.width,c.height=ke.height),c}this.allocateTextureUnit=$,this.resetTextureUnits=B,this.setTexture2D=Q,this.setTexture2DArray=W,this.setTexture3D=q,this.setTextureCube=Y,this.rebindTextures=Xe,this.setupRenderTarget=$e,this.updateRenderTargetMipmap=at,this.updateMultisampleRenderTarget=Ue,this.setupDepthRenderbuffer=Ae,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=ze}function zle(n,e){function t(r,i=x_){let s;const a=Ea.getTransfer(i);if(r===ql)return n.UNSIGNED_BYTE;if(r===R4)return n.UNSIGNED_SHORT_4_4_4_4;if(r===A4)return n.UNSIGNED_SHORT_5_5_5_1;if(r===nj)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===ej)return n.BYTE;if(r===tj)return n.SHORT;if(r===XT)return n.UNSIGNED_SHORT;if(r===w4)return n.INT;if(r===zv)return n.UNSIGNED_INT;if(r===Pp)return n.FLOAT;if(r===vb)return n.HALF_FLOAT;if(r===rj)return n.ALPHA;if(r===ij)return n.RGB;if(r===Xf)return n.RGBA;if(r===KT)return n.DEPTH_COMPONENT;if(r===EE)return n.DEPTH_STENCIL;if(r===Vw)return n.RED;if(r===pk)return n.RED_INTEGER;if(r===C4)return n.RG;if(r===M4)return n.RG_INTEGER;if(r===mk)return n.RGBA_INTEGER;if(r===O2||r===k2||r===I2||r===N2)if(a===Po)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===O2)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===k2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===I2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===N2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===O2)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===k2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===I2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===N2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===aD||r===oD||r===lD||r===cD)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===aD)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===oD)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===lD)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===cD)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===uD||r===fD||r===hD)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===uD||r===fD)return a===Po?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===hD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===dD||r===pD||r===mD||r===gD||r===_D||r===vD||r===yD||r===bD||r===SD||r===ED||r===xD||r===TD||r===wD||r===RD)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===dD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===pD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===mD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===gD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===_D)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===vD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===yD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===bD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===SD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===ED)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===xD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===TD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===wD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===RD)return a===Po?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===P2||r===AD||r===CD)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===P2)return a===Po?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===AD)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===CD)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===sj||r===MD||r===OD||r===kD)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===P2)return s.COMPRESSED_RED_RGTC1_EXT;if(r===MD)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===OD)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===kD)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===SE?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}const hOe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,dOe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class pOe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new wc,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!==r.depthNear||t.depthFar!==r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Vl({vertexShader:hOe,fragmentShader:dOe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new bu(new Yw(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class mOe extends $g{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,f=null,h=null,g=null,p=null;const _=new pOe,y=t.getContextAttributes();let v=null,x=null;const E=[],M=[],k=new an;let N=null;const I=new yf;I.viewport=new Ta;const D=new yf;D.viewport=new Ta;const V=[I,D],G=new Mle;let J=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ce){let de=E[ce];return de===void 0&&(de=new nP,E[ce]=de),de.getTargetRaySpace()},this.getControllerGrip=function(ce){let de=E[ce];return de===void 0&&(de=new nP,E[ce]=de),de.getGripSpace()},this.getHand=function(ce){let de=E[ce];return de===void 0&&(de=new nP,E[ce]=de),de.getHandSpace()};function $(ce){const de=M.indexOf(ce.inputSource);if(de===-1)return;const Me=E[de];Me!==void 0&&(Me.update(ce.inputSource,ce.frame,c||a),Me.dispatchEvent({type:ce.type,data:ce.inputSource}))}function U(){i.removeEventListener("select",$),i.removeEventListener("selectstart",$),i.removeEventListener("selectend",$),i.removeEventListener("squeeze",$),i.removeEventListener("squeezestart",$),i.removeEventListener("squeezeend",$),i.removeEventListener("end",U),i.removeEventListener("inputsourceschange",Q);for(let ce=0;ce<E.length;ce++){const de=M[ce];de!==null&&(M[ce]=null,E[ce].disconnect(de))}J=null,B=null,_.reset(),e.setRenderTarget(v),g=null,h=null,f=null,i=null,x=null,le.stop(),r.isPresenting=!1,e.setPixelRatio(N),e.setSize(k.width,k.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ce){s=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ce){o=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(ce){c=ce},this.getBaseLayer=function(){return h!==null?h:g},this.getBinding=function(){return f},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(ce){if(i=ce,i!==null){if(v=e.getRenderTarget(),i.addEventListener("select",$),i.addEventListener("selectstart",$),i.addEventListener("selectend",$),i.addEventListener("squeeze",$),i.addEventListener("squeezestart",$),i.addEventListener("squeezeend",$),i.addEventListener("end",U),i.addEventListener("inputsourceschange",Q),y.xrCompatible!==!0&&await t.makeXRCompatible(),N=e.getPixelRatio(),e.getSize(k),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,qe=null,Ne=null;y.depth&&(Ne=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=y.stencil?EE:KT,qe=y.stencil?SE:zv);const Ae={colorFormat:t.RGBA8,depthFormat:Ne,scaleFactor:s};f=new XRWebGLBinding(i,t),h=f.createProjectionLayer(Ae),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),x=new Sf(h.textureWidth,h.textureHeight,{format:Xf,type:ql,depthTexture:new Ww(h.textureWidth,h.textureHeight,qe,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{const Me={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};g=new XRWebGLLayer(i,t,Me),i.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),x=new Sf(g.framebufferWidth,g.framebufferHeight,{format:Xf,type:ql,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await i.requestReferenceSpace(o),le.setContext(i),le.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function Q(ce){for(let de=0;de<ce.removed.length;de++){const Me=ce.removed[de],qe=M.indexOf(Me);qe>=0&&(M[qe]=null,E[qe].disconnect(Me))}for(let de=0;de<ce.added.length;de++){const Me=ce.added[de];let qe=M.indexOf(Me);if(qe===-1){for(let Ae=0;Ae<E.length;Ae++)if(Ae>=M.length){M.push(Me),qe=Ae;break}else if(M[Ae]===null){M[Ae]=Me,qe=Ae;break}if(qe===-1)break}const Ne=E[qe];Ne&&Ne.connect(Me)}}const W=new ut,q=new ut;function Y(ce,de,Me){W.setFromMatrixPosition(de.matrixWorld),q.setFromMatrixPosition(Me.matrixWorld);const qe=W.distanceTo(q),Ne=de.projectionMatrix.elements,Ae=Me.projectionMatrix.elements,Xe=Ne[14]/(Ne[10]-1),$e=Ne[14]/(Ne[10]+1),at=(Ne[9]+1)/Ne[5],pt=(Ne[9]-1)/Ne[5],oe=(Ne[8]-1)/Ne[0],Ue=(Ae[8]+1)/Ae[0],Ge=Xe*oe,ze=Xe*Ue,Be=qe/(-oe+Ue),me=Be*-oe;if(de.matrixWorld.decompose(ce.position,ce.quaternion,ce.scale),ce.translateX(me),ce.translateZ(Be),ce.matrixWorld.compose(ce.position,ce.quaternion,ce.scale),ce.matrixWorldInverse.copy(ce.matrixWorld).invert(),Ne[10]===-1)ce.projectionMatrix.copy(de.projectionMatrix),ce.projectionMatrixInverse.copy(de.projectionMatrixInverse);else{const Se=Xe+Be,ke=$e+Be,be=Ge-me,Ke=ze+(qe-me),ot=at*$e/ke*Se,lt=pt*$e/ke*Se;ce.projectionMatrix.makePerspective(be,Ke,ot,lt,Se,ke),ce.projectionMatrixInverse.copy(ce.projectionMatrix).invert()}}function ae(ce,de){de===null?ce.matrixWorld.copy(ce.matrix):ce.matrixWorld.multiplyMatrices(de.matrixWorld,ce.matrix),ce.matrixWorldInverse.copy(ce.matrixWorld).invert()}this.updateCamera=function(ce){if(i===null)return;let de=ce.near,Me=ce.far;_.texture!==null&&(_.depthNear>0&&(de=_.depthNear),_.depthFar>0&&(Me=_.depthFar)),G.near=D.near=I.near=de,G.far=D.far=I.far=Me,(J!==G.near||B!==G.far)&&(i.updateRenderState({depthNear:G.near,depthFar:G.far}),J=G.near,B=G.far),I.layers.mask=ce.layers.mask|2,D.layers.mask=ce.layers.mask|4,G.layers.mask=I.layers.mask|D.layers.mask;const qe=ce.parent,Ne=G.cameras;ae(G,qe);for(let Ae=0;Ae<Ne.length;Ae++)ae(Ne[Ae],qe);Ne.length===2?Y(G,I,D):G.projectionMatrix.copy(I.projectionMatrix),Z(ce,G,qe)};function Z(ce,de,Me){Me===null?ce.matrix.copy(de.matrixWorld):(ce.matrix.copy(Me.matrixWorld),ce.matrix.invert(),ce.matrix.multiply(de.matrixWorld)),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale),ce.updateMatrixWorld(!0),ce.projectionMatrix.copy(de.projectionMatrix),ce.projectionMatrixInverse.copy(de.projectionMatrixInverse),ce.isPerspectiveCamera&&(ce.fov=ZT*2*Math.atan(1/ce.projectionMatrix.elements[5]),ce.zoom=1)}this.getCamera=function(){return G},this.getFoveation=function(){if(!(h===null&&g===null))return l},this.setFoveation=function(ce){l=ce,h!==null&&(h.fixedFoveation=ce),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=ce)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(G)};let K=null;function ne(ce,de){if(u=de.getViewerPose(c||a),p=de,u!==null){const Me=u.views;g!==null&&(e.setRenderTargetFramebuffer(x,g.framebuffer),e.setRenderTarget(x));let qe=!1;Me.length!==G.cameras.length&&(G.cameras.length=0,qe=!0);for(let Xe=0;Xe<Me.length;Xe++){const $e=Me[Xe];let at=null;if(g!==null)at=g.getViewport($e);else{const oe=f.getViewSubImage(h,$e);at=oe.viewport,Xe===0&&(e.setRenderTargetTextures(x,oe.colorTexture,oe.depthStencilTexture),e.setRenderTarget(x))}let pt=V[Xe];pt===void 0&&(pt=new yf,pt.layers.enable(Xe),pt.viewport=new Ta,V[Xe]=pt),pt.matrix.fromArray($e.transform.matrix),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt.projectionMatrix.fromArray($e.projectionMatrix),pt.projectionMatrixInverse.copy(pt.projectionMatrix).invert(),pt.viewport.set(at.x,at.y,at.width,at.height),Xe===0&&(G.matrix.copy(pt.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale)),qe===!0&&G.cameras.push(pt)}const Ne=i.enabledFeatures;if(Ne&&Ne.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&f){const Xe=f.getDepthInformation(Me[0]);Xe&&Xe.isValid&&Xe.texture&&_.init(e,Xe,i.renderState)}}for(let Me=0;Me<E.length;Me++){const qe=M[Me],Ne=E[Me];qe!==null&&Ne!==void 0&&Ne.update(qe,de,c||a)}K&&K(ce,de),de.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:de}),p=null}const le=new Dle;le.setAnimationLoop(ne),this.setAnimationLoop=function(ce){K=ce},this.dispose=function(){}}}const SS=new Bm,gOe=new Qr;function _Oe(n,e){function t(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function r(y,v){v.color.getRGB(y.fogColor.value,Ioe(n)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function i(y,v,x,E,M){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),f(y,v)):v.isMeshPhongMaterial?(s(y,v),u(y,v)):v.isMeshStandardMaterial?(s(y,v),h(y,v),v.isMeshPhysicalMaterial&&g(y,v,M)):v.isMeshMatcapMaterial?(s(y,v),p(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),_(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(a(y,v),v.isLineDashedMaterial&&o(y,v)):v.isPointsMaterial?l(y,v,x,E):v.isSpriteMaterial?c(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,t(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===Yf&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,t(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===Yf&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,t(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,t(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const x=e.get(v),E=x.envMap,M=x.envMapRotation;E&&(y.envMap.value=E,SS.copy(M),SS.x*=-1,SS.y*=-1,SS.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(SS.y*=-1,SS.z*=-1),y.envMapRotation.value.setFromMatrix4(gOe.makeRotationFromEuler(SS)),y.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,t(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,y.aoMapTransform))}function a(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform))}function o(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,x,E){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*x,y.scale.value=E*.5,v.map&&(y.map.value=v.map,t(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function c(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function f(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function h(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function g(y,v,x){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Yf&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=x.texture,y.transmissionSamplerSize.value.set(x.width,x.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,y.specularIntensityMapTransform))}function p(y,v){v.matcap&&(y.matcap.value=v.matcap)}function _(y,v){const x=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(x.matrixWorld),y.nearDistance.value=x.shadow.camera.near,y.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function vOe(n,e,t,r){let i={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(x,E){const M=E.program;r.uniformBlockBinding(x,M)}function c(x,E){let M=i[x.id];M===void 0&&(p(x),M=u(x),i[x.id]=M,x.addEventListener("dispose",y));const k=E.program;r.updateUBOMapping(x,k);const N=e.render.frame;s[x.id]!==N&&(h(x),s[x.id]=N)}function u(x){const E=f();x.__bindingPointIndex=E;const M=n.createBuffer(),k=x.__size,N=x.usage;return n.bindBuffer(n.UNIFORM_BUFFER,M),n.bufferData(n.UNIFORM_BUFFER,k,N),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,M),M}function f(){for(let x=0;x<o;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(x){const E=i[x.id],M=x.uniforms,k=x.__cache;n.bindBuffer(n.UNIFORM_BUFFER,E);for(let N=0,I=M.length;N<I;N++){const D=Array.isArray(M[N])?M[N]:[M[N]];for(let V=0,G=D.length;V<G;V++){const J=D[V];if(g(J,N,V,k)===!0){const B=J.__offset,$=Array.isArray(J.value)?J.value:[J.value];let U=0;for(let Q=0;Q<$.length;Q++){const W=$[Q],q=_(W);typeof W=="number"||typeof W=="boolean"?(J.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,B+U,J.__data)):W.isMatrix3?(J.__data[0]=W.elements[0],J.__data[1]=W.elements[1],J.__data[2]=W.elements[2],J.__data[3]=0,J.__data[4]=W.elements[3],J.__data[5]=W.elements[4],J.__data[6]=W.elements[5],J.__data[7]=0,J.__data[8]=W.elements[6],J.__data[9]=W.elements[7],J.__data[10]=W.elements[8],J.__data[11]=0):(W.toArray(J.__data,U),U+=q.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,B,J.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function g(x,E,M,k){const N=x.value,I=E+"_"+M;if(k[I]===void 0)return typeof N=="number"||typeof N=="boolean"?k[I]=N:k[I]=N.clone(),!0;{const D=k[I];if(typeof N=="number"||typeof N=="boolean"){if(D!==N)return k[I]=N,!0}else if(D.equals(N)===!1)return D.copy(N),!0}return!1}function p(x){const E=x.uniforms;let M=0;const k=16;for(let I=0,D=E.length;I<D;I++){const V=Array.isArray(E[I])?E[I]:[E[I]];for(let G=0,J=V.length;G<J;G++){const B=V[G],$=Array.isArray(B.value)?B.value:[B.value];for(let U=0,Q=$.length;U<Q;U++){const W=$[U],q=_(W),Y=M%k,ae=Y%q.boundary,Z=Y+ae;M+=ae,Z!==0&&k-Z<q.storage&&(M+=k-Z),B.__data=new Float32Array(q.storage/Float32Array.BYTES_PER_ELEMENT),B.__offset=M,M+=q.storage}}}const N=M%k;return N>0&&(M+=k-N),x.__size=M,x.__cache={},this}function _(x){const E={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(E.boundary=4,E.storage=4):x.isVector2?(E.boundary=8,E.storage=8):x.isVector3||x.isColor?(E.boundary=16,E.storage=12):x.isVector4?(E.boundary=16,E.storage=16):x.isMatrix3?(E.boundary=48,E.storage=48):x.isMatrix4?(E.boundary=64,E.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),E}function y(x){const E=x.target;E.removeEventListener("dispose",y);const M=a.indexOf(E.__bindingPointIndex);a.splice(M,1),n.deleteBuffer(i[E.id]),delete i[E.id],delete s[E.id]}function v(){for(const x in i)n.deleteBuffer(i[x]);a=[],i={},s={}}return{bind:l,update:c,dispose:v}}class jle{constructor(e={}){const{canvas:t=Moe(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:h=!1}=e;this.isWebGLRenderer=!0;let g;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=r.getContextAttributes().alpha}else g=a;const p=new Uint32Array(4),_=new Int32Array(4);let y=null,v=null;const x=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Iv,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let k=!1;this._outputColorSpace=na;let N=0,I=0,D=null,V=-1,G=null;const J=new Ta,B=new Ta;let $=null;const U=new cr(0);let Q=0,W=t.width,q=t.height,Y=1,ae=null,Z=null;const K=new Ta(0,0,W,q),ne=new Ta(0,0,W,q);let le=!1;const ce=new $w;let de=!1,Me=!1;const qe=new Qr,Ne=new Qr,Ae=new ut,Xe=new Ta,$e={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let at=!1;function pt(){return D===null?Y:1}let oe=r;function Ue(We,At){return t.getContext(We,At)}try{const We={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Hw}`),t.addEventListener("webglcontextlost",nt,!1),t.addEventListener("webglcontextrestored",vt,!1),t.addEventListener("webglcontextcreationerror",Je,!1),oe===null){const At="webgl2";if(oe=Ue(At,We),oe===null)throw Ue(At)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(We){throw console.error("THREE.WebGLRenderer: "+We.message),We}let Ge,ze,Be,me,Se,ke,be,Ke,ot,lt,ct,Vt,Ot,Ut,je,ge,se,_e,Ie,De,Oe,we,st,Ve;function tt(){Ge=new OMe(oe),Ge.init(),we=new zle(oe,Ge),ze=new xMe(oe,Ge,e,we),Be=new uOe(oe,Ge),ze.reverseDepthBuffer&&h&&Be.buffers.depth.setReversed(!0),me=new NMe(oe),Se=new Z2e,ke=new fOe(oe,Ge,Be,Se,ze,we,me),be=new wMe(M),Ke=new MMe(M),ot=new FRe(oe),st=new SMe(oe,ot),lt=new kMe(oe,ot,me,st),ct=new DMe(oe,lt,ot,me),Ie=new PMe(oe,ze,ke),ge=new TMe(Se),Vt=new K2e(M,be,Ke,Ge,ze,st,ge),Ot=new _Oe(M,Se),Ut=new Q2e,je=new sOe(Ge),_e=new bMe(M,be,Ke,Be,ct,g,l),se=new lOe(M,ct,ze),Ve=new vOe(oe,me,ze,Be),De=new EMe(oe,Ge,me),Oe=new IMe(oe,Ge,me),me.programs=Vt.programs,M.capabilities=ze,M.extensions=Ge,M.properties=Se,M.renderLists=Ut,M.shadowMap=se,M.state=Be,M.info=me}tt();const Ze=new mOe(M,oe);this.xr=Ze,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const We=Ge.get("WEBGL_lose_context");We&&We.loseContext()},this.forceContextRestore=function(){const We=Ge.get("WEBGL_lose_context");We&&We.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(We){We!==void 0&&(Y=We,this.setSize(W,q,!1))},this.getSize=function(We){return We.set(W,q)},this.setSize=function(We,At,Wt=!0){if(Ze.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=We,q=At,t.width=Math.floor(We*Y),t.height=Math.floor(At*Y),Wt===!0&&(t.style.width=We+"px",t.style.height=At+"px"),this.setViewport(0,0,We,At)},this.getDrawingBufferSize=function(We){return We.set(W*Y,q*Y).floor()},this.setDrawingBufferSize=function(We,At,Wt){W=We,q=At,Y=Wt,t.width=Math.floor(We*Wt),t.height=Math.floor(At*Wt),this.setViewport(0,0,We,At)},this.getCurrentViewport=function(We){return We.copy(J)},this.getViewport=function(We){return We.copy(K)},this.setViewport=function(We,At,Wt,Kt){We.isVector4?K.set(We.x,We.y,We.z,We.w):K.set(We,At,Wt,Kt),Be.viewport(J.copy(K).multiplyScalar(Y).round())},this.getScissor=function(We){return We.copy(ne)},this.setScissor=function(We,At,Wt,Kt){We.isVector4?ne.set(We.x,We.y,We.z,We.w):ne.set(We,At,Wt,Kt),Be.scissor(B.copy(ne).multiplyScalar(Y).round())},this.getScissorTest=function(){return le},this.setScissorTest=function(We){Be.setScissorTest(le=We)},this.setOpaqueSort=function(We){ae=We},this.setTransparentSort=function(We){Z=We},this.getClearColor=function(We){return We.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor(...arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha(...arguments)},this.clear=function(We=!0,At=!0,Wt=!0){let Kt=0;if(We){let Lt=!1;if(D!==null){const yn=D.texture.format;Lt=yn===mk||yn===M4||yn===pk}if(Lt){const yn=D.texture.type,zn=yn===ql||yn===zv||yn===XT||yn===SE||yn===R4||yn===A4,En=_e.getClearColor(),tr=_e.getClearAlpha(),Nr=En.r,Er=En.g,rr=En.b;zn?(p[0]=Nr,p[1]=Er,p[2]=rr,p[3]=tr,oe.clearBufferuiv(oe.COLOR,0,p)):(_[0]=Nr,_[1]=Er,_[2]=rr,_[3]=tr,oe.clearBufferiv(oe.COLOR,0,_))}else Kt|=oe.COLOR_BUFFER_BIT}At&&(Kt|=oe.DEPTH_BUFFER_BIT),Wt&&(Kt|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(Kt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nt,!1),t.removeEventListener("webglcontextrestored",vt,!1),t.removeEventListener("webglcontextcreationerror",Je,!1),_e.dispose(),Ut.dispose(),je.dispose(),Se.dispose(),be.dispose(),Ke.dispose(),ct.dispose(),st.dispose(),Ve.dispose(),Vt.dispose(),Ze.dispose(),Ze.removeEventListener("sessionstart",Bt),Ze.removeEventListener("sessionend",Yt),Mt.stop()};function nt(We){We.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;const We=me.autoReset,At=se.enabled,Wt=se.autoUpdate,Kt=se.needsUpdate,Lt=se.type;tt(),me.autoReset=We,se.enabled=At,se.autoUpdate=Wt,se.needsUpdate=Kt,se.type=Lt}function Je(We){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",We.statusMessage)}function ht(We){const At=We.target;At.removeEventListener("dispose",ht),mt(At)}function mt(We){ft(We),Se.remove(We)}function ft(We){const At=Se.get(We).programs;At!==void 0&&(At.forEach(function(Wt){Vt.releaseProgram(Wt)}),We.isShaderMaterial&&Vt.releaseShaderCache(We))}this.renderBufferDirect=function(We,At,Wt,Kt,Lt,yn){At===null&&(At=$e);const zn=Lt.isMesh&&Lt.matrixWorld.determinant()<0,En=Ni(We,At,Wt,Kt,Lt);Be.setMaterial(Kt,zn);let tr=Wt.index,Nr=1;if(Kt.wireframe===!0){if(tr=lt.getWireframeAttribute(Wt),tr===void 0)return;Nr=2}const Er=Wt.drawRange,rr=Wt.attributes.position;let Lr=Er.start*Nr,ii=(Er.start+Er.count)*Nr;yn!==null&&(Lr=Math.max(Lr,yn.start*Nr),ii=Math.min(ii,(yn.start+yn.count)*Nr)),tr!==null?(Lr=Math.max(Lr,0),ii=Math.min(ii,tr.count)):rr!=null&&(Lr=Math.max(Lr,0),ii=Math.min(ii,rr.count));const da=ii-Lr;if(da<0||da===1/0)return;st.setup(Lt,Kt,En,Wt,tr);let Mr,si=De;if(tr!==null&&(Mr=ot.get(tr),si=Oe,si.setIndex(Mr)),Lt.isMesh)Kt.wireframe===!0?(Be.setLineWidth(Kt.wireframeLinewidth*pt()),si.setMode(oe.LINES)):si.setMode(oe.TRIANGLES);else if(Lt.isLine){let Tr=Kt.linewidth;Tr===void 0&&(Tr=1),Be.setLineWidth(Tr*pt()),Lt.isLineSegments?si.setMode(oe.LINES):Lt.isLineLoop?si.setMode(oe.LINE_LOOP):si.setMode(oe.LINE_STRIP)}else Lt.isPoints?si.setMode(oe.POINTS):Lt.isSprite&&si.setMode(oe.TRIANGLES);if(Lt.isBatchedMesh)if(Lt._multiDrawInstances!==null)tP("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),si.renderMultiDrawInstances(Lt._multiDrawStarts,Lt._multiDrawCounts,Lt._multiDrawCount,Lt._multiDrawInstances);else if(Ge.get("WEBGL_multi_draw"))si.renderMultiDraw(Lt._multiDrawStarts,Lt._multiDrawCounts,Lt._multiDrawCount);else{const Tr=Lt._multiDrawStarts,Dr=Lt._multiDrawCounts,Cn=Lt._multiDrawCount,jr=tr?ot.get(tr).bytesPerElement:1,Uo=Se.get(Kt).currentProgram.getUniforms();for(let cs=0;cs<Cn;cs++)Uo.setValue(oe,"_gl_DrawID",cs),si.render(Tr[cs]/jr,Dr[cs])}else if(Lt.isInstancedMesh)si.renderInstances(Lr,da,Lt.count);else if(Wt.isInstancedBufferGeometry){const Tr=Wt._maxInstanceCount!==void 0?Wt._maxInstanceCount:1/0,Dr=Math.min(Wt.instanceCount,Tr);si.renderInstances(Lr,da,Dr)}else si.render(Lr,da)};function _t(We,At,Wt){We.transparent===!0&&We.side===$f&&We.forceSinglePass===!1?(We.side=Yf,We.needsUpdate=!0,er(We,At,Wt),We.side=Fv,We.needsUpdate=!0,er(We,At,Wt),We.side=$f):er(We,At,Wt)}this.compile=function(We,At,Wt=null){Wt===null&&(Wt=We),v=je.get(Wt),v.init(At),E.push(v),Wt.traverseVisible(function(Lt){Lt.isLight&&Lt.layers.test(At.layers)&&(v.pushLight(Lt),Lt.castShadow&&v.pushShadow(Lt))}),We!==Wt&&We.traverseVisible(function(Lt){Lt.isLight&&Lt.layers.test(At.layers)&&(v.pushLight(Lt),Lt.castShadow&&v.pushShadow(Lt))}),v.setupLights();const Kt=new Set;return We.traverse(function(Lt){if(!(Lt.isMesh||Lt.isPoints||Lt.isLine||Lt.isSprite))return;const yn=Lt.material;if(yn)if(Array.isArray(yn))for(let zn=0;zn<yn.length;zn++){const En=yn[zn];_t(En,Wt,Lt),Kt.add(En)}else _t(yn,Wt,Lt),Kt.add(yn)}),v=E.pop(),Kt},this.compileAsync=function(We,At,Wt=null){const Kt=this.compile(We,At,Wt);return new Promise(Lt=>{function yn(){if(Kt.forEach(function(zn){Se.get(zn).currentProgram.isReady()&&Kt.delete(zn)}),Kt.size===0){Lt(We);return}setTimeout(yn,10)}Ge.get("KHR_parallel_shader_compile")!==null?yn():setTimeout(yn,10)})};let gn=null;function _n(We){gn&&gn(We)}function Bt(){Mt.stop()}function Yt(){Mt.start()}const Mt=new Dle;Mt.setAnimationLoop(_n),typeof self<"u"&&Mt.setContext(self),this.setAnimationLoop=function(We){gn=We,Ze.setAnimationLoop(We),We===null?Mt.stop():Mt.start()},Ze.addEventListener("sessionstart",Bt),Ze.addEventListener("sessionend",Yt),this.render=function(We,At){if(At!==void 0&&At.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k===!0)return;if(We.matrixWorldAutoUpdate===!0&&We.updateMatrixWorld(),At.parent===null&&At.matrixWorldAutoUpdate===!0&&At.updateMatrixWorld(),Ze.enabled===!0&&Ze.isPresenting===!0&&(Ze.cameraAutoUpdate===!0&&Ze.updateCamera(At),At=Ze.getCamera()),We.isScene===!0&&We.onBeforeRender(M,We,At,D),v=je.get(We,E.length),v.init(At),E.push(v),Ne.multiplyMatrices(At.projectionMatrix,At.matrixWorldInverse),ce.setFromProjectionMatrix(Ne),Me=this.localClippingEnabled,de=ge.init(this.clippingPlanes,Me),y=Ut.get(We,x.length),y.init(),x.push(y),Ze.enabled===!0&&Ze.isPresenting===!0){const yn=M.xr.getDepthSensingMesh();yn!==null&&fn(yn,At,-1/0,M.sortObjects)}fn(We,At,0,M.sortObjects),y.finish(),M.sortObjects===!0&&y.sort(ae,Z),at=Ze.enabled===!1||Ze.isPresenting===!1||Ze.hasDepthSensing()===!1,at&&_e.addToRenderList(y,We),this.info.render.frame++,de===!0&&ge.beginShadows();const Wt=v.state.shadowsArray;se.render(Wt,We,At),de===!0&&ge.endShadows(),this.info.autoReset===!0&&this.info.reset();const Kt=y.opaque,Lt=y.transmissive;if(v.setupLights(),At.isArrayCamera){const yn=At.cameras;if(Lt.length>0)for(let zn=0,En=yn.length;zn<En;zn++){const tr=yn[zn];cn(Kt,Lt,We,tr)}at&&_e.render(We);for(let zn=0,En=yn.length;zn<En;zn++){const tr=yn[zn];Bn(y,We,tr,tr.viewport)}}else Lt.length>0&&cn(Kt,Lt,We,At),at&&_e.render(We),Bn(y,We,At);D!==null&&I===0&&(ke.updateMultisampleRenderTarget(D),ke.updateRenderTargetMipmap(D)),We.isScene===!0&&We.onAfterRender(M,We,At),st.resetDefaultState(),V=-1,G=null,E.pop(),E.length>0?(v=E[E.length-1],de===!0&&ge.setGlobalState(M.clippingPlanes,v.state.camera)):v=null,x.pop(),x.length>0?y=x[x.length-1]:y=null};function fn(We,At,Wt,Kt){if(We.visible===!1)return;if(We.layers.test(At.layers)){if(We.isGroup)Wt=We.renderOrder;else if(We.isLOD)We.autoUpdate===!0&&We.update(At);else if(We.isLight)v.pushLight(We),We.castShadow&&v.pushShadow(We);else if(We.isSprite){if(!We.frustumCulled||ce.intersectsSprite(We)){Kt&&Xe.setFromMatrixPosition(We.matrixWorld).applyMatrix4(Ne);const zn=ct.update(We),En=We.material;En.visible&&y.push(We,zn,En,Wt,Xe.z,null)}}else if((We.isMesh||We.isLine||We.isPoints)&&(!We.frustumCulled||ce.intersectsObject(We))){const zn=ct.update(We),En=We.material;if(Kt&&(We.boundingSphere!==void 0?(We.boundingSphere===null&&We.computeBoundingSphere(),Xe.copy(We.boundingSphere.center)):(zn.boundingSphere===null&&zn.computeBoundingSphere(),Xe.copy(zn.boundingSphere.center)),Xe.applyMatrix4(We.matrixWorld).applyMatrix4(Ne)),Array.isArray(En)){const tr=zn.groups;for(let Nr=0,Er=tr.length;Nr<Er;Nr++){const rr=tr[Nr],Lr=En[rr.materialIndex];Lr&&Lr.visible&&y.push(We,zn,Lr,Wt,Xe.z,rr)}}else En.visible&&y.push(We,zn,En,Wt,Xe.z,null)}}const yn=We.children;for(let zn=0,En=yn.length;zn<En;zn++)fn(yn[zn],At,Wt,Kt)}function Bn(We,At,Wt,Kt){const Lt=We.opaque,yn=We.transmissive,zn=We.transparent;v.setupLightsView(Wt),de===!0&&ge.setGlobalState(M.clippingPlanes,Wt),Kt&&Be.viewport(J.copy(Kt)),Lt.length>0&&In(Lt,At,Wt),yn.length>0&&In(yn,At,Wt),zn.length>0&&In(zn,At,Wt),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1)}function cn(We,At,Wt,Kt){if((Wt.isScene===!0?Wt.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[Kt.id]===void 0&&(v.state.transmissionRenderTarget[Kt.id]=new Sf(1,1,{generateMipmaps:!0,type:Ge.has("EXT_color_buffer_half_float")||Ge.has("EXT_color_buffer_float")?vb:ql,minFilter:Rv,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ea.workingColorSpace}));const yn=v.state.transmissionRenderTarget[Kt.id],zn=Kt.viewport||J;yn.setSize(zn.z*M.transmissionResolutionScale,zn.w*M.transmissionResolutionScale);const En=M.getRenderTarget();M.setRenderTarget(yn),M.getClearColor(U),Q=M.getClearAlpha(),Q<1&&M.setClearColor(16777215,.5),M.clear(),at&&_e.render(Wt);const tr=M.toneMapping;M.toneMapping=Iv;const Nr=Kt.viewport;if(Kt.viewport!==void 0&&(Kt.viewport=void 0),v.setupLightsView(Kt),de===!0&&ge.setGlobalState(M.clippingPlanes,Kt),In(We,Wt,Kt),ke.updateMultisampleRenderTarget(yn),ke.updateRenderTargetMipmap(yn),Ge.has("WEBGL_multisampled_render_to_texture")===!1){let Er=!1;for(let rr=0,Lr=At.length;rr<Lr;rr++){const ii=At[rr],da=ii.object,Mr=ii.geometry,si=ii.material,Tr=ii.group;if(si.side===$f&&da.layers.test(Kt.layers)){const Dr=si.side;si.side=Yf,si.needsUpdate=!0,Wn(da,Wt,Kt,Mr,si,Tr),si.side=Dr,si.needsUpdate=!0,Er=!0}}Er===!0&&(ke.updateMultisampleRenderTarget(yn),ke.updateRenderTargetMipmap(yn))}M.setRenderTarget(En),M.setClearColor(U,Q),Nr!==void 0&&(Kt.viewport=Nr),M.toneMapping=tr}function In(We,At,Wt){const Kt=At.isScene===!0?At.overrideMaterial:null;for(let Lt=0,yn=We.length;Lt<yn;Lt++){const zn=We[Lt],En=zn.object,tr=zn.geometry,Nr=zn.group;let Er=zn.material;Er.allowOverride===!0&&Kt!==null&&(Er=Kt),En.layers.test(Wt.layers)&&Wn(En,At,Wt,tr,Er,Nr)}}function Wn(We,At,Wt,Kt,Lt,yn){We.onBeforeRender(M,At,Wt,Kt,Lt,yn),We.modelViewMatrix.multiplyMatrices(Wt.matrixWorldInverse,We.matrixWorld),We.normalMatrix.getNormalMatrix(We.modelViewMatrix),Lt.onBeforeRender(M,At,Wt,Kt,We,yn),Lt.transparent===!0&&Lt.side===$f&&Lt.forceSinglePass===!1?(Lt.side=Yf,Lt.needsUpdate=!0,M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),Lt.side=Fv,Lt.needsUpdate=!0,M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),Lt.side=$f):M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),We.onAfterRender(M,At,Wt,Kt,Lt,yn)}function er(We,At,Wt){At.isScene!==!0&&(At=$e);const Kt=Se.get(We),Lt=v.state.lights,yn=v.state.shadowsArray,zn=Lt.state.version,En=Vt.getParameters(We,Lt.state,yn,At,Wt),tr=Vt.getProgramCacheKey(En);let Nr=Kt.programs;Kt.environment=We.isMeshStandardMaterial?At.environment:null,Kt.fog=At.fog,Kt.envMap=(We.isMeshStandardMaterial?Ke:be).get(We.envMap||Kt.environment),Kt.envMapRotation=Kt.environment!==null&&We.envMap===null?At.environmentRotation:We.envMapRotation,Nr===void 0&&(We.addEventListener("dispose",ht),Nr=new Map,Kt.programs=Nr);let Er=Nr.get(tr);if(Er!==void 0){if(Kt.currentProgram===Er&&Kt.lightsStateVersion===zn)return gi(We,En),Er}else En.uniforms=Vt.getUniforms(We),We.onBeforeCompile(En,M),Er=Vt.acquireProgram(En,tr),Nr.set(tr,Er),Kt.uniforms=En.uniforms;const rr=Kt.uniforms;return(!We.isShaderMaterial&&!We.isRawShaderMaterial||We.clipping===!0)&&(rr.clippingPlanes=ge.uniform),gi(We,En),Kt.needsLights=_i(We),Kt.lightsStateVersion=zn,Kt.needsLights&&(rr.ambientLightColor.value=Lt.state.ambient,rr.lightProbe.value=Lt.state.probe,rr.directionalLights.value=Lt.state.directional,rr.directionalLightShadows.value=Lt.state.directionalShadow,rr.spotLights.value=Lt.state.spot,rr.spotLightShadows.value=Lt.state.spotShadow,rr.rectAreaLights.value=Lt.state.rectArea,rr.ltc_1.value=Lt.state.rectAreaLTC1,rr.ltc_2.value=Lt.state.rectAreaLTC2,rr.pointLights.value=Lt.state.point,rr.pointLightShadows.value=Lt.state.pointShadow,rr.hemisphereLights.value=Lt.state.hemi,rr.directionalShadowMap.value=Lt.state.directionalShadowMap,rr.directionalShadowMatrix.value=Lt.state.directionalShadowMatrix,rr.spotShadowMap.value=Lt.state.spotShadowMap,rr.spotLightMatrix.value=Lt.state.spotLightMatrix,rr.spotLightMap.value=Lt.state.spotLightMap,rr.pointShadowMap.value=Lt.state.pointShadowMap,rr.pointShadowMatrix.value=Lt.state.pointShadowMatrix),Kt.currentProgram=Er,Kt.uniformsList=null,Er}function os(We){if(We.uniformsList===null){const At=We.currentProgram.getUniforms();We.uniformsList=rP.seqWithValue(At.seq,We.uniforms)}return We.uniformsList}function gi(We,At){const Wt=Se.get(We);Wt.outputColorSpace=At.outputColorSpace,Wt.batching=At.batching,Wt.batchingColor=At.batchingColor,Wt.instancing=At.instancing,Wt.instancingColor=At.instancingColor,Wt.instancingMorph=At.instancingMorph,Wt.skinning=At.skinning,Wt.morphTargets=At.morphTargets,Wt.morphNormals=At.morphNormals,Wt.morphColors=At.morphColors,Wt.morphTargetsCount=At.morphTargetsCount,Wt.numClippingPlanes=At.numClippingPlanes,Wt.numIntersection=At.numClipIntersection,Wt.vertexAlphas=At.vertexAlphas,Wt.vertexTangents=At.vertexTangents,Wt.toneMapping=At.toneMapping}function Ni(We,At,Wt,Kt,Lt){At.isScene!==!0&&(At=$e),ke.resetTextureUnits();const yn=At.fog,zn=Kt.isMeshStandardMaterial?At.environment:null,En=D===null?M.outputColorSpace:D.isXRRenderTarget===!0?D.texture.colorSpace:jv,tr=(Kt.isMeshStandardMaterial?Ke:be).get(Kt.envMap||zn),Nr=Kt.vertexColors===!0&&!!Wt.attributes.color&&Wt.attributes.color.itemSize===4,Er=!!Wt.attributes.tangent&&(!!Kt.normalMap||Kt.anisotropy>0),rr=!!Wt.morphAttributes.position,Lr=!!Wt.morphAttributes.normal,ii=!!Wt.morphAttributes.color;let da=Iv;Kt.toneMapped&&(D===null||D.isXRRenderTarget===!0)&&(da=M.toneMapping);const Mr=Wt.morphAttributes.position||Wt.morphAttributes.normal||Wt.morphAttributes.color,si=Mr!==void 0?Mr.length:0,Tr=Se.get(Kt),Dr=v.state.lights;if(de===!0&&(Me===!0||We!==G)){const ur=We===G&&Kt.id===V;ge.setState(Kt,We,ur)}let Cn=!1;Kt.version===Tr.__version?(Tr.needsLights&&Tr.lightsStateVersion!==Dr.state.version||Tr.outputColorSpace!==En||Lt.isBatchedMesh&&Tr.batching===!1||!Lt.isBatchedMesh&&Tr.batching===!0||Lt.isBatchedMesh&&Tr.batchingColor===!0&&Lt.colorTexture===null||Lt.isBatchedMesh&&Tr.batchingColor===!1&&Lt.colorTexture!==null||Lt.isInstancedMesh&&Tr.instancing===!1||!Lt.isInstancedMesh&&Tr.instancing===!0||Lt.isSkinnedMesh&&Tr.skinning===!1||!Lt.isSkinnedMesh&&Tr.skinning===!0||Lt.isInstancedMesh&&Tr.instancingColor===!0&&Lt.instanceColor===null||Lt.isInstancedMesh&&Tr.instancingColor===!1&&Lt.instanceColor!==null||Lt.isInstancedMesh&&Tr.instancingMorph===!0&&Lt.morphTexture===null||Lt.isInstancedMesh&&Tr.instancingMorph===!1&&Lt.morphTexture!==null||Tr.envMap!==tr||Kt.fog===!0&&Tr.fog!==yn||Tr.numClippingPlanes!==void 0&&(Tr.numClippingPlanes!==ge.numPlanes||Tr.numIntersection!==ge.numIntersection)||Tr.vertexAlphas!==Nr||Tr.vertexTangents!==Er||Tr.morphTargets!==rr||Tr.morphNormals!==Lr||Tr.morphColors!==ii||Tr.toneMapping!==da||Tr.morphTargetsCount!==si)&&(Cn=!0):(Cn=!0,Tr.__version=Kt.version);let jr=Tr.currentProgram;Cn===!0&&(jr=er(Kt,At,Lt));let Uo=!1,cs=!1,Bo=!1;const us=jr.getUniforms(),Xn=Tr.uniforms;if(Be.useProgram(jr.program)&&(Uo=!0,cs=!0,Bo=!0),Kt.id!==V&&(V=Kt.id,cs=!0),Uo||G!==We){Be.buffers.depth.getReversed()?(qe.copy(We.projectionMatrix),oTe(qe),lTe(qe),us.setValue(oe,"projectionMatrix",qe)):us.setValue(oe,"projectionMatrix",We.projectionMatrix),us.setValue(oe,"viewMatrix",We.matrixWorldInverse);const zs=us.map.cameraPosition;zs!==void 0&&zs.setValue(oe,Ae.setFromMatrixPosition(We.matrixWorld)),ze.logarithmicDepthBuffer&&us.setValue(oe,"logDepthBufFC",2/(Math.log(We.far+1)/Math.LN2)),(Kt.isMeshPhongMaterial||Kt.isMeshToonMaterial||Kt.isMeshLambertMaterial||Kt.isMeshBasicMaterial||Kt.isMeshStandardMaterial||Kt.isShaderMaterial)&&us.setValue(oe,"isOrthographic",We.isOrthographicCamera===!0),G!==We&&(G=We,cs=!0,Bo=!0)}if(Lt.isSkinnedMesh){us.setOptional(oe,Lt,"bindMatrix"),us.setOptional(oe,Lt,"bindMatrixInverse");const ur=Lt.skeleton;ur&&(ur.boneTexture===null&&ur.computeBoneTexture(),us.setValue(oe,"boneTexture",ur.boneTexture,ke))}Lt.isBatchedMesh&&(us.setOptional(oe,Lt,"batchingTexture"),us.setValue(oe,"batchingTexture",Lt._matricesTexture,ke),us.setOptional(oe,Lt,"batchingIdTexture"),us.setValue(oe,"batchingIdTexture",Lt._indirectTexture,ke),us.setOptional(oe,Lt,"batchingColorTexture"),Lt._colorsTexture!==null&&us.setValue(oe,"batchingColorTexture",Lt._colorsTexture,ke));const ei=Wt.morphAttributes;if((ei.position!==void 0||ei.normal!==void 0||ei.color!==void 0)&&Ie.update(Lt,Wt,jr),(cs||Tr.receiveShadow!==Lt.receiveShadow)&&(Tr.receiveShadow=Lt.receiveShadow,us.setValue(oe,"receiveShadow",Lt.receiveShadow)),Kt.isMeshGouraudMaterial&&Kt.envMap!==null&&(Xn.envMap.value=tr,Xn.flipEnvMap.value=tr.isCubeTexture&&tr.isRenderTargetTexture===!1?-1:1),Kt.isMeshStandardMaterial&&Kt.envMap===null&&At.environment!==null&&(Xn.envMapIntensity.value=At.environmentIntensity),cs&&(us.setValue(oe,"toneMappingExposure",M.toneMappingExposure),Tr.needsLights&&Fs(Xn,Bo),yn&&Kt.fog===!0&&Ot.refreshFogUniforms(Xn,yn),Ot.refreshMaterialUniforms(Xn,Kt,Y,q,v.state.transmissionRenderTarget[We.id]),rP.upload(oe,os(Tr),Xn,ke)),Kt.isShaderMaterial&&Kt.uniformsNeedUpdate===!0&&(rP.upload(oe,os(Tr),Xn,ke),Kt.uniformsNeedUpdate=!1),Kt.isSpriteMaterial&&us.setValue(oe,"center",Lt.center),us.setValue(oe,"modelViewMatrix",Lt.modelViewMatrix),us.setValue(oe,"normalMatrix",Lt.normalMatrix),us.setValue(oe,"modelMatrix",Lt.matrixWorld),Kt.isShaderMaterial||Kt.isRawShaderMaterial){const ur=Kt.uniformsGroups;for(let zs=0,So=ur.length;zs<So;zs++){const pa=ur[zs];Ve.update(pa,jr),Ve.bind(pa,jr)}}return jr}function Fs(We,At){We.ambientLightColor.needsUpdate=At,We.lightProbe.needsUpdate=At,We.directionalLights.needsUpdate=At,We.directionalLightShadows.needsUpdate=At,We.pointLights.needsUpdate=At,We.pointLightShadows.needsUpdate=At,We.spotLights.needsUpdate=At,We.spotLightShadows.needsUpdate=At,We.rectAreaLights.needsUpdate=At,We.hemisphereLights.needsUpdate=At}function _i(We){return We.isMeshLambertMaterial||We.isMeshToonMaterial||We.isMeshPhongMaterial||We.isMeshStandardMaterial||We.isShadowMaterial||We.isShaderMaterial&&We.lights===!0}this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(We,At,Wt){const Kt=Se.get(We);Kt.__autoAllocateDepthBuffer=We.resolveDepthBuffer===!1,Kt.__autoAllocateDepthBuffer===!1&&(Kt.__useRenderToTexture=!1),Se.get(We.texture).__webglTexture=At,Se.get(We.depthTexture).__webglTexture=Kt.__autoAllocateDepthBuffer?void 0:Wt,Kt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(We,At){const Wt=Se.get(We);Wt.__webglFramebuffer=At,Wt.__useDefaultFramebuffer=At===void 0};const Rs=oe.createFramebuffer();this.setRenderTarget=function(We,At=0,Wt=0){D=We,N=At,I=Wt;let Kt=!0,Lt=null,yn=!1,zn=!1;if(We){const tr=Se.get(We);if(tr.__useDefaultFramebuffer!==void 0)Be.bindFramebuffer(oe.FRAMEBUFFER,null),Kt=!1;else if(tr.__webglFramebuffer===void 0)ke.setupRenderTarget(We);else if(tr.__hasExternalTextures)ke.rebindTextures(We,Se.get(We.texture).__webglTexture,Se.get(We.depthTexture).__webglTexture);else if(We.depthBuffer){const rr=We.depthTexture;if(tr.__boundDepthTexture!==rr){if(rr!==null&&Se.has(rr)&&(We.width!==rr.image.width||We.height!==rr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ke.setupDepthRenderbuffer(We)}}const Nr=We.texture;(Nr.isData3DTexture||Nr.isDataArrayTexture||Nr.isCompressedArrayTexture)&&(zn=!0);const Er=Se.get(We).__webglFramebuffer;We.isWebGLCubeRenderTarget?(Array.isArray(Er[At])?Lt=Er[At][Wt]:Lt=Er[At],yn=!0):We.samples>0&&ke.useMultisampledRTT(We)===!1?Lt=Se.get(We).__webglMultisampledFramebuffer:Array.isArray(Er)?Lt=Er[Wt]:Lt=Er,J.copy(We.viewport),B.copy(We.scissor),$=We.scissorTest}else J.copy(K).multiplyScalar(Y).floor(),B.copy(ne).multiplyScalar(Y).floor(),$=le;if(Wt!==0&&(Lt=Rs),Be.bindFramebuffer(oe.FRAMEBUFFER,Lt)&&Kt&&Be.drawBuffers(We,Lt),Be.viewport(J),Be.scissor(B),Be.setScissorTest($),yn){const tr=Se.get(We.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+At,tr.__webglTexture,Wt)}else if(zn){const tr=Se.get(We.texture),Nr=At;oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,tr.__webglTexture,Wt,Nr)}else if(We!==null&&Wt!==0){const tr=Se.get(We.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,tr.__webglTexture,Wt)}V=-1},this.readRenderTargetPixels=function(We,At,Wt,Kt,Lt,yn,zn){if(!(We&&We.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let En=Se.get(We).__webglFramebuffer;if(We.isWebGLCubeRenderTarget&&zn!==void 0&&(En=En[zn]),En){Be.bindFramebuffer(oe.FRAMEBUFFER,En);try{const tr=We.texture,Nr=tr.format,Er=tr.type;if(!ze.textureFormatReadable(Nr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ze.textureTypeReadable(Er)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}At>=0&&At<=We.width-Kt&&Wt>=0&&Wt<=We.height-Lt&&oe.readPixels(At,Wt,Kt,Lt,we.convert(Nr),we.convert(Er),yn)}finally{const tr=D!==null?Se.get(D).__webglFramebuffer:null;Be.bindFramebuffer(oe.FRAMEBUFFER,tr)}}},this.readRenderTargetPixelsAsync=async function(We,At,Wt,Kt,Lt,yn,zn){if(!(We&&We.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let En=Se.get(We).__webglFramebuffer;if(We.isWebGLCubeRenderTarget&&zn!==void 0&&(En=En[zn]),En)if(At>=0&&At<=We.width-Kt&&Wt>=0&&Wt<=We.height-Lt){Be.bindFramebuffer(oe.FRAMEBUFFER,En);const tr=We.texture,Nr=tr.format,Er=tr.type;if(!ze.textureFormatReadable(Nr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ze.textureTypeReadable(Er))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const rr=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,rr),oe.bufferData(oe.PIXEL_PACK_BUFFER,yn.byteLength,oe.STREAM_READ),oe.readPixels(At,Wt,Kt,Lt,we.convert(Nr),we.convert(Er),0);const Lr=D!==null?Se.get(D).__webglFramebuffer:null;Be.bindFramebuffer(oe.FRAMEBUFFER,Lr);const ii=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await aTe(oe,ii,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,rr),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,yn),oe.deleteBuffer(rr),oe.deleteSync(ii),yn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(We,At=null,Wt=0){const Kt=Math.pow(2,-Wt),Lt=Math.floor(We.image.width*Kt),yn=Math.floor(We.image.height*Kt),zn=At!==null?At.x:0,En=At!==null?At.y:0;ke.setTexture2D(We,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,Wt,0,0,zn,En,Lt,yn),Be.unbindTexture()};const ra=oe.createFramebuffer(),ls=oe.createFramebuffer();this.copyTextureToTexture=function(We,At,Wt=null,Kt=null,Lt=0,yn=null){yn===null&&(Lt!==0?(tP("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),yn=Lt,Lt=0):yn=0);let zn,En,tr,Nr,Er,rr,Lr,ii,da;const Mr=We.isCompressedTexture?We.mipmaps[yn]:We.image;if(Wt!==null)zn=Wt.max.x-Wt.min.x,En=Wt.max.y-Wt.min.y,tr=Wt.isBox3?Wt.max.z-Wt.min.z:1,Nr=Wt.min.x,Er=Wt.min.y,rr=Wt.isBox3?Wt.min.z:0;else{const ei=Math.pow(2,-Lt);zn=Math.floor(Mr.width*ei),En=Math.floor(Mr.height*ei),We.isDataArrayTexture?tr=Mr.depth:We.isData3DTexture?tr=Math.floor(Mr.depth*ei):tr=1,Nr=0,Er=0,rr=0}Kt!==null?(Lr=Kt.x,ii=Kt.y,da=Kt.z):(Lr=0,ii=0,da=0);const si=we.convert(At.format),Tr=we.convert(At.type);let Dr;At.isData3DTexture?(ke.setTexture3D(At,0),Dr=oe.TEXTURE_3D):At.isDataArrayTexture||At.isCompressedArrayTexture?(ke.setTexture2DArray(At,0),Dr=oe.TEXTURE_2D_ARRAY):(ke.setTexture2D(At,0),Dr=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,At.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,At.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,At.unpackAlignment);const Cn=oe.getParameter(oe.UNPACK_ROW_LENGTH),jr=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Uo=oe.getParameter(oe.UNPACK_SKIP_PIXELS),cs=oe.getParameter(oe.UNPACK_SKIP_ROWS),Bo=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Mr.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Mr.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Nr),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Er),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,rr);const us=We.isDataArrayTexture||We.isData3DTexture,Xn=At.isDataArrayTexture||At.isData3DTexture;if(We.isDepthTexture){const ei=Se.get(We),ur=Se.get(At),zs=Se.get(ei.__renderTarget),So=Se.get(ur.__renderTarget);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,zs.__webglFramebuffer),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,So.__webglFramebuffer);for(let pa=0;pa<tr;pa++)us&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Se.get(We).__webglTexture,Lt,rr+pa),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Se.get(At).__webglTexture,yn,da+pa)),oe.blitFramebuffer(Nr,Er,zn,En,Lr,ii,zn,En,oe.DEPTH_BUFFER_BIT,oe.NEAREST);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(Lt!==0||We.isRenderTargetTexture||Se.has(We)){const ei=Se.get(We),ur=Se.get(At);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,ra),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,ls);for(let zs=0;zs<tr;zs++)us?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ei.__webglTexture,Lt,rr+zs):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ei.__webglTexture,Lt),Xn?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ur.__webglTexture,yn,da+zs):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ur.__webglTexture,yn),Lt!==0?oe.blitFramebuffer(Nr,Er,zn,En,Lr,ii,zn,En,oe.COLOR_BUFFER_BIT,oe.NEAREST):Xn?oe.copyTexSubImage3D(Dr,yn,Lr,ii,da+zs,Nr,Er,zn,En):oe.copyTexSubImage2D(Dr,yn,Lr,ii,Nr,Er,zn,En);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Xn?We.isDataTexture||We.isData3DTexture?oe.texSubImage3D(Dr,yn,Lr,ii,da,zn,En,tr,si,Tr,Mr.data):At.isCompressedArrayTexture?oe.compressedTexSubImage3D(Dr,yn,Lr,ii,da,zn,En,tr,si,Mr.data):oe.texSubImage3D(Dr,yn,Lr,ii,da,zn,En,tr,si,Tr,Mr):We.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,yn,Lr,ii,zn,En,si,Tr,Mr.data):We.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,yn,Lr,ii,Mr.width,Mr.height,si,Mr.data):oe.texSubImage2D(oe.TEXTURE_2D,yn,Lr,ii,zn,En,si,Tr,Mr);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Cn),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,jr),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Uo),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,cs),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Bo),yn===0&&At.generateMipmaps&&oe.generateMipmap(Dr),Be.unbindTexture()},this.copyTextureToTexture3D=function(We,At,Wt=null,Kt=null,Lt=0){return tP('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(We,At,Wt,Kt,Lt)},this.initRenderTarget=function(We){Se.get(We).__webglFramebuffer===void 0&&ke.setupRenderTarget(We)},this.initTexture=function(We){We.isCubeTexture?ke.setTextureCube(We,0):We.isData3DTexture?ke.setTexture3D(We,0):We.isDataArrayTexture||We.isCompressedArrayTexture?ke.setTexture2DArray(We,0):ke.setTexture2D(We,0),Be.unbindTexture()},this.resetState=function(){N=0,I=0,D=null,Be.reset(),st.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return N0}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Ea._getDrawingBufferColorSpace(e),t.unpackColorSpace=Ea._getUnpackColorSpace()}}const yOe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Jz,AddEquation:c1,AddOperation:ooe,AdditiveAnimationBlendMode:aj,AdditiveBlending:T7,AgXToneMapping:hoe,AlphaFormat:rj,AlwaysCompare:Roe,AlwaysDepth:eD,AlwaysStencilFunc:C7,AmbientLight:xle,AnimationAction:Ile,AnimationClip:fO,AnimationLoader:Pwe,AnimationMixer:lRe,AnimationObjectGroup:aRe,AnimationUtils:Owe,ArcCurve:Woe,ArrayCamera:Mle,ArrowHelper:ORe,AttachedBindMode:A7,Audio:Ole,AudioAnalyser:Kwe,AudioContext:Cj,AudioListener:Wwe,AudioLoader:Vwe,AxesHelper:kRe,BackSide:Yf,BasicDepthPacking:q1,BasicShadowMap:jae,BatchedMesh:joe,Bone:hj,BooleanKeyframeTrack:JE,Box2:Nle,Box3:Zd,Box3Helper:CRe,BoxGeometry:ZE,BoxHelper:ARe,BufferAttribute:Ds,BufferGeometry:ns,BufferGeometryLoader:Cle,ByteType:ej,Cache:Wy,Camera:_k,CameraHelper:RRe,CanvasTexture:Goe,CapsuleGeometry:F4,CatmullRomCurve3:Yoe,CineonToneMapping:uoe,CircleGeometry:z4,ClampToEdgeWrapping:I0,Clock:Mj,Color:cr,ColorKeyframeTrack:wj,ColorManagement:Ea,CompressedArrayTexture:ZTe,CompressedCubeTexture:JTe,CompressedTexture:B4,CompressedTextureLoader:Dwe,ConeGeometry:bk,ConstantAlphaFactor:ioe,ConstantColorFactor:noe,Controls:NRe,CubeCamera:Poe,CubeReflectionMapping:lb,CubeRefractionMapping:C1,CubeTexture:vk,CubeTextureLoader:Lwe,CubeUVReflectionMapping:qw,CubicBezierCurve:mj,CubicBezierCurve3:Xoe,CubicInterpolant:ple,CullFaceBack:x7,CullFaceFront:zae,CullFaceFrontBack:oxe,CullFaceNone:Fae,Curve:F_,CurvePath:Zoe,CustomBlending:Hae,CustomToneMapping:foe,CylinderGeometry:yk,Cylindrical:gRe,Data3DTexture:I4,DataArrayTexture:gk,DataTexture:Bg,DataTextureLoader:Uwe,DataUtils:xTe,DecrementStencilOp:Sxe,DecrementWrapStencilOp:xxe,DefaultLoadingManager:_le,DepthArrayTexture:QTe,DepthFormat:KT,DepthStencilFormat:EE,DepthTexture:Ww,DetachedBindMode:poe,DirectionalLight:Ele,DirectionalLightHelper:wRe,DiscreteInterpolant:mle,DodecahedronGeometry:j4,DoubleSide:$f,DstAlphaFactor:Zae,DstColorFactor:Qae,DynamicCopyUsage:Uxe,DynamicDrawUsage:M7,DynamicReadUsage:Pxe,EdgesGeometry:$oe,EllipseCurve:H4,EqualCompare:Eoe,EqualDepth:nD,EqualStencilFunc:Axe,EquirectangularReflectionMapping:Z2,EquirectangularRefractionMapping:J2,Euler:Bm,EventDispatcher:$g,ExtrudeGeometry:q4,FileLoader:cb,Float16BufferAttribute:OTe,Float32BufferAttribute:Ir,FloatType:Pp,Fog:P4,FogExp2:N4,FramebufferTexture:KTe,FrontSide:Fv,Frustum:$w,FrustumArray:U4,GLBufferAttribute:pRe,GLSL1:Fxe,GLSL3:O7,GreaterCompare:xoe,GreaterDepth:iD,GreaterEqualCompare:woe,GreaterEqualDepth:rD,GreaterEqualStencilFunc:kxe,GreaterStencilFunc:Mxe,GridHelper:xRe,Group:eE,HalfFloatType:vb,HemisphereLight:yle,HemisphereLightHelper:ERe,IcosahedronGeometry:V4,ImageBitmapLoader:qwe,ImageLoader:hO,ImageUtils:Ooe,IncrementStencilOp:bxe,IncrementWrapStencilOp:Exe,InstancedBufferAttribute:tw,InstancedBufferGeometry:Ale,InstancedInterleavedBuffer:dRe,InstancedMesh:zoe,Int16BufferAttribute:CTe,Int32BufferAttribute:MTe,Int8BufferAttribute:wTe,IntType:w4,InterleavedBuffer:D4,InterleavedBufferAttribute:xE,Interpolant:xk,InterpolateDiscrete:eO,InterpolateLinear:ID,InterpolateSmooth:eP,InterpolationSamplingMode:Hxe,InterpolationSamplingType:jxe,InvertStencilOp:Txe,KeepStencilOp:BS,KeyframeTrack:Y0,LOD:Boe,LatheGeometry:G4,Layers:JT,LessCompare:Soe,LessDepth:tD,LessEqualCompare:oj,LessEqualDepth:bE,LessEqualStencilFunc:Cxe,LessStencilFunc:Rxe,Light:W1,LightProbe:Rle,Line:M1,Line3:_Re,LineBasicMaterial:qp,LineCurve:gj,LineCurve3:Koe,LineDashedMaterial:fle,LineLoop:Hoe,LineSegments:Kv,LinearFilter:sc,LinearInterpolant:Tj,LinearMipMapLinearFilter:fxe,LinearMipMapNearestFilter:uxe,LinearMipmapLinearFilter:Rv,LinearMipmapNearestFilter:M2,LinearSRGBColorSpace:jv,LinearToneMapping:loe,LinearTransfer:nO,Loader:Ym,LoaderUtils:D7,LoadingManager:Rj,LoopOnce:moe,LoopPingPong:_oe,LoopRepeat:goe,MOUSE:sxe,Material:nh,MaterialLoader:J4,MathUtils:Aoe,Matrix2:Nj,Matrix3:es,Matrix4:Qr,MaxEquation:$ae,Mesh:bu,MeshBasicMaterial:G1,MeshDepthMaterial:Sj,MeshDistanceMaterial:Ej,MeshLambertMaterial:cle,MeshMatcapMaterial:ule,MeshNormalMaterial:lle,MeshPhongMaterial:ale,MeshPhysicalMaterial:sle,MeshStandardMaterial:bj,MeshToonMaterial:ole,MinEquation:Gae,MirroredRepeatWrapping:Q2,MixOperation:aoe,MultiplyBlending:R7,MultiplyOperation:dk,NearestFilter:bf,NearestMipMapLinearFilter:cxe,NearestMipMapNearestFilter:lxe,NearestMipmapLinearFilter:ET,NearestMipmapNearestFilter:Qz,NeutralToneMapping:doe,NeverCompare:boe,NeverDepth:QP,NeverStencilFunc:wxe,NoBlending:Ih,NoColorSpace:x_,NoToneMapping:Iv,NormalAnimationBlendMode:O4,NormalBlending:lE,NotEqualCompare:Toe,NotEqualDepth:sD,NotEqualStencilFunc:Oxe,NumberKeyframeTrack:cO,Object3D:ja,ObjectLoader:jwe,ObjectSpaceNormalMap:yoe,OctahedronGeometry:Sk,OneFactor:Yae,OneMinusConstantAlphaFactor:soe,OneMinusConstantColorFactor:roe,OneMinusDstAlphaFactor:Jae,OneMinusDstColorFactor:eoe,OneMinusSrcAlphaFactor:JP,OneMinusSrcColorFactor:Kae,OrthographicCamera:wk,PCFShadowMap:x4,PCFSoftShadowMap:C2,PMREMGenerator:B7,Path:LD,PerspectiveCamera:yf,Plane:r1,PlaneGeometry:Yw,PlaneHelper:MRe,PointLight:Sle,PointLightHelper:bRe,Points:qoe,PointsMaterial:dj,PolarGridHelper:TRe,PolyhedronGeometry:$1,PositionalAudio:Xwe,PropertyBinding:Fa,PropertyMixer:kle,QuadraticBezierCurve:_j,QuadraticBezierCurve3:vj,Quaternion:zp,QuaternionKeyframeTrack:Tk,QuaternionLinearInterpolant:gle,RED_GREEN_RGTC2_Format:OD,RED_RGTC1_Format:sj,REVISION:Hw,RGBADepthPacking:voe,RGBAFormat:Xf,RGBAIntegerFormat:mk,RGBA_ASTC_10x10_Format:TD,RGBA_ASTC_10x5_Format:SD,RGBA_ASTC_10x6_Format:ED,RGBA_ASTC_10x8_Format:xD,RGBA_ASTC_12x10_Format:wD,RGBA_ASTC_12x12_Format:RD,RGBA_ASTC_4x4_Format:dD,RGBA_ASTC_5x4_Format:pD,RGBA_ASTC_5x5_Format:mD,RGBA_ASTC_6x5_Format:gD,RGBA_ASTC_6x6_Format:_D,RGBA_ASTC_8x5_Format:vD,RGBA_ASTC_8x6_Format:yD,RGBA_ASTC_8x8_Format:bD,RGBA_BPTC_Format:P2,RGBA_ETC2_EAC_Format:hD,RGBA_PVRTC_2BPPV1_Format:cD,RGBA_PVRTC_4BPPV1_Format:lD,RGBA_S3TC_DXT1_Format:k2,RGBA_S3TC_DXT3_Format:I2,RGBA_S3TC_DXT5_Format:N2,RGBDepthPacking:gxe,RGBFormat:ij,RGBIntegerFormat:hxe,RGB_BPTC_SIGNED_Format:AD,RGB_BPTC_UNSIGNED_Format:CD,RGB_ETC1_Format:uD,RGB_ETC2_Format:fD,RGB_PVRTC_2BPPV1_Format:oD,RGB_PVRTC_4BPPV1_Format:aD,RGB_S3TC_DXT1_Format:O2,RGDepthPacking:_xe,RGFormat:C4,RGIntegerFormat:M4,RawShaderMaterial:ile,Ray:Gw,Raycaster:Ij,RectAreaLight:Tle,RedFormat:Vw,RedIntegerFormat:pk,ReinhardToneMapping:coe,RenderTarget:k4,RenderTarget3D:cRe,RenderTargetArray:uRe,RepeatWrapping:YT,ReplaceStencilOp:yxe,ReverseSubtractEquation:Vae,RingGeometry:$4,SIGNED_RED_GREEN_RGTC2_Format:kD,SIGNED_RED_RGTC1_Format:MD,SRGBColorSpace:na,SRGBTransfer:Po,Scene:ew,ShaderChunk:_s,ShaderLib:b_,ShaderMaterial:Vl,ShadowMaterial:rle,Shape:uE,ShapeGeometry:W4,ShapePath:IRe,ShapeUtils:R_,ShortType:tj,Skeleton:L4,SkeletonHelper:yRe,SkinnedMesh:Foe,Source:p1,Sphere:xd,SphereGeometry:Ek,Spherical:mRe,SphericalHarmonics3:wle,SplineCurve:yj,SpotLight:ble,SpotLightHelper:vRe,Sprite:Uoe,SpriteMaterial:fj,SrcAlphaFactor:ZP,SrcAlphaSaturateFactor:toe,SrcColorFactor:Xae,StaticCopyUsage:Lxe,StaticDrawUsage:rO,StaticReadUsage:Nxe,StereoCamera:Gwe,StreamCopyUsage:Bxe,StreamDrawUsage:Ixe,StreamReadUsage:Dxe,StringKeyframeTrack:QE,SubtractEquation:qae,SubtractiveBlending:w7,TOUCH:axe,TangentSpaceNormalMap:V1,TetrahedronGeometry:Y4,Texture:wc,TextureLoader:vle,TextureUtils:BRe,TimestampQuery:zxe,TorusGeometry:X4,TorusKnotGeometry:K4,Triangle:Rm,TriangleFanDrawMode:mxe,TriangleStripDrawMode:pxe,TrianglesDrawMode:dxe,TubeGeometry:Z4,UVMapping:T4,Uint16BufferAttribute:cj,Uint32BufferAttribute:uj,Uint8BufferAttribute:RTe,Uint8ClampedBufferAttribute:ATe,Uniform:jn,UniformsGroup:hRe,UniformsLib:or,UniformsUtils:Noe,UnsignedByteType:ql,UnsignedInt248Type:SE,UnsignedInt5999Type:nj,UnsignedIntType:zv,UnsignedShort4444Type:R4,UnsignedShort5551Type:A4,UnsignedShortType:XT,VSMShadowMap:v_,Vector2:an,Vector3:ut,Vector4:Ta,VectorKeyframeTrack:uO,VideoFrameTexture:XTe,VideoTexture:Voe,WebGL3DRenderTarget:dTe,WebGLArrayRenderTarget:hTe,WebGLCoordinateSystem:N0,WebGLCubeRenderTarget:Doe,WebGLRenderTarget:Sf,WebGLRenderer:jle,WebGLUtils:zle,WebGPUCoordinateSystem:iO,WebXRController:nP,WireframeGeometry:nle,WrapAroundEnding:tO,ZeroCurvatureEnding:JS,ZeroFactor:Wae,ZeroSlopeEnding:QS,ZeroStencilOp:vxe,createCanvasElement:Moe},Symbol.toStringTag,{value:"Module"}));var Z5={exports:{}},J5={},Q5={exports:{}},eB={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EY;function bOe(){if(EY)return eB;EY=1;var n=jw();function e(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,h){var g=h(),p=r({inst:{value:g,getSnapshot:h}}),_=p[0].inst,y=p[1];return s(function(){_.value=g,_.getSnapshot=h,l(_)&&y({inst:_})},[f,g,h]),i(function(){return l(_)&&y({inst:_}),f(function(){l(_)&&y({inst:_})})},[f]),a(g),g}function l(f){var h=f.getSnapshot;f=f.value;try{var g=h();return!t(f,g)}catch{return!0}}function c(f,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return eB.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,eB}var xY;function SOe(){return xY||(xY=1,Q5.exports=bOe()),Q5.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TY;function EOe(){if(TY)return J5;TY=1;var n=jw(),e=SOe();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return J5.useSyncExternalStoreWithSelector=function(c,u,f,h,g){var p=s(null);if(p.current===null){var _={hasValue:!1,value:null};p.current=_}else _=p.current;p=o(function(){function v(N){if(!x){if(x=!0,E=N,N=h(N),g!==void 0&&_.hasValue){var I=_.value;if(g(I,N))return M=I}return M=N}if(I=M,r(E,N))return I;var D=h(N);return g!==void 0&&g(I,D)?(E=N,I):(E=N,M=D)}var x=!1,E,M,k=f===void 0?null:f;return[function(){return v(u())},k===null?void 0:function(){return v(k())}]},[u,f,h,g]);var y=i(c,p[0],p[1]);return a(function(){_.hasValue=!0,_.value=y},[y]),l(y),y},J5}var wY;function xOe(){return wY||(wY=1,Z5.exports=EOe()),Z5.exports}var TOe=xOe();const wOe=Bh(TOe),RY=n=>{let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const h=e;e=u??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(g=>g(e,h))}},i=()=>e,o={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(r,i,o);return o},eU=n=>n?RY(n):RY,{useSyncExternalStoreWithSelector:ROe}=wOe,AOe=n=>n;function COe(n,e=AOe,t){const r=ROe(n.subscribe,n.getState,n.getInitialState,e,t);return Ng.useDebugValue(r),r}const AY=(n,e)=>{const t=eU(n),r=(i,s=e)=>COe(t,i,s);return Object.assign(r,t),r},Hle=(n,e)=>n?AY(n,e):AY,MOe=n=>typeof n=="object"&&typeof n.then=="function",nE=[];function qle(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function Vle(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of nE)if(qle(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=nE.indexOf(i);s!==-1&&nE.splice(s,1)},promise:(MOe(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(nE.push(i),!t)throw i.promise}const Gle=(n,e,t)=>Vle(n,e,!1,t),OOe=(n,e,t)=>void Vle(n,e,!0,t),kOe=n=>{if(n===void 0||n.length===0)nE.splice(0,nE.length);else{const e=nE.find(t=>qle(n,t.keys,t.equal));e&&e.remove()}};var tB={exports:{}},nB={exports:{}},rB={exports:{}},iB={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CY;function IOe(){return CY||(CY=1,(function(n){function e(W,q){var Y=W.length;W.push(q);e:for(;0<Y;){var ae=Y-1>>>1,Z=W[ae];if(0<i(Z,q))W[ae]=q,W[Y]=Z,Y=ae;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var q=W[0],Y=W.pop();if(Y!==q){W[0]=Y;e:for(var ae=0,Z=W.length,K=Z>>>1;ae<K;){var ne=2*(ae+1)-1,le=W[ne],ce=ne+1,de=W[ce];if(0>i(le,Y))ce<Z&&0>i(de,le)?(W[ae]=de,W[ce]=Y,ae=ce):(W[ae]=le,W[ne]=Y,ae=ne);else if(ce<Z&&0>i(de,Y))W[ae]=de,W[ce]=Y,ae=ce;else break e}}return q}function i(W,q){var Y=W.sortIndex-q.sortIndex;return Y!==0?Y:W.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,g=!1,p=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function E(W){for(var q=t(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=W)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=t(c)}}function M(W){if(_=!1,E(W),!p)if(t(l)!==null)p=!0,U();else{var q=t(c);q!==null&&Q(M,q.startTime-W)}}var k=!1,N=-1,I=5,D=-1;function V(){return!(n.unstable_now()-D<I)}function G(){if(k){var W=n.unstable_now();D=W;var q=!0;try{e:{p=!1,_&&(_=!1,v(N),N=-1),g=!0;var Y=h;try{t:{for(E(W),f=t(l);f!==null&&!(f.expirationTime>W&&V());){var ae=f.callback;if(typeof ae=="function"){f.callback=null,h=f.priorityLevel;var Z=ae(f.expirationTime<=W);if(W=n.unstable_now(),typeof Z=="function"){f.callback=Z,E(W),q=!0;break t}f===t(l)&&r(l),E(W)}else r(l);f=t(l)}if(f!==null)q=!0;else{var K=t(c);K!==null&&Q(M,K.startTime-W),q=!1}}break e}finally{f=null,h=Y,g=!1}q=void 0}}finally{q?J():k=!1}}}var J;if(typeof x=="function")J=function(){x(G)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,$=B.port2;B.port1.onmessage=G,J=function(){$.postMessage(null)}}else J=function(){y(G,0)};function U(){k||(k=!0,J())}function Q(W,q){N=y(function(){W(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){p||g||(p=!0,U())},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(W){switch(h){case 1:case 2:case 3:var q=3;break;default:q=h}var Y=h;h=q;try{return W()}finally{h=Y}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=h;h=W;try{return q()}finally{h=Y}},n.unstable_scheduleCallback=function(W,q,Y){var ae=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,W={id:u++,callback:q,priorityLevel:W,startTime:Y,expirationTime:Z,sortIndex:-1},Y>ae?(W.sortIndex=Y,e(c,W),t(l)===null&&W===t(c)&&(_?(v(N),N=-1):_=!0,Q(M,Y-ae))):(W.sortIndex=Z,e(l,W),p||g||(p=!0,U())),W},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(W){var q=h;return function(){var Y=h;h=q;try{return W.apply(this,arguments)}finally{h=Y}}}})(iB)),iB}var MY;function $le(){return MY||(MY=1,rB.exports=IOe()),rB.exports}var OY;function NOe(){return OY||(OY=1,(function(n){n.exports=function(e){function t(T,R,z,re){return new Qp(T,R,z,re)}function r(){}function i(T){var R="https://react.dev/errors/"+T;if(1<arguments.length){R+="?args[]="+encodeURIComponent(arguments[1]);for(var z=2;z<arguments.length;z++)R+="&args[]="+encodeURIComponent(arguments[z])}return"Minified React error #"+T+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(T){return T===null||typeof T!="object"?null:(T=Oo&&T[Oo]||T["@@iterator"],typeof T=="function"?T:null)}function a(T){if(T==null)return null;if(typeof T=="function")return T.$$typeof===em?null:T.displayName||T.name||null;if(typeof T=="string")return T;switch(T){case Ha:return"Fragment";case Zl:return"Portal";case Lc:return"Profiler";case ia:return"StrictMode";case Uc:return"Suspense";case nf:return"SuspenseList"}if(typeof T=="object")switch(T.$$typeof){case to:return(T.displayName||"Context")+".Provider";case Au:return(T._context.displayName||"Context")+".Consumer";case tf:var R=T.render;return T=T.displayName,T||(T=R.displayName||R.name||"",T=T!==""?"ForwardRef("+T+")":"ForwardRef"),T;case Cu:return R=T.displayName||null,R!==null?R:a(T.type)||"Memo";case Mo:R=T._payload,T=T._init;try{return a(T(R))}catch{}}return null}function o(T){if(Mu===void 0)try{throw Error()}catch(z){var R=z.stack.trim().match(/\n( *(at )?)/);Mu=R&&R[1]||"",Pf=-1<z.stack.indexOf(`
    at`)?" (<anonymous>)":-1<z.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mu+T+Pf}function l(T,R){if(!T||Zh)return"";Zh=!0;var z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var re={DetermineComponentFrameRoot:function(){try{if(R){var Qn=function(){throw Error()};if(Object.defineProperty(Qn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qn,[])}catch(Xr){var nr=Xr}Reflect.construct(T,[],Qn)}else{try{Qn.call()}catch(Xr){nr=Xr}T.call(Qn.prototype)}}else{try{throw Error()}catch(Xr){nr=Xr}(Qn=T())&&typeof Qn.catch=="function"&&Qn.catch(function(){})}}catch(Xr){if(Xr&&nr&&typeof Xr.stack=="string")return[Xr.stack,nr.stack]}return[null,null]}};re.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var he=Object.getOwnPropertyDescriptor(re.DetermineComponentFrameRoot,"name");he&&he.configurable&&Object.defineProperty(re.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Te=re.DetermineComponentFrameRoot(),et=Te[0],yt=Te[1];if(et&&yt){var zt=et.split(`
`),mn=yt.split(`
`);for(he=re=0;re<zt.length&&!zt[re].includes("DetermineComponentFrameRoot");)re++;for(;he<mn.length&&!mn[he].includes("DetermineComponentFrameRoot");)he++;if(re===zt.length||he===mn.length)for(re=zt.length-1,he=mn.length-1;1<=re&&0<=he&&zt[re]!==mn[he];)he--;for(;1<=re&&0<=he;re--,he--)if(zt[re]!==mn[he]){if(re!==1||he!==1)do if(re--,he--,0>he||zt[re]!==mn[he]){var Ln=`
`+zt[re].replace(" at new "," at ");return T.displayName&&Ln.includes("<anonymous>")&&(Ln=Ln.replace("<anonymous>",T.displayName)),Ln}while(1<=re&&0<=he);break}}}finally{Zh=!1,Error.prepareStackTrace=z}return(z=T?T.displayName||T.name:"")?o(z):""}function c(T){switch(T.tag){case 26:case 27:case 5:return o(T.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return T=l(T.type,!1),T;case 11:return T=l(T.type.render,!1),T;case 1:return T=l(T.type,!0),T;default:return""}}function u(T){try{var R="";do R+=c(T),T=T.return;while(T);return R}catch(z){return`
Error generating stack: `+z.message+`
`+z.stack}}function f(T){var R=T,z=T;if(T.alternate)for(;R.return;)R=R.return;else{T=R;do R=T,(R.flags&4098)!==0&&(z=R.return),T=R.return;while(T)}return R.tag===3?z:null}function h(T){if(f(T)!==T)throw Error(i(188))}function g(T){var R=T.alternate;if(!R){if(R=f(T),R===null)throw Error(i(188));return R!==T?null:T}for(var z=T,re=R;;){var he=z.return;if(he===null)break;var Te=he.alternate;if(Te===null){if(re=he.return,re!==null){z=re;continue}break}if(he.child===Te.child){for(Te=he.child;Te;){if(Te===z)return h(he),T;if(Te===re)return h(he),R;Te=Te.sibling}throw Error(i(188))}if(z.return!==re.return)z=he,re=Te;else{for(var et=!1,yt=he.child;yt;){if(yt===z){et=!0,z=he,re=Te;break}if(yt===re){et=!0,re=he,z=Te;break}yt=yt.sibling}if(!et){for(yt=Te.child;yt;){if(yt===z){et=!0,z=Te,re=he;break}if(yt===re){et=!0,re=Te,z=he;break}yt=yt.sibling}if(!et)throw Error(i(189))}}if(z.alternate!==re)throw Error(i(190))}if(z.tag!==3)throw Error(i(188));return z.stateNode.current===z?T:R}function p(T){var R=T.tag;if(R===5||R===26||R===27||R===6)return T;for(T=T.child;T!==null;){if(R=p(T),R!==null)return R;T=T.sibling}return null}function _(T){var R=T.tag;if(R===5||R===26||R===27||R===6)return T;for(T=T.child;T!==null;){if(T.tag!==4&&(R=_(T),R!==null))return R;T=T.sibling}return null}function y(T){return{current:T}}function v(T){0>ad||(T.current=_o[ad],_o[ad]=null,ad--)}function x(T,R){ad++,_o[ad]=T.current,T.current=R}function E(T){return T>>>=0,T===0?32:31-($o(T)/_g|0)|0}function M(T){var R=T&42;if(R!==0)return R;switch(T&-T){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return T&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return T}}function k(T,R){var z=T.pendingLanes;if(z===0)return 0;var re=0,he=T.suspendedLanes,Te=T.pingedLanes,et=T.warmLanes;T=T.finishedLanes!==0;var yt=z&134217727;return yt!==0?(z=yt&~he,z!==0?re=M(z):(Te&=yt,Te!==0?re=M(Te):T||(et=yt&~et,et!==0&&(re=M(et))))):(yt=z&~he,yt!==0?re=M(yt):Te!==0?re=M(Te):T||(et=z&~et,et!==0&&(re=M(et)))),re===0?0:R!==0&&R!==re&&(R&he)===0&&(he=re&-re,et=R&-R,he>=et||he===32&&(et&4194176)!==0)?R:re}function N(T,R){return(T.pendingLanes&~(T.suspendedLanes&~T.pingedLanes)&R)===0}function I(T,R){switch(T){case 1:case 2:case 4:case 8:return R+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return R+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D(){var T=nu;return nu<<=1,(nu&4194176)===0&&(nu=128),T}function V(){var T=Fd;return Fd<<=1,(Fd&62914560)===0&&(Fd=4194304),T}function G(T){for(var R=[],z=0;31>z;z++)R.push(T);return R}function J(T,R){T.pendingLanes|=R,R!==268435456&&(T.suspendedLanes=0,T.pingedLanes=0,T.warmLanes=0)}function B(T,R,z,re,he,Te){var et=T.pendingLanes;T.pendingLanes=z,T.suspendedLanes=0,T.pingedLanes=0,T.warmLanes=0,T.expiredLanes&=z,T.entangledLanes&=z,T.errorRecoveryDisabledLanes&=z,T.shellSuspendCounter=0;var yt=T.entanglements,zt=T.expirationTimes,mn=T.hiddenUpdates;for(z=et&~z;0<z;){var Ln=31-io(z),Qn=1<<Ln;yt[Ln]=0,zt[Ln]=-1;var nr=mn[Ln];if(nr!==null)for(mn[Ln]=null,Ln=0;Ln<nr.length;Ln++){var Xr=nr[Ln];Xr!==null&&(Xr.lane&=-536870913)}z&=~Qn}re!==0&&$(T,re,0),Te!==0&&he===0&&T.tag!==0&&(T.suspendedLanes|=Te&~(et&~R))}function $(T,R,z){T.pendingLanes|=R,T.suspendedLanes&=~R;var re=31-io(R);T.entangledLanes|=R,T.entanglements[re]=T.entanglements[re]|1073741824|z&4194218}function U(T,R){var z=T.entangledLanes|=R;for(T=T.entanglements;z;){var re=31-io(z),he=1<<re;he&R|T[re]&R&&(T[re]|=R),z&=~he}}function Q(T){return T&=-T,2<T?8<T?(T&134217727)!==0?32:268435456:8:2}function W(T){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(bs,T,void 0,(T.current.flags&128)===128)}catch{}}function q(T){if(typeof Ra=="function"&&Ga(T),$a&&typeof $a.setStrictMode=="function")try{$a.setStrictMode(bs,T)}catch{}}function Y(T,R){return T===R&&(T!==0||1/T===1/R)||T!==T&&R!==R}function ae(T,R){if(typeof T=="object"&&T!==null){var z=la.get(T);return z!==void 0?z:(R={value:T,source:R,stack:u(R)},la.set(T,R),R)}return{value:T,source:R,stack:u(R)}}function Z(T,R){qr[ds++]=ru,qr[ds++]=Aa,Aa=T,ru=R}function K(T,R,z){Gi[Wa++]=Gs,Gi[Wa++]=Os,Gi[Wa++]=cf,cf=T;var re=Gs;T=Os;var he=32-io(re)-1;re&=~(1<<he),z+=1;var Te=32-io(R)+he;if(30<Te){var et=he-he%5;Te=(re&(1<<et)-1).toString(32),re>>=et,he-=et,Gs=1<<32-io(R)+he|z<<he|re,Os=Te+T}else Gs=1<<Te|z<<he|re,Os=T}function ne(T){T.return!==null&&(Z(T,1),K(T,1,0))}function le(T){for(;T===Aa;)Aa=qr[--ds],qr[ds]=null,ru=qr[--ds],qr[ds]=null;for(;T===cf;)cf=Gi[--Wa],Gi[Wa]=null,Os=Gi[--Wa],Gi[Wa]=null,Gs=Gi[--Wa],Gi[Wa]=null}function ce(T,R){x(vc,R),x(so,T),x(Di,null),T=Id(R),v(Di),x(Di,T)}function de(){v(Di),v(so),v(vc)}function Me(T){T.memoizedState!==null&&x(Pl,T);var R=Di.current,z=Nd(R,T.type);R!==z&&(x(so,T),x(Di,z))}function qe(T){so.current===T&&(v(Di),v(so)),Pl.current===T&&(v(Pl),fl?dr._currentValue=mc:dr._currentValue2=mc)}function Ne(T){var R=Error(i(418,""));throw pt(ae(R,T)),is}function Ae(T,R){if(!qo)throw Error(i(175));l0(T.stateNode,T.type,T.memoizedProps,R,T)||Ne(T)}function Xe(T){for(mr=T.return;mr;)switch(mr.tag){case 3:case 27:Wr=!0;return;case 5:case 13:Wr=!1;return;default:mr=mr.return}}function $e(T){if(!qo||T!==mr)return!1;if(!Yn)return Xe(T),Yn=!0,!1;var R=!1;if(Vs?T.tag!==3&&T.tag!==27&&(T.tag!==5||mg(T.type)&&!Zr(T.type,T.memoizedProps))&&(R=!0):T.tag!==3&&(T.tag!==5||mg(T.type)&&!Zr(T.type,T.memoizedProps))&&(R=!0),R&&fr&&Ne(T),Xe(T),T.tag===13){if(!qo)throw Error(i(316));if(T=T.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));fr=c0(T)}else fr=mr?um(T.stateNode):null;return!0}function at(){qo&&(fr=mr=null,Yn=!1)}function pt(T){Ya===null?Ya=[T]:Ya.push(T)}function oe(){for(var T=iu,R=ko=iu=0;R<T;){var z=Lu[R];Lu[R++]=null;var re=Lu[R];Lu[R++]=null;var he=Lu[R];Lu[R++]=null;var Te=Lu[R];if(Lu[R++]=null,re!==null&&he!==null){var et=re.pending;et===null?he.next=he:(he.next=et.next,et.next=he),re.pending=he}Te!==0&&Be(z,he,Te)}}function Ue(T,R,z,re){Lu[iu++]=T,Lu[iu++]=R,Lu[iu++]=z,Lu[iu++]=re,ko|=re,T.lanes|=re,T=T.alternate,T!==null&&(T.lanes|=re)}function Ge(T,R,z,re){return Ue(T,R,z,re),me(T)}function ze(T,R){return Ue(T,null,null,R),me(T)}function Be(T,R,z){T.lanes|=z;var re=T.alternate;re!==null&&(re.lanes|=z);for(var he=!1,Te=T.return;Te!==null;)Te.childLanes|=z,re=Te.alternate,re!==null&&(re.childLanes|=z),Te.tag===22&&(T=Te.stateNode,T===null||T._visibility&1||(he=!0)),T=Te,Te=Te.return;he&&R!==null&&T.tag===3&&(Te=T.stateNode,he=31-io(z),Te=Te.hiddenUpdates,T=Te[he],T===null?Te[he]=[R]:T.push(R),R.lane=z|536870912)}function me(T){if(50<cu)throw cu=0,Bu=null,Error(i(185));for(var R=T.return;R!==null;)T=R,R=T.return;return T.tag===3?T.stateNode:null}function Se(T){T!==ld&&T.next===null&&(ld===null?od=ld=T:ld=ld.next=T),ca=!0,Sp||(Sp=!0,ct(be))}function ke(T,R){if(!Ep&&ca){Ep=!0;do for(var z=!1,re=od;re!==null;){if(T!==0){var he=re.pendingLanes;if(he===0)var Te=0;else{var et=re.suspendedLanes,yt=re.pingedLanes;Te=(1<<31-io(42|T)+1)-1,Te&=he&~(et&~yt),Te=Te&201326677?Te&201326677|1:Te?Te|2:0}Te!==0&&(z=!0,lt(re,Te))}else Te=Zt,Te=k(re,re===It?Te:0),(Te&3)===0||N(re,Te)||(z=!0,lt(re,Te));re=re.next}while(z);Ep=!1}}function be(){ca=Sp=!1;var T=0;_l!==0&&(nd()&&(T=_l),_l=0);for(var R=Sr(),z=null,re=od;re!==null;){var he=re.next,Te=Ke(re,R);Te===0?(re.next=null,z===null?od=he:z.next=he,he===null&&(ld=z)):(z=re,(T!==0||(Te&3)!==0)&&(ca=!0)),re=he}ke(T)}function Ke(T,R){for(var z=T.suspendedLanes,re=T.pingedLanes,he=T.expirationTimes,Te=T.pendingLanes&-62914561;0<Te;){var et=31-io(Te),yt=1<<et,zt=he[et];zt===-1?((yt&z)===0||(yt&re)!==0)&&(he[et]=I(yt,R)):zt<=R&&(T.expiredLanes|=yt),Te&=~yt}if(R=It,z=Zt,z=k(T,T===R?z:0),re=T.callbackNode,z===0||T===R&&Gt===2||T.cancelPendingCommit!==null)return re!==null&&re!==null&&aa(re),T.callbackNode=null,T.callbackPriority=0;if((z&3)===0||N(T,z)){if(R=z&-z,R===T.callbackPriority)return R;switch(re!==null&&aa(re),Q(z)){case 2:case 8:z=_c;break;case 32:z=Ui;break;case 268435456:z=oa;break;default:z=Ui}return re=ot.bind(null,T),z=gl(z,re),T.callbackPriority=R,T.callbackNode=z,R}return re!==null&&re!==null&&aa(re),T.callbackPriority=2,T.callbackNode=null,2}function ot(T,R){var z=T.callbackNode;if(ol()&&T.callbackNode!==z)return null;var re=Zt;return re=k(T,T===It?re:0),re===0?null:(Na(T,re,R),Ke(T,Sr()),T.callbackNode!=null&&T.callbackNode===z?ot.bind(null,T):null)}function lt(T,R){if(ol())return null;Na(T,R,!0)}function ct(T){rd?go(function(){(wt&6)!==0?gl(Ar,T):T()}):gl(Ar,T)}function Vt(){return _l===0&&(_l=D()),_l}function Ot(T,R){if(vl===null){var z=vl=[];Fc=0,Ji=Vt(),Jr={status:"pending",value:void 0,then:function(re){z.push(re)}}}return Fc++,R.then(Ut,Ut),R}function Ut(){if(--Fc===0&&vl!==null){Jr!==null&&(Jr.status="fulfilled");var T=vl;vl=null,Ji=0,Jr=null;for(var R=0;R<T.length;R++)(0,T[R])()}}function je(T,R){var z=[],re={status:"pending",value:null,reason:null,then:function(he){z.push(he)}};return T.then(function(){re.status="fulfilled",re.value=R;for(var he=0;he<z.length;he++)(0,z[he])(R)},function(he){for(re.status="rejected",re.reason=he,he=0;he<z.length;he++)(0,z[he])(void 0)}),re}function ge(T){T.updateQueue={baseState:T.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function se(T,R){T=T.updateQueue,R.updateQueue===T&&(R.updateQueue={baseState:T.baseState,firstBaseUpdate:T.firstBaseUpdate,lastBaseUpdate:T.lastBaseUpdate,shared:T.shared,callbacks:null})}function _e(T){return{lane:T,tag:0,payload:null,callback:null,next:null}}function Ie(T,R,z){var re=T.updateQueue;if(re===null)return null;if(re=re.shared,(wt&2)!==0){var he=re.pending;return he===null?R.next=R:(R.next=he.next,he.next=R),re.pending=R,R=me(T),Be(T,null,z),R}return Ue(T,re,R,z),me(T)}function De(T,R,z){if(R=R.updateQueue,R!==null&&(R=R.shared,(z&4194176)!==0)){var re=R.lanes;re&=T.pendingLanes,z|=re,R.lanes=z,U(T,z)}}function Oe(T,R){var z=T.updateQueue,re=T.alternate;if(re!==null&&(re=re.updateQueue,z===re)){var he=null,Te=null;if(z=z.firstBaseUpdate,z!==null){do{var et={lane:z.lane,tag:z.tag,payload:z.payload,callback:null,next:null};Te===null?he=Te=et:Te=Te.next=et,z=z.next}while(z!==null);Te===null?he=Te=R:Te=Te.next=R}else he=Te=R;z={baseState:re.baseState,firstBaseUpdate:he,lastBaseUpdate:Te,shared:re.shared,callbacks:re.callbacks},T.updateQueue=z;return}T=z.lastBaseUpdate,T===null?z.firstBaseUpdate=R:T.next=R,z.lastBaseUpdate=R}function we(){if(vh){var T=Jr;if(T!==null)throw T}}function st(T,R,z,re){vh=!1;var he=T.updateQueue;ao=!1;var Te=he.firstBaseUpdate,et=he.lastBaseUpdate,yt=he.shared.pending;if(yt!==null){he.shared.pending=null;var zt=yt,mn=zt.next;zt.next=null,et===null?Te=mn:et.next=mn,et=zt;var Ln=T.alternate;Ln!==null&&(Ln=Ln.updateQueue,yt=Ln.lastBaseUpdate,yt!==et&&(yt===null?Ln.firstBaseUpdate=mn:yt.next=mn,Ln.lastBaseUpdate=zt))}if(Te!==null){var Qn=he.baseState;et=0,Ln=mn=zt=null,yt=Te;do{var nr=yt.lane&-536870913,Xr=nr!==yt.lane;if(Xr?(Zt&nr)===nr:(re&nr)===nr){nr!==0&&nr===Ji&&(vh=!0),Ln!==null&&(Ln=Ln.next={lane:0,tag:yt.tag,payload:yt.payload,callback:null,next:null});e:{var uu=T,hd=yt;nr=R;var dd=z;switch(hd.tag){case 1:if(uu=hd.payload,typeof uu=="function"){Qn=uu.call(dd,Qn,nr);break e}Qn=uu;break e;case 3:uu.flags=uu.flags&-65537|128;case 0:if(uu=hd.payload,nr=typeof uu=="function"?uu.call(dd,Qn,nr):uu,nr==null)break e;Qn=Od({},Qn,nr);break e;case 2:ao=!0}}nr=yt.callback,nr!==null&&(T.flags|=64,Xr&&(T.flags|=8192),Xr=he.callbacks,Xr===null?he.callbacks=[nr]:Xr.push(nr))}else Xr={lane:nr,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},Ln===null?(mn=Ln=Xr,zt=Qn):Ln=Ln.next=Xr,et|=nr;if(yt=yt.next,yt===null){if(yt=he.shared.pending,yt===null)break;Xr=yt,yt=Xr.next,Xr.next=null,he.lastBaseUpdate=Xr,he.shared.pending=null}}while(!0);Ln===null&&(zt=Qn),he.baseState=zt,he.firstBaseUpdate=mn,he.lastBaseUpdate=Ln,Te===null&&(he.shared.lanes=0),gr|=et,T.lanes=et,T.memoizedState=Qn}}function Ve(T,R){if(typeof T!="function")throw Error(i(191,T));T.call(R)}function tt(T,R){var z=T.callbacks;if(z!==null)for(T.callbacks=null,T=0;T<z.length;T++)Ve(z[T],R)}function Ze(T,R){if(Nl(T,R))return!0;if(typeof T!="object"||T===null||typeof R!="object"||R===null)return!1;var z=Object.keys(T),re=Object.keys(R);if(z.length!==re.length)return!1;for(re=0;re<z.length;re++){var he=z[re];if(!yl.call(R,he)||!Nl(T[he],R[he]))return!1}return!0}function nt(T){return T=T.status,T==="fulfilled"||T==="rejected"}function vt(){}function Je(T,R,z){switch(z=T[z],z===void 0?T.push(R):z!==R&&(R.then(vt,vt),R=z),R.status){case"fulfilled":return R.value;case"rejected":throw T=R.reason,T===va?Error(i(483)):T;default:if(typeof R.status=="string")R.then(vt,vt);else{if(T=It,T!==null&&100<T.shellSuspendCounter)throw Error(i(482));T=R,T.status="pending",T.then(function(re){if(R.status==="pending"){var he=R;he.status="fulfilled",he.value=re}},function(re){if(R.status==="pending"){var he=R;he.status="rejected",he.reason=re}})}switch(R.status){case"fulfilled":return R.value;case"rejected":throw T=R.reason,T===va?Error(i(483)):T}throw zf=R,va}}function ht(){if(zf===null)throw Error(i(459));var T=zf;return zf=null,T}function mt(T){var R=au;return au+=1,su===null&&(su=[]),Je(su,T,R)}function ft(T,R){R=R.props.ref,T.ref=R!==void 0?R:null}function _t(T,R){throw R.$$typeof===mp?Error(i(525)):(T=Object.prototype.toString.call(R),Error(i(31,T==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":T)))}function gn(T){var R=T._init;return R(T._payload)}function _n(T){function R(Jt,Ct){if(T){var nn=Jt.deletions;nn===null?(Jt.deletions=[Ct],Jt.flags|=16):nn.push(Ct)}}function z(Jt,Ct){if(!T)return null;for(;Ct!==null;)R(Jt,Ct),Ct=Ct.sibling;return null}function re(Jt){for(var Ct=new Map;Jt!==null;)Jt.key!==null?Ct.set(Jt.key,Jt):Ct.set(Jt.index,Jt),Jt=Jt.sibling;return Ct}function he(Jt,Ct){return Jt=Co(Jt,Ct),Jt.index=0,Jt.sibling=null,Jt}function Te(Jt,Ct,nn){return Jt.index=nn,T?(nn=Jt.alternate,nn!==null?(nn=nn.index,nn<Ct?(Jt.flags|=33554434,Ct):nn):(Jt.flags|=33554434,Ct)):(Jt.flags|=1048576,Ct)}function et(Jt){return T&&Jt.alternate===null&&(Jt.flags|=33554434),Jt}function yt(Jt,Ct,nn,Un){return Ct===null||Ct.tag!==6?(Ct=dp(nn,Jt.mode,Un),Ct.return=Jt,Ct):(Ct=he(Ct,nn),Ct.return=Jt,Ct)}function zt(Jt,Ct,nn,Un){var Or=nn.type;return Or===Ha?Ln(Jt,Ct,nn.props.children,Un,nn.key):Ct!==null&&(Ct.elementType===Or||typeof Or=="object"&&Or!==null&&Or.$$typeof===Mo&&gn(Or)===Ct.type)?(Ct=he(Ct,nn.props),ft(Ct,nn),Ct.return=Jt,Ct):(Ct=Qu(nn.type,nn.key,nn.props,null,Jt.mode,Un),ft(Ct,nn),Ct.return=Jt,Ct)}function mn(Jt,Ct,nn,Un){return Ct===null||Ct.tag!==4||Ct.stateNode.containerInfo!==nn.containerInfo||Ct.stateNode.implementation!==nn.implementation?(Ct=ef(nn,Jt.mode,Un),Ct.return=Jt,Ct):(Ct=he(Ct,nn.children||[]),Ct.return=Jt,Ct)}function Ln(Jt,Ct,nn,Un,Or){return Ct===null||Ct.tag!==7?(Ct=Pa(nn,Jt.mode,Un,Or),Ct.return=Jt,Ct):(Ct=he(Ct,nn),Ct.return=Jt,Ct)}function Qn(Jt,Ct,nn){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Ct=dp(""+Ct,Jt.mode,nn),Ct.return=Jt,Ct;if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case cl:return nn=Qu(Ct.type,Ct.key,Ct.props,null,Jt.mode,nn),ft(nn,Ct),nn.return=Jt,nn;case Zl:return Ct=ef(Ct,Jt.mode,nn),Ct.return=Jt,Ct;case Mo:var Un=Ct._init;return Ct=Un(Ct._payload),Qn(Jt,Ct,nn)}if(Jh(Ct)||s(Ct))return Ct=Pa(Ct,Jt.mode,nn,null),Ct.return=Jt,Ct;if(typeof Ct.then=="function")return Qn(Jt,mt(Ct),nn);if(Ct.$$typeof===to)return Qn(Jt,vr(Jt,Ct),nn);_t(Jt,Ct)}return null}function nr(Jt,Ct,nn,Un){var Or=Ct!==null?Ct.key:null;if(typeof nn=="string"&&nn!==""||typeof nn=="number"||typeof nn=="bigint")return Or!==null?null:yt(Jt,Ct,""+nn,Un);if(typeof nn=="object"&&nn!==null){switch(nn.$$typeof){case cl:return nn.key===Or?zt(Jt,Ct,nn,Un):null;case Zl:return nn.key===Or?mn(Jt,Ct,nn,Un):null;case Mo:return Or=nn._init,nn=Or(nn._payload),nr(Jt,Ct,nn,Un)}if(Jh(nn)||s(nn))return Or!==null?null:Ln(Jt,Ct,nn,Un,null);if(typeof nn.then=="function")return nr(Jt,Ct,mt(nn),Un);if(nn.$$typeof===to)return nr(Jt,Ct,vr(Jt,nn),Un);_t(Jt,nn)}return null}function Xr(Jt,Ct,nn,Un,Or){if(typeof Un=="string"&&Un!==""||typeof Un=="number"||typeof Un=="bigint")return Jt=Jt.get(nn)||null,yt(Ct,Jt,""+Un,Or);if(typeof Un=="object"&&Un!==null){switch(Un.$$typeof){case cl:return Jt=Jt.get(Un.key===null?nn:Un.key)||null,zt(Ct,Jt,Un,Or);case Zl:return Jt=Jt.get(Un.key===null?nn:Un.key)||null,mn(Ct,Jt,Un,Or);case Mo:var ba=Un._init;return Un=ba(Un._payload),Xr(Jt,Ct,nn,Un,Or)}if(Jh(Un)||s(Un))return Jt=Jt.get(nn)||null,Ln(Ct,Jt,Un,Or,null);if(typeof Un.then=="function")return Xr(Jt,Ct,nn,mt(Un),Or);if(Un.$$typeof===to)return Xr(Jt,Ct,nn,vr(Ct,Un),Or);_t(Ct,Un)}return null}function uu(Jt,Ct,nn,Un){for(var Or=null,ba=null,Kr=Ct,Es=Ct=0,Ca=null;Kr!==null&&Es<nn.length;Es++){Kr.index>Es?(Ca=Kr,Kr=null):Ca=Kr.sibling;var Qi=nr(Jt,Kr,nn[Es],Un);if(Qi===null){Kr===null&&(Kr=Ca);break}T&&Kr&&Qi.alternate===null&&R(Jt,Kr),Ct=Te(Qi,Ct,Es),ba===null?Or=Qi:ba.sibling=Qi,ba=Qi,Kr=Ca}if(Es===nn.length)return z(Jt,Kr),Yn&&Z(Jt,Es),Or;if(Kr===null){for(;Es<nn.length;Es++)Kr=Qn(Jt,nn[Es],Un),Kr!==null&&(Ct=Te(Kr,Ct,Es),ba===null?Or=Kr:ba.sibling=Kr,ba=Kr);return Yn&&Z(Jt,Es),Or}for(Kr=re(Kr);Es<nn.length;Es++)Ca=Xr(Kr,Jt,Es,nn[Es],Un),Ca!==null&&(T&&Ca.alternate!==null&&Kr.delete(Ca.key===null?Es:Ca.key),Ct=Te(Ca,Ct,Es),ba===null?Or=Ca:ba.sibling=Ca,ba=Ca);return T&&Kr.forEach(function(pd){return R(Jt,pd)}),Yn&&Z(Jt,Es),Or}function hd(Jt,Ct,nn,Un){if(nn==null)throw Error(i(151));for(var Or=null,ba=null,Kr=Ct,Es=Ct=0,Ca=null,Qi=nn.next();Kr!==null&&!Qi.done;Es++,Qi=nn.next()){Kr.index>Es?(Ca=Kr,Kr=null):Ca=Kr.sibling;var pd=nr(Jt,Kr,Qi.value,Un);if(pd===null){Kr===null&&(Kr=Ca);break}T&&Kr&&pd.alternate===null&&R(Jt,Kr),Ct=Te(pd,Ct,Es),ba===null?Or=pd:ba.sibling=pd,ba=pd,Kr=Ca}if(Qi.done)return z(Jt,Kr),Yn&&Z(Jt,Es),Or;if(Kr===null){for(;!Qi.done;Es++,Qi=nn.next())Qi=Qn(Jt,Qi.value,Un),Qi!==null&&(Ct=Te(Qi,Ct,Es),ba===null?Or=Qi:ba.sibling=Qi,ba=Qi);return Yn&&Z(Jt,Es),Or}for(Kr=re(Kr);!Qi.done;Es++,Qi=nn.next())Qi=Xr(Kr,Jt,Es,Qi.value,Un),Qi!==null&&(T&&Qi.alternate!==null&&Kr.delete(Qi.key===null?Es:Qi.key),Ct=Te(Qi,Ct,Es),ba===null?Or=Qi:ba.sibling=Qi,ba=Qi);return T&&Kr.forEach(function(o_){return R(Jt,o_)}),Yn&&Z(Jt,Es),Or}function dd(Jt,Ct,nn,Un){if(typeof nn=="object"&&nn!==null&&nn.type===Ha&&nn.key===null&&(nn=nn.props.children),typeof nn=="object"&&nn!==null){switch(nn.$$typeof){case cl:e:{for(var Or=nn.key;Ct!==null;){if(Ct.key===Or){if(Or=nn.type,Or===Ha){if(Ct.tag===7){z(Jt,Ct.sibling),Un=he(Ct,nn.props.children),Un.return=Jt,Jt=Un;break e}}else if(Ct.elementType===Or||typeof Or=="object"&&Or!==null&&Or.$$typeof===Mo&&gn(Or)===Ct.type){z(Jt,Ct.sibling),Un=he(Ct,nn.props),ft(Un,nn),Un.return=Jt,Jt=Un;break e}z(Jt,Ct);break}else R(Jt,Ct);Ct=Ct.sibling}nn.type===Ha?(Un=Pa(nn.props.children,Jt.mode,Un,nn.key),Un.return=Jt,Jt=Un):(Un=Qu(nn.type,nn.key,nn.props,null,Jt.mode,Un),ft(Un,nn),Un.return=Jt,Jt=Un)}return et(Jt);case Zl:e:{for(Or=nn.key;Ct!==null;){if(Ct.key===Or)if(Ct.tag===4&&Ct.stateNode.containerInfo===nn.containerInfo&&Ct.stateNode.implementation===nn.implementation){z(Jt,Ct.sibling),Un=he(Ct,nn.children||[]),Un.return=Jt,Jt=Un;break e}else{z(Jt,Ct);break}else R(Jt,Ct);Ct=Ct.sibling}Un=ef(nn,Jt.mode,Un),Un.return=Jt,Jt=Un}return et(Jt);case Mo:return Or=nn._init,nn=Or(nn._payload),dd(Jt,Ct,nn,Un)}if(Jh(nn))return uu(Jt,Ct,nn,Un);if(s(nn)){if(Or=s(nn),typeof Or!="function")throw Error(i(150));return nn=Or.call(nn),hd(Jt,Ct,nn,Un)}if(typeof nn.then=="function")return dd(Jt,Ct,mt(nn),Un);if(nn.$$typeof===to)return dd(Jt,Ct,vr(Jt,nn),Un);_t(Jt,nn)}return typeof nn=="string"&&nn!==""||typeof nn=="number"||typeof nn=="bigint"?(nn=""+nn,Ct!==null&&Ct.tag===6?(z(Jt,Ct.sibling),Un=he(Ct,nn),Un.return=Jt,Jt=Un):(z(Jt,Ct),Un=dp(nn,Jt.mode,Un),Un.return=Jt,Jt=Un),et(Jt)):z(Jt,Ct)}return function(Jt,Ct,nn,Un){try{au=0;var Or=dd(Jt,Ct,nn,Un);return su=null,Or}catch(Kr){if(Kr===va)throw Kr;var ba=t(29,Kr,null,Jt.mode);return ba.lanes=Un,ba.return=Jt,ba}finally{}}}function Bt(T,R){T=qn,x(jd,T),x(ua,R),qn=T|R.baseLanes}function Yt(){x(jd,qn),x(ua,ua.current)}function Mt(){qn=jd.current,v(ua),v(jd)}function fn(T){var R=T.alternate;x(Io,Io.current&1),x(ou,T),$s===null&&(R===null||ua.current!==null||R.memoizedState!==null)&&($s=T)}function Bn(T){if(T.tag===22){if(x(Io,Io.current),x(ou,T),$s===null){var R=T.alternate;R!==null&&R.memoizedState!==null&&($s=T)}}else cn()}function cn(){x(Io,Io.current),x(ou,ou.current)}function In(T){v(ou),$s===T&&($s=null),v(Io)}function Wn(T){for(var R=T;R!==null;){if(R.tag===13){var z=R.memoizedState;if(z!==null&&(z=z.dehydrated,z===null||lm(z)||fg(z)))return R}else if(R.tag===19&&R.memoizedProps.revealOrder!==void 0){if((R.flags&128)!==0)return R}else if(R.child!==null){R.child.return=R,R=R.child;continue}if(R===T)break;for(;R.sibling===null;){if(R.return===null||R.return===T)return null;R=R.return}R.sibling.return=R.return,R=R.sibling}return null}function er(){throw Error(i(321))}function os(T,R){if(R===null)return!1;for(var z=0;z<R.length&&z<T.length;z++)if(!Nl(T[z],R[z]))return!1;return!0}function gi(T,R,z,re,he,Te){return cd=Te,bi=R,R.memoizedState=null,R.updateQueue=null,R.lanes=0,Hr.H=T===null||T.memoizedState===null?ff:hi,bh=!1,Te=z(re,he),bh=!1,ud&&(Te=Fs(R,z,re,he)),Ni(T),Te}function Ni(T){Hr.H=ks;var R=ar!==null&&ar.next!==null;if(cd=0,Bi=ar=bi=null,Yo=!1,No=0,ps=null,R)throw Error(i(300));T===null||ya||(T=T.dependencies,T!==null&&sr(T)&&(ya=!0))}function Fs(T,R,z,re){bi=T;var he=0;do{if(ud&&(ps=null),No=0,ud=!1,25<=he)throw Error(i(301));if(he+=1,Bi=ar=null,T.updateQueue!=null){var Te=T.updateQueue;Te.lastEffect=null,Te.events=null,Te.stores=null,Te.memoCache!=null&&(Te.memoCache.index=0)}Hr.H=lu,Te=R(z,re)}while(ud);return Te}function _i(){var T=Hr.H,R=T.useState()[0];return R=typeof R.then=="function"?Wt(R):R,T=T.useState()[0],(ar!==null?ar.memoizedState:null)!==T&&(bi.flags|=1024),R}function Rs(){var T=vg!==0;return vg=0,T}function ra(T,R,z){R.updateQueue=T.updateQueue,R.flags&=-2053,T.lanes&=~z}function ls(T){if(Yo){for(T=T.memoizedState;T!==null;){var R=T.queue;R!==null&&(R.pending=null),T=T.next}Yo=!1}cd=0,Bi=ar=bi=null,ud=!1,No=vg=0,ps=null}function We(){var T={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bi===null?bi.memoizedState=Bi=T:Bi=Bi.next=T,Bi}function At(){if(ar===null){var T=bi.alternate;T=T!==null?T.memoizedState:null}else T=ar.next;var R=Bi===null?bi.memoizedState:Bi.next;if(R!==null)Bi=R,ar=T;else{if(T===null)throw bi.alternate===null?Error(i(467)):Error(i(310));ar=T,T={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},Bi===null?bi.memoizedState=Bi=T:Bi=Bi.next=T}return Bi}function Wt(T){var R=No;return No+=1,ps===null&&(ps=[]),T=Je(ps,T,R),R=bi,(Bi===null?R.memoizedState:Bi.next)===null&&(R=R.alternate,Hr.H=R===null||R.memoizedState===null?ff:hi),T}function Kt(T){if(T!==null&&typeof T=="object"){if(typeof T.then=="function")return Wt(T);if(T.$$typeof===to)return Ia(T)}throw Error(i(438,String(T)))}function Lt(T){var R=null,z=bi.updateQueue;if(z!==null&&(R=z.memoCache),R==null){var re=bi.alternate;re!==null&&(re=re.updateQueue,re!==null&&(re=re.memoCache,re!=null&&(R={data:re.data.map(function(he){return he.slice()}),index:0})))}if(R==null&&(R={data:[],index:0}),z===null&&(z=nc(),bi.updateQueue=z),z.memoCache=R,z=R.data[R.index],z===void 0)for(z=R.data[R.index]=Array(T),re=0;re<T;re++)z[re]=sf;return R.index++,z}function yn(T,R){return typeof R=="function"?R(T):R}function zn(T){var R=At();return En(R,ar,T)}function En(T,R,z){var re=T.queue;if(re===null)throw Error(i(311));re.lastRenderedReducer=z;var he=T.baseQueue,Te=re.pending;if(Te!==null){if(he!==null){var et=he.next;he.next=Te.next,Te.next=et}R.baseQueue=he=Te,re.pending=null}if(Te=T.baseState,he===null)T.memoizedState=Te;else{R=he.next;var yt=et=null,zt=null,mn=R,Ln=!1;do{var Qn=mn.lane&-536870913;if(Qn!==mn.lane?(Zt&Qn)===Qn:(cd&Qn)===Qn){var nr=mn.revertLane;if(nr===0)zt!==null&&(zt=zt.next={lane:0,revertLane:0,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null}),Qn===Ji&&(Ln=!0);else if((cd&nr)===nr){mn=mn.next,nr===Ji&&(Ln=!0);continue}else Qn={lane:0,revertLane:mn.revertLane,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null},zt===null?(yt=zt=Qn,et=Te):zt=zt.next=Qn,bi.lanes|=nr,gr|=nr;Qn=mn.action,bh&&z(Te,Qn),Te=mn.hasEagerState?mn.eagerState:z(Te,Qn)}else nr={lane:Qn,revertLane:mn.revertLane,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null},zt===null?(yt=zt=nr,et=Te):zt=zt.next=nr,bi.lanes|=Qn,gr|=Qn;mn=mn.next}while(mn!==null&&mn!==R);if(zt===null?et=Te:zt.next=yt,!Nl(Te,T.memoizedState)&&(ya=!0,Ln&&(z=Jr,z!==null)))throw z;T.memoizedState=Te,T.baseState=et,T.baseQueue=zt,re.lastRenderedState=Te}return he===null&&(re.lanes=0),[T.memoizedState,re.dispatch]}function tr(T){var R=At(),z=R.queue;if(z===null)throw Error(i(311));z.lastRenderedReducer=T;var re=z.dispatch,he=z.pending,Te=R.memoizedState;if(he!==null){z.pending=null;var et=he=he.next;do Te=T(Te,et.action),et=et.next;while(et!==he);Nl(Te,R.memoizedState)||(ya=!0),R.memoizedState=Te,R.baseQueue===null&&(R.baseState=Te),z.lastRenderedState=Te}return[Te,re]}function Nr(T,R,z){var re=bi,he=At(),Te=Yn;if(Te){if(z===void 0)throw Error(i(407));z=z()}else z=R();var et=!Nl((ar||he).memoizedState,z);if(et&&(he.memoizedState=z,ya=!0),he=he.queue,Wp(Lr.bind(null,re,he,T),[T]),he.getSnapshot!==R||et||Bi!==null&&Bi.memoizedState.tag&1){if(re.flags|=2048,So(9,rr.bind(null,re,he,z,R),{destroy:void 0},null),It===null)throw Error(i(349));Te||(cd&60)!==0||Er(re,R,z)}return z}function Er(T,R,z){T.flags|=16384,T={getSnapshot:R,value:z},R=bi.updateQueue,R===null?(R=nc(),bi.updateQueue=R,R.stores=[T]):(z=R.stores,z===null?R.stores=[T]:z.push(T))}function rr(T,R,z,re){R.value=z,R.getSnapshot=re,ii(R)&&da(T)}function Lr(T,R,z){return z(function(){ii(R)&&da(T)})}function ii(T){var R=T.getSnapshot;T=T.value;try{var z=R();return!Nl(T,z)}catch{return!0}}function da(T){var R=ze(T,2);R!==null&&Ro(R,T,2)}function Mr(T){var R=We();if(typeof T=="function"){var z=T;if(T=z(),bh){q(!0);try{z()}finally{q(!1)}}}return R.memoizedState=R.baseState=T,R.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:T},R}function si(T,R,z,re){return T.baseState=z,En(T,ar,typeof re=="function"?re:yn)}function Tr(T,R,z,re,he){if(ih(T))throw Error(i(485));if(T=R.action,T!==null){var Te={payload:he,action:T,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){Te.listeners.push(et)}};Hr.T!==null?z(!0):Te.isTransition=!1,re(Te),z=R.pending,z===null?(Te.next=R.pending=Te,Dr(R,Te)):(Te.next=z.next,R.pending=z.next=Te)}}function Dr(T,R){var z=R.action,re=R.payload,he=T.state;if(R.isTransition){var Te=Hr.T,et={};Hr.T=et;try{var yt=z(he,re),zt=Hr.S;zt!==null&&zt(et,yt),Cn(T,R,yt)}catch(mn){Uo(T,R,mn)}finally{Hr.T=Te}}else try{Te=z(he,re),Cn(T,R,Te)}catch(mn){Uo(T,R,mn)}}function Cn(T,R,z){z!==null&&typeof z=="object"&&typeof z.then=="function"?z.then(function(re){jr(T,R,re)},function(re){return Uo(T,R,re)}):jr(T,R,z)}function jr(T,R,z){R.status="fulfilled",R.value=z,cs(R),T.state=z,R=T.pending,R!==null&&(z=R.next,z===R?T.pending=null:(z=z.next,R.next=z,Dr(T,z)))}function Uo(T,R,z){var re=T.pending;if(T.pending=null,re!==null){re=re.next;do R.status="rejected",R.reason=z,cs(R),R=R.next;while(R!==re)}T.action=null}function cs(T){T=T.listeners;for(var R=0;R<T.length;R++)(0,T[R])()}function Bo(T,R){return R}function us(T,R){if(Yn){var z=It.formState;if(z!==null){e:{var re=bi;if(Yn){if(fr){var he=cm(fr,Wr);if(he){fr=um(he),re=n_(he);break e}}Ne(re)}re=!1}re&&(R=z[0])}}z=We(),z.memoizedState=z.baseState=R,re={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:R},z.queue=re,z=uo.bind(null,bi,re),re.dispatch=z,re=Mr(!1);var Te=Xc.bind(null,bi,!1,re.queue);return re=We(),he={state:R,dispatch:null,action:T,pending:null},re.queue=he,z=Tr.bind(null,bi,he,Te,z),he.dispatch=z,re.memoizedState=T,[R,z,!1]}function Xn(T){var R=At();return ei(R,ar,T)}function ei(T,R,z){R=En(T,R,Bo)[0],T=zn(yn)[0],R=typeof R=="object"&&R!==null&&typeof R.then=="function"?Wt(R):R;var re=At(),he=re.queue,Te=he.dispatch;return z!==re.memoizedState&&(bi.flags|=2048,So(9,ur.bind(null,he,z),{destroy:void 0},null)),[R,Te,T]}function ur(T,R){T.action=R}function zs(T){var R=At(),z=ar;if(z!==null)return ei(R,z,T);At(),R=R.memoizedState,z=At();var re=z.queue.dispatch;return z.memoizedState=T,[R,re,!1]}function So(T,R,z,re){return T={tag:T,create:R,inst:z,deps:re,next:null},R=bi.updateQueue,R===null&&(R=nc(),bi.updateQueue=R),z=R.lastEffect,z===null?R.lastEffect=T.next=T:(re=z.next,z.next=T,T.next=re,R.lastEffect=T),T}function pa(){return At().memoizedState}function ma(T,R,z,re){var he=We();bi.flags|=T,he.memoizedState=So(1|R,z,{destroy:void 0},re===void 0?null:re)}function zh(T,R,z,re){var he=At();re=re===void 0?null:re;var Te=he.memoizedState.inst;ar!==null&&re!==null&&os(re,ar.memoizedState.deps)?he.memoizedState=So(R,z,Te,re):(bi.flags|=T,he.memoizedState=So(1|R,z,Te,re))}function op(T,R){ma(8390656,8,T,R)}function Wp(T,R){zh(2048,8,T,R)}function Yp(T,R){return zh(4,2,T,R)}function rh(T,R){return zh(4,4,T,R)}function wl(T,R){if(typeof R=="function"){T=T();var z=R(T);return function(){typeof z=="function"?z():R(null)}}if(R!=null)return T=T(),R.current=T,function(){R.current=null}}function cc(T,R,z){z=z!=null?z.concat([T]):null,zh(4,4,wl.bind(null,R,T),z)}function Fo(){}function il(T,R){var z=At();R=R===void 0?null:R;var re=z.memoizedState;return R!==null&&os(R,re[1])?re[0]:(z.memoizedState=[T,R],T)}function Xp(T,R){var z=At();R=R===void 0?null:R;var re=z.memoizedState;if(R!==null&&os(R,re[1]))return re[0];if(re=T(),bh){q(!0);try{T()}finally{q(!1)}}return z.memoizedState=[re,R],re}function Ac(T,R,z){return z===void 0||(cd&1073741824)!==0?T.memoizedState=R:(T.memoizedState=z,T=hp(),bi.lanes|=T,gr|=T,z)}function Wc(T,R,z,re){return Nl(z,R)?z:ua.current!==null?(T=Ac(T,z,re),Nl(T,R)||(ya=!0),T):(cd&42)===0?(ya=!0,T.memoizedState=z):(T=hp(),bi.lanes|=T,gr|=T,R)}function Yu(T,R,z,re,he){var Te=ro();Js(Te!==0&&8>Te?Te:8);var et=Hr.T,yt={};Hr.T=yt,Xc(T,!1,R,z);try{var zt=he(),mn=Hr.S;if(mn!==null&&mn(yt,zt),zt!==null&&typeof zt=="object"&&typeof zt.then=="function"){var Ln=je(zt,re);Yc(T,R,Ln,_a(T))}else Yc(T,R,re,_a(T))}catch(Qn){Yc(T,R,{then:function(){},status:"rejected",reason:Qn},_a())}finally{Js(Te),Hr.T=et}}function Yi(T){var R=T.memoizedState;if(R!==null)return R;R={memoizedState:mc,baseState:mc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:mc},next:null};var z={};return R.next={memoizedState:z,baseState:z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:z},next:null},T.memoizedState=R,T=T.alternate,T!==null&&(T.memoizedState=R),R}function Xi(){return Ia(dr)}function Cc(){return At().memoizedState}function Ef(){return At().memoizedState}function Jm(T){for(var R=T.return;R!==null;){switch(R.tag){case 24:case 3:var z=_a();T=_e(z);var re=Ie(R,T,z);re!==null&&(Ro(re,R,z),De(re,R,z)),R={cache:ch()},T.payload=R;return}R=R.return}}function uc(T,R,z){var re=_a();z={lane:re,revertLane:0,action:z,hasEagerState:!1,eagerState:null,next:null},ih(T)?ga(R,z):(z=Ge(T,R,z,re),z!==null&&(Ro(z,T,re),xf(z,R,re)))}function uo(T,R,z){var re=_a();Yc(T,R,z,re)}function Yc(T,R,z,re){var he={lane:re,revertLane:0,action:z,hasEagerState:!1,eagerState:null,next:null};if(ih(T))ga(R,he);else{var Te=T.alternate;if(T.lanes===0&&(Te===null||Te.lanes===0)&&(Te=R.lastRenderedReducer,Te!==null))try{var et=R.lastRenderedState,yt=Te(et,z);if(he.hasEagerState=!0,he.eagerState=yt,Nl(yt,et))return Ue(T,R,he,0),It===null&&oe(),!1}catch{}finally{}if(z=Ge(T,R,he,re),z!==null)return Ro(z,T,re),xf(z,R,re),!0}return!1}function Xc(T,R,z,re){if(re={lane:2,revertLane:Vt(),action:re,hasEagerState:!1,eagerState:null,next:null},ih(T)){if(R)throw Error(i(479))}else R=Ge(T,z,re,2),R!==null&&Ro(R,T,2)}function ih(T){var R=T.alternate;return T===bi||R!==null&&R===bi}function ga(T,R){ud=Yo=!0;var z=T.pending;z===null?R.next=R:(R.next=z.next,z.next=R),T.pending=R}function xf(T,R,z){if((z&4194176)!==0){var re=R.lanes;re&=T.pendingLanes,z|=re,R.lanes=z,U(T,z)}}function sh(T,R,z,re){R=T.memoizedState,z=z(re,R),z=z==null?R:Od({},R,z),T.memoizedState=z,T.lanes===0&&(T.updateQueue.baseState=z)}function ah(T,R,z,re,he,Te,et){return T=T.stateNode,typeof T.shouldComponentUpdate=="function"?T.shouldComponentUpdate(re,Te,et):R.prototype&&R.prototype.isPureReactComponent?!Ze(z,re)||!Ze(he,Te):!0}function Qm(T,R,z,re){T=R.state,typeof R.componentWillReceiveProps=="function"&&R.componentWillReceiveProps(z,re),typeof R.UNSAFE_componentWillReceiveProps=="function"&&R.UNSAFE_componentWillReceiveProps(z,re),R.state!==T&&Sh.enqueueReplaceState(R,R.state,null)}function Xu(T,R){var z=R;if("ref"in R){z={};for(var re in R)re!=="ref"&&(z[re]=R[re])}if(T=T.defaultProps){z===R&&(z=Od({},z));for(var he in T)z[he]===void 0&&(z[he]=T[he])}return z}function Tf(T,R){try{var z=T.onUncaughtError;z(R.value,{componentStack:R.stack})}catch(re){setTimeout(function(){throw re})}}function oh(T,R,z){try{var re=T.onCaughtError;re(z.value,{componentStack:z.stack,errorBoundary:R.tag===1?R.stateNode:null})}catch(he){setTimeout(function(){throw he})}}function zo(T,R,z){return z=_e(z),z.tag=3,z.payload={element:null},z.callback=function(){Tf(T,R)},z}function $l(T){return T=_e(T),T.tag=3,T}function Rd(T,R,z,re){var he=z.type.getDerivedStateFromError;if(typeof he=="function"){var Te=re.value;T.payload=function(){return he(Te)},T.callback=function(){oh(R,z,re)}}var et=z.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(T.callback=function(){oh(R,z,re),typeof he!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var yt=re.stack;this.componentDidCatch(re.value,{componentStack:yt!==null?yt:""})})}function Kp(T,R,z,re,he){if(z.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){if(R=z.alternate,R!==null&&lh(R,z,he,!0),z=ou.current,z!==null){switch(z.tag){case 13:return $s===null?ai():z.alternate===null&&Dn===0&&(Dn=3),z.flags&=-257,z.flags|=65536,z.lanes=he,re===zd?z.flags|=16384:(R=z.updateQueue,R===null?z.updateQueue=new Set([re]):R.add(re),Zc(T,re,he)),!1;case 22:return z.flags|=65536,re===zd?z.flags|=16384:(R=z.updateQueue,R===null?(R={transitions:null,markerInstances:null,retryQueue:new Set([re])},z.updateQueue=R):(z=R.retryQueue,z===null?R.retryQueue=new Set([re]):z.add(re)),Zc(T,re,he)),!1}throw Error(i(435,z.tag))}return Zc(T,re,he),ai(),!1}if(Yn)return R=ou.current,R!==null?((R.flags&65536)===0&&(R.flags|=256),R.flags|=65536,R.lanes=he,re!==is&&(T=Error(i(422),{cause:re}),pt(ae(T,z)))):(re!==is&&(R=Error(i(423),{cause:re}),pt(ae(R,z))),T=T.current.alternate,T.flags|=65536,he&=-he,T.lanes|=he,re=ae(re,z),he=zo(T.stateNode,re,he),Oe(T,he),Dn!==4&&(Dn=2)),!1;var Te=Error(i(520),{cause:re});if(Te=ae(Te,z),Fi===null?Fi=[Te]:Fi.push(Te),Dn!==4&&(Dn=2),R===null)return!0;re=ae(re,z),z=R;do{switch(z.tag){case 3:return z.flags|=65536,T=he&-he,z.lanes|=T,T=zo(z.stateNode,re,T),Oe(z,T),!1;case 1:if(R=z.type,Te=z.stateNode,(z.flags&128)===0&&(typeof R.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(ea===null||!ea.has(Te))))return z.flags|=65536,he&=-he,z.lanes|=he,he=$l(he),Rd(he,T,z,re),Oe(z,he),!1}z=z.return}while(z!==null);return!1}function sl(T,R,z,re){R.child=T===null?uf(R,null,z,re):yh(R,T.child,z,re)}function eg(T,R,z,re,he){z=z.render;var Te=R.ref;if("ref"in re){var et={};for(var yt in re)yt!=="ref"&&(et[yt]=re[yt])}else et=re;return Oc(R),re=gi(T,R,z,et,Te,he),yt=Rs(),T!==null&&!ya?(ra(T,R,he),Zn(T,R,he)):(Yn&&yt&&ne(R),R.flags|=1,sl(T,R,re,he),R.child)}function G_(T,R,z,re,he){if(T===null){var Te=z.type;return typeof Te=="function"&&!Md(Te)&&Te.defaultProps===void 0&&z.compare===null?(R.tag=15,R.type=Te,$_(T,R,Te,re,he)):(T=Qu(z.type,null,re,R,R.mode,he),T.ref=R.ref,T.return=R,R.child=T)}if(Te=T.child,!Ci(T,he)){var et=Te.memoizedProps;if(z=z.compare,z=z!==null?z:Ze,z(et,re)&&T.ref===R.ref)return Zn(T,R,he)}return R.flags|=1,T=Co(Te,re),T.ref=R.ref,T.return=R,R.child=T}function $_(T,R,z,re,he){if(T!==null){var Te=T.memoizedProps;if(Ze(Te,re)&&T.ref===R.ref)if(ya=!1,R.pendingProps=re=Te,Ci(T,he))(T.flags&131072)!==0&&(ya=!0);else return R.lanes=T.lanes,Zn(T,R,he)}return Ku(T,R,z,re,he)}function lp(T,R,z){var re=R.pendingProps,he=re.children,Te=(R.stateNode._pendingVisibility&2)!==0,et=T!==null?T.memoizedState:null;if(Hh(T,R),re.mode==="hidden"||Te){if((R.flags&128)!==0){if(re=et!==null?et.baseLanes|z:z,T!==null){for(he=R.child=T.child,Te=0;he!==null;)Te=Te|he.lanes|he.childLanes,he=he.sibling;R.childLanes=Te&~re}else R.childLanes=0,R.child=null;return jh(T,R,re,z)}if((z&536870912)!==0)R.memoizedState={baseLanes:0,cachePool:null},T!==null&&Wl(R,et!==null?et.cachePool:null),et!==null?Bt(R,et):Yt(),Bn(R);else return R.lanes=R.childLanes=536870912,jh(T,R,et!==null?et.baseLanes|z:z,z)}else et!==null?(Wl(R,et.cachePool),Bt(R,et),cn(),R.memoizedState=null):(T!==null&&Wl(R,null),Yt(),cn());return sl(T,R,he,z),R.child}function jh(T,R,z,re){var he=Q0();return he=he===null?null:{parent:fl?te._currentValue:te._currentValue2,pool:he},R.memoizedState={baseLanes:z,cachePool:he},T!==null&&Wl(R,null),Yt(),Bn(R),T!==null&&lh(T,R,re,!0),null}function Hh(T,R){var z=R.ref;if(z===null)T!==null&&T.ref!==null&&(R.flags|=2097664);else{if(typeof z!="function"&&typeof z!="object")throw Error(i(284));(T===null||T.ref!==z)&&(R.flags|=2097664)}}function Ku(T,R,z,re,he){return Oc(R),z=gi(T,R,z,re,void 0,he),re=Rs(),T!==null&&!ya?(ra(T,R,he),Zn(T,R,he)):(Yn&&re&&ne(R),R.flags|=1,sl(T,R,z,he),R.child)}function Zu(T,R,z,re,he,Te){return Oc(R),R.updateQueue=null,z=Fs(R,re,z,he),Ni(T),re=Rs(),T!==null&&!ya?(ra(T,R,Te),Zn(T,R,Te)):(Yn&&re&&ne(R),R.flags|=1,sl(T,R,z,Te),R.child)}function tg(T,R,z,re,he){if(Oc(R),R.stateNode===null){var Te=Bf,et=z.contextType;typeof et=="object"&&et!==null&&(Te=Ia(et)),Te=new z(re,Te),R.memoizedState=Te.state!==null&&Te.state!==void 0?Te.state:null,Te.updater=Sh,R.stateNode=Te,Te._reactInternals=R,Te=R.stateNode,Te.props=re,Te.state=R.memoizedState,Te.refs={},ge(R),et=z.contextType,Te.context=typeof et=="object"&&et!==null?Ia(et):Bf,Te.state=R.memoizedState,et=z.getDerivedStateFromProps,typeof et=="function"&&(sh(R,z,et,re),Te.state=R.memoizedState),typeof z.getDerivedStateFromProps=="function"||typeof Te.getSnapshotBeforeUpdate=="function"||typeof Te.UNSAFE_componentWillMount!="function"&&typeof Te.componentWillMount!="function"||(et=Te.state,typeof Te.componentWillMount=="function"&&Te.componentWillMount(),typeof Te.UNSAFE_componentWillMount=="function"&&Te.UNSAFE_componentWillMount(),et!==Te.state&&Sh.enqueueReplaceState(Te,Te.state,null),st(R,re,Te,he),we(),Te.state=R.memoizedState),typeof Te.componentDidMount=="function"&&(R.flags|=4194308),re=!0}else if(T===null){Te=R.stateNode;var yt=R.memoizedProps,zt=Xu(z,yt);Te.props=zt;var mn=Te.context,Ln=z.contextType;et=Bf,typeof Ln=="object"&&Ln!==null&&(et=Ia(Ln));var Qn=z.getDerivedStateFromProps;Ln=typeof Qn=="function"||typeof Te.getSnapshotBeforeUpdate=="function",yt=R.pendingProps!==yt,Ln||typeof Te.UNSAFE_componentWillReceiveProps!="function"&&typeof Te.componentWillReceiveProps!="function"||(yt||mn!==et)&&Qm(R,Te,re,et),ao=!1;var nr=R.memoizedState;Te.state=nr,st(R,re,Te,he),we(),mn=R.memoizedState,yt||nr!==mn||ao?(typeof Qn=="function"&&(sh(R,z,Qn,re),mn=R.memoizedState),(zt=ao||ah(R,z,zt,re,nr,mn,et))?(Ln||typeof Te.UNSAFE_componentWillMount!="function"&&typeof Te.componentWillMount!="function"||(typeof Te.componentWillMount=="function"&&Te.componentWillMount(),typeof Te.UNSAFE_componentWillMount=="function"&&Te.UNSAFE_componentWillMount()),typeof Te.componentDidMount=="function"&&(R.flags|=4194308)):(typeof Te.componentDidMount=="function"&&(R.flags|=4194308),R.memoizedProps=re,R.memoizedState=mn),Te.props=re,Te.state=mn,Te.context=et,re=zt):(typeof Te.componentDidMount=="function"&&(R.flags|=4194308),re=!1)}else{Te=R.stateNode,se(T,R),et=R.memoizedProps,Ln=Xu(z,et),Te.props=Ln,Qn=R.pendingProps,nr=Te.context,mn=z.contextType,zt=Bf,typeof mn=="object"&&mn!==null&&(zt=Ia(mn)),yt=z.getDerivedStateFromProps,(mn=typeof yt=="function"||typeof Te.getSnapshotBeforeUpdate=="function")||typeof Te.UNSAFE_componentWillReceiveProps!="function"&&typeof Te.componentWillReceiveProps!="function"||(et!==Qn||nr!==zt)&&Qm(R,Te,re,zt),ao=!1,nr=R.memoizedState,Te.state=nr,st(R,re,Te,he),we();var Xr=R.memoizedState;et!==Qn||nr!==Xr||ao||T!==null&&T.dependencies!==null&&sr(T.dependencies)?(typeof yt=="function"&&(sh(R,z,yt,re),Xr=R.memoizedState),(Ln=ao||ah(R,z,Ln,re,nr,Xr,zt)||T!==null&&T.dependencies!==null&&sr(T.dependencies))?(mn||typeof Te.UNSAFE_componentWillUpdate!="function"&&typeof Te.componentWillUpdate!="function"||(typeof Te.componentWillUpdate=="function"&&Te.componentWillUpdate(re,Xr,zt),typeof Te.UNSAFE_componentWillUpdate=="function"&&Te.UNSAFE_componentWillUpdate(re,Xr,zt)),typeof Te.componentDidUpdate=="function"&&(R.flags|=4),typeof Te.getSnapshotBeforeUpdate=="function"&&(R.flags|=1024)):(typeof Te.componentDidUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=4),typeof Te.getSnapshotBeforeUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=1024),R.memoizedProps=re,R.memoizedState=Xr),Te.props=re,Te.state=Xr,Te.context=zt,re=Ln):(typeof Te.componentDidUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=4),typeof Te.getSnapshotBeforeUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=1024),re=!1)}return Te=re,Hh(T,R),re=(R.flags&128)!==0,Te||re?(Te=R.stateNode,z=re&&typeof z.getDerivedStateFromError!="function"?null:Te.render(),R.flags|=1,T!==null&&re?(R.child=yh(R,T.child,null,he),R.child=yh(R,null,z,he)):sl(T,R,z,he),R.memoizedState=Te.state,T=R.child):T=Zn(T,R,he),T}function ys(T,R,z,re){return at(),R.flags|=256,sl(T,R,z,re),R.child}function wa(T){return{baseLanes:T,cachePool:rg()}}function cp(T,R,z){return T=T!==null?T.childLanes&~z:0,R&&(T|=oi),T}function ng(T,R,z){var re=R.pendingProps,he=!1,Te=(R.flags&128)!==0,et;if((et=Te)||(et=T!==null&&T.memoizedState===null?!1:(Io.current&2)!==0),et&&(he=!0,R.flags&=-129),et=(R.flags&32)!==0,R.flags&=-33,T===null){if(Yn){if(he?fn(R):cn(),Yn){var yt=fr,zt;(zt=yt)&&(yt=o0(yt,Wr),yt!==null?(R.memoizedState={dehydrated:yt,treeContext:cf!==null?{id:Gs,overflow:Os}:null,retryLane:536870912},zt=t(18,null,null,0),zt.stateNode=yt,zt.return=R,R.child=zt,mr=R,fr=null,zt=!0):zt=!1),zt||Ne(R)}if(yt=R.memoizedState,yt!==null&&(yt=yt.dehydrated,yt!==null))return fg(yt)?R.lanes=16:R.lanes=536870912,null;In(R)}return yt=re.children,re=re.fallback,he?(cn(),he=R.mode,yt=rt({mode:"hidden",children:yt},he),re=Pa(re,he,z,null),yt.return=R,re.return=R,yt.sibling=re,R.child=yt,he=R.child,he.memoizedState=wa(z),he.childLanes=cp(T,et,z),R.memoizedState=jf,re):(fn(R),qh(R,yt))}if(zt=T.memoizedState,zt!==null&&(yt=zt.dehydrated,yt!==null)){if(Te)R.flags&256?(fn(R),R.flags&=-257,R=Tt(T,R,z)):R.memoizedState!==null?(cn(),R.child=T.child,R.flags|=128,R=null):(cn(),he=re.fallback,yt=R.mode,re=rt({mode:"visible",children:re.children},yt),he=Pa(he,yt,z,null),he.flags|=2,re.return=R,he.return=R,re.sibling=he,R.child=re,yh(R,T.child,null,z),re=R.child,re.memoizedState=wa(z),re.childLanes=cp(T,et,z),R.memoizedState=jf,R=he);else if(fn(R),fg(yt))et=i0(yt).digest,re=Error(i(419)),re.stack="",re.digest=et,pt({value:re,source:null,stack:null}),R=Tt(T,R,z);else if(ya||lh(T,R,z,!1),et=(z&T.childLanes)!==0,ya||et){if(et=It,et!==null){if(re=z&-z,(re&42)!==0)re=1;else switch(re){case 2:re=1;break;case 8:re=4;break;case 32:re=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:re=64;break;case 268435456:re=134217728;break;default:re=0}if(re=(re&(et.suspendedLanes|z))!==0?0:re,re!==0&&re!==zt.retryLane)throw zt.retryLane=re,ze(T,re),Ro(et,T,re),hm}lm(yt)||ai(),R=Tt(T,R,z)}else lm(yt)?(R.flags|=128,R.child=T.child,R=Jc.bind(null,T),s0(yt,R),R=null):(T=zt.treeContext,qo&&(fr=ec(yt),mr=R,Yn=!0,Ya=null,Wr=!1,T!==null&&(Gi[Wa++]=Gs,Gi[Wa++]=Os,Gi[Wa++]=cf,Gs=T.id,Os=T.overflow,cf=R)),R=qh(R,re.children),R.flags|=4096);return R}return he?(cn(),he=re.fallback,yt=R.mode,zt=T.child,Te=zt.sibling,re=Co(zt,{mode:"hidden",children:re.children}),re.subtreeFlags=zt.subtreeFlags&31457280,Te!==null?he=Co(Te,he):(he=Pa(he,yt,z,null),he.flags|=2),he.return=R,re.return=R,re.sibling=he,R.child=re,re=he,he=R.child,yt=T.child.memoizedState,yt===null?yt=wa(z):(zt=yt.cachePool,zt!==null?(Te=fl?te._currentValue:te._currentValue2,zt=zt.parent!==Te?{parent:Te,pool:Te}:zt):zt=rg(),yt={baseLanes:yt.baseLanes|z,cachePool:zt}),he.memoizedState=yt,he.childLanes=cp(T,et,z),R.memoizedState=jf,re):(fn(R),z=T.child,T=z.sibling,z=Co(z,{mode:"visible",children:re.children}),z.return=R,z.sibling=null,T!==null&&(et=R.deletions,et===null?(R.deletions=[T],R.flags|=16):et.push(T)),R.child=z,R.memoizedState=null,z)}function qh(T,R){return R=rt({mode:"visible",children:R},T.mode),R.return=T,T.child=R}function rt(T,R){return Kh(T,R,0,null)}function Tt(T,R,z){return yh(R,T.child,null,z),T=qh(R,R.pendingProps.children),T.flags|=2,R.memoizedState=null,T}function Rt(T,R,z){T.lanes|=R;var re=T.alternate;re!==null&&(re.lanes|=R),rs(T.return,R,z)}function tn(T,R,z,re,he){var Te=T.memoizedState;Te===null?T.memoizedState={isBackwards:R,rendering:null,renderingStartTime:0,last:re,tail:z,tailMode:he}:(Te.isBackwards=R,Te.rendering=null,Te.renderingStartTime=0,Te.last=re,Te.tail=z,Te.tailMode=he)}function wn(T,R,z){var re=R.pendingProps,he=re.revealOrder,Te=re.tail;if(sl(T,R,re.children,z),re=Io.current,(re&2)!==0)re=re&1|2,R.flags|=128;else{if(T!==null&&(T.flags&128)!==0)e:for(T=R.child;T!==null;){if(T.tag===13)T.memoizedState!==null&&Rt(T,z,R);else if(T.tag===19)Rt(T,z,R);else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===R)break e;for(;T.sibling===null;){if(T.return===null||T.return===R)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}re&=1}switch(x(Io,re),he){case"forwards":for(z=R.child,he=null;z!==null;)T=z.alternate,T!==null&&Wn(T)===null&&(he=z),z=z.sibling;z=he,z===null?(he=R.child,R.child=null):(he=z.sibling,z.sibling=null),tn(R,!1,he,z,Te);break;case"backwards":for(z=null,he=R.child,R.child=null;he!==null;){if(T=he.alternate,T!==null&&Wn(T)===null){R.child=he;break}T=he.sibling,he.sibling=z,z=he,he=T}tn(R,!0,z,null,Te);break;case"together":tn(R,!1,null,null,void 0);break;default:R.memoizedState=null}return R.child}function Zn(T,R,z){if(T!==null&&(R.dependencies=T.dependencies),gr|=R.lanes,(z&R.childLanes)===0)if(T!==null){if(lh(T,R,z,!1),(z&R.childLanes)===0)return null}else return null;if(T!==null&&R.child!==T.child)throw Error(i(153));if(R.child!==null){for(T=R.child,z=Co(T,T.pendingProps),R.child=z,z.return=R;T.sibling!==null;)T=T.sibling,z=z.sibling=Co(T,T.pendingProps),z.return=R;z.sibling=null}return R.child}function Ci(T,R){return(T.lanes&R)!==0?!0:(T=T.dependencies,!!(T!==null&&sr(T)))}function al(T,R,z){switch(R.tag){case 3:ce(R,R.stateNode.containerInfo),Eo(R,te,T.memoizedState.cache),at();break;case 27:case 5:Me(R);break;case 4:ce(R,R.stateNode.containerInfo);break;case 10:Eo(R,R.type,R.memoizedProps.value);break;case 13:var re=R.memoizedState;if(re!==null)return re.dehydrated!==null?(fn(R),R.flags|=128,null):(z&R.child.childLanes)!==0?ng(T,R,z):(fn(R),T=Zn(T,R,z),T!==null?T.sibling:null);fn(R);break;case 19:var he=(T.flags&128)!==0;if(re=(z&R.childLanes)!==0,re||(lh(T,R,z,!1),re=(z&R.childLanes)!==0),he){if(re)return wn(T,R,z);R.flags|=128}if(he=R.memoizedState,he!==null&&(he.rendering=null,he.tail=null,he.lastEffect=null),x(Io,Io.current),re)break;return null;case 22:case 23:return R.lanes=0,lp(T,R,z);case 24:Eo(R,te,T.memoizedState.cache)}return Zn(T,R,z)}function _r(T,R,z){if(T!==null)if(T.memoizedProps!==R.pendingProps)ya=!0;else{if(!Ci(T,z)&&(R.flags&128)===0)return ya=!1,al(T,R,z);ya=(T.flags&131072)!==0}else ya=!1,Yn&&(R.flags&1048576)!==0&&K(R,ru,R.index);switch(R.lanes=0,R.tag){case 16:e:{T=R.pendingProps;var re=R.elementType,he=re._init;if(re=he(re._payload),R.type=re,typeof re=="function")Md(re)?(T=Xu(re,T),R.tag=1,R=tg(null,R,re,T,z)):(R.tag=0,R=Ku(null,R,re,T,z));else{if(re!=null){if(he=re.$$typeof,he===tf){R.tag=11,R=eg(null,R,re,T,z);break e}else if(he===Cu){R.tag=14,R=G_(null,R,re,T,z);break e}}throw R=a(re)||re,Error(i(306,R,""))}}return R;case 0:return Ku(T,R,R.type,R.pendingProps,z);case 1:return re=R.type,he=Xu(re,R.pendingProps),tg(T,R,re,he,z);case 3:e:{if(ce(R,R.stateNode.containerInfo),T===null)throw Error(i(387));var Te=R.pendingProps;he=R.memoizedState,re=he.element,se(T,R),st(R,Te,null,z);var et=R.memoizedState;if(Te=et.cache,Eo(R,te,Te),Te!==he.cache&&Mc(R,[te],z,!0),we(),Te=et.element,qo&&he.isDehydrated)if(he={element:Te,isDehydrated:!1,cache:et.cache},R.updateQueue.baseState=he,R.memoizedState=he,R.flags&256){R=ys(T,R,Te,z);break e}else if(Te!==re){re=ae(Error(i(424)),R),pt(re),R=ys(T,R,Te,z);break e}else for(qo&&(fr=Pu(R.stateNode.containerInfo),mr=R,Yn=!0,Ya=null,Wr=!0),z=uf(R,null,Te,z),R.child=z;z;)z.flags=z.flags&-3|4096,z=z.sibling;else{if(at(),Te===re){R=Zn(T,R,z);break e}sl(T,R,Te,z)}R=R.child}return R;case 26:if(tu)return Hh(T,R),T===null?(z=s_(R.type,null,R.pendingProps,null))?R.memoizedState=z:Yn||(R.stateNode=tc(R.type,R.pendingProps,vc.current,R)):R.memoizedState=s_(R.type,T.memoizedProps,R.pendingProps,T.memoizedState),null;case 27:if(Vs)return Me(R),T===null&&Vs&&Yn&&(re=R.stateNode=gc(R.type,R.pendingProps,vc.current,Di.current,!1),mr=R,Wr=!0,fr=a0(re)),re=R.pendingProps.children,T!==null||Yn?sl(T,R,re,z):R.child=yh(R,null,re,z),Hh(T,R),R.child;case 5:return T===null&&Yn&&(f0(R.type,R.pendingProps,Di.current),(he=re=fr)&&(re=hg(re,R.type,R.pendingProps,Wr),re!==null?(R.stateNode=re,mr=R,fr=a0(re),Wr=!1,he=!0):he=!1),he||Ne(R)),Me(R),he=R.type,Te=R.pendingProps,et=T!==null?T.memoizedProps:null,re=Te.children,Zr(he,Te)?re=null:et!==null&&Zr(he,et)&&(R.flags|=32),R.memoizedState!==null&&(he=gi(T,R,_i,null,null,z),fl?dr._currentValue=he:dr._currentValue2=he),Hh(T,R),sl(T,R,re,z),R.child;case 6:return T===null&&Yn&&(J_(R.pendingProps,Di.current),(T=z=fr)&&(z=dg(z,R.pendingProps,Wr),z!==null?(R.stateNode=z,mr=R,fr=null,T=!0):T=!1),T||Ne(R)),null;case 13:return ng(T,R,z);case 4:return ce(R,R.stateNode.containerInfo),re=R.pendingProps,T===null?R.child=yh(R,null,re,z):sl(T,R,re,z),R.child;case 11:return eg(T,R,R.type,R.pendingProps,z);case 7:return sl(T,R,R.pendingProps,z),R.child;case 8:return sl(T,R,R.pendingProps.children,z),R.child;case 12:return sl(T,R,R.pendingProps.children,z),R.child;case 10:return re=R.pendingProps,Eo(R,R.type,re.value),sl(T,R,re.children,z),R.child;case 9:return he=R.type._context,re=R.pendingProps.children,Oc(R),he=Ia(he),re=re(he),R.flags|=1,sl(T,R,re,z),R.child;case 14:return G_(T,R,R.type,R.pendingProps,z);case 15:return $_(T,R,R.type,R.pendingProps,z);case 19:return wn(T,R,z);case 22:return lp(T,R,z);case 24:return Oc(R),re=Ia(te),T===null?(he=Q0(),he===null&&(he=It,Te=ch(),he.pooledCache=Te,Te.refCount++,Te!==null&&(he.pooledCacheLanes|=z),he=Te),R.memoizedState={parent:re,cache:he},ge(R),Eo(R,te,he)):((T.lanes&z)!==0&&(se(T,R),st(R,null,null,z),we()),he=T.memoizedState,Te=R.memoizedState,he.parent!==re?(he={parent:re,cache:re},R.memoizedState=he,R.lanes===0&&(R.memoizedState=R.updateQueue.baseState=he),Eo(R,te,re)):(re=Te.cache,Eo(R,te,re),re!==he.cache&&Mc(R,[te],z,!0))),sl(T,R,R.pendingProps.children,z),R.child;case 29:throw R.pendingProps}throw Error(i(156,R.tag))}function Eo(T,R,z){fl?(x(Uu,R._currentValue),R._currentValue=z):(x(Uu,R._currentValue2),R._currentValue2=z)}function wf(T){var R=Uu.current;fl?T._currentValue=R:T._currentValue2=R,v(Uu)}function rs(T,R,z){for(;T!==null;){var re=T.alternate;if((T.childLanes&R)!==R?(T.childLanes|=R,re!==null&&(re.childLanes|=R)):re!==null&&(re.childLanes&R)!==R&&(re.childLanes|=R),T===z)break;T=T.return}}function Mc(T,R,z,re){var he=T.child;for(he!==null&&(he.return=T);he!==null;){var Te=he.dependencies;if(Te!==null){var et=he.child;Te=Te.firstContext;e:for(;Te!==null;){var yt=Te;Te=he;for(var zt=0;zt<R.length;zt++)if(yt.context===R[zt]){Te.lanes|=z,yt=Te.alternate,yt!==null&&(yt.lanes|=z),rs(Te.return,z,T),re||(et=null);break e}Te=yt.next}}else if(he.tag===18){if(et=he.return,et===null)throw Error(i(341));et.lanes|=z,Te=et.alternate,Te!==null&&(Te.lanes|=z),rs(et,z,T),et=null}else et=he.child;if(et!==null)et.return=he;else for(et=he;et!==null;){if(et===T){et=null;break}if(he=et.sibling,he!==null){he.return=et.return,et=he;break}et=et.return}he=et}}function lh(T,R,z,re){T=null;for(var he=R,Te=!1;he!==null;){if(!Te){if((he.flags&524288)!==0)Te=!0;else if((he.flags&262144)!==0)break}if(he.tag===10){var et=he.alternate;if(et===null)throw Error(i(387));if(et=et.memoizedProps,et!==null){var yt=he.type;Nl(he.pendingProps.value,et.value)||(T!==null?T.push(yt):T=[yt])}}else if(he===Pl.current){if(et=he.alternate,et===null)throw Error(i(387));et.memoizedState.memoizedState!==he.memoizedState.memoizedState&&(T!==null?T.push(dr):T=[dr])}he=he.return}T!==null&&Mc(R,T,z,re),R.flags|=262144}function sr(T){for(T=T.firstContext;T!==null;){var R=T.context;if(!Nl(fl?R._currentValue:R._currentValue2,T.memoizedValue))return!0;T=T.next}return!1}function Oc(T){j=T,C=null,T=T.dependencies,T!==null&&(T.firstContext=null)}function Ia(T){return Gr(j,T)}function vr(T,R){return j===null&&Oc(T),Gr(T,R)}function Gr(T,R){var z=fl?R._currentValue:R._currentValue2;if(R={context:R,memoizedValue:z,next:null},C===null){if(T===null)throw Error(i(308));C=R,T.dependencies={lanes:0,firstContext:R},T.flags|=524288}else C=C.next=R;return z}function ch(){return{controller:new P,data:new Map,refCount:0}}function Rf(T){T.refCount--,T.refCount===0&&H(X,function(){T.controller.abort()})}function Q0(){var T=Ee.current;return T!==null?T:It.pooledCache}function Wl(T,R){R===null?x(Ee,Ee.current):x(Ee,R.pool)}function rg(){var T=Q0();return T===null?null:{parent:fl?te._currentValue:te._currentValue2,pool:T}}function xo(T){T.flags|=4}function jo(T,R){if(T!==null&&T.child===R.child)return!1;if((R.flags&16)!==0)return!0;for(T=R.child;T!==null;){if((T.flags&13878)!==0||(T.subtreeFlags&13878)!==0)return!0;T=T.sibling}return!1}function xu(T,R,z,re){if(no)for(z=R.child;z!==null;){if(z.tag===5||z.tag===6)ul(T,z.stateNode);else if(!(z.tag===4||Vs&&z.tag===27)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===R)break;for(;z.sibling===null;){if(z.return===null||z.return===R)return;z=z.return}z.sibling.return=z.return,z=z.sibling}else if(pc)for(var he=R.child;he!==null;){if(he.tag===5){var Te=he.stateNode;z&&re&&(Te=om(Te,he.type,he.memoizedProps)),ul(T,Te)}else if(he.tag===6)Te=he.stateNode,z&&re&&(Te=r0(Te,he.memoizedProps)),ul(T,Te);else if(he.tag!==4){if(he.tag===22&&he.memoizedState!==null)Te=he.child,Te!==null&&(Te.return=he),xu(T,he,!0,!0);else if(he.child!==null){he.child.return=he,he=he.child;continue}}if(he===R)break;for(;he.sibling===null;){if(he.return===null||he.return===R)return;he=he.return}he.sibling.return=he.return,he=he.sibling}}function Zg(T,R,z,re){if(pc)for(var he=R.child;he!==null;){if(he.tag===5){var Te=he.stateNode;z&&re&&(Te=om(Te,he.type,he.memoizedProps)),Nu(T,Te)}else if(he.tag===6)Te=he.stateNode,z&&re&&(Te=r0(Te,he.memoizedProps)),Nu(T,Te);else if(he.tag!==4){if(he.tag===22&&he.memoizedState!==null)Te=he.child,Te!==null&&(Te.return=he),Zg(T,he,!(he.memoizedProps!==null&&he.memoizedProps.mode==="manual"),!0);else if(he.child!==null){he.child.return=he,he=he.child;continue}}if(he===R)break;for(;he.sibling===null;){if(he.return===null||he.return===R)return;he=he.return}he.sibling.return=he.return,he=he.sibling}}function Tu(T,R){if(pc&&jo(T,R)){T=R.stateNode;var z=T.containerInfo,re=Ud();Zg(re,R,!1,!1),T.pendingChildren=re,xo(R),ml(z,re)}}function uh(T,R,z,re){if(no)T.memoizedProps!==re&&xo(R);else if(pc){var he=T.stateNode,Te=T.memoizedProps;if((T=jo(T,R))||Te!==re){var et=Di.current;Te=Df(he,z,Te,re,!T,null),Te===he?R.stateNode=he:(af(Te,z,re,et)&&xo(R),R.stateNode=Te,T?xu(Te,R,!1,!1):xo(R))}else R.stateNode=he}}function Zp(T,R,z){if(hl(R,z)){if(T.flags|=16777216,!Jl(R,z))if(Gh())T.flags|=8192;else throw zf=zd,Wo}else T.flags&=-16777217}function fh(T,R){if(Ms(R)){if(T.flags|=16777216,!_h(R))if(Gh())T.flags|=8192;else throw zf=zd,Wo}else T.flags&=-16777217}function Af(T,R){R!==null&&(T.flags|=4),T.flags&16384&&(R=T.tag!==22?V():536870912,T.lanes|=R,li|=R)}function Kc(T,R){if(!Yn)switch(T.tailMode){case"hidden":R=T.tail;for(var z=null;R!==null;)R.alternate!==null&&(z=R),R=R.sibling;z===null?T.tail=null:z.sibling=null;break;case"collapsed":z=T.tail;for(var re=null;z!==null;)z.alternate!==null&&(re=z),z=z.sibling;re===null?R||T.tail===null?T.tail=null:T.tail.sibling=null:re.sibling=null}}function Vi(T){var R=T.alternate!==null&&T.alternate.child===T.child,z=0,re=0;if(R)for(var he=T.child;he!==null;)z|=he.lanes|he.childLanes,re|=he.subtreeFlags&31457280,re|=he.flags&31457280,he.return=T,he=he.sibling;else for(he=T.child;he!==null;)z|=he.lanes|he.childLanes,re|=he.subtreeFlags,re|=he.flags,he.return=T,he=he.sibling;return T.subtreeFlags|=re,T.childLanes=z,R}function wu(T,R,z){var re=R.pendingProps;switch(le(R),R.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vi(R),null;case 1:return Vi(R),null;case 3:return z=R.stateNode,re=null,T!==null&&(re=T.memoizedState.cache),R.memoizedState.cache!==re&&(R.flags|=2048),wf(te),de(),z.pendingContext&&(z.context=z.pendingContext,z.pendingContext=null),(T===null||T.child===null)&&($e(R)?xo(R):T===null||T.memoizedState.isDehydrated&&(R.flags&256)===0||(R.flags|=1024,Ya!==null&&(dh(Ya),Ya=null))),Tu(T,R),Vi(R),null;case 26:if(tu){z=R.type;var he=R.memoizedState;return T===null?(xo(R),he!==null?(Vi(R),fh(R,he)):(Vi(R),Zp(R,z,re))):he?he!==T.memoizedState?(xo(R),Vi(R),fh(R,he)):(Vi(R),R.flags&=-16777217):(no?T.memoizedProps!==re&&xo(R):uh(T,R,z,re),Vi(R),Zp(R,z,re)),null}case 27:if(Vs){if(qe(R),z=vc.current,he=R.type,T!==null&&R.stateNode!=null)no?T.memoizedProps!==re&&xo(R):uh(T,R,he,re);else{if(!re){if(R.stateNode===null)throw Error(i(166));return Vi(R),null}T=Di.current,$e(R)?Ae(R,T):(T=gc(he,re,z,T,!0),R.stateNode=T,xo(R))}return Vi(R),null}case 5:if(qe(R),z=R.type,T!==null&&R.stateNode!=null)uh(T,R,z,re);else{if(!re){if(R.stateNode===null)throw Error(i(166));return Vi(R),null}T=Di.current,$e(R)?Ae(R,T):(he=Ou(z,re,vc.current,T,R),xu(he,R,!1,!1),R.stateNode=he,af(he,z,re,T)&&xo(R))}return Vi(R),Zp(R,R.type,R.pendingProps),null;case 6:if(T&&R.stateNode!=null)z=T.memoizedProps,no?z!==re&&xo(R):pc&&(z!==re?(R.stateNode=hs(re,vc.current,Di.current,R),xo(R)):R.stateNode=T.stateNode);else{if(typeof re!="string"&&R.stateNode===null)throw Error(i(166));if(T=vc.current,z=Di.current,$e(R)){if(!qo)throw Error(i(176));if(T=R.stateNode,z=R.memoizedProps,re=null,he=mr,he!==null)switch(he.tag){case 27:case 5:re=he.memoizedProps}r_(T,z,R,re)||Ne(R)}else R.stateNode=hs(re,T,z,R)}return Vi(R),null;case 13:if(re=R.memoizedState,T===null||T.memoizedState!==null&&T.memoizedState.dehydrated!==null){if(he=$e(R),re!==null&&re.dehydrated!==null){if(T===null){if(!he)throw Error(i(318));if(!qo)throw Error(i(344));if(he=R.memoizedState,he=he!==null?he.dehydrated:null,!he)throw Error(i(317));K_(he,R)}else at(),(R.flags&128)===0&&(R.memoizedState=null),R.flags|=4;Vi(R),he=!1}else Ya!==null&&(dh(Ya),Ya=null),he=!0;if(!he)return R.flags&256?(In(R),R):(In(R),null)}if(In(R),(R.flags&128)!==0)return R.lanes=z,R;if(z=re!==null,T=T!==null&&T.memoizedState!==null,z){re=R.child,he=null,re.alternate!==null&&re.alternate.memoizedState!==null&&re.alternate.memoizedState.cachePool!==null&&(he=re.alternate.memoizedState.cachePool.pool);var Te=null;re.memoizedState!==null&&re.memoizedState.cachePool!==null&&(Te=re.memoizedState.cachePool.pool),Te!==he&&(re.flags|=2048)}return z!==T&&z&&(R.child.flags|=8192),Af(R,R.updateQueue),Vi(R),null;case 4:return de(),Tu(T,R),T===null&&La(R.stateNode.containerInfo),Vi(R),null;case 10:return wf(R.type),Vi(R),null;case 19:if(v(Io),he=R.memoizedState,he===null)return Vi(R),null;if(re=(R.flags&128)!==0,Te=he.rendering,Te===null)if(re)Kc(he,!1);else{if(Dn!==0||T!==null&&(T.flags&128)!==0)for(T=R.child;T!==null;){if(Te=Wn(T),Te!==null){for(R.flags|=128,Kc(he,!1),T=Te.updateQueue,R.updateQueue=T,Af(R,T),R.subtreeFlags=0,T=z,z=R.child;z!==null;)Xh(z,T),z=z.sibling;return x(Io,Io.current&1|2),R.child}T=T.sibling}he.tail!==null&&Sr()>Is&&(R.flags|=128,re=!0,Kc(he,!1),R.lanes=4194304)}else{if(!re)if(T=Wn(Te),T!==null){if(R.flags|=128,re=!0,T=T.updateQueue,R.updateQueue=T,Af(R,T),Kc(he,!0),he.tail===null&&he.tailMode==="hidden"&&!Te.alternate&&!Yn)return Vi(R),null}else 2*Sr()-he.renderingStartTime>Is&&z!==536870912&&(R.flags|=128,re=!0,Kc(he,!1),R.lanes=4194304);he.isBackwards?(Te.sibling=R.child,R.child=Te):(T=he.last,T!==null?T.sibling=Te:R.child=Te,he.last=Te)}return he.tail!==null?(R=he.tail,he.rendering=R,he.tail=R.sibling,he.renderingStartTime=Sr(),R.sibling=null,T=Io.current,x(Io,re?T&1|2:T&1),R):(Vi(R),null);case 22:case 23:return In(R),Mt(),re=R.memoizedState!==null,T!==null?T.memoizedState!==null!==re&&(R.flags|=8192):re&&(R.flags|=8192),re?(z&536870912)!==0&&(R.flags&128)===0&&(Vi(R),R.subtreeFlags&6&&(R.flags|=8192)):Vi(R),z=R.updateQueue,z!==null&&Af(R,z.retryQueue),z=null,T!==null&&T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),re=null,R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(re=R.memoizedState.cachePool.pool),re!==z&&(R.flags|=2048),T!==null&&v(Ee),null;case 24:return z=null,T!==null&&(z=T.memoizedState.cache),R.memoizedState.cache!==z&&(R.flags|=2048),wf(te),Vi(R),null;case 25:return null}throw Error(i(156,R.tag))}function W_(T,R){switch(le(R),R.tag){case 1:return T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 3:return wf(te),de(),T=R.flags,(T&65536)!==0&&(T&128)===0?(R.flags=T&-65537|128,R):null;case 26:case 27:case 5:return qe(R),null;case 13:if(In(R),T=R.memoizedState,T!==null&&T.dehydrated!==null){if(R.alternate===null)throw Error(i(340));at()}return T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 19:return v(Io),null;case 4:return de(),null;case 10:return wf(R.type),null;case 22:case 23:return In(R),Mt(),T!==null&&v(Ee),T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 24:return wf(te),null;case 25:return null;default:return null}}function Y_(T,R){switch(le(R),R.tag){case 3:wf(te),de();break;case 26:case 27:case 5:qe(R);break;case 4:de();break;case 13:In(R);break;case 19:v(Io);break;case 10:wf(R.type);break;case 22:case 23:In(R),Mt(),T!==null&&v(Ee);break;case 24:wf(te)}}function ig(T,R){try{var z=R.updateQueue,re=z!==null?z.lastEffect:null;if(re!==null){var he=re.next;z=he;do{if((z.tag&T)===T){re=void 0;var Te=z.create,et=z.inst;re=Te(),et.destroy=re}z=z.next}while(z!==he)}}catch(yt){Pi(R,R.return,yt)}}function kc(T,R,z){try{var re=R.updateQueue,he=re!==null?re.lastEffect:null;if(he!==null){var Te=he.next;re=Te;do{if((re.tag&T)===T){var et=re.inst,yt=et.destroy;if(yt!==void 0){et.destroy=void 0,he=R;var zt=z;try{yt()}catch(mn){Pi(he,zt,mn)}}}re=re.next}while(re!==Te)}}catch(mn){Pi(R,R.return,mn)}}function Ad(T){var R=T.updateQueue;if(R!==null){var z=T.stateNode;try{tt(R,z)}catch(re){Pi(T,T.return,re)}}}function fo(T,R,z){z.props=Xu(T.type,T.memoizedProps),z.state=T.memoizedState;try{z.componentWillUnmount()}catch(re){Pi(T,R,re)}}function Cf(T,R){try{var z=T.ref;if(z!==null){var re=T.stateNode;switch(T.tag){case 26:case 27:case 5:var he=eu(re);break;default:he=re}typeof z=="function"?T.refCleanup=z(he):z.current=he}}catch(Te){Pi(T,R,Te)}}function Yl(T,R){var z=T.ref,re=T.refCleanup;if(z!==null)if(typeof re=="function")try{re()}catch(he){Pi(T,R,he)}finally{T.refCleanup=null,T=T.alternate,T!=null&&(T.refCleanup=null)}else if(typeof z=="function")try{z(null)}catch(he){Pi(T,R,he)}else z.current=null}function sg(T){var R=T.type,z=T.memoizedProps,re=T.stateNode;try{nm(re,R,z,T)}catch(he){Pi(T,T.return,he)}}function Jg(T,R,z){try{Va(T.stateNode,T.type,z,R,T)}catch(re){Pi(T,T.return,re)}}function vi(T){return T.tag===5||T.tag===3||(tu?T.tag===26:!1)||(Vs?T.tag===27:!1)||T.tag===4}function Ki(T){e:for(;;){for(;T.sibling===null;){if(T.return===null||vi(T.return))return null;T=T.return}for(T.sibling.return=T.return,T=T.sibling;T.tag!==5&&T.tag!==6&&(!Vs||T.tag!==27)&&T.tag!==18;){if(T.flags&2||T.child===null||T.tag===4)continue e;T.child.return=T,T=T.child}if(!(T.flags&2))return T.stateNode}}function ag(T,R,z){var re=T.tag;if(re===5||re===6)T=T.stateNode,R?n0(z,T,R):Pd(z,T);else if(!(re===4||Vs&&re===27)&&(T=T.child,T!==null))for(ag(T,R,z),T=T.sibling;T!==null;)ag(T,R,z),T=T.sibling}function hh(T,R,z){var re=T.tag;if(re===5||re===6)T=T.stateNode,R?rm(z,T,R):Go(z,T);else if(!(re===4||Vs&&re===27)&&(T=T.child,T!==null))for(hh(T,R,z),T=T.sibling;T!==null;)hh(T,R,z),T=T.sibling}function up(T,R,z){T=T.containerInfo;try{Bc(T,z)}catch(re){Pi(R,R.return,re)}}function Fn(T,R){for(tm(T.containerInfo),F=R;F!==null;)if(T=F,R=T.child,(T.subtreeFlags&1028)!==0&&R!==null)R.return=T,F=R;else for(;F!==null;){T=F;var z=T.alternate;switch(R=T.flags,T.tag){case 0:break;case 11:case 15:break;case 1:if((R&1024)!==0&&z!==null){R=void 0;var re=T,he=z.memoizedProps;z=z.memoizedState;var Te=re.stateNode;try{var et=Xu(re.type,he,re.elementType===re.type);R=Te.getSnapshotBeforeUpdate(et,z),Te.__reactInternalSnapshotBeforeUpdate=R}catch(yt){Pi(re,re.return,yt)}}break;case 3:(R&1024)!==0&&no&&am(T.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((R&1024)!==0)throw Error(i(163))}if(R=T.sibling,R!==null){R.return=T.return,F=R;break}F=T.return}return et=ie,ie=!1,et}function js(T,R,z){var re=z.flags;switch(z.tag){case 0:case 11:case 15:Al(T,z),re&4&&ig(5,z);break;case 1:if(Al(T,z),re&4)if(T=z.stateNode,R===null)try{T.componentDidMount()}catch(yt){Pi(z,z.return,yt)}else{var he=Xu(z.type,R.memoizedProps);R=R.memoizedState;try{T.componentDidUpdate(he,R,T.__reactInternalSnapshotBeforeUpdate)}catch(yt){Pi(z,z.return,yt)}}re&64&&Ad(z),re&512&&Cf(z,z.return);break;case 3:if(Al(T,z),re&64&&(re=z.updateQueue,re!==null)){if(T=null,z.child!==null)switch(z.child.tag){case 27:case 5:T=eu(z.child.stateNode);break;case 1:T=z.child.stateNode}try{tt(re,T)}catch(yt){Pi(z,z.return,yt)}}break;case 26:if(tu){Al(T,z),re&512&&Cf(z,z.return);break}case 27:case 5:Al(T,z),R===null&&re&4&&sg(z),re&512&&Cf(z,z.return);break;case 12:Al(T,z);break;case 13:Al(T,z),re&4&&Ju(T,z);break;case 22:if(he=z.memoizedState!==null||w,!he){R=R!==null&&R.memoizedState!==null||d;var Te=w,et=d;w=he,(d=R)&&!et?Ho(T,z,(z.subtreeFlags&8772)!==0):Al(T,z),w=Te,d=et}re&512&&(z.memoizedProps.mode==="manual"?Cf(z,z.return):Yl(z,z.return));break;default:Al(T,z)}}function Mf(T){var R=T.alternate;R!==null&&(T.alternate=null,Mf(R)),T.child=null,T.deletions=null,T.sibling=null,T.tag===5&&(R=T.stateNode,R!==null&&gp(R)),T.stateNode=null,T.return=null,T.dependencies=null,T.memoizedProps=null,T.memoizedState=null,T.pendingProps=null,T.stateNode=null,T.updateQueue=null}function To(T,R,z){for(z=z.child;z!==null;)Rl(T,R,z),z=z.sibling}function Rl(T,R,z){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(bs,z)}catch{}switch(z.tag){case 26:if(tu){d||Yl(z,R),To(T,R,z),z.memoizedState?bp(z.memoizedState):z.stateNode&&gh(z.stateNode);break}case 27:if(Vs){d||Yl(z,R);var re=pe,he=ye;pe=z.stateNode,To(T,R,z),Uf(z.stateNode),pe=re,ye=he;break}case 5:d||Yl(z,R);case 6:if(no){if(re=pe,he=ye,pe=null,To(T,R,z),pe=re,ye=he,pe!==null)if(ye)try{sm(pe,z.stateNode)}catch(Te){Pi(z,R,Te)}else try{im(pe,z.stateNode)}catch(Te){Pi(z,R,Te)}}else To(T,R,z);break;case 18:no&&pe!==null&&(ye?pg(pe,z.stateNode):Z_(pe,z.stateNode));break;case 4:no?(re=pe,he=ye,pe=z.stateNode.containerInfo,ye=!0,To(T,R,z),pe=re,ye=he):(pc&&up(z.stateNode,z,Ud()),To(T,R,z));break;case 0:case 11:case 14:case 15:d||kc(2,z,R),d||kc(4,z,R),To(T,R,z);break;case 1:d||(Yl(z,R),re=z.stateNode,typeof re.componentWillUnmount=="function"&&fo(z,R,re)),To(T,R,z);break;case 21:To(T,R,z);break;case 22:d||Yl(z,R),d=(re=d)||z.memoizedState!==null,To(T,R,z),d=re;break;default:To(T,R,z)}}function Ju(T,R){if(qo&&R.memoizedState===null&&(T=R.alternate,T!==null&&(T=T.memoizedState,T!==null&&(T=T.dehydrated,T!==null))))try{i_(T)}catch(z){Pi(R,R.return,z)}}function Of(T){switch(T.tag){case 13:case 19:var R=T.stateNode;return R===null&&(R=T.stateNode=new O),R;case 22:return T=T.stateNode,R=T._retryCache,R===null&&(R=T._retryCache=new O),R;default:throw Error(i(435,T.tag))}}function Ic(T,R){var z=Of(T);R.forEach(function(re){var he=ph.bind(null,T,re);z.has(re)||(z.add(re),re.then(he,he))})}function As(T,R){var z=R.deletions;if(z!==null)for(var re=0;re<z.length;re++){var he=z[re],Te=T,et=R;if(no){var yt=et;e:for(;yt!==null;){switch(yt.tag){case 27:case 5:pe=yt.stateNode,ye=!1;break e;case 3:pe=yt.stateNode.containerInfo,ye=!0;break e;case 4:pe=yt.stateNode.containerInfo,ye=!0;break e}yt=yt.return}if(pe===null)throw Error(i(160));Rl(Te,et,he),pe=null,ye=!1}else Rl(Te,et,he);Te=he.alternate,Te!==null&&(Te.return=null),he.return=null}if(R.subtreeFlags&13878)for(R=R.child;R!==null;)Qg(R,T),R=R.sibling}function Qg(T,R){var z=T.alternate,re=T.flags;switch(T.tag){case 0:case 11:case 14:case 15:As(R,T),Ks(T),re&4&&(kc(3,T,T.return),ig(3,T),kc(5,T,T.return));break;case 1:As(R,T),Ks(T),re&512&&(d||z===null||Yl(z,z.return)),re&64&&w&&(T=T.updateQueue,T!==null&&(re=T.callbacks,re!==null&&(z=T.shared.hiddenCallbacks,T.shared.hiddenCallbacks=z===null?re:z.concat(re))));break;case 26:if(tu){var he=Re;As(R,T),Ks(T),re&512&&(d||z===null||Yl(z,z.return)),re&4&&(re=z!==null?z.memoizedState:null,R=T.memoizedState,z===null?R===null?T.stateNode===null?T.stateNode=fm(he,T.type,T.memoizedProps,T):Bd(he,T.type,T.stateNode):T.stateNode=Q_(he,R,T.memoizedProps):re!==R?(re===null?z.stateNode!==null&&gh(z.stateNode):bp(re),R===null?Bd(he,T.type,T.stateNode):Q_(he,R,T.memoizedProps)):R===null&&T.stateNode!==null&&Jg(T,T.memoizedProps,z.memoizedProps));break}case 27:if(Vs&&re&4&&T.alternate===null){he=T.stateNode;var Te=T.memoizedProps;try{Lf(he),gg(T.type,Te,he,T)}catch(Ln){Pi(T,T.return,Ln)}}case 5:if(As(R,T),Ks(T),re&512&&(d||z===null||Yl(z,z.return)),no){if(T.flags&32){R=T.stateNode;try{Dd(R)}catch(Ln){Pi(T,T.return,Ln)}}re&4&&T.stateNode!=null&&(R=T.memoizedProps,Jg(T,R,z!==null?z.memoizedProps:R)),re&1024&&(b=!0)}break;case 6:if(As(R,T),Ks(T),re&4&&no){if(T.stateNode===null)throw Error(i(162));re=T.memoizedProps,z=z!==null?z.memoizedProps:re,R=T.stateNode;try{cg(R,z,re)}catch(Ln){Pi(T,T.return,Ln)}}break;case 3:if(tu?(Du(),he=Re,Re=yp(R.containerInfo),As(R,T),Re=he):As(R,T),Ks(T),re&4){if(no&&qo&&z!==null&&z.memoizedState.isDehydrated)try{u0(R.containerInfo)}catch(Ln){Pi(T,T.return,Ln)}if(pc){re=R.containerInfo,z=R.pendingChildren;try{Bc(re,z)}catch(Ln){Pi(T,T.return,Ln)}}}b&&(b=!1,e_(T));break;case 4:tu?(z=Re,Re=yp(T.stateNode.containerInfo),As(R,T),Ks(T),Re=z):(As(R,T),Ks(T)),re&4&&pc&&up(T.stateNode,T,T.stateNode.pendingChildren);break;case 12:As(R,T),Ks(T);break;case 13:As(R,T),Ks(T),T.child.flags&8192&&T.memoizedState!==null!=(z!==null&&z.memoizedState!==null)&&(ci=Sr()),re&4&&(re=T.updateQueue,re!==null&&(T.updateQueue=null,Ic(T,re)));break;case 22:re&512&&(d||z===null||Yl(z,z.return)),he=T.memoizedState!==null;var et=z!==null&&z.memoizedState!==null,yt=w,zt=d;if(w=yt||he,d=zt||et,As(R,T),d=zt,w=yt,Ks(T),R=T.stateNode,R._current=T,R._visibility&=-3,R._visibility|=R._pendingVisibility&2,re&8192&&(R._visibility=he?R._visibility&-2:R._visibility|1,he&&(R=w||d,z===null||et||R||fp(T)),no&&(T.memoizedProps===null||T.memoizedProps.mode!=="manual"))){e:if(z=null,no)for(R=T;;){if(R.tag===5||tu&&R.tag===26||Vs&&R.tag===27){if(z===null){et=z=R;try{Te=et.stateNode,he?Ld(Te):ug(et.stateNode,et.memoizedProps)}catch(Ln){Pi(et,et.return,Ln)}}}else if(R.tag===6){if(z===null){et=R;try{var mn=et.stateNode;he?Iu(mn):t_(mn,et.memoizedProps)}catch(Ln){Pi(et,et.return,Ln)}}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===T)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===T)break e;for(;R.sibling===null;){if(R.return===null||R.return===T)break e;z===R&&(z=null),R=R.return}z===R&&(z=null),R.sibling.return=R.return,R=R.sibling}}re&4&&(re=T.updateQueue,re!==null&&(z=re.retryQueue,z!==null&&(re.retryQueue=null,Ic(T,z))));break;case 19:As(R,T),Ks(T),re&4&&(re=T.updateQueue,re!==null&&(T.updateQueue=null,Ic(T,re)));break;case 21:break;default:As(R,T),Ks(T)}}function Ks(T){var R=T.flags;if(R&2){try{if(no&&(!Vs||T.tag!==27)){e:{for(var z=T.return;z!==null;){if(vi(z)){var re=z;break e}z=z.return}throw Error(i(160))}switch(re.tag){case 27:if(Vs){var he=re.stateNode,Te=Ki(T);hh(T,Te,he);break}case 5:var et=re.stateNode;re.flags&32&&(Dd(et),re.flags&=-33);var yt=Ki(T);hh(T,yt,et);break;case 3:case 4:var zt=re.stateNode.containerInfo,mn=Ki(T);ag(T,mn,zt);break;default:throw Error(i(161))}}}catch(Ln){Pi(T,T.return,Ln)}T.flags&=-3}R&4096&&(T.flags&=-4097)}function e_(T){if(T.subtreeFlags&1024)for(T=T.child;T!==null;){var R=T;e_(R),R.tag===5&&R.flags&1024&&br(R.stateNode),T=T.sibling}}function Al(T,R){if(R.subtreeFlags&8772)for(R=R.child;R!==null;)js(T,R.alternate,R),R=R.sibling}function fp(T){for(T=T.child;T!==null;){var R=T;switch(R.tag){case 0:case 11:case 14:case 15:kc(4,R,R.return),fp(R);break;case 1:Yl(R,R.return);var z=R.stateNode;typeof z.componentWillUnmount=="function"&&fo(R,R.return,z),fp(R);break;case 26:case 27:case 5:Yl(R,R.return),fp(R);break;case 22:Yl(R,R.return),R.memoizedState===null&&fp(R);break;default:fp(R)}T=T.sibling}}function Ho(T,R,z){for(z=z&&(R.subtreeFlags&8772)!==0,R=R.child;R!==null;){var re=R.alternate,he=T,Te=R,et=Te.flags;switch(Te.tag){case 0:case 11:case 15:Ho(he,Te,z),ig(4,Te);break;case 1:if(Ho(he,Te,z),re=Te,he=re.stateNode,typeof he.componentDidMount=="function")try{he.componentDidMount()}catch(mn){Pi(re,re.return,mn)}if(re=Te,he=re.updateQueue,he!==null){var yt=re.stateNode;try{var zt=he.shared.hiddenCallbacks;if(zt!==null)for(he.shared.hiddenCallbacks=null,he=0;he<zt.length;he++)Ve(zt[he],yt)}catch(mn){Pi(re,re.return,mn)}}z&&et&64&&Ad(Te),Cf(Te,Te.return);break;case 26:case 27:case 5:Ho(he,Te,z),z&&re===null&&et&4&&sg(Te),Cf(Te,Te.return);break;case 12:Ho(he,Te,z);break;case 13:Ho(he,Te,z),z&&et&4&&Ju(he,Te);break;case 22:Te.memoizedState===null&&Ho(he,Te,z),Cf(Te,Te.return);break;default:Ho(he,Te,z)}R=R.sibling}}function fc(T,R){var z=null;T!==null&&T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),T=null,R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(T=R.memoizedState.cachePool.pool),T!==z&&(T!=null&&T.refCount++,z!=null&&Rf(z))}function Fr(T,R){T=null,R.alternate!==null&&(T=R.alternate.memoizedState.cache),R=R.memoizedState.cache,R!==T&&(R.refCount++,T!=null&&Rf(T))}function ve(T,R,z,re){if(R.subtreeFlags&10256)for(R=R.child;R!==null;)hc(T,R,z,re),R=R.sibling}function hc(T,R,z,re){var he=R.flags;switch(R.tag){case 0:case 11:case 15:ve(T,R,z,re),he&2048&&ig(9,R);break;case 3:ve(T,R,z,re),he&2048&&(T=null,R.alternate!==null&&(T=R.alternate.memoizedState.cache),R=R.memoizedState.cache,R!==T&&(R.refCount++,T!=null&&Rf(T)));break;case 12:if(he&2048){ve(T,R,z,re),T=R.stateNode;try{var Te=R.memoizedProps,et=Te.id,yt=Te.onPostCommit;typeof yt=="function"&&yt(et,R.alternate===null?"mount":"update",T.passiveEffectDuration,-0)}catch(zt){Pi(R,R.return,zt)}}else ve(T,R,z,re);break;case 23:break;case 22:Te=R.stateNode,R.memoizedState!==null?Te._visibility&4?ve(T,R,z,re):Mi(T,R):Te._visibility&4?ve(T,R,z,re):(Te._visibility|=4,eo(T,R,z,re,(R.subtreeFlags&10256)!==0)),he&2048&&fc(R.alternate,R);break;case 24:ve(T,R,z,re),he&2048&&Fr(R.alternate,R);break;default:ve(T,R,z,re)}}function eo(T,R,z,re,he){for(he=he&&(R.subtreeFlags&10256)!==0,R=R.child;R!==null;){var Te=T,et=R,yt=z,zt=re,mn=et.flags;switch(et.tag){case 0:case 11:case 15:eo(Te,et,yt,zt,he),ig(8,et);break;case 23:break;case 22:var Ln=et.stateNode;et.memoizedState!==null?Ln._visibility&4?eo(Te,et,yt,zt,he):Mi(Te,et):(Ln._visibility|=4,eo(Te,et,yt,zt,he)),he&&mn&2048&&fc(et.alternate,et);break;case 24:eo(Te,et,yt,zt,he),he&&mn&2048&&Fr(et.alternate,et);break;default:eo(Te,et,yt,zt,he)}R=R.sibling}}function Mi(T,R){if(R.subtreeFlags&10256)for(R=R.child;R!==null;){var z=T,re=R,he=re.flags;switch(re.tag){case 22:Mi(z,re),he&2048&&fc(re.alternate,re);break;case 24:Mi(z,re),he&2048&&Fr(re.alternate,re);break;default:Mi(z,re)}R=R.sibling}}function kn(T){if(T.subtreeFlags&Pe)for(T=T.child;T!==null;)ho(T),T=T.sibling}function ho(T){switch(T.tag){case 26:kn(T),T.flags&Pe&&(T.memoizedState!==null?a_(Re,T.memoizedState,T.memoizedProps):dl(T.type,T.memoizedProps));break;case 5:kn(T),T.flags&Pe&&dl(T.type,T.memoizedProps);break;case 3:case 4:if(tu){var R=Re;Re=yp(T.stateNode.containerInfo),kn(T),Re=R}else kn(T);break;case 22:T.memoizedState===null&&(R=T.alternate,R!==null&&R.memoizedState!==null?(R=Pe,Pe=16777216,kn(T),Pe=R):kn(T));break;default:kn(T)}}function po(T){var R=T.alternate;if(R!==null&&(T=R.child,T!==null)){R.child=null;do R=T.sibling,T.sibling=null,T=R;while(T!==null)}}function Zi(T){var R=T.deletions;if((T.flags&16)!==0){if(R!==null)for(var z=0;z<R.length;z++){var re=R[z];F=re,og(re,T)}po(T)}if(T.subtreeFlags&10256)for(T=T.child;T!==null;)hn(T),T=T.sibling}function hn(T){switch(T.tag){case 0:case 11:case 15:Zi(T),T.flags&2048&&kc(9,T,T.return);break;case 3:Zi(T);break;case 12:Zi(T);break;case 22:var R=T.stateNode;T.memoizedState!==null&&R._visibility&4&&(T.return===null||T.return.tag!==13)?(R._visibility&=-5,Ti(T)):Zi(T);break;default:Zi(T)}}function Ti(T){var R=T.deletions;if((T.flags&16)!==0){if(R!==null)for(var z=0;z<R.length;z++){var re=R[z];F=re,og(re,T)}po(T)}for(T=T.child;T!==null;){switch(R=T,R.tag){case 0:case 11:case 15:kc(8,R,R.return),Ti(R);break;case 22:z=R.stateNode,z._visibility&4&&(z._visibility&=-5,Ti(R));break;default:Ti(R)}T=T.sibling}}function og(T,R){for(;F!==null;){var z=F;switch(z.tag){case 0:case 11:case 15:kc(8,z,R);break;case 23:case 22:if(z.memoizedState!==null&&z.memoizedState.cachePool!==null){var re=z.memoizedState.cachePool.pool;re!=null&&re.refCount++}break;case 24:Rf(z.memoizedState.cache)}if(re=z.child,re!==null)re.return=z,F=re;else e:for(z=T;F!==null;){re=F;var he=re.sibling,Te=re.return;if(Mf(re),re===z){F=null;break e}if(he!==null){he.return=Te,F=he;break e}F=Te}}}function kf(T){var R=e0(T);if(R!=null){if(typeof R.memoizedProps["data-testname"]!="string")throw Error(i(364));return R}if(T=vp(T),T===null)throw Error(i(362));return T.stateNode.current}function If(T,R){var z=T.tag;switch(R.$$typeof){case Ye:if(T.type===R.value)return!0;break;case dt:e:{for(R=R.value,T=[T,0],z=0;z<T.length;){var re=T[z++],he=re.tag,Te=T[z++],et=R[Te];if(he!==5&&he!==26&&he!==27||!id(re)){for(;et!=null&&If(re,et);)Te++,et=R[Te];if(Te===R.length){R=!0;break e}else for(re=re.child;re!==null;)T.push(re,Te),re=re.sibling}}R=!1}return R;case xt:if((z===5||z===26||z===27)&&t0(T.stateNode,R.value))return!0;break;case bt:if((z===5||z===6||z===26||z===27)&&(T=pl(T),T!==null&&0<=T.indexOf(R.value)))return!0;break;case Dt:if((z===5||z===26||z===27)&&(T=T.memoizedProps["data-testname"],typeof T=="string"&&T.toLowerCase()===R.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function lg(T){switch(T.$$typeof){case Ye:return"<"+(a(T.value)||"Unknown")+">";case dt:return":has("+(lg(T)||"")+")";case xt:return'[role="'+T.value+'"]';case bt:return'"'+T.value+'"';case Dt:return'[data-testname="'+T.value+'"]';default:throw Error(i(365))}}function wo(T,R){var z=[];T=[T,0];for(var re=0;re<T.length;){var he=T[re++],Te=he.tag,et=T[re++],yt=R[et];if(Te!==5&&Te!==26&&Te!==27||!id(he)){for(;yt!=null&&If(he,yt);)et++,yt=R[et];if(et===R.length)z.push(he);else for(he=he.child;he!==null;)T.push(he,et),he=he.sibling}}return z}function Nc(T,R){if(!Ql)throw Error(i(363));T=kf(T),T=wo(T,R),R=[],T=Array.from(T);for(var z=0;z<T.length;){var re=T[z++],he=re.tag;if(he===5||he===26||he===27)id(re)||R.push(re.stateNode);else for(re=re.child;re!==null;)T.push(re),re=re.sibling}return R}function _a(){if((wt&2)!==0&&Zt!==0)return Zt&-Zt;if(Hr.T!==null){var T=Ji;return T!==0?T:Vt()}return td()}function hp(){oi===0&&(oi=(Zt&536870912)===0||Yn?D():536870912);var T=ou.current;return T!==null&&(T.flags|=32),oi}function Ro(T,R,z){(T===It&&Gt===2||T.cancelPendingCommit!==null)&&(fs(T,0),Ml(T,Zt,oi,!1)),J(T,z),((wt&2)===0||T!==It)&&(T===It&&((wt&2)===0&&(Br|=z),Dn===4&&Ml(T,Zt,oi,!1)),Se(T))}function Na(T,R,z){if((wt&6)!==0)throw Error(i(327));var re=!z&&(R&60)===0&&(R&T.expiredLanes)===0||N(T,R),he=re?Zs(T,R):$h(T,R,!0),Te=re;do{if(he===0){Rn&&!re&&Ml(T,R,0,!1);break}else if(he===6)Ml(T,R,0,!dn);else{if(z=T.current.alternate,Te&&!Hs(z)){he=$h(T,R,!1),Te=!1;continue}if(he===2){if(Te=R,T.errorRecoveryDisabledLanes&Te)var et=0;else et=T.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){R=et;e:{var yt=T;he=Fi;var zt=qo&&yt.current.memoizedState.isDehydrated;if(zt&&(fs(yt,et).flags|=256),et=$h(yt,et,!1),et!==2){if(Nn&&!zt){yt.errorRecoveryDisabledLanes|=Te,Br|=Te,he=4;break e}Te=Yr,Yr=he,Te!==null&&dh(Te)}he=et}if(Te=!1,he!==2)continue}}if(he===1){fs(T,0),Ml(T,R,0,!0);break}e:{switch(re=T,he){case 0:case 1:throw Error(i(345));case 4:if((R&4194176)===R){Ml(re,R,oi,!dn);break e}break;case 2:Yr=null;break;case 3:case 5:break;default:throw Error(i(329))}if(re.finishedWork=z,re.finishedLanes=R,(R&62914560)===R&&(Te=ci+300-Sr(),10<Te)){if(Ml(re,R,oi,!dn),k(re,0)!==0)break e;re.timeoutHandle=qa(Cl.bind(null,re,z,Yr,$i,Ss,R,oi,Br,li,dn,2,-0,0),Te);break e}Cl(re,z,Yr,$i,Ss,R,oi,Br,li,dn,0,-0,0)}}break}while(!0);Se(T)}function dh(T){Yr===null?Yr=T:Yr.push.apply(Yr,T)}function Cl(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Qn,nr){var Xr=R.subtreeFlags;if((Xr&8192||(Xr&16785408)===16785408)&&(_p(),ho(R),R=sa(),R!==null)){T.cancelPendingCommit=R(Yh.bind(null,T,z,re,he,et,yt,zt,1,Qn,nr)),Ml(T,Te,et,!mn);return}Yh(T,z,re,he,et,yt,zt,Ln,Qn,nr)}function Hs(T){for(var R=T;;){var z=R.tag;if((z===0||z===11||z===15)&&R.flags&16384&&(z=R.updateQueue,z!==null&&(z=z.stores,z!==null)))for(var re=0;re<z.length;re++){var he=z[re],Te=he.getSnapshot;he=he.value;try{if(!Nl(Te(),he))return!1}catch{return!1}}if(z=R.child,R.subtreeFlags&16384&&z!==null)z.return=R,R=z;else{if(R===T)break;for(;R.sibling===null;){if(R.return===null||R.return===T)return!0;R=R.return}R.sibling.return=R.return,R=R.sibling}}return!0}function Ml(T,R,z,re){R&=~Oi,R&=~Br,T.suspendedLanes|=R,T.pingedLanes&=~R,re&&(T.warmLanes|=R),re=T.expirationTimes;for(var he=R;0<he;){var Te=31-io(he),et=1<<Te;re[Te]=-1,he&=~et}z!==0&&$(T,z,R)}function Vh(){return(wt&6)===0?(ke(0),!1):!0}function Pc(){if(Ft!==null){if(Gt===0)var T=Ft.return;else T=Ft,C=j=null,ls(T),su=null,au=0,T=Ft;for(;T!==null;)Y_(T.alternate,T),T=T.return;Ft=null}}function fs(T,R){T.finishedWork=null,T.finishedLanes=0;var z=T.timeoutHandle;z!==ku&&(T.timeoutHandle=ku,ed(z)),z=T.cancelPendingCommit,z!==null&&(T.cancelPendingCommit=null,z()),Pc(),It=T,Ft=z=Co(T.current,null),Zt=R,Gt=0,$t=null,dn=!1,Rn=N(T,R),Nn=!1,li=oi=Oi=Br=gr=Dn=0,Yr=Fi=null,Ss=!1,(R&8)!==0&&(R|=R&32);var re=T.entangledLanes;if(re!==0)for(T=T.entanglements,re&=R;0<re;){var he=31-io(re),Te=1<<he;R|=T[he],re&=~Te}return qn=R,oe(),z}function dc(T,R){bi=null,Hr.H=ks,R===va?(R=ht(),Gt=3):R===Wo?(R=ht(),Gt=4):Gt=R===hm?8:R!==null&&typeof R=="object"&&typeof R.then=="function"?6:1,$t=R,Ft===null&&(Dn=1,Tf(T,ae(R,T.current)))}function Gh(){var T=ou.current;return T===null?!0:(Zt&4194176)===Zt?$s===null:(Zt&62914560)===Zt||(Zt&536870912)!==0?T===$s:!1}function Xl(){var T=Hr.H;return Hr.H=ks,T===null?ks:T}function Ru(){var T=Hr.A;return Hr.A=Fe,T}function ai(){Dn=4,dn||(Zt&4194176)!==Zt&&ou.current!==null||(Rn=!0),(gr&134217727)===0&&(Br&134217727)===0||It===null||Ml(It,Zt,oi,!1)}function $h(T,R,z){var re=wt;wt|=2;var he=Xl(),Te=Ru();(It!==T||Zt!==R)&&($i=null,fs(T,R)),R=!1;var et=Dn;e:do try{if(Gt!==0&&Ft!==null){var yt=Ft,zt=$t;switch(Gt){case 8:Pc(),et=6;break e;case 3:case 2:case 6:ou.current===null&&(R=!0);var mn=Gt;if(Gt=0,$t=null,Dc(T,yt,zt,mn),z&&Rn){et=0;break e}break;default:mn=Gt,Gt=0,$t=null,Dc(T,yt,zt,mn)}}Jp(),et=Dn;break}catch(Ln){dc(T,Ln)}while(!0);return R&&T.shellSuspendCounter++,C=j=null,wt=re,Hr.H=he,Hr.A=Te,Ft===null&&(It=null,Zt=0,oe()),et}function Jp(){for(;Ft!==null;)Cs(Ft)}function Zs(T,R){var z=wt;wt|=2;var re=Xl(),he=Ru();It!==T||Zt!==R?($i=null,Is=Sr()+500,fs(T,R)):Rn=N(T,R);e:do try{if(Gt!==0&&Ft!==null){R=Ft;var Te=$t;t:switch(Gt){case 1:Gt=0,$t=null,Dc(T,R,Te,1);break;case 2:if(nt(Te)){Gt=0,$t=null,ti(R);break}R=function(){Gt===2&&It===T&&(Gt=7),Se(T)},Te.then(R,R);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:nt(Te)?(Gt=0,$t=null,ti(R)):(Gt=0,$t=null,Dc(T,R,Te,7));break;case 5:var et=null;switch(Ft.tag){case 26:et=Ft.memoizedState;case 5:case 27:var yt=Ft,zt=yt.type,mn=yt.pendingProps;if(et?_h(et):Jl(zt,mn)){Gt=0,$t=null;var Ln=yt.sibling;if(Ln!==null)Ft=Ln;else{var Qn=yt.return;Qn!==null?(Ft=Qn,yi(Qn)):Ft=null}break t}}Gt=0,$t=null,Dc(T,R,Te,5);break;case 6:Gt=0,$t=null,Dc(T,R,Te,6);break;case 8:Pc(),Dn=6;break e;default:throw Error(i(462))}}Ao();break}catch(nr){dc(T,nr)}while(!0);return C=j=null,Hr.H=re,Hr.A=he,wt=z,Ft!==null?0:(It=null,Zt=0,oe(),Dn)}function Ao(){for(;Ft!==null&&!ev();)Cs(Ft)}function Cs(T){var R=_r(T.alternate,T,qn);T.memoizedProps=T.pendingProps,R===null?yi(T):Ft=R}function ti(T){var R=T,z=R.alternate;switch(R.tag){case 15:case 0:R=Zu(z,R,R.pendingProps,R.type,void 0,Zt);break;case 11:R=Zu(z,R,R.pendingProps,R.type.render,R.ref,Zt);break;case 5:ls(R);default:Y_(z,R),R=Ft=Xh(R,qn),R=_r(z,R,qn)}T.memoizedProps=T.pendingProps,R===null?yi(T):Ft=R}function Dc(T,R,z,re){C=j=null,ls(R),su=null,au=0;var he=R.return;try{if(Kp(T,he,R,z,Zt)){Dn=1,Tf(T,ae(z,T.current)),Ft=null;return}}catch(Te){if(he!==null)throw Ft=he,Te;Dn=1,Tf(T,ae(z,T.current)),Ft=null;return}R.flags&32768?(Yn||re===1?T=!0:Rn||(Zt&536870912)!==0?T=!1:(dn=T=!0,(re===2||re===3||re===6)&&(re=ou.current,re!==null&&re.tag===13&&(re.flags|=16384))),Wh(R,T)):yi(R)}function yi(T){var R=T;do{if((R.flags&32768)!==0){Wh(R,dn);return}T=R.return;var z=wu(R.alternate,R,qn);if(z!==null){Ft=z;return}if(R=R.sibling,R!==null){Ft=R;return}Ft=R=T}while(R!==null);Dn===0&&(Dn=5)}function Wh(T,R){do{var z=W_(T.alternate,T);if(z!==null){z.flags&=32767,Ft=z;return}if(z=T.return,z!==null&&(z.flags|=32768,z.subtreeFlags=0,z.deletions=null),!R&&(T=T.sibling,T!==null)){Ft=T;return}Ft=T=z}while(T!==null);Dn=6,Ft=null}function Yh(T,R,z,re,he,Te,et,yt,zt,mn){var Ln=Hr.T,Qn=ro();try{Js(2),Hr.T=null,X_(T,R,z,re,Qn,he,Te,et,yt,zt,mn)}finally{Hr.T=Ln,Js(Qn)}}function X_(T,R,z,re,he,Te,et,yt){do ol();while(ms!==null);if((wt&6)!==0)throw Error(i(327));var zt=T.finishedWork;if(re=T.finishedLanes,zt===null)return null;if(T.finishedWork=null,T.finishedLanes=0,zt===T.current)throw Error(i(177));T.callbackNode=null,T.callbackPriority=0,T.cancelPendingCommit=null;var mn=zt.lanes|zt.childLanes;if(mn|=ko,B(T,re,mn,Te,et,yt),T===It&&(Ft=It=null,Zt=0),(zt.subtreeFlags&10256)===0&&(zt.flags&10256)===0||Ns||(Ns=!0,Dl=mn,yc=z,Qc(Ui,function(){return ol(),null})),z=(zt.flags&15990)!==0,(zt.subtreeFlags&15990)!==0||z?(z=Hr.T,Hr.T=null,Te=ro(),Js(2),et=wt,wt|=4,Fn(T,zt),Qg(zt,T),Qh(T.containerInfo),T.current=zt,js(T,zt.alternate,zt),Ff(),wt=et,Js(Te),Hr.T=z):T.current=zt,Ns?(Ns=!1,ms=T,vo=re):Cd(T,mn),mn=T.pendingLanes,mn===0&&(ea=null),W(zt.stateNode),Se(T),R!==null)for(he=T.onRecoverableError,zt=0;zt<R.length;zt++)mn=R[zt],he(mn.value,{componentStack:mn.stack});return(vo&3)!==0&&ol(),mn=T.pendingLanes,(re&4194218)!==0&&(mn&42)!==0?T===Bu?cu++:(cu=0,Bu=T):cu=0,ke(0),null}function Cd(T,R){(T.pooledCacheLanes&=R)===0&&(R=T.pooledCache,R!=null&&(T.pooledCache=null,Rf(R)))}function ol(){if(ms!==null){var T=ms,R=Dl;Dl=0;var z=Q(vo),re=32>z?32:z;z=Hr.T;var he=ro();try{if(Js(re),Hr.T=null,ms===null)var Te=!1;else{re=yc,yc=null;var et=ms,yt=vo;if(ms=null,vo=0,(wt&6)!==0)throw Error(i(331));var zt=wt;if(wt|=4,hn(et.current),hc(et,et.current,yt,re),wt=zt,ke(0,!1),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(bs,et)}catch{}Te=!0}return Te}finally{Js(he),Hr.T=z,Cd(T,R)}}return!1}function Jn(T,R,z){R=ae(z,R),R=zo(T.stateNode,R,2),T=Ie(T,R,2),T!==null&&(J(T,2),Se(T))}function Pi(T,R,z){if(T.tag===3)Jn(T,T,z);else for(;R!==null;){if(R.tag===3){Jn(R,T,z);break}else if(R.tag===1){var re=R.stateNode;if(typeof R.type.getDerivedStateFromError=="function"||typeof re.componentDidCatch=="function"&&(ea===null||!ea.has(re))){T=ae(z,T),z=$l(2),re=Ie(R,z,2),re!==null&&(Rd(z,re,R,T),J(re,2),Se(re));break}}R=R.return}}function Zc(T,R,z){var re=T.pingCache;if(re===null){re=T.pingCache=new kt;var he=new Set;re.set(R,he)}else he=re.get(R),he===void 0&&(he=new Set,re.set(R,he));he.has(z)||(Nn=!0,he.add(z),T=mo.bind(null,T,R,z),R.then(T,T))}function mo(T,R,z){var re=T.pingCache;re!==null&&re.delete(R),T.pingedLanes|=T.suspendedLanes&z,T.warmLanes&=~z,It===T&&(Zt&z)===z&&(Dn===4||Dn===3&&(Zt&62914560)===Zt&&300>Sr()-ci?(wt&2)===0&&fs(T,0):Oi|=z,li===Zt&&(li=0)),Se(T)}function Nf(T,R){R===0&&(R=V()),T=ze(T,R),T!==null&&(J(T,R),Se(T))}function Jc(T){var R=T.memoizedState,z=0;R!==null&&(z=R.retryLane),Nf(T,z)}function ph(T,R){var z=0;switch(T.tag){case 13:var re=T.stateNode,he=T.memoizedState;he!==null&&(z=he.retryLane);break;case 19:re=T.stateNode;break;case 22:re=T.stateNode._retryCache;break;default:throw Error(i(314))}re!==null&&re.delete(R),Nf(T,z)}function Qc(T,R){return gl(T,R)}function Qp(T,R,z,re){this.tag=T,this.key=z,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=R,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=re,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Md(T){return T=T.prototype,!(!T||!T.isReactComponent)}function Co(T,R){var z=T.alternate;return z===null?(z=t(T.tag,R,T.key,T.mode),z.elementType=T.elementType,z.type=T.type,z.stateNode=T.stateNode,z.alternate=T,T.alternate=z):(z.pendingProps=R,z.type=T.type,z.flags=0,z.subtreeFlags=0,z.deletions=null),z.flags=T.flags&31457280,z.childLanes=T.childLanes,z.lanes=T.lanes,z.child=T.child,z.memoizedProps=T.memoizedProps,z.memoizedState=T.memoizedState,z.updateQueue=T.updateQueue,R=T.dependencies,z.dependencies=R===null?null:{lanes:R.lanes,firstContext:R.firstContext},z.sibling=T.sibling,z.index=T.index,z.ref=T.ref,z.refCleanup=T.refCleanup,z}function Xh(T,R){T.flags&=31457282;var z=T.alternate;return z===null?(T.childLanes=0,T.lanes=R,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=z.childLanes,T.lanes=z.lanes,T.child=z.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=z.memoizedProps,T.memoizedState=z.memoizedState,T.updateQueue=z.updateQueue,T.type=z.type,R=z.dependencies,T.dependencies=R===null?null:{lanes:R.lanes,firstContext:R.firstContext}),T}function Qu(T,R,z,re,he,Te){var et=0;if(re=T,typeof T=="function")Md(T)&&(et=1);else if(typeof T=="string")et=tu&&Vs?sd(T,z,Di.current)?26:lf(T)?27:5:tu?sd(T,z,Di.current)?26:5:Vs&&lf(T)?27:5;else e:switch(T){case Ha:return Pa(z.children,he,Te,R);case ia:et=8,he|=24;break;case Lc:return T=t(12,z,R,he|2),T.elementType=Lc,T.lanes=Te,T;case Uc:return T=t(13,z,R,he),T.elementType=Uc,T.lanes=Te,T;case nf:return T=t(19,z,R,he),T.elementType=nf,T.lanes=Te,T;case rf:return Kh(z,he,Te,R);default:if(typeof T=="object"&&T!==null)switch(T.$$typeof){case kd:case to:et=10;break e;case Au:et=9;break e;case tf:et=11;break e;case Cu:et=14;break e;case Mo:et=16,re=null;break e}et=29,z=Error(i(130,T===null?"null":typeof T,"")),re=null}return R=t(et,z,R,he),R.elementType=T,R.type=re,R.lanes=Te,R}function Pa(T,R,z,re){return T=t(7,T,re,R),T.lanes=z,T}function Kh(T,R,z,re){T=t(22,T,re,R),T.elementType=rf,T.lanes=z;var he={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Te=he._current;if(Te===null)throw Error(i(456));if((he._pendingVisibility&2)===0){var et=ze(Te,2);et!==null&&(he._pendingVisibility|=2,Ro(et,Te,2))}},attach:function(){var Te=he._current;if(Te===null)throw Error(i(456));if((he._pendingVisibility&2)!==0){var et=ze(Te,2);et!==null&&(he._pendingVisibility&=-3,Ro(et,Te,2))}}};return T.stateNode=he,T}function dp(T,R,z){return T=t(6,T,null,R),T.lanes=z,T}function ef(T,R,z){return R=t(4,T.children!==null?T.children:[],T.key,R),R.lanes=z,R.stateNode={containerInfo:T.containerInfo,pendingChildren:null,implementation:T.implementation},R}function mh(T,R,z,re,he,Te,et,yt){this.tag=1,this.containerInfo=T,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ku,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=G(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G(0),this.hiddenUpdates=G(null),this.identifierPrefix=re,this.onUncaughtError=he,this.onCaughtError=Te,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=yt,this.incompleteTransitions=new Map}function Ur(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Qn){return T=new mh(T,R,z,et,yt,zt,mn,Qn),R=1,Te===!0&&(R|=24),Te=t(3,null,null,R),T.current=Te,Te.stateNode=T,R=ch(),R.refCount++,T.pooledCache=R,R.refCount++,Te.memoizedState={element:re,isDehydrated:z,cache:R},ge(Te),T}function yr(T){return T?(T=Bf,T):Bf}function ll(T){var R=T._reactInternals;if(R===void 0)throw typeof T.render=="function"?Error(i(188)):(T=Object.keys(T).join(","),Error(i(268,T)));return T=g(R),T=T!==null?p(T):null,T===null?null:eu(T.stateNode)}function Kl(T,R,z,re,he,Te){he=yr(he),re.context===null?re.context=he:re.pendingContext=he,re=_e(R),re.payload={element:z},Te=Te===void 0?null:Te,Te!==null&&(re.callback=Te),z=Ie(T,re,R),z!==null&&(Ro(z,T,R),De(z,T,R))}function wi(T,R){if(T=T.memoizedState,T!==null&&T.dehydrated!==null){var z=T.retryLane;T.retryLane=z!==0&&z<R?z:R}}function pp(T,R){wi(T,R),(T=T.alternate)&&wi(T,R)}var zr={},Ol=jw(),Da=$le(),Od=Object.assign,mp=Symbol.for("react.element"),cl=Symbol.for("react.transitional.element"),Zl=Symbol.for("react.portal"),Ha=Symbol.for("react.fragment"),ia=Symbol.for("react.strict_mode"),Lc=Symbol.for("react.profiler"),kd=Symbol.for("react.provider"),Au=Symbol.for("react.consumer"),to=Symbol.for("react.context"),tf=Symbol.for("react.forward_ref"),Uc=Symbol.for("react.suspense"),nf=Symbol.for("react.suspense_list"),Cu=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),rf=Symbol.for("react.offscreen"),sf=Symbol.for("react.memo_cache_sentinel"),Oo=Symbol.iterator,em=Symbol.for("react.client.reference"),Hr=Ol.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Mu,Pf,Zh=!1,Jh=Array.isArray,kl=e.rendererVersion,qs=e.rendererPackageName,Il=e.extraDevToolsConfig,eu=e.getPublicInstance,Id=e.getRootHostContext,Nd=e.getChildHostContext,tm=e.prepareForCommit,Qh=e.resetAfterCommit,Ou=e.createInstance,ul=e.appendInitialChild,af=e.finalizeInitialChildren,Zr=e.shouldSetTextContent,hs=e.createTextInstance,qa=e.scheduleTimeout,ed=e.cancelTimeout,ku=e.noTimeout,fl=e.isPrimaryRenderer;e.warnsIfNotActing;var no=e.supportsMutation,pc=e.supportsPersistence,qo=e.supportsHydration,e0=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var La=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Js=e.setCurrentUpdatePriority,ro=e.getCurrentUpdatePriority,td=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var nd=e.shouldAttemptEagerTransition,gp=e.detachDeletedInstance;e.requestPostPaintCallback;var hl=e.maySuspendCommit,Jl=e.preloadInstance,_p=e.startSuspendingCommit,dl=e.suspendInstance,sa=e.waitForCommitToBeReady,mc=e.NotPendingTransition,dr=e.HostTransitionContext,br=e.resetFormInstance;e.bindToConsole;var rd=e.supportsMicrotasks,go=e.scheduleMicrotask,Ql=e.supportsTestSelectors,vp=e.findFiberRoot,Vo=e.getBoundingRect,pl=e.getTextContent,id=e.isHiddenSubtree,t0=e.matchAccessibilityRole,of=e.setFocusIfFocusable,Ua=e.setupIntersectionObserver,Go=e.appendChild,Pd=e.appendChildToContainer,cg=e.commitTextUpdate,nm=e.commitMount,Va=e.commitUpdate,rm=e.insertBefore,n0=e.insertInContainerBefore,im=e.removeChild,sm=e.removeChildFromContainer,Dd=e.resetTextContent,Ld=e.hideInstance,Iu=e.hideTextInstance,ug=e.unhideInstance,t_=e.unhideTextInstance,am=e.clearContainer,Df=e.cloneInstance,Ud=e.createContainerChildSet,Nu=e.appendChildToContainerChildSet,ml=e.finalizeContainerChildren,Bc=e.replaceContainerChildren,om=e.cloneHiddenInstance,r0=e.cloneHiddenTextInstance,lm=e.isSuspenseInstancePending,fg=e.isSuspenseInstanceFallback,i0=e.getSuspenseInstanceFallbackErrorDetails,s0=e.registerSuspenseInstanceRetry,cm=e.canHydrateFormStateMarker,n_=e.isFormStateMarkerMatching,um=e.getNextHydratableSibling,a0=e.getFirstHydratableChild,Pu=e.getFirstHydratableChildWithinContainer,ec=e.getFirstHydratableChildWithinSuspenseInstance,hg=e.canHydrateInstance,dg=e.canHydrateTextInstance,o0=e.canHydrateSuspenseInstance,l0=e.hydrateInstance,r_=e.hydrateTextInstance,K_=e.hydrateSuspenseInstance,c0=e.getNextHydratableInstanceAfterSuspenseInstance,u0=e.commitHydratedContainer,i_=e.commitHydratedSuspenseInstance,Z_=e.clearSuspenseBoundary,pg=e.clearSuspenseBoundaryFromContainer,mg=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var f0=e.validateHydratableInstance,J_=e.validateHydratableTextInstance,tu=e.supportsResources,sd=e.isHostHoistableType,yp=e.getHoistableRoot,s_=e.getResource,Q_=e.acquireResource,bp=e.releaseResource,fm=e.hydrateHoistable,Bd=e.mountHoistable,gh=e.unmountHoistable,tc=e.createHoistableInstance,Du=e.prepareToCommitHoistables,Ms=e.mayResourceSuspendCommit,_h=e.preloadResource,a_=e.suspendResource,Vs=e.supportsSingletons,gc=e.resolveSingletonInstance,Lf=e.clearSingleton,gg=e.acquireSingletonInstance,Uf=e.releaseSingletonInstance,lf=e.isHostSingletonType,_o=[],ad=-1,Bf={},io=Math.clz32?Math.clz32:E,$o=Math.log,_g=Math.LN2,nu=128,Fd=4194304,gl=Da.unstable_scheduleCallback,aa=Da.unstable_cancelCallback,ev=Da.unstable_shouldYield,Ff=Da.unstable_requestPaint,Sr=Da.unstable_now,Ar=Da.unstable_ImmediatePriority,_c=Da.unstable_UserBlockingPriority,Ui=Da.unstable_NormalPriority,oa=Da.unstable_IdlePriority,Ra=Da.log,Ga=Da.unstable_setDisableYieldValue,bs=null,$a=null,Nl=typeof Object.is=="function"?Object.is:Y,la=new WeakMap,qr=[],ds=0,Aa=null,ru=0,Gi=[],Wa=0,cf=null,Gs=1,Os="",Di=y(null),so=y(null),vc=y(null),Pl=y(null),mr=null,fr=null,Yn=!1,Ya=null,Wr=!1,is=Error(i(519)),Lu=[],iu=0,ko=0,od=null,ld=null,Sp=!1,ca=!1,Ep=!1,_l=0,vl=null,Fc=0,Ji=0,Jr=null,ao=!1,vh=!1,yl=Object.prototype.hasOwnProperty,va=Error(i(460)),Wo=Error(i(474)),zd={then:function(){}},zf=null,su=null,au=0,yh=_n(!0),uf=_n(!1),ua=y(null),jd=y(0),ou=y(null),$s=null,Io=y(0),cd=0,bi=null,ar=null,Bi=null,Yo=!1,ud=!1,bh=!1,vg=0,No=0,ps=null,Qs=0,nc=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},ks={readContext:Ia,use:Kt,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useLayoutEffect:er,useInsertionEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useSyncExternalStore:er,useId:er};ks.useCacheRefresh=er,ks.useMemoCache=er,ks.useHostTransitionStatus=er,ks.useFormState=er,ks.useActionState=er,ks.useOptimistic=er;var ff={readContext:Ia,use:Kt,useCallback:function(T,R){return We().memoizedState=[T,R===void 0?null:R],T},useContext:Ia,useEffect:op,useImperativeHandle:function(T,R,z){z=z!=null?z.concat([T]):null,ma(4194308,4,wl.bind(null,R,T),z)},useLayoutEffect:function(T,R){return ma(4194308,4,T,R)},useInsertionEffect:function(T,R){ma(4,2,T,R)},useMemo:function(T,R){var z=We();R=R===void 0?null:R;var re=T();if(bh){q(!0);try{T()}finally{q(!1)}}return z.memoizedState=[re,R],re},useReducer:function(T,R,z){var re=We();if(z!==void 0){var he=z(R);if(bh){q(!0);try{z(R)}finally{q(!1)}}}else he=R;return re.memoizedState=re.baseState=he,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T,lastRenderedState:he},re.queue=T,T=T.dispatch=uc.bind(null,bi,T),[re.memoizedState,T]},useRef:function(T){var R=We();return T={current:T},R.memoizedState=T},useState:function(T){T=Mr(T);var R=T.queue,z=uo.bind(null,bi,R);return R.dispatch=z,[T.memoizedState,z]},useDebugValue:Fo,useDeferredValue:function(T,R){var z=We();return Ac(z,T,R)},useTransition:function(){var T=Mr(!1);return T=Yu.bind(null,bi,T.queue,!0,!1),We().memoizedState=T,[!1,T]},useSyncExternalStore:function(T,R,z){var re=bi,he=We();if(Yn){if(z===void 0)throw Error(i(407));z=z()}else{if(z=R(),It===null)throw Error(i(349));(Zt&60)!==0||Er(re,R,z)}he.memoizedState=z;var Te={value:z,getSnapshot:R};return he.queue=Te,op(Lr.bind(null,re,Te,T),[T]),re.flags|=2048,So(9,rr.bind(null,re,Te,z,R),{destroy:void 0},null),z},useId:function(){var T=We(),R=It.identifierPrefix;if(Yn){var z=Os,re=Gs;z=(re&~(1<<32-io(re)-1)).toString(32)+z,R=":"+R+"R"+z,z=vg++,0<z&&(R+="H"+z.toString(32)),R+=":"}else z=Qs++,R=":"+R+"r"+z.toString(32)+":";return T.memoizedState=R},useCacheRefresh:function(){return We().memoizedState=Jm.bind(null,bi)}};ff.useMemoCache=Lt,ff.useHostTransitionStatus=Xi,ff.useFormState=us,ff.useActionState=us,ff.useOptimistic=function(T){var R=We();R.memoizedState=R.baseState=T;var z={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return R.queue=z,R=Xc.bind(null,bi,!0,z),z.dispatch=R,[T,R]};var hi={readContext:Ia,use:Kt,useCallback:il,useContext:Ia,useEffect:Wp,useImperativeHandle:cc,useInsertionEffect:Yp,useLayoutEffect:rh,useMemo:Xp,useReducer:zn,useRef:pa,useState:function(){return zn(yn)},useDebugValue:Fo,useDeferredValue:function(T,R){var z=At();return Wc(z,ar.memoizedState,T,R)},useTransition:function(){var T=zn(yn)[0],R=At().memoizedState;return[typeof T=="boolean"?T:Wt(T),R]},useSyncExternalStore:Nr,useId:Cc};hi.useCacheRefresh=Ef,hi.useMemoCache=Lt,hi.useHostTransitionStatus=Xi,hi.useFormState=Xn,hi.useActionState=Xn,hi.useOptimistic=function(T,R){var z=At();return si(z,ar,T,R)};var lu={readContext:Ia,use:Kt,useCallback:il,useContext:Ia,useEffect:Wp,useImperativeHandle:cc,useInsertionEffect:Yp,useLayoutEffect:rh,useMemo:Xp,useReducer:tr,useRef:pa,useState:function(){return tr(yn)},useDebugValue:Fo,useDeferredValue:function(T,R){var z=At();return ar===null?Ac(z,T,R):Wc(z,ar.memoizedState,T,R)},useTransition:function(){var T=tr(yn)[0],R=At().memoizedState;return[typeof T=="boolean"?T:Wt(T),R]},useSyncExternalStore:Nr,useId:Cc};lu.useCacheRefresh=Ef,lu.useMemoCache=Lt,lu.useHostTransitionStatus=Xi,lu.useFormState=zs,lu.useActionState=zs,lu.useOptimistic=function(T,R){var z=At();return ar!==null?si(z,ar,T,R):(z.baseState=T,[T,z.queue.dispatch])};var Sh={isMounted:function(T){return(T=T._reactInternals)?f(T)===T:!1},enqueueSetState:function(T,R,z){T=T._reactInternals;var re=_a(),he=_e(re);he.payload=R,z!=null&&(he.callback=z),R=Ie(T,he,re),R!==null&&(Ro(R,T,re),De(R,T,re))},enqueueReplaceState:function(T,R,z){T=T._reactInternals;var re=_a(),he=_e(re);he.tag=1,he.payload=R,z!=null&&(he.callback=z),R=Ie(T,he,re),R!==null&&(Ro(R,T,re),De(R,T,re))},enqueueForceUpdate:function(T,R){T=T._reactInternals;var z=_a(),re=_e(z);re.tag=2,R!=null&&(re.callback=R),R=Ie(T,re,z),R!==null&&(Ro(R,T,z),De(R,T,z))}},fd=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(R))return}else if(typeof Tl=="object"&&typeof Tl.emit=="function"){Tl.emit("uncaughtException",T);return}console.error(T)},hm=Error(i(461)),ya=!1,jf={dehydrated:null,treeContext:null,retryLane:0},Uu=y(null),j=null,C=null,P=typeof AbortController<"u"?AbortController:function(){var T=[],R=this.signal={aborted:!1,addEventListener:function(z,re){T.push(re)}};this.abort=function(){R.aborted=!0,T.forEach(function(z){return z()})}},H=Da.unstable_scheduleCallback,X=Da.unstable_NormalPriority,te={$$typeof:to,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},ue=Hr.S;Hr.S=function(T,R){typeof R=="object"&&R!==null&&typeof R.then=="function"&&Ot(T,R),ue!==null&&ue(T,R)};var Ee=y(null),w=!1,d=!1,b=!1,O=typeof WeakSet=="function"?WeakSet:Set,F=null,ie=!1,pe=null,ye=!1,Re=null,Pe=8192,Fe={getCacheForType:function(T){var R=Ia(te),z=R.data.get(T);return z===void 0&&(z=T(),R.data.set(T,z)),z}},Ye=0,dt=1,xt=2,Dt=3,bt=4;if(typeof Symbol=="function"&&Symbol.for){var gt=Symbol.for;Ye=gt("selector.component"),dt=gt("selector.has_pseudo_class"),xt=gt("selector.role"),Dt=gt("selector.test_id"),bt=gt("selector.text")}var kt=typeof WeakMap=="function"?WeakMap:Map,wt=0,It=null,Ft=null,Zt=0,Gt=0,$t=null,dn=!1,Rn=!1,Nn=!1,qn=0,Dn=0,gr=0,Br=0,Oi=0,oi=0,li=0,Fi=null,Yr=null,Ss=!1,ci=0,Is=1/0,$i=null,ea=null,Ns=!1,ms=null,vo=0,Dl=0,yc=null,cu=0,Bu=null;return zr.attemptContinuousHydration=function(T){if(T.tag===13){var R=ze(T,67108864);R!==null&&Ro(R,T,67108864),pp(T,67108864)}},zr.attemptHydrationAtCurrentPriority=function(T){if(T.tag===13){var R=_a(),z=ze(T,R);z!==null&&Ro(z,T,R),pp(T,R)}},zr.attemptSynchronousHydration=function(T){switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var R=M(T.pendingLanes);if(R!==0){for(T.pendingLanes|=2,T.entangledLanes|=2;R;){var z=1<<31-io(R);T.entanglements[1]|=z,R&=~z}Se(T),(wt&6)===0&&(Is=Sr()+500,ke(0))}}break;case 13:R=ze(T,2),R!==null&&Ro(R,T,2),Vh(),pp(T,2)}},zr.batchedUpdates=function(T,R){return T(R)},zr.createComponentSelector=function(T){return{$$typeof:Ye,value:T}},zr.createContainer=function(T,R,z,re,he,Te,et,yt,zt,mn){return Ur(T,R,!1,null,z,re,Te,et,yt,zt,mn,null)},zr.createHasPseudoClassSelector=function(T){return{$$typeof:dt,value:T}},zr.createHydrationContainer=function(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Qn,nr){return T=Ur(z,re,!0,T,he,Te,yt,zt,mn,Ln,Qn,nr),T.context=yr(null),z=T.current,re=_a(),he=_e(re),he.callback=R??null,Ie(z,he,re),T.current.lanes=re,J(T,re),Se(T),T},zr.createPortal=function(T,R,z){var re=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zl,key:re==null?null:""+re,children:T,containerInfo:R,implementation:z}},zr.createRoleSelector=function(T){return{$$typeof:xt,value:T}},zr.createTestNameSelector=function(T){return{$$typeof:Dt,value:T}},zr.createTextSelector=function(T){return{$$typeof:bt,value:T}},zr.defaultOnCaughtError=function(T){console.error(T)},zr.defaultOnRecoverableError=function(T){fd(T)},zr.defaultOnUncaughtError=function(T){fd(T)},zr.deferredUpdates=function(T){var R=Hr.T,z=ro();try{return Js(32),Hr.T=null,T()}finally{Js(z),Hr.T=R}},zr.discreteUpdates=function(T,R,z,re,he){var Te=Hr.T,et=ro();try{return Js(2),Hr.T=null,T(R,z,re,he)}finally{Js(et),Hr.T=Te,wt===0&&(Is=Sr()+500)}},zr.findAllNodes=Nc,zr.findBoundingRects=function(T,R){if(!Ql)throw Error(i(363));R=Nc(T,R),T=[];for(var z=0;z<R.length;z++)T.push(Vo(R[z]));for(R=T.length-1;0<R;R--){z=T[R];for(var re=z.x,he=re+z.width,Te=z.y,et=Te+z.height,yt=R-1;0<=yt;yt--)if(R!==yt){var zt=T[yt],mn=zt.x,Ln=mn+zt.width,Qn=zt.y,nr=Qn+zt.height;if(re>=mn&&Te>=Qn&&he<=Ln&&et<=nr){T.splice(R,1);break}else if(re!==mn||z.width!==zt.width||nr<Te||Qn>et){if(!(Te!==Qn||z.height!==zt.height||Ln<re||mn>he)){mn>re&&(zt.width+=mn-re,zt.x=re),Ln<he&&(zt.width=he-mn),T.splice(R,1);break}}else{Qn>Te&&(zt.height+=Qn-Te,zt.y=Te),nr<et&&(zt.height=et-Qn),T.splice(R,1);break}}}return T},zr.findHostInstance=ll,zr.findHostInstanceWithNoPortals=function(T){return T=g(T),T=T!==null?_(T):null,T===null?null:eu(T.stateNode)},zr.findHostInstanceWithWarning=function(T){return ll(T)},zr.flushPassiveEffects=ol,zr.flushSyncFromReconciler=function(T){var R=wt;wt|=1;var z=Hr.T,re=ro();try{if(Js(2),Hr.T=null,T)return T()}finally{Js(re),Hr.T=z,wt=R,(wt&6)===0&&ke(0)}},zr.flushSyncWork=Vh,zr.focusWithin=function(T,R){if(!Ql)throw Error(i(363));for(T=kf(T),R=wo(T,R),R=Array.from(R),T=0;T<R.length;){var z=R[T++],re=z.tag;if(!id(z)){if((re===5||re===26||re===27)&&of(z.stateNode))return!0;for(z=z.child;z!==null;)R.push(z),z=z.sibling}}return!1},zr.getFindAllNodesFailureDescription=function(T,R){if(!Ql)throw Error(i(363));var z=0,re=[];T=[kf(T),0];for(var he=0;he<T.length;){var Te=T[he++],et=Te.tag,yt=T[he++],zt=R[yt];if((et!==5&&et!==26&&et!==27||!id(Te))&&(If(Te,zt)&&(re.push(lg(zt)),yt++,yt>z&&(z=yt)),yt<R.length))for(Te=Te.child;Te!==null;)T.push(Te,yt),Te=Te.sibling}if(z<R.length){for(T=[];z<R.length;z++)T.push(lg(R[z]));return`findAllNodes was able to match part of the selector:
  `+(re.join(" > ")+`

No matching component was found for:
  `)+T.join(" > ")}return null},zr.getPublicRootInstance=function(T){if(T=T.current,!T.child)return null;switch(T.child.tag){case 27:case 5:return eu(T.child.stateNode);default:return T.child.stateNode}},zr.injectIntoDevTools=function(){var T={bundleType:0,version:kl,rendererPackageName:qs,currentDispatcherRef:Hr,findFiberByHostInstance:e0,reconcilerVersion:"19.0.0"};if(Il!==null&&(T.rendererConfig=Il),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")T=!1;else{var R=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(R.isDisabled||!R.supportsFiber)T=!0;else{try{bs=R.inject(T),$a=R}catch{}T=!!R.checkDCE}}return T},zr.isAlreadyRendering=function(){return!1},zr.observeVisibleRects=function(T,R,z,re){if(!Ql)throw Error(i(363));T=Nc(T,R);var he=Ua(T,z,re).disconnect;return{disconnect:function(){he()}}},zr.shouldError=function(){return null},zr.shouldSuspend=function(){return!1},zr.startHostTransition=function(T,R,z,re){if(T.tag!==5)throw Error(i(476));var he=Yi(T).queue;Yu(T,he,R,mc,z===null?r:function(){var Te=Yi(T).next.queue;return Yc(T,Te,{},_a()),z(re)})},zr.updateContainer=function(T,R,z,re){var he=R.current,Te=_a();return Kl(he,Te,T,R,z,re),Te},zr.updateContainerSync=function(T,R,z,re){return R.tag===0&&ol(),Kl(R.current,2,T,R,z,re),2},zr},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})})(nB)),nB.exports}var kY;function POe(){return kY||(kY=1,tB.exports=NOe()),tB.exports}var DOe=POe();const LOe=Bh(DOe);var IY=$le();function Dj(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=e?n.return:n.child;for(;r;){const i=Dj(r,e,t);if(i)return i;r=e?null:r.sibling}}function Wle(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const Lj=Wle(it.createContext(null));let Yle=class extends it.Component{render(){return it.createElement(Lj.Provider,{value:this._reactInternals},this.props.children)}};function Xle(){const n=it.useContext(Lj);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=it.useId();return it.useMemo(()=>{for(const t of[n,n?.alternate]){if(!t)continue;const r=Dj(t,!1,i=>{let s=i.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(r)return r}},[n,e])}const UOe=Symbol.for("react.context"),BOe=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===UOe;function FOe(){const n=Xle(),[e]=it.useState(()=>new Map);e.clear();let t=n;for(;t;){const r=t.type;BOe(r)&&r!==Lj&&!e.has(r)&&e.set(r,it.use(Wle(r))),t=t.return}return e}function zOe(){const n=FOe();return it.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>it.createElement(e,null,it.createElement(t.Provider,{...r,value:n.get(t)})),e=>it.createElement(Yle,{...e})),[n])}function Kle(n){let e=n.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Zle=n=>n&&n.isOrthographicCamera,jOe=n=>n&&n.hasOwnProperty("current"),HOe=n=>n!=null&&(typeof n=="string"||typeof n=="number"||n.isColor),Rk=((n,e)=>typeof window<"u"&&(((n=window.document)==null?void 0:n.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?it.useLayoutEffect:it.useEffect;function Uj(n){const e=it.useRef(n);return Rk(()=>void(e.current=n),[n]),e}function qOe(){const n=Xle(),e=zOe();return it.useMemo(()=>({children:t})=>{const i=!!Dj(n,!0,s=>s.type===it.StrictMode)?it.StrictMode:it.Fragment;return Le.jsx(i,{children:Le.jsx(e,{children:t})})},[n,e])}function VOe({set:n}){return Rk(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}const GOe=(n=>(n=class extends it.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},n.getDerivedStateFromError=()=>({error:!0}),n))();function Jle(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}function Yx(n){var e;return(e=n.__r3f)==null?void 0:e.root.getState()}const Ec={obj:n=>n===Object(n)&&!Ec.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Ec.str(n)||Ec.num(n)||Ec.boo(n))return n===e;const s=Ec.obj(n);if(s&&r==="reference")return n===e;const a=Ec.arr(n);if(a&&t==="reference")return n===e;if((a||s)&&n===e)return!0;let o;for(o in n)if(!(o in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(o in i?e:n)if(!Ec.equ(n[o],e[o],{strict:i,objects:"reference"}))return!1}else for(o in i?e:n)if(n[o]!==e[o])return!1;if(Ec.und(o)){if(a&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function $Oe(n){const e={nodes:{},materials:{},meshes:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function WOe(n){n.type!=="Scene"&&(n.dispose==null||n.dispose());for(const e in n){const t=n[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const Qle=["children","key","ref"];function YOe(n){const e={};for(const t in n)Qle.includes(t)||(e[t]=n[t]);return e}function UD(n,e,t,r){const i=n;let s=i?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:YOe(r),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=s)),s}function dO(n,e){let t=n[e];if(!e.includes("-"))return{root:n,key:e,target:t};t=n;for(const i of e.split("-")){var r;e=i,n=t,t=(r=t)==null?void 0:r[e]}return{root:n,key:e,target:t}}const NY=/-\d+$/;function BD(n,e){if(Ec.str(e.props.attach)){if(NY.test(e.props.attach)){const i=e.props.attach.replace(NY,""),{root:s,key:a}=dO(n.object,i);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:r}=dO(n.object,e.props.attach);e.previousAttach=t[r],t[r]=e.object}else Ec.fun(e.props.attach)&&(e.previousAttach=e.props.attach(n.object,e.object))}function FD(n,e){if(Ec.str(e.props.attach)){const{root:t,key:r}=dO(n.object,e.props.attach),i=e.previousAttach;i===void 0?delete t[r]:t[r]=i}else e.previousAttach==null||e.previousAttach(n.object,e.object);delete e.previousAttach}const z7=[...Qle,"args","dispose","attach","object","onUpdate","dispose"],PY=new Map;function XOe(n){let e=PY.get(n.constructor);try{e||(e=new n.constructor,PY.set(n.constructor,e))}catch{}return e}function KOe(n,e){const t={};for(const r in e)if(!z7.includes(r)&&!Ec.equ(e[r],n.props[r])){t[r]=e[r];for(const i in e)i.startsWith(`${r}-`)&&(t[i]=e[i])}for(const r in n.props){if(z7.includes(r)||e.hasOwnProperty(r))continue;const{root:i,key:s}=dO(n.object,r);if(i.constructor&&i.constructor.length===0){const a=XOe(i);Ec.und(a)||(t[s]=a[s])}else t[s]=0}return t}const ZOe=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],JOe=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function u1(n,e){var t;const r=n.__r3f,i=r&&Kle(r).getState(),s=r?.eventCount;for(const o in e){let l=e[o];if(z7.includes(o))continue;if(r&&JOe.test(o)){typeof l=="function"?r.handlers[o]=l:delete r.handlers[o],r.eventCount=Object.keys(r.handlers).length;continue}if(l===void 0)continue;let{root:c,key:u,target:f}=dO(n,o);if(f instanceof JT&&l instanceof JT)f.mask=l.mask;else if(f instanceof cr&&HOe(l))f.set(l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof f.copy=="function"&&l!=null&&l.constructor&&f.constructor===l.constructor)f.copy(l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&Array.isArray(l))typeof f.fromArray=="function"?f.fromArray(l):f.set(...l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof l=="number")typeof f.setScalar=="function"?f.setScalar(l):f.set(l);else{var a;c[u]=l,i&&!i.linear&&ZOe.includes(u)&&(a=c[u])!=null&&a.isTexture&&c[u].format===Xf&&c[u].type===ql&&(c[u].colorSpace=na)}}if(r!=null&&r.parent&&i!=null&&i.internal&&(t=r.object)!=null&&t.isObject3D&&s!==r.eventCount){const o=r.object,l=i.internal.interaction.indexOf(o);l>-1&&i.internal.interaction.splice(l,1),r.eventCount&&o.raycast!==null&&i.internal.interaction.push(o)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&Kw(r),n}function Kw(n){var e;if(!n.parent)return;n.props.onUpdate==null||n.props.onUpdate(n.object);const t=(e=n.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function ece(n,e){n.manual||(Zle(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix())}const Ap=n=>n?.isObject3D;function qI(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function tce(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function QOe(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{tce(t.capturedMap,e,r,i)})}function eke(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(l,c){const u=n.getState(),f=new Set,h=[],g=c?c(u.internal.interaction):u.internal.interaction;for(let v=0;v<g.length;v++){const x=Yx(g[v]);x&&(x.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(v){const x=Yx(v);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var E;x.events.compute==null||x.events.compute(l,x,(E=x.previousRoot)==null?void 0:E.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(v,!0):[]}let _=g.flatMap(p).sort((v,x)=>{const E=Yx(v.object),M=Yx(x.object);return!E||!M?v.distance-x.distance:M.events.priority-E.events.priority||v.distance-x.distance}).filter(v=>{const x=qI(v);return f.has(x)?!1:(f.add(x),!0)});u.events.filter&&(_=u.events.filter(_,u));for(const v of _){let x=v.object;for(;x;){var y;(y=x.__r3f)!=null&&y.eventCount&&h.push({...v,eventObject:x}),x=x.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let v of u.internal.capturedMap.get(l.pointerId).values())f.has(qI(v.intersection))||h.push(v.intersection);return h}function i(l,c,u,f){if(l.length){const h={stopped:!1};for(const g of l){let p=Yx(g.object);if(p||g.object.traverseAncestors(_=>{const y=Yx(_);if(y)return p=y,!1}),p){const{raycaster:_,pointer:y,camera:v,internal:x}=p,E=new ut(y.x,y.y,0).unproject(v),M=V=>{var G,J;return(G=(J=x.capturedMap.get(V))==null?void 0:J.has(g.eventObject))!=null?G:!1},k=V=>{const G={intersection:g,target:c.target};x.capturedMap.has(V)?x.capturedMap.get(V).set(g.eventObject,G):x.capturedMap.set(V,new Map([[g.eventObject,G]])),c.target.setPointerCapture(V)},N=V=>{const G=x.capturedMap.get(V);G&&tce(x.capturedMap,g.eventObject,G,V)};let I={};for(let V in c){let G=c[V];typeof G!="function"&&(I[V]=G)}let D={...g,...I,pointer:y,intersections:l,stopped:h.stopped,delta:u,unprojectedPoint:E,ray:_.ray,camera:v,stopPropagation(){const V="pointerId"in c&&x.capturedMap.get(c.pointerId);if((!V||V.has(g.eventObject))&&(D.stopped=h.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(G=>G.eventObject===g.eventObject))){const G=l.slice(0,l.indexOf(g));s([...G,g])}},target:{hasPointerCapture:M,setPointerCapture:k,releasePointerCapture:N},currentTarget:{hasPointerCapture:M,setPointerCapture:k,releasePointerCapture:N},nativeEvent:c};if(f(D),h.stopped===!0)break}}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const h=u.eventObject.__r3f;if(c.hovered.delete(qI(u)),h!=null&&h.eventCount){const g=h.handlers,p={...u,intersections:l};g.onPointerOut==null||g.onPointerOut(p),g.onPointerLeave==null||g.onPointerLeave(p)}}}function a(l,c){for(let u=0;u<c.length;u++){const f=c[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:f,internal:h}=n.getState();h.lastEvent.current=u;const g=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=r(u,g?t:void 0),v=p?e(u):0;l==="onPointerDown"&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=y.map(E=>E.eventObject)),p&&!y.length&&v<=2&&(a(u,h.interaction),f&&f(u)),g&&s(y);function x(E){const M=E.eventObject,k=M.__r3f;if(!(k!=null&&k.eventCount))return;const N=k.handlers;if(g){if(N.onPointerOver||N.onPointerEnter||N.onPointerOut||N.onPointerLeave){const I=qI(E),D=h.hovered.get(I);D?D.stopped&&E.stopPropagation():(h.hovered.set(I,E),N.onPointerOver==null||N.onPointerOver(E),N.onPointerEnter==null||N.onPointerEnter(E))}N.onPointerMove==null||N.onPointerMove(E)}else{const I=N[l];I?(!p||h.initialHits.includes(M))&&(a(u,h.interaction.filter(D=>!h.initialHits.includes(D))),I(E)):p&&h.initialHits.includes(M)&&a(u,h.interaction.filter(D=>!h.initialHits.includes(D)))}}i(y,u,v,x)}}return{handlePointer:o}}const DY=n=>!!(n!=null&&n.render),Bj=it.createContext(null),tke=(n,e)=>{const t=Hle((o,l)=>{const c=new ut,u=new ut,f=new ut;function h(v=l().camera,x=u,E=l().size){const{width:M,height:k,top:N,left:I}=E,D=M/k;x.isVector3?f.copy(x):f.set(...x);const V=v.getWorldPosition(c).distanceTo(f);if(Zle(v))return{width:M/v.zoom,height:k/v.zoom,top:N,left:I,factor:1,distance:V,aspect:D};{const G=v.fov*Math.PI/180,J=2*Math.tan(G/2)*V,B=J*(M/k);return{width:B,height:J,top:N,left:I,factor:M/B,distance:V,aspect:D}}}let g;const p=v=>o(x=>({performance:{...x.performance,current:v}})),_=new an;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(v=1)=>n(l(),v),advance:(v,x)=>e(v,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Mj,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();g&&clearTimeout(g),v.performance.current!==v.performance.min&&p(v.performance.min),g=setTimeout(()=>p(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:v=>o(x=>({...x,events:{...x.events,...v}})),setSize:(v,x,E=0,M=0)=>{const k=l().camera,N={width:v,height:x,top:E,left:M};o(I=>({size:N,viewport:{...I.viewport,...h(k,u,N)}}))},setDpr:v=>o(x=>{const E=Jle(v);return{viewport:{...x.viewport,dpr:E,initialDpr:x.viewport.initialDpr||E}}}),setFrameloop:(v="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,v!=="never"&&(x.start(),x.elapsedTime=0),o(()=>({frameloop:v}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:it.createRef(),active:!1,frames:0,priority:0,subscribe:(v,x,E)=>{const M=l().internal;return M.priority=M.priority+(x>0?1:0),M.subscribers.push({ref:v,priority:x,store:E}),M.subscribers=M.subscribers.sort((k,N)=>k.priority-N.priority),()=>{const k=l().internal;k!=null&&k.subscribers&&(k.priority=k.priority-(x>0?1:0),k.subscribers=k.subscribers.filter(N=>N.ref!==v))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,a=r.camera;return t.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:u,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){i=l,s=c.dpr,ece(o,l),c.dpr>0&&u.setPixelRatio(c.dpr);const h=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,h)}o!==a&&(a=o,f(h=>({viewport:{...h.viewport,...h.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>n(o)),t};function Fj(){const n=it.useContext(Bj);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Nm(n=t=>t,e){return Fj()(n,e)}function Wg(n,e=0){const t=Fj(),r=t.getState().internal.subscribe,i=Uj(n);return Rk(()=>r(i,e,t),[e,r,t]),null}const LY=new WeakMap,nke=n=>{var e;return typeof n=="function"&&(n==null||(e=n.prototype)==null?void 0:e.constructor)===n};function nce(n,e){return function(t,...r){let i;return nke(t)?(i=LY.get(t),i||(i=new t,LY.set(t,i))):i=t,n&&n(i),Promise.all(r.map(s=>new Promise((a,o)=>i.load(s,l=>{Ap(l?.scene)&&Object.assign(l,$Oe(l.scene)),a(l)},e,l=>o(new Error(`Could not load ${s}: ${l?.message}`))))))}}function zj(n,e,t,r){const i=Array.isArray(e)?e:[e],s=Gle(nce(t,r),[n,...i],{equal:Ec.equ});return Array.isArray(e)?s:s[0]}zj.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return OOe(nce(t),[n,...r])};zj.clear=function(n,e){const t=Array.isArray(e)?e:[e];return kOe([n,...t])};function rke(n){const e=LOe(n);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:it.version}),e}const rce=0,rw={},ike=/^three(?=[A-Z])/,tU=n=>`${n[0].toUpperCase()}${n.slice(1)}`;let ske=0;const ake=n=>typeof n=="function";function jj(n){if(ake(n)){const e=`${ske++}`;return rw[e]=n,e}else Object.assign(rw,n)}function ice(n,e){const t=tU(n),r=rw[t];if(n!=="primitive"&&!r)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(n==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function oke(n,e,t){var r;return n=tU(n)in rw?n:n.replace(ike,""),ice(n,e),n==="primitive"&&(r=e.object)!=null&&r.__r3f&&delete e.object.__r3f,UD(e.object,t,n,e)}function lke(n){if(!n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?FD(n.parent,n):Ap(n.object)&&(n.object.visible=!1),n.isHidden=!0,Kw(n)}}function sce(n){if(n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?BD(n.parent,n):Ap(n.object)&&n.props.visible!==!1&&(n.object.visible=!0),n.isHidden=!1,Kw(n)}}function Hj(n,e,t){const r=e.root.getState();if(!(!n.parent&&n.object!==r.scene)){if(!e.object){var i,s;const a=rw[tU(e.type)];e.object=(i=e.props.object)!=null?i:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(u1(e.object,e.props),e.props.attach)BD(n,e);else if(Ap(e.object)&&Ap(n.object)){const a=n.object.children.indexOf(t?.object);if(t&&a!==-1){const o=n.object.children.indexOf(e.object);if(o!==-1){n.object.children.splice(o,1);const l=o<a?a-1:a;n.object.children.splice(l,0,e.object)}else e.object.parent=n.object,n.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),n.object.dispatchEvent({type:"childadded",child:e.object})}else n.object.add(e.object)}for(const a of e.children)Hj(e,a);Kw(e)}}function sB(n,e){e&&(e.parent=n,n.children.push(e),Hj(n,e))}function UY(n,e,t){if(!e||!t)return;e.parent=n;const r=n.children.indexOf(t);r!==-1?n.children.splice(r,0,e):n.children.push(e),Hj(n,e,t)}function ace(n){if(typeof n.dispose=="function"){const e=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():IY.unstable_scheduleCallback(IY.unstable_IdlePriority,e)}}function j7(n,e,t){if(!e)return;e.parent=null;const r=n.children.indexOf(e);r!==-1&&n.children.splice(r,1),e.props.attach?FD(n,e):Ap(e.object)&&Ap(n.object)&&(n.object.remove(e.object),QOe(Kle(e),e.object));const i=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];j7(e,a,i)}e.children.length=0,delete e.object.__r3f,i&&e.type!=="primitive"&&e.object.type!=="Scene"&&ace(e.object),t===void 0&&Kw(e)}function cke(n,e){for(const t of[n,n.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const r=t.ref(e);typeof r=="function"&&(t.refCleanup=r)}else t.ref&&(t.ref.current=e)}const iP=[];function uke(){for(const[t]of iP){const r=t.parent;if(r){t.props.attach?FD(r,t):Ap(t.object)&&Ap(r.object)&&r.object.remove(t.object);for(const i of t.children)i.props.attach?FD(t,i):Ap(i.object)&&Ap(t.object)&&t.object.remove(i.object)}t.isHidden&&sce(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&ace(t.object)}for(const[t,r,i]of iP){t.props=r;const s=t.parent;if(s){var n,e;const a=rw[tU(t.type)];t.object=(n=t.props.object)!=null?n:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,cke(i,t.object),u1(t.object,t.props),t.props.attach?BD(s,t):Ap(t.object)&&Ap(s.object)&&s.object.add(t.object);for(const o of t.children)o.props.attach?BD(t,o):Ap(o.object)&&Ap(t.object)&&t.object.add(o.object);Kw(t)}}iP.length=0}const aB=()=>{},BY={};let VI=rce;const fke=0,hke=4,zD=rke({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:oke,removeChild:j7,appendChild:sB,appendInitialChild:sB,insertBefore:UY,appendChildToContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||sB(t,e)},removeChildFromContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||j7(t,e)},insertInContainerBefore(n,e,t){const r=n.getState().scene.__r3f;!e||!t||!r||UY(r,e,t)},getRootHostContext:()=>BY,getChildHostContext:()=>BY,commitUpdate(n,e,t,r,i){var s,a,o;ice(e,r);let l=!1;if((n.type==="primitive"&&t.object!==r.object||((s=r.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(o=r.args)!=null&&o.some((u,f)=>{var h;return u!==((h=t.args)==null?void 0:h[f])}))&&(l=!0),l)iP.push([n,{...r},i]);else{const u=KOe(n,r);Object.keys(u).length&&(Object.assign(n.props,u),u1(n.object,u))}(i.sibling===null||(i.flags&hke)===fke)&&uke()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:n=>n?.object,prepareForCommit:()=>null,preparePortalMount:n=>UD(n.getState().scene,n,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:lke,unhideInstance:sce,createTextInstance:aB,hideTextInstance:aB,unhideTextInstance:aB,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:it.createContext(null),setCurrentUpdatePriority(n){VI=n},getCurrentUpdatePriority(){return VI},resolveUpdatePriority(){var n;if(VI!==rce)return VI;switch(typeof window<"u"&&((n=window.event)==null?void 0:n.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return QN.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return QN.ContinuousEventPriority;default:return QN.DefaultEventPriority}},resetFormInstance(){}}),wE=new Map,Xx={objects:"shallow",strict:!1};function dke(n,e){if(!e&&typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:r,top:i,left:s}=n.parentElement.getBoundingClientRect();return{width:t,height:r,top:i,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function pke(n){const e=wE.get(n),t=e?.fiber,r=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||tke(V7,zY),a=t||zD.createContainer(s,QN.ConcurrentRoot,null,!1,null,"",i,i,i,null);e||wE.set(n,{fiber:a,store:s});let o,l,c=!1,u=null;return{async configure(f={}){let h;u=new Promise(K=>h=K);let{gl:g,size:p,scene:_,events:y,onCreated:v,shadows:x=!1,linear:E=!1,flat:M=!1,legacy:k=!1,orthographic:N=!1,frameloop:I="always",dpr:D=[1,2],performance:V,raycaster:G,camera:J,onPointerMissed:B}=f,$=s.getState(),U=$.gl;if(!$.gl){const K={canvas:n,powerPreference:"high-performance",antialias:!0,alpha:!0},ne=typeof g=="function"?await g(K):g;DY(ne)?U=ne:U=new jle({...K,...g}),$.set({gl:U})}let Q=$.raycaster;Q||$.set({raycaster:Q=new Ij});const{params:W,...q}=G||{};if(Ec.equ(q,Q,Xx)||u1(Q,{...q}),Ec.equ(W,Q.params,Xx)||u1(Q,{params:{...Q.params,...W}}),!$.camera||$.camera===l&&!Ec.equ(l,J,Xx)){l=J;const K=J?.isCamera,ne=K?J:N?new wk(0,0,0,0,.1,1e3):new yf(75,0,.1,1e3);K||(ne.position.z=5,J&&(u1(ne,J),ne.manual||("aspect"in J||"left"in J||"right"in J||"bottom"in J||"top"in J)&&(ne.manual=!0,ne.updateProjectionMatrix())),!$.camera&&!(J!=null&&J.rotation)&&ne.lookAt(0,0,0)),$.set({camera:ne}),Q.camera=ne}if(!$.scene){let K;_!=null&&_.isScene?(K=_,UD(K,s,"",{})):(K=new ew,UD(K,s,"",{}),_&&u1(K,_)),$.set({scene:K})}y&&!$.events.handlers&&$.set({events:y(s)});const Y=dke(n,p);if(Ec.equ(Y,$.size,Xx)||$.setSize(Y.width,Y.height,Y.top,Y.left),D&&$.viewport.dpr!==Jle(D)&&$.setDpr(D),$.frameloop!==I&&$.setFrameloop(I),$.onPointerMissed||$.set({onPointerMissed:B}),V&&!Ec.equ(V,$.performance,Xx)&&$.set(K=>({performance:{...K.performance,...V}})),!$.xr){var ae;const K=(ce,de)=>{const Me=s.getState();Me.frameloop!=="never"&&zY(ce,!0,Me,de)},ne=()=>{const ce=s.getState();ce.gl.xr.enabled=ce.gl.xr.isPresenting,ce.gl.xr.setAnimationLoop(ce.gl.xr.isPresenting?K:null),ce.gl.xr.isPresenting||V7(ce)},le={connect(){const ce=s.getState().gl;ce.xr.addEventListener("sessionstart",ne),ce.xr.addEventListener("sessionend",ne)},disconnect(){const ce=s.getState().gl;ce.xr.removeEventListener("sessionstart",ne),ce.xr.removeEventListener("sessionend",ne)}};typeof((ae=U.xr)==null?void 0:ae.addEventListener)=="function"&&le.connect(),$.set({xr:le})}if(U.shadowMap){const K=U.shadowMap.enabled,ne=U.shadowMap.type;if(U.shadowMap.enabled=!!x,Ec.boo(x))U.shadowMap.type=C2;else if(Ec.str(x)){var Z;const le={basic:jae,percentage:x4,soft:C2,variance:v_};U.shadowMap.type=(Z=le[x])!=null?Z:C2}else Ec.obj(x)&&Object.assign(U.shadowMap,x);(K!==U.shadowMap.enabled||ne!==U.shadowMap.type)&&(U.shadowMap.needsUpdate=!0)}return Ea.enabled=!k,c||(U.outputColorSpace=E?jv:na,U.toneMapping=M?Iv:Jz),$.legacy!==k&&$.set(()=>({legacy:k})),$.linear!==E&&$.set(()=>({linear:E})),$.flat!==M&&$.set(()=>({flat:M})),g&&!Ec.fun(g)&&!DY(g)&&!Ec.equ(g,U,Xx)&&u1(U,g),o=v,c=!0,h(),this},render(f){return!c&&!u&&this.configure(),u.then(()=>{zD.updateContainer(Le.jsx(mke,{store:s,children:f,onCreated:o,rootElement:n}),a,null,()=>{})}),s},unmount(){oce(n)}}}function mke({store:n,children:e,onCreated:t,rootElement:r}){return Rk(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),Le.jsx(Bj.Provider,{value:n,children:e})}function oce(n,e){const t=wE.get(n),r=t?.fiber;if(r){const i=t?.store.getState();i&&(i.internal.active=!1),zD.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,a,o,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=i.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),WOe(i.scene),wE.delete(n)}catch{}},500)})}}function gke(n,e,t){return Le.jsx(_ke,{children:n,container:e,state:t})}function _ke({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,a=Fj(),[o]=it.useState(()=>new Ij),[l]=it.useState(()=>new an),c=Uj((f,h)=>{let g;if(h.camera&&i){const p=h.camera;g=f.viewport.getCurrentViewport(p,new ut,i),p!==f.camera&&ece(p,i)}return{...f,...h,scene:t,raycaster:o,pointer:l,mouse:l,previousRoot:a,events:{...f.events,...h.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...g},setEvents:p=>h.set(_=>({..._,events:{..._.events,...p}}))}}),u=it.useMemo(()=>{const f=Hle((g,p)=>({...s,set:g,get:p})),h=g=>f.setState(p=>c.current(g,p));return h(a.getState()),a.subscribe(h),f},[a,t]);return Le.jsx(Le.Fragment,{children:zD.createPortal(Le.jsx(Bj.Provider,{value:u,children:e}),u,null)})}function lce(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}const cce=new Set,uce=new Set,vke=new Set,yke=n=>lce(n,cce),bke=n=>lce(n,uce);function oB(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function B2(n,e){switch(n){case"before":return oB(cce,e);case"after":return oB(uce,e);case"tail":return oB(vke,e)}}let lB,cB;function H7(n,e,t){let r=e.clock.getDelta();e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),lB=e.internal.subscribers;for(let i=0;i<lB.length;i++)cB=lB[i],cB.ref.current(cB.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let jD=!1,q7=!1,uB,FY,Kx;function fce(n){FY=requestAnimationFrame(fce),jD=!0,uB=0,B2("before",n),q7=!0;for(const t of wE.values()){var e;Kx=t.store.getState(),Kx.internal.active&&(Kx.frameloop==="always"||Kx.internal.frames>0)&&!((e=Kx.gl.xr)!=null&&e.isPresenting)&&(uB+=H7(n,Kx))}if(q7=!1,B2("after",n),uB===0)return B2("tail",n),jD=!1,cancelAnimationFrame(FY)}function V7(n,e=1){var t;if(!n)return wE.forEach(r=>V7(r.store.getState(),e));(t=n.gl.xr)!=null&&t.isPresenting||!n.internal.active||n.frameloop==="never"||(e>1?n.internal.frames=Math.min(60,n.internal.frames+e):q7?n.internal.frames=2:n.internal.frames=1,jD||(jD=!0,requestAnimationFrame(fce)))}function zY(n,e=!0,t,r){if(e&&B2("before",n),t)H7(n,t,r);else for(const i of wE.values())H7(n,i.store.getState());e&&B2("after",n)}const fB={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function hce(n){const{handlePointer:e}=eke(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(fB).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{const{set:r,events:i}=n.getState();if(i.disconnect==null||i.disconnect(),r(s=>({events:{...s.events,connected:t}})),i.handlers)for(const s in i.handlers){const a=i.handlers[s],[o,l]=fB[s];t.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){if(r.handlers)for(const i in r.handlers){const s=r.handlers[i],[a]=fB[i];r.connected.removeEventListener(a,s)}t(i=>({events:{...i.events,connected:void 0}}))}}}}function jY(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function Ske({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=it.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=it.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=it.useRef(!1);it.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[f,h,g]=it.useMemo(()=>{const v=()=>{if(!o.current.element)return;const{left:x,top:E,width:M,height:k,bottom:N,right:I,x:D,y:V}=o.current.element.getBoundingClientRect(),G={left:x,top:E,width:M,height:k,bottom:N,right:I,x:D,y:V};o.current.element instanceof HTMLElement&&r&&(G.height=o.current.element.offsetHeight,G.width=o.current.element.offsetWidth),Object.freeze(G),u.current&&!wke(o.current.lastBounds,G)&&a(o.current.lastBounds=G)};return[v,c?jY(v,c):v,l?jY(v,l):v]},[a,r,l,c]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",g,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function _(){o.current.element&&(o.current.resizeObserver=new i(g),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(v=>v.addEventListener("scroll",g,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{g()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const y=v=>{!v||v===o.current.element||(p(),o.current.element=v,o.current.scrollContainers=dce(v),_())};return xke(g,!!e),Eke(h),it.useEffect(()=>{p(),_()},[e,g,h]),it.useEffect(()=>p,[]),[y,s,f]}function Eke(n){it.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function xke(n,e){it.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function dce(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...dce(n.parentElement)]}const Tke=["x","y","top","bottom","left","right","width","height"],wke=(n,e)=>Tke.every(t=>n[t]===e[t]);function Rke({ref:n,children:e,fallback:t,resize:r,style:i,gl:s,events:a=hce,eventSource:o,eventPrefix:l,shadows:c,linear:u,flat:f,legacy:h,orthographic:g,frameloop:p,dpr:_,performance:y,raycaster:v,camera:x,scene:E,onPointerMissed:M,onCreated:k,...N}){it.useMemo(()=>jj(yOe),[]);const I=qOe(),[D,V]=Ske({scroll:!0,debounce:{scroll:50,resize:0},...r}),G=it.useRef(null),J=it.useRef(null);it.useImperativeHandle(n,()=>G.current);const B=Uj(M),[$,U]=it.useState(!1),[Q,W]=it.useState(!1);if($)throw $;if(Q)throw Q;const q=it.useRef(null);Rk(()=>{const ae=G.current;if(V.width>0&&V.height>0&&ae){q.current||(q.current=pke(ae));async function Z(){await q.current.configure({gl:s,scene:E,events:a,shadows:c,linear:u,flat:f,legacy:h,orthographic:g,frameloop:p,dpr:_,performance:y,raycaster:v,camera:x,size:V,onPointerMissed:(...K)=>B.current==null?void 0:B.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(o?jOe(o)?o.current:o:J.current),l&&K.setEvents({compute:(ne,le)=>{const ce=ne[l+"X"],de=ne[l+"Y"];le.pointer.set(ce/le.size.width*2-1,-(de/le.size.height)*2+1),le.raycaster.setFromCamera(le.pointer,le.camera)}}),k?.(K)}}),q.current.render(Le.jsx(I,{children:Le.jsx(GOe,{set:W,children:Le.jsx(it.Suspense,{fallback:Le.jsx(VOe,{set:U}),children:e??null})})}))}Z()}}),it.useEffect(()=>{const ae=G.current;if(ae)return()=>oce(ae)},[]);const Y=o?"none":"auto";return Le.jsx("div",{ref:J,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...i},...N,children:Le.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:Le.jsx("canvas",{ref:G,style:{display:"block"},children:t})})})}function Ake(n){return Le.jsx(Yle,{children:Le.jsx(Rke,{...n})})}var GI={exports:{}},HY;function Cke(){if(HY)return GI.exports;HY=1;function n(e,t=100,r={}){if(typeof e!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:i}=typeof r=="boolean"?{immediate:r}:r;let s,a,o,l,c;function u(){const g=s,p=a;return s=void 0,a=void 0,c=e.apply(g,p),c}function f(){const g=Date.now()-l;g<t&&g>=0?o=setTimeout(f,t-g):(o=void 0,i||(c=u()))}const h=function(...g){if(s&&this!==s&&Object.getPrototypeOf(this)===Object.getPrototypeOf(s))throw new Error("Debounced method called with different contexts of the same prototype.");s=this,a=g,l=Date.now();const p=i&&!o;return o||(o=setTimeout(f,t)),p&&(c=u()),c};return Object.defineProperty(h,"isPending",{get(){return o!==void 0}}),h.clear=()=>{o&&(clearTimeout(o),o=void 0)},h.flush=()=>{o&&h.trigger()},h.trigger=()=>{c=u(),h.clear()},h}return GI.exports.debounce=n,GI.exports=n,GI.exports}var Mke=Cke();const Oke=Bh(Mke);var hB={exports:{}},$R={},dB={exports:{}},pB={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qY;function kke(){return qY||(qY=1,(function(n){function e(W,q){var Y=W.length;W.push(q);e:for(;0<Y;){var ae=Y-1>>>1,Z=W[ae];if(0<i(Z,q))W[ae]=q,W[Y]=Z,Y=ae;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var q=W[0],Y=W.pop();if(Y!==q){W[0]=Y;e:for(var ae=0,Z=W.length,K=Z>>>1;ae<K;){var ne=2*(ae+1)-1,le=W[ne],ce=ne+1,de=W[ce];if(0>i(le,Y))ce<Z&&0>i(de,le)?(W[ae]=de,W[ce]=Y,ae=ce):(W[ae]=le,W[ne]=Y,ae=ne);else if(ce<Z&&0>i(de,Y))W[ae]=de,W[ce]=Y,ae=ce;else break e}}return q}function i(W,q){var Y=W.sortIndex-q.sortIndex;return Y!==0?Y:W.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,g=!1,p=!1,_=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function M(W){for(var q=t(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=W)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=t(c)}}function k(W){if(_=!1,M(W),!p)if(t(l)!==null)p=!0,N||(N=!0,B());else{var q=t(c);q!==null&&Q(k,q.startTime-W)}}var N=!1,I=-1,D=5,V=-1;function G(){return y?!0:!(n.unstable_now()-V<D)}function J(){if(y=!1,N){var W=n.unstable_now();V=W;var q=!0;try{e:{p=!1,_&&(_=!1,x(I),I=-1),g=!0;var Y=h;try{t:{for(M(W),f=t(l);f!==null&&!(f.expirationTime>W&&G());){var ae=f.callback;if(typeof ae=="function"){f.callback=null,h=f.priorityLevel;var Z=ae(f.expirationTime<=W);if(W=n.unstable_now(),typeof Z=="function"){f.callback=Z,M(W),q=!0;break t}f===t(l)&&r(l),M(W)}else r(l);f=t(l)}if(f!==null)q=!0;else{var K=t(c);K!==null&&Q(k,K.startTime-W),q=!1}}break e}finally{f=null,h=Y,g=!1}q=void 0}}finally{q?B():N=!1}}}var B;if(typeof E=="function")B=function(){E(J)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,U=$.port2;$.port1.onmessage=J,B=function(){U.postMessage(null)}}else B=function(){v(J,0)};function Q(W,q){I=v(function(){W(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_next=function(W){switch(h){case 1:case 2:case 3:var q=3;break;default:q=h}var Y=h;h=q;try{return W()}finally{h=Y}},n.unstable_requestPaint=function(){y=!0},n.unstable_runWithPriority=function(W,q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=h;h=W;try{return q()}finally{h=Y}},n.unstable_scheduleCallback=function(W,q,Y){var ae=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,W={id:u++,callback:q,priorityLevel:W,startTime:Y,expirationTime:Z,sortIndex:-1},Y>ae?(W.sortIndex=Y,e(c,W),t(l)===null&&W===t(c)&&(_?(x(I),I=-1):_=!0,Q(k,Y-ae))):(W.sortIndex=Z,e(l,W),p||g||(p=!0,N||(N=!0,B()))),W},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(W){var q=h;return function(){var Y=h;h=q;try{return W.apply(this,arguments)}finally{h=Y}}}})(pB)),pB}var VY;function Ike(){return VY||(VY=1,dB.exports=kke()),dB.exports}var mB={exports:{}},Gd={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GY;function Nke(){if(GY)return Gd;GY=1;var n=jw();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,c,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:f==null?null:""+f,children:l,containerInfo:c,implementation:u}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Gd.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Gd.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return s(l,c,null,u)},Gd.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Gd.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Gd.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Gd.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:h,fetchPriority:g}):u==="script"&&r.d.X(l,{crossOrigin:f,integrity:h,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Gd.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Gd.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Gd.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Gd.requestFormReset=function(l){r.d.r(l)},Gd.unstable_batchedUpdates=function(l,c){return l(c)},Gd.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Gd.useFormStatus=function(){return a.H.useHostTransitionStatus()},Gd.version="19.1.1",Gd}var $Y;function Pke(){if($Y)return mB.exports;$Y=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),mB.exports=Nke(),mB.exports}var WY;function Dke(){if(WY)return $R;WY=1;var n=Ike(),e=jw(),t=Pke();function r(m){var S="https://react.dev/errors/"+m;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)S+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+m+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function s(m){var S=m,A=m;if(m.alternate)for(;S.return;)S=S.return;else{m=S;do S=m,(S.flags&4098)!==0&&(A=S.return),m=S.return;while(m)}return S.tag===3?A:null}function a(m){if(m.tag===13){var S=m.memoizedState;if(S===null&&(m=m.alternate,m!==null&&(S=m.memoizedState)),S!==null)return S.dehydrated}return null}function o(m){if(s(m)!==m)throw Error(r(188))}function l(m){var S=m.alternate;if(!S){if(S=s(m),S===null)throw Error(r(188));return S!==m?null:m}for(var A=m,L=S;;){var ee=A.return;if(ee===null)break;var fe=ee.alternate;if(fe===null){if(L=ee.return,L!==null){A=L;continue}break}if(ee.child===fe.child){for(fe=ee.child;fe;){if(fe===A)return o(ee),m;if(fe===L)return o(ee),S;fe=fe.sibling}throw Error(r(188))}if(A.return!==L.return)A=ee,L=fe;else{for(var He=!1,Qe=ee.child;Qe;){if(Qe===A){He=!0,A=ee,L=fe;break}if(Qe===L){He=!0,L=ee,A=fe;break}Qe=Qe.sibling}if(!He){for(Qe=fe.child;Qe;){if(Qe===A){He=!0,A=fe,L=ee;break}if(Qe===L){He=!0,L=fe,A=ee;break}Qe=Qe.sibling}if(!He)throw Error(r(189))}}if(A.alternate!==L)throw Error(r(190))}if(A.tag!==3)throw Error(r(188));return A.stateNode.current===A?m:S}function c(m){var S=m.tag;if(S===5||S===26||S===27||S===6)return m;for(m=m.child;m!==null;){if(S=c(m),S!==null)return S;m=m.sibling}return null}var u=Object.assign,f=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),E=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function B(m){return m===null||typeof m!="object"?null:(m=J&&m[J]||m["@@iterator"],typeof m=="function"?m:null)}var $=Symbol.for("react.client.reference");function U(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===$?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case p:return"Fragment";case y:return"Profiler";case _:return"StrictMode";case k:return"Suspense";case N:return"SuspenseList";case V:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case g:return"Portal";case E:return(m.displayName||"Context")+".Provider";case x:return(m._context.displayName||"Context")+".Consumer";case M:var S=m.render;return m=m.displayName,m||(m=S.displayName||S.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case I:return S=m.displayName||null,S!==null?S:U(m.type)||"Memo";case D:S=m._payload,m=m._init;try{return U(m(S))}catch{}}return null}var Q=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},ae=[],Z=-1;function K(m){return{current:m}}function ne(m){0>Z||(m.current=ae[Z],ae[Z]=null,Z--)}function le(m,S){Z++,ae[Z]=m.current,m.current=S}var ce=K(null),de=K(null),Me=K(null),qe=K(null);function Ne(m,S){switch(le(Me,S),le(de,m),le(ce,null),S.nodeType){case 9:case 11:m=(m=S.documentElement)&&(m=m.namespaceURI)?h$(m):0;break;default:if(m=S.tagName,S=S.namespaceURI)S=h$(S),m=d$(S,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}ne(ce),le(ce,m)}function Ae(){ne(ce),ne(de),ne(Me)}function Xe(m){m.memoizedState!==null&&le(qe,m);var S=ce.current,A=d$(S,m.type);S!==A&&(le(de,m),le(ce,A))}function $e(m){de.current===m&&(ne(ce),ne(de)),qe.current===m&&(ne(qe),CR._currentValue=Y)}var at=Object.prototype.hasOwnProperty,pt=n.unstable_scheduleCallback,oe=n.unstable_cancelCallback,Ue=n.unstable_shouldYield,Ge=n.unstable_requestPaint,ze=n.unstable_now,Be=n.unstable_getCurrentPriorityLevel,me=n.unstable_ImmediatePriority,Se=n.unstable_UserBlockingPriority,ke=n.unstable_NormalPriority,be=n.unstable_LowPriority,Ke=n.unstable_IdlePriority,ot=n.log,lt=n.unstable_setDisableYieldValue,ct=null,Vt=null;function Ot(m){if(typeof ot=="function"&&lt(m),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(ct,m)}catch{}}var Ut=Math.clz32?Math.clz32:se,je=Math.log,ge=Math.LN2;function se(m){return m>>>=0,m===0?32:31-(je(m)/ge|0)|0}var _e=256,Ie=4194304;function De(m){var S=m&42;if(S!==0)return S;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Oe(m,S,A){var L=m.pendingLanes;if(L===0)return 0;var ee=0,fe=m.suspendedLanes,He=m.pingedLanes;m=m.warmLanes;var Qe=L&134217727;return Qe!==0?(L=Qe&~fe,L!==0?ee=De(L):(He&=Qe,He!==0?ee=De(He):A||(A=Qe&~m,A!==0&&(ee=De(A))))):(Qe=L&~fe,Qe!==0?ee=De(Qe):He!==0?ee=De(He):A||(A=L&~m,A!==0&&(ee=De(A)))),ee===0?0:S!==0&&S!==ee&&(S&fe)===0&&(fe=ee&-ee,A=S&-S,fe>=A||fe===32&&(A&4194048)!==0)?S:ee}function we(m,S){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&S)===0}function st(m,S){switch(m){case 1:case 2:case 4:case 8:case 64:return S+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ve(){var m=_e;return _e<<=1,(_e&4194048)===0&&(_e=256),m}function tt(){var m=Ie;return Ie<<=1,(Ie&62914560)===0&&(Ie=4194304),m}function Ze(m){for(var S=[],A=0;31>A;A++)S.push(m);return S}function nt(m,S){m.pendingLanes|=S,S!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function vt(m,S,A,L,ee,fe){var He=m.pendingLanes;m.pendingLanes=A,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=A,m.entangledLanes&=A,m.errorRecoveryDisabledLanes&=A,m.shellSuspendCounter=0;var Qe=m.entanglements,Et=m.expirationTimes,Qt=m.hiddenUpdates;for(A=He&~A;0<A;){var vn=31-Ut(A),xn=1<<vn;Qe[vn]=0,Et[vn]=-1;var rn=Qt[vn];if(rn!==null)for(Qt[vn]=null,vn=0;vn<rn.length;vn++){var on=rn[vn];on!==null&&(on.lane&=-536870913)}A&=~xn}L!==0&&Je(m,L,0),fe!==0&&ee===0&&m.tag!==0&&(m.suspendedLanes|=fe&~(He&~S))}function Je(m,S,A){m.pendingLanes|=S,m.suspendedLanes&=~S;var L=31-Ut(S);m.entangledLanes|=S,m.entanglements[L]=m.entanglements[L]|1073741824|A&4194090}function ht(m,S){var A=m.entangledLanes|=S;for(m=m.entanglements;A;){var L=31-Ut(A),ee=1<<L;ee&S|m[L]&S&&(m[L]|=S),A&=~ee}}function mt(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function ft(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function _t(){var m=q.p;return m!==0?m:(m=window.event,m===void 0?32:I$(m.type))}function gn(m,S){var A=q.p;try{return q.p=m,S()}finally{q.p=A}}var _n=Math.random().toString(36).slice(2),Bt="__reactFiber$"+_n,Yt="__reactProps$"+_n,Mt="__reactContainer$"+_n,fn="__reactEvents$"+_n,Bn="__reactListeners$"+_n,cn="__reactHandles$"+_n,In="__reactResources$"+_n,Wn="__reactMarker$"+_n;function er(m){delete m[Bt],delete m[Yt],delete m[fn],delete m[Bn],delete m[cn]}function os(m){var S=m[Bt];if(S)return S;for(var A=m.parentNode;A;){if(S=A[Mt]||A[Bt]){if(A=S.alternate,S.child!==null||A!==null&&A.child!==null)for(m=_$(m);m!==null;){if(A=m[Bt])return A;m=_$(m)}return S}m=A,A=m.parentNode}return null}function gi(m){if(m=m[Bt]||m[Mt]){var S=m.tag;if(S===5||S===6||S===13||S===26||S===27||S===3)return m}return null}function Ni(m){var S=m.tag;if(S===5||S===26||S===27||S===6)return m.stateNode;throw Error(r(33))}function Fs(m){var S=m[In];return S||(S=m[In]={hoistableStyles:new Map,hoistableScripts:new Map}),S}function _i(m){m[Wn]=!0}var Rs=new Set,ra={};function ls(m,S){We(m,S),We(m+"Capture",S)}function We(m,S){for(ra[m]=S,m=0;m<S.length;m++)Rs.add(S[m])}var At=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wt={},Kt={};function Lt(m){return at.call(Kt,m)?!0:at.call(Wt,m)?!1:At.test(m)?Kt[m]=!0:(Wt[m]=!0,!1)}function yn(m,S,A){if(Lt(S))if(A===null)m.removeAttribute(S);else{switch(typeof A){case"undefined":case"function":case"symbol":m.removeAttribute(S);return;case"boolean":var L=S.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){m.removeAttribute(S);return}}m.setAttribute(S,""+A)}}function zn(m,S,A){if(A===null)m.removeAttribute(S);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(S);return}m.setAttribute(S,""+A)}}function En(m,S,A,L){if(L===null)m.removeAttribute(A);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(A);return}m.setAttributeNS(S,A,""+L)}}var tr,Nr;function Er(m){if(tr===void 0)try{throw Error()}catch(A){var S=A.stack.trim().match(/\n( *(at )?)/);tr=S&&S[1]||"",Nr=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tr+m+Nr}var rr=!1;function Lr(m,S){if(!m||rr)return"";rr=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(S){var xn=function(){throw Error()};if(Object.defineProperty(xn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xn,[])}catch(on){var rn=on}Reflect.construct(m,[],xn)}else{try{xn.call()}catch(on){rn=on}m.call(xn.prototype)}}else{try{throw Error()}catch(on){rn=on}(xn=m())&&typeof xn.catch=="function"&&xn.catch(function(){})}}catch(on){if(on&&rn&&typeof on.stack=="string")return[on.stack,rn.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var ee=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");ee&&ee.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var fe=L.DetermineComponentFrameRoot(),He=fe[0],Qe=fe[1];if(He&&Qe){var Et=He.split(`
`),Qt=Qe.split(`
`);for(ee=L=0;L<Et.length&&!Et[L].includes("DetermineComponentFrameRoot");)L++;for(;ee<Qt.length&&!Qt[ee].includes("DetermineComponentFrameRoot");)ee++;if(L===Et.length||ee===Qt.length)for(L=Et.length-1,ee=Qt.length-1;1<=L&&0<=ee&&Et[L]!==Qt[ee];)ee--;for(;1<=L&&0<=ee;L--,ee--)if(Et[L]!==Qt[ee]){if(L!==1||ee!==1)do if(L--,ee--,0>ee||Et[L]!==Qt[ee]){var vn=`
`+Et[L].replace(" at new "," at ");return m.displayName&&vn.includes("<anonymous>")&&(vn=vn.replace("<anonymous>",m.displayName)),vn}while(1<=L&&0<=ee);break}}}finally{rr=!1,Error.prepareStackTrace=A}return(A=m?m.displayName||m.name:"")?Er(A):""}function ii(m){switch(m.tag){case 26:case 27:case 5:return Er(m.type);case 16:return Er("Lazy");case 13:return Er("Suspense");case 19:return Er("SuspenseList");case 0:case 15:return Lr(m.type,!1);case 11:return Lr(m.type.render,!1);case 1:return Lr(m.type,!0);case 31:return Er("Activity");default:return""}}function da(m){try{var S="";do S+=ii(m),m=m.return;while(m);return S}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Mr(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function si(m){var S=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(S==="checkbox"||S==="radio")}function Tr(m){var S=si(m)?"checked":"value",A=Object.getOwnPropertyDescriptor(m.constructor.prototype,S),L=""+m[S];if(!m.hasOwnProperty(S)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var ee=A.get,fe=A.set;return Object.defineProperty(m,S,{configurable:!0,get:function(){return ee.call(this)},set:function(He){L=""+He,fe.call(this,He)}}),Object.defineProperty(m,S,{enumerable:A.enumerable}),{getValue:function(){return L},setValue:function(He){L=""+He},stopTracking:function(){m._valueTracker=null,delete m[S]}}}}function Dr(m){m._valueTracker||(m._valueTracker=Tr(m))}function Cn(m){if(!m)return!1;var S=m._valueTracker;if(!S)return!0;var A=S.getValue(),L="";return m&&(L=si(m)?m.checked?"true":"false":m.value),m=L,m!==A?(S.setValue(m),!0):!1}function jr(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var Uo=/[\n"\\]/g;function cs(m){return m.replace(Uo,function(S){return"\\"+S.charCodeAt(0).toString(16)+" "})}function Bo(m,S,A,L,ee,fe,He,Qe){m.name="",He!=null&&typeof He!="function"&&typeof He!="symbol"&&typeof He!="boolean"?m.type=He:m.removeAttribute("type"),S!=null?He==="number"?(S===0&&m.value===""||m.value!=S)&&(m.value=""+Mr(S)):m.value!==""+Mr(S)&&(m.value=""+Mr(S)):He!=="submit"&&He!=="reset"||m.removeAttribute("value"),S!=null?Xn(m,He,Mr(S)):A!=null?Xn(m,He,Mr(A)):L!=null&&m.removeAttribute("value"),ee==null&&fe!=null&&(m.defaultChecked=!!fe),ee!=null&&(m.checked=ee&&typeof ee!="function"&&typeof ee!="symbol"),Qe!=null&&typeof Qe!="function"&&typeof Qe!="symbol"&&typeof Qe!="boolean"?m.name=""+Mr(Qe):m.removeAttribute("name")}function us(m,S,A,L,ee,fe,He,Qe){if(fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"&&(m.type=fe),S!=null||A!=null){if(!(fe!=="submit"&&fe!=="reset"||S!=null))return;A=A!=null?""+Mr(A):"",S=S!=null?""+Mr(S):A,Qe||S===m.value||(m.value=S),m.defaultValue=S}L=L??ee,L=typeof L!="function"&&typeof L!="symbol"&&!!L,m.checked=Qe?m.checked:!!L,m.defaultChecked=!!L,He!=null&&typeof He!="function"&&typeof He!="symbol"&&typeof He!="boolean"&&(m.name=He)}function Xn(m,S,A){S==="number"&&jr(m.ownerDocument)===m||m.defaultValue===""+A||(m.defaultValue=""+A)}function ei(m,S,A,L){if(m=m.options,S){S={};for(var ee=0;ee<A.length;ee++)S["$"+A[ee]]=!0;for(A=0;A<m.length;A++)ee=S.hasOwnProperty("$"+m[A].value),m[A].selected!==ee&&(m[A].selected=ee),ee&&L&&(m[A].defaultSelected=!0)}else{for(A=""+Mr(A),S=null,ee=0;ee<m.length;ee++){if(m[ee].value===A){m[ee].selected=!0,L&&(m[ee].defaultSelected=!0);return}S!==null||m[ee].disabled||(S=m[ee])}S!==null&&(S.selected=!0)}}function ur(m,S,A){if(S!=null&&(S=""+Mr(S),S!==m.value&&(m.value=S),A==null)){m.defaultValue!==S&&(m.defaultValue=S);return}m.defaultValue=A!=null?""+Mr(A):""}function zs(m,S,A,L){if(S==null){if(L!=null){if(A!=null)throw Error(r(92));if(Q(L)){if(1<L.length)throw Error(r(93));L=L[0]}A=L}A==null&&(A=""),S=A}A=Mr(S),m.defaultValue=A,L=m.textContent,L===A&&L!==""&&L!==null&&(m.value=L)}function So(m,S){if(S){var A=m.firstChild;if(A&&A===m.lastChild&&A.nodeType===3){A.nodeValue=S;return}}m.textContent=S}var pa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ma(m,S,A){var L=S.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?L?m.setProperty(S,""):S==="float"?m.cssFloat="":m[S]="":L?m.setProperty(S,A):typeof A!="number"||A===0||pa.has(S)?S==="float"?m.cssFloat=A:m[S]=(""+A).trim():m[S]=A+"px"}function zh(m,S,A){if(S!=null&&typeof S!="object")throw Error(r(62));if(m=m.style,A!=null){for(var L in A)!A.hasOwnProperty(L)||S!=null&&S.hasOwnProperty(L)||(L.indexOf("--")===0?m.setProperty(L,""):L==="float"?m.cssFloat="":m[L]="");for(var ee in S)L=S[ee],S.hasOwnProperty(ee)&&A[ee]!==L&&ma(m,ee,L)}else for(var fe in S)S.hasOwnProperty(fe)&&ma(m,fe,S[fe])}function op(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rh(m){return Yp.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var wl=null;function cc(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Fo=null,il=null;function Xp(m){var S=gi(m);if(S&&(m=S.stateNode)){var A=m[Yt]||null;e:switch(m=S.stateNode,S.type){case"input":if(Bo(m,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),S=A.name,A.type==="radio"&&S!=null){for(A=m;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+cs(""+S)+'"][type="radio"]'),S=0;S<A.length;S++){var L=A[S];if(L!==m&&L.form===m.form){var ee=L[Yt]||null;if(!ee)throw Error(r(90));Bo(L,ee.value,ee.defaultValue,ee.defaultValue,ee.checked,ee.defaultChecked,ee.type,ee.name)}}for(S=0;S<A.length;S++)L=A[S],L.form===m.form&&Cn(L)}break e;case"textarea":ur(m,A.value,A.defaultValue);break e;case"select":S=A.value,S!=null&&ei(m,!!A.multiple,S,!1)}}}var Ac=!1;function Wc(m,S,A){if(Ac)return m(S,A);Ac=!0;try{var L=m(S);return L}finally{if(Ac=!1,(Fo!==null||il!==null)&&(ms(),Fo&&(S=Fo,m=il,il=Fo=null,Xp(S),m)))for(S=0;S<m.length;S++)Xp(m[S])}}function Yu(m,S){var A=m.stateNode;if(A===null)return null;var L=A[Yt]||null;if(L===null)return null;A=L[S];e:switch(S){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(m=m.type,L=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!L;break e;default:m=!1}if(m)return null;if(A&&typeof A!="function")throw Error(r(231,S,typeof A));return A}var Yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xi=!1;if(Yi)try{var Cc={};Object.defineProperty(Cc,"passive",{get:function(){Xi=!0}}),window.addEventListener("test",Cc,Cc),window.removeEventListener("test",Cc,Cc)}catch{Xi=!1}var Ef=null,Jm=null,uc=null;function uo(){if(uc)return uc;var m,S=Jm,A=S.length,L,ee="value"in Ef?Ef.value:Ef.textContent,fe=ee.length;for(m=0;m<A&&S[m]===ee[m];m++);var He=A-m;for(L=1;L<=He&&S[A-L]===ee[fe-L];L++);return uc=ee.slice(m,1<L?1-L:void 0)}function Yc(m){var S=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&S===13&&(m=13)):m=S,m===10&&(m=13),32<=m||m===13?m:0}function Xc(){return!0}function ih(){return!1}function ga(m){function S(A,L,ee,fe,He){this._reactName=A,this._targetInst=ee,this.type=L,this.nativeEvent=fe,this.target=He,this.currentTarget=null;for(var Qe in m)m.hasOwnProperty(Qe)&&(A=m[Qe],this[Qe]=A?A(fe):fe[Qe]);return this.isDefaultPrevented=(fe.defaultPrevented!=null?fe.defaultPrevented:fe.returnValue===!1)?Xc:ih,this.isPropagationStopped=ih,this}return u(S.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=Xc)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=Xc)},persist:function(){},isPersistent:Xc}),S}var xf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sh=ga(xf),ah=u({},xf,{view:0,detail:0}),Qm=ga(ah),Xu,Tf,oh,zo=u({},ah,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cp,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==oh&&(oh&&m.type==="mousemove"?(Xu=m.screenX-oh.screenX,Tf=m.screenY-oh.screenY):Tf=Xu=0,oh=m),Xu)},movementY:function(m){return"movementY"in m?m.movementY:Tf}}),$l=ga(zo),Rd=u({},zo,{dataTransfer:0}),Kp=ga(Rd),sl=u({},ah,{relatedTarget:0}),eg=ga(sl),G_=u({},xf,{animationName:0,elapsedTime:0,pseudoElement:0}),$_=ga(G_),lp=u({},xf,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),jh=ga(lp),Hh=u({},xf,{data:0}),Ku=ga(Hh),Zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ys={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wa(m){var S=this.nativeEvent;return S.getModifierState?S.getModifierState(m):(m=ys[m])?!!S[m]:!1}function cp(){return wa}var ng=u({},ah,{key:function(m){if(m.key){var S=Zu[m.key]||m.key;if(S!=="Unidentified")return S}return m.type==="keypress"?(m=Yc(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?tg[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cp,charCode:function(m){return m.type==="keypress"?Yc(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?Yc(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),qh=ga(ng),rt=u({},zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tt=ga(rt),Rt=u({},ah,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cp}),tn=ga(Rt),wn=u({},xf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zn=ga(wn),Ci=u({},zo,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),al=ga(Ci),_r=u({},xf,{newState:0,oldState:0}),Eo=ga(_r),wf=[9,13,27,32],rs=Yi&&"CompositionEvent"in window,Mc=null;Yi&&"documentMode"in document&&(Mc=document.documentMode);var lh=Yi&&"TextEvent"in window&&!Mc,sr=Yi&&(!rs||Mc&&8<Mc&&11>=Mc),Oc=" ",Ia=!1;function vr(m,S){switch(m){case"keyup":return wf.indexOf(S.keyCode)!==-1;case"keydown":return S.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gr(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var ch=!1;function Rf(m,S){switch(m){case"compositionend":return Gr(S);case"keypress":return S.which!==32?null:(Ia=!0,Oc);case"textInput":return m=S.data,m===Oc&&Ia?null:m;default:return null}}function Q0(m,S){if(ch)return m==="compositionend"||!rs&&vr(m,S)?(m=uo(),uc=Jm=Ef=null,ch=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(S.ctrlKey||S.altKey||S.metaKey)||S.ctrlKey&&S.altKey){if(S.char&&1<S.char.length)return S.char;if(S.which)return String.fromCharCode(S.which)}return null;case"compositionend":return sr&&S.locale!=="ko"?null:S.data;default:return null}}var Wl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rg(m){var S=m&&m.nodeName&&m.nodeName.toLowerCase();return S==="input"?!!Wl[m.type]:S==="textarea"}function xo(m,S,A,L){Fo?il?il.push(L):il=[L]:Fo=L,S=U3(S,"onChange"),0<S.length&&(A=new sh("onChange","change",null,A,L),m.push({event:A,listeners:S}))}var jo=null,xu=null;function Zg(m){o$(m,0)}function Tu(m){var S=Ni(m);if(Cn(S))return m}function uh(m,S){if(m==="change")return S}var Zp=!1;if(Yi){var fh;if(Yi){var Af="oninput"in document;if(!Af){var Kc=document.createElement("div");Kc.setAttribute("oninput","return;"),Af=typeof Kc.oninput=="function"}fh=Af}else fh=!1;Zp=fh&&(!document.documentMode||9<document.documentMode)}function Vi(){jo&&(jo.detachEvent("onpropertychange",wu),xu=jo=null)}function wu(m){if(m.propertyName==="value"&&Tu(xu)){var S=[];xo(S,xu,m,cc(m)),Wc(Zg,S)}}function W_(m,S,A){m==="focusin"?(Vi(),jo=S,xu=A,jo.attachEvent("onpropertychange",wu)):m==="focusout"&&Vi()}function Y_(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return Tu(xu)}function ig(m,S){if(m==="click")return Tu(S)}function kc(m,S){if(m==="input"||m==="change")return Tu(S)}function Ad(m,S){return m===S&&(m!==0||1/m===1/S)||m!==m&&S!==S}var fo=typeof Object.is=="function"?Object.is:Ad;function Cf(m,S){if(fo(m,S))return!0;if(typeof m!="object"||m===null||typeof S!="object"||S===null)return!1;var A=Object.keys(m),L=Object.keys(S);if(A.length!==L.length)return!1;for(L=0;L<A.length;L++){var ee=A[L];if(!at.call(S,ee)||!fo(m[ee],S[ee]))return!1}return!0}function Yl(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function sg(m,S){var A=Yl(m);m=0;for(var L;A;){if(A.nodeType===3){if(L=m+A.textContent.length,m<=S&&L>=S)return{node:A,offset:S-m};m=L}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=Yl(A)}}function Jg(m,S){return m&&S?m===S?!0:m&&m.nodeType===3?!1:S&&S.nodeType===3?Jg(m,S.parentNode):"contains"in m?m.contains(S):m.compareDocumentPosition?!!(m.compareDocumentPosition(S)&16):!1:!1}function vi(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var S=jr(m.document);S instanceof m.HTMLIFrameElement;){try{var A=typeof S.contentWindow.location.href=="string"}catch{A=!1}if(A)m=S.contentWindow;else break;S=jr(m.document)}return S}function Ki(m){var S=m&&m.nodeName&&m.nodeName.toLowerCase();return S&&(S==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||S==="textarea"||m.contentEditable==="true")}var ag=Yi&&"documentMode"in document&&11>=document.documentMode,hh=null,up=null,Fn=null,js=!1;function Mf(m,S,A){var L=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;js||hh==null||hh!==jr(L)||(L=hh,"selectionStart"in L&&Ki(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),Fn&&Cf(Fn,L)||(Fn=L,L=U3(up,"onSelect"),0<L.length&&(S=new sh("onSelect","select",null,S,A),m.push({event:S,listeners:L}),S.target=hh)))}function To(m,S){var A={};return A[m.toLowerCase()]=S.toLowerCase(),A["Webkit"+m]="webkit"+S,A["Moz"+m]="moz"+S,A}var Rl={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionrun:To("Transition","TransitionRun"),transitionstart:To("Transition","TransitionStart"),transitioncancel:To("Transition","TransitionCancel"),transitionend:To("Transition","TransitionEnd")},Ju={},Of={};Yi&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete Rl.animationend.animation,delete Rl.animationiteration.animation,delete Rl.animationstart.animation),"TransitionEvent"in window||delete Rl.transitionend.transition);function Ic(m){if(Ju[m])return Ju[m];if(!Rl[m])return m;var S=Rl[m],A;for(A in S)if(S.hasOwnProperty(A)&&A in Of)return Ju[m]=S[A];return m}var As=Ic("animationend"),Qg=Ic("animationiteration"),Ks=Ic("animationstart"),e_=Ic("transitionrun"),Al=Ic("transitionstart"),fp=Ic("transitioncancel"),Ho=Ic("transitionend"),fc=new Map,Fr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fr.push("scrollEnd");function ve(m,S){fc.set(m,S),ls(S,[m])}var hc=new WeakMap;function eo(m,S){if(typeof m=="object"&&m!==null){var A=hc.get(m);return A!==void 0?A:(S={value:m,source:S,stack:da(S)},hc.set(m,S),S)}return{value:m,source:S,stack:da(S)}}var Mi=[],kn=0,ho=0;function po(){for(var m=kn,S=ho=kn=0;S<m;){var A=Mi[S];Mi[S++]=null;var L=Mi[S];Mi[S++]=null;var ee=Mi[S];Mi[S++]=null;var fe=Mi[S];if(Mi[S++]=null,L!==null&&ee!==null){var He=L.pending;He===null?ee.next=ee:(ee.next=He.next,He.next=ee),L.pending=ee}fe!==0&&og(A,ee,fe)}}function Zi(m,S,A,L){Mi[kn++]=m,Mi[kn++]=S,Mi[kn++]=A,Mi[kn++]=L,ho|=L,m.lanes|=L,m=m.alternate,m!==null&&(m.lanes|=L)}function hn(m,S,A,L){return Zi(m,S,A,L),kf(m)}function Ti(m,S){return Zi(m,null,null,S),kf(m)}function og(m,S,A){m.lanes|=A;var L=m.alternate;L!==null&&(L.lanes|=A);for(var ee=!1,fe=m.return;fe!==null;)fe.childLanes|=A,L=fe.alternate,L!==null&&(L.childLanes|=A),fe.tag===22&&(m=fe.stateNode,m===null||m._visibility&1||(ee=!0)),m=fe,fe=fe.return;return m.tag===3?(fe=m.stateNode,ee&&S!==null&&(ee=31-Ut(A),m=fe.hiddenUpdates,L=m[ee],L===null?m[ee]=[S]:L.push(S),S.lane=A|536870912),fe):null}function kf(m){if(50<li)throw li=0,Fi=null,Error(r(185));for(var S=m.return;S!==null;)m=S,S=m.return;return m.tag===3?m.stateNode:null}var If={};function lg(m,S,A,L){this.tag=m,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=S,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wo(m,S,A,L){return new lg(m,S,A,L)}function Nc(m){return m=m.prototype,!(!m||!m.isReactComponent)}function _a(m,S){var A=m.alternate;return A===null?(A=wo(m.tag,S,m.key,m.mode),A.elementType=m.elementType,A.type=m.type,A.stateNode=m.stateNode,A.alternate=m,m.alternate=A):(A.pendingProps=S,A.type=m.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=m.flags&65011712,A.childLanes=m.childLanes,A.lanes=m.lanes,A.child=m.child,A.memoizedProps=m.memoizedProps,A.memoizedState=m.memoizedState,A.updateQueue=m.updateQueue,S=m.dependencies,A.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext},A.sibling=m.sibling,A.index=m.index,A.ref=m.ref,A.refCleanup=m.refCleanup,A}function hp(m,S){m.flags&=65011714;var A=m.alternate;return A===null?(m.childLanes=0,m.lanes=S,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=A.childLanes,m.lanes=A.lanes,m.child=A.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=A.memoizedProps,m.memoizedState=A.memoizedState,m.updateQueue=A.updateQueue,m.type=A.type,S=A.dependencies,m.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext}),m}function Ro(m,S,A,L,ee,fe){var He=0;if(L=m,typeof m=="function")Nc(m)&&(He=1);else if(typeof m=="string")He=DEe(m,A,ce.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case V:return m=wo(31,A,S,ee),m.elementType=V,m.lanes=fe,m;case p:return Na(A.children,ee,fe,S);case _:He=8,ee|=24;break;case y:return m=wo(12,A,S,ee|2),m.elementType=y,m.lanes=fe,m;case k:return m=wo(13,A,S,ee),m.elementType=k,m.lanes=fe,m;case N:return m=wo(19,A,S,ee),m.elementType=N,m.lanes=fe,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case v:case E:He=10;break e;case x:He=9;break e;case M:He=11;break e;case I:He=14;break e;case D:He=16,L=null;break e}He=29,A=Error(r(130,m===null?"null":typeof m,"")),L=null}return S=wo(He,A,S,ee),S.elementType=m,S.type=L,S.lanes=fe,S}function Na(m,S,A,L){return m=wo(7,m,L,S),m.lanes=A,m}function dh(m,S,A){return m=wo(6,m,null,S),m.lanes=A,m}function Cl(m,S,A){return S=wo(4,m.children!==null?m.children:[],m.key,S),S.lanes=A,S.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},S}var Hs=[],Ml=0,Vh=null,Pc=0,fs=[],dc=0,Gh=null,Xl=1,Ru="";function ai(m,S){Hs[Ml++]=Pc,Hs[Ml++]=Vh,Vh=m,Pc=S}function $h(m,S,A){fs[dc++]=Xl,fs[dc++]=Ru,fs[dc++]=Gh,Gh=m;var L=Xl;m=Ru;var ee=32-Ut(L)-1;L&=~(1<<ee),A+=1;var fe=32-Ut(S)+ee;if(30<fe){var He=ee-ee%5;fe=(L&(1<<He)-1).toString(32),L>>=He,ee-=He,Xl=1<<32-Ut(S)+ee|A<<ee|L,Ru=fe+m}else Xl=1<<fe|A<<ee|L,Ru=m}function Jp(m){m.return!==null&&(ai(m,1),$h(m,1,0))}function Zs(m){for(;m===Vh;)Vh=Hs[--Ml],Hs[Ml]=null,Pc=Hs[--Ml],Hs[Ml]=null;for(;m===Gh;)Gh=fs[--dc],fs[dc]=null,Ru=fs[--dc],fs[dc]=null,Xl=fs[--dc],fs[dc]=null}var Ao=null,Cs=null,ti=!1,Dc=null,yi=!1,Wh=Error(r(519));function Yh(m){var S=Error(r(418,""));throw Zc(eo(S,m)),Wh}function X_(m){var S=m.stateNode,A=m.type,L=m.memoizedProps;switch(S[Bt]=m,S[Yt]=L,A){case"dialog":ta("cancel",S),ta("close",S);break;case"iframe":case"object":case"embed":ta("load",S);break;case"video":case"audio":for(A=0;A<ER.length;A++)ta(ER[A],S);break;case"source":ta("error",S);break;case"img":case"image":case"link":ta("error",S),ta("load",S);break;case"details":ta("toggle",S);break;case"input":ta("invalid",S),us(S,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),Dr(S);break;case"select":ta("invalid",S);break;case"textarea":ta("invalid",S),zs(S,L.value,L.defaultValue,L.children),Dr(S)}A=L.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||S.textContent===""+A||L.suppressHydrationWarning===!0||f$(S.textContent,A)?(L.popover!=null&&(ta("beforetoggle",S),ta("toggle",S)),L.onScroll!=null&&ta("scroll",S),L.onScrollEnd!=null&&ta("scrollend",S),L.onClick!=null&&(S.onclick=B3),S=!0):S=!1,S||Yh(m)}function Cd(m){for(Ao=m.return;Ao;)switch(Ao.tag){case 5:case 13:yi=!1;return;case 27:case 3:yi=!0;return;default:Ao=Ao.return}}function ol(m){if(m!==Ao)return!1;if(!ti)return Cd(m),ti=!0,!1;var S=m.tag,A;if((A=S!==3&&S!==27)&&((A=S===5)&&(A=m.type,A=!(A!=="form"&&A!=="button")||Y6(m.type,m.memoizedProps)),A=!A),A&&Cs&&Yh(m),Cd(m),S===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,S=0;m;){if(m.nodeType===8)if(A=m.data,A==="/$"){if(S===0){Cs=l_(m.nextSibling);break e}S--}else A!=="$"&&A!=="$!"&&A!=="$?"||S++;m=m.nextSibling}Cs=null}}else S===27?(S=Cs,Ib(m.type)?(m=J6,J6=null,Cs=m):Cs=S):Cs=Ao?l_(m.stateNode.nextSibling):null;return!0}function Jn(){Cs=Ao=null,ti=!1}function Pi(){var m=Dc;return m!==null&&(Ft===null?Ft=m:Ft.push.apply(Ft,m),Dc=null),m}function Zc(m){Dc===null?Dc=[m]:Dc.push(m)}var mo=K(null),Nf=null,Jc=null;function ph(m,S,A){le(mo,S._currentValue),S._currentValue=A}function Qc(m){m._currentValue=mo.current,ne(mo)}function Qp(m,S,A){for(;m!==null;){var L=m.alternate;if((m.childLanes&S)!==S?(m.childLanes|=S,L!==null&&(L.childLanes|=S)):L!==null&&(L.childLanes&S)!==S&&(L.childLanes|=S),m===A)break;m=m.return}}function Md(m,S,A,L){var ee=m.child;for(ee!==null&&(ee.return=m);ee!==null;){var fe=ee.dependencies;if(fe!==null){var He=ee.child;fe=fe.firstContext;e:for(;fe!==null;){var Qe=fe;fe=ee;for(var Et=0;Et<S.length;Et++)if(Qe.context===S[Et]){fe.lanes|=A,Qe=fe.alternate,Qe!==null&&(Qe.lanes|=A),Qp(fe.return,A,m),L||(He=null);break e}fe=Qe.next}}else if(ee.tag===18){if(He=ee.return,He===null)throw Error(r(341));He.lanes|=A,fe=He.alternate,fe!==null&&(fe.lanes|=A),Qp(He,A,m),He=null}else He=ee.child;if(He!==null)He.return=ee;else for(He=ee;He!==null;){if(He===m){He=null;break}if(ee=He.sibling,ee!==null){ee.return=He.return,He=ee;break}He=He.return}ee=He}}function Co(m,S,A,L){m=null;for(var ee=S,fe=!1;ee!==null;){if(!fe){if((ee.flags&524288)!==0)fe=!0;else if((ee.flags&262144)!==0)break}if(ee.tag===10){var He=ee.alternate;if(He===null)throw Error(r(387));if(He=He.memoizedProps,He!==null){var Qe=ee.type;fo(ee.pendingProps.value,He.value)||(m!==null?m.push(Qe):m=[Qe])}}else if(ee===qe.current){if(He=ee.alternate,He===null)throw Error(r(387));He.memoizedState.memoizedState!==ee.memoizedState.memoizedState&&(m!==null?m.push(CR):m=[CR])}ee=ee.return}m!==null&&Md(S,m,A,L),S.flags|=262144}function Xh(m){for(m=m.firstContext;m!==null;){if(!fo(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Qu(m){Nf=m,Jc=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Pa(m){return dp(Nf,m)}function Kh(m,S){return Nf===null&&Qu(m),dp(m,S)}function dp(m,S){var A=S._currentValue;if(S={context:S,memoizedValue:A,next:null},Jc===null){if(m===null)throw Error(r(308));Jc=S,m.dependencies={lanes:0,firstContext:S},m.flags|=524288}else Jc=Jc.next=S;return A}var ef=typeof AbortController<"u"?AbortController:function(){var m=[],S=this.signal={aborted:!1,addEventListener:function(A,L){m.push(L)}};this.abort=function(){S.aborted=!0,m.forEach(function(A){return A()})}},mh=n.unstable_scheduleCallback,Ur=n.unstable_NormalPriority,yr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ll(){return{controller:new ef,data:new Map,refCount:0}}function Kl(m){m.refCount--,m.refCount===0&&mh(Ur,function(){m.controller.abort()})}var wi=null,pp=0,zr=0,Ol=null;function Da(m,S){if(wi===null){var A=wi=[];pp=0,zr=F6(),Ol={status:"pending",value:void 0,then:function(L){A.push(L)}}}return pp++,S.then(Od,Od),S}function Od(){if(--pp===0&&wi!==null){Ol!==null&&(Ol.status="fulfilled");var m=wi;wi=null,zr=0,Ol=null;for(var S=0;S<m.length;S++)(0,m[S])()}}function mp(m,S){var A=[],L={status:"pending",value:null,reason:null,then:function(ee){A.push(ee)}};return m.then(function(){L.status="fulfilled",L.value=S;for(var ee=0;ee<A.length;ee++)(0,A[ee])(S)},function(ee){for(L.status="rejected",L.reason=ee,ee=0;ee<A.length;ee++)(0,A[ee])(void 0)}),L}var cl=W.S;W.S=function(m,S){typeof S=="object"&&S!==null&&typeof S.then=="function"&&Da(m,S),cl!==null&&cl(m,S)};var Zl=K(null);function Ha(){var m=Zl.current;return m!==null?m:F.pooledCache}function ia(m,S){S===null?le(Zl,Zl.current):le(Zl,S.pool)}function Lc(){var m=Ha();return m===null?null:{parent:yr._currentValue,pool:m}}var kd=Error(r(460)),Au=Error(r(474)),to=Error(r(542)),tf={then:function(){}};function Uc(m){return m=m.status,m==="fulfilled"||m==="rejected"}function nf(){}function Cu(m,S,A){switch(A=m[A],A===void 0?m.push(S):A!==S&&(S.then(nf,nf),S=A),S.status){case"fulfilled":return S.value;case"rejected":throw m=S.reason,sf(m),m;default:if(typeof S.status=="string")S.then(nf,nf);else{if(m=F,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=S,m.status="pending",m.then(function(L){if(S.status==="pending"){var ee=S;ee.status="fulfilled",ee.value=L}},function(L){if(S.status==="pending"){var ee=S;ee.status="rejected",ee.reason=L}})}switch(S.status){case"fulfilled":return S.value;case"rejected":throw m=S.reason,sf(m),m}throw Mo=S,kd}}var Mo=null;function rf(){if(Mo===null)throw Error(r(459));var m=Mo;return Mo=null,m}function sf(m){if(m===kd||m===to)throw Error(r(483))}var Oo=!1;function em(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hr(m,S){m=m.updateQueue,S.updateQueue===m&&(S.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function Mu(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Pf(m,S,A){var L=m.updateQueue;if(L===null)return null;if(L=L.shared,(O&2)!==0){var ee=L.pending;return ee===null?S.next=S:(S.next=ee.next,ee.next=S),L.pending=S,S=kf(m),og(m,null,A),S}return Zi(m,L,S,A),kf(m)}function Zh(m,S,A){if(S=S.updateQueue,S!==null&&(S=S.shared,(A&4194048)!==0)){var L=S.lanes;L&=m.pendingLanes,A|=L,S.lanes=A,ht(m,A)}}function Jh(m,S){var A=m.updateQueue,L=m.alternate;if(L!==null&&(L=L.updateQueue,A===L)){var ee=null,fe=null;if(A=A.firstBaseUpdate,A!==null){do{var He={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};fe===null?ee=fe=He:fe=fe.next=He,A=A.next}while(A!==null);fe===null?ee=fe=S:fe=fe.next=S}else ee=fe=S;A={baseState:L.baseState,firstBaseUpdate:ee,lastBaseUpdate:fe,shared:L.shared,callbacks:L.callbacks},m.updateQueue=A;return}m=A.lastBaseUpdate,m===null?A.firstBaseUpdate=S:m.next=S,A.lastBaseUpdate=S}var kl=!1;function qs(){if(kl){var m=Ol;if(m!==null)throw m}}function Il(m,S,A,L){kl=!1;var ee=m.updateQueue;Oo=!1;var fe=ee.firstBaseUpdate,He=ee.lastBaseUpdate,Qe=ee.shared.pending;if(Qe!==null){ee.shared.pending=null;var Et=Qe,Qt=Et.next;Et.next=null,He===null?fe=Qt:He.next=Qt,He=Et;var vn=m.alternate;vn!==null&&(vn=vn.updateQueue,Qe=vn.lastBaseUpdate,Qe!==He&&(Qe===null?vn.firstBaseUpdate=Qt:Qe.next=Qt,vn.lastBaseUpdate=Et))}if(fe!==null){var xn=ee.baseState;He=0,vn=Qt=Et=null,Qe=fe;do{var rn=Qe.lane&-536870913,on=rn!==Qe.lane;if(on?(pe&rn)===rn:(L&rn)===rn){rn!==0&&rn===zr&&(kl=!0),vn!==null&&(vn=vn.next={lane:0,tag:Qe.tag,payload:Qe.payload,callback:null,next:null});e:{var ki=m,di=Qe;rn=S;var Ko=A;switch(di.tag){case 1:if(ki=di.payload,typeof ki=="function"){xn=ki.call(Ko,xn,rn);break e}xn=ki;break e;case 3:ki.flags=ki.flags&-65537|128;case 0:if(ki=di.payload,rn=typeof ki=="function"?ki.call(Ko,xn,rn):ki,rn==null)break e;xn=u({},xn,rn);break e;case 2:Oo=!0}}rn=Qe.callback,rn!==null&&(m.flags|=64,on&&(m.flags|=8192),on=ee.callbacks,on===null?ee.callbacks=[rn]:on.push(rn))}else on={lane:rn,tag:Qe.tag,payload:Qe.payload,callback:Qe.callback,next:null},vn===null?(Qt=vn=on,Et=xn):vn=vn.next=on,He|=rn;if(Qe=Qe.next,Qe===null){if(Qe=ee.shared.pending,Qe===null)break;on=Qe,Qe=on.next,on.next=null,ee.lastBaseUpdate=on,ee.shared.pending=null}}while(!0);vn===null&&(Et=xn),ee.baseState=Et,ee.firstBaseUpdate=Qt,ee.lastBaseUpdate=vn,fe===null&&(ee.shared.lanes=0),Dt|=He,m.lanes=He,m.memoizedState=xn}}function eu(m,S){if(typeof m!="function")throw Error(r(191,m));m.call(S)}function Id(m,S){var A=m.callbacks;if(A!==null)for(m.callbacks=null,m=0;m<A.length;m++)eu(A[m],S)}var Nd=K(null),tm=K(0);function Qh(m,S){m=dt,le(tm,m),le(Nd,S),dt=m|S.baseLanes}function Ou(){le(tm,dt),le(Nd,Nd.current)}function ul(){dt=tm.current,ne(Nd),ne(tm)}var af=0,Zr=null,hs=null,qa=null,ed=!1,ku=!1,fl=!1,no=0,pc=0,qo=null,e0=0;function La(){throw Error(r(321))}function Js(m,S){if(S===null)return!1;for(var A=0;A<S.length&&A<m.length;A++)if(!fo(m[A],S[A]))return!1;return!0}function ro(m,S,A,L,ee,fe){return af=fe,Zr=S,S.memoizedState=null,S.updateQueue=null,S.lanes=0,W.H=m===null||m.memoizedState===null?yp:s_,fl=!1,fe=A(L,ee),fl=!1,ku&&(fe=nd(S,A,L,ee)),td(m),fe}function td(m){W.H=sd;var S=hs!==null&&hs.next!==null;if(af=0,qa=hs=Zr=null,ed=!1,pc=0,qo=null,S)throw Error(r(300));m===null||Ga||(m=m.dependencies,m!==null&&Xh(m)&&(Ga=!0))}function nd(m,S,A,L){Zr=m;var ee=0;do{if(ku&&(qo=null),pc=0,ku=!1,25<=ee)throw Error(r(301));if(ee+=1,qa=hs=null,m.updateQueue!=null){var fe=m.updateQueue;fe.lastEffect=null,fe.events=null,fe.stores=null,fe.memoCache!=null&&(fe.memoCache.index=0)}W.H=Q_,fe=S(A,L)}while(ku);return fe}function gp(){var m=W.H,S=m.useState()[0];return S=typeof S.then=="function"?dr(S):S,m=m.useState()[0],(hs!==null?hs.memoizedState:null)!==m&&(Zr.flags|=1024),S}function hl(){var m=no!==0;return no=0,m}function Jl(m,S,A){S.updateQueue=m.updateQueue,S.flags&=-2053,m.lanes&=~A}function _p(m){if(ed){for(m=m.memoizedState;m!==null;){var S=m.queue;S!==null&&(S.pending=null),m=m.next}ed=!1}af=0,qa=hs=Zr=null,ku=!1,pc=no=0,qo=null}function dl(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qa===null?Zr.memoizedState=qa=m:qa=qa.next=m,qa}function sa(){if(hs===null){var m=Zr.alternate;m=m!==null?m.memoizedState:null}else m=hs.next;var S=qa===null?Zr.memoizedState:qa.next;if(S!==null)qa=S,hs=m;else{if(m===null)throw Zr.alternate===null?Error(r(467)):Error(r(310));hs=m,m={memoizedState:hs.memoizedState,baseState:hs.baseState,baseQueue:hs.baseQueue,queue:hs.queue,next:null},qa===null?Zr.memoizedState=qa=m:qa=qa.next=m}return qa}function mc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dr(m){var S=pc;return pc+=1,qo===null&&(qo=[]),m=Cu(qo,m,S),S=Zr,(qa===null?S.memoizedState:qa.next)===null&&(S=S.alternate,W.H=S===null||S.memoizedState===null?yp:s_),m}function br(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return dr(m);if(m.$$typeof===E)return Pa(m)}throw Error(r(438,String(m)))}function rd(m){var S=null,A=Zr.updateQueue;if(A!==null&&(S=A.memoCache),S==null){var L=Zr.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(S={data:L.data.map(function(ee){return ee.slice()}),index:0})))}if(S==null&&(S={data:[],index:0}),A===null&&(A=mc(),Zr.updateQueue=A),A.memoCache=S,A=S.data[S.index],A===void 0)for(A=S.data[S.index]=Array(m),L=0;L<m;L++)A[L]=G;return S.index++,A}function go(m,S){return typeof S=="function"?S(m):S}function Ql(m){var S=sa();return vp(S,hs,m)}function vp(m,S,A){var L=m.queue;if(L===null)throw Error(r(311));L.lastRenderedReducer=A;var ee=m.baseQueue,fe=L.pending;if(fe!==null){if(ee!==null){var He=ee.next;ee.next=fe.next,fe.next=He}S.baseQueue=ee=fe,L.pending=null}if(fe=m.baseState,ee===null)m.memoizedState=fe;else{S=ee.next;var Qe=He=null,Et=null,Qt=S,vn=!1;do{var xn=Qt.lane&-536870913;if(xn!==Qt.lane?(pe&xn)===xn:(af&xn)===xn){var rn=Qt.revertLane;if(rn===0)Et!==null&&(Et=Et.next={lane:0,revertLane:0,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null}),xn===zr&&(vn=!0);else if((af&rn)===rn){Qt=Qt.next,rn===zr&&(vn=!0);continue}else xn={lane:0,revertLane:Qt.revertLane,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},Et===null?(Qe=Et=xn,He=fe):Et=Et.next=xn,Zr.lanes|=rn,Dt|=rn;xn=Qt.action,fl&&A(fe,xn),fe=Qt.hasEagerState?Qt.eagerState:A(fe,xn)}else rn={lane:xn,revertLane:Qt.revertLane,action:Qt.action,hasEagerState:Qt.hasEagerState,eagerState:Qt.eagerState,next:null},Et===null?(Qe=Et=rn,He=fe):Et=Et.next=rn,Zr.lanes|=xn,Dt|=xn;Qt=Qt.next}while(Qt!==null&&Qt!==S);if(Et===null?He=fe:Et.next=Qe,!fo(fe,m.memoizedState)&&(Ga=!0,vn&&(A=Ol,A!==null)))throw A;m.memoizedState=fe,m.baseState=He,m.baseQueue=Et,L.lastRenderedState=fe}return ee===null&&(L.lanes=0),[m.memoizedState,L.dispatch]}function Vo(m){var S=sa(),A=S.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=m;var L=A.dispatch,ee=A.pending,fe=S.memoizedState;if(ee!==null){A.pending=null;var He=ee=ee.next;do fe=m(fe,He.action),He=He.next;while(He!==ee);fo(fe,S.memoizedState)||(Ga=!0),S.memoizedState=fe,S.baseQueue===null&&(S.baseState=fe),A.lastRenderedState=fe}return[fe,L]}function pl(m,S,A){var L=Zr,ee=sa(),fe=ti;if(fe){if(A===void 0)throw Error(r(407));A=A()}else A=S();var He=!fo((hs||ee).memoizedState,A);He&&(ee.memoizedState=A,Ga=!0),ee=ee.queue;var Qe=of.bind(null,L,ee,m);if(Bc(2048,8,Qe,[m]),ee.getSnapshot!==S||He||qa!==null&&qa.memoizedState.tag&1){if(L.flags|=2048,Df(9,Ud(),t0.bind(null,L,ee,A,S),null),F===null)throw Error(r(349));fe||(af&124)!==0||id(L,S,A)}return A}function id(m,S,A){m.flags|=16384,m={getSnapshot:S,value:A},S=Zr.updateQueue,S===null?(S=mc(),Zr.updateQueue=S,S.stores=[m]):(A=S.stores,A===null?S.stores=[m]:A.push(m))}function t0(m,S,A,L){S.value=A,S.getSnapshot=L,Ua(S)&&Go(m)}function of(m,S,A){return A(function(){Ua(S)&&Go(m)})}function Ua(m){var S=m.getSnapshot;m=m.value;try{var A=S();return!fo(m,A)}catch{return!0}}function Go(m){var S=Ti(m,2);S!==null&&ci(S,m,2)}function Pd(m){var S=dl();if(typeof m=="function"){var A=m;if(m=A(),fl){Ot(!0);try{A()}finally{Ot(!1)}}}return S.memoizedState=S.baseState=m,S.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:m},S}function cg(m,S,A,L){return m.baseState=A,vp(m,hs,typeof L=="function"?L:go)}function nm(m,S,A,L,ee){if(f0(m))throw Error(r(485));if(m=S.action,m!==null){var fe={payload:ee,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(He){fe.listeners.push(He)}};W.T!==null?A(!0):fe.isTransition=!1,L(fe),A=S.pending,A===null?(fe.next=S.pending=fe,Va(S,fe)):(fe.next=A.next,S.pending=A.next=fe)}}function Va(m,S){var A=S.action,L=S.payload,ee=m.state;if(S.isTransition){var fe=W.T,He={};W.T=He;try{var Qe=A(ee,L),Et=W.S;Et!==null&&Et(He,Qe),rm(m,S,Qe)}catch(Qt){im(m,S,Qt)}finally{W.T=fe}}else try{fe=A(ee,L),rm(m,S,fe)}catch(Qt){im(m,S,Qt)}}function rm(m,S,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(L){n0(m,S,L)},function(L){return im(m,S,L)}):n0(m,S,A)}function n0(m,S,A){S.status="fulfilled",S.value=A,sm(S),m.state=A,S=m.pending,S!==null&&(A=S.next,A===S?m.pending=null:(A=A.next,S.next=A,Va(m,A)))}function im(m,S,A){var L=m.pending;if(m.pending=null,L!==null){L=L.next;do S.status="rejected",S.reason=A,sm(S),S=S.next;while(S!==L)}m.action=null}function sm(m){m=m.listeners;for(var S=0;S<m.length;S++)(0,m[S])()}function Dd(m,S){return S}function Ld(m,S){if(ti){var A=F.formState;if(A!==null){e:{var L=Zr;if(ti){if(Cs){t:{for(var ee=Cs,fe=yi;ee.nodeType!==8;){if(!fe){ee=null;break t}if(ee=l_(ee.nextSibling),ee===null){ee=null;break t}}fe=ee.data,ee=fe==="F!"||fe==="F"?ee:null}if(ee){Cs=l_(ee.nextSibling),L=ee.data==="F!";break e}}Yh(L)}L=!1}L&&(S=A[0])}}return A=dl(),A.memoizedState=A.baseState=S,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Dd,lastRenderedState:S},A.queue=L,A=Z_.bind(null,Zr,L),L.dispatch=A,L=Pd(!1),fe=mg.bind(null,Zr,!1,L.queue),L=dl(),ee={state:S,dispatch:null,action:m,pending:null},L.queue=ee,A=nm.bind(null,Zr,ee,fe,A),ee.dispatch=A,L.memoizedState=m,[S,A,!1]}function Iu(m){var S=sa();return ug(S,hs,m)}function ug(m,S,A){if(S=vp(m,S,Dd)[0],m=Ql(go)[0],typeof S=="object"&&S!==null&&typeof S.then=="function")try{var L=dr(S)}catch(He){throw He===kd?to:He}else L=S;S=sa();var ee=S.queue,fe=ee.dispatch;return A!==S.memoizedState&&(Zr.flags|=2048,Df(9,Ud(),t_.bind(null,ee,A),null)),[L,fe,m]}function t_(m,S){m.action=S}function am(m){var S=sa(),A=hs;if(A!==null)return ug(S,A,m);sa(),S=S.memoizedState,A=sa();var L=A.queue.dispatch;return A.memoizedState=m,[S,L,!1]}function Df(m,S,A,L){return m={tag:m,create:A,deps:L,inst:S,next:null},S=Zr.updateQueue,S===null&&(S=mc(),Zr.updateQueue=S),A=S.lastEffect,A===null?S.lastEffect=m.next=m:(L=A.next,A.next=m,m.next=L,S.lastEffect=m),m}function Ud(){return{destroy:void 0,resource:void 0}}function Nu(){return sa().memoizedState}function ml(m,S,A,L){var ee=dl();L=L===void 0?null:L,Zr.flags|=m,ee.memoizedState=Df(1|S,Ud(),A,L)}function Bc(m,S,A,L){var ee=sa();L=L===void 0?null:L;var fe=ee.memoizedState.inst;hs!==null&&L!==null&&Js(L,hs.memoizedState.deps)?ee.memoizedState=Df(S,fe,A,L):(Zr.flags|=m,ee.memoizedState=Df(1|S,fe,A,L))}function om(m,S){ml(8390656,8,m,S)}function r0(m,S){Bc(2048,8,m,S)}function lm(m,S){return Bc(4,2,m,S)}function fg(m,S){return Bc(4,4,m,S)}function i0(m,S){if(typeof S=="function"){m=m();var A=S(m);return function(){typeof A=="function"?A():S(null)}}if(S!=null)return m=m(),S.current=m,function(){S.current=null}}function s0(m,S,A){A=A!=null?A.concat([m]):null,Bc(4,4,i0.bind(null,S,m),A)}function cm(){}function n_(m,S){var A=sa();S=S===void 0?null:S;var L=A.memoizedState;return S!==null&&Js(S,L[1])?L[0]:(A.memoizedState=[m,S],m)}function um(m,S){var A=sa();S=S===void 0?null:S;var L=A.memoizedState;if(S!==null&&Js(S,L[1]))return L[0];if(L=m(),fl){Ot(!0);try{m()}finally{Ot(!1)}}return A.memoizedState=[L,S],L}function a0(m,S,A){return A===void 0||(af&1073741824)!==0?m.memoizedState=S:(m.memoizedState=A,m=Ss(),Zr.lanes|=m,Dt|=m,A)}function Pu(m,S,A,L){return fo(A,S)?A:Nd.current!==null?(m=a0(m,A,L),fo(m,S)||(Ga=!0),m):(af&42)===0?(Ga=!0,m.memoizedState=A):(m=Ss(),Zr.lanes|=m,Dt|=m,S)}function ec(m,S,A,L,ee){var fe=q.p;q.p=fe!==0&&8>fe?fe:8;var He=W.T,Qe={};W.T=Qe,mg(m,!1,S,A);try{var Et=ee(),Qt=W.S;if(Qt!==null&&Qt(Qe,Et),Et!==null&&typeof Et=="object"&&typeof Et.then=="function"){var vn=mp(Et,L);pg(m,S,vn,Yr(m))}else pg(m,S,L,Yr(m))}catch(xn){pg(m,S,{then:function(){},status:"rejected",reason:xn},Yr())}finally{q.p=fe,W.T=He}}function hg(){}function dg(m,S,A,L){if(m.tag!==5)throw Error(r(476));var ee=o0(m).queue;ec(m,ee,S,Y,A===null?hg:function(){return l0(m),A(L)})}function o0(m){var S=m.memoizedState;if(S!==null)return S;S={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:Y},next:null};var A={};return S.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:A},next:null},m.memoizedState=S,m=m.alternate,m!==null&&(m.memoizedState=S),S}function l0(m){var S=o0(m).next.queue;pg(m,S,{},Yr())}function r_(){return Pa(CR)}function K_(){return sa().memoizedState}function c0(){return sa().memoizedState}function u0(m){for(var S=m.return;S!==null;){switch(S.tag){case 24:case 3:var A=Yr();m=Mu(A);var L=Pf(S,m,A);L!==null&&(ci(L,S,A),Zh(L,S,A)),S={cache:ll()},m.payload=S;return}S=S.return}}function i_(m,S,A){var L=Yr();A={lane:L,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},f0(m)?J_(S,A):(A=hn(m,S,A,L),A!==null&&(ci(A,m,L),tu(A,S,L)))}function Z_(m,S,A){var L=Yr();pg(m,S,A,L)}function pg(m,S,A,L){var ee={lane:L,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(f0(m))J_(S,ee);else{var fe=m.alternate;if(m.lanes===0&&(fe===null||fe.lanes===0)&&(fe=S.lastRenderedReducer,fe!==null))try{var He=S.lastRenderedState,Qe=fe(He,A);if(ee.hasEagerState=!0,ee.eagerState=Qe,fo(Qe,He))return Zi(m,S,ee,0),F===null&&po(),!1}catch{}finally{}if(A=hn(m,S,ee,L),A!==null)return ci(A,m,L),tu(A,S,L),!0}return!1}function mg(m,S,A,L){if(L={lane:2,revertLane:F6(),action:L,hasEagerState:!1,eagerState:null,next:null},f0(m)){if(S)throw Error(r(479))}else S=hn(m,A,L,2),S!==null&&ci(S,m,2)}function f0(m){var S=m.alternate;return m===Zr||S!==null&&S===Zr}function J_(m,S){ku=ed=!0;var A=m.pending;A===null?S.next=S:(S.next=A.next,A.next=S),m.pending=S}function tu(m,S,A){if((A&4194048)!==0){var L=S.lanes;L&=m.pendingLanes,A|=L,S.lanes=A,ht(m,A)}}var sd={readContext:Pa,use:br,useCallback:La,useContext:La,useEffect:La,useImperativeHandle:La,useLayoutEffect:La,useInsertionEffect:La,useMemo:La,useReducer:La,useRef:La,useState:La,useDebugValue:La,useDeferredValue:La,useTransition:La,useSyncExternalStore:La,useId:La,useHostTransitionStatus:La,useFormState:La,useActionState:La,useOptimistic:La,useMemoCache:La,useCacheRefresh:La},yp={readContext:Pa,use:br,useCallback:function(m,S){return dl().memoizedState=[m,S===void 0?null:S],m},useContext:Pa,useEffect:om,useImperativeHandle:function(m,S,A){A=A!=null?A.concat([m]):null,ml(4194308,4,i0.bind(null,S,m),A)},useLayoutEffect:function(m,S){return ml(4194308,4,m,S)},useInsertionEffect:function(m,S){ml(4,2,m,S)},useMemo:function(m,S){var A=dl();S=S===void 0?null:S;var L=m();if(fl){Ot(!0);try{m()}finally{Ot(!1)}}return A.memoizedState=[L,S],L},useReducer:function(m,S,A){var L=dl();if(A!==void 0){var ee=A(S);if(fl){Ot(!0);try{A(S)}finally{Ot(!1)}}}else ee=S;return L.memoizedState=L.baseState=ee,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:ee},L.queue=m,m=m.dispatch=i_.bind(null,Zr,m),[L.memoizedState,m]},useRef:function(m){var S=dl();return m={current:m},S.memoizedState=m},useState:function(m){m=Pd(m);var S=m.queue,A=Z_.bind(null,Zr,S);return S.dispatch=A,[m.memoizedState,A]},useDebugValue:cm,useDeferredValue:function(m,S){var A=dl();return a0(A,m,S)},useTransition:function(){var m=Pd(!1);return m=ec.bind(null,Zr,m.queue,!0,!1),dl().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,S,A){var L=Zr,ee=dl();if(ti){if(A===void 0)throw Error(r(407));A=A()}else{if(A=S(),F===null)throw Error(r(349));(pe&124)!==0||id(L,S,A)}ee.memoizedState=A;var fe={value:A,getSnapshot:S};return ee.queue=fe,om(of.bind(null,L,fe,m),[m]),L.flags|=2048,Df(9,Ud(),t0.bind(null,L,fe,A,S),null),A},useId:function(){var m=dl(),S=F.identifierPrefix;if(ti){var A=Ru,L=Xl;A=(L&~(1<<32-Ut(L)-1)).toString(32)+A,S="«"+S+"R"+A,A=no++,0<A&&(S+="H"+A.toString(32)),S+="»"}else A=e0++,S="«"+S+"r"+A.toString(32)+"»";return m.memoizedState=S},useHostTransitionStatus:r_,useFormState:Ld,useActionState:Ld,useOptimistic:function(m){var S=dl();S.memoizedState=S.baseState=m;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return S.queue=A,S=mg.bind(null,Zr,!0,A),A.dispatch=S,[m,S]},useMemoCache:rd,useCacheRefresh:function(){return dl().memoizedState=u0.bind(null,Zr)}},s_={readContext:Pa,use:br,useCallback:n_,useContext:Pa,useEffect:r0,useImperativeHandle:s0,useInsertionEffect:lm,useLayoutEffect:fg,useMemo:um,useReducer:Ql,useRef:Nu,useState:function(){return Ql(go)},useDebugValue:cm,useDeferredValue:function(m,S){var A=sa();return Pu(A,hs.memoizedState,m,S)},useTransition:function(){var m=Ql(go)[0],S=sa().memoizedState;return[typeof m=="boolean"?m:dr(m),S]},useSyncExternalStore:pl,useId:K_,useHostTransitionStatus:r_,useFormState:Iu,useActionState:Iu,useOptimistic:function(m,S){var A=sa();return cg(A,hs,m,S)},useMemoCache:rd,useCacheRefresh:c0},Q_={readContext:Pa,use:br,useCallback:n_,useContext:Pa,useEffect:r0,useImperativeHandle:s0,useInsertionEffect:lm,useLayoutEffect:fg,useMemo:um,useReducer:Vo,useRef:Nu,useState:function(){return Vo(go)},useDebugValue:cm,useDeferredValue:function(m,S){var A=sa();return hs===null?a0(A,m,S):Pu(A,hs.memoizedState,m,S)},useTransition:function(){var m=Vo(go)[0],S=sa().memoizedState;return[typeof m=="boolean"?m:dr(m),S]},useSyncExternalStore:pl,useId:K_,useHostTransitionStatus:r_,useFormState:am,useActionState:am,useOptimistic:function(m,S){var A=sa();return hs!==null?cg(A,hs,m,S):(A.baseState=m,[m,A.queue.dispatch])},useMemoCache:rd,useCacheRefresh:c0},bp=null,fm=0;function Bd(m){var S=fm;return fm+=1,bp===null&&(bp=[]),Cu(bp,m,S)}function gh(m,S){S=S.props.ref,m.ref=S!==void 0?S:null}function tc(m,S){throw S.$$typeof===f?Error(r(525)):(m=Object.prototype.toString.call(S),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":m)))}function Du(m){var S=m._init;return S(m._payload)}function Ms(m){function S(Ht,Nt){if(m){var Xt=Ht.deletions;Xt===null?(Ht.deletions=[Nt],Ht.flags|=16):Xt.push(Nt)}}function A(Ht,Nt){if(!m)return null;for(;Nt!==null;)S(Ht,Nt),Nt=Nt.sibling;return null}function L(Ht){for(var Nt=new Map;Ht!==null;)Ht.key!==null?Nt.set(Ht.key,Ht):Nt.set(Ht.index,Ht),Ht=Ht.sibling;return Nt}function ee(Ht,Nt){return Ht=_a(Ht,Nt),Ht.index=0,Ht.sibling=null,Ht}function fe(Ht,Nt,Xt){return Ht.index=Xt,m?(Xt=Ht.alternate,Xt!==null?(Xt=Xt.index,Xt<Nt?(Ht.flags|=67108866,Nt):Xt):(Ht.flags|=67108866,Nt)):(Ht.flags|=1048576,Nt)}function He(Ht){return m&&Ht.alternate===null&&(Ht.flags|=67108866),Ht}function Qe(Ht,Nt,Xt,Sn){return Nt===null||Nt.tag!==6?(Nt=dh(Xt,Ht.mode,Sn),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt),Nt.return=Ht,Nt)}function Et(Ht,Nt,Xt,Sn){var kr=Xt.type;return kr===p?vn(Ht,Nt,Xt.props.children,Sn,Xt.key):Nt!==null&&(Nt.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===D&&Du(kr)===Nt.type)?(Nt=ee(Nt,Xt.props),gh(Nt,Xt),Nt.return=Ht,Nt):(Nt=Ro(Xt.type,Xt.key,Xt.props,null,Ht.mode,Sn),gh(Nt,Xt),Nt.return=Ht,Nt)}function Qt(Ht,Nt,Xt,Sn){return Nt===null||Nt.tag!==4||Nt.stateNode.containerInfo!==Xt.containerInfo||Nt.stateNode.implementation!==Xt.implementation?(Nt=Cl(Xt,Ht.mode,Sn),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt.children||[]),Nt.return=Ht,Nt)}function vn(Ht,Nt,Xt,Sn,kr){return Nt===null||Nt.tag!==7?(Nt=Na(Xt,Ht.mode,Sn,kr),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt),Nt.return=Ht,Nt)}function xn(Ht,Nt,Xt){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return Nt=dh(""+Nt,Ht.mode,Xt),Nt.return=Ht,Nt;if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case h:return Xt=Ro(Nt.type,Nt.key,Nt.props,null,Ht.mode,Xt),gh(Xt,Nt),Xt.return=Ht,Xt;case g:return Nt=Cl(Nt,Ht.mode,Xt),Nt.return=Ht,Nt;case D:var Sn=Nt._init;return Nt=Sn(Nt._payload),xn(Ht,Nt,Xt)}if(Q(Nt)||B(Nt))return Nt=Na(Nt,Ht.mode,Xt,null),Nt.return=Ht,Nt;if(typeof Nt.then=="function")return xn(Ht,Bd(Nt),Xt);if(Nt.$$typeof===E)return xn(Ht,Kh(Ht,Nt),Xt);tc(Ht,Nt)}return null}function rn(Ht,Nt,Xt,Sn){var kr=Nt!==null?Nt.key:null;if(typeof Xt=="string"&&Xt!==""||typeof Xt=="number"||typeof Xt=="bigint")return kr!==null?null:Qe(Ht,Nt,""+Xt,Sn);if(typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case h:return Xt.key===kr?Et(Ht,Nt,Xt,Sn):null;case g:return Xt.key===kr?Qt(Ht,Nt,Xt,Sn):null;case D:return kr=Xt._init,Xt=kr(Xt._payload),rn(Ht,Nt,Xt,Sn)}if(Q(Xt)||B(Xt))return kr!==null?null:vn(Ht,Nt,Xt,Sn,null);if(typeof Xt.then=="function")return rn(Ht,Nt,Bd(Xt),Sn);if(Xt.$$typeof===E)return rn(Ht,Nt,Kh(Ht,Xt),Sn);tc(Ht,Xt)}return null}function on(Ht,Nt,Xt,Sn,kr){if(typeof Sn=="string"&&Sn!==""||typeof Sn=="number"||typeof Sn=="bigint")return Ht=Ht.get(Xt)||null,Qe(Nt,Ht,""+Sn,kr);if(typeof Sn=="object"&&Sn!==null){switch(Sn.$$typeof){case h:return Ht=Ht.get(Sn.key===null?Xt:Sn.key)||null,Et(Nt,Ht,Sn,kr);case g:return Ht=Ht.get(Sn.key===null?Xt:Sn.key)||null,Qt(Nt,Ht,Sn,kr);case D:var Ws=Sn._init;return Sn=Ws(Sn._payload),on(Ht,Nt,Xt,Sn,kr)}if(Q(Sn)||B(Sn))return Ht=Ht.get(Xt)||null,vn(Nt,Ht,Sn,kr,null);if(typeof Sn.then=="function")return on(Ht,Nt,Xt,Bd(Sn),kr);if(Sn.$$typeof===E)return on(Ht,Nt,Xt,Kh(Nt,Sn),kr);tc(Nt,Sn)}return null}function ki(Ht,Nt,Xt,Sn){for(var kr=null,Ws=null,$r=Nt,Si=Nt=0,Eh=null;$r!==null&&Si<Xt.length;Si++){$r.index>Si?(Eh=$r,$r=null):Eh=$r.sibling;var Xa=rn(Ht,$r,Xt[Si],Sn);if(Xa===null){$r===null&&($r=Eh);break}m&&$r&&Xa.alternate===null&&S(Ht,$r),Nt=fe(Xa,Nt,Si),Ws===null?kr=Xa:Ws.sibling=Xa,Ws=Xa,$r=Eh}if(Si===Xt.length)return A(Ht,$r),ti&&ai(Ht,Si),kr;if($r===null){for(;Si<Xt.length;Si++)$r=xn(Ht,Xt[Si],Sn),$r!==null&&(Nt=fe($r,Nt,Si),Ws===null?kr=$r:Ws.sibling=$r,Ws=$r);return ti&&ai(Ht,Si),kr}for($r=L($r);Si<Xt.length;Si++)Eh=on($r,Ht,Si,Xt[Si],Sn),Eh!==null&&(m&&Eh.alternate!==null&&$r.delete(Eh.key===null?Si:Eh.key),Nt=fe(Eh,Nt,Si),Ws===null?kr=Eh:Ws.sibling=Eh,Ws=Eh);return m&&$r.forEach(function(Ub){return S(Ht,Ub)}),ti&&ai(Ht,Si),kr}function di(Ht,Nt,Xt,Sn){if(Xt==null)throw Error(r(151));for(var kr=null,Ws=null,$r=Nt,Si=Nt=0,Eh=null,Xa=Xt.next();$r!==null&&!Xa.done;Si++,Xa=Xt.next()){$r.index>Si?(Eh=$r,$r=null):Eh=$r.sibling;var Ub=rn(Ht,$r,Xa.value,Sn);if(Ub===null){$r===null&&($r=Eh);break}m&&$r&&Ub.alternate===null&&S(Ht,$r),Nt=fe(Ub,Nt,Si),Ws===null?kr=Ub:Ws.sibling=Ub,Ws=Ub,$r=Eh}if(Xa.done)return A(Ht,$r),ti&&ai(Ht,Si),kr;if($r===null){for(;!Xa.done;Si++,Xa=Xt.next())Xa=xn(Ht,Xa.value,Sn),Xa!==null&&(Nt=fe(Xa,Nt,Si),Ws===null?kr=Xa:Ws.sibling=Xa,Ws=Xa);return ti&&ai(Ht,Si),kr}for($r=L($r);!Xa.done;Si++,Xa=Xt.next())Xa=on($r,Ht,Si,Xa.value,Sn),Xa!==null&&(m&&Xa.alternate!==null&&$r.delete(Xa.key===null?Si:Xa.key),Nt=fe(Xa,Nt,Si),Ws===null?kr=Xa:Ws.sibling=Xa,Ws=Xa);return m&&$r.forEach(function(WEe){return S(Ht,WEe)}),ti&&ai(Ht,Si),kr}function Ko(Ht,Nt,Xt,Sn){if(typeof Xt=="object"&&Xt!==null&&Xt.type===p&&Xt.key===null&&(Xt=Xt.props.children),typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case h:e:{for(var kr=Xt.key;Nt!==null;){if(Nt.key===kr){if(kr=Xt.type,kr===p){if(Nt.tag===7){A(Ht,Nt.sibling),Sn=ee(Nt,Xt.props.children),Sn.return=Ht,Ht=Sn;break e}}else if(Nt.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===D&&Du(kr)===Nt.type){A(Ht,Nt.sibling),Sn=ee(Nt,Xt.props),gh(Sn,Xt),Sn.return=Ht,Ht=Sn;break e}A(Ht,Nt);break}else S(Ht,Nt);Nt=Nt.sibling}Xt.type===p?(Sn=Na(Xt.props.children,Ht.mode,Sn,Xt.key),Sn.return=Ht,Ht=Sn):(Sn=Ro(Xt.type,Xt.key,Xt.props,null,Ht.mode,Sn),gh(Sn,Xt),Sn.return=Ht,Ht=Sn)}return He(Ht);case g:e:{for(kr=Xt.key;Nt!==null;){if(Nt.key===kr)if(Nt.tag===4&&Nt.stateNode.containerInfo===Xt.containerInfo&&Nt.stateNode.implementation===Xt.implementation){A(Ht,Nt.sibling),Sn=ee(Nt,Xt.children||[]),Sn.return=Ht,Ht=Sn;break e}else{A(Ht,Nt);break}else S(Ht,Nt);Nt=Nt.sibling}Sn=Cl(Xt,Ht.mode,Sn),Sn.return=Ht,Ht=Sn}return He(Ht);case D:return kr=Xt._init,Xt=kr(Xt._payload),Ko(Ht,Nt,Xt,Sn)}if(Q(Xt))return ki(Ht,Nt,Xt,Sn);if(B(Xt)){if(kr=B(Xt),typeof kr!="function")throw Error(r(150));return Xt=kr.call(Xt),di(Ht,Nt,Xt,Sn)}if(typeof Xt.then=="function")return Ko(Ht,Nt,Bd(Xt),Sn);if(Xt.$$typeof===E)return Ko(Ht,Nt,Kh(Ht,Xt),Sn);tc(Ht,Xt)}return typeof Xt=="string"&&Xt!==""||typeof Xt=="number"||typeof Xt=="bigint"?(Xt=""+Xt,Nt!==null&&Nt.tag===6?(A(Ht,Nt.sibling),Sn=ee(Nt,Xt),Sn.return=Ht,Ht=Sn):(A(Ht,Nt),Sn=dh(Xt,Ht.mode,Sn),Sn.return=Ht,Ht=Sn),He(Ht)):A(Ht,Nt)}return function(Ht,Nt,Xt,Sn){try{fm=0;var kr=Ko(Ht,Nt,Xt,Sn);return bp=null,kr}catch($r){if($r===kd||$r===to)throw $r;var Ws=wo(29,$r,null,Ht.mode);return Ws.lanes=Sn,Ws.return=Ht,Ws}finally{}}}var _h=Ms(!0),a_=Ms(!1),Vs=K(null),gc=null;function Lf(m){var S=m.alternate;le(_o,_o.current&1),le(Vs,m),gc===null&&(S===null||Nd.current!==null||S.memoizedState!==null)&&(gc=m)}function gg(m){if(m.tag===22){if(le(_o,_o.current),le(Vs,m),gc===null){var S=m.alternate;S!==null&&S.memoizedState!==null&&(gc=m)}}else Uf()}function Uf(){le(_o,_o.current),le(Vs,Vs.current)}function lf(m){ne(Vs),gc===m&&(gc=null),ne(_o)}var _o=K(0);function ad(m){for(var S=m;S!==null;){if(S.tag===13){var A=S.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||Z6(A)))return S}else if(S.tag===19&&S.memoizedProps.revealOrder!==void 0){if((S.flags&128)!==0)return S}else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===m)break;for(;S.sibling===null;){if(S.return===null||S.return===m)return null;S=S.return}S.sibling.return=S.return,S=S.sibling}return null}function Bf(m,S,A,L){S=m.memoizedState,A=A(L,S),A=A==null?S:u({},S,A),m.memoizedState=A,m.lanes===0&&(m.updateQueue.baseState=A)}var io={enqueueSetState:function(m,S,A){m=m._reactInternals;var L=Yr(),ee=Mu(L);ee.payload=S,A!=null&&(ee.callback=A),S=Pf(m,ee,L),S!==null&&(ci(S,m,L),Zh(S,m,L))},enqueueReplaceState:function(m,S,A){m=m._reactInternals;var L=Yr(),ee=Mu(L);ee.tag=1,ee.payload=S,A!=null&&(ee.callback=A),S=Pf(m,ee,L),S!==null&&(ci(S,m,L),Zh(S,m,L))},enqueueForceUpdate:function(m,S){m=m._reactInternals;var A=Yr(),L=Mu(A);L.tag=2,S!=null&&(L.callback=S),S=Pf(m,L,A),S!==null&&(ci(S,m,A),Zh(S,m,A))}};function $o(m,S,A,L,ee,fe,He){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(L,fe,He):S.prototype&&S.prototype.isPureReactComponent?!Cf(A,L)||!Cf(ee,fe):!0}function _g(m,S,A,L){m=S.state,typeof S.componentWillReceiveProps=="function"&&S.componentWillReceiveProps(A,L),typeof S.UNSAFE_componentWillReceiveProps=="function"&&S.UNSAFE_componentWillReceiveProps(A,L),S.state!==m&&io.enqueueReplaceState(S,S.state,null)}function nu(m,S){var A=S;if("ref"in S){A={};for(var L in S)L!=="ref"&&(A[L]=S[L])}if(m=m.defaultProps){A===S&&(A=u({},A));for(var ee in m)A[ee]===void 0&&(A[ee]=m[ee])}return A}var Fd=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var S=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(S))return}else if(typeof Tl=="object"&&typeof Tl.emit=="function"){Tl.emit("uncaughtException",m);return}console.error(m)};function gl(m){Fd(m)}function aa(m){console.error(m)}function ev(m){Fd(m)}function Ff(m,S){try{var A=m.onUncaughtError;A(S.value,{componentStack:S.stack})}catch(L){setTimeout(function(){throw L})}}function Sr(m,S,A){try{var L=m.onCaughtError;L(A.value,{componentStack:A.stack,errorBoundary:S.tag===1?S.stateNode:null})}catch(ee){setTimeout(function(){throw ee})}}function Ar(m,S,A){return A=Mu(A),A.tag=3,A.payload={element:null},A.callback=function(){Ff(m,S)},A}function _c(m){return m=Mu(m),m.tag=3,m}function Ui(m,S,A,L){var ee=A.type.getDerivedStateFromError;if(typeof ee=="function"){var fe=L.value;m.payload=function(){return ee(fe)},m.callback=function(){Sr(S,A,L)}}var He=A.stateNode;He!==null&&typeof He.componentDidCatch=="function"&&(m.callback=function(){Sr(S,A,L),typeof ee!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var Qe=L.stack;this.componentDidCatch(L.value,{componentStack:Qe!==null?Qe:""})})}function oa(m,S,A,L,ee){if(A.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(S=A.alternate,S!==null&&Co(S,A,ee,!0),A=Vs.current,A!==null){switch(A.tag){case 13:return gc===null?T():A.alternate===null&&xt===0&&(xt=3),A.flags&=-257,A.flags|=65536,A.lanes=ee,L===tf?A.flags|=16384:(S=A.updateQueue,S===null?A.updateQueue=new Set([L]):S.add(L),nn(m,L,ee)),!1;case 22:return A.flags|=65536,L===tf?A.flags|=16384:(S=A.updateQueue,S===null?(S={transitions:null,markerInstances:null,retryQueue:new Set([L])},A.updateQueue=S):(A=S.retryQueue,A===null?S.retryQueue=new Set([L]):A.add(L)),nn(m,L,ee)),!1}throw Error(r(435,A.tag))}return nn(m,L,ee),T(),!1}if(ti)return S=Vs.current,S!==null?((S.flags&65536)===0&&(S.flags|=256),S.flags|=65536,S.lanes=ee,L!==Wh&&(m=Error(r(422),{cause:L}),Zc(eo(m,A)))):(L!==Wh&&(S=Error(r(423),{cause:L}),Zc(eo(S,A))),m=m.current.alternate,m.flags|=65536,ee&=-ee,m.lanes|=ee,L=eo(L,A),ee=Ar(m.stateNode,L,ee),Jh(m,ee),xt!==4&&(xt=2)),!1;var fe=Error(r(520),{cause:L});if(fe=eo(fe,A),It===null?It=[fe]:It.push(fe),xt!==4&&(xt=2),S===null)return!0;L=eo(L,A),A=S;do{switch(A.tag){case 3:return A.flags|=65536,m=ee&-ee,A.lanes|=m,m=Ar(A.stateNode,L,m),Jh(A,m),!1;case 1:if(S=A.type,fe=A.stateNode,(A.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(Rn===null||!Rn.has(fe))))return A.flags|=65536,ee&=-ee,A.lanes|=ee,ee=_c(ee),Ui(ee,m,A,L),Jh(A,ee),!1}A=A.return}while(A!==null);return!1}var Ra=Error(r(461)),Ga=!1;function bs(m,S,A,L){S.child=m===null?a_(S,null,A,L):_h(S,m.child,A,L)}function $a(m,S,A,L,ee){A=A.render;var fe=S.ref;if("ref"in L){var He={};for(var Qe in L)Qe!=="ref"&&(He[Qe]=L[Qe])}else He=L;return Qu(S),L=ro(m,S,A,He,fe,ee),Qe=hl(),m!==null&&!Ga?(Jl(m,S,ee),Wr(m,S,ee)):(ti&&Qe&&Jp(S),S.flags|=1,bs(m,S,L,ee),S.child)}function Nl(m,S,A,L,ee){if(m===null){var fe=A.type;return typeof fe=="function"&&!Nc(fe)&&fe.defaultProps===void 0&&A.compare===null?(S.tag=15,S.type=fe,la(m,S,fe,L,ee)):(m=Ro(A.type,null,L,S,S.mode,ee),m.ref=S.ref,m.return=S,S.child=m)}if(fe=m.child,!is(m,ee)){var He=fe.memoizedProps;if(A=A.compare,A=A!==null?A:Cf,A(He,L)&&m.ref===S.ref)return Wr(m,S,ee)}return S.flags|=1,m=_a(fe,L),m.ref=S.ref,m.return=S,S.child=m}function la(m,S,A,L,ee){if(m!==null){var fe=m.memoizedProps;if(Cf(fe,L)&&m.ref===S.ref)if(Ga=!1,S.pendingProps=L=fe,is(m,ee))(m.flags&131072)!==0&&(Ga=!0);else return S.lanes=m.lanes,Wr(m,S,ee)}return ru(m,S,A,L,ee)}function qr(m,S,A){var L=S.pendingProps,ee=L.children,fe=m!==null?m.memoizedState:null;if(L.mode==="hidden"){if((S.flags&128)!==0){if(L=fe!==null?fe.baseLanes|A:A,m!==null){for(ee=S.child=m.child,fe=0;ee!==null;)fe=fe|ee.lanes|ee.childLanes,ee=ee.sibling;S.childLanes=fe&~L}else S.childLanes=0,S.child=null;return ds(m,S,L,A)}if((A&536870912)!==0)S.memoizedState={baseLanes:0,cachePool:null},m!==null&&ia(S,fe!==null?fe.cachePool:null),fe!==null?Qh(S,fe):Ou(),gg(S);else return S.lanes=S.childLanes=536870912,ds(m,S,fe!==null?fe.baseLanes|A:A,A)}else fe!==null?(ia(S,fe.cachePool),Qh(S,fe),Uf(),S.memoizedState=null):(m!==null&&ia(S,null),Ou(),Uf());return bs(m,S,ee,A),S.child}function ds(m,S,A,L){var ee=Ha();return ee=ee===null?null:{parent:yr._currentValue,pool:ee},S.memoizedState={baseLanes:A,cachePool:ee},m!==null&&ia(S,null),Ou(),gg(S),m!==null&&Co(m,S,L,!0),null}function Aa(m,S){var A=S.ref;if(A===null)m!==null&&m.ref!==null&&(S.flags|=4194816);else{if(typeof A!="function"&&typeof A!="object")throw Error(r(284));(m===null||m.ref!==A)&&(S.flags|=4194816)}}function ru(m,S,A,L,ee){return Qu(S),A=ro(m,S,A,L,void 0,ee),L=hl(),m!==null&&!Ga?(Jl(m,S,ee),Wr(m,S,ee)):(ti&&L&&Jp(S),S.flags|=1,bs(m,S,A,ee),S.child)}function Gi(m,S,A,L,ee,fe){return Qu(S),S.updateQueue=null,A=nd(S,L,A,ee),td(m),L=hl(),m!==null&&!Ga?(Jl(m,S,fe),Wr(m,S,fe)):(ti&&L&&Jp(S),S.flags|=1,bs(m,S,A,fe),S.child)}function Wa(m,S,A,L,ee){if(Qu(S),S.stateNode===null){var fe=If,He=A.contextType;typeof He=="object"&&He!==null&&(fe=Pa(He)),fe=new A(L,fe),S.memoizedState=fe.state!==null&&fe.state!==void 0?fe.state:null,fe.updater=io,S.stateNode=fe,fe._reactInternals=S,fe=S.stateNode,fe.props=L,fe.state=S.memoizedState,fe.refs={},em(S),He=A.contextType,fe.context=typeof He=="object"&&He!==null?Pa(He):If,fe.state=S.memoizedState,He=A.getDerivedStateFromProps,typeof He=="function"&&(Bf(S,A,He,L),fe.state=S.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof fe.getSnapshotBeforeUpdate=="function"||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(He=fe.state,typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount(),He!==fe.state&&io.enqueueReplaceState(fe,fe.state,null),Il(S,L,fe,ee),qs(),fe.state=S.memoizedState),typeof fe.componentDidMount=="function"&&(S.flags|=4194308),L=!0}else if(m===null){fe=S.stateNode;var Qe=S.memoizedProps,Et=nu(A,Qe);fe.props=Et;var Qt=fe.context,vn=A.contextType;He=If,typeof vn=="object"&&vn!==null&&(He=Pa(vn));var xn=A.getDerivedStateFromProps;vn=typeof xn=="function"||typeof fe.getSnapshotBeforeUpdate=="function",Qe=S.pendingProps!==Qe,vn||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Qe||Qt!==He)&&_g(S,fe,L,He),Oo=!1;var rn=S.memoizedState;fe.state=rn,Il(S,L,fe,ee),qs(),Qt=S.memoizedState,Qe||rn!==Qt||Oo?(typeof xn=="function"&&(Bf(S,A,xn,L),Qt=S.memoizedState),(Et=Oo||$o(S,A,Et,L,rn,Qt,He))?(vn||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(S.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(S.flags|=4194308),S.memoizedProps=L,S.memoizedState=Qt),fe.props=L,fe.state=Qt,fe.context=He,L=Et):(typeof fe.componentDidMount=="function"&&(S.flags|=4194308),L=!1)}else{fe=S.stateNode,Hr(m,S),He=S.memoizedProps,vn=nu(A,He),fe.props=vn,xn=S.pendingProps,rn=fe.context,Qt=A.contextType,Et=If,typeof Qt=="object"&&Qt!==null&&(Et=Pa(Qt)),Qe=A.getDerivedStateFromProps,(Qt=typeof Qe=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(He!==xn||rn!==Et)&&_g(S,fe,L,Et),Oo=!1,rn=S.memoizedState,fe.state=rn,Il(S,L,fe,ee),qs();var on=S.memoizedState;He!==xn||rn!==on||Oo||m!==null&&m.dependencies!==null&&Xh(m.dependencies)?(typeof Qe=="function"&&(Bf(S,A,Qe,L),on=S.memoizedState),(vn=Oo||$o(S,A,vn,L,rn,on,Et)||m!==null&&m.dependencies!==null&&Xh(m.dependencies))?(Qt||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(L,on,Et),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(L,on,Et)),typeof fe.componentDidUpdate=="function"&&(S.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(S.flags|=1024)):(typeof fe.componentDidUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=1024),S.memoizedProps=L,S.memoizedState=on),fe.props=L,fe.state=on,fe.context=Et,L=vn):(typeof fe.componentDidUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=1024),L=!1)}return fe=L,Aa(m,S),L=(S.flags&128)!==0,fe||L?(fe=S.stateNode,A=L&&typeof A.getDerivedStateFromError!="function"?null:fe.render(),S.flags|=1,m!==null&&L?(S.child=_h(S,m.child,null,ee),S.child=_h(S,null,A,ee)):bs(m,S,A,ee),S.memoizedState=fe.state,m=S.child):m=Wr(m,S,ee),m}function cf(m,S,A,L){return Jn(),S.flags|=256,bs(m,S,A,L),S.child}var Gs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Os(m){return{baseLanes:m,cachePool:Lc()}}function Di(m,S,A){return m=m!==null?m.childLanes&~A:0,S&&(m|=kt),m}function so(m,S,A){var L=S.pendingProps,ee=!1,fe=(S.flags&128)!==0,He;if((He=fe)||(He=m!==null&&m.memoizedState===null?!1:(_o.current&2)!==0),He&&(ee=!0,S.flags&=-129),He=(S.flags&32)!==0,S.flags&=-33,m===null){if(ti){if(ee?Lf(S):Uf(),ti){var Qe=Cs,Et;if(Et=Qe){e:{for(Et=Qe,Qe=yi;Et.nodeType!==8;){if(!Qe){Qe=null;break e}if(Et=l_(Et.nextSibling),Et===null){Qe=null;break e}}Qe=Et}Qe!==null?(S.memoizedState={dehydrated:Qe,treeContext:Gh!==null?{id:Xl,overflow:Ru}:null,retryLane:536870912,hydrationErrors:null},Et=wo(18,null,null,0),Et.stateNode=Qe,Et.return=S,S.child=Et,Ao=S,Cs=null,Et=!0):Et=!1}Et||Yh(S)}if(Qe=S.memoizedState,Qe!==null&&(Qe=Qe.dehydrated,Qe!==null))return Z6(Qe)?S.lanes=32:S.lanes=536870912,null;lf(S)}return Qe=L.children,L=L.fallback,ee?(Uf(),ee=S.mode,Qe=Pl({mode:"hidden",children:Qe},ee),L=Na(L,ee,A,null),Qe.return=S,L.return=S,Qe.sibling=L,S.child=Qe,ee=S.child,ee.memoizedState=Os(A),ee.childLanes=Di(m,He,A),S.memoizedState=Gs,L):(Lf(S),vc(S,Qe))}if(Et=m.memoizedState,Et!==null&&(Qe=Et.dehydrated,Qe!==null)){if(fe)S.flags&256?(Lf(S),S.flags&=-257,S=mr(m,S,A)):S.memoizedState!==null?(Uf(),S.child=m.child,S.flags|=128,S=null):(Uf(),ee=L.fallback,Qe=S.mode,L=Pl({mode:"visible",children:L.children},Qe),ee=Na(ee,Qe,A,null),ee.flags|=2,L.return=S,ee.return=S,L.sibling=ee,S.child=L,_h(S,m.child,null,A),L=S.child,L.memoizedState=Os(A),L.childLanes=Di(m,He,A),S.memoizedState=Gs,S=ee);else if(Lf(S),Z6(Qe)){if(He=Qe.nextSibling&&Qe.nextSibling.dataset,He)var Qt=He.dgst;He=Qt,L=Error(r(419)),L.stack="",L.digest=He,Zc({value:L,source:null,stack:null}),S=mr(m,S,A)}else if(Ga||Co(m,S,A,!1),He=(A&m.childLanes)!==0,Ga||He){if(He=F,He!==null&&(L=A&-A,L=(L&42)!==0?1:mt(L),L=(L&(He.suspendedLanes|A))!==0?0:L,L!==0&&L!==Et.retryLane))throw Et.retryLane=L,Ti(m,L),ci(He,m,L),Ra;Qe.data==="$?"||T(),S=mr(m,S,A)}else Qe.data==="$?"?(S.flags|=192,S.child=m.child,S=null):(m=Et.treeContext,Cs=l_(Qe.nextSibling),Ao=S,ti=!0,Dc=null,yi=!1,m!==null&&(fs[dc++]=Xl,fs[dc++]=Ru,fs[dc++]=Gh,Xl=m.id,Ru=m.overflow,Gh=S),S=vc(S,L.children),S.flags|=4096);return S}return ee?(Uf(),ee=L.fallback,Qe=S.mode,Et=m.child,Qt=Et.sibling,L=_a(Et,{mode:"hidden",children:L.children}),L.subtreeFlags=Et.subtreeFlags&65011712,Qt!==null?ee=_a(Qt,ee):(ee=Na(ee,Qe,A,null),ee.flags|=2),ee.return=S,L.return=S,L.sibling=ee,S.child=L,L=ee,ee=S.child,Qe=m.child.memoizedState,Qe===null?Qe=Os(A):(Et=Qe.cachePool,Et!==null?(Qt=yr._currentValue,Et=Et.parent!==Qt?{parent:Qt,pool:Qt}:Et):Et=Lc(),Qe={baseLanes:Qe.baseLanes|A,cachePool:Et}),ee.memoizedState=Qe,ee.childLanes=Di(m,He,A),S.memoizedState=Gs,L):(Lf(S),A=m.child,m=A.sibling,A=_a(A,{mode:"visible",children:L.children}),A.return=S,A.sibling=null,m!==null&&(He=S.deletions,He===null?(S.deletions=[m],S.flags|=16):He.push(m)),S.child=A,S.memoizedState=null,A)}function vc(m,S){return S=Pl({mode:"visible",children:S},m.mode),S.return=m,m.child=S}function Pl(m,S){return m=wo(22,m,null,S),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function mr(m,S,A){return _h(S,m.child,null,A),m=vc(S,S.pendingProps.children),m.flags|=2,S.memoizedState=null,m}function fr(m,S,A){m.lanes|=S;var L=m.alternate;L!==null&&(L.lanes|=S),Qp(m.return,S,A)}function Yn(m,S,A,L,ee){var fe=m.memoizedState;fe===null?m.memoizedState={isBackwards:S,rendering:null,renderingStartTime:0,last:L,tail:A,tailMode:ee}:(fe.isBackwards=S,fe.rendering=null,fe.renderingStartTime=0,fe.last=L,fe.tail=A,fe.tailMode=ee)}function Ya(m,S,A){var L=S.pendingProps,ee=L.revealOrder,fe=L.tail;if(bs(m,S,L.children,A),L=_o.current,(L&2)!==0)L=L&1|2,S.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=S.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&fr(m,A,S);else if(m.tag===19)fr(m,A,S);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===S)break e;for(;m.sibling===null;){if(m.return===null||m.return===S)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}L&=1}switch(le(_o,L),ee){case"forwards":for(A=S.child,ee=null;A!==null;)m=A.alternate,m!==null&&ad(m)===null&&(ee=A),A=A.sibling;A=ee,A===null?(ee=S.child,S.child=null):(ee=A.sibling,A.sibling=null),Yn(S,!1,ee,A,fe);break;case"backwards":for(A=null,ee=S.child,S.child=null;ee!==null;){if(m=ee.alternate,m!==null&&ad(m)===null){S.child=ee;break}m=ee.sibling,ee.sibling=A,A=ee,ee=m}Yn(S,!0,A,null,fe);break;case"together":Yn(S,!1,null,null,void 0);break;default:S.memoizedState=null}return S.child}function Wr(m,S,A){if(m!==null&&(S.dependencies=m.dependencies),Dt|=S.lanes,(A&S.childLanes)===0)if(m!==null){if(Co(m,S,A,!1),(A&S.childLanes)===0)return null}else return null;if(m!==null&&S.child!==m.child)throw Error(r(153));if(S.child!==null){for(m=S.child,A=_a(m,m.pendingProps),S.child=A,A.return=S;m.sibling!==null;)m=m.sibling,A=A.sibling=_a(m,m.pendingProps),A.return=S;A.sibling=null}return S.child}function is(m,S){return(m.lanes&S)!==0?!0:(m=m.dependencies,!!(m!==null&&Xh(m)))}function Lu(m,S,A){switch(S.tag){case 3:Ne(S,S.stateNode.containerInfo),ph(S,yr,m.memoizedState.cache),Jn();break;case 27:case 5:Xe(S);break;case 4:Ne(S,S.stateNode.containerInfo);break;case 10:ph(S,S.type,S.memoizedProps.value);break;case 13:var L=S.memoizedState;if(L!==null)return L.dehydrated!==null?(Lf(S),S.flags|=128,null):(A&S.child.childLanes)!==0?so(m,S,A):(Lf(S),m=Wr(m,S,A),m!==null?m.sibling:null);Lf(S);break;case 19:var ee=(m.flags&128)!==0;if(L=(A&S.childLanes)!==0,L||(Co(m,S,A,!1),L=(A&S.childLanes)!==0),ee){if(L)return Ya(m,S,A);S.flags|=128}if(ee=S.memoizedState,ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),le(_o,_o.current),L)break;return null;case 22:case 23:return S.lanes=0,qr(m,S,A);case 24:ph(S,yr,m.memoizedState.cache)}return Wr(m,S,A)}function iu(m,S,A){if(m!==null)if(m.memoizedProps!==S.pendingProps)Ga=!0;else{if(!is(m,A)&&(S.flags&128)===0)return Ga=!1,Lu(m,S,A);Ga=(m.flags&131072)!==0}else Ga=!1,ti&&(S.flags&1048576)!==0&&$h(S,Pc,S.index);switch(S.lanes=0,S.tag){case 16:e:{m=S.pendingProps;var L=S.elementType,ee=L._init;if(L=ee(L._payload),S.type=L,typeof L=="function")Nc(L)?(m=nu(L,m),S.tag=1,S=Wa(null,S,L,m,A)):(S.tag=0,S=ru(null,S,L,m,A));else{if(L!=null){if(ee=L.$$typeof,ee===M){S.tag=11,S=$a(null,S,L,m,A);break e}else if(ee===I){S.tag=14,S=Nl(null,S,L,m,A);break e}}throw S=U(L)||L,Error(r(306,S,""))}}return S;case 0:return ru(m,S,S.type,S.pendingProps,A);case 1:return L=S.type,ee=nu(L,S.pendingProps),Wa(m,S,L,ee,A);case 3:e:{if(Ne(S,S.stateNode.containerInfo),m===null)throw Error(r(387));L=S.pendingProps;var fe=S.memoizedState;ee=fe.element,Hr(m,S),Il(S,L,null,A);var He=S.memoizedState;if(L=He.cache,ph(S,yr,L),L!==fe.cache&&Md(S,[yr],A,!0),qs(),L=He.element,fe.isDehydrated)if(fe={element:L,isDehydrated:!1,cache:He.cache},S.updateQueue.baseState=fe,S.memoizedState=fe,S.flags&256){S=cf(m,S,L,A);break e}else if(L!==ee){ee=eo(Error(r(424)),S),Zc(ee),S=cf(m,S,L,A);break e}else{switch(m=S.stateNode.containerInfo,m.nodeType){case 9:m=m.body;break;default:m=m.nodeName==="HTML"?m.ownerDocument.body:m}for(Cs=l_(m.firstChild),Ao=S,ti=!0,Dc=null,yi=!0,A=a_(S,null,L,A),S.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling}else{if(Jn(),L===ee){S=Wr(m,S,A);break e}bs(m,S,L,A)}S=S.child}return S;case 26:return Aa(m,S),m===null?(A=S$(S.type,null,S.pendingProps,null))?S.memoizedState=A:ti||(A=S.type,m=S.pendingProps,L=F3(Me.current).createElement(A),L[Bt]=S,L[Yt]=m,md(L,A,m),_i(L),S.stateNode=L):S.memoizedState=S$(S.type,m.memoizedProps,S.pendingProps,m.memoizedState),null;case 27:return Xe(S),m===null&&ti&&(L=S.stateNode=v$(S.type,S.pendingProps,Me.current),Ao=S,yi=!0,ee=Cs,Ib(S.type)?(J6=ee,Cs=l_(L.firstChild)):Cs=ee),bs(m,S,S.pendingProps.children,A),Aa(m,S),m===null&&(S.flags|=4194304),S.child;case 5:return m===null&&ti&&((ee=L=Cs)&&(L=EEe(L,S.type,S.pendingProps,yi),L!==null?(S.stateNode=L,Ao=S,Cs=l_(L.firstChild),yi=!1,ee=!0):ee=!1),ee||Yh(S)),Xe(S),ee=S.type,fe=S.pendingProps,He=m!==null?m.memoizedProps:null,L=fe.children,Y6(ee,fe)?L=null:He!==null&&Y6(ee,He)&&(S.flags|=32),S.memoizedState!==null&&(ee=ro(m,S,gp,null,null,A),CR._currentValue=ee),Aa(m,S),bs(m,S,L,A),S.child;case 6:return m===null&&ti&&((m=A=Cs)&&(A=xEe(A,S.pendingProps,yi),A!==null?(S.stateNode=A,Ao=S,Cs=null,m=!0):m=!1),m||Yh(S)),null;case 13:return so(m,S,A);case 4:return Ne(S,S.stateNode.containerInfo),L=S.pendingProps,m===null?S.child=_h(S,null,L,A):bs(m,S,L,A),S.child;case 11:return $a(m,S,S.type,S.pendingProps,A);case 7:return bs(m,S,S.pendingProps,A),S.child;case 8:return bs(m,S,S.pendingProps.children,A),S.child;case 12:return bs(m,S,S.pendingProps.children,A),S.child;case 10:return L=S.pendingProps,ph(S,S.type,L.value),bs(m,S,L.children,A),S.child;case 9:return ee=S.type._context,L=S.pendingProps.children,Qu(S),ee=Pa(ee),L=L(ee),S.flags|=1,bs(m,S,L,A),S.child;case 14:return Nl(m,S,S.type,S.pendingProps,A);case 15:return la(m,S,S.type,S.pendingProps,A);case 19:return Ya(m,S,A);case 31:return L=S.pendingProps,A=S.mode,L={mode:L.mode,children:L.children},m===null?(A=Pl(L,A),A.ref=S.ref,S.child=A,A.return=S,S=A):(A=_a(m.child,L),A.ref=S.ref,S.child=A,A.return=S,S=A),S;case 22:return qr(m,S,A);case 24:return Qu(S),L=Pa(yr),m===null?(ee=Ha(),ee===null&&(ee=F,fe=ll(),ee.pooledCache=fe,fe.refCount++,fe!==null&&(ee.pooledCacheLanes|=A),ee=fe),S.memoizedState={parent:L,cache:ee},em(S),ph(S,yr,ee)):((m.lanes&A)!==0&&(Hr(m,S),Il(S,null,null,A),qs()),ee=m.memoizedState,fe=S.memoizedState,ee.parent!==L?(ee={parent:L,cache:L},S.memoizedState=ee,S.lanes===0&&(S.memoizedState=S.updateQueue.baseState=ee),ph(S,yr,L)):(L=fe.cache,ph(S,yr,L),L!==ee.cache&&Md(S,[yr],A,!0))),bs(m,S,S.pendingProps.children,A),S.child;case 29:throw S.pendingProps}throw Error(r(156,S.tag))}function ko(m){m.flags|=4}function od(m,S){if(S.type!=="stylesheet"||(S.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!R$(S)){if(S=Vs.current,S!==null&&((pe&4194048)===pe?gc!==null:(pe&62914560)!==pe&&(pe&536870912)===0||S!==gc))throw Mo=tf,Au;m.flags|=8192}}function ld(m,S){S!==null&&(m.flags|=4),m.flags&16384&&(S=m.tag!==22?tt():536870912,m.lanes|=S,wt|=S)}function Sp(m,S){if(!ti)switch(m.tailMode){case"hidden":S=m.tail;for(var A=null;S!==null;)S.alternate!==null&&(A=S),S=S.sibling;A===null?m.tail=null:A.sibling=null;break;case"collapsed":A=m.tail;for(var L=null;A!==null;)A.alternate!==null&&(L=A),A=A.sibling;L===null?S||m.tail===null?m.tail=null:m.tail.sibling=null:L.sibling=null}}function ca(m){var S=m.alternate!==null&&m.alternate.child===m.child,A=0,L=0;if(S)for(var ee=m.child;ee!==null;)A|=ee.lanes|ee.childLanes,L|=ee.subtreeFlags&65011712,L|=ee.flags&65011712,ee.return=m,ee=ee.sibling;else for(ee=m.child;ee!==null;)A|=ee.lanes|ee.childLanes,L|=ee.subtreeFlags,L|=ee.flags,ee.return=m,ee=ee.sibling;return m.subtreeFlags|=L,m.childLanes=A,S}function Ep(m,S,A){var L=S.pendingProps;switch(Zs(S),S.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ca(S),null;case 1:return ca(S),null;case 3:return A=S.stateNode,L=null,m!==null&&(L=m.memoizedState.cache),S.memoizedState.cache!==L&&(S.flags|=2048),Qc(yr),Ae(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(m===null||m.child===null)&&(ol(S)?ko(S):m===null||m.memoizedState.isDehydrated&&(S.flags&256)===0||(S.flags|=1024,Pi())),ca(S),null;case 26:return A=S.memoizedState,m===null?(ko(S),A!==null?(ca(S),od(S,A)):(ca(S),S.flags&=-16777217)):A?A!==m.memoizedState?(ko(S),ca(S),od(S,A)):(ca(S),S.flags&=-16777217):(m.memoizedProps!==L&&ko(S),ca(S),S.flags&=-16777217),null;case 27:$e(S),A=Me.current;var ee=S.type;if(m!==null&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(!L){if(S.stateNode===null)throw Error(r(166));return ca(S),null}m=ce.current,ol(S)?X_(S):(m=v$(ee,L,A),S.stateNode=m,ko(S))}return ca(S),null;case 5:if($e(S),A=S.type,m!==null&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(!L){if(S.stateNode===null)throw Error(r(166));return ca(S),null}if(m=ce.current,ol(S))X_(S);else{switch(ee=F3(Me.current),m){case 1:m=ee.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:m=ee.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":m=ee.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":m=ee.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":m=ee.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof L.is=="string"?ee.createElement("select",{is:L.is}):ee.createElement("select"),L.multiple?m.multiple=!0:L.size&&(m.size=L.size);break;default:m=typeof L.is=="string"?ee.createElement(A,{is:L.is}):ee.createElement(A)}}m[Bt]=S,m[Yt]=L;e:for(ee=S.child;ee!==null;){if(ee.tag===5||ee.tag===6)m.appendChild(ee.stateNode);else if(ee.tag!==4&&ee.tag!==27&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===S)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===S)break e;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}S.stateNode=m;e:switch(md(m,A,L),A){case"button":case"input":case"select":case"textarea":m=!!L.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&ko(S)}}return ca(S),S.flags&=-16777217,null;case 6:if(m&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(typeof L!="string"&&S.stateNode===null)throw Error(r(166));if(m=Me.current,ol(S)){if(m=S.stateNode,A=S.memoizedProps,L=null,ee=Ao,ee!==null)switch(ee.tag){case 27:case 5:L=ee.memoizedProps}m[Bt]=S,m=!!(m.nodeValue===A||L!==null&&L.suppressHydrationWarning===!0||f$(m.nodeValue,A)),m||Yh(S)}else m=F3(m).createTextNode(L),m[Bt]=S,S.stateNode=m}return ca(S),null;case 13:if(L=S.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(ee=ol(S),L!==null&&L.dehydrated!==null){if(m===null){if(!ee)throw Error(r(318));if(ee=S.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(r(317));ee[Bt]=S}else Jn(),(S.flags&128)===0&&(S.memoizedState=null),S.flags|=4;ca(S),ee=!1}else ee=Pi(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=ee),ee=!0;if(!ee)return S.flags&256?(lf(S),S):(lf(S),null)}if(lf(S),(S.flags&128)!==0)return S.lanes=A,S;if(A=L!==null,m=m!==null&&m.memoizedState!==null,A){L=S.child,ee=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(ee=L.alternate.memoizedState.cachePool.pool);var fe=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(fe=L.memoizedState.cachePool.pool),fe!==ee&&(L.flags|=2048)}return A!==m&&A&&(S.child.flags|=8192),ld(S,S.updateQueue),ca(S),null;case 4:return Ae(),m===null&&q6(S.stateNode.containerInfo),ca(S),null;case 10:return Qc(S.type),ca(S),null;case 19:if(ne(_o),ee=S.memoizedState,ee===null)return ca(S),null;if(L=(S.flags&128)!==0,fe=ee.rendering,fe===null)if(L)Sp(ee,!1);else{if(xt!==0||m!==null&&(m.flags&128)!==0)for(m=S.child;m!==null;){if(fe=ad(m),fe!==null){for(S.flags|=128,Sp(ee,!1),m=fe.updateQueue,S.updateQueue=m,ld(S,m),S.subtreeFlags=0,m=A,A=S.child;A!==null;)hp(A,m),A=A.sibling;return le(_o,_o.current&1|2),S.child}m=m.sibling}ee.tail!==null&&ze()>$t&&(S.flags|=128,L=!0,Sp(ee,!1),S.lanes=4194304)}else{if(!L)if(m=ad(fe),m!==null){if(S.flags|=128,L=!0,m=m.updateQueue,S.updateQueue=m,ld(S,m),Sp(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!fe.alternate&&!ti)return ca(S),null}else 2*ze()-ee.renderingStartTime>$t&&A!==536870912&&(S.flags|=128,L=!0,Sp(ee,!1),S.lanes=4194304);ee.isBackwards?(fe.sibling=S.child,S.child=fe):(m=ee.last,m!==null?m.sibling=fe:S.child=fe,ee.last=fe)}return ee.tail!==null?(S=ee.tail,ee.rendering=S,ee.tail=S.sibling,ee.renderingStartTime=ze(),S.sibling=null,m=_o.current,le(_o,L?m&1|2:m&1),S):(ca(S),null);case 22:case 23:return lf(S),ul(),L=S.memoizedState!==null,m!==null?m.memoizedState!==null!==L&&(S.flags|=8192):L&&(S.flags|=8192),L?(A&536870912)!==0&&(S.flags&128)===0&&(ca(S),S.subtreeFlags&6&&(S.flags|=8192)):ca(S),A=S.updateQueue,A!==null&&ld(S,A.retryQueue),A=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),L=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(L=S.memoizedState.cachePool.pool),L!==A&&(S.flags|=2048),m!==null&&ne(Zl),null;case 24:return A=null,m!==null&&(A=m.memoizedState.cache),S.memoizedState.cache!==A&&(S.flags|=2048),Qc(yr),ca(S),null;case 25:return null;case 30:return null}throw Error(r(156,S.tag))}function _l(m,S){switch(Zs(S),S.tag){case 1:return m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 3:return Qc(yr),Ae(),m=S.flags,(m&65536)!==0&&(m&128)===0?(S.flags=m&-65537|128,S):null;case 26:case 27:case 5:return $e(S),null;case 13:if(lf(S),m=S.memoizedState,m!==null&&m.dehydrated!==null){if(S.alternate===null)throw Error(r(340));Jn()}return m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 19:return ne(_o),null;case 4:return Ae(),null;case 10:return Qc(S.type),null;case 22:case 23:return lf(S),ul(),m!==null&&ne(Zl),m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 24:return Qc(yr),null;case 25:return null;default:return null}}function vl(m,S){switch(Zs(S),S.tag){case 3:Qc(yr),Ae();break;case 26:case 27:case 5:$e(S);break;case 4:Ae();break;case 13:lf(S);break;case 19:ne(_o);break;case 10:Qc(S.type);break;case 22:case 23:lf(S),ul(),m!==null&&ne(Zl);break;case 24:Qc(yr)}}function Fc(m,S){try{var A=S.updateQueue,L=A!==null?A.lastEffect:null;if(L!==null){var ee=L.next;A=ee;do{if((A.tag&m)===m){L=void 0;var fe=A.create,He=A.inst;L=fe(),He.destroy=L}A=A.next}while(A!==ee)}}catch(Qe){Ct(S,S.return,Qe)}}function Ji(m,S,A){try{var L=S.updateQueue,ee=L!==null?L.lastEffect:null;if(ee!==null){var fe=ee.next;L=fe;do{if((L.tag&m)===m){var He=L.inst,Qe=He.destroy;if(Qe!==void 0){He.destroy=void 0,ee=S;var Et=A,Qt=Qe;try{Qt()}catch(vn){Ct(ee,Et,vn)}}}L=L.next}while(L!==fe)}}catch(vn){Ct(S,S.return,vn)}}function Jr(m){var S=m.updateQueue;if(S!==null){var A=m.stateNode;try{Id(S,A)}catch(L){Ct(m,m.return,L)}}}function ao(m,S,A){A.props=nu(m.type,m.memoizedProps),A.state=m.memoizedState;try{A.componentWillUnmount()}catch(L){Ct(m,S,L)}}function vh(m,S){try{var A=m.ref;if(A!==null){switch(m.tag){case 26:case 27:case 5:var L=m.stateNode;break;case 30:L=m.stateNode;break;default:L=m.stateNode}typeof A=="function"?m.refCleanup=A(L):A.current=L}}catch(ee){Ct(m,S,ee)}}function yl(m,S){var A=m.ref,L=m.refCleanup;if(A!==null)if(typeof L=="function")try{L()}catch(ee){Ct(m,S,ee)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(ee){Ct(m,S,ee)}else A.current=null}function va(m){var S=m.type,A=m.memoizedProps,L=m.stateNode;try{e:switch(S){case"button":case"input":case"select":case"textarea":A.autoFocus&&L.focus();break e;case"img":A.src?L.src=A.src:A.srcSet&&(L.srcset=A.srcSet)}}catch(ee){Ct(m,m.return,ee)}}function Wo(m,S,A){try{var L=m.stateNode;_Ee(L,m.type,A,S),L[Yt]=S}catch(ee){Ct(m,m.return,ee)}}function zd(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Ib(m.type)||m.tag===4}function zf(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||zd(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Ib(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function su(m,S,A){var L=m.tag;if(L===5||L===6)m=m.stateNode,S?(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A).insertBefore(m,S):(S=A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,S.appendChild(m),A=A._reactRootContainer,A!=null||S.onclick!==null||(S.onclick=B3));else if(L!==4&&(L===27&&Ib(m.type)&&(A=m.stateNode,S=null),m=m.child,m!==null))for(su(m,S,A),m=m.sibling;m!==null;)su(m,S,A),m=m.sibling}function au(m,S,A){var L=m.tag;if(L===5||L===6)m=m.stateNode,S?A.insertBefore(m,S):A.appendChild(m);else if(L!==4&&(L===27&&Ib(m.type)&&(A=m.stateNode),m=m.child,m!==null))for(au(m,S,A),m=m.sibling;m!==null;)au(m,S,A),m=m.sibling}function yh(m){var S=m.stateNode,A=m.memoizedProps;try{for(var L=m.type,ee=S.attributes;ee.length;)S.removeAttributeNode(ee[0]);md(S,L,A),S[Bt]=m,S[Yt]=A}catch(fe){Ct(m,m.return,fe)}}var uf=!1,ua=!1,jd=!1,ou=typeof WeakSet=="function"?WeakSet:Set,$s=null;function Io(m,S){if(m=m.containerInfo,$6=G3,m=vi(m),Ki(m)){if("selectionStart"in m)var A={start:m.selectionStart,end:m.selectionEnd};else e:{A=(A=m.ownerDocument)&&A.defaultView||window;var L=A.getSelection&&A.getSelection();if(L&&L.rangeCount!==0){A=L.anchorNode;var ee=L.anchorOffset,fe=L.focusNode;L=L.focusOffset;try{A.nodeType,fe.nodeType}catch{A=null;break e}var He=0,Qe=-1,Et=-1,Qt=0,vn=0,xn=m,rn=null;t:for(;;){for(var on;xn!==A||ee!==0&&xn.nodeType!==3||(Qe=He+ee),xn!==fe||L!==0&&xn.nodeType!==3||(Et=He+L),xn.nodeType===3&&(He+=xn.nodeValue.length),(on=xn.firstChild)!==null;)rn=xn,xn=on;for(;;){if(xn===m)break t;if(rn===A&&++Qt===ee&&(Qe=He),rn===fe&&++vn===L&&(Et=He),(on=xn.nextSibling)!==null)break;xn=rn,rn=xn.parentNode}xn=on}A=Qe===-1||Et===-1?null:{start:Qe,end:Et}}else A=null}A=A||{start:0,end:0}}else A=null;for(W6={focusedElem:m,selectionRange:A},G3=!1,$s=S;$s!==null;)if(S=$s,m=S.child,(S.subtreeFlags&1024)!==0&&m!==null)m.return=S,$s=m;else for(;$s!==null;){switch(S=$s,fe=S.alternate,m=S.flags,S.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&fe!==null){m=void 0,A=S,ee=fe.memoizedProps,fe=fe.memoizedState,L=A.stateNode;try{var ki=nu(A.type,ee,A.elementType===A.type);m=L.getSnapshotBeforeUpdate(ki,fe),L.__reactInternalSnapshotBeforeUpdate=m}catch(di){Ct(A,A.return,di)}}break;case 3:if((m&1024)!==0){if(m=S.stateNode.containerInfo,A=m.nodeType,A===9)K6(m);else if(A===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":K6(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(r(163))}if(m=S.sibling,m!==null){m.return=S.return,$s=m;break}$s=S.return}}function cd(m,S,A){var L=A.flags;switch(A.tag){case 0:case 11:case 15:hi(m,A),L&4&&Fc(5,A);break;case 1:if(hi(m,A),L&4)if(m=A.stateNode,S===null)try{m.componentDidMount()}catch(He){Ct(A,A.return,He)}else{var ee=nu(A.type,S.memoizedProps);S=S.memoizedState;try{m.componentDidUpdate(ee,S,m.__reactInternalSnapshotBeforeUpdate)}catch(He){Ct(A,A.return,He)}}L&64&&Jr(A),L&512&&vh(A,A.return);break;case 3:if(hi(m,A),L&64&&(m=A.updateQueue,m!==null)){if(S=null,A.child!==null)switch(A.child.tag){case 27:case 5:S=A.child.stateNode;break;case 1:S=A.child.stateNode}try{Id(m,S)}catch(He){Ct(A,A.return,He)}}break;case 27:S===null&&L&4&&yh(A);case 26:case 5:hi(m,A),S===null&&L&4&&va(A),L&512&&vh(A,A.return);break;case 12:hi(m,A);break;case 13:hi(m,A),L&4&&bh(m,A),L&64&&(m=A.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(A=ba.bind(null,A),TEe(m,A))));break;case 22:if(L=A.memoizedState!==null||uf,!L){S=S!==null&&S.memoizedState!==null||ua,ee=uf;var fe=ua;uf=L,(ua=S)&&!fe?Sh(m,A,(A.subtreeFlags&8772)!==0):hi(m,A),uf=ee,ua=fe}break;case 30:break;default:hi(m,A)}}function bi(m){var S=m.alternate;S!==null&&(m.alternate=null,bi(S)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(S=m.stateNode,S!==null&&er(S)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var ar=null,Bi=!1;function Yo(m,S,A){for(A=A.child;A!==null;)ud(m,S,A),A=A.sibling}function ud(m,S,A){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ct,A)}catch{}switch(A.tag){case 26:ua||yl(A,S),Yo(m,S,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:ua||yl(A,S);var L=ar,ee=Bi;Ib(A.type)&&(ar=A.stateNode,Bi=!1),Yo(m,S,A),TR(A.stateNode),ar=L,Bi=ee;break;case 5:ua||yl(A,S);case 6:if(L=ar,ee=Bi,ar=null,Yo(m,S,A),ar=L,Bi=ee,ar!==null)if(Bi)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(A.stateNode)}catch(fe){Ct(A,S,fe)}else try{ar.removeChild(A.stateNode)}catch(fe){Ct(A,S,fe)}break;case 18:ar!==null&&(Bi?(m=ar,g$(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,A.stateNode),IR(m)):g$(ar,A.stateNode));break;case 4:L=ar,ee=Bi,ar=A.stateNode.containerInfo,Bi=!0,Yo(m,S,A),ar=L,Bi=ee;break;case 0:case 11:case 14:case 15:ua||Ji(2,A,S),ua||Ji(4,A,S),Yo(m,S,A);break;case 1:ua||(yl(A,S),L=A.stateNode,typeof L.componentWillUnmount=="function"&&ao(A,S,L)),Yo(m,S,A);break;case 21:Yo(m,S,A);break;case 22:ua=(L=ua)||A.memoizedState!==null,Yo(m,S,A),ua=L;break;default:Yo(m,S,A)}}function bh(m,S){if(S.memoizedState===null&&(m=S.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{IR(m)}catch(A){Ct(S,S.return,A)}}function vg(m){switch(m.tag){case 13:case 19:var S=m.stateNode;return S===null&&(S=m.stateNode=new ou),S;case 22:return m=m.stateNode,S=m._retryCache,S===null&&(S=m._retryCache=new ou),S;default:throw Error(r(435,m.tag))}}function No(m,S){var A=vg(m);S.forEach(function(L){var ee=Kr.bind(null,m,L);A.has(L)||(A.add(L),L.then(ee,ee))})}function ps(m,S){var A=S.deletions;if(A!==null)for(var L=0;L<A.length;L++){var ee=A[L],fe=m,He=S,Qe=He;e:for(;Qe!==null;){switch(Qe.tag){case 27:if(Ib(Qe.type)){ar=Qe.stateNode,Bi=!1;break e}break;case 5:ar=Qe.stateNode,Bi=!1;break e;case 3:case 4:ar=Qe.stateNode.containerInfo,Bi=!0;break e}Qe=Qe.return}if(ar===null)throw Error(r(160));ud(fe,He,ee),ar=null,Bi=!1,fe=ee.alternate,fe!==null&&(fe.return=null),ee.return=null}if(S.subtreeFlags&13878)for(S=S.child;S!==null;)nc(S,m),S=S.sibling}var Qs=null;function nc(m,S){var A=m.alternate,L=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ps(S,m),ks(m),L&4&&(Ji(3,m,m.return),Fc(3,m),Ji(5,m,m.return));break;case 1:ps(S,m),ks(m),L&512&&(ua||A===null||yl(A,A.return)),L&64&&uf&&(m=m.updateQueue,m!==null&&(L=m.callbacks,L!==null&&(A=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=A===null?L:A.concat(L))));break;case 26:var ee=Qs;if(ps(S,m),ks(m),L&512&&(ua||A===null||yl(A,A.return)),L&4){var fe=A!==null?A.memoizedState:null;if(L=m.memoizedState,A===null)if(L===null)if(m.stateNode===null){e:{L=m.type,A=m.memoizedProps,ee=ee.ownerDocument||ee;t:switch(L){case"title":fe=ee.getElementsByTagName("title")[0],(!fe||fe[Wn]||fe[Bt]||fe.namespaceURI==="http://www.w3.org/2000/svg"||fe.hasAttribute("itemprop"))&&(fe=ee.createElement(L),ee.head.insertBefore(fe,ee.querySelector("head > title"))),md(fe,L,A),fe[Bt]=m,_i(fe),L=fe;break e;case"link":var He=T$("link","href",ee).get(L+(A.href||""));if(He){for(var Qe=0;Qe<He.length;Qe++)if(fe=He[Qe],fe.getAttribute("href")===(A.href==null||A.href===""?null:A.href)&&fe.getAttribute("rel")===(A.rel==null?null:A.rel)&&fe.getAttribute("title")===(A.title==null?null:A.title)&&fe.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){He.splice(Qe,1);break t}}fe=ee.createElement(L),md(fe,L,A),ee.head.appendChild(fe);break;case"meta":if(He=T$("meta","content",ee).get(L+(A.content||""))){for(Qe=0;Qe<He.length;Qe++)if(fe=He[Qe],fe.getAttribute("content")===(A.content==null?null:""+A.content)&&fe.getAttribute("name")===(A.name==null?null:A.name)&&fe.getAttribute("property")===(A.property==null?null:A.property)&&fe.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&fe.getAttribute("charset")===(A.charSet==null?null:A.charSet)){He.splice(Qe,1);break t}}fe=ee.createElement(L),md(fe,L,A),ee.head.appendChild(fe);break;default:throw Error(r(468,L))}fe[Bt]=m,_i(fe),L=fe}m.stateNode=L}else w$(ee,m.type,m.stateNode);else m.stateNode=x$(ee,L,m.memoizedProps);else fe!==L?(fe===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):fe.count--,L===null?w$(ee,m.type,m.stateNode):x$(ee,L,m.memoizedProps)):L===null&&m.stateNode!==null&&Wo(m,m.memoizedProps,A.memoizedProps)}break;case 27:ps(S,m),ks(m),L&512&&(ua||A===null||yl(A,A.return)),A!==null&&L&4&&Wo(m,m.memoizedProps,A.memoizedProps);break;case 5:if(ps(S,m),ks(m),L&512&&(ua||A===null||yl(A,A.return)),m.flags&32){ee=m.stateNode;try{So(ee,"")}catch(on){Ct(m,m.return,on)}}L&4&&m.stateNode!=null&&(ee=m.memoizedProps,Wo(m,ee,A!==null?A.memoizedProps:ee)),L&1024&&(jd=!0);break;case 6:if(ps(S,m),ks(m),L&4){if(m.stateNode===null)throw Error(r(162));L=m.memoizedProps,A=m.stateNode;try{A.nodeValue=L}catch(on){Ct(m,m.return,on)}}break;case 3:if(H3=null,ee=Qs,Qs=z3(S.containerInfo),ps(S,m),Qs=ee,ks(m),L&4&&A!==null&&A.memoizedState.isDehydrated)try{IR(S.containerInfo)}catch(on){Ct(m,m.return,on)}jd&&(jd=!1,ff(m));break;case 4:L=Qs,Qs=z3(m.stateNode.containerInfo),ps(S,m),ks(m),Qs=L;break;case 12:ps(S,m),ks(m);break;case 13:ps(S,m),ks(m),m.child.flags&8192&&m.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(Gt=ze()),L&4&&(L=m.updateQueue,L!==null&&(m.updateQueue=null,No(m,L)));break;case 22:ee=m.memoizedState!==null;var Et=A!==null&&A.memoizedState!==null,Qt=uf,vn=ua;if(uf=Qt||ee,ua=vn||Et,ps(S,m),ua=vn,uf=Qt,ks(m),L&8192)e:for(S=m.stateNode,S._visibility=ee?S._visibility&-2:S._visibility|1,ee&&(A===null||Et||uf||ua||lu(m)),A=null,S=m;;){if(S.tag===5||S.tag===26){if(A===null){Et=A=S;try{if(fe=Et.stateNode,ee)He=fe.style,typeof He.setProperty=="function"?He.setProperty("display","none","important"):He.display="none";else{Qe=Et.stateNode;var xn=Et.memoizedProps.style,rn=xn!=null&&xn.hasOwnProperty("display")?xn.display:null;Qe.style.display=rn==null||typeof rn=="boolean"?"":(""+rn).trim()}}catch(on){Ct(Et,Et.return,on)}}}else if(S.tag===6){if(A===null){Et=S;try{Et.stateNode.nodeValue=ee?"":Et.memoizedProps}catch(on){Ct(Et,Et.return,on)}}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===m)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===m)break e;for(;S.sibling===null;){if(S.return===null||S.return===m)break e;A===S&&(A=null),S=S.return}A===S&&(A=null),S.sibling.return=S.return,S=S.sibling}L&4&&(L=m.updateQueue,L!==null&&(A=L.retryQueue,A!==null&&(L.retryQueue=null,No(m,A))));break;case 19:ps(S,m),ks(m),L&4&&(L=m.updateQueue,L!==null&&(m.updateQueue=null,No(m,L)));break;case 30:break;case 21:break;default:ps(S,m),ks(m)}}function ks(m){var S=m.flags;if(S&2){try{for(var A,L=m.return;L!==null;){if(zd(L)){A=L;break}L=L.return}if(A==null)throw Error(r(160));switch(A.tag){case 27:var ee=A.stateNode,fe=zf(m);au(m,fe,ee);break;case 5:var He=A.stateNode;A.flags&32&&(So(He,""),A.flags&=-33);var Qe=zf(m);au(m,Qe,He);break;case 3:case 4:var Et=A.stateNode.containerInfo,Qt=zf(m);su(m,Qt,Et);break;default:throw Error(r(161))}}catch(vn){Ct(m,m.return,vn)}m.flags&=-3}S&4096&&(m.flags&=-4097)}function ff(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var S=m;ff(S),S.tag===5&&S.flags&1024&&S.stateNode.reset(),m=m.sibling}}function hi(m,S){if(S.subtreeFlags&8772)for(S=S.child;S!==null;)cd(m,S.alternate,S),S=S.sibling}function lu(m){for(m=m.child;m!==null;){var S=m;switch(S.tag){case 0:case 11:case 14:case 15:Ji(4,S,S.return),lu(S);break;case 1:yl(S,S.return);var A=S.stateNode;typeof A.componentWillUnmount=="function"&&ao(S,S.return,A),lu(S);break;case 27:TR(S.stateNode);case 26:case 5:yl(S,S.return),lu(S);break;case 22:S.memoizedState===null&&lu(S);break;case 30:lu(S);break;default:lu(S)}m=m.sibling}}function Sh(m,S,A){for(A=A&&(S.subtreeFlags&8772)!==0,S=S.child;S!==null;){var L=S.alternate,ee=m,fe=S,He=fe.flags;switch(fe.tag){case 0:case 11:case 15:Sh(ee,fe,A),Fc(4,fe);break;case 1:if(Sh(ee,fe,A),L=fe,ee=L.stateNode,typeof ee.componentDidMount=="function")try{ee.componentDidMount()}catch(Qt){Ct(L,L.return,Qt)}if(L=fe,ee=L.updateQueue,ee!==null){var Qe=L.stateNode;try{var Et=ee.shared.hiddenCallbacks;if(Et!==null)for(ee.shared.hiddenCallbacks=null,ee=0;ee<Et.length;ee++)eu(Et[ee],Qe)}catch(Qt){Ct(L,L.return,Qt)}}A&&He&64&&Jr(fe),vh(fe,fe.return);break;case 27:yh(fe);case 26:case 5:Sh(ee,fe,A),A&&L===null&&He&4&&va(fe),vh(fe,fe.return);break;case 12:Sh(ee,fe,A);break;case 13:Sh(ee,fe,A),A&&He&4&&bh(ee,fe);break;case 22:fe.memoizedState===null&&Sh(ee,fe,A),vh(fe,fe.return);break;case 30:break;default:Sh(ee,fe,A)}S=S.sibling}}function fd(m,S){var A=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),m=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(m=S.memoizedState.cachePool.pool),m!==A&&(m!=null&&m.refCount++,A!=null&&Kl(A))}function hm(m,S){m=null,S.alternate!==null&&(m=S.alternate.memoizedState.cache),S=S.memoizedState.cache,S!==m&&(S.refCount++,m!=null&&Kl(m))}function ya(m,S,A,L){if(S.subtreeFlags&10256)for(S=S.child;S!==null;)jf(m,S,A,L),S=S.sibling}function jf(m,S,A,L){var ee=S.flags;switch(S.tag){case 0:case 11:case 15:ya(m,S,A,L),ee&2048&&Fc(9,S);break;case 1:ya(m,S,A,L);break;case 3:ya(m,S,A,L),ee&2048&&(m=null,S.alternate!==null&&(m=S.alternate.memoizedState.cache),S=S.memoizedState.cache,S!==m&&(S.refCount++,m!=null&&Kl(m)));break;case 12:if(ee&2048){ya(m,S,A,L),m=S.stateNode;try{var fe=S.memoizedProps,He=fe.id,Qe=fe.onPostCommit;typeof Qe=="function"&&Qe(He,S.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Et){Ct(S,S.return,Et)}}else ya(m,S,A,L);break;case 13:ya(m,S,A,L);break;case 23:break;case 22:fe=S.stateNode,He=S.alternate,S.memoizedState!==null?fe._visibility&2?ya(m,S,A,L):j(m,S):fe._visibility&2?ya(m,S,A,L):(fe._visibility|=2,Uu(m,S,A,L,(S.subtreeFlags&10256)!==0)),ee&2048&&fd(He,S);break;case 24:ya(m,S,A,L),ee&2048&&hm(S.alternate,S);break;default:ya(m,S,A,L)}}function Uu(m,S,A,L,ee){for(ee=ee&&(S.subtreeFlags&10256)!==0,S=S.child;S!==null;){var fe=m,He=S,Qe=A,Et=L,Qt=He.flags;switch(He.tag){case 0:case 11:case 15:Uu(fe,He,Qe,Et,ee),Fc(8,He);break;case 23:break;case 22:var vn=He.stateNode;He.memoizedState!==null?vn._visibility&2?Uu(fe,He,Qe,Et,ee):j(fe,He):(vn._visibility|=2,Uu(fe,He,Qe,Et,ee)),ee&&Qt&2048&&fd(He.alternate,He);break;case 24:Uu(fe,He,Qe,Et,ee),ee&&Qt&2048&&hm(He.alternate,He);break;default:Uu(fe,He,Qe,Et,ee)}S=S.sibling}}function j(m,S){if(S.subtreeFlags&10256)for(S=S.child;S!==null;){var A=m,L=S,ee=L.flags;switch(L.tag){case 22:j(A,L),ee&2048&&fd(L.alternate,L);break;case 24:j(A,L),ee&2048&&hm(L.alternate,L);break;default:j(A,L)}S=S.sibling}}var C=8192;function P(m){if(m.subtreeFlags&C)for(m=m.child;m!==null;)H(m),m=m.sibling}function H(m){switch(m.tag){case 26:P(m),m.flags&C&&m.memoizedState!==null&&UEe(Qs,m.memoizedState,m.memoizedProps);break;case 5:P(m);break;case 3:case 4:var S=Qs;Qs=z3(m.stateNode.containerInfo),P(m),Qs=S;break;case 22:m.memoizedState===null&&(S=m.alternate,S!==null&&S.memoizedState!==null?(S=C,C=16777216,P(m),C=S):P(m));break;default:P(m)}}function X(m){var S=m.alternate;if(S!==null&&(m=S.child,m!==null)){S.child=null;do S=m.sibling,m.sibling=null,m=S;while(m!==null)}}function te(m){var S=m.deletions;if((m.flags&16)!==0){if(S!==null)for(var A=0;A<S.length;A++){var L=S[A];$s=L,w(L,m)}X(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)ue(m),m=m.sibling}function ue(m){switch(m.tag){case 0:case 11:case 15:te(m),m.flags&2048&&Ji(9,m,m.return);break;case 3:te(m);break;case 12:te(m);break;case 22:var S=m.stateNode;m.memoizedState!==null&&S._visibility&2&&(m.return===null||m.return.tag!==13)?(S._visibility&=-3,Ee(m)):te(m);break;default:te(m)}}function Ee(m){var S=m.deletions;if((m.flags&16)!==0){if(S!==null)for(var A=0;A<S.length;A++){var L=S[A];$s=L,w(L,m)}X(m)}for(m=m.child;m!==null;){switch(S=m,S.tag){case 0:case 11:case 15:Ji(8,S,S.return),Ee(S);break;case 22:A=S.stateNode,A._visibility&2&&(A._visibility&=-3,Ee(S));break;default:Ee(S)}m=m.sibling}}function w(m,S){for(;$s!==null;){var A=$s;switch(A.tag){case 0:case 11:case 15:Ji(8,A,S);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var L=A.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:Kl(A.memoizedState.cache)}if(L=A.child,L!==null)L.return=A,$s=L;else e:for(A=m;$s!==null;){L=$s;var ee=L.sibling,fe=L.return;if(bi(L),L===A){$s=null;break e}if(ee!==null){ee.return=fe,$s=ee;break e}$s=fe}}}var d={getCacheForType:function(m){var S=Pa(yr),A=S.data.get(m);return A===void 0&&(A=m(),S.data.set(m,A)),A}},b=typeof WeakMap=="function"?WeakMap:Map,O=0,F=null,ie=null,pe=0,ye=0,Re=null,Pe=!1,Fe=!1,Ye=!1,dt=0,xt=0,Dt=0,bt=0,gt=0,kt=0,wt=0,It=null,Ft=null,Zt=!1,Gt=0,$t=1/0,dn=null,Rn=null,Nn=0,qn=null,Dn=null,gr=0,Br=0,Oi=null,oi=null,li=0,Fi=null;function Yr(){if((O&2)!==0&&pe!==0)return pe&-pe;if(W.T!==null){var m=zr;return m!==0?m:F6()}return _t()}function Ss(){kt===0&&(kt=(pe&536870912)===0||ti?Ve():536870912);var m=Vs.current;return m!==null&&(m.flags|=32),kt}function ci(m,S,A){(m===F&&(ye===2||ye===9)||m.cancelPendingCommit!==null)&&(Dl(m,0),Ns(m,pe,kt,!1)),nt(m,A),((O&2)===0||m!==F)&&(m===F&&((O&2)===0&&(bt|=A),xt===4&&Ns(m,pe,kt,!1)),yg(m))}function Is(m,S,A){if((O&6)!==0)throw Error(r(327));var L=!A&&(S&124)===0&&(S&m.expiredLanes)===0||we(m,S),ee=L?re(m,S):R(m,S,!0),fe=L;do{if(ee===0){Fe&&!L&&Ns(m,S,0,!1);break}else{if(A=m.current.alternate,fe&&!ea(A)){ee=R(m,S,!1),fe=!1;continue}if(ee===2){if(fe=S,m.errorRecoveryDisabledLanes&fe)var He=0;else He=m.pendingLanes&-536870913,He=He!==0?He:He&536870912?536870912:0;if(He!==0){S=He;e:{var Qe=m;ee=It;var Et=Qe.current.memoizedState.isDehydrated;if(Et&&(Dl(Qe,He).flags|=256),He=R(Qe,He,!1),He!==2){if(Ye&&!Et){Qe.errorRecoveryDisabledLanes|=fe,bt|=fe,ee=4;break e}fe=Ft,Ft=ee,fe!==null&&(Ft===null?Ft=fe:Ft.push.apply(Ft,fe))}ee=He}if(fe=!1,ee!==2)continue}}if(ee===1){Dl(m,0),Ns(m,S,0,!0);break}e:{switch(L=m,fe=ee,fe){case 0:case 1:throw Error(r(345));case 4:if((S&4194048)!==S)break;case 6:Ns(L,S,kt,!Pe);break e;case 2:Ft=null;break;case 3:case 5:break;default:throw Error(r(329))}if((S&62914560)===S&&(ee=Gt+300-ze(),10<ee)){if(Ns(L,S,kt,!Pe),Oe(L,0,!0)!==0)break e;L.timeoutHandle=p$($i.bind(null,L,A,Ft,dn,Zt,S,kt,bt,wt,Pe,fe,2,-0,0),ee);break e}$i(L,A,Ft,dn,Zt,S,kt,bt,wt,Pe,fe,0,-0,0)}}break}while(!0);yg(m)}function $i(m,S,A,L,ee,fe,He,Qe,Et,Qt,vn,xn,rn,on){if(m.timeoutHandle=-1,xn=S.subtreeFlags,(xn&8192||(xn&16785408)===16785408)&&(AR={stylesheets:null,count:0,unsuspend:LEe},H(S),xn=BEe(),xn!==null)){m.cancelPendingCommit=xn(Ln.bind(null,m,S,fe,A,L,ee,He,Qe,Et,vn,1,rn,on)),Ns(m,fe,He,!Qt);return}Ln(m,S,fe,A,L,ee,He,Qe,Et)}function ea(m){for(var S=m;;){var A=S.tag;if((A===0||A===11||A===15)&&S.flags&16384&&(A=S.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var L=0;L<A.length;L++){var ee=A[L],fe=ee.getSnapshot;ee=ee.value;try{if(!fo(fe(),ee))return!1}catch{return!1}}if(A=S.child,S.subtreeFlags&16384&&A!==null)A.return=S,S=A;else{if(S===m)break;for(;S.sibling===null;){if(S.return===null||S.return===m)return!0;S=S.return}S.sibling.return=S.return,S=S.sibling}}return!0}function Ns(m,S,A,L){S&=~gt,S&=~bt,m.suspendedLanes|=S,m.pingedLanes&=~S,L&&(m.warmLanes|=S),L=m.expirationTimes;for(var ee=S;0<ee;){var fe=31-Ut(ee),He=1<<fe;L[fe]=-1,ee&=~He}A!==0&&Je(m,A,S)}function ms(){return(O&6)===0?(lS(0),!1):!0}function vo(){if(ie!==null){if(ye===0)var m=ie.return;else m=ie,Jc=Nf=null,_p(m),bp=null,fm=0,m=ie;for(;m!==null;)vl(m.alternate,m),m=m.return;ie=null}}function Dl(m,S){var A=m.timeoutHandle;A!==-1&&(m.timeoutHandle=-1,yEe(A)),A=m.cancelPendingCommit,A!==null&&(m.cancelPendingCommit=null,A()),vo(),F=m,ie=A=_a(m.current,null),pe=S,ye=0,Re=null,Pe=!1,Fe=we(m,S),Ye=!1,wt=kt=gt=bt=Dt=xt=0,Ft=It=null,Zt=!1,(S&8)!==0&&(S|=S&32);var L=m.entangledLanes;if(L!==0)for(m=m.entanglements,L&=S;0<L;){var ee=31-Ut(L),fe=1<<ee;S|=m[ee],L&=~fe}return dt=S,po(),A}function yc(m,S){Zr=null,W.H=sd,S===kd||S===to?(S=rf(),ye=3):S===Au?(S=rf(),ye=4):ye=S===Ra?8:S!==null&&typeof S=="object"&&typeof S.then=="function"?6:1,Re=S,ie===null&&(xt=1,Ff(m,eo(S,m.current)))}function cu(){var m=W.H;return W.H=sd,m===null?sd:m}function Bu(){var m=W.A;return W.A=d,m}function T(){xt=4,Pe||(pe&4194048)!==pe&&Vs.current!==null||(Fe=!0),(Dt&134217727)===0&&(bt&134217727)===0||F===null||Ns(F,pe,kt,!1)}function R(m,S,A){var L=O;O|=2;var ee=cu(),fe=Bu();(F!==m||pe!==S)&&(dn=null,Dl(m,S)),S=!1;var He=xt;e:do try{if(ye!==0&&ie!==null){var Qe=ie,Et=Re;switch(ye){case 8:vo(),He=6;break e;case 3:case 2:case 9:case 6:Vs.current===null&&(S=!0);var Qt=ye;if(ye=0,Re=null,yt(m,Qe,Et,Qt),A&&Fe){He=0;break e}break;default:Qt=ye,ye=0,Re=null,yt(m,Qe,Et,Qt)}}z(),He=xt;break}catch(vn){yc(m,vn)}while(!0);return S&&m.shellSuspendCounter++,Jc=Nf=null,O=L,W.H=ee,W.A=fe,ie===null&&(F=null,pe=0,po()),He}function z(){for(;ie!==null;)Te(ie)}function re(m,S){var A=O;O|=2;var L=cu(),ee=Bu();F!==m||pe!==S?(dn=null,$t=ze()+500,Dl(m,S)):Fe=we(m,S);e:do try{if(ye!==0&&ie!==null){S=ie;var fe=Re;t:switch(ye){case 1:ye=0,Re=null,yt(m,S,fe,1);break;case 2:case 9:if(Uc(fe)){ye=0,Re=null,et(S);break}S=function(){ye!==2&&ye!==9||F!==m||(ye=7),yg(m)},fe.then(S,S);break e;case 3:ye=7;break e;case 4:ye=5;break e;case 7:Uc(fe)?(ye=0,Re=null,et(S)):(ye=0,Re=null,yt(m,S,fe,7));break;case 5:var He=null;switch(ie.tag){case 26:He=ie.memoizedState;case 5:case 27:var Qe=ie;if(!He||R$(He)){ye=0,Re=null;var Et=Qe.sibling;if(Et!==null)ie=Et;else{var Qt=Qe.return;Qt!==null?(ie=Qt,zt(Qt)):ie=null}break t}}ye=0,Re=null,yt(m,S,fe,5);break;case 6:ye=0,Re=null,yt(m,S,fe,6);break;case 8:vo(),xt=6;break e;default:throw Error(r(462))}}he();break}catch(vn){yc(m,vn)}while(!0);return Jc=Nf=null,W.H=L,W.A=ee,O=A,ie!==null?0:(F=null,pe=0,po(),xt)}function he(){for(;ie!==null&&!Ue();)Te(ie)}function Te(m){var S=iu(m.alternate,m,dt);m.memoizedProps=m.pendingProps,S===null?zt(m):ie=S}function et(m){var S=m,A=S.alternate;switch(S.tag){case 15:case 0:S=Gi(A,S,S.pendingProps,S.type,void 0,pe);break;case 11:S=Gi(A,S,S.pendingProps,S.type.render,S.ref,pe);break;case 5:_p(S);default:vl(A,S),S=ie=hp(S,dt),S=iu(A,S,dt)}m.memoizedProps=m.pendingProps,S===null?zt(m):ie=S}function yt(m,S,A,L){Jc=Nf=null,_p(S),bp=null,fm=0;var ee=S.return;try{if(oa(m,ee,S,A,pe)){xt=1,Ff(m,eo(A,m.current)),ie=null;return}}catch(fe){if(ee!==null)throw ie=ee,fe;xt=1,Ff(m,eo(A,m.current)),ie=null;return}S.flags&32768?(ti||L===1?m=!0:Fe||(pe&536870912)!==0?m=!1:(Pe=m=!0,(L===2||L===9||L===3||L===6)&&(L=Vs.current,L!==null&&L.tag===13&&(L.flags|=16384))),mn(S,m)):zt(S)}function zt(m){var S=m;do{if((S.flags&32768)!==0){mn(S,Pe);return}m=S.return;var A=Ep(S.alternate,S,dt);if(A!==null){ie=A;return}if(S=S.sibling,S!==null){ie=S;return}ie=S=m}while(S!==null);xt===0&&(xt=5)}function mn(m,S){do{var A=_l(m.alternate,m);if(A!==null){A.flags&=32767,ie=A;return}if(A=m.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!S&&(m=m.sibling,m!==null)){ie=m;return}ie=m=A}while(m!==null);xt=6,ie=null}function Ln(m,S,A,L,ee,fe,He,Qe,Et){m.cancelPendingCommit=null;do hd();while(Nn!==0);if((O&6)!==0)throw Error(r(327));if(S!==null){if(S===m.current)throw Error(r(177));if(fe=S.lanes|S.childLanes,fe|=ho,vt(m,A,fe,He,Qe,Et),m===F&&(ie=F=null,pe=0),Dn=S,qn=m,gr=A,Br=fe,Oi=ee,oi=L,(S.subtreeFlags&10256)!==0||(S.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,Es(ke,function(){return dd(),null})):(m.callbackNode=null,m.callbackPriority=0),L=(S.flags&13878)!==0,(S.subtreeFlags&13878)!==0||L){L=W.T,W.T=null,ee=q.p,q.p=2,He=O,O|=4;try{Io(m,S,A)}finally{O=He,q.p=ee,W.T=L}}Nn=1,Qn(),nr(),Xr()}}function Qn(){if(Nn===1){Nn=0;var m=qn,S=Dn,A=(S.flags&13878)!==0;if((S.subtreeFlags&13878)!==0||A){A=W.T,W.T=null;var L=q.p;q.p=2;var ee=O;O|=4;try{nc(S,m);var fe=W6,He=vi(m.containerInfo),Qe=fe.focusedElem,Et=fe.selectionRange;if(He!==Qe&&Qe&&Qe.ownerDocument&&Jg(Qe.ownerDocument.documentElement,Qe)){if(Et!==null&&Ki(Qe)){var Qt=Et.start,vn=Et.end;if(vn===void 0&&(vn=Qt),"selectionStart"in Qe)Qe.selectionStart=Qt,Qe.selectionEnd=Math.min(vn,Qe.value.length);else{var xn=Qe.ownerDocument||document,rn=xn&&xn.defaultView||window;if(rn.getSelection){var on=rn.getSelection(),ki=Qe.textContent.length,di=Math.min(Et.start,ki),Ko=Et.end===void 0?di:Math.min(Et.end,ki);!on.extend&&di>Ko&&(He=Ko,Ko=di,di=He);var Ht=sg(Qe,di),Nt=sg(Qe,Ko);if(Ht&&Nt&&(on.rangeCount!==1||on.anchorNode!==Ht.node||on.anchorOffset!==Ht.offset||on.focusNode!==Nt.node||on.focusOffset!==Nt.offset)){var Xt=xn.createRange();Xt.setStart(Ht.node,Ht.offset),on.removeAllRanges(),di>Ko?(on.addRange(Xt),on.extend(Nt.node,Nt.offset)):(Xt.setEnd(Nt.node,Nt.offset),on.addRange(Xt))}}}}for(xn=[],on=Qe;on=on.parentNode;)on.nodeType===1&&xn.push({element:on,left:on.scrollLeft,top:on.scrollTop});for(typeof Qe.focus=="function"&&Qe.focus(),Qe=0;Qe<xn.length;Qe++){var Sn=xn[Qe];Sn.element.scrollLeft=Sn.left,Sn.element.scrollTop=Sn.top}}G3=!!$6,W6=$6=null}finally{O=ee,q.p=L,W.T=A}}m.current=S,Nn=2}}function nr(){if(Nn===2){Nn=0;var m=qn,S=Dn,A=(S.flags&8772)!==0;if((S.subtreeFlags&8772)!==0||A){A=W.T,W.T=null;var L=q.p;q.p=2;var ee=O;O|=4;try{cd(m,S.alternate,S)}finally{O=ee,q.p=L,W.T=A}}Nn=3}}function Xr(){if(Nn===4||Nn===3){Nn=0,Ge();var m=qn,S=Dn,A=gr,L=oi;(S.subtreeFlags&10256)!==0||(S.flags&10256)!==0?Nn=5:(Nn=0,Dn=qn=null,uu(m,m.pendingLanes));var ee=m.pendingLanes;if(ee===0&&(Rn=null),ft(A),S=S.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ct,S,void 0,(S.current.flags&128)===128)}catch{}if(L!==null){S=W.T,ee=q.p,q.p=2,W.T=null;try{for(var fe=m.onRecoverableError,He=0;He<L.length;He++){var Qe=L[He];fe(Qe.value,{componentStack:Qe.stack})}}finally{W.T=S,q.p=ee}}(gr&3)!==0&&hd(),yg(m),ee=m.pendingLanes,(A&4194090)!==0&&(ee&42)!==0?m===Fi?li++:(li=0,Fi=m):li=0,lS(0)}}function uu(m,S){(m.pooledCacheLanes&=S)===0&&(S=m.pooledCache,S!=null&&(m.pooledCache=null,Kl(S)))}function hd(m){return Qn(),nr(),Xr(),dd()}function dd(){if(Nn!==5)return!1;var m=qn,S=Br;Br=0;var A=ft(gr),L=W.T,ee=q.p;try{q.p=32>A?32:A,W.T=null,A=Oi,Oi=null;var fe=qn,He=gr;if(Nn=0,Dn=qn=null,gr=0,(O&6)!==0)throw Error(r(331));var Qe=O;if(O|=4,ue(fe.current),jf(fe,fe.current,He,A),O=Qe,lS(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ct,fe)}catch{}return!0}finally{q.p=ee,W.T=L,uu(m,S)}}function Jt(m,S,A){S=eo(A,S),S=Ar(m.stateNode,S,2),m=Pf(m,S,2),m!==null&&(nt(m,2),yg(m))}function Ct(m,S,A){if(m.tag===3)Jt(m,m,A);else for(;S!==null;){if(S.tag===3){Jt(S,m,A);break}else if(S.tag===1){var L=S.stateNode;if(typeof S.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(Rn===null||!Rn.has(L))){m=eo(A,m),A=_c(2),L=Pf(S,A,2),L!==null&&(Ui(A,L,S,m),nt(L,2),yg(L));break}}S=S.return}}function nn(m,S,A){var L=m.pingCache;if(L===null){L=m.pingCache=new b;var ee=new Set;L.set(S,ee)}else ee=L.get(S),ee===void 0&&(ee=new Set,L.set(S,ee));ee.has(A)||(Ye=!0,ee.add(A),m=Un.bind(null,m,S,A),S.then(m,m))}function Un(m,S,A){var L=m.pingCache;L!==null&&L.delete(S),m.pingedLanes|=m.suspendedLanes&A,m.warmLanes&=~A,F===m&&(pe&A)===A&&(xt===4||xt===3&&(pe&62914560)===pe&&300>ze()-Gt?(O&2)===0&&Dl(m,0):gt|=A,wt===pe&&(wt=0)),yg(m)}function Or(m,S){S===0&&(S=tt()),m=Ti(m,S),m!==null&&(nt(m,S),yg(m))}function ba(m){var S=m.memoizedState,A=0;S!==null&&(A=S.retryLane),Or(m,A)}function Kr(m,S){var A=0;switch(m.tag){case 13:var L=m.stateNode,ee=m.memoizedState;ee!==null&&(A=ee.retryLane);break;case 19:L=m.stateNode;break;case 22:L=m.stateNode._retryCache;break;default:throw Error(r(314))}L!==null&&L.delete(S),Or(m,A)}function Es(m,S){return pt(m,S)}var Ca=null,Qi=null,pd=!1,o_=!1,bR=!1,tv=0;function yg(m){m!==Qi&&m.next===null&&(Qi===null?Ca=Qi=m:Qi=Qi.next=m),o_=!0,pd||(pd=!0,uEe())}function lS(m,S){if(!bR&&o_){bR=!0;do for(var A=!1,L=Ca;L!==null;){if(m!==0){var ee=L.pendingLanes;if(ee===0)var fe=0;else{var He=L.suspendedLanes,Qe=L.pingedLanes;fe=(1<<31-Ut(42|m)+1)-1,fe&=ee&~(He&~Qe),fe=fe&201326741?fe&201326741|1:fe?fe|2:0}fe!==0&&(A=!0,D3(L,fe))}else fe=pe,fe=Oe(L,L===F?fe:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(fe&3)===0||we(L,fe)||(A=!0,D3(L,fe));L=L.next}while(A);bR=!1}}function N3(){SR()}function SR(){o_=pd=!1;var m=0;tv!==0&&(vEe()&&(m=tv),tv=0);for(var S=ze(),A=null,L=Ca;L!==null;){var ee=L.next,fe=P3(L,S);fe===0?(L.next=null,A===null?Ca=ee:A.next=ee,ee===null&&(Qi=A)):(A=L,(m!==0||(fe&3)!==0)&&(o_=!0)),L=ee}lS(m)}function P3(m,S){for(var A=m.suspendedLanes,L=m.pingedLanes,ee=m.expirationTimes,fe=m.pendingLanes&-62914561;0<fe;){var He=31-Ut(fe),Qe=1<<He,Et=ee[He];Et===-1?((Qe&A)===0||(Qe&L)!==0)&&(ee[He]=st(Qe,S)):Et<=S&&(m.expiredLanes|=Qe),fe&=~Qe}if(S=F,A=pe,A=Oe(m,m===S?A:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),L=m.callbackNode,A===0||m===S&&(ye===2||ye===9)||m.cancelPendingCommit!==null)return L!==null&&L!==null&&oe(L),m.callbackNode=null,m.callbackPriority=0;if((A&3)===0||we(m,A)){if(S=A&-A,S===m.callbackPriority)return S;switch(L!==null&&oe(L),ft(A)){case 2:case 8:A=Se;break;case 32:A=ke;break;case 268435456:A=Ke;break;default:A=ke}return L=cy.bind(null,m),A=pt(A,L),m.callbackPriority=S,m.callbackNode=A,S}return L!==null&&L!==null&&oe(L),m.callbackPriority=2,m.callbackNode=null,2}function cy(m,S){if(Nn!==0&&Nn!==5)return m.callbackNode=null,m.callbackPriority=0,null;var A=m.callbackNode;if(hd()&&m.callbackNode!==A)return null;var L=pe;return L=Oe(m,m===F?L:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),L===0?null:(Is(m,L,S),P3(m,ze()),m.callbackNode!=null&&m.callbackNode===A?cy.bind(null,m):null)}function D3(m,S){if(hd())return null;Is(m,S,!0)}function uEe(){bEe(function(){(O&6)!==0?pt(me,N3):SR()})}function F6(){return tv===0&&(tv=Ve()),tv}function s$(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:rh(""+m)}function a$(m,S){var A=S.ownerDocument.createElement("input");return A.name=S.name,A.value=S.value,m.id&&A.setAttribute("form",m.id),S.parentNode.insertBefore(A,S),m=new FormData(m),A.parentNode.removeChild(A),m}function fEe(m,S,A,L,ee){if(S==="submit"&&A&&A.stateNode===ee){var fe=s$((ee[Yt]||null).action),He=L.submitter;He&&(S=(S=He[Yt]||null)?s$(S.formAction):He.getAttribute("formAction"),S!==null&&(fe=S,He=null));var Qe=new sh("action","action",null,L,ee);m.push({event:Qe,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(tv!==0){var Et=He?a$(ee,He):new FormData(ee);dg(A,{pending:!0,data:Et,method:ee.method,action:fe},null,Et)}}else typeof fe=="function"&&(Qe.preventDefault(),Et=He?a$(ee,He):new FormData(ee),dg(A,{pending:!0,data:Et,method:ee.method,action:fe},fe,Et))},currentTarget:ee}]})}}for(var z6=0;z6<Fr.length;z6++){var j6=Fr[z6],hEe=j6.toLowerCase(),dEe=j6[0].toUpperCase()+j6.slice(1);ve(hEe,"on"+dEe)}ve(As,"onAnimationEnd"),ve(Qg,"onAnimationIteration"),ve(Ks,"onAnimationStart"),ve("dblclick","onDoubleClick"),ve("focusin","onFocus"),ve("focusout","onBlur"),ve(e_,"onTransitionRun"),ve(Al,"onTransitionStart"),ve(fp,"onTransitionCancel"),ve(Ho,"onTransitionEnd"),We("onMouseEnter",["mouseout","mouseover"]),We("onMouseLeave",["mouseout","mouseover"]),We("onPointerEnter",["pointerout","pointerover"]),We("onPointerLeave",["pointerout","pointerover"]),ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ls("onBeforeInput",["compositionend","keypress","textInput","paste"]),ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ER="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pEe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ER));function o$(m,S){S=(S&4)!==0;for(var A=0;A<m.length;A++){var L=m[A],ee=L.event;L=L.listeners;e:{var fe=void 0;if(S)for(var He=L.length-1;0<=He;He--){var Qe=L[He],Et=Qe.instance,Qt=Qe.currentTarget;if(Qe=Qe.listener,Et!==fe&&ee.isPropagationStopped())break e;fe=Qe,ee.currentTarget=Qt;try{fe(ee)}catch(vn){Fd(vn)}ee.currentTarget=null,fe=Et}else for(He=0;He<L.length;He++){if(Qe=L[He],Et=Qe.instance,Qt=Qe.currentTarget,Qe=Qe.listener,Et!==fe&&ee.isPropagationStopped())break e;fe=Qe,ee.currentTarget=Qt;try{fe(ee)}catch(vn){Fd(vn)}ee.currentTarget=null,fe=Et}}}}function ta(m,S){var A=S[fn];A===void 0&&(A=S[fn]=new Set);var L=m+"__bubble";A.has(L)||(l$(S,m,2,!1),A.add(L))}function H6(m,S,A){var L=0;S&&(L|=4),l$(A,m,L,S)}var L3="_reactListening"+Math.random().toString(36).slice(2);function q6(m){if(!m[L3]){m[L3]=!0,Rs.forEach(function(A){A!=="selectionchange"&&(pEe.has(A)||H6(A,!1,m),H6(A,!0,m))});var S=m.nodeType===9?m:m.ownerDocument;S===null||S[L3]||(S[L3]=!0,H6("selectionchange",!1,S))}}function l$(m,S,A,L){switch(I$(S)){case 2:var ee=jEe;break;case 8:ee=HEe;break;default:ee=r5}A=ee.bind(null,S,A,m),ee=void 0,!Xi||S!=="touchstart"&&S!=="touchmove"&&S!=="wheel"||(ee=!0),L?ee!==void 0?m.addEventListener(S,A,{capture:!0,passive:ee}):m.addEventListener(S,A,!0):ee!==void 0?m.addEventListener(S,A,{passive:ee}):m.addEventListener(S,A,!1)}function V6(m,S,A,L,ee){var fe=L;if((S&1)===0&&(S&2)===0&&L!==null)e:for(;;){if(L===null)return;var He=L.tag;if(He===3||He===4){var Qe=L.stateNode.containerInfo;if(Qe===ee)break;if(He===4)for(He=L.return;He!==null;){var Et=He.tag;if((Et===3||Et===4)&&He.stateNode.containerInfo===ee)return;He=He.return}for(;Qe!==null;){if(He=os(Qe),He===null)return;if(Et=He.tag,Et===5||Et===6||Et===26||Et===27){L=fe=He;continue e}Qe=Qe.parentNode}}L=L.return}Wc(function(){var Qt=fe,vn=cc(A),xn=[];e:{var rn=fc.get(m);if(rn!==void 0){var on=sh,ki=m;switch(m){case"keypress":if(Yc(A)===0)break e;case"keydown":case"keyup":on=qh;break;case"focusin":ki="focus",on=eg;break;case"focusout":ki="blur",on=eg;break;case"beforeblur":case"afterblur":on=eg;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":on=$l;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":on=Kp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":on=tn;break;case As:case Qg:case Ks:on=$_;break;case Ho:on=Zn;break;case"scroll":case"scrollend":on=Qm;break;case"wheel":on=al;break;case"copy":case"cut":case"paste":on=jh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":on=Tt;break;case"toggle":case"beforetoggle":on=Eo}var di=(S&4)!==0,Ko=!di&&(m==="scroll"||m==="scrollend"),Ht=di?rn!==null?rn+"Capture":null:rn;di=[];for(var Nt=Qt,Xt;Nt!==null;){var Sn=Nt;if(Xt=Sn.stateNode,Sn=Sn.tag,Sn!==5&&Sn!==26&&Sn!==27||Xt===null||Ht===null||(Sn=Yu(Nt,Ht),Sn!=null&&di.push(xR(Nt,Sn,Xt))),Ko)break;Nt=Nt.return}0<di.length&&(rn=new on(rn,ki,null,A,vn),xn.push({event:rn,listeners:di}))}}if((S&7)===0){e:{if(rn=m==="mouseover"||m==="pointerover",on=m==="mouseout"||m==="pointerout",rn&&A!==wl&&(ki=A.relatedTarget||A.fromElement)&&(os(ki)||ki[Mt]))break e;if((on||rn)&&(rn=vn.window===vn?vn:(rn=vn.ownerDocument)?rn.defaultView||rn.parentWindow:window,on?(ki=A.relatedTarget||A.toElement,on=Qt,ki=ki?os(ki):null,ki!==null&&(Ko=s(ki),di=ki.tag,ki!==Ko||di!==5&&di!==27&&di!==6)&&(ki=null)):(on=null,ki=Qt),on!==ki)){if(di=$l,Sn="onMouseLeave",Ht="onMouseEnter",Nt="mouse",(m==="pointerout"||m==="pointerover")&&(di=Tt,Sn="onPointerLeave",Ht="onPointerEnter",Nt="pointer"),Ko=on==null?rn:Ni(on),Xt=ki==null?rn:Ni(ki),rn=new di(Sn,Nt+"leave",on,A,vn),rn.target=Ko,rn.relatedTarget=Xt,Sn=null,os(vn)===Qt&&(di=new di(Ht,Nt+"enter",ki,A,vn),di.target=Xt,di.relatedTarget=Ko,Sn=di),Ko=Sn,on&&ki)t:{for(di=on,Ht=ki,Nt=0,Xt=di;Xt;Xt=Rx(Xt))Nt++;for(Xt=0,Sn=Ht;Sn;Sn=Rx(Sn))Xt++;for(;0<Nt-Xt;)di=Rx(di),Nt--;for(;0<Xt-Nt;)Ht=Rx(Ht),Xt--;for(;Nt--;){if(di===Ht||Ht!==null&&di===Ht.alternate)break t;di=Rx(di),Ht=Rx(Ht)}di=null}else di=null;on!==null&&c$(xn,rn,on,di,!1),ki!==null&&Ko!==null&&c$(xn,Ko,ki,di,!0)}}e:{if(rn=Qt?Ni(Qt):window,on=rn.nodeName&&rn.nodeName.toLowerCase(),on==="select"||on==="input"&&rn.type==="file")var kr=uh;else if(rg(rn))if(Zp)kr=kc;else{kr=Y_;var Ws=W_}else on=rn.nodeName,!on||on.toLowerCase()!=="input"||rn.type!=="checkbox"&&rn.type!=="radio"?Qt&&op(Qt.elementType)&&(kr=uh):kr=ig;if(kr&&(kr=kr(m,Qt))){xo(xn,kr,A,vn);break e}Ws&&Ws(m,rn,Qt),m==="focusout"&&Qt&&rn.type==="number"&&Qt.memoizedProps.value!=null&&Xn(rn,"number",rn.value)}switch(Ws=Qt?Ni(Qt):window,m){case"focusin":(rg(Ws)||Ws.contentEditable==="true")&&(hh=Ws,up=Qt,Fn=null);break;case"focusout":Fn=up=hh=null;break;case"mousedown":js=!0;break;case"contextmenu":case"mouseup":case"dragend":js=!1,Mf(xn,A,vn);break;case"selectionchange":if(ag)break;case"keydown":case"keyup":Mf(xn,A,vn)}var $r;if(rs)e:{switch(m){case"compositionstart":var Si="onCompositionStart";break e;case"compositionend":Si="onCompositionEnd";break e;case"compositionupdate":Si="onCompositionUpdate";break e}Si=void 0}else ch?vr(m,A)&&(Si="onCompositionEnd"):m==="keydown"&&A.keyCode===229&&(Si="onCompositionStart");Si&&(sr&&A.locale!=="ko"&&(ch||Si!=="onCompositionStart"?Si==="onCompositionEnd"&&ch&&($r=uo()):(Ef=vn,Jm="value"in Ef?Ef.value:Ef.textContent,ch=!0)),Ws=U3(Qt,Si),0<Ws.length&&(Si=new Ku(Si,m,null,A,vn),xn.push({event:Si,listeners:Ws}),$r?Si.data=$r:($r=Gr(A),$r!==null&&(Si.data=$r)))),($r=lh?Rf(m,A):Q0(m,A))&&(Si=U3(Qt,"onBeforeInput"),0<Si.length&&(Ws=new Ku("onBeforeInput","beforeinput",null,A,vn),xn.push({event:Ws,listeners:Si}),Ws.data=$r)),fEe(xn,m,Qt,A,vn)}o$(xn,S)})}function xR(m,S,A){return{instance:m,listener:S,currentTarget:A}}function U3(m,S){for(var A=S+"Capture",L=[];m!==null;){var ee=m,fe=ee.stateNode;if(ee=ee.tag,ee!==5&&ee!==26&&ee!==27||fe===null||(ee=Yu(m,A),ee!=null&&L.unshift(xR(m,ee,fe)),ee=Yu(m,S),ee!=null&&L.push(xR(m,ee,fe))),m.tag===3)return L;m=m.return}return[]}function Rx(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function c$(m,S,A,L,ee){for(var fe=S._reactName,He=[];A!==null&&A!==L;){var Qe=A,Et=Qe.alternate,Qt=Qe.stateNode;if(Qe=Qe.tag,Et!==null&&Et===L)break;Qe!==5&&Qe!==26&&Qe!==27||Qt===null||(Et=Qt,ee?(Qt=Yu(A,fe),Qt!=null&&He.unshift(xR(A,Qt,Et))):ee||(Qt=Yu(A,fe),Qt!=null&&He.push(xR(A,Qt,Et)))),A=A.return}He.length!==0&&m.push({event:S,listeners:He})}var mEe=/\r\n?/g,gEe=/\u0000|\uFFFD/g;function u$(m){return(typeof m=="string"?m:""+m).replace(mEe,`
`).replace(gEe,"")}function f$(m,S){return S=u$(S),u$(m)===S}function B3(){}function Xo(m,S,A,L,ee,fe){switch(A){case"children":typeof L=="string"?S==="body"||S==="textarea"&&L===""||So(m,L):(typeof L=="number"||typeof L=="bigint")&&S!=="body"&&So(m,""+L);break;case"className":zn(m,"class",L);break;case"tabIndex":zn(m,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":zn(m,A,L);break;case"style":zh(m,L,fe);break;case"data":if(S!=="object"){zn(m,"data",L);break}case"src":case"href":if(L===""&&(S!=="a"||A!=="href")){m.removeAttribute(A);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){m.removeAttribute(A);break}L=rh(""+L),m.setAttribute(A,L);break;case"action":case"formAction":if(typeof L=="function"){m.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof fe=="function"&&(A==="formAction"?(S!=="input"&&Xo(m,S,"name",ee.name,ee,null),Xo(m,S,"formEncType",ee.formEncType,ee,null),Xo(m,S,"formMethod",ee.formMethod,ee,null),Xo(m,S,"formTarget",ee.formTarget,ee,null)):(Xo(m,S,"encType",ee.encType,ee,null),Xo(m,S,"method",ee.method,ee,null),Xo(m,S,"target",ee.target,ee,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){m.removeAttribute(A);break}L=rh(""+L),m.setAttribute(A,L);break;case"onClick":L!=null&&(m.onclick=B3);break;case"onScroll":L!=null&&ta("scroll",m);break;case"onScrollEnd":L!=null&&ta("scrollend",m);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(r(61));if(A=L.__html,A!=null){if(ee.children!=null)throw Error(r(60));m.innerHTML=A}}break;case"multiple":m.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":m.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){m.removeAttribute("xlink:href");break}A=rh(""+L),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,""+L):m.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,""):m.removeAttribute(A);break;case"capture":case"download":L===!0?m.setAttribute(A,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,L):m.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?m.setAttribute(A,L):m.removeAttribute(A);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?m.removeAttribute(A):m.setAttribute(A,L);break;case"popover":ta("beforetoggle",m),ta("toggle",m),yn(m,"popover",L);break;case"xlinkActuate":En(m,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":En(m,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":En(m,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":En(m,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":En(m,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":En(m,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":En(m,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":En(m,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":En(m,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":yn(m,"is",L);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=Wp.get(A)||A,yn(m,A,L))}}function G6(m,S,A,L,ee,fe){switch(A){case"style":zh(m,L,fe);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(r(61));if(A=L.__html,A!=null){if(ee.children!=null)throw Error(r(60));m.innerHTML=A}}break;case"children":typeof L=="string"?So(m,L):(typeof L=="number"||typeof L=="bigint")&&So(m,""+L);break;case"onScroll":L!=null&&ta("scroll",m);break;case"onScrollEnd":L!=null&&ta("scrollend",m);break;case"onClick":L!=null&&(m.onclick=B3);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ra.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(ee=A.endsWith("Capture"),S=A.slice(2,ee?A.length-7:void 0),fe=m[Yt]||null,fe=fe!=null?fe[A]:null,typeof fe=="function"&&m.removeEventListener(S,fe,ee),typeof L=="function")){typeof fe!="function"&&fe!==null&&(A in m?m[A]=null:m.hasAttribute(A)&&m.removeAttribute(A)),m.addEventListener(S,L,ee);break e}A in m?m[A]=L:L===!0?m.setAttribute(A,""):yn(m,A,L)}}}function md(m,S,A){switch(S){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ta("error",m),ta("load",m);var L=!1,ee=!1,fe;for(fe in A)if(A.hasOwnProperty(fe)){var He=A[fe];if(He!=null)switch(fe){case"src":L=!0;break;case"srcSet":ee=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,S));default:Xo(m,S,fe,He,A,null)}}ee&&Xo(m,S,"srcSet",A.srcSet,A,null),L&&Xo(m,S,"src",A.src,A,null);return;case"input":ta("invalid",m);var Qe=fe=He=ee=null,Et=null,Qt=null;for(L in A)if(A.hasOwnProperty(L)){var vn=A[L];if(vn!=null)switch(L){case"name":ee=vn;break;case"type":He=vn;break;case"checked":Et=vn;break;case"defaultChecked":Qt=vn;break;case"value":fe=vn;break;case"defaultValue":Qe=vn;break;case"children":case"dangerouslySetInnerHTML":if(vn!=null)throw Error(r(137,S));break;default:Xo(m,S,L,vn,A,null)}}us(m,fe,Qe,Et,Qt,He,ee,!1),Dr(m);return;case"select":ta("invalid",m),L=He=fe=null;for(ee in A)if(A.hasOwnProperty(ee)&&(Qe=A[ee],Qe!=null))switch(ee){case"value":fe=Qe;break;case"defaultValue":He=Qe;break;case"multiple":L=Qe;default:Xo(m,S,ee,Qe,A,null)}S=fe,A=He,m.multiple=!!L,S!=null?ei(m,!!L,S,!1):A!=null&&ei(m,!!L,A,!0);return;case"textarea":ta("invalid",m),fe=ee=L=null;for(He in A)if(A.hasOwnProperty(He)&&(Qe=A[He],Qe!=null))switch(He){case"value":L=Qe;break;case"defaultValue":ee=Qe;break;case"children":fe=Qe;break;case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(r(91));break;default:Xo(m,S,He,Qe,A,null)}zs(m,L,ee,fe),Dr(m);return;case"option":for(Et in A)if(A.hasOwnProperty(Et)&&(L=A[Et],L!=null))switch(Et){case"selected":m.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:Xo(m,S,Et,L,A,null)}return;case"dialog":ta("beforetoggle",m),ta("toggle",m),ta("cancel",m),ta("close",m);break;case"iframe":case"object":ta("load",m);break;case"video":case"audio":for(L=0;L<ER.length;L++)ta(ER[L],m);break;case"image":ta("error",m),ta("load",m);break;case"details":ta("toggle",m);break;case"embed":case"source":case"link":ta("error",m),ta("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qt in A)if(A.hasOwnProperty(Qt)&&(L=A[Qt],L!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,S));default:Xo(m,S,Qt,L,A,null)}return;default:if(op(S)){for(vn in A)A.hasOwnProperty(vn)&&(L=A[vn],L!==void 0&&G6(m,S,vn,L,A,void 0));return}}for(Qe in A)A.hasOwnProperty(Qe)&&(L=A[Qe],L!=null&&Xo(m,S,Qe,L,A,null))}function _Ee(m,S,A,L){switch(S){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var ee=null,fe=null,He=null,Qe=null,Et=null,Qt=null,vn=null;for(on in A){var xn=A[on];if(A.hasOwnProperty(on)&&xn!=null)switch(on){case"checked":break;case"value":break;case"defaultValue":Et=xn;default:L.hasOwnProperty(on)||Xo(m,S,on,null,L,xn)}}for(var rn in L){var on=L[rn];if(xn=A[rn],L.hasOwnProperty(rn)&&(on!=null||xn!=null))switch(rn){case"type":fe=on;break;case"name":ee=on;break;case"checked":Qt=on;break;case"defaultChecked":vn=on;break;case"value":He=on;break;case"defaultValue":Qe=on;break;case"children":case"dangerouslySetInnerHTML":if(on!=null)throw Error(r(137,S));break;default:on!==xn&&Xo(m,S,rn,on,L,xn)}}Bo(m,He,Qe,Et,Qt,vn,fe,ee);return;case"select":on=He=Qe=rn=null;for(fe in A)if(Et=A[fe],A.hasOwnProperty(fe)&&Et!=null)switch(fe){case"value":break;case"multiple":on=Et;default:L.hasOwnProperty(fe)||Xo(m,S,fe,null,L,Et)}for(ee in L)if(fe=L[ee],Et=A[ee],L.hasOwnProperty(ee)&&(fe!=null||Et!=null))switch(ee){case"value":rn=fe;break;case"defaultValue":Qe=fe;break;case"multiple":He=fe;default:fe!==Et&&Xo(m,S,ee,fe,L,Et)}S=Qe,A=He,L=on,rn!=null?ei(m,!!A,rn,!1):!!L!=!!A&&(S!=null?ei(m,!!A,S,!0):ei(m,!!A,A?[]:"",!1));return;case"textarea":on=rn=null;for(Qe in A)if(ee=A[Qe],A.hasOwnProperty(Qe)&&ee!=null&&!L.hasOwnProperty(Qe))switch(Qe){case"value":break;case"children":break;default:Xo(m,S,Qe,null,L,ee)}for(He in L)if(ee=L[He],fe=A[He],L.hasOwnProperty(He)&&(ee!=null||fe!=null))switch(He){case"value":rn=ee;break;case"defaultValue":on=ee;break;case"children":break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(91));break;default:ee!==fe&&Xo(m,S,He,ee,L,fe)}ur(m,rn,on);return;case"option":for(var ki in A)if(rn=A[ki],A.hasOwnProperty(ki)&&rn!=null&&!L.hasOwnProperty(ki))switch(ki){case"selected":m.selected=!1;break;default:Xo(m,S,ki,null,L,rn)}for(Et in L)if(rn=L[Et],on=A[Et],L.hasOwnProperty(Et)&&rn!==on&&(rn!=null||on!=null))switch(Et){case"selected":m.selected=rn&&typeof rn!="function"&&typeof rn!="symbol";break;default:Xo(m,S,Et,rn,L,on)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var di in A)rn=A[di],A.hasOwnProperty(di)&&rn!=null&&!L.hasOwnProperty(di)&&Xo(m,S,di,null,L,rn);for(Qt in L)if(rn=L[Qt],on=A[Qt],L.hasOwnProperty(Qt)&&rn!==on&&(rn!=null||on!=null))switch(Qt){case"children":case"dangerouslySetInnerHTML":if(rn!=null)throw Error(r(137,S));break;default:Xo(m,S,Qt,rn,L,on)}return;default:if(op(S)){for(var Ko in A)rn=A[Ko],A.hasOwnProperty(Ko)&&rn!==void 0&&!L.hasOwnProperty(Ko)&&G6(m,S,Ko,void 0,L,rn);for(vn in L)rn=L[vn],on=A[vn],!L.hasOwnProperty(vn)||rn===on||rn===void 0&&on===void 0||G6(m,S,vn,rn,L,on);return}}for(var Ht in A)rn=A[Ht],A.hasOwnProperty(Ht)&&rn!=null&&!L.hasOwnProperty(Ht)&&Xo(m,S,Ht,null,L,rn);for(xn in L)rn=L[xn],on=A[xn],!L.hasOwnProperty(xn)||rn===on||rn==null&&on==null||Xo(m,S,xn,rn,L,on)}var $6=null,W6=null;function F3(m){return m.nodeType===9?m:m.ownerDocument}function h$(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function d$(m,S){if(m===0)switch(S){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&S==="foreignObject"?0:m}function Y6(m,S){return m==="textarea"||m==="noscript"||typeof S.children=="string"||typeof S.children=="number"||typeof S.children=="bigint"||typeof S.dangerouslySetInnerHTML=="object"&&S.dangerouslySetInnerHTML!==null&&S.dangerouslySetInnerHTML.__html!=null}var X6=null;function vEe(){var m=window.event;return m&&m.type==="popstate"?m===X6?!1:(X6=m,!0):(X6=null,!1)}var p$=typeof setTimeout=="function"?setTimeout:void 0,yEe=typeof clearTimeout=="function"?clearTimeout:void 0,m$=typeof Promise=="function"?Promise:void 0,bEe=typeof queueMicrotask=="function"?queueMicrotask:typeof m$<"u"?function(m){return m$.resolve(null).then(m).catch(SEe)}:p$;function SEe(m){setTimeout(function(){throw m})}function Ib(m){return m==="head"}function g$(m,S){var A=S,L=0,ee=0;do{var fe=A.nextSibling;if(m.removeChild(A),fe&&fe.nodeType===8)if(A=fe.data,A==="/$"){if(0<L&&8>L){A=L;var He=m.ownerDocument;if(A&1&&TR(He.documentElement),A&2&&TR(He.body),A&4)for(A=He.head,TR(A),He=A.firstChild;He;){var Qe=He.nextSibling,Et=He.nodeName;He[Wn]||Et==="SCRIPT"||Et==="STYLE"||Et==="LINK"&&He.rel.toLowerCase()==="stylesheet"||A.removeChild(He),He=Qe}}if(ee===0){m.removeChild(fe),IR(S);return}ee--}else A==="$"||A==="$?"||A==="$!"?ee++:L=A.charCodeAt(0)-48;else L=0;A=fe}while(A);IR(S)}function K6(m){var S=m.firstChild;for(S&&S.nodeType===10&&(S=S.nextSibling);S;){var A=S;switch(S=S.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":K6(A),er(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}m.removeChild(A)}}function EEe(m,S,A,L){for(;m.nodeType===1;){var ee=A;if(m.nodeName.toLowerCase()!==S.toLowerCase()){if(!L&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(L){if(!m[Wn])switch(S){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(fe=m.getAttribute("rel"),fe==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(fe!==ee.rel||m.getAttribute("href")!==(ee.href==null||ee.href===""?null:ee.href)||m.getAttribute("crossorigin")!==(ee.crossOrigin==null?null:ee.crossOrigin)||m.getAttribute("title")!==(ee.title==null?null:ee.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(fe=m.getAttribute("src"),(fe!==(ee.src==null?null:ee.src)||m.getAttribute("type")!==(ee.type==null?null:ee.type)||m.getAttribute("crossorigin")!==(ee.crossOrigin==null?null:ee.crossOrigin))&&fe&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(S==="input"&&m.type==="hidden"){var fe=ee.name==null?null:""+ee.name;if(ee.type==="hidden"&&m.getAttribute("name")===fe)return m}else return m;if(m=l_(m.nextSibling),m===null)break}return null}function xEe(m,S,A){if(S==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!A||(m=l_(m.nextSibling),m===null))return null;return m}function Z6(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState==="complete"}function TEe(m,S){var A=m.ownerDocument;if(m.data!=="$?"||A.readyState==="complete")S();else{var L=function(){S(),A.removeEventListener("DOMContentLoaded",L)};A.addEventListener("DOMContentLoaded",L),m._reactRetry=L}}function l_(m){for(;m!=null;m=m.nextSibling){var S=m.nodeType;if(S===1||S===3)break;if(S===8){if(S=m.data,S==="$"||S==="$!"||S==="$?"||S==="F!"||S==="F")break;if(S==="/$")return null}}return m}var J6=null;function _$(m){m=m.previousSibling;for(var S=0;m;){if(m.nodeType===8){var A=m.data;if(A==="$"||A==="$!"||A==="$?"){if(S===0)return m;S--}else A==="/$"&&S++}m=m.previousSibling}return null}function v$(m,S,A){switch(S=F3(A),m){case"html":if(m=S.documentElement,!m)throw Error(r(452));return m;case"head":if(m=S.head,!m)throw Error(r(453));return m;case"body":if(m=S.body,!m)throw Error(r(454));return m;default:throw Error(r(451))}}function TR(m){for(var S=m.attributes;S.length;)m.removeAttributeNode(S[0]);er(m)}var h0=new Map,y$=new Set;function z3(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var uy=q.d;q.d={f:wEe,r:REe,D:AEe,C:CEe,L:MEe,m:OEe,X:IEe,S:kEe,M:NEe};function wEe(){var m=uy.f(),S=ms();return m||S}function REe(m){var S=gi(m);S!==null&&S.tag===5&&S.type==="form"?l0(S):uy.r(m)}var Ax=typeof document>"u"?null:document;function b$(m,S,A){var L=Ax;if(L&&typeof S=="string"&&S){var ee=cs(S);ee='link[rel="'+m+'"][href="'+ee+'"]',typeof A=="string"&&(ee+='[crossorigin="'+A+'"]'),y$.has(ee)||(y$.add(ee),m={rel:m,crossOrigin:A,href:S},L.querySelector(ee)===null&&(S=L.createElement("link"),md(S,"link",m),_i(S),L.head.appendChild(S)))}}function AEe(m){uy.D(m),b$("dns-prefetch",m,null)}function CEe(m,S){uy.C(m,S),b$("preconnect",m,S)}function MEe(m,S,A){uy.L(m,S,A);var L=Ax;if(L&&m&&S){var ee='link[rel="preload"][as="'+cs(S)+'"]';S==="image"&&A&&A.imageSrcSet?(ee+='[imagesrcset="'+cs(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(ee+='[imagesizes="'+cs(A.imageSizes)+'"]')):ee+='[href="'+cs(m)+'"]';var fe=ee;switch(S){case"style":fe=Cx(m);break;case"script":fe=Mx(m)}h0.has(fe)||(m=u({rel:"preload",href:S==="image"&&A&&A.imageSrcSet?void 0:m,as:S},A),h0.set(fe,m),L.querySelector(ee)!==null||S==="style"&&L.querySelector(wR(fe))||S==="script"&&L.querySelector(RR(fe))||(S=L.createElement("link"),md(S,"link",m),_i(S),L.head.appendChild(S)))}}function OEe(m,S){uy.m(m,S);var A=Ax;if(A&&m){var L=S&&typeof S.as=="string"?S.as:"script",ee='link[rel="modulepreload"][as="'+cs(L)+'"][href="'+cs(m)+'"]',fe=ee;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":fe=Mx(m)}if(!h0.has(fe)&&(m=u({rel:"modulepreload",href:m},S),h0.set(fe,m),A.querySelector(ee)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(RR(fe)))return}L=A.createElement("link"),md(L,"link",m),_i(L),A.head.appendChild(L)}}}function kEe(m,S,A){uy.S(m,S,A);var L=Ax;if(L&&m){var ee=Fs(L).hoistableStyles,fe=Cx(m);S=S||"default";var He=ee.get(fe);if(!He){var Qe={loading:0,preload:null};if(He=L.querySelector(wR(fe)))Qe.loading=5;else{m=u({rel:"stylesheet",href:m,"data-precedence":S},A),(A=h0.get(fe))&&Q6(m,A);var Et=He=L.createElement("link");_i(Et),md(Et,"link",m),Et._p=new Promise(function(Qt,vn){Et.onload=Qt,Et.onerror=vn}),Et.addEventListener("load",function(){Qe.loading|=1}),Et.addEventListener("error",function(){Qe.loading|=2}),Qe.loading|=4,j3(He,S,L)}He={type:"stylesheet",instance:He,count:1,state:Qe},ee.set(fe,He)}}}function IEe(m,S){uy.X(m,S);var A=Ax;if(A&&m){var L=Fs(A).hoistableScripts,ee=Mx(m),fe=L.get(ee);fe||(fe=A.querySelector(RR(ee)),fe||(m=u({src:m,async:!0},S),(S=h0.get(ee))&&e5(m,S),fe=A.createElement("script"),_i(fe),md(fe,"link",m),A.head.appendChild(fe)),fe={type:"script",instance:fe,count:1,state:null},L.set(ee,fe))}}function NEe(m,S){uy.M(m,S);var A=Ax;if(A&&m){var L=Fs(A).hoistableScripts,ee=Mx(m),fe=L.get(ee);fe||(fe=A.querySelector(RR(ee)),fe||(m=u({src:m,async:!0,type:"module"},S),(S=h0.get(ee))&&e5(m,S),fe=A.createElement("script"),_i(fe),md(fe,"link",m),A.head.appendChild(fe)),fe={type:"script",instance:fe,count:1,state:null},L.set(ee,fe))}}function S$(m,S,A,L){var ee=(ee=Me.current)?z3(ee):null;if(!ee)throw Error(r(446));switch(m){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(S=Cx(A.href),A=Fs(ee).hoistableStyles,L=A.get(S),L||(L={type:"style",instance:null,count:0,state:null},A.set(S,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){m=Cx(A.href);var fe=Fs(ee).hoistableStyles,He=fe.get(m);if(He||(ee=ee.ownerDocument||ee,He={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},fe.set(m,He),(fe=ee.querySelector(wR(m)))&&!fe._p&&(He.instance=fe,He.state.loading=5),h0.has(m)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},h0.set(m,A),fe||PEe(ee,m,A,He.state))),S&&L===null)throw Error(r(528,""));return He}if(S&&L!==null)throw Error(r(529,""));return null;case"script":return S=A.async,A=A.src,typeof A=="string"&&S&&typeof S!="function"&&typeof S!="symbol"?(S=Mx(A),A=Fs(ee).hoistableScripts,L=A.get(S),L||(L={type:"script",instance:null,count:0,state:null},A.set(S,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,m))}}function Cx(m){return'href="'+cs(m)+'"'}function wR(m){return'link[rel="stylesheet"]['+m+"]"}function E$(m){return u({},m,{"data-precedence":m.precedence,precedence:null})}function PEe(m,S,A,L){m.querySelector('link[rel="preload"][as="style"]['+S+"]")?L.loading=1:(S=m.createElement("link"),L.preload=S,S.addEventListener("load",function(){return L.loading|=1}),S.addEventListener("error",function(){return L.loading|=2}),md(S,"link",A),_i(S),m.head.appendChild(S))}function Mx(m){return'[src="'+cs(m)+'"]'}function RR(m){return"script[async]"+m}function x$(m,S,A){if(S.count++,S.instance===null)switch(S.type){case"style":var L=m.querySelector('style[data-href~="'+cs(A.href)+'"]');if(L)return S.instance=L,_i(L),L;var ee=u({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return L=(m.ownerDocument||m).createElement("style"),_i(L),md(L,"style",ee),j3(L,A.precedence,m),S.instance=L;case"stylesheet":ee=Cx(A.href);var fe=m.querySelector(wR(ee));if(fe)return S.state.loading|=4,S.instance=fe,_i(fe),fe;L=E$(A),(ee=h0.get(ee))&&Q6(L,ee),fe=(m.ownerDocument||m).createElement("link"),_i(fe);var He=fe;return He._p=new Promise(function(Qe,Et){He.onload=Qe,He.onerror=Et}),md(fe,"link",L),S.state.loading|=4,j3(fe,A.precedence,m),S.instance=fe;case"script":return fe=Mx(A.src),(ee=m.querySelector(RR(fe)))?(S.instance=ee,_i(ee),ee):(L=A,(ee=h0.get(fe))&&(L=u({},A),e5(L,ee)),m=m.ownerDocument||m,ee=m.createElement("script"),_i(ee),md(ee,"link",L),m.head.appendChild(ee),S.instance=ee);case"void":return null;default:throw Error(r(443,S.type))}else S.type==="stylesheet"&&(S.state.loading&4)===0&&(L=S.instance,S.state.loading|=4,j3(L,A.precedence,m));return S.instance}function j3(m,S,A){for(var L=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),ee=L.length?L[L.length-1]:null,fe=ee,He=0;He<L.length;He++){var Qe=L[He];if(Qe.dataset.precedence===S)fe=Qe;else if(fe!==ee)break}fe?fe.parentNode.insertBefore(m,fe.nextSibling):(S=A.nodeType===9?A.head:A,S.insertBefore(m,S.firstChild))}function Q6(m,S){m.crossOrigin==null&&(m.crossOrigin=S.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=S.referrerPolicy),m.title==null&&(m.title=S.title)}function e5(m,S){m.crossOrigin==null&&(m.crossOrigin=S.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=S.referrerPolicy),m.integrity==null&&(m.integrity=S.integrity)}var H3=null;function T$(m,S,A){if(H3===null){var L=new Map,ee=H3=new Map;ee.set(A,L)}else ee=H3,L=ee.get(A),L||(L=new Map,ee.set(A,L));if(L.has(m))return L;for(L.set(m,null),A=A.getElementsByTagName(m),ee=0;ee<A.length;ee++){var fe=A[ee];if(!(fe[Wn]||fe[Bt]||m==="link"&&fe.getAttribute("rel")==="stylesheet")&&fe.namespaceURI!=="http://www.w3.org/2000/svg"){var He=fe.getAttribute(S)||"";He=m+He;var Qe=L.get(He);Qe?Qe.push(fe):L.set(He,[fe])}}return L}function w$(m,S,A){m=m.ownerDocument||m,m.head.insertBefore(A,S==="title"?m.querySelector("head > title"):null)}function DEe(m,S,A){if(A===1||S.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof S.precedence!="string"||typeof S.href!="string"||S.href==="")break;return!0;case"link":if(typeof S.rel!="string"||typeof S.href!="string"||S.href===""||S.onLoad||S.onError)break;switch(S.rel){case"stylesheet":return m=S.disabled,typeof S.precedence=="string"&&m==null;default:return!0}case"script":if(S.async&&typeof S.async!="function"&&typeof S.async!="symbol"&&!S.onLoad&&!S.onError&&S.src&&typeof S.src=="string")return!0}return!1}function R$(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}var AR=null;function LEe(){}function UEe(m,S,A){if(AR===null)throw Error(r(475));var L=AR;if(S.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(S.state.loading&4)===0){if(S.instance===null){var ee=Cx(A.href),fe=m.querySelector(wR(ee));if(fe){m=fe._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(L.count++,L=q3.bind(L),m.then(L,L)),S.state.loading|=4,S.instance=fe,_i(fe);return}fe=m.ownerDocument||m,A=E$(A),(ee=h0.get(ee))&&Q6(A,ee),fe=fe.createElement("link"),_i(fe);var He=fe;He._p=new Promise(function(Qe,Et){He.onload=Qe,He.onerror=Et}),md(fe,"link",A),S.instance=fe}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(S,m),(m=S.state.preload)&&(S.state.loading&3)===0&&(L.count++,S=q3.bind(L),m.addEventListener("load",S),m.addEventListener("error",S))}}function BEe(){if(AR===null)throw Error(r(475));var m=AR;return m.stylesheets&&m.count===0&&t5(m,m.stylesheets),0<m.count?function(S){var A=setTimeout(function(){if(m.stylesheets&&t5(m,m.stylesheets),m.unsuspend){var L=m.unsuspend;m.unsuspend=null,L()}},6e4);return m.unsuspend=S,function(){m.unsuspend=null,clearTimeout(A)}}:null}function q3(){if(this.count--,this.count===0){if(this.stylesheets)t5(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var V3=null;function t5(m,S){m.stylesheets=null,m.unsuspend!==null&&(m.count++,V3=new Map,S.forEach(FEe,m),V3=null,q3.call(m))}function FEe(m,S){if(!(S.state.loading&4)){var A=V3.get(m);if(A)var L=A.get(null);else{A=new Map,V3.set(m,A);for(var ee=m.querySelectorAll("link[data-precedence],style[data-precedence]"),fe=0;fe<ee.length;fe++){var He=ee[fe];(He.nodeName==="LINK"||He.getAttribute("media")!=="not all")&&(A.set(He.dataset.precedence,He),L=He)}L&&A.set(null,L)}ee=S.instance,He=ee.getAttribute("data-precedence"),fe=A.get(He)||L,fe===L&&A.set(null,ee),A.set(He,ee),this.count++,L=q3.bind(this),ee.addEventListener("load",L),ee.addEventListener("error",L),fe?fe.parentNode.insertBefore(ee,fe.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(ee,m.firstChild)),S.state.loading|=4}}var CR={$$typeof:E,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function zEe(m,S,A,L,ee,fe,He,Qe){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=L,this.onUncaughtError=ee,this.onCaughtError=fe,this.onRecoverableError=He,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Qe,this.incompleteTransitions=new Map}function A$(m,S,A,L,ee,fe,He,Qe,Et,Qt,vn,xn){return m=new zEe(m,S,A,He,Qe,Et,Qt,xn),S=1,fe===!0&&(S|=24),fe=wo(3,null,null,S),m.current=fe,fe.stateNode=m,S=ll(),S.refCount++,m.pooledCache=S,S.refCount++,fe.memoizedState={element:L,isDehydrated:A,cache:S},em(fe),m}function C$(m){return m?(m=If,m):If}function M$(m,S,A,L,ee,fe){ee=C$(ee),L.context===null?L.context=ee:L.pendingContext=ee,L=Mu(S),L.payload={element:A},fe=fe===void 0?null:fe,fe!==null&&(L.callback=fe),A=Pf(m,L,S),A!==null&&(ci(A,m,S),Zh(A,m,S))}function O$(m,S){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var A=m.retryLane;m.retryLane=A!==0&&A<S?A:S}}function n5(m,S){O$(m,S),(m=m.alternate)&&O$(m,S)}function k$(m){if(m.tag===13){var S=Ti(m,67108864);S!==null&&ci(S,m,67108864),n5(m,67108864)}}var G3=!0;function jEe(m,S,A,L){var ee=W.T;W.T=null;var fe=q.p;try{q.p=2,r5(m,S,A,L)}finally{q.p=fe,W.T=ee}}function HEe(m,S,A,L){var ee=W.T;W.T=null;var fe=q.p;try{q.p=8,r5(m,S,A,L)}finally{q.p=fe,W.T=ee}}function r5(m,S,A,L){if(G3){var ee=i5(L);if(ee===null)V6(m,S,L,$3,A),N$(m,L);else if(VEe(ee,m,S,A,L))L.stopPropagation();else if(N$(m,L),S&4&&-1<qEe.indexOf(m)){for(;ee!==null;){var fe=gi(ee);if(fe!==null)switch(fe.tag){case 3:if(fe=fe.stateNode,fe.current.memoizedState.isDehydrated){var He=De(fe.pendingLanes);if(He!==0){var Qe=fe;for(Qe.pendingLanes|=2,Qe.entangledLanes|=2;He;){var Et=1<<31-Ut(He);Qe.entanglements[1]|=Et,He&=~Et}yg(fe),(O&6)===0&&($t=ze()+500,lS(0))}}break;case 13:Qe=Ti(fe,2),Qe!==null&&ci(Qe,fe,2),ms(),n5(fe,2)}if(fe=i5(L),fe===null&&V6(m,S,L,$3,A),fe===ee)break;ee=fe}ee!==null&&L.stopPropagation()}else V6(m,S,L,null,A)}}function i5(m){return m=cc(m),s5(m)}var $3=null;function s5(m){if($3=null,m=os(m),m!==null){var S=s(m);if(S===null)m=null;else{var A=S.tag;if(A===13){if(m=a(S),m!==null)return m;m=null}else if(A===3){if(S.stateNode.current.memoizedState.isDehydrated)return S.tag===3?S.stateNode.containerInfo:null;m=null}else S!==m&&(m=null)}}return $3=m,null}function I$(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Be()){case me:return 2;case Se:return 8;case ke:case be:return 32;case Ke:return 268435456;default:return 32}default:return 32}}var a5=!1,Nb=null,Pb=null,Db=null,MR=new Map,OR=new Map,Lb=[],qEe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function N$(m,S){switch(m){case"focusin":case"focusout":Nb=null;break;case"dragenter":case"dragleave":Pb=null;break;case"mouseover":case"mouseout":Db=null;break;case"pointerover":case"pointerout":MR.delete(S.pointerId);break;case"gotpointercapture":case"lostpointercapture":OR.delete(S.pointerId)}}function kR(m,S,A,L,ee,fe){return m===null||m.nativeEvent!==fe?(m={blockedOn:S,domEventName:A,eventSystemFlags:L,nativeEvent:fe,targetContainers:[ee]},S!==null&&(S=gi(S),S!==null&&k$(S)),m):(m.eventSystemFlags|=L,S=m.targetContainers,ee!==null&&S.indexOf(ee)===-1&&S.push(ee),m)}function VEe(m,S,A,L,ee){switch(S){case"focusin":return Nb=kR(Nb,m,S,A,L,ee),!0;case"dragenter":return Pb=kR(Pb,m,S,A,L,ee),!0;case"mouseover":return Db=kR(Db,m,S,A,L,ee),!0;case"pointerover":var fe=ee.pointerId;return MR.set(fe,kR(MR.get(fe)||null,m,S,A,L,ee)),!0;case"gotpointercapture":return fe=ee.pointerId,OR.set(fe,kR(OR.get(fe)||null,m,S,A,L,ee)),!0}return!1}function P$(m){var S=os(m.target);if(S!==null){var A=s(S);if(A!==null){if(S=A.tag,S===13){if(S=a(A),S!==null){m.blockedOn=S,gn(m.priority,function(){if(A.tag===13){var L=Yr();L=mt(L);var ee=Ti(A,L);ee!==null&&ci(ee,A,L),n5(A,L)}});return}}else if(S===3&&A.stateNode.current.memoizedState.isDehydrated){m.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}m.blockedOn=null}function W3(m){if(m.blockedOn!==null)return!1;for(var S=m.targetContainers;0<S.length;){var A=i5(m.nativeEvent);if(A===null){A=m.nativeEvent;var L=new A.constructor(A.type,A);wl=L,A.target.dispatchEvent(L),wl=null}else return S=gi(A),S!==null&&k$(S),m.blockedOn=A,!1;S.shift()}return!0}function D$(m,S,A){W3(m)&&A.delete(S)}function GEe(){a5=!1,Nb!==null&&W3(Nb)&&(Nb=null),Pb!==null&&W3(Pb)&&(Pb=null),Db!==null&&W3(Db)&&(Db=null),MR.forEach(D$),OR.forEach(D$)}function Y3(m,S){m.blockedOn===S&&(m.blockedOn=null,a5||(a5=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,GEe)))}var X3=null;function L$(m){X3!==m&&(X3=m,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){X3===m&&(X3=null);for(var S=0;S<m.length;S+=3){var A=m[S],L=m[S+1],ee=m[S+2];if(typeof L!="function"){if(s5(L||A)===null)continue;break}var fe=gi(A);fe!==null&&(m.splice(S,3),S-=3,dg(fe,{pending:!0,data:ee,method:A.method,action:L},L,ee))}}))}function IR(m){function S(Et){return Y3(Et,m)}Nb!==null&&Y3(Nb,m),Pb!==null&&Y3(Pb,m),Db!==null&&Y3(Db,m),MR.forEach(S),OR.forEach(S);for(var A=0;A<Lb.length;A++){var L=Lb[A];L.blockedOn===m&&(L.blockedOn=null)}for(;0<Lb.length&&(A=Lb[0],A.blockedOn===null);)P$(A),A.blockedOn===null&&Lb.shift();if(A=(m.ownerDocument||m).$$reactFormReplay,A!=null)for(L=0;L<A.length;L+=3){var ee=A[L],fe=A[L+1],He=ee[Yt]||null;if(typeof fe=="function")He||L$(A);else if(He){var Qe=null;if(fe&&fe.hasAttribute("formAction")){if(ee=fe,He=fe[Yt]||null)Qe=He.formAction;else if(s5(ee)!==null)continue}else Qe=He.action;typeof Qe=="function"?A[L+1]=Qe:(A.splice(L,3),L-=3),L$(A)}}}function o5(m){this._internalRoot=m}K3.prototype.render=o5.prototype.render=function(m){var S=this._internalRoot;if(S===null)throw Error(r(409));var A=S.current,L=Yr();M$(A,L,m,S,null,null)},K3.prototype.unmount=o5.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var S=m.containerInfo;M$(m.current,2,null,m,null,null),ms(),S[Mt]=null}};function K3(m){this._internalRoot=m}K3.prototype.unstable_scheduleHydration=function(m){if(m){var S=_t();m={blockedOn:null,target:m,priority:S};for(var A=0;A<Lb.length&&S!==0&&S<Lb[A].priority;A++);Lb.splice(A,0,m),A===0&&P$(m)}};var U$=e.version;if(U$!=="19.1.1")throw Error(r(527,U$,"19.1.1"));q.findDOMNode=function(m){var S=m._reactInternals;if(S===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=l(S),m=m!==null?c(m):null,m=m===null?null:m.stateNode,m};var $Ee={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Z3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Z3.isDisabled&&Z3.supportsFiber)try{ct=Z3.inject($Ee),Vt=Z3}catch{}}return $R.createRoot=function(m,S){if(!i(m))throw Error(r(299));var A=!1,L="",ee=gl,fe=aa,He=ev,Qe=null;return S!=null&&(S.unstable_strictMode===!0&&(A=!0),S.identifierPrefix!==void 0&&(L=S.identifierPrefix),S.onUncaughtError!==void 0&&(ee=S.onUncaughtError),S.onCaughtError!==void 0&&(fe=S.onCaughtError),S.onRecoverableError!==void 0&&(He=S.onRecoverableError),S.unstable_transitionCallbacks!==void 0&&(Qe=S.unstable_transitionCallbacks)),S=A$(m,1,!1,null,null,A,L,ee,fe,He,Qe,null),m[Mt]=S.current,q6(m),new o5(S)},$R.hydrateRoot=function(m,S,A){if(!i(m))throw Error(r(299));var L=!1,ee="",fe=gl,He=aa,Qe=ev,Et=null,Qt=null;return A!=null&&(A.unstable_strictMode===!0&&(L=!0),A.identifierPrefix!==void 0&&(ee=A.identifierPrefix),A.onUncaughtError!==void 0&&(fe=A.onUncaughtError),A.onCaughtError!==void 0&&(He=A.onCaughtError),A.onRecoverableError!==void 0&&(Qe=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(Et=A.unstable_transitionCallbacks),A.formState!==void 0&&(Qt=A.formState)),S=A$(m,1,!0,S,A??null,L,ee,fe,He,Qe,Et,Qt),S.context=C$(null),A=S.current,L=Yr(),L=mt(L),ee=Mu(L),ee.callback=null,Pf(A,ee,L),A=L,S.current.lanes=A,nt(S,A),yg(S),m[Mt]=S.current,q6(m),new K3(S)},$R.version="19.1.1",$R}var YY;function Lke(){if(YY)return hB.exports;YY=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),hB.exports=Dke(),hB.exports}var Uke=Lke(),sP={exports:{}},Bke=sP.exports,XY;function Fke(){return XY||(XY=1,(function(n,e){(function(t,r){n.exports=r()})(Bke,function(){return t.importState=function(i){var s=new t;return s.importState(i),s},t;function t(){return(function(i){var s=0,a=0,o=0,l=1;i.length==0&&(i=[+new Date]);var c=r();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<i.length;u++)s-=c(i[u]),s<0&&(s+=1),a-=c(i[u]),a<0&&(a+=1),o-=c(i[u]),o<0&&(o+=1);c=null;var f=function(){var h=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=h-(l=h|0)};return f.next=f,f.uint32=function(){return f()*4294967296},f.fract53=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.version="Alea 0.9",f.args=i,f.exportState=function(){return[s,a,o,l]},f.importState=function(h){s=+h[0]||0,a=+h[1]||0,o=+h[2]||0,l=+h[3]||0},f})(Array.prototype.slice.call(arguments))}function r(){var i=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){i+=a.charCodeAt(o);var l=.02519603282416938*i;i=l>>>0,l-=i,l*=i,i=l>>>0,l-=i,i+=l*4294967296}return(i>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(sP)),sP.exports}var zke=Fke();const qj=Bh(zke);new an;new an;function Li(n,e,t){return Math.max(e,Math.min(t,n))}function jke(n,e){return Li(n-Math.floor(n/e)*e,0,e)}function Hke(n,e){var t=jke(e-n,Math.PI*2);return t>Math.PI&&(t-=Math.PI*2),t}function qke(n){return n/180*Math.PI}function Vke(n){return n*180/Math.PI}const Gke=qj("089fad0j9awfem09wavefc09uwaef");function KY(n){return 2*Math.floor(n/2)}function pce(n,e){return Math.round(n/e)*e}function $ke(){return Gke()}function Wke(n){return qj(n)()}function Og(n,e){const t=Math.min(n,e),i=Math.max(n,e)-t+1;return t+Math.floor($ke()*i)}function mce(n,e,t){const r=Math.min(e,t),s=Math.max(e,t)-r+1;return r+Math.floor(Wke(n)*s)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Yke=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),Xke=Object.prototype.hasOwnProperty;function G7(n,e){return Xke.call(n,e)}function $7(n){if(Array.isArray(n)){for(var e=new Array(n.length),t=0;t<e.length;t++)e[t]=""+t;return e}if(Object.keys)return Object.keys(n);var r=[];for(var i in n)G7(n,i)&&r.push(i);return r}function Om(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function W7(n){for(var e=0,t=n.length,r;e<t;){if(r=n.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function zS(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function gce(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function Y7(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(var e=0,t=n.length;e<t;e++)if(Y7(n[e]))return!0}else if(typeof n=="object"){for(var r=$7(n),i=r.length,s=0;s<i;s++)if(Y7(n[r[s]]))return!0}}return!1}function ZY(n,e){var t=[n];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&t.push(r+": "+i)}return t.join(`
`)}var _ce=(function(n){Yke(e,n);function e(t,r,i,s,a){var o=this.constructor,l=n.call(this,ZY(t,{name:r,index:i,operation:s,tree:a}))||this;return l.name=r,l.index=i,l.operation=s,l.tree=a,Object.setPrototypeOf(l,o.prototype),l.message=ZY(t,{name:r,index:i,operation:s,tree:a}),l}return e})(Error),gu=_ce,Kke=Om,wT={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var r=n[e];return delete n[e],{newDocument:t,removed:r}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:function(n,e,t){var r=HD(t,this.path);r&&(r=Om(r));var i=fE(t,{op:"remove",path:this.from}).removed;return fE(t,{op:"add",path:this.path,value:i}),{newDocument:t,removed:r}},copy:function(n,e,t){var r=HD(t,this.from);return fE(t,{op:"add",path:this.path,value:Om(r)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:pO(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}},Zke={add:function(n,e,t){return W7(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var r=n.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:wT.move,copy:wT.copy,test:wT.test,_get:wT._get};function HD(n,e){if(e=="")return n;var t={op:"_get",path:e};return fE(n,t),t.value}function fE(n,e,t,r,i,s){if(t===void 0&&(t=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),t&&(typeof t=="function"?t(e,0,n,e.path):qD(e,0)),e.path===""){var a={newDocument:n};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=n,a;if(e.op==="move"||e.op==="copy")return a.newDocument=HD(n,e.from),e.op==="move"&&(a.removed=n),a;if(e.op==="test"){if(a.test=pO(n,e.value),a.test===!1)throw new gu("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a.newDocument=n,a}else{if(e.op==="remove")return a.removed=n,a.newDocument=null,a;if(e.op==="_get")return e.value=n,a;if(t)throw new gu("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,n);return a}}else{r||(n=Om(n));var o=e.path||"",l=o.split("/"),c=n,u=1,f=l.length,h=void 0,g=void 0,p=void 0;for(typeof t=="function"?p=t:p=qD;;){if(g=l[u],g&&g.indexOf("~")!=-1&&(g=gce(g)),i&&(g=="__proto__"||g=="prototype"&&u>0&&l[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&h===void 0&&(c[g]===void 0?h=l.slice(0,u).join("/"):u==f-1&&(h=e.path),h!==void 0&&p(e,0,n,h)),u++,Array.isArray(c)){if(g==="-")g=c.length;else{if(t&&!W7(g))throw new gu("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,n);W7(g)&&(g=~~g)}if(u>=f){if(t&&e.op==="add"&&g>c.length)throw new gu("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,n);var a=Zke[e.op].call(e,c,g,n);if(a.test===!1)throw new gu("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a}}else if(u>=f){var a=wT[e.op].call(e,c,g,n);if(a.test===!1)throw new gu("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a}if(c=c[g],t&&u<f&&(!c||typeof c!="object"))throw new gu("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,n)}}}function nU(n,e,t,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),t&&!Array.isArray(e))throw new gu("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(n=Om(n));for(var s=new Array(e.length),a=0,o=e.length;a<o;a++)s[a]=fE(n,e[a],t,!0,i,a),n=s[a].newDocument;return s.newDocument=n,s}function Jke(n,e,t){var r=fE(n,e);if(r.test===!1)throw new gu("Test operation failed","TEST_OPERATION_FAILED",t,e,n);return r.newDocument}function qD(n,e,t,r){if(typeof n!="object"||n===null||Array.isArray(n))throw new gu("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(wT[n.op]){if(typeof n.path!="string")throw new gu("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new gu('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new gu("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new gu("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&Y7(n.value))throw new gu("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var i=n.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new gu("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==r)throw new gu("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var a={op:"_get",path:n.from,value:void 0},o=vce([a],t);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new gu("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new gu("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function vce(n,e,t){try{if(!Array.isArray(n))throw new gu("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)nU(Om(e),Om(n),t||!0);else{t=t||qD;for(var r=0;r<n.length;r++)t(n[r],r,e,void 0)}}catch(i){if(i instanceof gu)return i;throw i}}function pO(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),r=Array.isArray(e),i,s,a;if(t&&r){if(s=n.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!pO(n[i],e[i]))return!1;return!0}if(t!=r)return!1;var o=Object.keys(n);if(s=o.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!pO(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}const Qke=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:gu,_areEquals:pO,applyOperation:fE,applyPatch:nU,applyReducer:Jke,deepClone:Kke,getValueByPointer:HD,validate:vce,validator:qD},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var Vj=new WeakMap,e3e=(function(){function n(e){this.observers=new Map,this.obj=e}return n})(),t3e=(function(){function n(e,t){this.callback=e,this.observer=t}return n})();function n3e(n){return Vj.get(n)}function r3e(n,e){return n.observers.get(e)}function i3e(n,e){n.observers.delete(e.callback)}function s3e(n,e){e.unobserve()}function a3e(n,e){var t=[],r,i=n3e(n);if(!i)i=new e3e(n),Vj.set(n,i);else{var s=r3e(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=Om(n),e){r.callback=e,r.next=null;var a=function(){X7(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=t,r.object=n,r.unobserve=function(){X7(r),clearTimeout(r.next),i3e(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},i.observers.set(e,new t3e(e,r)),r}function X7(n,e){e===void 0&&(e=!1);var t=Vj.get(n.object);Gj(t.value,n.object,n.patches,"",e),n.patches.length&&nU(t.value,n.patches);var r=n.patches;return r.length>0&&(n.patches=[],n.callback&&n.callback(r)),r}function Gj(n,e,t,r,i){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=$7(e),a=$7(n),o=!1,l=a.length-1;l>=0;l--){var c=a[l],u=n[c];if(G7(e,c)&&!(e[c]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var f=e[c];typeof u=="object"&&u!=null&&typeof f=="object"&&f!=null&&Array.isArray(u)===Array.isArray(f)?Gj(u,f,t,r+"/"+zS(c),i):u!==f&&(i&&t.push({op:"test",path:r+"/"+zS(c),value:Om(u)}),t.push({op:"replace",path:r+"/"+zS(c),value:Om(f)}))}else Array.isArray(n)===Array.isArray(e)?(i&&t.push({op:"test",path:r+"/"+zS(c),value:Om(u)}),t.push({op:"remove",path:r+"/"+zS(c)}),o=!0):(i&&t.push({op:"test",path:r,value:n}),t.push({op:"replace",path:r,value:e}))}if(!(!o&&s.length==a.length))for(var l=0;l<s.length;l++){var c=s[l];!G7(n,c)&&e[c]!==void 0&&t.push({op:"add",path:r+"/"+zS(c),value:Om(e[c])})}}}function o3e(n,e,t){t===void 0&&(t=!1);var r=[];return Gj(n,e,r,"",t),r}const l3e=Object.freeze(Object.defineProperty({__proto__:null,compare:o3e,generate:X7,observe:a3e,unobserve:s3e},Symbol.toStringTag,{value:"Module"}));Object.assign({},Qke,l3e,{JsonPatchError:_ce,deepClone:Om,escapePathComponent:zS,unescapePathComponent:gce});var gB,JY;function c3e(){if(JY)return gB;JY=1;var n=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",r=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(s,a){if(s===a)return!0;if(s&&a&&typeof s=="object"&&typeof a=="object"){if(s.constructor!==a.constructor)return!1;var o,l,c;if(Array.isArray(s)){if(o=s.length,o!=a.length)return!1;for(l=o;l--!==0;)if(!i(s[l],a[l]))return!1;return!0}var u;if(e&&s instanceof Map&&a instanceof Map){if(s.size!==a.size)return!1;for(u=s.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;for(u=s.entries();!(l=u.next()).done;)if(!i(l.value[1],a.get(l.value[0])))return!1;return!0}if(t&&s instanceof Set&&a instanceof Set){if(s.size!==a.size)return!1;for(u=s.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(a)){if(o=s.length,o!=a.length)return!1;for(l=o;l--!==0;)if(s[l]!==a[l])return!1;return!0}if(s.constructor===RegExp)return s.source===a.source&&s.flags===a.flags;if(s.valueOf!==Object.prototype.valueOf&&typeof s.valueOf=="function"&&typeof a.valueOf=="function")return s.valueOf()===a.valueOf();if(s.toString!==Object.prototype.toString&&typeof s.toString=="function"&&typeof a.toString=="function")return s.toString()===a.toString();if(c=Object.keys(s),o=c.length,o!==Object.keys(a).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(a,c[l]))return!1;if(n&&s instanceof Element)return!1;for(l=o;l--!==0;)if(!((c[l]==="_owner"||c[l]==="__v"||c[l]==="__o")&&s.$$typeof)&&!i(s[c[l]],a[c[l]]))return!1;return!0}return s!==s&&a!==a}return gB=function(a,o){try{return i(a,o)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},gB}var u3e=c3e();const i1=Bh(u3e);function xe(n){return n!=null}const f3e=Object.fromEntries,ub=Object.keys;function El(n){return Om(n)}function h3e(n){return typeof n=="boolean"}function Mn(n){return typeof n=="number"&&isNaN(n)===!1}function Vn(n){return typeof n=="string"}function ui(n){return Array.isArray(n)}function bm(n){return n}function d3e(n){return typeof n=="object"&&Vn(n.session)&&Vn(n.player)&&Vn(n.id)&&Vn(n.sender)&&Vn(n.target)}function p3e(n){n.emit("","session_reset")}function xi(n,e,t,...r){return n.emit(e,"error",[`$red${t}$blue>>`,...r]),!1}function m3e(n,e,...t){return n.emit(e,"info",t),!0}function Ts(n,e,...t){return n.emit(e,"log",t),!0}function g3e(n,e,...t){return n.emit(e,"chat",t),!0}function yce(n,e,t){n.emit(e,"toast",t)}function _3e(n,e,t){n.emit(e,"bridge:streamstart",t)}function v3e(n,e){n.emit(e,"bridge:streamstop",void 0)}function y3e(n,e,t){n.emit(e,"bridge:chatstart",t)}function b3e(n,e){n.emit(e,"bridge:chatstop")}function S3e(n,e,t,r,i,s,a){n.emit(e,"bridge:fetch",[t,r,i,s,a])}function E3e(n,e,t){n.emit(e,"bridge:join",t)}function x3e(n,e,t){n.emit(e,"bridge:start",t)}function T3e(n,e,t){n.emit(e,"bridge:tab",t)}function w3e(n,e){n.emit(e,"bridge:tabopen")}function R3e(n,e,t){n.emit(e,"bridge:showjoincode",t)}function A3e(n,e){n.emit(e,"gadgetserver:desync")}function C3e(n,e){n.emit(e,"gadgetserver:clearscroll")}function QY(n,e,t,r){n.emit(e,"register:downloadjsonfile",[t,r])}function M3e(n,e){n.emit(e,"register:dev",void 0)}function O3e(n,e){n.emit(e,"register:share",void 0)}function k3e(n,e){n.emit(e,"register:nuke",void 0)}function I3e(n,e){n.emit(e,"register:enterar",void 0)}function N3e(n,e){n.emit(e,"synth:audioenabled",void 0)}function P3e(n,e,t,r){n.emit(e,"synth:tts",[t,r])}function D3e(n,e,t,r){n.emit(e,"synth:ttsqueue",[t,r])}function L3e(n,e,t,r){n.emit(e,"synth:play",[t,r])}function U3e(n,e,t,r,i){n.emit(e,"synth:bgplay",[t,r,i])}function B3e(n,e,t){n.emit(e,"synth:bpm",t)}function F3e(n,e,t){n.emit(e,"synth:playvolume",t)}function z3e(n,e,t){n.emit(e,"synth:bgplayvolume",t)}function j3e(n,e,t){n.emit(e,"synth:ttsvolume",t)}function _B(n,e,t,r,i){n.emit(e,"synth:voice",[t,r,i])}function bce(n,e,t,r,i,s){n.emit(e,"synth:voicefx",[t,r,i,s])}function H3e(n,e,t){n.emit(e,"synth:record",t)}function q3e(n,e){n.emit(e,"synth:flush")}function V3e(n,e){n.emit(e,"register:refresh")}function eX(n,e,t,r){n.emit(e,"register:config",[t,r])}function G3e(n,e){n.emit(e,"register:configshow")}function $3e(n,e){n.emit(e,"register:inspector")}function tX(n,e,t){n.emit(e,"register:findany",t)}function W3e(n,e){n.emit(e,"register:terminal:open")}function nX(n,e,t){n.emit(e,"register:terminal:quickopen",t)}function VD(n,e){n.emit(e,"register:terminal:close")}function Sce(n,e,t){n.emit(e,"register:terminal:inclayout",t)}function $j(n,e){n.emit(e,"register:terminal:full")}function Y3e(n,e,t,r,i,s){n.emit(e,"register:editor:open",[t,r,i,s])}function X3e(n,e){n.emit(e,"register:editor:close")}function K3e(n,e){n.emit(e,"vm:operator")}function Z3e(n,e){n.emit(e,"vm:admin")}function J3e(n,e,t,r){n.emit(e,"vm:zztsearch",[t,r])}function Q3e(n,e){n.emit(e,"vm:zztrandom")}function Ece(n,e){n.emit(e,"vm:zsswords")}function eIe(n,e,t){n.emit(e,"vm:halt",t)}function tIe(n,e,t){n.emit(e,"vm:books",t)}function nIe(n,e){n.emit(e,"vm:search")}function rIe(n,e,t){n.emit(e,"vm:login",t)}function iIe(n,e){n.emit(e,"vm:local")}function xce(n,e){n.emit(e,"vm:logout")}function Tce(n,e){n.emit(e,"vm:doot")}function rX(n,e,t,r,i){n.emit(e,"vm:touched",[t,r,i])}function wce(n,e,t,r){n.emit(e,"vm:input",[t,r])}function sIe(n,e,t){n.emit(e,"vm:copyjsonfile",t)}function aIe(n,e,t){n.emit(e,"vm:makeitscroll",t)}function oIe(n,e){n.emit(e,"vm:refscroll")}function lIe(n,e,t,r){n.emit(e,"vm:inspect",[t,r])}function cIe(n,e){n.emit(e,"vm:findany")}function Rce(n,e){const[t,r]=e;return`${n}:${[t,r].filter(xe).join(":")}`}function uIe(n,e,t,r){n.emit(e,"vm:codewatch",[t,r])}function fIe(n,e,t,r){n.emit(e,"vm:coderelease",[t,r])}function Av(n,e,t){n.emit(e,"vm:cli",t)}function Ace(n,e){n.emit(e,"vm:clirepeatlast")}function hIe(n,e){n.emit(e,"vm:restart")}function dIe(n,e,t){n.emit(e,"vm:synthsend",t)}function pIe(n,e){n.emit(e,"vm:flush")}function mIe(n,e){n.emit(e,"vm:fork")}function gIe(n,e){n.emit(e,"vm:itchiopublish")}function _Ie(n,e){return{filename:n,cursor:0,lines:e.split(`
`)}}function vIe(n,e){return{filename:n,json:e}}function yIe(n,e){return{filename:n,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function U0(n,e,t,r,i,s){let a;switch(r){case"file":a=s;break;case"text":a=_Ie(i,s);break;case"json":a=vIe(i,s);break;case"binary":a=yIe(i,s);break}setTimeout(()=>{n.emit(e,"vm:loader",[t,r,i,a])},1)}var WR={},iX;function bIe(){return iX||(iX=1,(function(n){var e=WR&&WR.__spreadArray||function(c,u,f){if(f||arguments.length===2)for(var h=0,g=u.length,p;h<g;h++)(p||!(h in u))&&(p||(p=Array.prototype.slice.call(u,0,h)),p[h]=u[h]);return c.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(n,"__esModule",{value:!0}),n.minLength=n.maxLength=n.poolSize=n.humanId=n.adverbs=n.verbs=n.nouns=n.adjectives=void 0,n.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],n.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],n.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],n.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function t(c){return c[Math.floor(Math.random()*c.length)]}function r(c){return c.reduce(function(u,f){return u.length>f.length?u:f})}function i(c){return c.reduce(function(u,f){return u.length<f.length?u:f})}function s(c){c===void 0&&(c={}),typeof c=="string"&&(c={separator:c}),typeof c=="boolean"&&(c={capitalize:c});var u=c.separator,f=u===void 0?"":u,h=c.capitalize,g=h===void 0?!0:h,p=c.adjectiveCount,_=p===void 0?1:p,y=c.addAdverb,v=y===void 0?!1:y,x=e(e(e([],e([],Array(_),!0).map(function(E){return t(n.adjectives)}),!0),[t(n.nouns),t(n.verbs)],!1),v?[t(n.adverbs)]:[],!0);return g&&(x=x.map(function(E){return E.charAt(0).toUpperCase()+E.substr(1)})),x.join(f)}n.humanId=s;function a(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,h=c.addAdverb,g=h===void 0?!1:h;return n.adjectives.length*f*n.nouns.length*n.verbs.length*(g?n.adverbs.length:1)}n.poolSize=a;function o(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,h=c.addAdverb,g=h===void 0?!1:h,p=c.separator,_=p===void 0?"":p;return r(n.adjectives).length*f+f*_.length+r(n.nouns).length+_.length+r(n.verbs).length+(g?r(n.adverbs).length+_.length:0)}n.maxLength=o;function l(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,h=c.addAdverb,g=h===void 0?!1:h,p=c.separator,_=p===void 0?"":p;return i(n.adjectives).length*f+f*_.length+i(n.nouns).length+_.length+i(n.verbs).length+(g?i(n.adverbs).length+_.length:0)}n.minLength=l,n.default=s})(WR)),WR}var SIe=bIe();const Wj=Bh(SIe);function rU(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function EIe(n,e){let t;const r=()=>{if(t)return t;const i=indexedDB.open(n);return i.onupgradeneeded=()=>i.result.createObjectStore(e),t=rU(i),t.then(s=>{s.onclose=()=>t=void 0},()=>{}),t};return(i,s)=>r().then(a=>s(a.transaction(e,i).objectStore(e)))}let vB;function Yj(){return vB||(vB=EIe("keyval-store","keyval")),vB}function xIe(n,e=Yj()){return e("readonly",t=>rU(t.get(n)))}function TIe(n,e=Yj()){return e("readonly",t=>Promise.all(n.map(r=>rU(t.get(r)))))}function wIe(n,e,t=Yj()){return t("readwrite",r=>new Promise((i,s)=>{r.get(n).onsuccess=function(){try{r.put(e(this.result),n),i(rU(r.transaction))}catch(a){s(a)}}}))}const yB=new Set,mO={emit(n,e,t,r,i){mO.invoke(zIe(n,e,t,r,i))},invoke(n){yB.forEach(e=>e.handle(n))},connect(n){yB.add(n)},disconnect(n){yB.delete(n)}},RIe="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let AIe=n=>crypto.getRandomValues(new Uint8Array(n)),CIe=(n,e,t)=>{let r=(2<<Math.log2(n.length-1))-1,i=-~(1.6*r*e/n.length);return(s=e)=>{let a="";for(;;){let o=t(i),l=i|0;for(;l--;)if(a+=n[o[l]&r]||"",a.length>=s)return a}}},Cce=(n,e=21)=>CIe(n,e|0,AIe),MIe=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n|=0));for(;n--;)e+=RIe[t[n]&63];return e};var bB,sX;function Mce(){return sX||(sX=1,bB="abcdefghijklmnopqrstuvwxyz"),bB}var SB,aX;function Oce(){return aX||(aX=1,SB="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),SB}var EB,oX;function kce(){return oX||(oX=1,EB="0123456789"),EB}var xB,lX;function OIe(){return lX||(lX=1,xB="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz"),xB}var TB,cX;function kIe(){return cX||(cX=1,TB="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz"),TB}var wB,uX;function IIe(){if(uX)return wB;uX=1;const n=kce(),e=Mce(),t=Oce();return wB=n+e+t,wB}var RB,fX;function NIe(){return fX||(fX=1,RB={lowercase:Mce(),uppercase:Oce(),numbers:kce(),nolookalikes:OIe(),nolookalikesSafe:kIe(),alphanumeric:IIe()}),RB}var K7=NIe();function Sc(){return`sid_${MIe(12).replaceAll("-",".")}`}const PIe=Cce(K7.numbers,4),DIe=Cce(`${K7.numbers}${K7.lowercase}`,16);function LIe(){return`pid_${PIe()}_${DIe()}`}function R0(n){return n?.startsWith("pid_")??!1}function Ice(){return Wj({capitalize:!1,adjectiveCount:1})}function UIe(){return Wj({addAdverb:!1,capitalize:!1,adjectiveCount:0})}const BIe=20,hX="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function FIe(n){const e=qj(n),t=[];for(let r=0;r<BIe;++r)t.push(hX[Math.floor(e()*hX.length)]);return t.join("")}var bn=(n=>(n[n.BLACK=0]="BLACK",n[n.DKBLUE=1]="DKBLUE",n[n.DKGREEN=2]="DKGREEN",n[n.DKCYAN=3]="DKCYAN",n[n.DKRED=4]="DKRED",n[n.DKPURPLE=5]="DKPURPLE",n[n.DKYELLOW=6]="DKYELLOW",n[n.LTGRAY=7]="LTGRAY",n[n.DKGRAY=8]="DKGRAY",n[n.BLUE=9]="BLUE",n[n.GREEN=10]="GREEN",n[n.CYAN=11]="CYAN",n[n.RED=12]="RED",n[n.PURPLE=13]="PURPLE",n[n.YELLOW=14]="YELLOW",n[n.WHITE=15]="WHITE",n[n.ONBLACK=16]="ONBLACK",n[n.ONDKBLUE=17]="ONDKBLUE",n[n.ONDKGREEN=18]="ONDKGREEN",n[n.ONDKCYAN=19]="ONDKCYAN",n[n.ONDKRED=20]="ONDKRED",n[n.ONDKPURPLE=21]="ONDKPURPLE",n[n.ONDKYELLOW=22]="ONDKYELLOW",n[n.ONLTGRAY=23]="ONLTGRAY",n[n.ONDKGRAY=24]="ONDKGRAY",n[n.ONBLUE=25]="ONBLUE",n[n.ONGREEN=26]="ONGREEN",n[n.ONCYAN=27]="ONCYAN",n[n.ONRED=28]="ONRED",n[n.ONPURPLE=29]="ONPURPLE",n[n.ONYELLOW=30]="ONYELLOW",n[n.ONWHITE=31]="ONWHITE",n[n.ONCLEAR=32]="ONCLEAR",n[n.BLBLACK=33]="BLBLACK",n[n.BLDKBLUE=34]="BLDKBLUE",n[n.BLDKGREEN=35]="BLDKGREEN",n[n.BLDKCYAN=36]="BLDKCYAN",n[n.BLDKRED=37]="BLDKRED",n[n.BLDKPURPLE=38]="BLDKPURPLE",n[n.BLDKYELLOW=39]="BLDKYELLOW",n[n.BLLTGRAY=40]="BLLTGRAY",n[n.BLDKGRAY=41]="BLDKGRAY",n[n.BLBLUE=42]="BLBLUE",n[n.BLGREEN=43]="BLGREEN",n[n.BLCYAN=44]="BLCYAN",n[n.BLRED=45]="BLRED",n[n.BLPURPLE=46]="BLPURPLE",n[n.BLYELLOW=47]="BLYELLOW",n[n.BLWHITE=48]="BLWHITE",n))(bn||{}),wr=(n=>(n[n.ISWALK=0]="ISWALK",n[n.ISSOLID=1]="ISSOLID",n[n.ISSWIM=2]="ISSWIM",n[n.ISBULLET=3]="ISBULLET",n[n.ISGHOST=4]="ISGHOST",n))(wr||{}),RE=(n=>(n[n.ISTERRAIN=0]="ISTERRAIN",n[n.ISOBJECT=1]="ISOBJECT",n))(RE||{}),Hn=(n=>(n[n.IDLE=0]="IDLE",n[n.NORTH=1]="NORTH",n[n.SOUTH=2]="SOUTH",n[n.WEST=3]="WEST",n[n.EAST=4]="EAST",n[n.BY=5]="BY",n[n.AT=6]="AT",n[n.FLOW=7]="FLOW",n[n.SEEK=8]="SEEK",n[n.RNDNS=9]="RNDNS",n[n.RNDNE=10]="RNDNE",n[n.RND=11]="RND",n[n.CW=12]="CW",n[n.CCW=13]="CCW",n[n.OPP=14]="OPP",n[n.RNDP=15]="RNDP",n[n.AWAY=16]="AWAY",n[n.TOWARD=17]="TOWARD",n[n.FIND=18]="FIND",n[n.FLEE=19]="FLEE",n[n.TO=20]="TO",n[n.MID=21]="MID",n[n.OVER=22]="OVER",n[n.UNDER=23]="UNDER",n[n.WITHIN=24]="WITHIN",n[n.AWAYBY=25]="AWAYBY",n))(Hn||{}),hr=(n=>(n[n.LOADER=0]="LOADER",n[n.BOARD=1]="BOARD",n[n.OBJECT=2]="OBJECT",n[n.TERRAIN=3]="TERRAIN",n[n.CHARSET=4]="CHARSET",n[n.PALETTE=5]="PALETTE",n[n.CONST=6]="CONST",n[n.RANGE=7]="RANGE",n[n.SELECT=8]="SELECT",n[n.NUMBER=9]="NUMBER",n[n.TEXT=10]="TEXT",n[n.HOTKEY=11]="HOTKEY",n[n.COPYIT=12]="COPYIT",n[n.OPENIT=13]="OPENIT",n[n.VIEWIT=14]="VIEWIT",n[n.ZSSEDIT=15]="ZSSEDIT",n[n.CHAREDIT=16]="CHAREDIT",n[n.COLOREDIT=17]="COLOREDIT",n))(hr||{});function Vr(n){return Vn(n)?n.toLowerCase().trim():""}function zIe(n,e,t,r,i){return{session:n,player:e,id:Sc(),sender:t,target:r,data:i}}function AE(n){const[e,...t]=n.split(":");return{target:e,path:t.join(":")}}function Y1(n,e=[],t=bm,r=""){const i=Sc(),s=Vr(n),a=e.map(Vr);let o=r;const l={id(){return i},name(){return n},session(c){return xe(c)?c.session===o?c.session:"":o},topics(){return e},emit(c,u,f){mO.emit(o,c,i,u,f)},reply(c,u,f){l.emit(c.player,`${c.sender}:${u}`,f)},replynext(c,u,f){setTimeout(()=>l.emit(c.player,`${c.sender}:${u}`,f),64)},handle(c){const{target:u,path:f}=AE(c.target),h=Vr(u);!o&&h==="ready"&&(o=c.session),h==="session_reset"&&(o=""),a.findIndex(g=>g==="all"||g===h)!==-1&&t(c),(i===u||h==="all"||s===h)&&t({...c,target:f})}};return mO.connect(l),l}var aP={exports:{}},jIe=aP.exports,dX;function HIe(){return dX||(dX=1,(function(n,e){(function(t,r){r()})(jIe,function(){function t(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,u,f){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){l(h.response,u,f)},h.onerror=function(){console.error("could not download file")},h.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof k0=="object"&&k0.global===k0?k0:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,u,f){var h=a.URL||a.webkitURL,g=document.createElement("a");u=u||c.name||"download",g.download=u,g.rel="noopener",typeof c=="string"?(g.href=c,g.origin===location.origin?s(g):i(g.href)?r(c,u,f):s(g,g.target="_blank")):(g.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(g.href)},4e4),setTimeout(function(){s(g)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,f){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(t(c,f),u);else if(i(c))r(c,u,f);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){s(h)})}}:function(c,u,f,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return r(c,u,f);var g=c.type==="application/octet-stream",p=/constructor/i.test(a.HTMLElement)||a.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||g&&p||o)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var E=y.result;E=_?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=E:location=E,h=null},y.readAsDataURL(c)}else{var v=a.URL||a.webkitURL,x=v.createObjectURL(c);h?h.location=x:location.href=x,h=null,setTimeout(function(){v.revokeObjectURL(x)},4e4)}});a.saveAs=l.saveAs=l,n.exports=l})})(aP)),aP.exports}var qIe=HIe(),Nce={},iU={};iU.byteLength=$Ie;iU.toByteArray=YIe;iU.fromByteArray=ZIe;var Sv=[],S0=[],VIe=typeof Uint8Array<"u"?Uint8Array:Array,AB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Zx=0,GIe=AB.length;Zx<GIe;++Zx)Sv[Zx]=AB[Zx],S0[AB.charCodeAt(Zx)]=Zx;S0[45]=62;S0[95]=63;function Pce(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function $Ie(n){var e=Pce(n),t=e[0],r=e[1];return(t+r)*3/4-r}function WIe(n,e,t){return(e+t)*3/4-t}function YIe(n){var e,t=Pce(n),r=t[0],i=t[1],s=new VIe(WIe(n,r,i)),a=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=S0[n.charCodeAt(l)]<<18|S0[n.charCodeAt(l+1)]<<12|S0[n.charCodeAt(l+2)]<<6|S0[n.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=S0[n.charCodeAt(l)]<<2|S0[n.charCodeAt(l+1)]>>4,s[a++]=e&255),i===1&&(e=S0[n.charCodeAt(l)]<<10|S0[n.charCodeAt(l+1)]<<4|S0[n.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function XIe(n){return Sv[n>>18&63]+Sv[n>>12&63]+Sv[n>>6&63]+Sv[n&63]}function KIe(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(XIe(r));return i.join("")}function ZIe(n){for(var e,t=n.length,r=t%3,i=[],s=16383,a=0,o=t-r;a<o;a+=s)i.push(KIe(n,a,a+s>o?o:a+s));return r===1?(e=n[t-1],i.push(Sv[e>>2]+Sv[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(Sv[e>>10]+Sv[e>>4&63]+Sv[e<<2&63]+"=")),i.join("")}var Xj={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Xj.read=function(n,e,t,r,i){var s,a,o=i*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,f=t?i-1:0,h=t?-1:1,g=n[e+f];for(f+=h,s=g&(1<<-u)-1,g>>=-u,u+=o;u>0;s=s*256+n[e+f],f+=h,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;u>0;a=a*256+n[e+f],f+=h,u-=8);if(s===0)s=1-c;else{if(s===l)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-c}return(g?-1:1)*a*Math.pow(2,s-r)};Xj.write=function(n,e,t,r,i,s){var a,o,l,c=s*8-i-1,u=(1<<c)-1,f=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:s-1,p=r?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?e+=h/l:e+=h*Math.pow(2,1-f),e*l>=2&&(a++,l/=2),a+f>=u?(o=0,a=u):a+f>=1?(o=(e*l-1)*Math.pow(2,i),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;n[t+g]=o&255,g+=p,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;n[t+g]=a&255,g+=p,a/=256,c-=8);n[t+g-p]|=_*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=iU,t=Xj,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=u,n.SlowBuffer=k,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const je=new s(1),ge={foo:function(){return 42}};return Object.setPrototypeOf(ge,s.prototype),Object.setPrototypeOf(je,ge),je.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(je){if(je>i)throw new RangeError('The value "'+je+'" is invalid for option "size"');const ge=new s(je);return Object.setPrototypeOf(ge,u.prototype),ge}function u(je,ge,se){if(typeof je=="number"){if(typeof ge=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(je)}return f(je,ge,se)}u.poolSize=8192;function f(je,ge,se){if(typeof je=="string")return _(je,ge);if(a.isView(je))return v(je);if(je==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je);if(lt(je,a)||je&&lt(je.buffer,a)||typeof o<"u"&&(lt(je,o)||je&&lt(je.buffer,o)))return x(je,ge,se);if(typeof je=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=je.valueOf&&je.valueOf();if(_e!=null&&_e!==je)return u.from(_e,ge,se);const Ie=E(je);if(Ie)return Ie;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof je[Symbol.toPrimitive]=="function")return u.from(je[Symbol.toPrimitive]("string"),ge,se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je)}u.from=function(je,ge,se){return f(je,ge,se)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function h(je){if(typeof je!="number")throw new TypeError('"size" argument must be of type number');if(je<0)throw new RangeError('The value "'+je+'" is invalid for option "size"')}function g(je,ge,se){return h(je),je<=0?c(je):ge!==void 0?typeof se=="string"?c(je).fill(ge,se):c(je).fill(ge):c(je)}u.alloc=function(je,ge,se){return g(je,ge,se)};function p(je){return h(je),c(je<0?0:M(je)|0)}u.allocUnsafe=function(je){return p(je)},u.allocUnsafeSlow=function(je){return p(je)};function _(je,ge){if((typeof ge!="string"||ge==="")&&(ge="utf8"),!u.isEncoding(ge))throw new TypeError("Unknown encoding: "+ge);const se=N(je,ge)|0;let _e=c(se);const Ie=_e.write(je,ge);return Ie!==se&&(_e=_e.slice(0,Ie)),_e}function y(je){const ge=je.length<0?0:M(je.length)|0,se=c(ge);for(let _e=0;_e<ge;_e+=1)se[_e]=je[_e]&255;return se}function v(je){if(lt(je,s)){const ge=new s(je);return x(ge.buffer,ge.byteOffset,ge.byteLength)}return y(je)}function x(je,ge,se){if(ge<0||je.byteLength<ge)throw new RangeError('"offset" is outside of buffer bounds');if(je.byteLength<ge+(se||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return ge===void 0&&se===void 0?_e=new s(je):se===void 0?_e=new s(je,ge):_e=new s(je,ge,se),Object.setPrototypeOf(_e,u.prototype),_e}function E(je){if(u.isBuffer(je)){const ge=M(je.length)|0,se=c(ge);return se.length===0||je.copy(se,0,0,ge),se}if(je.length!==void 0)return typeof je.length!="number"||ct(je.length)?c(0):y(je);if(je.type==="Buffer"&&Array.isArray(je.data))return y(je.data)}function M(je){if(je>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return je|0}function k(je){return+je!=je&&(je=0),u.alloc(+je)}u.isBuffer=function(ge){return ge!=null&&ge._isBuffer===!0&&ge!==u.prototype},u.compare=function(ge,se){if(lt(ge,s)&&(ge=u.from(ge,ge.offset,ge.byteLength)),lt(se,s)&&(se=u.from(se,se.offset,se.byteLength)),!u.isBuffer(ge)||!u.isBuffer(se))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ge===se)return 0;let _e=ge.length,Ie=se.length;for(let De=0,Oe=Math.min(_e,Ie);De<Oe;++De)if(ge[De]!==se[De]){_e=ge[De],Ie=se[De];break}return _e<Ie?-1:Ie<_e?1:0},u.isEncoding=function(ge){switch(String(ge).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(ge,se){if(!Array.isArray(ge))throw new TypeError('"list" argument must be an Array of Buffers');if(ge.length===0)return u.alloc(0);let _e;if(se===void 0)for(se=0,_e=0;_e<ge.length;++_e)se+=ge[_e].length;const Ie=u.allocUnsafe(se);let De=0;for(_e=0;_e<ge.length;++_e){let Oe=ge[_e];if(lt(Oe,s))De+Oe.length>Ie.length?(u.isBuffer(Oe)||(Oe=u.from(Oe)),Oe.copy(Ie,De)):s.prototype.set.call(Ie,Oe,De);else if(u.isBuffer(Oe))Oe.copy(Ie,De);else throw new TypeError('"list" argument must be an Array of Buffers');De+=Oe.length}return Ie};function N(je,ge){if(u.isBuffer(je))return je.length;if(a.isView(je)||lt(je,a))return je.byteLength;if(typeof je!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof je);const se=je.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&se===0)return 0;let Ie=!1;for(;;)switch(ge){case"ascii":case"latin1":case"binary":return se;case"utf8":case"utf-8":return Se(je).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se*2;case"hex":return se>>>1;case"base64":return Ke(je).length;default:if(Ie)return _e?-1:Se(je).length;ge=(""+ge).toLowerCase(),Ie=!0}}u.byteLength=N;function I(je,ge,se){let _e=!1;if((ge===void 0||ge<0)&&(ge=0),ge>this.length||((se===void 0||se>this.length)&&(se=this.length),se<=0)||(se>>>=0,ge>>>=0,se<=ge))return"";for(je||(je="utf8");;)switch(je){case"hex":return ne(this,ge,se);case"utf8":case"utf-8":return q(this,ge,se);case"ascii":return Z(this,ge,se);case"latin1":case"binary":return K(this,ge,se);case"base64":return W(this,ge,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,ge,se);default:if(_e)throw new TypeError("Unknown encoding: "+je);je=(je+"").toLowerCase(),_e=!0}}u.prototype._isBuffer=!0;function D(je,ge,se){const _e=je[ge];je[ge]=je[se],je[se]=_e}u.prototype.swap16=function(){const ge=this.length;if(ge%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let se=0;se<ge;se+=2)D(this,se,se+1);return this},u.prototype.swap32=function(){const ge=this.length;if(ge%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let se=0;se<ge;se+=4)D(this,se,se+3),D(this,se+1,se+2);return this},u.prototype.swap64=function(){const ge=this.length;if(ge%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let se=0;se<ge;se+=8)D(this,se,se+7),D(this,se+1,se+6),D(this,se+2,se+5),D(this,se+3,se+4);return this},u.prototype.toString=function(){const ge=this.length;return ge===0?"":arguments.length===0?q(this,0,ge):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(ge){if(!u.isBuffer(ge))throw new TypeError("Argument must be a Buffer");return this===ge?!0:u.compare(this,ge)===0},u.prototype.inspect=function(){let ge="";const se=n.INSPECT_MAX_BYTES;return ge=this.toString("hex",0,se).replace(/(.{2})/g,"$1 ").trim(),this.length>se&&(ge+=" ... "),"<Buffer "+ge+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(ge,se,_e,Ie,De){if(lt(ge,s)&&(ge=u.from(ge,ge.offset,ge.byteLength)),!u.isBuffer(ge))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ge);if(se===void 0&&(se=0),_e===void 0&&(_e=ge?ge.length:0),Ie===void 0&&(Ie=0),De===void 0&&(De=this.length),se<0||_e>ge.length||Ie<0||De>this.length)throw new RangeError("out of range index");if(Ie>=De&&se>=_e)return 0;if(Ie>=De)return-1;if(se>=_e)return 1;if(se>>>=0,_e>>>=0,Ie>>>=0,De>>>=0,this===ge)return 0;let Oe=De-Ie,we=_e-se;const st=Math.min(Oe,we),Ve=this.slice(Ie,De),tt=ge.slice(se,_e);for(let Ze=0;Ze<st;++Ze)if(Ve[Ze]!==tt[Ze]){Oe=Ve[Ze],we=tt[Ze];break}return Oe<we?-1:we<Oe?1:0};function V(je,ge,se,_e,Ie){if(je.length===0)return-1;if(typeof se=="string"?(_e=se,se=0):se>2147483647?se=2147483647:se<-2147483648&&(se=-2147483648),se=+se,ct(se)&&(se=Ie?0:je.length-1),se<0&&(se=je.length+se),se>=je.length){if(Ie)return-1;se=je.length-1}else if(se<0)if(Ie)se=0;else return-1;if(typeof ge=="string"&&(ge=u.from(ge,_e)),u.isBuffer(ge))return ge.length===0?-1:G(je,ge,se,_e,Ie);if(typeof ge=="number")return ge=ge&255,typeof s.prototype.indexOf=="function"?Ie?s.prototype.indexOf.call(je,ge,se):s.prototype.lastIndexOf.call(je,ge,se):G(je,[ge],se,_e,Ie);throw new TypeError("val must be string, number or Buffer")}function G(je,ge,se,_e,Ie){let De=1,Oe=je.length,we=ge.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(je.length<2||ge.length<2)return-1;De=2,Oe/=2,we/=2,se/=2}function st(tt,Ze){return De===1?tt[Ze]:tt.readUInt16BE(Ze*De)}let Ve;if(Ie){let tt=-1;for(Ve=se;Ve<Oe;Ve++)if(st(je,Ve)===st(ge,tt===-1?0:Ve-tt)){if(tt===-1&&(tt=Ve),Ve-tt+1===we)return tt*De}else tt!==-1&&(Ve-=Ve-tt),tt=-1}else for(se+we>Oe&&(se=Oe-we),Ve=se;Ve>=0;Ve--){let tt=!0;for(let Ze=0;Ze<we;Ze++)if(st(je,Ve+Ze)!==st(ge,Ze)){tt=!1;break}if(tt)return Ve}return-1}u.prototype.includes=function(ge,se,_e){return this.indexOf(ge,se,_e)!==-1},u.prototype.indexOf=function(ge,se,_e){return V(this,ge,se,_e,!0)},u.prototype.lastIndexOf=function(ge,se,_e){return V(this,ge,se,_e,!1)};function J(je,ge,se,_e){se=Number(se)||0;const Ie=je.length-se;_e?(_e=Number(_e),_e>Ie&&(_e=Ie)):_e=Ie;const De=ge.length;_e>De/2&&(_e=De/2);let Oe;for(Oe=0;Oe<_e;++Oe){const we=parseInt(ge.substr(Oe*2,2),16);if(ct(we))return Oe;je[se+Oe]=we}return Oe}function B(je,ge,se,_e){return ot(Se(ge,je.length-se),je,se,_e)}function $(je,ge,se,_e){return ot(ke(ge),je,se,_e)}function U(je,ge,se,_e){return ot(Ke(ge),je,se,_e)}function Q(je,ge,se,_e){return ot(be(ge,je.length-se),je,se,_e)}u.prototype.write=function(ge,se,_e,Ie){if(se===void 0)Ie="utf8",_e=this.length,se=0;else if(_e===void 0&&typeof se=="string")Ie=se,_e=this.length,se=0;else if(isFinite(se))se=se>>>0,isFinite(_e)?(_e=_e>>>0,Ie===void 0&&(Ie="utf8")):(Ie=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const De=this.length-se;if((_e===void 0||_e>De)&&(_e=De),ge.length>0&&(_e<0||se<0)||se>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ie||(Ie="utf8");let Oe=!1;for(;;)switch(Ie){case"hex":return J(this,ge,se,_e);case"utf8":case"utf-8":return B(this,ge,se,_e);case"ascii":case"latin1":case"binary":return $(this,ge,se,_e);case"base64":return U(this,ge,se,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,ge,se,_e);default:if(Oe)throw new TypeError("Unknown encoding: "+Ie);Ie=(""+Ie).toLowerCase(),Oe=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(je,ge,se){return ge===0&&se===je.length?e.fromByteArray(je):e.fromByteArray(je.slice(ge,se))}function q(je,ge,se){se=Math.min(je.length,se);const _e=[];let Ie=ge;for(;Ie<se;){const De=je[Ie];let Oe=null,we=De>239?4:De>223?3:De>191?2:1;if(Ie+we<=se){let st,Ve,tt,Ze;switch(we){case 1:De<128&&(Oe=De);break;case 2:st=je[Ie+1],(st&192)===128&&(Ze=(De&31)<<6|st&63,Ze>127&&(Oe=Ze));break;case 3:st=je[Ie+1],Ve=je[Ie+2],(st&192)===128&&(Ve&192)===128&&(Ze=(De&15)<<12|(st&63)<<6|Ve&63,Ze>2047&&(Ze<55296||Ze>57343)&&(Oe=Ze));break;case 4:st=je[Ie+1],Ve=je[Ie+2],tt=je[Ie+3],(st&192)===128&&(Ve&192)===128&&(tt&192)===128&&(Ze=(De&15)<<18|(st&63)<<12|(Ve&63)<<6|tt&63,Ze>65535&&Ze<1114112&&(Oe=Ze))}}Oe===null?(Oe=65533,we=1):Oe>65535&&(Oe-=65536,_e.push(Oe>>>10&1023|55296),Oe=56320|Oe&1023),_e.push(Oe),Ie+=we}return ae(_e)}const Y=4096;function ae(je){const ge=je.length;if(ge<=Y)return String.fromCharCode.apply(String,je);let se="",_e=0;for(;_e<ge;)se+=String.fromCharCode.apply(String,je.slice(_e,_e+=Y));return se}function Z(je,ge,se){let _e="";se=Math.min(je.length,se);for(let Ie=ge;Ie<se;++Ie)_e+=String.fromCharCode(je[Ie]&127);return _e}function K(je,ge,se){let _e="";se=Math.min(je.length,se);for(let Ie=ge;Ie<se;++Ie)_e+=String.fromCharCode(je[Ie]);return _e}function ne(je,ge,se){const _e=je.length;(!ge||ge<0)&&(ge=0),(!se||se<0||se>_e)&&(se=_e);let Ie="";for(let De=ge;De<se;++De)Ie+=Vt[je[De]];return Ie}function le(je,ge,se){const _e=je.slice(ge,se);let Ie="";for(let De=0;De<_e.length-1;De+=2)Ie+=String.fromCharCode(_e[De]+_e[De+1]*256);return Ie}u.prototype.slice=function(ge,se){const _e=this.length;ge=~~ge,se=se===void 0?_e:~~se,ge<0?(ge+=_e,ge<0&&(ge=0)):ge>_e&&(ge=_e),se<0?(se+=_e,se<0&&(se=0)):se>_e&&(se=_e),se<ge&&(se=ge);const Ie=this.subarray(ge,se);return Object.setPrototypeOf(Ie,u.prototype),Ie};function ce(je,ge,se){if(je%1!==0||je<0)throw new RangeError("offset is not uint");if(je+ge>se)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ie=this[ge],De=1,Oe=0;for(;++Oe<se&&(De*=256);)Ie+=this[ge+Oe]*De;return Ie},u.prototype.readUintBE=u.prototype.readUIntBE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ie=this[ge+--se],De=1;for(;se>0&&(De*=256);)Ie+=this[ge+--se]*De;return Ie},u.prototype.readUint8=u.prototype.readUInt8=function(ge,se){return ge=ge>>>0,se||ce(ge,1,this.length),this[ge]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(ge,se){return ge=ge>>>0,se||ce(ge,2,this.length),this[ge]|this[ge+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(ge,se){return ge=ge>>>0,se||ce(ge,2,this.length),this[ge]<<8|this[ge+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),(this[ge]|this[ge+1]<<8|this[ge+2]<<16)+this[ge+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]*16777216+(this[ge+1]<<16|this[ge+2]<<8|this[ge+3])},u.prototype.readBigUInt64LE=Ot(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ie=se+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24,De=this[++ge]+this[++ge]*2**8+this[++ge]*2**16+_e*2**24;return BigInt(Ie)+(BigInt(De)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ot(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ie=se*2**24+this[++ge]*2**16+this[++ge]*2**8+this[++ge],De=this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+_e;return(BigInt(Ie)<<BigInt(32))+BigInt(De)}),u.prototype.readIntLE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ie=this[ge],De=1,Oe=0;for(;++Oe<se&&(De*=256);)Ie+=this[ge+Oe]*De;return De*=128,Ie>=De&&(Ie-=Math.pow(2,8*se)),Ie},u.prototype.readIntBE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ie=se,De=1,Oe=this[ge+--Ie];for(;Ie>0&&(De*=256);)Oe+=this[ge+--Ie]*De;return De*=128,Oe>=De&&(Oe-=Math.pow(2,8*se)),Oe},u.prototype.readInt8=function(ge,se){return ge=ge>>>0,se||ce(ge,1,this.length),this[ge]&128?(255-this[ge]+1)*-1:this[ge]},u.prototype.readInt16LE=function(ge,se){ge=ge>>>0,se||ce(ge,2,this.length);const _e=this[ge]|this[ge+1]<<8;return _e&32768?_e|4294901760:_e},u.prototype.readInt16BE=function(ge,se){ge=ge>>>0,se||ce(ge,2,this.length);const _e=this[ge+1]|this[ge]<<8;return _e&32768?_e|4294901760:_e},u.prototype.readInt32LE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]|this[ge+1]<<8|this[ge+2]<<16|this[ge+3]<<24},u.prototype.readInt32BE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]<<24|this[ge+1]<<16|this[ge+2]<<8|this[ge+3]},u.prototype.readBigInt64LE=Ot(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ie=this[ge+4]+this[ge+5]*2**8+this[ge+6]*2**16+(_e<<24);return(BigInt(Ie)<<BigInt(32))+BigInt(se+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24)}),u.prototype.readBigInt64BE=Ot(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ie=(se<<24)+this[++ge]*2**16+this[++ge]*2**8+this[++ge];return(BigInt(Ie)<<BigInt(32))+BigInt(this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+_e)}),u.prototype.readFloatLE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),t.read(this,ge,!0,23,4)},u.prototype.readFloatBE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),t.read(this,ge,!1,23,4)},u.prototype.readDoubleLE=function(ge,se){return ge=ge>>>0,se||ce(ge,8,this.length),t.read(this,ge,!0,52,8)},u.prototype.readDoubleBE=function(ge,se){return ge=ge>>>0,se||ce(ge,8,this.length),t.read(this,ge,!1,52,8)};function de(je,ge,se,_e,Ie,De){if(!u.isBuffer(je))throw new TypeError('"buffer" argument must be a Buffer instance');if(ge>Ie||ge<De)throw new RangeError('"value" argument is out of bounds');if(se+_e>je.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(ge,se,_e,Ie){if(ge=+ge,se=se>>>0,_e=_e>>>0,!Ie){const we=Math.pow(2,8*_e)-1;de(this,ge,se,_e,we,0)}let De=1,Oe=0;for(this[se]=ge&255;++Oe<_e&&(De*=256);)this[se+Oe]=ge/De&255;return se+_e},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(ge,se,_e,Ie){if(ge=+ge,se=se>>>0,_e=_e>>>0,!Ie){const we=Math.pow(2,8*_e)-1;de(this,ge,se,_e,we,0)}let De=_e-1,Oe=1;for(this[se+De]=ge&255;--De>=0&&(Oe*=256);)this[se+De]=ge/Oe&255;return se+_e},u.prototype.writeUint8=u.prototype.writeUInt8=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,1,255,0),this[se]=ge&255,se+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,65535,0),this[se]=ge&255,this[se+1]=ge>>>8,se+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,65535,0),this[se]=ge>>>8,this[se+1]=ge&255,se+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,4294967295,0),this[se+3]=ge>>>24,this[se+2]=ge>>>16,this[se+1]=ge>>>8,this[se]=ge&255,se+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,4294967295,0),this[se]=ge>>>24,this[se+1]=ge>>>16,this[se+2]=ge>>>8,this[se+3]=ge&255,se+4};function Me(je,ge,se,_e,Ie){Ue(ge,_e,Ie,je,se,7);let De=Number(ge&BigInt(4294967295));je[se++]=De,De=De>>8,je[se++]=De,De=De>>8,je[se++]=De,De=De>>8,je[se++]=De;let Oe=Number(ge>>BigInt(32)&BigInt(4294967295));return je[se++]=Oe,Oe=Oe>>8,je[se++]=Oe,Oe=Oe>>8,je[se++]=Oe,Oe=Oe>>8,je[se++]=Oe,se}function qe(je,ge,se,_e,Ie){Ue(ge,_e,Ie,je,se,7);let De=Number(ge&BigInt(4294967295));je[se+7]=De,De=De>>8,je[se+6]=De,De=De>>8,je[se+5]=De,De=De>>8,je[se+4]=De;let Oe=Number(ge>>BigInt(32)&BigInt(4294967295));return je[se+3]=Oe,Oe=Oe>>8,je[se+2]=Oe,Oe=Oe>>8,je[se+1]=Oe,Oe=Oe>>8,je[se]=Oe,se+8}u.prototype.writeBigUInt64LE=Ot(function(ge,se=0){return Me(this,ge,se,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ot(function(ge,se=0){return qe(this,ge,se,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(ge,se,_e,Ie){if(ge=+ge,se=se>>>0,!Ie){const st=Math.pow(2,8*_e-1);de(this,ge,se,_e,st-1,-st)}let De=0,Oe=1,we=0;for(this[se]=ge&255;++De<_e&&(Oe*=256);)ge<0&&we===0&&this[se+De-1]!==0&&(we=1),this[se+De]=(ge/Oe>>0)-we&255;return se+_e},u.prototype.writeIntBE=function(ge,se,_e,Ie){if(ge=+ge,se=se>>>0,!Ie){const st=Math.pow(2,8*_e-1);de(this,ge,se,_e,st-1,-st)}let De=_e-1,Oe=1,we=0;for(this[se+De]=ge&255;--De>=0&&(Oe*=256);)ge<0&&we===0&&this[se+De+1]!==0&&(we=1),this[se+De]=(ge/Oe>>0)-we&255;return se+_e},u.prototype.writeInt8=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,1,127,-128),ge<0&&(ge=255+ge+1),this[se]=ge&255,se+1},u.prototype.writeInt16LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,32767,-32768),this[se]=ge&255,this[se+1]=ge>>>8,se+2},u.prototype.writeInt16BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,32767,-32768),this[se]=ge>>>8,this[se+1]=ge&255,se+2},u.prototype.writeInt32LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,2147483647,-2147483648),this[se]=ge&255,this[se+1]=ge>>>8,this[se+2]=ge>>>16,this[se+3]=ge>>>24,se+4},u.prototype.writeInt32BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,2147483647,-2147483648),ge<0&&(ge=4294967295+ge+1),this[se]=ge>>>24,this[se+1]=ge>>>16,this[se+2]=ge>>>8,this[se+3]=ge&255,se+4},u.prototype.writeBigInt64LE=Ot(function(ge,se=0){return Me(this,ge,se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ot(function(ge,se=0){return qe(this,ge,se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ne(je,ge,se,_e,Ie,De){if(se+_e>je.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("Index out of range")}function Ae(je,ge,se,_e,Ie){return ge=+ge,se=se>>>0,Ie||Ne(je,ge,se,4),t.write(je,ge,se,_e,23,4),se+4}u.prototype.writeFloatLE=function(ge,se,_e){return Ae(this,ge,se,!0,_e)},u.prototype.writeFloatBE=function(ge,se,_e){return Ae(this,ge,se,!1,_e)};function Xe(je,ge,se,_e,Ie){return ge=+ge,se=se>>>0,Ie||Ne(je,ge,se,8),t.write(je,ge,se,_e,52,8),se+8}u.prototype.writeDoubleLE=function(ge,se,_e){return Xe(this,ge,se,!0,_e)},u.prototype.writeDoubleBE=function(ge,se,_e){return Xe(this,ge,se,!1,_e)},u.prototype.copy=function(ge,se,_e,Ie){if(!u.isBuffer(ge))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!Ie&&Ie!==0&&(Ie=this.length),se>=ge.length&&(se=ge.length),se||(se=0),Ie>0&&Ie<_e&&(Ie=_e),Ie===_e||ge.length===0||this.length===0)return 0;if(se<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if(Ie<0)throw new RangeError("sourceEnd out of bounds");Ie>this.length&&(Ie=this.length),ge.length-se<Ie-_e&&(Ie=ge.length-se+_e);const De=Ie-_e;return this===ge&&typeof s.prototype.copyWithin=="function"?this.copyWithin(se,_e,Ie):s.prototype.set.call(ge,this.subarray(_e,Ie),se),De},u.prototype.fill=function(ge,se,_e,Ie){if(typeof ge=="string"){if(typeof se=="string"?(Ie=se,se=0,_e=this.length):typeof _e=="string"&&(Ie=_e,_e=this.length),Ie!==void 0&&typeof Ie!="string")throw new TypeError("encoding must be a string");if(typeof Ie=="string"&&!u.isEncoding(Ie))throw new TypeError("Unknown encoding: "+Ie);if(ge.length===1){const Oe=ge.charCodeAt(0);(Ie==="utf8"&&Oe<128||Ie==="latin1")&&(ge=Oe)}}else typeof ge=="number"?ge=ge&255:typeof ge=="boolean"&&(ge=Number(ge));if(se<0||this.length<se||this.length<_e)throw new RangeError("Out of range index");if(_e<=se)return this;se=se>>>0,_e=_e===void 0?this.length:_e>>>0,ge||(ge=0);let De;if(typeof ge=="number")for(De=se;De<_e;++De)this[De]=ge;else{const Oe=u.isBuffer(ge)?ge:u.from(ge,Ie),we=Oe.length;if(we===0)throw new TypeError('The value "'+ge+'" is invalid for argument "value"');for(De=0;De<_e-se;++De)this[De+se]=Oe[De%we]}return this};const $e={};function at(je,ge,se){$e[je]=class extends se{constructor(){super(),Object.defineProperty(this,"message",{value:ge.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${je}]`,this.stack,delete this.name}get code(){return je}set code(Ie){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ie,writable:!0})}toString(){return`${this.name} [${je}]: ${this.message}`}}}at("ERR_BUFFER_OUT_OF_BOUNDS",function(je){return je?`${je} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),at("ERR_INVALID_ARG_TYPE",function(je,ge){return`The "${je}" argument must be of type number. Received type ${typeof ge}`},TypeError),at("ERR_OUT_OF_RANGE",function(je,ge,se){let _e=`The value of "${je}" is out of range.`,Ie=se;return Number.isInteger(se)&&Math.abs(se)>2**32?Ie=pt(String(se)):typeof se=="bigint"&&(Ie=String(se),(se>BigInt(2)**BigInt(32)||se<-(BigInt(2)**BigInt(32)))&&(Ie=pt(Ie)),Ie+="n"),_e+=` It must be ${ge}. Received ${Ie}`,_e},RangeError);function pt(je){let ge="",se=je.length;const _e=je[0]==="-"?1:0;for(;se>=_e+4;se-=3)ge=`_${je.slice(se-3,se)}${ge}`;return`${je.slice(0,se)}${ge}`}function oe(je,ge,se){Ge(ge,"offset"),(je[ge]===void 0||je[ge+se]===void 0)&&ze(ge,je.length-(se+1))}function Ue(je,ge,se,_e,Ie,De){if(je>se||je<ge){const Oe=typeof ge=="bigint"?"n":"";let we;throw ge===0||ge===BigInt(0)?we=`>= 0${Oe} and < 2${Oe} ** ${(De+1)*8}${Oe}`:we=`>= -(2${Oe} ** ${(De+1)*8-1}${Oe}) and < 2 ** ${(De+1)*8-1}${Oe}`,new $e.ERR_OUT_OF_RANGE("value",we,je)}oe(_e,Ie,De)}function Ge(je,ge){if(typeof je!="number")throw new $e.ERR_INVALID_ARG_TYPE(ge,"number",je)}function ze(je,ge,se){throw Math.floor(je)!==je?(Ge(je,se),new $e.ERR_OUT_OF_RANGE("offset","an integer",je)):ge<0?new $e.ERR_BUFFER_OUT_OF_BOUNDS:new $e.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ge}`,je)}const Be=/[^+/0-9A-Za-z-_]/g;function me(je){if(je=je.split("=")[0],je=je.trim().replace(Be,""),je.length<2)return"";for(;je.length%4!==0;)je=je+"=";return je}function Se(je,ge){ge=ge||1/0;let se;const _e=je.length;let Ie=null;const De=[];for(let Oe=0;Oe<_e;++Oe){if(se=je.charCodeAt(Oe),se>55295&&se<57344){if(!Ie){if(se>56319){(ge-=3)>-1&&De.push(239,191,189);continue}else if(Oe+1===_e){(ge-=3)>-1&&De.push(239,191,189);continue}Ie=se;continue}if(se<56320){(ge-=3)>-1&&De.push(239,191,189),Ie=se;continue}se=(Ie-55296<<10|se-56320)+65536}else Ie&&(ge-=3)>-1&&De.push(239,191,189);if(Ie=null,se<128){if((ge-=1)<0)break;De.push(se)}else if(se<2048){if((ge-=2)<0)break;De.push(se>>6|192,se&63|128)}else if(se<65536){if((ge-=3)<0)break;De.push(se>>12|224,se>>6&63|128,se&63|128)}else if(se<1114112){if((ge-=4)<0)break;De.push(se>>18|240,se>>12&63|128,se>>6&63|128,se&63|128)}else throw new Error("Invalid code point")}return De}function ke(je){const ge=[];for(let se=0;se<je.length;++se)ge.push(je.charCodeAt(se)&255);return ge}function be(je,ge){let se,_e,Ie;const De=[];for(let Oe=0;Oe<je.length&&!((ge-=2)<0);++Oe)se=je.charCodeAt(Oe),_e=se>>8,Ie=se%256,De.push(Ie),De.push(_e);return De}function Ke(je){return e.toByteArray(me(je))}function ot(je,ge,se,_e){let Ie;for(Ie=0;Ie<_e&&!(Ie+se>=ge.length||Ie>=je.length);++Ie)ge[Ie+se]=je[Ie];return Ie}function lt(je,ge){return je instanceof ge||je!=null&&je.constructor!=null&&je.constructor.name!=null&&je.constructor.name===ge.name}function ct(je){return je!==je}const Vt=(function(){const je="0123456789abcdef",ge=new Array(256);for(let se=0;se<16;++se){const _e=se*16;for(let Ie=0;Ie<16;++Ie)ge[_e+Ie]=je[se]+je[Ie]}return ge})();function Ot(je){return typeof BigInt>"u"?Ut:je}function Ut(){throw new Error("BigInt not supported")}})(Nce);const Bl=Nce.Buffer;function $I(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var CB={exports:{}},pX;function JIe(){return pX||(pX=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(r,i,s){function a(c,u){if(!i[c]){if(!r[c]){var f=typeof $I=="function"&&$I;if(!u&&f)return f(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var g=i[c]={exports:{}};r[c][0].call(g.exports,function(p){var _=r[c][1][p];return a(_||p)},g,g.exports,t,r,i,s)}return i[c].exports}for(var o=typeof $I=="function"&&$I,l=0;l<s.length;l++)a(s[l]);return a})({1:[function(t,r,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,f,h,g,p,_,y=[],v=0,x=l.length,E=x,M=s.getTypeOf(l)!=="string";v<l.length;)E=x-v,f=M?(c=l[v++],u=v<x?l[v++]:0,v<x?l[v++]:0):(c=l.charCodeAt(v++),u=v<x?l.charCodeAt(v++):0,v<x?l.charCodeAt(v++):0),h=c>>2,g=(3&c)<<4|u>>4,p=1<E?(15&u)<<2|f>>6:64,_=2<E?63&f:64,y.push(o.charAt(h)+o.charAt(g)+o.charAt(p)+o.charAt(_));return y.join("")},i.decode=function(l){var c,u,f,h,g,p,_=0,y=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var x,E=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|E):new Array(0|E);_<l.length;)c=o.indexOf(l.charAt(_++))<<2|(h=o.indexOf(l.charAt(_++)))>>4,u=(15&h)<<4|(g=o.indexOf(l.charAt(_++)))>>2,f=(3&g)<<6|(p=o.indexOf(l.charAt(_++))),x[y++]=c,g!==64&&(x[y++]=u),p!==64&&(x[y++]=f);return x}},{"./support":30,"./utils":32}],2:[function(t,r,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(u,f,h,g,p){this.compressedSize=u,this.uncompressedSize=f,this.crc32=h,this.compression=g,this.compressedContent=p}c.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var s=t("./utils"),a=(function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l})();r.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?(function(c,u,f,h){var g=a,p=h+f;c^=-1;for(var _=h;_<p;_++)c=c>>>8^g[255&(c^u[_])];return-1^c})(0|l,o,o.length,0):(function(c,u,f,h){var g=a,p=h+f;c^=-1;for(var _=h;_<p;_++)c=c>>>8^g[255&(c^u.charCodeAt(_))];return-1^c})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";function u(f,h){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}i.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){function s(g,p){var _,y="";for(_=0;_<p;_++)y+=String.fromCharCode(255&g),g>>>=8;return y}function a(g,p,_,y,v,x){var E,M,k=g.file,N=g.compression,I=x!==c.utf8encode,D=o.transformTo("string",x(k.name)),V=o.transformTo("string",c.utf8encode(k.name)),G=k.comment,J=o.transformTo("string",x(G)),B=o.transformTo("string",c.utf8encode(G)),$=V.length!==k.name.length,U=B.length!==G.length,Q="",W="",q="",Y=k.dir,ae=k.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};p&&!_||(Z.crc32=g.crc32,Z.compressedSize=g.compressedSize,Z.uncompressedSize=g.uncompressedSize);var K=0;p&&(K|=8),I||!$&&!U||(K|=2048);var ne=0,le=0;Y&&(ne|=16),v==="UNIX"?(le=798,ne|=(function(de,Me){var qe=de;return de||(qe=Me?16893:33204),(65535&qe)<<16})(k.unixPermissions,Y)):(le=20,ne|=(function(de){return 63&(de||0)})(k.dosPermissions)),E=ae.getUTCHours(),E<<=6,E|=ae.getUTCMinutes(),E<<=5,E|=ae.getUTCSeconds()/2,M=ae.getUTCFullYear()-1980,M<<=4,M|=ae.getUTCMonth()+1,M<<=5,M|=ae.getUTCDate(),$&&(W=s(1,1)+s(u(D),4)+V,Q+="up"+s(W.length,2)+W),U&&(q=s(1,1)+s(u(J),4)+B,Q+="uc"+s(q.length,2)+q);var ce="";return ce+=`
\0`,ce+=s(K,2),ce+=N.magic,ce+=s(E,2),ce+=s(M,2),ce+=s(Z.crc32,4),ce+=s(Z.compressedSize,4),ce+=s(Z.uncompressedSize,4),ce+=s(D.length,2),ce+=s(Q.length,2),{fileRecord:f.LOCAL_FILE_HEADER+ce+D+Q,dirRecord:f.CENTRAL_FILE_HEADER+s(le,2)+ce+s(J.length,2)+"\0\0\0\0"+s(ne,4)+s(y,4)+D+Q+J}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),u=t("../crc32"),f=t("../signature");function h(g,p,_,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=_,this.encodeFileName=y,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(g){var p=g.meta.percent||0,_=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,l.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:_?(p+100*(_-y-1))/_:100}}))},h.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var p=this.streamFiles&&!g.file.dir;if(p){var _=a(g,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(g){this.accumulate=!1;var p=this.streamFiles&&!g.file.dir,_=a(g,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),p)this.push({data:(function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)})(g),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var g=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var _=this.bytesWritten-g,y=(function(v,x,E,M,k){var N=o.transformTo("string",k(M));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(v,2)+s(v,2)+s(x,4)+s(E,4)+s(N.length,2)+N})(this.dirRecords.length,_,g,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(g){this._sources.push(g);var p=this;return g.on("data",function(_){p.processChunk(_)}),g.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),g.on("error",function(_){p.error(_)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(g){var p=this._sources;if(!l.prototype.error.call(this,g))return!1;for(var _=0;_<p.length;_++)try{p[_].error(g)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var g=this._sources,p=0;p<g.length;p++)g[p].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var s=t("../compressions"),a=t("./ZipFileWorker");i.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{o.forEach(function(h,g){f++;var p=(function(x,E){var M=x||E,k=s[M];if(!k)throw new Error(M+" is not a valid compression method !");return k})(g.options.compression,l.compression),_=g.options.compressionOptions||l.compressionOptions||{},y=g.dir,v=g.date;g._compressWorker(p,_).withStreamInfo("file",{name:h,dir:y,date:v,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function f(h){return new a.Promise(function(g,p){var _=h.decompressed.getContentWorker().pipe(new c);_.on("error",function(y){p(y)}).on("end",function(){_.streamInfo.crc32!==h.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}r.exports=function(h,g){var p=this;return g=s.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,g.optimizedBinaryString,g.base64).then(function(_){var y=new l(g);return y.load(_),y}).then(function(_){var y=[a.Promise.resolve(_)],v=_.files;if(g.checkCRC32)for(var x=0;x<v.length;x++)y.push(f(v[x]));return a.Promise.all(y)}).then(function(_){for(var y=_.shift(),v=y.files,x=0;x<v.length;x++){var E=v[x],M=E.fileNameStr,k=s.resolve(E.fileNameStr);p.file(k,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(p.file(k).unsafeOriginalName=M)}return y.zipComment.length&&(p.comment=y.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var s=t("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var u=this;o.on("data",function(f,h){u.push(f)||u._helper.pause(),c&&c(h)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Bl<"u",newBufferFrom:function(s,a){if(Bl.from&&Bl.from!==Uint8Array.from)return Bl.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Bl(s,a)},allocBuffer:function(s){if(Bl.alloc)return Bl.alloc(s);var a=new Bl(s);return a.fill(0),a},isBuffer:function(s){return Bl.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,i){function s(k,N,I){var D,V=o.getTypeOf(N),G=o.extend(I||{},u);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(k=v(k)),G.createFolders&&(D=y(k))&&x.call(this,D,!0);var J=V==="string"&&G.binary===!1&&G.base64===!1;I&&I.binary!==void 0||(G.binary=!J),(N instanceof f&&N.uncompressedSize===0||G.dir||!N||N.length===0)&&(G.base64=!1,G.binary=!0,N="",G.compression="STORE",V="string");var B=null;B=N instanceof f||N instanceof l?N:p.isNode&&p.isStream(N)?new _(k,N):o.prepareContent(k,N,G.binary,G.optimizedBinaryString,G.base64);var $=new h(k,B,G);this.files[k]=$}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),u=t("./defaults"),f=t("./compressedObject"),h=t("./zipObject"),g=t("./generate"),p=t("./nodejsUtils"),_=t("./nodejs/NodejsStreamInputAdapter"),y=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var N=k.lastIndexOf("/");return 0<N?k.substring(0,N):""},v=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},x=function(k,N){return N=N!==void 0?N:u.createFolders,k=v(k),this.files[k]||s.call(this,k,null,{dir:!0,createFolders:N}),this.files[k]};function E(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var N,I,D;for(N in this.files)D=this.files[N],(I=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&k(I,D)},filter:function(k){var N=[];return this.forEach(function(I,D){k(I,D)&&N.push(D)}),N},file:function(k,N,I){if(arguments.length!==1)return k=this.root+k,s.call(this,k,N,I),this;if(E(k)){var D=k;return this.filter(function(G,J){return!J.dir&&D.test(G)})}var V=this.files[this.root+k];return V&&!V.dir?V:null},folder:function(k){if(!k)return this;if(E(k))return this.filter(function(V,G){return G.dir&&k.test(V)});var N=this.root+k,I=x.call(this,N),D=this.clone();return D.root=I.name,D},remove:function(k){k=this.root+k;var N=this.files[k];if(N||(k.slice(-1)!=="/"&&(k+="/"),N=this.files[k]),N&&!N.dir)delete this.files[k];else for(var I=this.filter(function(V,G){return G.name.slice(0,k.length)===k}),D=0;D<I.length;D++)delete this.files[I[D].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var N,I={};try{if((I=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");o.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var D=I.comment||this.comment||"";N=g.generateWorker(this,I,D)}catch(V){(N=new l("error")).error(V)}return new c(N,I.type||"string",I.mimeType)},generateAsync:function(k,N){return this.generateInternalStream(k).accumulate(N)},generateNodeStream:function(k,N){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(N)}};r.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===f)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&f===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(t,r,i){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");r.exports=function(f){var h=s.getTypeOf(f);return s.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(f):a.uint8array?new u(s.transformTo("uint8array",f)):new o(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(t,r,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),u=t("../external"),f=null;if(c.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,_){return new u.Promise(function(y,v){var x=[],E=p._internalType,M=p._outputType,k=p._mimeType;p.on("data",function(N,I){x.push(N),_&&_(I)}).on("error",function(N){x=[],v(N)}).on("end",function(){try{var N=(function(I,D,V){switch(I){case"blob":return s.newBlob(s.transformTo("arraybuffer",D),V);case"base64":return l.encode(D);default:return s.transformTo(I,D)}})(M,(function(I,D){var V,G=0,J=null,B=0;for(V=0;V<D.length;V++)B+=D[V].length;switch(I){case"string":return D.join("");case"array":return Array.prototype.concat.apply([],D);case"uint8array":for(J=new Uint8Array(B),V=0;V<D.length;V++)J.set(D[V],G),G+=D[V].length;return J;case"nodebuffer":return Bl.concat(D);default:throw new Error("concat : unsupported type '"+I+"'")}})(E,x),k);y(N)}catch(I){v(I)}x=[]}).resume()})}function g(p,_,y){var v=_;switch(_){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=_,this._mimeType=y,s.checkSupport(v),this._worker=p.pipe(new a(v)),p.lock()}catch(x){this._worker=new o("error"),this._worker.error(x)}}g.prototype={accumulate:function(p){return h(this,p)},on:function(p,_){var y=this;return p==="data"?this._worker.on(p,function(v){_.call(y,v.data,v.meta)}):this._worker.on(p,function(){s.delay(_,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Bl<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}i.utf8encode=function(g){return a.nodebuffer?o.newBufferFrom(g,"utf-8"):(function(p){var _,y,v,x,E,M=p.length,k=0;for(x=0;x<M;x++)(64512&(y=p.charCodeAt(x)))==55296&&x+1<M&&(64512&(v=p.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),x++),k+=y<128?1:y<2048?2:y<65536?3:4;for(_=a.uint8array?new Uint8Array(k):new Array(k),x=E=0;E<k;x++)(64512&(y=p.charCodeAt(x)))==55296&&x+1<M&&(64512&(v=p.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),x++),y<128?_[E++]=y:(y<2048?_[E++]=192|y>>>6:(y<65536?_[E++]=224|y>>>12:(_[E++]=240|y>>>18,_[E++]=128|y>>>12&63),_[E++]=128|y>>>6&63),_[E++]=128|63&y);return _})(g)},i.utf8decode=function(g){return a.nodebuffer?s.transformTo("nodebuffer",g).toString("utf-8"):(function(p){var _,y,v,x,E=p.length,M=new Array(2*E);for(_=y=0;_<E;)if((v=p[_++])<128)M[y++]=v;else if(4<(x=c[v]))M[y++]=65533,_+=x-1;else{for(v&=x===2?31:x===3?15:7;1<x&&_<E;)v=v<<6|63&p[_++],x--;1<x?M[y++]=65533:v<65536?M[y++]=v:(v-=65536,M[y++]=55296|v>>10&1023,M[y++]=56320|1023&v)}return M.length!==y&&(M.subarray?M=M.subarray(0,y):M.length=y),s.applyFromCharCode(M)})(g=s.transformTo(a.uint8array?"uint8array":"array",g))},s.inherits(f,l),f.prototype.processChunk=function(g){var p=s.transformTo(a.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var _=p;(p=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),p.set(_,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var y=(function(x,E){var M;for((E=E||x.length)>x.length&&(E=x.length),M=E-1;0<=M&&(192&x[M])==128;)M--;return M<0||M===0?E:M+c[x[M]]>E?M:E})(p),v=p;y!==p.length&&(a.uint8array?(v=p.subarray(0,y),this.leftOver=p.subarray(y,p.length)):(v=p.slice(0,y),this.leftOver=p.slice(y,p.length))),this.push({data:i.utf8decode(v),meta:g.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(h,l),h.prototype.processChunk=function(g){this.push({data:i.utf8encode(g.data),meta:g.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(_){return _}function u(_,y){for(var v=0;v<_.length;++v)y[v]=255&_.charCodeAt(v);return y}t("setimmediate"),i.newBlob=function(_,y){i.checkSupport("blob");try{return new Blob([_],{type:y})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(_),v.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(_,y,v){var x=[],E=0,M=_.length;if(M<=v)return String.fromCharCode.apply(null,_);for(;E<M;)y==="array"||y==="nodebuffer"?x.push(String.fromCharCode.apply(null,_.slice(E,Math.min(E+v,M)))):x.push(String.fromCharCode.apply(null,_.subarray(E,Math.min(E+v,M)))),E+=v;return x.join("")},stringifyByChar:function(_){for(var y="",v=0;v<_.length;v++)y+=String.fromCharCode(_[v]);return y},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function h(_){var y=65536,v=i.getTypeOf(_),x=!0;if(v==="uint8array"?x=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(x=f.applyCanBeUsed.nodebuffer),x)for(;1<y;)try{return f.stringifyByChunk(_,v,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(_)}function g(_,y){for(var v=0;v<_.length;v++)y[v]=_[v];return y}i.applyFromCharCode=h;var p={};p.string={string:c,array:function(_){return u(_,new Array(_.length))},arraybuffer:function(_){return p.string.uint8array(_).buffer},uint8array:function(_){return u(_,new Uint8Array(_.length))},nodebuffer:function(_){return u(_,o.allocBuffer(_.length))}},p.array={string:h,array:c,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return o.newBufferFrom(_)}},p.arraybuffer={string:function(_){return h(new Uint8Array(_))},array:function(_){return g(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:c,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return o.newBufferFrom(new Uint8Array(_))}},p.uint8array={string:h,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:c,nodebuffer:function(_){return o.newBufferFrom(_)}},p.nodebuffer={string:h,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return p.nodebuffer.uint8array(_).buffer},uint8array:function(_){return g(_,new Uint8Array(_.length))},nodebuffer:c},i.transformTo=function(_,y){if(y=y||"",!_)return y;i.checkSupport(_);var v=i.getTypeOf(y);return p[v][_](y)},i.resolve=function(_){for(var y=_.split("/"),v=[],x=0;x<y.length;x++){var E=y[x];E==="."||E===""&&x!==0&&x!==y.length-1||(E===".."?v.pop():v.push(E))}return v.join("/")},i.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(_)?"nodebuffer":s.uint8array&&_ instanceof Uint8Array?"uint8array":s.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(_){if(!s[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(_){var y,v,x="";for(v=0;v<(_||"").length;v++)x+="\\x"+((y=_.charCodeAt(v))<16?"0":"")+y.toString(16).toUpperCase();return x},i.delay=function(_,y,v){setImmediate(function(){_.apply(v||null,y||[])})},i.inherits=function(_,y){function v(){}v.prototype=y.prototype,_.prototype=new v},i.extend=function(){var _,y,v={};for(_=0;_<arguments.length;_++)for(y in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],y)&&v[y]===void 0&&(v[y]=arguments[_][y]);return v},i.prepareContent=function(_,y,v,x,E){return l.Promise.resolve(y).then(function(M){return s.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,N){var I=new FileReader;I.onload=function(D){k(D.target.result)},I.onerror=function(D){N(D.target.error)},I.readAsArrayBuffer(M)}):M}).then(function(M){var k=i.getTypeOf(M);return k?(k==="arraybuffer"?M=i.transformTo("uint8array",M):k==="string"&&(E?M=a.decode(M):v&&x!==!0&&(M=(function(N){return u(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))})(M))),M):l.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(f)+")")}},isSignature:function(f,h){var g=this.reader.index;this.reader.setIndex(f);var p=this.reader.readString(4)===h;return this.reader.setIndex(g),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",g=a.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,g,p=this.zip64EndOfCentralSize-44;0<p;)f=this.reader.readInt(2),h=this.reader.readInt(4),g=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var p=h-g;if(0<p)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),u=t("./compressions"),f=t("./support");function h(g,p){this.options=g,this.loadOptions=p}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var p,_;if(g.skip(22),this.fileNameLength=g.readInt(2),_=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=(function(y){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===y)return u[v];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,p,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var p=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(p),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var p,_,y,v=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<v;)p=g.readInt(2),_=g.readInt(2),y=g.readData(_),this.extraFields[p]={id:p,length:_,value:y};g.setIndex(v)},handleUTF8:function(){var g=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var _=a.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var v=a.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var p=s(g.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var p=s(g.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(g.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){function s(p,_,y){this.name=p,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=_,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),u=t("./stream/GenericWorker");s.prototype={internalStream:function(p){var _=null,y="string";try{if(!p)throw new Error("No output type specified.");var v=(y=p.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),_=this._decompressWorker();var x=!this._dataBinary;x&&!v&&(_=_.pipe(new l.Utf8EncodeWorker)),!x&&v&&(_=_.pipe(new l.Utf8DecodeWorker))}catch(E){(_=new u("error")).error(E)}return new a(_,y,"")},async:function(p,_){return this.internalStream(p).accumulate(_)},nodeStream:function(p,_){return this.internalStream(p||"nodebuffer").toNodejsStream(_)},_compressWorker:function(p,_){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,p,_)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)s.prototype[f[g]]=h;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(p),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var _=s.document.createElement("script");_.onreadystatechange=function(){p(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},s.document.documentElement.appendChild(_)}:function(){setTimeout(p,0)};else{var h=new s.MessageChannel;h.port1.onmessage=p,a=function(){h.port2.postMessage(0)}}var g=[];function p(){var _,y;o=!0;for(var v=g.length;v;){for(y=g,g=[],_=-1;++_<v;)y[_]();v=g.length}o=!1}r.exports=function(_){g.push(_)!==1||o||a()}}).call(this,typeof k0<"u"?k0:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==a&&_(this,v)}function h(v,x,E){this.promise=v,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function g(v,x,E){s(function(){var M;try{M=x(E)}catch(k){return o.reject(v,k)}M===v?o.reject(v,new TypeError("Cannot resolve promise with itself")):o.resolve(v,M)})}function p(v){var x=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof x=="function")return function(){x.apply(v,arguments)}}function _(v,x){var E=!1;function M(I){E||(E=!0,o.reject(v,I))}function k(I){E||(E=!0,o.resolve(v,I))}var N=y(function(){x(k,M)});N.status==="error"&&M(N.value)}function y(v,x){var E={};try{E.value=v(x),E.status="success"}catch(M){E.status="error",E.value=M}return E}(r.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var x=this.constructor;return this.then(function(E){return x.resolve(v()).then(function(){return E})},function(E){return x.resolve(v()).then(function(){throw E})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,x){if(typeof v!="function"&&this.state===c||typeof x!="function"&&this.state===l)return this;var E=new this.constructor(a);return this.state!==u?g(E,this.state===c?v:x,this.outcome):this.queue.push(new h(E,v,x)),E},h.prototype.callFulfilled=function(v){o.resolve(this.promise,v)},h.prototype.otherCallFulfilled=function(v){g(this.promise,this.onFulfilled,v)},h.prototype.callRejected=function(v){o.reject(this.promise,v)},h.prototype.otherCallRejected=function(v){g(this.promise,this.onRejected,v)},o.resolve=function(v,x){var E=y(p,x);if(E.status==="error")return o.reject(v,E.value);var M=E.value;if(M)_(v,M);else{v.state=c,v.outcome=x;for(var k=-1,N=v.queue.length;++k<N;)v.queue[k].callFulfilled(x)}return v},o.reject=function(v,x){v.state=l,v.outcome=x;for(var E=-1,M=v.queue.length;++E<M;)v.queue[E].callRejected(x);return v},f.resolve=function(v){return v instanceof this?v:o.resolve(new this(a),v)},f.reject=function(v){var x=new this(a);return o.reject(x,v)},f.all=function(v){var x=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=v.length,M=!1;if(!E)return this.resolve([]);for(var k=new Array(E),N=0,I=-1,D=new this(a);++I<E;)V(v[I],I);return D;function V(G,J){x.resolve(G).then(function(B){k[J]=B,++N!==E||M||(M=!0,o.resolve(D,k))},function(B){M||(M=!0,o.reject(D,B))})}},f.race=function(v){var x=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=v.length,M=!1;if(!E)return this.resolve([]);for(var k=-1,N=new this(a);++k<E;)I=v[k],x.resolve(I).then(function(D){M||(M=!0,o.resolve(N,D))},function(D){M||(M=!0,o.reject(N,D))});var I;return N}},{immediate:36}],38:[function(t,r,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),u=Object.prototype.toString,f=0,h=-1,g=0,p=8;function _(v){if(!(this instanceof _))return new _(v);this.options=a.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},v||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var E=s.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(E!==f)throw new Error(l[E]);if(x.header&&s.deflateSetHeader(this.strm,x.header),x.dictionary){var M;if(M=typeof x.dictionary=="string"?o.string2buf(x.dictionary):u.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(E=s.deflateSetDictionary(this.strm,M))!==f)throw new Error(l[E]);this._dict_set=!0}}function y(v,x){var E=new _(x);if(E.push(v,!0),E.err)throw E.msg||l[E.err];return E.result}_.prototype.push=function(v,x){var E,M,k=this.strm,N=this.options.chunkSize;if(this.ended)return!1;M=x===~~x?x:x===!0?4:0,typeof v=="string"?k.input=o.string2buf(v):u.call(v)==="[object ArrayBuffer]"?k.input=new Uint8Array(v):k.input=v,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(N),k.next_out=0,k.avail_out=N),(E=s.deflate(k,M))!==1&&E!==f)return this.onEnd(E),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&E!==1);return M===4?(E=s.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===f):M!==2||(this.onEnd(f),!(k.avail_out=0))},_.prototype.onData=function(v){this.chunks.push(v)},_.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=_,i.deflate=y,i.deflateRaw=function(v,x){return(x=x||{}).raw=!0,y(v,x)},i.gzip=function(v,x){return(x=x||{}).gzip=!0,y(v,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),u=t("./zlib/zstream"),f=t("./zlib/gzheader"),h=Object.prototype.toString;function g(_){if(!(this instanceof g))return new g(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||_&&_.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,y.windowBits);if(v!==l.Z_OK)throw new Error(c[v]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function p(_,y){var v=new g(y);if(v.push(_,!0),v.err)throw v.msg||c[v.err];return v.result}g.prototype.push=function(_,y){var v,x,E,M,k,N,I=this.strm,D=this.options.chunkSize,V=this.options.dictionary,G=!1;if(this.ended)return!1;x=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof _=="string"?I.input=o.binstring2buf(_):h.call(_)==="[object ArrayBuffer]"?I.input=new Uint8Array(_):I.input=_,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(D),I.next_out=0,I.avail_out=D),(v=s.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&V&&(N=typeof V=="string"?o.string2buf(V):h.call(V)==="[object ArrayBuffer]"?new Uint8Array(V):V,v=s.inflateSetDictionary(this.strm,N)),v===l.Z_BUF_ERROR&&G===!0&&(v=l.Z_OK,G=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&v!==l.Z_STREAM_END&&(I.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(I.output,I.next_out),M=I.next_out-E,k=o.buf2string(I.output,E),I.next_out=M,I.avail_out=D-M,M&&a.arraySet(I.output,I.output,E,M,0),this.onData(k)):this.onData(a.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(G=!0)}while((0<I.avail_in||I.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(v=s.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Inflate=g,i.inflate=p,i.inflateRaw=function(_,y){return(y=y||{}).raw=!0,p(_,y)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,f,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),h);else for(var g=0;g<f;g++)l[h+g]=c[u+g]},flattenChunks:function(l){var c,u,f,h,g,p;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(p=new Uint8Array(f),c=h=0,u=l.length;c<u;c++)g=l[c],p.set(g,h),h+=g.length;return p}},o={arraySet:function(l,c,u,f,h){for(var g=0;g<f;g++)l[h+g]=c[u+g]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,r,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,h){if(h<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,h));for(var g="",p=0;p<h;p++)g+=String.fromCharCode(f[p]);return g}l[254]=l[254]=1,i.string2buf=function(f){var h,g,p,_,y,v=f.length,x=0;for(_=0;_<v;_++)(64512&(g=f.charCodeAt(_)))==55296&&_+1<v&&(64512&(p=f.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),_++),x+=g<128?1:g<2048?2:g<65536?3:4;for(h=new s.Buf8(x),_=y=0;y<x;_++)(64512&(g=f.charCodeAt(_)))==55296&&_+1<v&&(64512&(p=f.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),_++),g<128?h[y++]=g:(g<2048?h[y++]=192|g>>>6:(g<65536?h[y++]=224|g>>>12:(h[y++]=240|g>>>18,h[y++]=128|g>>>12&63),h[y++]=128|g>>>6&63),h[y++]=128|63&g);return h},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var h=new s.Buf8(f.length),g=0,p=h.length;g<p;g++)h[g]=f.charCodeAt(g);return h},i.buf2string=function(f,h){var g,p,_,y,v=h||f.length,x=new Array(2*v);for(g=p=0;g<v;)if((_=f[g++])<128)x[p++]=_;else if(4<(y=l[_]))x[p++]=65533,g+=y-1;else{for(_&=y===2?31:y===3?15:7;1<y&&g<v;)_=_<<6|63&f[g++],y--;1<y?x[p++]=65533:_<65536?x[p++]=_:(_-=65536,x[p++]=55296|_>>10&1023,x[p++]=56320|1023&_)}return u(x,p)},i.utf8border=function(f,h){var g;for((h=h||f.length)>f.length&&(h=f.length),g=h-1;0<=g&&(192&f[g])==128;)g--;return g<0||g===0?h:g+l[f[g]]>h?g:h}},{"./common":41}],43:[function(t,r,i){r.exports=function(s,a,o,l){for(var c=65535&s|0,u=s>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){var s=(function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o})();r.exports=function(a,o,l,c){var u=s,f=c+l;a^=-1;for(var h=c;h<f;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(t,r,i){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),u=t("./messages"),f=0,h=4,g=0,p=-2,_=-1,y=4,v=2,x=8,E=9,M=286,k=30,N=19,I=2*M+1,D=15,V=3,G=258,J=G+V+1,B=42,$=113,U=1,Q=2,W=3,q=4;function Y(oe,Ue){return oe.msg=u[Ue],Ue}function ae(oe){return(oe<<1)-(4<oe?9:0)}function Z(oe){for(var Ue=oe.length;0<=--Ue;)oe[Ue]=0}function K(oe){var Ue=oe.state,Ge=Ue.pending;Ge>oe.avail_out&&(Ge=oe.avail_out),Ge!==0&&(a.arraySet(oe.output,Ue.pending_buf,Ue.pending_out,Ge,oe.next_out),oe.next_out+=Ge,Ue.pending_out+=Ge,oe.total_out+=Ge,oe.avail_out-=Ge,Ue.pending-=Ge,Ue.pending===0&&(Ue.pending_out=0))}function ne(oe,Ue){o._tr_flush_block(oe,0<=oe.block_start?oe.block_start:-1,oe.strstart-oe.block_start,Ue),oe.block_start=oe.strstart,K(oe.strm)}function le(oe,Ue){oe.pending_buf[oe.pending++]=Ue}function ce(oe,Ue){oe.pending_buf[oe.pending++]=Ue>>>8&255,oe.pending_buf[oe.pending++]=255&Ue}function de(oe,Ue){var Ge,ze,Be=oe.max_chain_length,me=oe.strstart,Se=oe.prev_length,ke=oe.nice_match,be=oe.strstart>oe.w_size-J?oe.strstart-(oe.w_size-J):0,Ke=oe.window,ot=oe.w_mask,lt=oe.prev,ct=oe.strstart+G,Vt=Ke[me+Se-1],Ot=Ke[me+Se];oe.prev_length>=oe.good_match&&(Be>>=2),ke>oe.lookahead&&(ke=oe.lookahead);do if(Ke[(Ge=Ue)+Se]===Ot&&Ke[Ge+Se-1]===Vt&&Ke[Ge]===Ke[me]&&Ke[++Ge]===Ke[me+1]){me+=2,Ge++;do;while(Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&me<ct);if(ze=G-(ct-me),me=ct-G,Se<ze){if(oe.match_start=Ue,ke<=(Se=ze))break;Vt=Ke[me+Se-1],Ot=Ke[me+Se]}}while((Ue=lt[Ue&ot])>be&&--Be!=0);return Se<=oe.lookahead?Se:oe.lookahead}function Me(oe){var Ue,Ge,ze,Be,me,Se,ke,be,Ke,ot,lt=oe.w_size;do{if(Be=oe.window_size-oe.lookahead-oe.strstart,oe.strstart>=lt+(lt-J)){for(a.arraySet(oe.window,oe.window,lt,lt,0),oe.match_start-=lt,oe.strstart-=lt,oe.block_start-=lt,Ue=Ge=oe.hash_size;ze=oe.head[--Ue],oe.head[Ue]=lt<=ze?ze-lt:0,--Ge;);for(Ue=Ge=lt;ze=oe.prev[--Ue],oe.prev[Ue]=lt<=ze?ze-lt:0,--Ge;);Be+=lt}if(oe.strm.avail_in===0)break;if(Se=oe.strm,ke=oe.window,be=oe.strstart+oe.lookahead,Ke=Be,ot=void 0,ot=Se.avail_in,Ke<ot&&(ot=Ke),Ge=ot===0?0:(Se.avail_in-=ot,a.arraySet(ke,Se.input,Se.next_in,ot,be),Se.state.wrap===1?Se.adler=l(Se.adler,ke,ot,be):Se.state.wrap===2&&(Se.adler=c(Se.adler,ke,ot,be)),Se.next_in+=ot,Se.total_in+=ot,ot),oe.lookahead+=Ge,oe.lookahead+oe.insert>=V)for(me=oe.strstart-oe.insert,oe.ins_h=oe.window[me],oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[me+1])&oe.hash_mask;oe.insert&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[me+V-1])&oe.hash_mask,oe.prev[me&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=me,me++,oe.insert--,!(oe.lookahead+oe.insert<V)););}while(oe.lookahead<J&&oe.strm.avail_in!==0)}function qe(oe,Ue){for(var Ge,ze;;){if(oe.lookahead<J){if(Me(oe),oe.lookahead<J&&Ue===f)return U;if(oe.lookahead===0)break}if(Ge=0,oe.lookahead>=V&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),Ge!==0&&oe.strstart-Ge<=oe.w_size-J&&(oe.match_length=de(oe,Ge)),oe.match_length>=V)if(ze=o._tr_tally(oe,oe.strstart-oe.match_start,oe.match_length-V),oe.lookahead-=oe.match_length,oe.match_length<=oe.max_lazy_match&&oe.lookahead>=V){for(oe.match_length--;oe.strstart++,oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart,--oe.match_length!=0;);oe.strstart++}else oe.strstart+=oe.match_length,oe.match_length=0,oe.ins_h=oe.window[oe.strstart],oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+1])&oe.hash_mask;else ze=o._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++;if(ze&&(ne(oe,!1),oe.strm.avail_out===0))return U}return oe.insert=oe.strstart<V-1?oe.strstart:V-1,Ue===h?(ne(oe,!0),oe.strm.avail_out===0?W:q):oe.last_lit&&(ne(oe,!1),oe.strm.avail_out===0)?U:Q}function Ne(oe,Ue){for(var Ge,ze,Be;;){if(oe.lookahead<J){if(Me(oe),oe.lookahead<J&&Ue===f)return U;if(oe.lookahead===0)break}if(Ge=0,oe.lookahead>=V&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),oe.prev_length=oe.match_length,oe.prev_match=oe.match_start,oe.match_length=V-1,Ge!==0&&oe.prev_length<oe.max_lazy_match&&oe.strstart-Ge<=oe.w_size-J&&(oe.match_length=de(oe,Ge),oe.match_length<=5&&(oe.strategy===1||oe.match_length===V&&4096<oe.strstart-oe.match_start)&&(oe.match_length=V-1)),oe.prev_length>=V&&oe.match_length<=oe.prev_length){for(Be=oe.strstart+oe.lookahead-V,ze=o._tr_tally(oe,oe.strstart-1-oe.prev_match,oe.prev_length-V),oe.lookahead-=oe.prev_length-1,oe.prev_length-=2;++oe.strstart<=Be&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),--oe.prev_length!=0;);if(oe.match_available=0,oe.match_length=V-1,oe.strstart++,ze&&(ne(oe,!1),oe.strm.avail_out===0))return U}else if(oe.match_available){if((ze=o._tr_tally(oe,0,oe.window[oe.strstart-1]))&&ne(oe,!1),oe.strstart++,oe.lookahead--,oe.strm.avail_out===0)return U}else oe.match_available=1,oe.strstart++,oe.lookahead--}return oe.match_available&&(ze=o._tr_tally(oe,0,oe.window[oe.strstart-1]),oe.match_available=0),oe.insert=oe.strstart<V-1?oe.strstart:V-1,Ue===h?(ne(oe,!0),oe.strm.avail_out===0?W:q):oe.last_lit&&(ne(oe,!1),oe.strm.avail_out===0)?U:Q}function Ae(oe,Ue,Ge,ze,Be){this.good_length=oe,this.max_lazy=Ue,this.nice_length=Ge,this.max_chain=ze,this.func=Be}function Xe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*I),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(D+1),this.heap=new a.Buf16(2*M+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*M+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(oe){var Ue;return oe&&oe.state?(oe.total_in=oe.total_out=0,oe.data_type=v,(Ue=oe.state).pending=0,Ue.pending_out=0,Ue.wrap<0&&(Ue.wrap=-Ue.wrap),Ue.status=Ue.wrap?B:$,oe.adler=Ue.wrap===2?0:1,Ue.last_flush=f,o._tr_init(Ue),g):Y(oe,p)}function at(oe){var Ue=$e(oe);return Ue===g&&(function(Ge){Ge.window_size=2*Ge.w_size,Z(Ge.head),Ge.max_lazy_match=s[Ge.level].max_lazy,Ge.good_match=s[Ge.level].good_length,Ge.nice_match=s[Ge.level].nice_length,Ge.max_chain_length=s[Ge.level].max_chain,Ge.strstart=0,Ge.block_start=0,Ge.lookahead=0,Ge.insert=0,Ge.match_length=Ge.prev_length=V-1,Ge.match_available=0,Ge.ins_h=0})(oe.state),Ue}function pt(oe,Ue,Ge,ze,Be,me){if(!oe)return p;var Se=1;if(Ue===_&&(Ue=6),ze<0?(Se=0,ze=-ze):15<ze&&(Se=2,ze-=16),Be<1||E<Be||Ge!==x||ze<8||15<ze||Ue<0||9<Ue||me<0||y<me)return Y(oe,p);ze===8&&(ze=9);var ke=new Xe;return(oe.state=ke).strm=oe,ke.wrap=Se,ke.gzhead=null,ke.w_bits=ze,ke.w_size=1<<ke.w_bits,ke.w_mask=ke.w_size-1,ke.hash_bits=Be+7,ke.hash_size=1<<ke.hash_bits,ke.hash_mask=ke.hash_size-1,ke.hash_shift=~~((ke.hash_bits+V-1)/V),ke.window=new a.Buf8(2*ke.w_size),ke.head=new a.Buf16(ke.hash_size),ke.prev=new a.Buf16(ke.w_size),ke.lit_bufsize=1<<Be+6,ke.pending_buf_size=4*ke.lit_bufsize,ke.pending_buf=new a.Buf8(ke.pending_buf_size),ke.d_buf=1*ke.lit_bufsize,ke.l_buf=3*ke.lit_bufsize,ke.level=Ue,ke.strategy=me,ke.method=Ge,at(oe)}s=[new Ae(0,0,0,0,function(oe,Ue){var Ge=65535;for(Ge>oe.pending_buf_size-5&&(Ge=oe.pending_buf_size-5);;){if(oe.lookahead<=1){if(Me(oe),oe.lookahead===0&&Ue===f)return U;if(oe.lookahead===0)break}oe.strstart+=oe.lookahead,oe.lookahead=0;var ze=oe.block_start+Ge;if((oe.strstart===0||oe.strstart>=ze)&&(oe.lookahead=oe.strstart-ze,oe.strstart=ze,ne(oe,!1),oe.strm.avail_out===0)||oe.strstart-oe.block_start>=oe.w_size-J&&(ne(oe,!1),oe.strm.avail_out===0))return U}return oe.insert=0,Ue===h?(ne(oe,!0),oe.strm.avail_out===0?W:q):(oe.strstart>oe.block_start&&(ne(oe,!1),oe.strm.avail_out),U)}),new Ae(4,4,8,4,qe),new Ae(4,5,16,8,qe),new Ae(4,6,32,32,qe),new Ae(4,4,16,16,Ne),new Ae(8,16,32,32,Ne),new Ae(8,16,128,128,Ne),new Ae(8,32,128,256,Ne),new Ae(32,128,258,1024,Ne),new Ae(32,258,258,4096,Ne)],i.deflateInit=function(oe,Ue){return pt(oe,Ue,x,15,8,0)},i.deflateInit2=pt,i.deflateReset=at,i.deflateResetKeep=$e,i.deflateSetHeader=function(oe,Ue){return oe&&oe.state?oe.state.wrap!==2?p:(oe.state.gzhead=Ue,g):p},i.deflate=function(oe,Ue){var Ge,ze,Be,me;if(!oe||!oe.state||5<Ue||Ue<0)return oe?Y(oe,p):p;if(ze=oe.state,!oe.output||!oe.input&&oe.avail_in!==0||ze.status===666&&Ue!==h)return Y(oe,oe.avail_out===0?-5:p);if(ze.strm=oe,Ge=ze.last_flush,ze.last_flush=Ue,ze.status===B)if(ze.wrap===2)oe.adler=0,le(ze,31),le(ze,139),le(ze,8),ze.gzhead?(le(ze,(ze.gzhead.text?1:0)+(ze.gzhead.hcrc?2:0)+(ze.gzhead.extra?4:0)+(ze.gzhead.name?8:0)+(ze.gzhead.comment?16:0)),le(ze,255&ze.gzhead.time),le(ze,ze.gzhead.time>>8&255),le(ze,ze.gzhead.time>>16&255),le(ze,ze.gzhead.time>>24&255),le(ze,ze.level===9?2:2<=ze.strategy||ze.level<2?4:0),le(ze,255&ze.gzhead.os),ze.gzhead.extra&&ze.gzhead.extra.length&&(le(ze,255&ze.gzhead.extra.length),le(ze,ze.gzhead.extra.length>>8&255)),ze.gzhead.hcrc&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending,0)),ze.gzindex=0,ze.status=69):(le(ze,0),le(ze,0),le(ze,0),le(ze,0),le(ze,0),le(ze,ze.level===9?2:2<=ze.strategy||ze.level<2?4:0),le(ze,3),ze.status=$);else{var Se=x+(ze.w_bits-8<<4)<<8;Se|=(2<=ze.strategy||ze.level<2?0:ze.level<6?1:ze.level===6?2:3)<<6,ze.strstart!==0&&(Se|=32),Se+=31-Se%31,ze.status=$,ce(ze,Se),ze.strstart!==0&&(ce(ze,oe.adler>>>16),ce(ze,65535&oe.adler)),oe.adler=1}if(ze.status===69)if(ze.gzhead.extra){for(Be=ze.pending;ze.gzindex<(65535&ze.gzhead.extra.length)&&(ze.pending!==ze.pending_buf_size||(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending!==ze.pending_buf_size));)le(ze,255&ze.gzhead.extra[ze.gzindex]),ze.gzindex++;ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),ze.gzindex===ze.gzhead.extra.length&&(ze.gzindex=0,ze.status=73)}else ze.status=73;if(ze.status===73)if(ze.gzhead.name){Be=ze.pending;do{if(ze.pending===ze.pending_buf_size&&(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending===ze.pending_buf_size)){me=1;break}me=ze.gzindex<ze.gzhead.name.length?255&ze.gzhead.name.charCodeAt(ze.gzindex++):0,le(ze,me)}while(me!==0);ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),me===0&&(ze.gzindex=0,ze.status=91)}else ze.status=91;if(ze.status===91)if(ze.gzhead.comment){Be=ze.pending;do{if(ze.pending===ze.pending_buf_size&&(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending===ze.pending_buf_size)){me=1;break}me=ze.gzindex<ze.gzhead.comment.length?255&ze.gzhead.comment.charCodeAt(ze.gzindex++):0,le(ze,me)}while(me!==0);ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),me===0&&(ze.status=103)}else ze.status=103;if(ze.status===103&&(ze.gzhead.hcrc?(ze.pending+2>ze.pending_buf_size&&K(oe),ze.pending+2<=ze.pending_buf_size&&(le(ze,255&oe.adler),le(ze,oe.adler>>8&255),oe.adler=0,ze.status=$)):ze.status=$),ze.pending!==0){if(K(oe),oe.avail_out===0)return ze.last_flush=-1,g}else if(oe.avail_in===0&&ae(Ue)<=ae(Ge)&&Ue!==h)return Y(oe,-5);if(ze.status===666&&oe.avail_in!==0)return Y(oe,-5);if(oe.avail_in!==0||ze.lookahead!==0||Ue!==f&&ze.status!==666){var ke=ze.strategy===2?(function(be,Ke){for(var ot;;){if(be.lookahead===0&&(Me(be),be.lookahead===0)){if(Ke===f)return U;break}if(be.match_length=0,ot=o._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++,ot&&(ne(be,!1),be.strm.avail_out===0))return U}return be.insert=0,Ke===h?(ne(be,!0),be.strm.avail_out===0?W:q):be.last_lit&&(ne(be,!1),be.strm.avail_out===0)?U:Q})(ze,Ue):ze.strategy===3?(function(be,Ke){for(var ot,lt,ct,Vt,Ot=be.window;;){if(be.lookahead<=G){if(Me(be),be.lookahead<=G&&Ke===f)return U;if(be.lookahead===0)break}if(be.match_length=0,be.lookahead>=V&&0<be.strstart&&(lt=Ot[ct=be.strstart-1])===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]){Vt=be.strstart+G;do;while(lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&lt===Ot[++ct]&&ct<Vt);be.match_length=G-(Vt-ct),be.match_length>be.lookahead&&(be.match_length=be.lookahead)}if(be.match_length>=V?(ot=o._tr_tally(be,1,be.match_length-V),be.lookahead-=be.match_length,be.strstart+=be.match_length,be.match_length=0):(ot=o._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++),ot&&(ne(be,!1),be.strm.avail_out===0))return U}return be.insert=0,Ke===h?(ne(be,!0),be.strm.avail_out===0?W:q):be.last_lit&&(ne(be,!1),be.strm.avail_out===0)?U:Q})(ze,Ue):s[ze.level].func(ze,Ue);if(ke!==W&&ke!==q||(ze.status=666),ke===U||ke===W)return oe.avail_out===0&&(ze.last_flush=-1),g;if(ke===Q&&(Ue===1?o._tr_align(ze):Ue!==5&&(o._tr_stored_block(ze,0,0,!1),Ue===3&&(Z(ze.head),ze.lookahead===0&&(ze.strstart=0,ze.block_start=0,ze.insert=0))),K(oe),oe.avail_out===0))return ze.last_flush=-1,g}return Ue!==h?g:ze.wrap<=0?1:(ze.wrap===2?(le(ze,255&oe.adler),le(ze,oe.adler>>8&255),le(ze,oe.adler>>16&255),le(ze,oe.adler>>24&255),le(ze,255&oe.total_in),le(ze,oe.total_in>>8&255),le(ze,oe.total_in>>16&255),le(ze,oe.total_in>>24&255)):(ce(ze,oe.adler>>>16),ce(ze,65535&oe.adler)),K(oe),0<ze.wrap&&(ze.wrap=-ze.wrap),ze.pending!==0?g:1)},i.deflateEnd=function(oe){var Ue;return oe&&oe.state?(Ue=oe.state.status)!==B&&Ue!==69&&Ue!==73&&Ue!==91&&Ue!==103&&Ue!==$&&Ue!==666?Y(oe,p):(oe.state=null,Ue===$?Y(oe,-3):g):p},i.deflateSetDictionary=function(oe,Ue){var Ge,ze,Be,me,Se,ke,be,Ke,ot=Ue.length;if(!oe||!oe.state||(me=(Ge=oe.state).wrap)===2||me===1&&Ge.status!==B||Ge.lookahead)return p;for(me===1&&(oe.adler=l(oe.adler,Ue,ot,0)),Ge.wrap=0,ot>=Ge.w_size&&(me===0&&(Z(Ge.head),Ge.strstart=0,Ge.block_start=0,Ge.insert=0),Ke=new a.Buf8(Ge.w_size),a.arraySet(Ke,Ue,ot-Ge.w_size,Ge.w_size,0),Ue=Ke,ot=Ge.w_size),Se=oe.avail_in,ke=oe.next_in,be=oe.input,oe.avail_in=ot,oe.next_in=0,oe.input=Ue,Me(Ge);Ge.lookahead>=V;){for(ze=Ge.strstart,Be=Ge.lookahead-(V-1);Ge.ins_h=(Ge.ins_h<<Ge.hash_shift^Ge.window[ze+V-1])&Ge.hash_mask,Ge.prev[ze&Ge.w_mask]=Ge.head[Ge.ins_h],Ge.head[Ge.ins_h]=ze,ze++,--Be;);Ge.strstart=ze,Ge.lookahead=V-1,Me(Ge)}return Ge.strstart+=Ge.lookahead,Ge.block_start=Ge.strstart,Ge.insert=Ge.lookahead,Ge.lookahead=0,Ge.match_length=Ge.prev_length=V-1,Ge.match_available=0,oe.next_in=ke,oe.input=be,oe.avail_in=Se,Ge.wrap=me,g},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,r,i){r.exports=function(s,a){var o,l,c,u,f,h,g,p,_,y,v,x,E,M,k,N,I,D,V,G,J,B,$,U,Q;o=s.state,l=s.next_in,U=s.input,c=l+(s.avail_in-5),u=s.next_out,Q=s.output,f=u-(a-s.avail_out),h=u+(s.avail_out-257),g=o.dmax,p=o.wsize,_=o.whave,y=o.wnext,v=o.window,x=o.hold,E=o.bits,M=o.lencode,k=o.distcode,N=(1<<o.lenbits)-1,I=(1<<o.distbits)-1;e:do{E<15&&(x+=U[l++]<<E,E+=8,x+=U[l++]<<E,E+=8),D=M[x&N];t:for(;;){if(x>>>=V=D>>>24,E-=V,(V=D>>>16&255)===0)Q[u++]=65535&D;else{if(!(16&V)){if((64&V)==0){D=M[(65535&D)+(x&(1<<V)-1)];continue t}if(32&V){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}G=65535&D,(V&=15)&&(E<V&&(x+=U[l++]<<E,E+=8),G+=x&(1<<V)-1,x>>>=V,E-=V),E<15&&(x+=U[l++]<<E,E+=8,x+=U[l++]<<E,E+=8),D=k[x&I];n:for(;;){if(x>>>=V=D>>>24,E-=V,!(16&(V=D>>>16&255))){if((64&V)==0){D=k[(65535&D)+(x&(1<<V)-1)];continue n}s.msg="invalid distance code",o.mode=30;break e}if(J=65535&D,E<(V&=15)&&(x+=U[l++]<<E,(E+=8)<V&&(x+=U[l++]<<E,E+=8)),g<(J+=x&(1<<V)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(x>>>=V,E-=V,(V=u-f)<J){if(_<(V=J-V)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if($=v,(B=0)===y){if(B+=p-V,V<G){for(G-=V;Q[u++]=v[B++],--V;);B=u-J,$=Q}}else if(y<V){if(B+=p+y-V,(V-=y)<G){for(G-=V;Q[u++]=v[B++],--V;);if(B=0,y<G){for(G-=V=y;Q[u++]=v[B++],--V;);B=u-J,$=Q}}}else if(B+=y-V,V<G){for(G-=V;Q[u++]=v[B++],--V;);B=u-J,$=Q}for(;2<G;)Q[u++]=$[B++],Q[u++]=$[B++],Q[u++]=$[B++],G-=3;G&&(Q[u++]=$[B++],1<G&&(Q[u++]=$[B++]))}else{for(B=u-J;Q[u++]=Q[B++],Q[u++]=Q[B++],Q[u++]=Q[B++],2<(G-=3););G&&(Q[u++]=Q[B++],1<G&&(Q[u++]=Q[B++]))}break}}break}}while(l<c&&u<h);l-=G=E>>3,x&=(1<<(E-=G<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<h?h-u+257:257-(u-h),o.hold=x,o.bits=E}},{}],49:[function(t,r,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),u=1,f=2,h=0,g=-2,p=1,_=852,y=592;function v(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(B){var $;return B&&B.state?($=B.state,B.total_in=B.total_out=$.total=0,B.msg="",$.wrap&&(B.adler=1&$.wrap),$.mode=p,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new s.Buf32(_),$.distcode=$.distdyn=new s.Buf32(y),$.sane=1,$.back=-1,h):g}function M(B){var $;return B&&B.state?(($=B.state).wsize=0,$.whave=0,$.wnext=0,E(B)):g}function k(B,$){var U,Q;return B&&B.state?(Q=B.state,$<0?(U=0,$=-$):(U=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?g:(Q.window!==null&&Q.wbits!==$&&(Q.window=null),Q.wrap=U,Q.wbits=$,M(B))):g}function N(B,$){var U,Q;return B?(Q=new x,(B.state=Q).window=null,(U=k(B,$))!==h&&(B.state=null),U):g}var I,D,V=!0;function G(B){if(V){var $;for(I=new s.Buf32(512),D=new s.Buf32(32),$=0;$<144;)B.lens[$++]=8;for(;$<256;)B.lens[$++]=9;for(;$<280;)B.lens[$++]=7;for(;$<288;)B.lens[$++]=8;for(c(u,B.lens,0,288,I,0,B.work,{bits:9}),$=0;$<32;)B.lens[$++]=5;c(f,B.lens,0,32,D,0,B.work,{bits:5}),V=!1}B.lencode=I,B.lenbits=9,B.distcode=D,B.distbits=5}function J(B,$,U,Q){var W,q=B.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new s.Buf8(q.wsize)),Q>=q.wsize?(s.arraySet(q.window,$,U-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(Q<(W=q.wsize-q.wnext)&&(W=Q),s.arraySet(q.window,$,U-Q,W,q.wnext),(Q-=W)?(s.arraySet(q.window,$,U-Q,Q,0),q.wnext=Q,q.whave=q.wsize):(q.wnext+=W,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=W))),0}i.inflateReset=M,i.inflateReset2=k,i.inflateResetKeep=E,i.inflateInit=function(B){return N(B,15)},i.inflateInit2=N,i.inflate=function(B,$){var U,Q,W,q,Y,ae,Z,K,ne,le,ce,de,Me,qe,Ne,Ae,Xe,$e,at,pt,oe,Ue,Ge,ze,Be=0,me=new s.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return g;(U=B.state).mode===12&&(U.mode=13),Y=B.next_out,W=B.output,Z=B.avail_out,q=B.next_in,Q=B.input,ae=B.avail_in,K=U.hold,ne=U.bits,le=ae,ce=Z,Ue=h;e:for(;;)switch(U.mode){case p:if(U.wrap===0){U.mode=13;break}for(;ne<16;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(2&U.wrap&&K===35615){me[U.check=0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0),ne=K=0,U.mode=2;break}if(U.flags=0,U.head&&(U.head.done=!1),!(1&U.wrap)||(((255&K)<<8)+(K>>8))%31){B.msg="incorrect header check",U.mode=30;break}if((15&K)!=8){B.msg="unknown compression method",U.mode=30;break}if(ne-=4,oe=8+(15&(K>>>=4)),U.wbits===0)U.wbits=oe;else if(oe>U.wbits){B.msg="invalid window size",U.mode=30;break}U.dmax=1<<oe,B.adler=U.check=1,U.mode=512&K?10:12,ne=K=0;break;case 2:for(;ne<16;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(U.flags=K,(255&U.flags)!=8){B.msg="unknown compression method",U.mode=30;break}if(57344&U.flags){B.msg="unknown header flags set",U.mode=30;break}U.head&&(U.head.text=K>>8&1),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0,U.mode=3;case 3:for(;ne<32;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.head&&(U.head.time=K),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,me[2]=K>>>16&255,me[3]=K>>>24&255,U.check=o(U.check,me,4,0)),ne=K=0,U.mode=4;case 4:for(;ne<16;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.head&&(U.head.xflags=255&K,U.head.os=K>>8),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0,U.mode=5;case 5:if(1024&U.flags){for(;ne<16;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.length=K,U.head&&(U.head.extra_len=K),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0}else U.head&&(U.head.extra=null);U.mode=6;case 6:if(1024&U.flags&&(ae<(de=U.length)&&(de=ae),de&&(U.head&&(oe=U.head.extra_len-U.length,U.head.extra||(U.head.extra=new Array(U.head.extra_len)),s.arraySet(U.head.extra,Q,q,de,oe)),512&U.flags&&(U.check=o(U.check,Q,de,q)),ae-=de,q+=de,U.length-=de),U.length))break e;U.length=0,U.mode=7;case 7:if(2048&U.flags){if(ae===0)break e;for(de=0;oe=Q[q+de++],U.head&&oe&&U.length<65536&&(U.head.name+=String.fromCharCode(oe)),oe&&de<ae;);if(512&U.flags&&(U.check=o(U.check,Q,de,q)),ae-=de,q+=de,oe)break e}else U.head&&(U.head.name=null);U.length=0,U.mode=8;case 8:if(4096&U.flags){if(ae===0)break e;for(de=0;oe=Q[q+de++],U.head&&oe&&U.length<65536&&(U.head.comment+=String.fromCharCode(oe)),oe&&de<ae;);if(512&U.flags&&(U.check=o(U.check,Q,de,q)),ae-=de,q+=de,oe)break e}else U.head&&(U.head.comment=null);U.mode=9;case 9:if(512&U.flags){for(;ne<16;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(K!==(65535&U.check)){B.msg="header crc mismatch",U.mode=30;break}ne=K=0}U.head&&(U.head.hcrc=U.flags>>9&1,U.head.done=!0),B.adler=U.check=0,U.mode=12;break;case 10:for(;ne<32;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}B.adler=U.check=v(K),ne=K=0,U.mode=11;case 11:if(U.havedict===0)return B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,2;B.adler=U.check=1,U.mode=12;case 12:if($===5||$===6)break e;case 13:if(U.last){K>>>=7&ne,ne-=7&ne,U.mode=27;break}for(;ne<3;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}switch(U.last=1&K,ne-=1,3&(K>>>=1)){case 0:U.mode=14;break;case 1:if(G(U),U.mode=20,$!==6)break;K>>>=2,ne-=2;break e;case 2:U.mode=17;break;case 3:B.msg="invalid block type",U.mode=30}K>>>=2,ne-=2;break;case 14:for(K>>>=7&ne,ne-=7&ne;ne<32;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if((65535&K)!=(K>>>16^65535)){B.msg="invalid stored block lengths",U.mode=30;break}if(U.length=65535&K,ne=K=0,U.mode=15,$===6)break e;case 15:U.mode=16;case 16:if(de=U.length){if(ae<de&&(de=ae),Z<de&&(de=Z),de===0)break e;s.arraySet(W,Q,q,de,Y),ae-=de,q+=de,Z-=de,Y+=de,U.length-=de;break}U.mode=12;break;case 17:for(;ne<14;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(U.nlen=257+(31&K),K>>>=5,ne-=5,U.ndist=1+(31&K),K>>>=5,ne-=5,U.ncode=4+(15&K),K>>>=4,ne-=4,286<U.nlen||30<U.ndist){B.msg="too many length or distance symbols",U.mode=30;break}U.have=0,U.mode=18;case 18:for(;U.have<U.ncode;){for(;ne<3;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.lens[Se[U.have++]]=7&K,K>>>=3,ne-=3}for(;U.have<19;)U.lens[Se[U.have++]]=0;if(U.lencode=U.lendyn,U.lenbits=7,Ge={bits:U.lenbits},Ue=c(0,U.lens,0,19,U.lencode,0,U.work,Ge),U.lenbits=Ge.bits,Ue){B.msg="invalid code lengths set",U.mode=30;break}U.have=0,U.mode=19;case 19:for(;U.have<U.nlen+U.ndist;){for(;Ae=(Be=U.lencode[K&(1<<U.lenbits)-1])>>>16&255,Xe=65535&Be,!((Ne=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(Xe<16)K>>>=Ne,ne-=Ne,U.lens[U.have++]=Xe;else{if(Xe===16){for(ze=Ne+2;ne<ze;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(K>>>=Ne,ne-=Ne,U.have===0){B.msg="invalid bit length repeat",U.mode=30;break}oe=U.lens[U.have-1],de=3+(3&K),K>>>=2,ne-=2}else if(Xe===17){for(ze=Ne+3;ne<ze;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}ne-=Ne,oe=0,de=3+(7&(K>>>=Ne)),K>>>=3,ne-=3}else{for(ze=Ne+7;ne<ze;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}ne-=Ne,oe=0,de=11+(127&(K>>>=Ne)),K>>>=7,ne-=7}if(U.have+de>U.nlen+U.ndist){B.msg="invalid bit length repeat",U.mode=30;break}for(;de--;)U.lens[U.have++]=oe}}if(U.mode===30)break;if(U.lens[256]===0){B.msg="invalid code -- missing end-of-block",U.mode=30;break}if(U.lenbits=9,Ge={bits:U.lenbits},Ue=c(u,U.lens,0,U.nlen,U.lencode,0,U.work,Ge),U.lenbits=Ge.bits,Ue){B.msg="invalid literal/lengths set",U.mode=30;break}if(U.distbits=6,U.distcode=U.distdyn,Ge={bits:U.distbits},Ue=c(f,U.lens,U.nlen,U.ndist,U.distcode,0,U.work,Ge),U.distbits=Ge.bits,Ue){B.msg="invalid distances set",U.mode=30;break}if(U.mode=20,$===6)break e;case 20:U.mode=21;case 21:if(6<=ae&&258<=Z){B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,l(B,ce),Y=B.next_out,W=B.output,Z=B.avail_out,q=B.next_in,Q=B.input,ae=B.avail_in,K=U.hold,ne=U.bits,U.mode===12&&(U.back=-1);break}for(U.back=0;Ae=(Be=U.lencode[K&(1<<U.lenbits)-1])>>>16&255,Xe=65535&Be,!((Ne=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(Ae&&(240&Ae)==0){for($e=Ne,at=Ae,pt=Xe;Ae=(Be=U.lencode[pt+((K&(1<<$e+at)-1)>>$e)])>>>16&255,Xe=65535&Be,!($e+(Ne=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}K>>>=$e,ne-=$e,U.back+=$e}if(K>>>=Ne,ne-=Ne,U.back+=Ne,U.length=Xe,Ae===0){U.mode=26;break}if(32&Ae){U.back=-1,U.mode=12;break}if(64&Ae){B.msg="invalid literal/length code",U.mode=30;break}U.extra=15&Ae,U.mode=22;case 22:if(U.extra){for(ze=U.extra;ne<ze;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.length+=K&(1<<U.extra)-1,K>>>=U.extra,ne-=U.extra,U.back+=U.extra}U.was=U.length,U.mode=23;case 23:for(;Ae=(Be=U.distcode[K&(1<<U.distbits)-1])>>>16&255,Xe=65535&Be,!((Ne=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if((240&Ae)==0){for($e=Ne,at=Ae,pt=Xe;Ae=(Be=U.distcode[pt+((K&(1<<$e+at)-1)>>$e)])>>>16&255,Xe=65535&Be,!($e+(Ne=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}K>>>=$e,ne-=$e,U.back+=$e}if(K>>>=Ne,ne-=Ne,U.back+=Ne,64&Ae){B.msg="invalid distance code",U.mode=30;break}U.offset=Xe,U.extra=15&Ae,U.mode=24;case 24:if(U.extra){for(ze=U.extra;ne<ze;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}U.offset+=K&(1<<U.extra)-1,K>>>=U.extra,ne-=U.extra,U.back+=U.extra}if(U.offset>U.dmax){B.msg="invalid distance too far back",U.mode=30;break}U.mode=25;case 25:if(Z===0)break e;if(de=ce-Z,U.offset>de){if((de=U.offset-de)>U.whave&&U.sane){B.msg="invalid distance too far back",U.mode=30;break}Me=de>U.wnext?(de-=U.wnext,U.wsize-de):U.wnext-de,de>U.length&&(de=U.length),qe=U.window}else qe=W,Me=Y-U.offset,de=U.length;for(Z<de&&(de=Z),Z-=de,U.length-=de;W[Y++]=qe[Me++],--de;);U.length===0&&(U.mode=21);break;case 26:if(Z===0)break e;W[Y++]=U.length,Z--,U.mode=21;break;case 27:if(U.wrap){for(;ne<32;){if(ae===0)break e;ae--,K|=Q[q++]<<ne,ne+=8}if(ce-=Z,B.total_out+=ce,U.total+=ce,ce&&(B.adler=U.check=U.flags?o(U.check,W,ce,Y-ce):a(U.check,W,ce,Y-ce)),ce=Z,(U.flags?K:v(K))!==U.check){B.msg="incorrect data check",U.mode=30;break}ne=K=0}U.mode=28;case 28:if(U.wrap&&U.flags){for(;ne<32;){if(ae===0)break e;ae--,K+=Q[q++]<<ne,ne+=8}if(K!==(4294967295&U.total)){B.msg="incorrect length check",U.mode=30;break}ne=K=0}U.mode=29;case 29:Ue=1;break e;case 30:Ue=-3;break e;case 31:return-4;case 32:default:return g}return B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,(U.wsize||ce!==B.avail_out&&U.mode<30&&(U.mode<27||$!==4))&&J(B,B.output,B.next_out,ce-B.avail_out)?(U.mode=31,-4):(le-=B.avail_in,ce-=B.avail_out,B.total_in+=le,B.total_out+=ce,U.total+=ce,U.wrap&&ce&&(B.adler=U.check=U.flags?o(U.check,W,ce,B.next_out-ce):a(U.check,W,ce,B.next_out-ce)),B.data_type=U.bits+(U.last?64:0)+(U.mode===12?128:0)+(U.mode===20||U.mode===15?256:0),(le==0&&ce===0||$===4)&&Ue===h&&(Ue=-5),Ue)},i.inflateEnd=function(B){if(!B||!B.state)return g;var $=B.state;return $.window&&($.window=null),B.state=null,h},i.inflateGetHeader=function(B,$){var U;return B&&B.state?(2&(U=B.state).wrap)==0?g:((U.head=$).done=!1,h):g},i.inflateSetDictionary=function(B,$){var U,Q=$.length;return B&&B.state?(U=B.state).wrap!==0&&U.mode!==11?g:U.mode===11&&a(1,$,Q,0)!==U.check?-3:J(B,$,Q,Q)?(U.mode=31,-4):(U.havedict=1,h):g},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,h,g,p,_,y,v){var x,E,M,k,N,I,D,V,G,J=v.bits,B=0,$=0,U=0,Q=0,W=0,q=0,Y=0,ae=0,Z=0,K=0,ne=null,le=0,ce=new s.Buf16(16),de=new s.Buf16(16),Me=null,qe=0;for(B=0;B<=15;B++)ce[B]=0;for($=0;$<g;$++)ce[f[h+$]]++;for(W=J,Q=15;1<=Q&&ce[Q]===0;Q--);if(Q<W&&(W=Q),Q===0)return p[_++]=20971520,p[_++]=20971520,v.bits=1,0;for(U=1;U<Q&&ce[U]===0;U++);for(W<U&&(W=U),B=ae=1;B<=15;B++)if(ae<<=1,(ae-=ce[B])<0)return-1;if(0<ae&&(u===0||Q!==1))return-1;for(de[1]=0,B=1;B<15;B++)de[B+1]=de[B]+ce[B];for($=0;$<g;$++)f[h+$]!==0&&(y[de[f[h+$]]++]=$);if(I=u===0?(ne=Me=y,19):u===1?(ne=a,le-=257,Me=o,qe-=257,256):(ne=l,Me=c,-1),B=U,N=_,Y=$=K=0,M=-1,k=(Z=1<<(q=W))-1,u===1&&852<Z||u===2&&592<Z)return 1;for(;;){for(D=B-Y,G=y[$]<I?(V=0,y[$]):y[$]>I?(V=Me[qe+y[$]],ne[le+y[$]]):(V=96,0),x=1<<B-Y,U=E=1<<q;p[N+(K>>Y)+(E-=x)]=D<<24|V<<16|G|0,E!==0;);for(x=1<<B-1;K&x;)x>>=1;if(x!==0?(K&=x-1,K+=x):K=0,$++,--ce[B]==0){if(B===Q)break;B=f[h+y[$]]}if(W<B&&(K&k)!==M){for(Y===0&&(Y=W),N+=U,ae=1<<(q=B-Y);q+Y<Q&&!((ae-=ce[q+Y])<=0);)q++,ae<<=1;if(Z+=1<<q,u===1&&852<Z||u===2&&592<Z)return 1;p[M=K&k]=W<<24|q<<16|N-_|0}}return K!==0&&(p[N+K]=B-Y<<24|64<<16|0),v.bits=W,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var s=t("../utils/common"),a=0,o=1;function l(Be){for(var me=Be.length;0<=--me;)Be[me]=0}var c=0,u=29,f=256,h=f+1+u,g=30,p=19,_=2*h+1,y=15,v=16,x=7,E=256,M=16,k=17,N=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=new Array(2*(h+2));l(J);var B=new Array(2*g);l(B);var $=new Array(512);l($);var U=new Array(256);l(U);var Q=new Array(u);l(Q);var W,q,Y,ae=new Array(g);function Z(Be,me,Se,ke,be){this.static_tree=Be,this.extra_bits=me,this.extra_base=Se,this.elems=ke,this.max_length=be,this.has_stree=Be&&Be.length}function K(Be,me){this.dyn_tree=Be,this.max_code=0,this.stat_desc=me}function ne(Be){return Be<256?$[Be]:$[256+(Be>>>7)]}function le(Be,me){Be.pending_buf[Be.pending++]=255&me,Be.pending_buf[Be.pending++]=me>>>8&255}function ce(Be,me,Se){Be.bi_valid>v-Se?(Be.bi_buf|=me<<Be.bi_valid&65535,le(Be,Be.bi_buf),Be.bi_buf=me>>v-Be.bi_valid,Be.bi_valid+=Se-v):(Be.bi_buf|=me<<Be.bi_valid&65535,Be.bi_valid+=Se)}function de(Be,me,Se){ce(Be,Se[2*me],Se[2*me+1])}function Me(Be,me){for(var Se=0;Se|=1&Be,Be>>>=1,Se<<=1,0<--me;);return Se>>>1}function qe(Be,me,Se){var ke,be,Ke=new Array(y+1),ot=0;for(ke=1;ke<=y;ke++)Ke[ke]=ot=ot+Se[ke-1]<<1;for(be=0;be<=me;be++){var lt=Be[2*be+1];lt!==0&&(Be[2*be]=Me(Ke[lt]++,lt))}}function Ne(Be){var me;for(me=0;me<h;me++)Be.dyn_ltree[2*me]=0;for(me=0;me<g;me++)Be.dyn_dtree[2*me]=0;for(me=0;me<p;me++)Be.bl_tree[2*me]=0;Be.dyn_ltree[2*E]=1,Be.opt_len=Be.static_len=0,Be.last_lit=Be.matches=0}function Ae(Be){8<Be.bi_valid?le(Be,Be.bi_buf):0<Be.bi_valid&&(Be.pending_buf[Be.pending++]=Be.bi_buf),Be.bi_buf=0,Be.bi_valid=0}function Xe(Be,me,Se,ke){var be=2*me,Ke=2*Se;return Be[be]<Be[Ke]||Be[be]===Be[Ke]&&ke[me]<=ke[Se]}function $e(Be,me,Se){for(var ke=Be.heap[Se],be=Se<<1;be<=Be.heap_len&&(be<Be.heap_len&&Xe(me,Be.heap[be+1],Be.heap[be],Be.depth)&&be++,!Xe(me,ke,Be.heap[be],Be.depth));)Be.heap[Se]=Be.heap[be],Se=be,be<<=1;Be.heap[Se]=ke}function at(Be,me,Se){var ke,be,Ke,ot,lt=0;if(Be.last_lit!==0)for(;ke=Be.pending_buf[Be.d_buf+2*lt]<<8|Be.pending_buf[Be.d_buf+2*lt+1],be=Be.pending_buf[Be.l_buf+lt],lt++,ke===0?de(Be,be,me):(de(Be,(Ke=U[be])+f+1,me),(ot=I[Ke])!==0&&ce(Be,be-=Q[Ke],ot),de(Be,Ke=ne(--ke),Se),(ot=D[Ke])!==0&&ce(Be,ke-=ae[Ke],ot)),lt<Be.last_lit;);de(Be,E,me)}function pt(Be,me){var Se,ke,be,Ke=me.dyn_tree,ot=me.stat_desc.static_tree,lt=me.stat_desc.has_stree,ct=me.stat_desc.elems,Vt=-1;for(Be.heap_len=0,Be.heap_max=_,Se=0;Se<ct;Se++)Ke[2*Se]!==0?(Be.heap[++Be.heap_len]=Vt=Se,Be.depth[Se]=0):Ke[2*Se+1]=0;for(;Be.heap_len<2;)Ke[2*(be=Be.heap[++Be.heap_len]=Vt<2?++Vt:0)]=1,Be.depth[be]=0,Be.opt_len--,lt&&(Be.static_len-=ot[2*be+1]);for(me.max_code=Vt,Se=Be.heap_len>>1;1<=Se;Se--)$e(Be,Ke,Se);for(be=ct;Se=Be.heap[1],Be.heap[1]=Be.heap[Be.heap_len--],$e(Be,Ke,1),ke=Be.heap[1],Be.heap[--Be.heap_max]=Se,Be.heap[--Be.heap_max]=ke,Ke[2*be]=Ke[2*Se]+Ke[2*ke],Be.depth[be]=(Be.depth[Se]>=Be.depth[ke]?Be.depth[Se]:Be.depth[ke])+1,Ke[2*Se+1]=Ke[2*ke+1]=be,Be.heap[1]=be++,$e(Be,Ke,1),2<=Be.heap_len;);Be.heap[--Be.heap_max]=Be.heap[1],(function(Ot,Ut){var je,ge,se,_e,Ie,De,Oe=Ut.dyn_tree,we=Ut.max_code,st=Ut.stat_desc.static_tree,Ve=Ut.stat_desc.has_stree,tt=Ut.stat_desc.extra_bits,Ze=Ut.stat_desc.extra_base,nt=Ut.stat_desc.max_length,vt=0;for(_e=0;_e<=y;_e++)Ot.bl_count[_e]=0;for(Oe[2*Ot.heap[Ot.heap_max]+1]=0,je=Ot.heap_max+1;je<_;je++)nt<(_e=Oe[2*Oe[2*(ge=Ot.heap[je])+1]+1]+1)&&(_e=nt,vt++),Oe[2*ge+1]=_e,we<ge||(Ot.bl_count[_e]++,Ie=0,Ze<=ge&&(Ie=tt[ge-Ze]),De=Oe[2*ge],Ot.opt_len+=De*(_e+Ie),Ve&&(Ot.static_len+=De*(st[2*ge+1]+Ie)));if(vt!==0){do{for(_e=nt-1;Ot.bl_count[_e]===0;)_e--;Ot.bl_count[_e]--,Ot.bl_count[_e+1]+=2,Ot.bl_count[nt]--,vt-=2}while(0<vt);for(_e=nt;_e!==0;_e--)for(ge=Ot.bl_count[_e];ge!==0;)we<(se=Ot.heap[--je])||(Oe[2*se+1]!==_e&&(Ot.opt_len+=(_e-Oe[2*se+1])*Oe[2*se],Oe[2*se+1]=_e),ge--)}})(Be,me),qe(Ke,Vt,Be.bl_count)}function oe(Be,me,Se){var ke,be,Ke=-1,ot=me[1],lt=0,ct=7,Vt=4;for(ot===0&&(ct=138,Vt=3),me[2*(Se+1)+1]=65535,ke=0;ke<=Se;ke++)be=ot,ot=me[2*(ke+1)+1],++lt<ct&&be===ot||(lt<Vt?Be.bl_tree[2*be]+=lt:be!==0?(be!==Ke&&Be.bl_tree[2*be]++,Be.bl_tree[2*M]++):lt<=10?Be.bl_tree[2*k]++:Be.bl_tree[2*N]++,Ke=be,Vt=(lt=0)===ot?(ct=138,3):be===ot?(ct=6,3):(ct=7,4))}function Ue(Be,me,Se){var ke,be,Ke=-1,ot=me[1],lt=0,ct=7,Vt=4;for(ot===0&&(ct=138,Vt=3),ke=0;ke<=Se;ke++)if(be=ot,ot=me[2*(ke+1)+1],!(++lt<ct&&be===ot)){if(lt<Vt)for(;de(Be,be,Be.bl_tree),--lt!=0;);else be!==0?(be!==Ke&&(de(Be,be,Be.bl_tree),lt--),de(Be,M,Be.bl_tree),ce(Be,lt-3,2)):lt<=10?(de(Be,k,Be.bl_tree),ce(Be,lt-3,3)):(de(Be,N,Be.bl_tree),ce(Be,lt-11,7));Ke=be,Vt=(lt=0)===ot?(ct=138,3):be===ot?(ct=6,3):(ct=7,4)}}l(ae);var Ge=!1;function ze(Be,me,Se,ke){ce(Be,(c<<1)+(ke?1:0),3),(function(be,Ke,ot,lt){Ae(be),le(be,ot),le(be,~ot),s.arraySet(be.pending_buf,be.window,Ke,ot,be.pending),be.pending+=ot})(Be,me,Se)}i._tr_init=function(Be){Ge||((function(){var me,Se,ke,be,Ke,ot=new Array(y+1);for(be=ke=0;be<u-1;be++)for(Q[be]=ke,me=0;me<1<<I[be];me++)U[ke++]=be;for(U[ke-1]=be,be=Ke=0;be<16;be++)for(ae[be]=Ke,me=0;me<1<<D[be];me++)$[Ke++]=be;for(Ke>>=7;be<g;be++)for(ae[be]=Ke<<7,me=0;me<1<<D[be]-7;me++)$[256+Ke++]=be;for(Se=0;Se<=y;Se++)ot[Se]=0;for(me=0;me<=143;)J[2*me+1]=8,me++,ot[8]++;for(;me<=255;)J[2*me+1]=9,me++,ot[9]++;for(;me<=279;)J[2*me+1]=7,me++,ot[7]++;for(;me<=287;)J[2*me+1]=8,me++,ot[8]++;for(qe(J,h+1,ot),me=0;me<g;me++)B[2*me+1]=5,B[2*me]=Me(me,5);W=new Z(J,I,f+1,h,y),q=new Z(B,D,0,g,y),Y=new Z(new Array(0),V,0,p,x)})(),Ge=!0),Be.l_desc=new K(Be.dyn_ltree,W),Be.d_desc=new K(Be.dyn_dtree,q),Be.bl_desc=new K(Be.bl_tree,Y),Be.bi_buf=0,Be.bi_valid=0,Ne(Be)},i._tr_stored_block=ze,i._tr_flush_block=function(Be,me,Se,ke){var be,Ke,ot=0;0<Be.level?(Be.strm.data_type===2&&(Be.strm.data_type=(function(lt){var ct,Vt=4093624447;for(ct=0;ct<=31;ct++,Vt>>>=1)if(1&Vt&&lt.dyn_ltree[2*ct]!==0)return a;if(lt.dyn_ltree[18]!==0||lt.dyn_ltree[20]!==0||lt.dyn_ltree[26]!==0)return o;for(ct=32;ct<f;ct++)if(lt.dyn_ltree[2*ct]!==0)return o;return a})(Be)),pt(Be,Be.l_desc),pt(Be,Be.d_desc),ot=(function(lt){var ct;for(oe(lt,lt.dyn_ltree,lt.l_desc.max_code),oe(lt,lt.dyn_dtree,lt.d_desc.max_code),pt(lt,lt.bl_desc),ct=p-1;3<=ct&&lt.bl_tree[2*G[ct]+1]===0;ct--);return lt.opt_len+=3*(ct+1)+5+5+4,ct})(Be),be=Be.opt_len+3+7>>>3,(Ke=Be.static_len+3+7>>>3)<=be&&(be=Ke)):be=Ke=Se+5,Se+4<=be&&me!==-1?ze(Be,me,Se,ke):Be.strategy===4||Ke===be?(ce(Be,2+(ke?1:0),3),at(Be,J,B)):(ce(Be,4+(ke?1:0),3),(function(lt,ct,Vt,Ot){var Ut;for(ce(lt,ct-257,5),ce(lt,Vt-1,5),ce(lt,Ot-4,4),Ut=0;Ut<Ot;Ut++)ce(lt,lt.bl_tree[2*G[Ut]+1],3);Ue(lt,lt.dyn_ltree,ct-1),Ue(lt,lt.dyn_dtree,Vt-1)})(Be,Be.l_desc.max_code+1,Be.d_desc.max_code+1,ot+1),at(Be,Be.dyn_ltree,Be.dyn_dtree)),Ne(Be),ke&&Ae(Be)},i._tr_tally=function(Be,me,Se){return Be.pending_buf[Be.d_buf+2*Be.last_lit]=me>>>8&255,Be.pending_buf[Be.d_buf+2*Be.last_lit+1]=255&me,Be.pending_buf[Be.l_buf+Be.last_lit]=255&Se,Be.last_lit++,me===0?Be.dyn_ltree[2*Se]++:(Be.matches++,me--,Be.dyn_ltree[2*(U[Se]+f+1)]++,Be.dyn_dtree[2*ne(me)]++),Be.last_lit===Be.lit_bufsize-1},i._tr_align=function(Be){ce(Be,2,3),de(Be,E,J),(function(me){me.bi_valid===16?(le(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)})(Be)}},{"../utils/common":41}],53:[function(t,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,r,i){(function(s){(function(a,o){if(!a.setImmediate){var l,c,u,f,h=1,g={},p=!1,_=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,l={}.toString.call(a.process)==="[object process]"?function(M){Tl.nextTick(function(){x(M)})}:(function(){if(a.postMessage&&!a.importScripts){var M=!0,k=a.onmessage;return a.onmessage=function(){M=!1},a.postMessage("","*"),a.onmessage=k,M}})()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",E,!1):a.attachEvent("onmessage",E),function(M){a.postMessage(f+M,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(M){x(M.data)},function(M){u.port2.postMessage(M)}):_&&"onreadystatechange"in _.createElement("script")?(c=_.documentElement,function(M){var k=_.createElement("script");k.onreadystatechange=function(){x(M),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(M){setTimeout(x,0,M)},y.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var k=new Array(arguments.length-1),N=0;N<k.length;N++)k[N]=arguments[N+1];var I={callback:M,args:k};return g[h]=I,l(h),h++},y.clearImmediate=v}function v(M){delete g[M]}function x(M){if(p)setTimeout(x,0,M);else{var k=g[M];if(k){p=!0;try{(function(N){var I=N.callback,D=N.args;switch(D.length){case 0:I();break;case 1:I(D[0]);break;case 2:I(D[0],D[1]);break;case 3:I(D[0],D[1],D[2]);break;default:I.apply(o,D)}})(k)}finally{v(M),p=!1}}}}function E(M){M.source===a&&typeof M.data=="string"&&M.data.indexOf(f)===0&&x(+M.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof k0<"u"?k0:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(CB)),CB.exports}var QIe=JIe();const eNe=Bh(QIe);async function tNe(n,e){const t=new eNe;t.file("index.html",`<!doctype html>
      <html lang=en>
      <head>
      <meta charset=utf-8>
      <title>...adding bytes</title>
      </head>
      <body>
      <script>location = 'https://zed.cafe/#${e}';<\/script>
      </body>
    </html>`);const r=await t.generateAsync({type:"blob"});qIe.saveAs(r,`${n}.zip`)}function Ls(n,e,t){return n.namespaceURI&&n.namespaceURI!=="http://www.w3.org/1999/xhtml"||(e=Array.isArray(e)?e:[e],!e.includes(n.tagName.toLowerCase()))?!1:t?Object.entries(t).every(([r,i])=>n[r]===i):!0}function X0(n){var e;if(nNe(n)&&n.defaultView)return n.defaultView;if(!((e=n.ownerDocument)===null||e===void 0)&&e.defaultView)return n.ownerDocument.defaultView;throw new Error(`Could not determine window of node. Node was ${rNe(n)}`)}function nNe(n){return n.nodeType===9}function rNe(n){return typeof n=="function"?`function ${n.name}`:n===null?"null":String(n)}function Dce(n,e){return new Promise((t,r)=>{const i=new e;i.onerror=r,i.onabort=r,i.onload=()=>{t(String(i.result))},i.readAsText(n)})}function Kj(n,e){const t={...e,length:e.length,item:r=>t[r],[Symbol.iterator]:function*(){for(let i=0;i<t.length;i++)yield t[i]}};return t.constructor=n.FileList,n.FileList&&Object.setPrototypeOf(t,n.FileList.prototype),Object.freeze(t),t}function m1(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Lce{getAsFile(){return this.file}getAsString(e){typeof this.data=="string"&&e(this.data)}webkitGetAsEntry(){throw new Error("not implemented")}constructor(e,t){m1(this,"kind",void 0),m1(this,"type",void 0),m1(this,"file",null),m1(this,"data",void 0),typeof e=="string"?(this.kind="string",this.type=String(t),this.data=e):(this.kind="file",this.type=e.type,this.file=e)}}class iNe extends Array{add(...e){const t=new Lce(e[0],e[1]);return this.push(t),t}clear(){this.splice(0,this.length)}remove(e){this.splice(e,1)}}function WI(n,e){const[t,r]=n.split("/"),i=!r||r==="*";return s=>e?s.type===(i?t:n):i?s.type.startsWith(`${t}/`):s.type===t}function sNe(n){return new class{getData(t){var r;const i=(r=this.items.find(WI(t,!0)))!==null&&r!==void 0?r:this.items.find(WI(t,!1));let s="";return i?.getAsString(a=>{s=a}),s}setData(t,r){const i=this.items.findIndex(WI(t,!0)),s=new Lce(r,t);i>=0?this.items.splice(i,1,s):this.items.push(s)}clearData(t){if(t){const r=this.items.findIndex(WI(t,!0));r>=0&&this.items.remove(r)}else this.items.clear()}get types(){const t=[];return this.files.length&&t.push("Files"),this.items.forEach(r=>t.push(r.type)),Object.freeze(t),t}setDragImage(){}constructor(){m1(this,"dropEffect","none"),m1(this,"effectAllowed","uninitialized"),m1(this,"items",new iNe),m1(this,"files",Kj(n,[]))}}}function Zj(n,e=[]){const t=typeof n.DataTransfer>"u"?sNe(n):new n.DataTransfer;return Object.defineProperty(t,"files",{get:()=>Kj(n,e)}),t}async function aNe(n,e){return e.kind==="file"?e.getAsFile():new n.Blob([await new Promise(t=>e.getAsString(t))],{type:e.type})}function Uce(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bce(n,...e){const t=Object.fromEntries(e.map(r=>[typeof r=="string"?"text/plain":r.type,Promise.resolve(r)]));return typeof n.ClipboardItem<"u"?new n.ClipboardItem(t):new class{get types(){return Array.from(Object.keys(this.data))}async getType(i){const s=await this.data[i];if(!s)throw new Error(`${i} is not one of the available MIME types on this item.`);return s instanceof n.Blob?s:new n.Blob([s],{type:i})}constructor(i){Uce(this,"data",void 0),this.data=i}}(t)}const iw=Symbol("Manage ClipboardSub");function mX(n,e){return Object.assign(new class extends n.EventTarget{async read(){return Array.from(this.items)}async readText(){let r="";for(const i of this.items){const s=i.types.includes("text/plain")?"text/plain":i.types.find(a=>a.startsWith("text/"));s&&(r+=await i.getType(s).then(a=>Dce(a,n.FileReader)))}return r}async write(r){this.items=r}async writeText(r){this.items=[Bce(n,r)]}constructor(...r){super(...r),Uce(this,"items",[])}},{[iw]:e})}function Jj(n){return!!n?.[iw]}function oNe(n){if(Jj(n.navigator.clipboard))return n.navigator.clipboard[iw];const e=Object.getOwnPropertyDescriptor(n.navigator,"clipboard");let t;const r={resetClipboardStub:()=>{t=mX(n,r)},detachClipboardStub:()=>{e?Object.defineProperty(n.navigator,"clipboard",e):Object.defineProperty(n.navigator,"clipboard",{value:void 0,configurable:!0})}};return t=mX(n,r),Object.defineProperty(n.navigator,"clipboard",{get:()=>t,configurable:!0}),t[iw]}function lNe(n){Jj(n.navigator.clipboard)&&n.navigator.clipboard[iw].resetClipboardStub()}function cNe(n){Jj(n.navigator.clipboard)&&n.navigator.clipboard[iw].detachClipboardStub()}async function uNe(n){const e=n.defaultView,t=e?.navigator.clipboard,r=t&&await t.read();if(!r)throw new Error("The Clipboard API is unavailable.");const i=Zj(e);for(const s of r)for(const a of s.types)i.setData(a,await s.getType(a).then(o=>Dce(o,e.FileReader)));return i}async function Fce(n,e){const t=X0(n),r=t.navigator.clipboard,i=[];for(let a=0;a<e.items.length;a++){const o=e.items[a],l=await aNe(t,o);i.push(Bce(t,l))}if(!(r&&await r.write(i).then(()=>!0,()=>!1)))throw new Error("The Clipboard API is unavailable.")}const GD=globalThis;typeof GD.afterEach=="function"&&GD.afterEach(()=>lNe(globalThis.window));typeof GD.afterAll=="function"&&GD.afterAll(()=>cNe(globalThis.window));const zce=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");function Qj(n){return n.matches(zce)}function fNe(n){return new n.constructor(n.type,n)}function fb(n){for(let t=n;t;t=t.parentElement)if(Ls(t,["button","input","select","textarea","optgroup","option"])){if(t.hasAttribute("disabled"))return!0}else if(Ls(t,"fieldset")){var e;if(t.hasAttribute("disabled")&&!(!((e=t.querySelector(":scope > legend"))===null||e===void 0)&&e.contains(n)))return!0}else if(t.tagName.includes("-")&&t.constructor.formAssociated&&t.hasAttribute("disabled"))return!0;return!1}function Ak(n){const e=n.activeElement;return e?.shadowRoot?Ak(e.shadowRoot):fb(e)?n.ownerDocument?n.ownerDocument.body:n.body:e}function MB(n){var e;return(e=Ak(n))!==null&&e!==void 0?e:n.body}function hNe(n,e){let t=n;do{if(e(t))return t;t=t.parentElement}while(t&&t!==n.ownerDocument.body)}function CE(n){return n.hasAttribute("contenteditable")&&(n.getAttribute("contenteditable")=="true"||n.getAttribute("contenteditable")=="")}function gO(n){const e=dNe(n);return e&&(e.closest('[contenteditable=""]')||e.closest('[contenteditable="true"]'))}function dNe(n){return n.nodeType===1?n:n.parentElement}var jce=(function(n){return n.button="button",n.color="color",n.file="file",n.image="image",n.reset="reset",n.submit="submit",n.checkbox="checkbox",n.radio="radio",n})(jce||{});function Hce(n){return Ls(n,"button")||Ls(n,"input")&&n.type in jce}function sw(n){return Vce(n)&&!n.readOnly||CE(n)}var qce=(function(n){return n.text="text",n.date="date",n["datetime-local"]="datetime-local",n.email="email",n.month="month",n.number="number",n.password="password",n.search="search",n.tel="tel",n.time="time",n.url="url",n.week="week",n})(qce||{});function Vce(n){return Ls(n,"textarea")||Ls(n,"input")&&n.type in qce}function Zv(n){return Gce(n)&&Vce(n)}function pNe(n){return Gce(n)&&Hce(n)}function Gce(n){return n.nodeType===1}function mNe(n){const e=n.ownerDocument.getSelection();if(e?.focusNode&&Zv(n)){const r=gO(e.focusNode);if(r){if(!e.isCollapsed){var t;const i=((t=r.firstChild)===null||t===void 0?void 0:t.nodeType)===3?r.firstChild:r;e.setBaseAndExtent(i,0,i,0)}}else e.setBaseAndExtent(n,0,n,0)}}var iv={},oP={exports:{}};oP.exports;var gX;function $ce(){return gX||(gX=1,(function(n){const t=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,r=(s=0)=>(a,o,l)=>`\x1B[${38+s};2;${a};${o};${l}m`;function i(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,l]of Object.entries(a)){for(const[c,u]of Object.entries(l))a[c]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},l[c]=a[c],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:l,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=t(),a.color.ansi16m=r(),a.bgColor.ansi256=t(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,l,c)=>o===l&&l===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:c}=l.groups;c.length===3&&(c=c.split("").map(f=>f+f).join(""));const u=Number.parseInt(c,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(n,"exports",{enumerable:!0,get:i})})(oP)),oP.exports}var ES={},_X;function sU(){if(_X)return ES;_X=1,Object.defineProperty(ES,"__esModule",{value:!0}),ES.printIteratorEntries=e,ES.printIteratorValues=t,ES.printListItems=r,ES.printObjectProperties=i;const n=(s,a)=>{const o=Object.keys(s).sort(a);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(s).forEach(l=>{Object.getOwnPropertyDescriptor(s,l).enumerable&&o.push(l)}),o};function e(s,a,o,l,c,u,f=": "){let h="",g=s.next();if(!g.done){h+=a.spacingOuter;const p=o+a.indent;for(;!g.done;){const _=u(g.value[0],a,p,l,c),y=u(g.value[1],a,p,l,c);h+=p+_+f+y,g=s.next(),g.done?a.min||(h+=","):h+=","+a.spacingInner}h+=a.spacingOuter+o}return h}function t(s,a,o,l,c,u){let f="",h=s.next();if(!h.done){f+=a.spacingOuter;const g=o+a.indent;for(;!h.done;)f+=g+u(h.value,a,g,l,c),h=s.next(),h.done?a.min||(f+=","):f+=","+a.spacingInner;f+=a.spacingOuter+o}return f}function r(s,a,o,l,c,u){let f="";if(s.length){f+=a.spacingOuter;const h=o+a.indent;for(let g=0;g<s.length;g++)f+=h,g in s&&(f+=u(s[g],a,h,l,c)),g<s.length-1?f+=","+a.spacingInner:a.min||(f+=",");f+=a.spacingOuter+o}return f}function i(s,a,o,l,c,u){let f="";const h=n(s,a.compareKeys);if(h.length){f+=a.spacingOuter;const g=o+a.indent;for(let p=0;p<h.length;p++){const _=h[p],y=u(_,a,g,l,c),v=u(s[_],a,g,l,c);f+=g+y+": "+v,p<h.length-1?f+=","+a.spacingInner:a.min||(f+=",")}f+=a.spacingOuter+o}return f}return ES}var vy={},vX;function gNe(){if(vX)return vy;vX=1,Object.defineProperty(vy,"__esModule",{value:!0}),vy.test=vy.serialize=vy.default=void 0;var n=sU(),e=(function(){return typeof globalThis<"u"?globalThis:typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()})(),t=e["jest-symbol-do-not-touch"]||e.Symbol;const r=typeof t=="function"&&t.for?t.for("jest.asymmetricMatcher"):1267621,i=" ",s=(c,u,f,h,g,p)=>{const _=c.toString();return _==="ArrayContaining"||_==="ArrayNotContaining"?++h>u.maxDepth?"["+_+"]":_+i+"["+(0,n.printListItems)(c.sample,u,f,h,g,p)+"]":_==="ObjectContaining"||_==="ObjectNotContaining"?++h>u.maxDepth?"["+_+"]":_+i+"{"+(0,n.printObjectProperties)(c.sample,u,f,h,g,p)+"}":_==="StringMatching"||_==="StringNotMatching"||_==="StringContaining"||_==="StringNotContaining"?_+i+p(c.sample,u,f,h,g):c.toAsymmetricMatcher()};vy.serialize=s;const a=c=>c&&c.$$typeof===r;vy.test=a;var l={serialize:s,test:a};return vy.default=l,vy}var yy={},OB,yX;function _Ne(){return yX||(yX=1,OB=({onlyFirst:n=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,n?void 0:"g")}),OB}var bX;function vNe(){if(bX)return yy;bX=1,Object.defineProperty(yy,"__esModule",{value:!0}),yy.test=yy.serialize=yy.default=void 0;var n=t(_Ne()),e=t($ce());function t(l){return l&&l.__esModule?l:{default:l}}const r=l=>l.replace((0,n.default)(),c=>{switch(c){case e.default.red.close:case e.default.green.close:case e.default.cyan.close:case e.default.gray.close:case e.default.white.close:case e.default.yellow.close:case e.default.bgRed.close:case e.default.bgGreen.close:case e.default.bgYellow.close:case e.default.inverse.close:case e.default.dim.close:case e.default.bold.close:case e.default.reset.open:case e.default.reset.close:return"</>";case e.default.red.open:return"<red>";case e.default.green.open:return"<green>";case e.default.cyan.open:return"<cyan>";case e.default.gray.open:return"<gray>";case e.default.white.open:return"<white>";case e.default.yellow.open:return"<yellow>";case e.default.bgRed.open:return"<bgRed>";case e.default.bgGreen.open:return"<bgGreen>";case e.default.bgYellow.open:return"<bgYellow>";case e.default.inverse.open:return"<inverse>";case e.default.dim.open:return"<dim>";case e.default.bold.open:return"<bold>";default:return""}}),i=l=>typeof l=="string"&&!!l.match((0,n.default)());yy.test=i;const s=(l,c,u,f,h,g)=>g(r(l),c,u,f,h);yy.serialize=s;var o={serialize:s,test:i};return yy.default=o,yy}var by={},SX;function yNe(){if(SX)return by;SX=1,Object.defineProperty(by,"__esModule",{value:!0}),by.test=by.serialize=by.default=void 0;var n=sU();const e=" ",t=["DOMStringMap","NamedNodeMap"],r=/^(HTML\w*Collection|NodeList)$/,i=u=>t.indexOf(u)!==-1||r.test(u),s=u=>u&&u.constructor&&!!u.constructor.name&&i(u.constructor.name);by.test=s;const a=u=>u.constructor.name==="NamedNodeMap",o=(u,f,h,g,p,_)=>{const y=u.constructor.name;return++g>f.maxDepth?"["+y+"]":(f.min?"":y+e)+(t.indexOf(y)!==-1?"{"+(0,n.printObjectProperties)(a(u)?Array.from(u).reduce((v,x)=>(v[x.name]=x.value,v),{}):{...u},f,h,g,p,_)+"}":"["+(0,n.printListItems)(Array.from(u),f,h,g,p,_)+"]")};by.serialize=o;var c={serialize:o,test:s};return by.default=c,by}var Sy={},Tp={},YI={},EX;function bNe(){if(EX)return YI;EX=1,Object.defineProperty(YI,"__esModule",{value:!0}),YI.default=n;function n(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}return YI}var xX;function eH(){if(xX)return Tp;xX=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.printText=Tp.printProps=Tp.printElementAsLeaf=Tp.printElement=Tp.printComment=Tp.printChildren=void 0;var n=e(bNe());function e(l){return l&&l.__esModule?l:{default:l}}const t=(l,c,u,f,h,g,p)=>{const _=f+u.indent,y=u.colors;return l.map(v=>{const x=c[v];let E=p(x,u,_,h,g);return typeof x!="string"&&(E.indexOf(`
`)!==-1&&(E=u.spacingOuter+_+E+u.spacingOuter+f),E="{"+E+"}"),u.spacingInner+f+y.prop.open+v+y.prop.close+"="+y.value.open+E+y.value.close}).join("")};Tp.printProps=t;const r=(l,c,u,f,h,g)=>l.map(p=>c.spacingOuter+u+(typeof p=="string"?i(p,c):g(p,c,u,f,h))).join("");Tp.printChildren=r;const i=(l,c)=>{const u=c.colors.content;return u.open+(0,n.default)(l)+u.close};Tp.printText=i;const s=(l,c)=>{const u=c.colors.comment;return u.open+"<!--"+(0,n.default)(l)+"-->"+u.close};Tp.printComment=s;const a=(l,c,u,f,h)=>{const g=f.colors.tag;return g.open+"<"+l+(c&&g.close+c+f.spacingOuter+h+g.open)+(u?">"+g.close+u+f.spacingOuter+h+g.open+"</"+l:(c&&!f.min?"":" ")+"/")+">"+g.close};Tp.printElement=a;const o=(l,c)=>{const u=c.colors.tag;return u.open+"<"+l+u.close+" …"+u.open+" />"+u.close};return Tp.printElementAsLeaf=o,Tp}var TX;function SNe(){if(TX)return Sy;TX=1,Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.test=Sy.serialize=Sy.default=void 0;var n=eH();const e=1,t=3,r=8,i=11,s=/^((HTML|SVG)\w*)?Element$/,a=_=>{try{return typeof _.hasAttribute=="function"&&_.hasAttribute("is")}catch{return!1}},o=_=>{const y=_.constructor.name,{nodeType:v,tagName:x}=_,E=typeof x=="string"&&x.includes("-")||a(_);return v===e&&(s.test(y)||E)||v===t&&y==="Text"||v===r&&y==="Comment"||v===i&&y==="DocumentFragment"},l=_=>{var y;return(_==null||(y=_.constructor)===null||y===void 0?void 0:y.name)&&o(_)};Sy.test=l;function c(_){return _.nodeType===t}function u(_){return _.nodeType===r}function f(_){return _.nodeType===i}const h=(_,y,v,x,E,M)=>{if(c(_))return(0,n.printText)(_.data,y);if(u(_))return(0,n.printComment)(_.data,y);const k=f(_)?"DocumentFragment":_.tagName.toLowerCase();return++x>y.maxDepth?(0,n.printElementAsLeaf)(k,y):(0,n.printElement)(k,(0,n.printProps)(f(_)?[]:Array.from(_.attributes).map(N=>N.name).sort(),f(_)?{}:Array.from(_.attributes).reduce((N,I)=>(N[I.name]=I.value,N),{}),y,v+y.indent,x,E,M),(0,n.printChildren)(Array.prototype.slice.call(_.childNodes||_.children),y,v+y.indent,x,E,M),y,v)};Sy.serialize=h;var p={serialize:h,test:l};return Sy.default=p,Sy}var Ey={},wX;function ENe(){if(wX)return Ey;wX=1,Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.test=Ey.serialize=Ey.default=void 0;var n=sU();const e="@@__IMMUTABLE_ITERABLE__@@",t="@@__IMMUTABLE_LIST__@@",r="@@__IMMUTABLE_KEYED__@@",i="@@__IMMUTABLE_MAP__@@",s="@@__IMMUTABLE_ORDERED__@@",a="@@__IMMUTABLE_RECORD__@@",o="@@__IMMUTABLE_SEQ__@@",l="@@__IMMUTABLE_SET__@@",c="@@__IMMUTABLE_STACK__@@",u=I=>"Immutable."+I,f=I=>"["+I+"]",h=" ",g="…",p=(I,D,V,G,J,B,$)=>++G>D.maxDepth?f(u($)):u($)+h+"{"+(0,n.printIteratorEntries)(I.entries(),D,V,G,J,B)+"}";function _(I){let D=0;return{next(){if(D<I._keys.length){const V=I._keys[D++];return{done:!1,value:[V,I.get(V)]}}return{done:!0,value:void 0}}}}const y=(I,D,V,G,J,B)=>{const $=u(I._name||"Record");return++G>D.maxDepth?f($):$+h+"{"+(0,n.printIteratorEntries)(_(I),D,V,G,J,B)+"}"},v=(I,D,V,G,J,B)=>{const $=u("Seq");return++G>D.maxDepth?f($):I[r]?$+h+"{"+(I._iter||I._object?(0,n.printIteratorEntries)(I.entries(),D,V,G,J,B):g)+"}":$+h+"["+(I._iter||I._array||I._collection||I._iterable?(0,n.printIteratorValues)(I.values(),D,V,G,J,B):g)+"]"},x=(I,D,V,G,J,B,$)=>++G>D.maxDepth?f(u($)):u($)+h+"["+(0,n.printIteratorValues)(I.values(),D,V,G,J,B)+"]",E=(I,D,V,G,J,B)=>I[i]?p(I,D,V,G,J,B,I[s]?"OrderedMap":"Map"):I[t]?x(I,D,V,G,J,B,"List"):I[l]?x(I,D,V,G,J,B,I[s]?"OrderedSet":"Set"):I[c]?x(I,D,V,G,J,B,"Stack"):I[o]?v(I,D,V,G,J,B):y(I,D,V,G,J,B);Ey.serialize=E;const M=I=>I&&(I[e]===!0||I[a]===!0);Ey.test=M;var N={serialize:E,test:M};return Ey.default=N,Ey}var xy={},kB={exports:{}},Zo={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RX;function xNe(){if(RX)return Zo;RX=1;var n=60103,e=60106,t=60107,r=60108,i=60114,s=60109,a=60110,o=60112,l=60113,c=60120,u=60115,f=60116,h=60121,g=60122,p=60117,_=60129,y=60131;if(typeof Symbol=="function"&&Symbol.for){var v=Symbol.for;n=v("react.element"),e=v("react.portal"),t=v("react.fragment"),r=v("react.strict_mode"),i=v("react.profiler"),s=v("react.provider"),a=v("react.context"),o=v("react.forward_ref"),l=v("react.suspense"),c=v("react.suspense_list"),u=v("react.memo"),f=v("react.lazy"),h=v("react.block"),g=v("react.server.block"),p=v("react.fundamental"),_=v("react.debug_trace_mode"),y=v("react.legacy_hidden")}function x($){if(typeof $=="object"&&$!==null){var U=$.$$typeof;switch(U){case n:switch($=$.type,$){case t:case i:case r:case l:case c:return $;default:switch($=$&&$.$$typeof,$){case a:case o:case f:case u:case s:return $;default:return U}}case e:return U}}}var E=s,M=n,k=o,N=t,I=f,D=u,V=e,G=i,J=r,B=l;return Zo.ContextConsumer=a,Zo.ContextProvider=E,Zo.Element=M,Zo.ForwardRef=k,Zo.Fragment=N,Zo.Lazy=I,Zo.Memo=D,Zo.Portal=V,Zo.Profiler=G,Zo.StrictMode=J,Zo.Suspense=B,Zo.isAsyncMode=function(){return!1},Zo.isConcurrentMode=function(){return!1},Zo.isContextConsumer=function($){return x($)===a},Zo.isContextProvider=function($){return x($)===s},Zo.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===n},Zo.isForwardRef=function($){return x($)===o},Zo.isFragment=function($){return x($)===t},Zo.isLazy=function($){return x($)===f},Zo.isMemo=function($){return x($)===u},Zo.isPortal=function($){return x($)===e},Zo.isProfiler=function($){return x($)===i},Zo.isStrictMode=function($){return x($)===r},Zo.isSuspense=function($){return x($)===l},Zo.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===t||$===i||$===_||$===r||$===l||$===c||$===y||typeof $=="object"&&$!==null&&($.$$typeof===f||$.$$typeof===u||$.$$typeof===s||$.$$typeof===a||$.$$typeof===o||$.$$typeof===p||$.$$typeof===h||$[0]===g)},Zo.typeOf=x,Zo}var AX;function TNe(){return AX||(AX=1,kB.exports=xNe()),kB.exports}var CX;function wNe(){if(CX)return xy;CX=1,Object.defineProperty(xy,"__esModule",{value:!0}),xy.test=xy.serialize=xy.default=void 0;var n=r(TNe()),e=eH();function t(f){if(typeof WeakMap!="function")return null;var h=new WeakMap,g=new WeakMap;return(t=function(p){return p?g:h})(f)}function r(f,h){if(f&&f.__esModule)return f;if(f===null||typeof f!="object"&&typeof f!="function")return{default:f};var g=t(h);if(g&&g.has(f))return g.get(f);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(y!=="default"&&Object.prototype.hasOwnProperty.call(f,y)){var v=_?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(p,y,v):p[y]=f[y]}return p.default=f,g&&g.set(f,p),p}const i=(f,h=[])=>(Array.isArray(f)?f.forEach(g=>{i(g,h)}):f!=null&&f!==!1&&h.push(f),h),s=f=>{const h=f.type;if(typeof h=="string")return h;if(typeof h=="function")return h.displayName||h.name||"Unknown";if(n.isFragment(f))return"React.Fragment";if(n.isSuspense(f))return"React.Suspense";if(typeof h=="object"&&h!==null){if(n.isContextProvider(f))return"Context.Provider";if(n.isContextConsumer(f))return"Context.Consumer";if(n.isForwardRef(f)){if(h.displayName)return h.displayName;const g=h.render.displayName||h.render.name||"";return g!==""?"ForwardRef("+g+")":"ForwardRef"}if(n.isMemo(f)){const g=h.displayName||h.type.displayName||h.type.name||"";return g!==""?"Memo("+g+")":"Memo"}}return"UNDEFINED"},a=f=>{const{props:h}=f;return Object.keys(h).filter(g=>g!=="children"&&h[g]!==void 0).sort()},o=(f,h,g,p,_,y)=>++p>h.maxDepth?(0,e.printElementAsLeaf)(s(f),h):(0,e.printElement)(s(f),(0,e.printProps)(a(f),f.props,h,g+h.indent,p,_,y),(0,e.printChildren)(i(f.props.children),h,g+h.indent,p,_,y),h,g);xy.serialize=o;const l=f=>f!=null&&n.isElement(f);xy.test=l;var u={serialize:o,test:l};return xy.default=u,xy}var Ty={},MX;function RNe(){if(MX)return Ty;MX=1,Object.defineProperty(Ty,"__esModule",{value:!0}),Ty.test=Ty.serialize=Ty.default=void 0;var n=eH(),e=(function(){return typeof globalThis<"u"?globalThis:typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()})(),t=e["jest-symbol-do-not-touch"]||e.Symbol;const r=typeof t=="function"&&t.for?t.for("react.test.json"):245830487,i=c=>{const{props:u}=c;return u?Object.keys(u).filter(f=>u[f]!==void 0).sort():[]},s=(c,u,f,h,g,p)=>++h>u.maxDepth?(0,n.printElementAsLeaf)(c.type,u):(0,n.printElement)(c.type,c.props?(0,n.printProps)(i(c),c.props,u,f+u.indent,h,g,p):"",c.children?(0,n.printChildren)(c.children,u,f+u.indent,h,g,p):"",u,f);Ty.serialize=s;const a=c=>c&&c.$$typeof===r;Ty.test=a;var l={serialize:s,test:a};return Ty.default=l,Ty}var OX;function ANe(){if(OX)return iv;OX=1,Object.defineProperty(iv,"__esModule",{value:!0}),iv.default=iv.DEFAULT_OPTIONS=void 0,iv.format=Me,iv.plugins=void 0;var n=c($ce()),e=sU(),t=c(gNe()),r=c(vNe()),i=c(yNe()),s=c(SNe()),a=c(ENe()),o=c(wNe()),l=c(RNe());function c(Ae){return Ae&&Ae.__esModule?Ae:{default:Ae}}const u=Object.prototype.toString,f=Date.prototype.toISOString,h=Error.prototype.toString,g=RegExp.prototype.toString,p=Ae=>typeof Ae.constructor=="function"&&Ae.constructor.name||"Object",_=Ae=>typeof window<"u"&&Ae===window,y=/^Symbol\((.*)\)(.*)$/,v=/\n/gi;class x extends Error{constructor(Xe,$e){super(Xe),this.stack=$e,this.name=this.constructor.name}}function E(Ae){return Ae==="[object Array]"||Ae==="[object ArrayBuffer]"||Ae==="[object DataView]"||Ae==="[object Float32Array]"||Ae==="[object Float64Array]"||Ae==="[object Int8Array]"||Ae==="[object Int16Array]"||Ae==="[object Int32Array]"||Ae==="[object Uint8Array]"||Ae==="[object Uint8ClampedArray]"||Ae==="[object Uint16Array]"||Ae==="[object Uint32Array]"}function M(Ae){return Object.is(Ae,-0)?"-0":String(Ae)}function k(Ae){return`${Ae}n`}function N(Ae,Xe){return Xe?"[Function "+(Ae.name||"anonymous")+"]":"[Function]"}function I(Ae){return String(Ae).replace(y,"Symbol($1)")}function D(Ae){return"["+h.call(Ae)+"]"}function V(Ae,Xe,$e,at){if(Ae===!0||Ae===!1)return""+Ae;if(Ae===void 0)return"undefined";if(Ae===null)return"null";const pt=typeof Ae;if(pt==="number")return M(Ae);if(pt==="bigint")return k(Ae);if(pt==="string")return at?'"'+Ae.replace(/"|\\/g,"\\$&")+'"':'"'+Ae+'"';if(pt==="function")return N(Ae,Xe);if(pt==="symbol")return I(Ae);const oe=u.call(Ae);return oe==="[object WeakMap]"?"WeakMap {}":oe==="[object WeakSet]"?"WeakSet {}":oe==="[object Function]"||oe==="[object GeneratorFunction]"?N(Ae,Xe):oe==="[object Symbol]"?I(Ae):oe==="[object Date]"?isNaN(+Ae)?"Date { NaN }":f.call(Ae):oe==="[object Error]"?D(Ae):oe==="[object RegExp]"?$e?g.call(Ae).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):g.call(Ae):Ae instanceof Error?D(Ae):null}function G(Ae,Xe,$e,at,pt,oe){if(pt.indexOf(Ae)!==-1)return"[Circular]";pt=pt.slice(),pt.push(Ae);const Ue=++at>Xe.maxDepth,Ge=Xe.min;if(Xe.callToJSON&&!Ue&&Ae.toJSON&&typeof Ae.toJSON=="function"&&!oe)return U(Ae.toJSON(),Xe,$e,at,pt,!0);const ze=u.call(Ae);return ze==="[object Arguments]"?Ue?"[Arguments]":(Ge?"":"Arguments ")+"["+(0,e.printListItems)(Ae,Xe,$e,at,pt,U)+"]":E(ze)?Ue?"["+Ae.constructor.name+"]":(Ge||!Xe.printBasicPrototype&&Ae.constructor.name==="Array"?"":Ae.constructor.name+" ")+"["+(0,e.printListItems)(Ae,Xe,$e,at,pt,U)+"]":ze==="[object Map]"?Ue?"[Map]":"Map {"+(0,e.printIteratorEntries)(Ae.entries(),Xe,$e,at,pt,U," => ")+"}":ze==="[object Set]"?Ue?"[Set]":"Set {"+(0,e.printIteratorValues)(Ae.values(),Xe,$e,at,pt,U)+"}":Ue||_(Ae)?"["+p(Ae)+"]":(Ge||!Xe.printBasicPrototype&&p(Ae)==="Object"?"":p(Ae)+" ")+"{"+(0,e.printObjectProperties)(Ae,Xe,$e,at,pt,U)+"}"}function J(Ae){return Ae.serialize!=null}function B(Ae,Xe,$e,at,pt,oe){let Ue;try{Ue=J(Ae)?Ae.serialize(Xe,$e,at,pt,oe,U):Ae.print(Xe,Ge=>U(Ge,$e,at,pt,oe),Ge=>{const ze=at+$e.indent;return ze+Ge.replace(v,`
`+ze)},{edgeSpacing:$e.spacingOuter,min:$e.min,spacing:$e.spacingInner},$e.colors)}catch(Ge){throw new x(Ge.message,Ge.stack)}if(typeof Ue!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof Ue}".`);return Ue}function $(Ae,Xe){for(let $e=0;$e<Ae.length;$e++)try{if(Ae[$e].test(Xe))return Ae[$e]}catch(at){throw new x(at.message,at.stack)}return null}function U(Ae,Xe,$e,at,pt,oe){const Ue=$(Xe.plugins,Ae);if(Ue!==null)return B(Ue,Ae,Xe,$e,at,pt);const Ge=V(Ae,Xe.printFunctionName,Xe.escapeRegex,Xe.escapeString);return Ge!==null?Ge:G(Ae,Xe,$e,at,pt,oe)}const Q={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},W=Object.keys(Q),q={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:Q};iv.DEFAULT_OPTIONS=q;function Y(Ae){if(Object.keys(Ae).forEach(Xe=>{if(!q.hasOwnProperty(Xe))throw new Error(`pretty-format: Unknown option "${Xe}".`)}),Ae.min&&Ae.indent!==void 0&&Ae.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(Ae.theme!==void 0){if(Ae.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof Ae.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof Ae.theme}".`)}}const ae=Ae=>W.reduce((Xe,$e)=>{const at=Ae.theme&&Ae.theme[$e]!==void 0?Ae.theme[$e]:Q[$e],pt=at&&n.default[at];if(pt&&typeof pt.close=="string"&&typeof pt.open=="string")Xe[$e]=pt;else throw new Error(`pretty-format: Option "theme" has a key "${$e}" whose value "${at}" is undefined in ansi-styles.`);return Xe},Object.create(null)),Z=()=>W.reduce((Ae,Xe)=>(Ae[Xe]={close:"",open:""},Ae),Object.create(null)),K=Ae=>Ae&&Ae.printFunctionName!==void 0?Ae.printFunctionName:q.printFunctionName,ne=Ae=>Ae&&Ae.escapeRegex!==void 0?Ae.escapeRegex:q.escapeRegex,le=Ae=>Ae&&Ae.escapeString!==void 0?Ae.escapeString:q.escapeString,ce=Ae=>{var Xe;return{callToJSON:Ae&&Ae.callToJSON!==void 0?Ae.callToJSON:q.callToJSON,colors:Ae&&Ae.highlight?ae(Ae):Z(),compareKeys:Ae&&typeof Ae.compareKeys=="function"?Ae.compareKeys:q.compareKeys,escapeRegex:ne(Ae),escapeString:le(Ae),indent:Ae&&Ae.min?"":de(Ae&&Ae.indent!==void 0?Ae.indent:q.indent),maxDepth:Ae&&Ae.maxDepth!==void 0?Ae.maxDepth:q.maxDepth,min:Ae&&Ae.min!==void 0?Ae.min:q.min,plugins:Ae&&Ae.plugins!==void 0?Ae.plugins:q.plugins,printBasicPrototype:(Xe=Ae?.printBasicPrototype)!==null&&Xe!==void 0?Xe:!0,printFunctionName:K(Ae),spacingInner:Ae&&Ae.min?" ":`
`,spacingOuter:Ae&&Ae.min?"":`
`}};function de(Ae){return new Array(Ae+1).join(" ")}function Me(Ae,Xe){if(Xe&&(Y(Xe),Xe.plugins)){const at=$(Xe.plugins,Ae);if(at!==null)return B(at,Ae,ce(Xe),"",0,[])}const $e=V(Ae,K(Xe),ne(Xe),le(Xe));return $e!==null?$e:G(Ae,ce(Xe),"",0,[])}const qe={AsymmetricMatcher:t.default,ConvertAnsi:r.default,DOMCollection:i.default,DOMElement:s.default,Immutable:a.default,ReactElement:o.default,ReactTestComponent:l.default};iv.plugins=qe;var Ne=Me;return iv.default=Ne,iv}var Wce=ANe(),CNe=Object.prototype.toString;function MNe(n){return typeof n=="function"||CNe.call(n)==="[object Function]"}function ONe(n){var e=Number(n);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var kNe=Math.pow(2,53)-1;function INe(n){var e=ONe(n);return Math.min(Math.max(e,0),kNe)}function S_(n,e){var t=Array,r=Object(n);if(n==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var i=INe(r.length),s=MNe(t)?Object(new t(i)):new Array(i),a=0,o;a<i;)o=r[a],s[a]=o,a+=1;return s.length=i,s}function _O(n){"@babel/helpers - typeof";return _O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_O(n)}function NNe(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function PNe(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Yce(r.key),r)}}function DNe(n,e,t){return e&&PNe(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function LNe(n,e,t){return e=Yce(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Yce(n){var e=UNe(n,"string");return _O(e)==="symbol"?e:String(e)}function UNe(n,e){if(_O(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(_O(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var BNe=(function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];NNe(this,n),LNe(this,"items",void 0),this.items=e}return DNe(n,[{key:"add",value:function(t){return this.has(t)===!1&&this.items.push(t),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(t){var r=this.items.length;return this.items=this.items.filter(function(i){return i!==t}),r!==this.items.length}},{key:"forEach",value:function(t){var r=this;this.items.forEach(function(i){t(i,i,r)})}},{key:"has",value:function(t){return this.items.indexOf(t)!==-1}},{key:"size",get:function(){return this.items.length}}]),n})();const FNe=typeof Set>"u"?Set:BNe;function np(n){var e;return(e=n.localName)!==null&&e!==void 0?e:n.tagName.toLowerCase()}var zNe={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},jNe={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function HNe(n,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(t){var r;return n.hasAttribute(t)&&!((r=jNe[e])!==null&&r!==void 0&&r.has(t))})}function Xce(n,e){return HNe(n,e)}function qNe(n){var e=GNe(n);if(e===null||e==="presentation"){var t=VNe(n);if(e!=="presentation"||Xce(n,t||""))return t}return e}function VNe(n){var e=zNe[np(n)];if(e!==void 0)return e;switch(np(n)){case"a":case"area":case"link":if(n.hasAttribute("href"))return"link";break;case"img":return n.getAttribute("alt")===""&&!Xce(n,"img")?"presentation":"img";case"input":{var t=n,r=t.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return n.hasAttribute("list")?"combobox":"textbox";case"search":return n.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return n.hasAttribute("multiple")||n.size>1?"listbox":"combobox"}return null}function GNe(n){var e=n.getAttribute("role");if(e!==null){var t=e.trim().split(" ")[0];if(t.length>0)return t}return null}function xc(n){return n!==null&&n.nodeType===n.ELEMENT_NODE}function Kce(n){return xc(n)&&np(n)==="caption"}function lP(n){return xc(n)&&np(n)==="input"}function $Ne(n){return xc(n)&&np(n)==="optgroup"}function WNe(n){return xc(n)&&np(n)==="select"}function YNe(n){return xc(n)&&np(n)==="table"}function XNe(n){return xc(n)&&np(n)==="textarea"}function KNe(n){var e=n.ownerDocument===null?n:n.ownerDocument,t=e.defaultView;if(t===null)throw new TypeError("no window available");return t}function ZNe(n){return xc(n)&&np(n)==="fieldset"}function JNe(n){return xc(n)&&np(n)==="legend"}function QNe(n){return xc(n)&&np(n)==="slot"}function ePe(n){return xc(n)&&n.ownerSVGElement!==void 0}function tPe(n){return xc(n)&&np(n)==="svg"}function nPe(n){return ePe(n)&&np(n)==="title"}function $D(n,e){if(xc(n)&&n.hasAttribute(e)){var t=n.getAttribute(e).split(" "),r=n.getRootNode?n.getRootNode():n.ownerDocument;return t.map(function(i){return r.getElementById(i)}).filter(function(i){return i!==null})}return[]}function Yy(n,e){return xc(n)?e.indexOf(qNe(n))!==-1:!1}function rPe(n){return n.trim().replace(/\s\s+/g," ")}function iPe(n,e){if(!xc(n))return!1;if(n.hasAttribute("hidden")||n.getAttribute("aria-hidden")==="true")return!0;var t=e(n);return t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"}function sPe(n){return Yy(n,["button","combobox","listbox","textbox"])||Zce(n,"range")}function Zce(n,e){if(!xc(n))return!1;switch(e){case"range":return Yy(n,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function kX(n,e){var t=S_(n.querySelectorAll(e));return $D(n,"aria-owns").forEach(function(r){t.push.apply(t,S_(r.querySelectorAll(e)))}),t}function aPe(n){return WNe(n)?n.selectedOptions||kX(n,"[selected]"):kX(n,'[aria-selected="true"]')}function oPe(n){return Yy(n,["none","presentation"])}function lPe(n){return Kce(n)}function cPe(n){return Yy(n,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function uPe(n){return!1}function fPe(n){return lP(n)||XNe(n)?n.value:n.textContent||""}function IX(n){var e=n.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function Jce(n){var e=np(n);return e==="button"||e==="input"&&n.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function Qce(n){if(Jce(n))return n;var e=null;return n.childNodes.forEach(function(t){if(e===null&&xc(t)){var r=Qce(t);r!==null&&(e=r)}}),e}function hPe(n){if(n.control!==void 0)return n.control;var e=n.getAttribute("for");return e!==null?n.ownerDocument.getElementById(e):Qce(n)}function dPe(n){var e=n.labels;if(e===null)return e;if(e!==void 0)return S_(e);if(!Jce(n))return null;var t=n.ownerDocument;return S_(t.querySelectorAll("label")).filter(function(r){return hPe(r)===n})}function pPe(n){var e=n.assignedNodes();return e.length===0?S_(n.childNodes):e}function eue(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new FNe,r=KNe(n),i=e.compute,s=i===void 0?"name":i,a=e.computedStyleSupportsPseudoElements,o=a===void 0?e.getComputedStyle!==void 0:a,l=e.getComputedStyle,c=l===void 0?r.getComputedStyle.bind(r):l,u=e.hidden,f=u===void 0?!1:u;function h(v,x){var E="";if(xc(v)&&o){var M=c(v,"::before"),k=IX(M);E="".concat(k," ").concat(E)}var N=QNe(v)?pPe(v):S_(v.childNodes).concat($D(v,"aria-owns"));if(N.forEach(function(V){var G=y(V,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),J=xc(V)?c(V).getPropertyValue("display"):"inline",B=J!=="inline"?" ":"";E+="".concat(B).concat(G).concat(B)}),xc(v)&&o){var I=c(v,"::after"),D=IX(I);E="".concat(E," ").concat(D)}return E.trim()}function g(v,x){var E=v.getAttributeNode(x);return E!==null&&!t.has(E)&&E.value.trim()!==""?(t.add(E),E.value):null}function p(v){return xc(v)?g(v,"title"):null}function _(v){if(!xc(v))return null;if(ZNe(v)){t.add(v);for(var x=S_(v.childNodes),E=0;E<x.length;E+=1){var M=x[E];if(JNe(M))return y(M,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(YNe(v)){t.add(v);for(var k=S_(v.childNodes),N=0;N<k.length;N+=1){var I=k[N];if(Kce(I))return y(I,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(tPe(v)){t.add(v);for(var D=S_(v.childNodes),V=0;V<D.length;V+=1){var G=D[V];if(nPe(G))return G.textContent}return null}else if(np(v)==="img"||np(v)==="area"){var J=g(v,"alt");if(J!==null)return J}else if($Ne(v)){var B=g(v,"label");if(B!==null)return B}if(lP(v)&&(v.type==="button"||v.type==="submit"||v.type==="reset")){var $=g(v,"value");if($!==null)return $;if(v.type==="submit")return"Submit";if(v.type==="reset")return"Reset"}var U=dPe(v);if(U!==null&&U.length!==0)return t.add(v),S_(U).map(function(Y){return y(Y,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(Y){return Y.length>0}).join(" ");if(lP(v)&&v.type==="image"){var Q=g(v,"alt");if(Q!==null)return Q;var W=g(v,"title");return W!==null?W:"Submit Query"}if(Yy(v,["button"])){var q=h(v,{isEmbeddedInLabel:!1});if(q!=="")return q}return null}function y(v,x){if(t.has(v))return"";if(!f&&iPe(v,c)&&!x.isReferenced)return t.add(v),"";var E=xc(v)?v.getAttributeNode("aria-labelledby"):null,M=E!==null&&!t.has(E)?$D(v,"aria-labelledby"):[];if(s==="name"&&!x.isReferenced&&M.length>0)return t.add(E),M.map(function(J){return y(J,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var k=x.recursion&&sPe(v)&&s==="name";if(!k){var N=(xc(v)&&v.getAttribute("aria-label")||"").trim();if(N!==""&&s==="name")return t.add(v),N;if(!oPe(v)){var I=_(v);if(I!==null)return t.add(v),I}}if(Yy(v,["menu"]))return t.add(v),"";if(k||x.isEmbeddedInLabel||x.isReferenced){if(Yy(v,["combobox","listbox"])){t.add(v);var D=aPe(v);return D.length===0?lP(v)?v.value:"":S_(D).map(function(J){return y(J,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(Zce(v,"range"))return t.add(v),v.hasAttribute("aria-valuetext")?v.getAttribute("aria-valuetext"):v.hasAttribute("aria-valuenow")?v.getAttribute("aria-valuenow"):v.getAttribute("value")||"";if(Yy(v,["textbox"]))return t.add(v),fPe(v)}if(cPe(v)||xc(v)&&x.isReferenced||lPe(v)||uPe()){var V=h(v,{isEmbeddedInLabel:x.isEmbeddedInLabel});if(V!=="")return t.add(v),V}if(v.nodeType===v.TEXT_NODE)return t.add(v),v.textContent||"";if(x.recursion)return t.add(v),h(v,{isEmbeddedInLabel:x.isEmbeddedInLabel});var G=p(v);return G!==null?(t.add(v),G):(t.add(v),"")}return rPe(y(n,{isEmbeddedInLabel:!1,isReferenced:s==="description",recursion:!1}))}function vO(n){"@babel/helpers - typeof";return vO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vO(n)}function NX(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function PX(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?NX(Object(t),!0).forEach(function(r){mPe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):NX(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function mPe(n,e,t){return e=gPe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gPe(n){var e=_Pe(n,"string");return vO(e)==="symbol"?e:String(e)}function _Pe(n,e){if(vO(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(vO(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function tue(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=$D(n,"aria-describedby").map(function(i){return eue(i,PX(PX({},e),{},{compute:"description"}))}).join(" ");if(t===""){var r=n.getAttribute("title");t=r===null?"":r}return t}function vPe(n){return Yy(n,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function tH(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vPe(n)?"":eue(n,e)}var Eg={},YR={},XI={},XR={},DX;function yPe(){if(DX)return XR;DX=1,Object.defineProperty(XR,"__esModule",{value:!0}),XR.default=void 0;function n(){var t=this,r=0,i={"@@iterator":function(){return i},next:function(){if(r<t.length){var a=t[r];return r=r+1,{done:!1,value:a}}else return{done:!0}}};return i}var e=n;return XR.default=e,XR}var LX;function Ck(){if(LX)return XI;LX=1,Object.defineProperty(XI,"__esModule",{value:!0}),XI.default=r;var n=e(yPe());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t(i)}function r(i,s){return typeof Symbol=="function"&&t(Symbol.iterator)==="symbol"&&Object.defineProperty(i,Symbol.iterator,{value:n.default.bind(s)}),i}return XI}var UX;function bPe(){if(UX)return YR;UX=1,Object.defineProperty(YR,"__esModule",{value:!0}),YR.default=void 0;var n=e(Ck());function e(h){return h&&h.__esModule?h:{default:h}}function t(h,g){return s(h)||i(h,g)||o(h,g)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(h,g){var p=h==null?null:typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(p!=null){var _=[],y=!0,v=!1,x,E;try{for(p=p.call(h);!(y=(x=p.next()).done)&&(_.push(x.value),!(g&&_.length===g));y=!0);}catch(M){v=!0,E=M}finally{try{!y&&p.return!=null&&p.return()}finally{if(v)throw E}}return _}}function s(h){if(Array.isArray(h))return h}function a(h,g){var p=typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(!p){if(Array.isArray(h)||(p=o(h))||g){p&&(h=p);var _=0,y=function(){};return{s:y,n:function(){return _>=h.length?{done:!0}:{done:!1,value:h[_++]}},e:function(k){throw k},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,x=!1,E;return{s:function(){p=p.call(h)},n:function(){var k=p.next();return v=k.done,k},e:function(k){x=!0,E=k},f:function(){try{!v&&p.return!=null&&p.return()}finally{if(x)throw E}}}}function o(h,g){if(h){if(typeof h=="string")return l(h,g);var p=Object.prototype.toString.call(h).slice(8,-1);if(p==="Object"&&h.constructor&&(p=h.constructor.name),p==="Map"||p==="Set")return Array.from(h);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return l(h,g)}}function l(h,g){(g==null||g>h.length)&&(g=h.length);for(var p=0,_=new Array(g);p<g;p++)_[p]=h[p];return _}var c=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-braillelabel",{type:"string"}],["aria-brailleroledescription",{type:"string"}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-description",{type:"string"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],u={entries:function(){return c},forEach:function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,_=a(c),y;try{for(_.s();!(y=_.n()).done;){var v=t(y.value,2),x=v[0],E=v[1];g.call(p,E,x,c)}}catch(M){_.e(M)}finally{_.f()}},get:function(g){var p=c.find(function(_){return _[0]===g});return p&&p[1]},has:function(g){return!!u.get(g)},keys:function(){return c.map(function(g){var p=t(g,1),_=p[0];return _})},values:function(){return c.map(function(g){var p=t(g,2),_=p[1];return _})}},f=(0,n.default)(u,u.entries());return YR.default=f,YR}var KR={},BX;function SPe(){if(BX)return KR;BX=1,Object.defineProperty(KR,"__esModule",{value:!0}),KR.default=void 0;var n=e(Ck());function e(h){return h&&h.__esModule?h:{default:h}}function t(h,g){return s(h)||i(h,g)||o(h,g)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(h,g){var p=h==null?null:typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(p!=null){var _=[],y=!0,v=!1,x,E;try{for(p=p.call(h);!(y=(x=p.next()).done)&&(_.push(x.value),!(g&&_.length===g));y=!0);}catch(M){v=!0,E=M}finally{try{!y&&p.return!=null&&p.return()}finally{if(v)throw E}}return _}}function s(h){if(Array.isArray(h))return h}function a(h,g){var p=typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(!p){if(Array.isArray(h)||(p=o(h))||g){p&&(h=p);var _=0,y=function(){};return{s:y,n:function(){return _>=h.length?{done:!0}:{done:!1,value:h[_++]}},e:function(k){throw k},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,x=!1,E;return{s:function(){p=p.call(h)},n:function(){var k=p.next();return v=k.done,k},e:function(k){x=!0,E=k},f:function(){try{!v&&p.return!=null&&p.return()}finally{if(x)throw E}}}}function o(h,g){if(h){if(typeof h=="string")return l(h,g);var p=Object.prototype.toString.call(h).slice(8,-1);if(p==="Object"&&h.constructor&&(p=h.constructor.name),p==="Map"||p==="Set")return Array.from(h);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return l(h,g)}}function l(h,g){(g==null||g>h.length)&&(g=h.length);for(var p=0,_=new Array(g);p<g;p++)_[p]=h[p];return _}var c=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],u={entries:function(){return c},forEach:function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,_=a(c),y;try{for(_.s();!(y=_.n()).done;){var v=t(y.value,2),x=v[0],E=v[1];g.call(p,E,x,c)}}catch(M){_.e(M)}finally{_.f()}},get:function(g){var p=c.find(function(_){return _[0]===g});return p&&p[1]},has:function(g){return!!u.get(g)},keys:function(){return c.map(function(g){var p=t(g,1),_=p[0];return _})},values:function(){return c.map(function(g){var p=t(g,2),_=p[1];return _})}},f=(0,n.default)(u,u.entries());return KR.default=f,KR}var ZR={},JR={},QR={},FX;function EPe(){if(FX)return QR;FX=1,Object.defineProperty(QR,"__esModule",{value:!0}),QR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return QR.default=e,QR}var eA={},zX;function xPe(){if(zX)return eA;zX=1,Object.defineProperty(eA,"__esModule",{value:!0}),eA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return eA.default=e,eA}var tA={},jX;function TPe(){if(jX)return tA;jX=1,Object.defineProperty(tA,"__esModule",{value:!0}),tA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return tA.default=e,tA}var nA={},HX;function wPe(){if(HX)return nA;HX=1,Object.defineProperty(nA,"__esModule",{value:!0}),nA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return nA.default=e,nA}var rA={},qX;function RPe(){if(qX)return rA;qX=1,Object.defineProperty(rA,"__esModule",{value:!0}),rA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return rA.default=e,rA}var iA={},VX;function APe(){if(VX)return iA;VX=1,Object.defineProperty(iA,"__esModule",{value:!0}),iA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},e=n;return iA.default=e,iA}var sA={},GX;function CPe(){if(GX)return sA;GX=1,Object.defineProperty(sA,"__esModule",{value:!0}),sA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return sA.default=e,sA}var aA={},$X;function MPe(){if($X)return aA;$X=1,Object.defineProperty(aA,"__esModule",{value:!0}),aA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return aA.default=e,aA}var oA={},WX;function OPe(){if(WX)return oA;WX=1,Object.defineProperty(oA,"__esModule",{value:!0}),oA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},e=n;return oA.default=e,oA}var lA={},YX;function kPe(){if(YX)return lA;YX=1,Object.defineProperty(lA,"__esModule",{value:!0}),lA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return lA.default=e,lA}var cA={},XX;function IPe(){if(XX)return cA;XX=1,Object.defineProperty(cA,"__esModule",{value:!0}),cA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return cA.default=e,cA}var uA={},KX;function NPe(){if(KX)return uA;KX=1,Object.defineProperty(uA,"__esModule",{value:!0}),uA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return uA.default=e,uA}var ZX;function PPe(){if(ZX)return JR;ZX=1,Object.defineProperty(JR,"__esModule",{value:!0}),JR.default=void 0;var n=h(EPe()),e=h(xPe()),t=h(TPe()),r=h(wPe()),i=h(RPe()),s=h(APe()),a=h(CPe()),o=h(MPe()),l=h(OPe()),c=h(kPe()),u=h(IPe()),f=h(NPe());function h(_){return _&&_.__esModule?_:{default:_}}var g=[["command",n.default],["composite",e.default],["input",t.default],["landmark",r.default],["range",i.default],["roletype",s.default],["section",a.default],["sectionhead",o.default],["select",l.default],["structure",c.default],["widget",u.default],["window",f.default]],p=g;return JR.default=p,JR}var fA={},hA={},JX;function DPe(){if(JX)return hA;JX=1,Object.defineProperty(hA,"__esModule",{value:!0}),hA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return hA.default=e,hA}var dA={},QX;function LPe(){if(QX)return dA;QX=1,Object.defineProperty(dA,"__esModule",{value:!0}),dA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},e=n;return dA.default=e,dA}var pA={},eK;function UPe(){if(eK)return pA;eK=1,Object.defineProperty(pA,"__esModule",{value:!0}),pA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return pA.default=e,pA}var mA={},tK;function BPe(){if(tK)return mA;tK=1,Object.defineProperty(mA,"__esModule",{value:!0}),mA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},e=n;return mA.default=e,mA}var gA={},nK;function FPe(){if(nK)return gA;nK=1,Object.defineProperty(gA,"__esModule",{value:!0}),gA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return gA.default=e,gA}var _A={},rK;function zPe(){if(rK)return _A;rK=1,Object.defineProperty(_A,"__esModule",{value:!0}),_A.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"blockquote"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return _A.default=e,_A}var vA={},iK;function jPe(){if(iK)return vA;iK=1,Object.defineProperty(vA,"__esModule",{value:!0}),vA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return vA.default=e,vA}var yA={},sK;function HPe(){if(sK)return yA;sK=1,Object.defineProperty(yA,"__esModule",{value:!0}),yA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"caption"},module:"HTML"}],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return yA.default=e,yA}var bA={},aK;function qPe(){if(aK)return bA;aK=1,Object.defineProperty(bA,"__esModule",{value:!0}),bA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["ancestor table element has table role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return bA.default=e,bA}var SA={},oK;function VPe(){if(oK)return SA;oK=1,Object.defineProperty(SA,"__esModule",{value:!0}),SA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},e=n;return SA.default=e,SA}var EA={},lK;function GPe(){if(lK)return EA;lK=1,Object.defineProperty(EA,"__esModule",{value:!0}),EA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"code"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return EA.default=e,EA}var xA={},cK;function $Pe(){if(cK)return xA;cK=1,Object.defineProperty(xA,"__esModule",{value:!0}),xA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"col"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"colgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},e=n;return xA.default=e,xA}var TA={},uK;function WPe(){if(uK)return TA;uK=1,Object.defineProperty(TA,"__esModule",{value:!0}),TA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],constraints:["the multiple attribute is not set and the size attribute does not have a value greater than 1"],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},e=n;return TA.default=e,TA}var wA={},fK;function YPe(){if(fK)return wA;fK=1,Object.defineProperty(wA,"__esModule",{value:!0}),wA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-label"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return wA.default=e,wA}var RA={},hK;function XPe(){if(hK)return RA;hK=1,Object.defineProperty(RA,"__esModule",{value:!0}),RA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return RA.default=e,RA}var AA={},dK;function KPe(){if(dK)return AA;dK=1,Object.defineProperty(AA,"__esModule",{value:!0}),AA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return AA.default=e,AA}var CA={},pK;function ZPe(){if(pK)return CA;pK=1,Object.defineProperty(CA,"__esModule",{value:!0}),CA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"del"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return CA.default=e,CA}var MA={},mK;function JPe(){if(mK)return MA;mK=1,Object.defineProperty(MA,"__esModule",{value:!0}),MA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},e=n;return MA.default=e,MA}var OA={},gK;function QPe(){if(gK)return OA;gK=1,Object.defineProperty(OA,"__esModule",{value:!0}),OA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},e=n;return OA.default=e,OA}var kA={},_K;function eDe(){if(_K)return kA;_K=1,Object.defineProperty(kA,"__esModule",{value:!0}),kA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"html"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return kA.default=e,kA}var IA={},vK;function tDe(){if(vK)return IA;vK=1,Object.defineProperty(IA,"__esModule",{value:!0}),IA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"em"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return IA.default=e,IA}var NA={},yK;function nDe(){if(yK)return NA;yK=1,Object.defineProperty(NA,"__esModule",{value:!0}),NA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},e=n;return NA.default=e,NA}var PA={},bK;function rDe(){if(bK)return PA;bK=1,Object.defineProperty(PA,"__esModule",{value:!0}),PA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return PA.default=e,PA}var DA={},SK;function iDe(){if(SK)return DA;SK=1,Object.defineProperty(DA,"__esModule",{value:!0}),DA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return DA.default=e,DA}var LA={},EK;function sDe(){if(EK)return LA;EK=1,Object.defineProperty(LA,"__esModule",{value:!0}),LA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"a"},module:"HTML"},{concept:{name:"area"},module:"HTML"},{concept:{name:"aside"},module:"HTML"},{concept:{name:"b"},module:"HTML"},{concept:{name:"bdo"},module:"HTML"},{concept:{name:"body"},module:"HTML"},{concept:{name:"data"},module:"HTML"},{concept:{name:"div"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"footer"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"header"},module:"HTML"},{concept:{name:"hgroup"},module:"HTML"},{concept:{name:"i"},module:"HTML"},{concept:{name:"pre"},module:"HTML"},{concept:{name:"q"},module:"HTML"},{concept:{name:"samp"},module:"HTML"},{concept:{name:"section"},module:"HTML"},{concept:{name:"small"},module:"HTML"},{concept:{name:"span"},module:"HTML"},{concept:{name:"u"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return LA.default=e,LA}var UA={},xK;function aDe(){if(xK)return UA;xK=1,Object.defineProperty(UA,"__esModule",{value:!0}),UA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},e=n;return UA.default=e,UA}var BA={},TK;function oDe(){if(TK)return BA;TK=1,Object.defineProperty(BA,"__esModule",{value:!0}),BA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{constraints:["ancestor table element has grid role","ancestor table element has treegrid role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},e=n;return BA.default=e,BA}var FA={},wK;function lDe(){if(wK)return FA;wK=1,Object.defineProperty(FA,"__esModule",{value:!0}),FA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"},{concept:{name:"address"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return FA.default=e,FA}var zA={},RK;function cDe(){if(RK)return zA;RK=1,Object.defineProperty(zA,"__esModule",{value:!0}),zA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},e=n;return zA.default=e,zA}var jA={},AK;function uDe(){if(AK)return jA;AK=1,Object.defineProperty(jA,"__esModule",{value:!0}),jA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return jA.default=e,jA}var HA={},CK;function fDe(){if(CK)return HA;CK=1,Object.defineProperty(HA,"__esModule",{value:!0}),HA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"ins"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return HA.default=e,HA}var qA={},MK;function hDe(){if(MK)return qA;MK=1,Object.defineProperty(qA,"__esModule",{value:!0}),qA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"href"}],name:"area"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return qA.default=e,qA}var VA={},OK;function dDe(){if(OK)return VA;OK=1,Object.defineProperty(VA,"__esModule",{value:!0}),VA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return VA.default=e,VA}var GA={},kK;function pDe(){if(kK)return GA;kK=1,Object.defineProperty(GA,"__esModule",{value:!0}),GA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"}],constraints:["the size attribute value is greater than 1"],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return GA.default=e,GA}var $A={},IK;function mDe(){if(IK)return $A;IK=1,Object.defineProperty($A,"__esModule",{value:!0}),$A.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol","direct descendant of ul","direct descendant of menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return $A.default=e,$A}var WA={},NK;function gDe(){if(NK)return WA;NK=1,Object.defineProperty(WA,"__esModule",{value:!0}),WA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return WA.default=e,WA}var YA={},PK;function _De(){if(PK)return YA;PK=1,Object.defineProperty(YA,"__esModule",{value:!0}),YA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return YA.default=e,YA}var XA={},DK;function vDe(){if(DK)return XA;DK=1,Object.defineProperty(XA,"__esModule",{value:!0}),XA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:[],props:{"aria-braillelabel":null,"aria-brailleroledescription":null,"aria-description":null},relatedConcepts:[{concept:{name:"mark"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return XA.default=e,XA}var KA={},LK;function yDe(){if(LK)return KA;LK=1,Object.defineProperty(KA,"__esModule",{value:!0}),KA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return KA.default=e,KA}var ZA={},UK;function bDe(){if(UK)return ZA;UK=1,Object.defineProperty(ZA,"__esModule",{value:!0}),ZA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return ZA.default=e,ZA}var JA={},BK;function SDe(){if(BK)return JA;BK=1,Object.defineProperty(JA,"__esModule",{value:!0}),JA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return JA.default=e,JA}var QA={},FK;function EDe(){if(FK)return QA;FK=1,Object.defineProperty(QA,"__esModule",{value:!0}),QA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},e=n;return QA.default=e,QA}var eC={},zK;function xDe(){if(zK)return eC;zK=1,Object.defineProperty(eC,"__esModule",{value:!0}),eC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return eC.default=e,eC}var tC={},jK;function TDe(){if(jK)return tC;jK=1,Object.defineProperty(tC,"__esModule",{value:!0}),tC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},e=n;return tC.default=e,tC}var nC={},HK;function wDe(){if(HK)return nC;HK=1,Object.defineProperty(nC,"__esModule",{value:!0}),nC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},e=n;return nC.default=e,nC}var rC={},qK;function RDe(){if(qK)return rC;qK=1,Object.defineProperty(rC,"__esModule",{value:!0}),rC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"meter"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},e=n;return rC.default=e,rC}var iC={},VK;function ADe(){if(VK)return iC;VK=1,Object.defineProperty(iC,"__esModule",{value:!0}),iC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return iC.default=e,iC}var sC={},GK;function CDe(){if(GK)return sC;GK=1,Object.defineProperty(sC,"__esModule",{value:!0}),sC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},e=n;return sC.default=e,sC}var aC={},$K;function MDe(){if($K)return aC;$K=1,Object.defineProperty(aC,"__esModule",{value:!0}),aC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return aC.default=e,aC}var oC={},WK;function ODe(){if(WK)return oC;WK=1,Object.defineProperty(oC,"__esModule",{value:!0}),oC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},e=n;return oC.default=e,oC}var lC={},YK;function kDe(){if(YK)return lC;YK=1,Object.defineProperty(lC,"__esModule",{value:!0}),lC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"p"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return lC.default=e,lC}var cC={},XK;function IDe(){if(XK)return cC;XK=1,Object.defineProperty(cC,"__esModule",{value:!0}),cC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{attributes:[{name:"alt",value:""}],name:"img"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return cC.default=e,cC}var uC={},KK;function NDe(){if(KK)return uC;KK=1,Object.defineProperty(uC,"__esModule",{value:!0}),uC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},e=n;return uC.default=e,uC}var fC={},ZK;function PDe(){if(ZK)return fC;ZK=1,Object.defineProperty(fC,"__esModule",{value:!0}),fC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},e=n;return fC.default=e,fC}var hC={},JK;function DDe(){if(JK)return hC;JK=1,Object.defineProperty(hC,"__esModule",{value:!0}),hC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return hC.default=e,hC}var dC={},QK;function LDe(){if(QK)return dC;QK=1,Object.defineProperty(dC,"__esModule",{value:!0}),dC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return dC.default=e,dC}var pC={},eZ;function UDe(){if(eZ)return pC;eZ=1,Object.defineProperty(pC,"__esModule",{value:!0}),pC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},e=n;return pC.default=e,pC}var mC={},tZ;function BDe(){if(tZ)return mC;tZ=1,Object.defineProperty(mC,"__esModule",{value:!0}),mC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return mC.default=e,mC}var gC={},nZ;function FDe(){if(nZ)return gC;nZ=1,Object.defineProperty(gC,"__esModule",{value:!0}),gC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},e=n;return gC.default=e,gC}var _C={},rZ;function zDe(){if(rZ)return _C;rZ=1,Object.defineProperty(_C,"__esModule",{value:!0}),_C.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},e=n;return _C.default=e,_C}var vC={},iZ;function jDe(){if(iZ)return vC;iZ=1,Object.defineProperty(vC,"__esModule",{value:!0}),vC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return vC.default=e,vC}var yC={},sZ;function HDe(){if(sZ)return yC;sZ=1,Object.defineProperty(yC,"__esModule",{value:!0}),yC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},e=n;return yC.default=e,yC}var bC={},aZ;function qDe(){if(aZ)return bC;aZ=1,Object.defineProperty(bC,"__esModule",{value:!0}),bC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return bC.default=e,bC}var SC={},oZ;function VDe(){if(oZ)return SC;oZ=1,Object.defineProperty(SC,"__esModule",{value:!0}),SC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},e=n;return SC.default=e,SC}var EC={},lZ;function GDe(){if(lZ)return EC;lZ=1,Object.defineProperty(EC,"__esModule",{value:!0}),EC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},e=n;return EC.default=e,EC}var xC={},cZ;function $De(){if(cZ)return xC;cZ=1,Object.defineProperty(xC,"__esModule",{value:!0}),xC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return xC.default=e,xC}var TC={},uZ;function WDe(){if(uZ)return TC;uZ=1,Object.defineProperty(TC,"__esModule",{value:!0}),TC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"strong"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return TC.default=e,TC}var wC={},fZ;function YDe(){if(fZ)return wC;fZ=1,Object.defineProperty(wC,"__esModule",{value:!0}),wC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sub"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return wC.default=e,wC}var RC={},hZ;function XDe(){if(hZ)return RC;hZ=1,Object.defineProperty(RC,"__esModule",{value:!0}),RC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return RC.default=e,RC}var AC={},dZ;function KDe(){if(dZ)return AC;dZ=1,Object.defineProperty(AC,"__esModule",{value:!0}),AC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},e=n;return AC.default=e,AC}var CC={},pZ;function ZDe(){if(pZ)return CC;pZ=1,Object.defineProperty(CC,"__esModule",{value:!0}),CC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},e=n;return CC.default=e,CC}var MC={},mZ;function JDe(){if(mZ)return MC;mZ=1,Object.defineProperty(MC,"__esModule",{value:!0}),MC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return MC.default=e,MC}var OC={},gZ;function QDe(){if(gZ)return OC;gZ=1,Object.defineProperty(OC,"__esModule",{value:!0}),OC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},e=n;return OC.default=e,OC}var kC={},_Z;function eLe(){if(_Z)return kC;_Z=1,Object.defineProperty(kC,"__esModule",{value:!0}),kC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return kC.default=e,kC}var IC={},vZ;function tLe(){if(vZ)return IC;vZ=1,Object.defineProperty(IC,"__esModule",{value:!0}),IC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return IC.default=e,IC}var NC={},yZ;function nLe(){if(yZ)return NC;yZ=1,Object.defineProperty(NC,"__esModule",{value:!0}),NC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},e=n;return NC.default=e,NC}var PC={},bZ;function rLe(){if(bZ)return PC;bZ=1,Object.defineProperty(PC,"__esModule",{value:!0}),PC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"time"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return PC.default=e,PC}var DC={},SZ;function iLe(){if(SZ)return DC;SZ=1,Object.defineProperty(DC,"__esModule",{value:!0}),DC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},e=n;return DC.default=e,DC}var LC={},EZ;function sLe(){if(EZ)return LC;EZ=1,Object.defineProperty(LC,"__esModule",{value:!0}),LC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},e=n;return LC.default=e,LC}var UC={},xZ;function aLe(){if(xZ)return UC;xZ=1,Object.defineProperty(UC,"__esModule",{value:!0}),UC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return UC.default=e,UC}var BC={},TZ;function oLe(){if(TZ)return BC;TZ=1,Object.defineProperty(BC,"__esModule",{value:!0}),BC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return BC.default=e,BC}var FC={},wZ;function lLe(){if(wZ)return FC;wZ=1,Object.defineProperty(FC,"__esModule",{value:!0}),FC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},e=n;return FC.default=e,FC}var zC={},RZ;function cLe(){if(RZ)return zC;RZ=1,Object.defineProperty(zC,"__esModule",{value:!0}),zC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},e=n;return zC.default=e,zC}var AZ;function uLe(){if(AZ)return fA;AZ=1,Object.defineProperty(fA,"__esModule",{value:!0}),fA.default=void 0;var n=ft(DPe()),e=ft(LPe()),t=ft(UPe()),r=ft(BPe()),i=ft(FPe()),s=ft(zPe()),a=ft(jPe()),o=ft(HPe()),l=ft(qPe()),c=ft(VPe()),u=ft(GPe()),f=ft($Pe()),h=ft(WPe()),g=ft(YPe()),p=ft(XPe()),_=ft(KPe()),y=ft(ZPe()),v=ft(JPe()),x=ft(QPe()),E=ft(eDe()),M=ft(tDe()),k=ft(nDe()),N=ft(rDe()),I=ft(iDe()),D=ft(sDe()),V=ft(aDe()),G=ft(oDe()),J=ft(lDe()),B=ft(cDe()),$=ft(uDe()),U=ft(fDe()),Q=ft(hDe()),W=ft(dDe()),q=ft(pDe()),Y=ft(mDe()),ae=ft(gDe()),Z=ft(_De()),K=ft(vDe()),ne=ft(yDe()),le=ft(bDe()),ce=ft(SDe()),de=ft(EDe()),Me=ft(xDe()),qe=ft(TDe()),Ne=ft(wDe()),Ae=ft(RDe()),Xe=ft(ADe()),$e=ft(CDe()),at=ft(MDe()),pt=ft(ODe()),oe=ft(kDe()),Ue=ft(IDe()),Ge=ft(NDe()),ze=ft(PDe()),Be=ft(DDe()),me=ft(LDe()),Se=ft(UDe()),ke=ft(BDe()),be=ft(FDe()),Ke=ft(zDe()),ot=ft(jDe()),lt=ft(HDe()),ct=ft(qDe()),Vt=ft(VDe()),Ot=ft(GDe()),Ut=ft($De()),je=ft(WDe()),ge=ft(YDe()),se=ft(XDe()),_e=ft(KDe()),Ie=ft(ZDe()),De=ft(JDe()),Oe=ft(QDe()),we=ft(eLe()),st=ft(tLe()),Ve=ft(nLe()),tt=ft(rLe()),Ze=ft(iLe()),nt=ft(sLe()),vt=ft(aLe()),Je=ft(oLe()),ht=ft(lLe()),mt=ft(cLe());function ft(_n){return _n&&_n.__esModule?_n:{default:_n}}var _t=[["alert",n.default],["alertdialog",e.default],["application",t.default],["article",r.default],["banner",i.default],["blockquote",s.default],["button",a.default],["caption",o.default],["cell",l.default],["checkbox",c.default],["code",u.default],["columnheader",f.default],["combobox",h.default],["complementary",g.default],["contentinfo",p.default],["definition",_.default],["deletion",y.default],["dialog",v.default],["directory",x.default],["document",E.default],["emphasis",M.default],["feed",k.default],["figure",N.default],["form",I.default],["generic",D.default],["grid",V.default],["gridcell",G.default],["group",J.default],["heading",B.default],["img",$.default],["insertion",U.default],["link",Q.default],["list",W.default],["listbox",q.default],["listitem",Y.default],["log",ae.default],["main",Z.default],["mark",K.default],["marquee",ne.default],["math",le.default],["menu",ce.default],["menubar",de.default],["menuitem",Me.default],["menuitemcheckbox",qe.default],["menuitemradio",Ne.default],["meter",Ae.default],["navigation",Xe.default],["none",$e.default],["note",at.default],["option",pt.default],["paragraph",oe.default],["presentation",Ue.default],["progressbar",Ge.default],["radio",ze.default],["radiogroup",Be.default],["region",me.default],["row",Se.default],["rowgroup",ke.default],["rowheader",be.default],["scrollbar",Ke.default],["search",ot.default],["searchbox",lt.default],["separator",ct.default],["slider",Vt.default],["spinbutton",Ot.default],["status",Ut.default],["strong",je.default],["subscript",ge.default],["superscript",se.default],["switch",_e.default],["tab",Ie.default],["table",De.default],["tablist",Oe.default],["tabpanel",we.default],["term",st.default],["textbox",Ve.default],["time",tt.default],["timer",Ze.default],["toolbar",nt.default],["tooltip",vt.default],["tree",Je.default],["treegrid",ht.default],["treeitem",mt.default]],gn=_t;return fA.default=gn,fA}var jC={},HC={},CZ;function fLe(){if(CZ)return HC;CZ=1,Object.defineProperty(HC,"__esModule",{value:!0}),HC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return HC.default=e,HC}var qC={},MZ;function hLe(){if(MZ)return qC;MZ=1,Object.defineProperty(qC,"__esModule",{value:!0}),qC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return qC.default=e,qC}var VC={},OZ;function dLe(){if(OZ)return VC;OZ=1,Object.defineProperty(VC,"__esModule",{value:!0}),VC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return VC.default=e,VC}var GC={},kZ;function pLe(){if(kZ)return GC;kZ=1,Object.defineProperty(GC,"__esModule",{value:!0}),GC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return GC.default=e,GC}var $C={},IZ;function mLe(){if(IZ)return $C;IZ=1,Object.defineProperty($C,"__esModule",{value:!0}),$C.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return $C.default=e,$C}var WC={},NZ;function gLe(){if(NZ)return WC;NZ=1,Object.defineProperty(WC,"__esModule",{value:!0}),WC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},e=n;return WC.default=e,WC}var YC={},PZ;function _Le(){if(PZ)return YC;PZ=1,Object.defineProperty(YC,"__esModule",{value:!0}),YC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return YC.default=e,YC}var XC={},DZ;function vLe(){if(DZ)return XC;DZ=1,Object.defineProperty(XC,"__esModule",{value:!0}),XC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return XC.default=e,XC}var KC={},LZ;function yLe(){if(LZ)return KC;LZ=1,Object.defineProperty(KC,"__esModule",{value:!0}),KC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return KC.default=e,KC}var ZC={},UZ;function bLe(){if(UZ)return ZC;UZ=1,Object.defineProperty(ZC,"__esModule",{value:!0}),ZC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return ZC.default=e,ZC}var JC={},BZ;function SLe(){if(BZ)return JC;BZ=1,Object.defineProperty(JC,"__esModule",{value:!0}),JC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return JC.default=e,JC}var QC={},FZ;function ELe(){if(FZ)return QC;FZ=1,Object.defineProperty(QC,"__esModule",{value:!0}),QC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},e=n;return QC.default=e,QC}var eM={},zZ;function xLe(){if(zZ)return eM;zZ=1,Object.defineProperty(eM,"__esModule",{value:!0}),eM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return eM.default=e,eM}var tM={},jZ;function TLe(){if(jZ)return tM;jZ=1,Object.defineProperty(tM,"__esModule",{value:!0}),tM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return tM.default=e,tM}var nM={},HZ;function wLe(){if(HZ)return nM;HZ=1,Object.defineProperty(nM,"__esModule",{value:!0}),nM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return nM.default=e,nM}var rM={},qZ;function RLe(){if(qZ)return rM;qZ=1,Object.defineProperty(rM,"__esModule",{value:!0}),rM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},e=n;return rM.default=e,rM}var iM={},VZ;function ALe(){if(VZ)return iM;VZ=1,Object.defineProperty(iM,"__esModule",{value:!0}),iM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return iM.default=e,iM}var sM={},GZ;function CLe(){if(GZ)return sM;GZ=1,Object.defineProperty(sM,"__esModule",{value:!0}),sM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return sM.default=e,sM}var aM={},$Z;function MLe(){if($Z)return aM;$Z=1,Object.defineProperty(aM,"__esModule",{value:!0}),aM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return aM.default=e,aM}var oM={},WZ;function OLe(){if(WZ)return oM;WZ=1,Object.defineProperty(oM,"__esModule",{value:!0}),oM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return oM.default=e,oM}var lM={},YZ;function kLe(){if(YZ)return lM;YZ=1,Object.defineProperty(lM,"__esModule",{value:!0}),lM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return lM.default=e,lM}var cM={},XZ;function ILe(){if(XZ)return cM;XZ=1,Object.defineProperty(cM,"__esModule",{value:!0}),cM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return cM.default=e,cM}var uM={},KZ;function NLe(){if(KZ)return uM;KZ=1,Object.defineProperty(uM,"__esModule",{value:!0}),uM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return uM.default=e,uM}var fM={},ZZ;function PLe(){if(ZZ)return fM;ZZ=1,Object.defineProperty(fM,"__esModule",{value:!0}),fM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return fM.default=e,fM}var hM={},JZ;function DLe(){if(JZ)return hM;JZ=1,Object.defineProperty(hM,"__esModule",{value:!0}),hM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return hM.default=e,hM}var dM={},QZ;function LLe(){if(QZ)return dM;QZ=1,Object.defineProperty(dM,"__esModule",{value:!0}),dM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return dM.default=e,dM}var pM={},eJ;function ULe(){if(eJ)return pM;eJ=1,Object.defineProperty(pM,"__esModule",{value:!0}),pM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return pM.default=e,pM}var mM={},tJ;function BLe(){if(tJ)return mM;tJ=1,Object.defineProperty(mM,"__esModule",{value:!0}),mM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return mM.default=e,mM}var gM={},nJ;function FLe(){if(nJ)return gM;nJ=1,Object.defineProperty(gM,"__esModule",{value:!0}),gM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},e=n;return gM.default=e,gM}var _M={},rJ;function zLe(){if(rJ)return _M;rJ=1,Object.defineProperty(_M,"__esModule",{value:!0}),_M.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},e=n;return _M.default=e,_M}var vM={},iJ;function jLe(){if(iJ)return vM;iJ=1,Object.defineProperty(vM,"__esModule",{value:!0}),vM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return vM.default=e,vM}var yM={},sJ;function HLe(){if(sJ)return yM;sJ=1,Object.defineProperty(yM,"__esModule",{value:!0}),yM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return yM.default=e,yM}var bM={},aJ;function qLe(){if(aJ)return bM;aJ=1,Object.defineProperty(bM,"__esModule",{value:!0}),bM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return bM.default=e,bM}var SM={},oJ;function VLe(){if(oJ)return SM;oJ=1,Object.defineProperty(SM,"__esModule",{value:!0}),SM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return SM.default=e,SM}var EM={},lJ;function GLe(){if(lJ)return EM;lJ=1,Object.defineProperty(EM,"__esModule",{value:!0}),EM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},e=n;return EM.default=e,EM}var xM={},cJ;function $Le(){if(cJ)return xM;cJ=1,Object.defineProperty(xM,"__esModule",{value:!0}),xM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return xM.default=e,xM}var TM={},uJ;function WLe(){if(uJ)return TM;uJ=1,Object.defineProperty(TM,"__esModule",{value:!0}),TM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},e=n;return TM.default=e,TM}var wM={},fJ;function YLe(){if(fJ)return wM;fJ=1,Object.defineProperty(wM,"__esModule",{value:!0}),wM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},e=n;return wM.default=e,wM}var RM={},hJ;function XLe(){if(hJ)return RM;hJ=1,Object.defineProperty(RM,"__esModule",{value:!0}),RM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return RM.default=e,RM}var dJ;function KLe(){if(dJ)return jC;dJ=1,Object.defineProperty(jC,"__esModule",{value:!0}),jC.default=void 0;var n=le(fLe()),e=le(hLe()),t=le(dLe()),r=le(pLe()),i=le(mLe()),s=le(gLe()),a=le(_Le()),o=le(vLe()),l=le(yLe()),c=le(bLe()),u=le(SLe()),f=le(ELe()),h=le(xLe()),g=le(TLe()),p=le(wLe()),_=le(RLe()),y=le(ALe()),v=le(CLe()),x=le(MLe()),E=le(OLe()),M=le(kLe()),k=le(ILe()),N=le(NLe()),I=le(PLe()),D=le(DLe()),V=le(LLe()),G=le(ULe()),J=le(BLe()),B=le(FLe()),$=le(zLe()),U=le(jLe()),Q=le(HLe()),W=le(qLe()),q=le(VLe()),Y=le(GLe()),ae=le($Le()),Z=le(WLe()),K=le(YLe()),ne=le(XLe());function le(Me){return Me&&Me.__esModule?Me:{default:Me}}var ce=[["doc-abstract",n.default],["doc-acknowledgments",e.default],["doc-afterword",t.default],["doc-appendix",r.default],["doc-backlink",i.default],["doc-biblioentry",s.default],["doc-bibliography",a.default],["doc-biblioref",o.default],["doc-chapter",l.default],["doc-colophon",c.default],["doc-conclusion",u.default],["doc-cover",f.default],["doc-credit",h.default],["doc-credits",g.default],["doc-dedication",p.default],["doc-endnote",_.default],["doc-endnotes",y.default],["doc-epigraph",v.default],["doc-epilogue",x.default],["doc-errata",E.default],["doc-example",M.default],["doc-footnote",k.default],["doc-foreword",N.default],["doc-glossary",I.default],["doc-glossref",D.default],["doc-index",V.default],["doc-introduction",G.default],["doc-noteref",J.default],["doc-notice",B.default],["doc-pagebreak",$.default],["doc-pagelist",U.default],["doc-part",Q.default],["doc-preface",W.default],["doc-prologue",q.default],["doc-pullquote",Y.default],["doc-qna",ae.default],["doc-subtitle",Z.default],["doc-tip",K.default],["doc-toc",ne.default]],de=ce;return jC.default=de,jC}var AM={},CM={},pJ;function ZLe(){if(pJ)return CM;pJ=1,Object.defineProperty(CM,"__esModule",{value:!0}),CM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},e=n;return CM.default=e,CM}var MM={},mJ;function JLe(){if(mJ)return MM;mJ=1,Object.defineProperty(MM,"__esModule",{value:!0}),MM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},e=n;return MM.default=e,MM}var OM={},gJ;function QLe(){if(gJ)return OM;gJ=1,Object.defineProperty(OM,"__esModule",{value:!0}),OM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},e=n;return OM.default=e,OM}var _J;function e4e(){if(_J)return AM;_J=1,Object.defineProperty(AM,"__esModule",{value:!0}),AM.default=void 0;var n=r(ZLe()),e=r(JLe()),t=r(QLe());function r(a){return a&&a.__esModule?a:{default:a}}var i=[["graphics-document",n.default],["graphics-object",e.default],["graphics-symbol",t.default]],s=i;return AM.default=s,AM}var vJ;function nH(){if(vJ)return ZR;vJ=1,Object.defineProperty(ZR,"__esModule",{value:!0}),ZR.default=void 0;var n=s(PPe()),e=s(uLe()),t=s(KLe()),r=s(e4e()),i=s(Ck());function s(v){return v&&v.__esModule?v:{default:v}}function a(v,x,E){return x in v?Object.defineProperty(v,x,{value:E,enumerable:!0,configurable:!0,writable:!0}):v[x]=E,v}function o(v,x){var E=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!E){if(Array.isArray(v)||(E=u(v))||x){E&&(v=E);var M=0,k=function(){};return{s:k,n:function(){return M>=v.length?{done:!0}:{done:!1,value:v[M++]}},e:function(G){throw G},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var N=!0,I=!1,D;return{s:function(){E=E.call(v)},n:function(){var G=E.next();return N=G.done,G},e:function(G){I=!0,D=G},f:function(){try{!N&&E.return!=null&&E.return()}finally{if(I)throw D}}}}function l(v,x){return g(v)||h(v,x)||u(v,x)||c()}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u(v,x){if(v){if(typeof v=="string")return f(v,x);var E=Object.prototype.toString.call(v).slice(8,-1);if(E==="Object"&&v.constructor&&(E=v.constructor.name),E==="Map"||E==="Set")return Array.from(v);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return f(v,x)}}function f(v,x){(x==null||x>v.length)&&(x=v.length);for(var E=0,M=new Array(x);E<x;E++)M[E]=v[E];return M}function h(v,x){var E=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(E!=null){var M=[],k=!0,N=!1,I,D;try{for(E=E.call(v);!(k=(I=E.next()).done)&&(M.push(I.value),!(x&&M.length===x));k=!0);}catch(V){N=!0,D=V}finally{try{!k&&E.return!=null&&E.return()}finally{if(N)throw D}}return M}}function g(v){if(Array.isArray(v))return v}var p=[].concat(n.default,e.default,t.default,r.default);p.forEach(function(v){var x=l(v,2),E=x[1],M=o(E.superClass),k;try{for(M.s();!(k=M.n()).done;){var N=k.value,I=o(N),D;try{var V=function(){var J=D.value,B=p.find(function(q){var Y=l(q,1),ae=Y[0];return ae===J});if(B)for(var $=B[1],U=0,Q=Object.keys($.props);U<Q.length;U++){var W=Q[U];Object.prototype.hasOwnProperty.call(E.props,W)||Object.assign(E.props,a({},W,$.props[W]))}};for(I.s();!(D=I.n()).done;)V()}catch(G){I.e(G)}finally{I.f()}}}catch(G){M.e(G)}finally{M.f()}});var _={entries:function(){return p},forEach:function(x){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,M=o(p),k;try{for(M.s();!(k=M.n()).done;){var N=l(k.value,2),I=N[0],D=N[1];x.call(E,D,I,p)}}catch(V){M.e(V)}finally{M.f()}},get:function(x){var E=p.find(function(M){return M[0]===x});return E&&E[1]},has:function(x){return!!_.get(x)},keys:function(){return p.map(function(x){var E=l(x,1),M=E[0];return M})},values:function(){return p.map(function(x){var E=l(x,2),M=E[1];return M})}},y=(0,i.default)(_,_.entries());return ZR.default=y,ZR}var kM={},IB={},yJ;function t4e(){if(yJ)return IB;yJ=1;var n=Object.prototype.hasOwnProperty;function e(t,r){var i,s;if(t===r)return!0;if(t&&r&&(i=t.constructor)===r.constructor){if(i===Date)return t.getTime()===r.getTime();if(i===RegExp)return t.toString()===r.toString();if(i===Array){if((s=t.length)===r.length)for(;s--&&e(t[s],r[s]););return s===-1}if(!i||typeof t=="object"){s=0;for(i in t)if(n.call(t,i)&&++s&&!n.call(r,i)||!(i in r)||!e(t[i],r[i]))return!1;return Object.keys(r).length===s}}return t!==t&&r!==r}return IB.dequal=e,IB}var bJ;function n4e(){if(bJ)return kM;bJ=1,Object.defineProperty(kM,"__esModule",{value:!0}),kM.default=void 0;var n=t4e(),e=r(Ck()),t=r(nH());function r(k){return k&&k.__esModule?k:{default:k}}function i(k,N){return o(k)||a(k,N)||c(k,N)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a(k,N){var I=k==null?null:typeof Symbol<"u"&&k[Symbol.iterator]||k["@@iterator"];if(I!=null){var D=[],V=!0,G=!1,J,B;try{for(I=I.call(k);!(V=(J=I.next()).done)&&(D.push(J.value),!(N&&D.length===N));V=!0);}catch($){G=!0,B=$}finally{try{!V&&I.return!=null&&I.return()}finally{if(G)throw B}}return D}}function o(k){if(Array.isArray(k))return k}function l(k,N){var I=typeof Symbol<"u"&&k[Symbol.iterator]||k["@@iterator"];if(!I){if(Array.isArray(k)||(I=c(k))||N){I&&(k=I);var D=0,V=function(){};return{s:V,n:function(){return D>=k.length?{done:!0}:{done:!1,value:k[D++]}},e:function(U){throw U},f:V}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=!0,J=!1,B;return{s:function(){I=I.call(k)},n:function(){var U=I.next();return G=U.done,U},e:function(U){J=!0,B=U},f:function(){try{!G&&I.return!=null&&I.return()}finally{if(J)throw B}}}}function c(k,N){if(k){if(typeof k=="string")return u(k,N);var I=Object.prototype.toString.call(k).slice(8,-1);if(I==="Object"&&k.constructor&&(I=k.constructor.name),I==="Map"||I==="Set")return Array.from(k);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return u(k,N)}}function u(k,N){(N==null||N>k.length)&&(N=k.length);for(var I=0,D=new Array(N);I<N;I++)D[I]=k[I];return D}for(var f=[],h=t.default.keys(),g=0;g<h.length;g++){var p=h[g],_=t.default.get(p);if(_)for(var y=[].concat(_.baseConcepts,_.relatedConcepts),v=0;v<y.length;v++){var x=y[v];x.module==="HTML"&&(function(){var k=x.concept;if(k){var N=f.find(function(G){return(0,n.dequal)(G,k)}),I;N?I=N[1]:I=[];for(var D=!0,V=0;V<I.length;V++)if(I[V]===p){D=!1;break}D&&I.push(p),f.push([k,I])}})()}}var E={entries:function(){return f},forEach:function(N){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,D=l(f),V;try{for(D.s();!(V=D.n()).done;){var G=i(V.value,2),J=G[0],B=G[1];N.call(I,B,J,f)}}catch($){D.e($)}finally{D.f()}},get:function(N){var I=f.find(function(D){return N.name===D[0].name&&(0,n.dequal)(N.attributes,D[0].attributes)});return I&&I[1]},has:function(N){return!!E.get(N)},keys:function(){return f.map(function(N){var I=i(N,1),D=I[0];return D})},values:function(){return f.map(function(N){var I=i(N,2),D=I[1];return D})}},M=(0,e.default)(E,E.entries());return kM.default=M,kM}var IM={},SJ;function r4e(){if(SJ)return IM;SJ=1,Object.defineProperty(IM,"__esModule",{value:!0}),IM.default=void 0;var n=t(Ck()),e=t(nH());function t(N){return N&&N.__esModule?N:{default:N}}function r(N,I){return a(N)||s(N,I)||l(N,I)||i()}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s(N,I){var D=N==null?null:typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(D!=null){var V=[],G=!0,J=!1,B,$;try{for(D=D.call(N);!(G=(B=D.next()).done)&&(V.push(B.value),!(I&&V.length===I));G=!0);}catch(U){J=!0,$=U}finally{try{!G&&D.return!=null&&D.return()}finally{if(J)throw $}}return V}}function a(N){if(Array.isArray(N))return N}function o(N,I){var D=typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(!D){if(Array.isArray(N)||(D=l(N))||I){D&&(N=D);var V=0,G=function(){};return{s:G,n:function(){return V>=N.length?{done:!0}:{done:!1,value:N[V++]}},e:function(Q){throw Q},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var J=!0,B=!1,$;return{s:function(){D=D.call(N)},n:function(){var Q=D.next();return J=Q.done,Q},e:function(Q){B=!0,$=Q},f:function(){try{!J&&D.return!=null&&D.return()}finally{if(B)throw $}}}}function l(N,I){if(N){if(typeof N=="string")return c(N,I);var D=Object.prototype.toString.call(N).slice(8,-1);if(D==="Object"&&N.constructor&&(D=N.constructor.name),D==="Map"||D==="Set")return Array.from(N);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return c(N,I)}}function c(N,I){(I==null||I>N.length)&&(I=N.length);for(var D=0,V=new Array(I);D<I;D++)V[D]=N[D];return V}for(var u=[],f=e.default.keys(),h=0;h<f.length;h++){var g=f[h],p=e.default.get(g),_=[];if(p){for(var y=[].concat(p.baseConcepts,p.relatedConcepts),v=0;v<y.length;v++){var x=y[v];if(x.module==="HTML"){var E=x.concept;E!=null&&_.push(E)}}_.length>0&&u.push([g,_])}}var M={entries:function(){return u},forEach:function(I){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,V=o(u),G;try{for(V.s();!(G=V.n()).done;){var J=r(G.value,2),B=J[0],$=J[1];I.call(D,$,B,u)}}catch(U){V.e(U)}finally{V.f()}},get:function(I){var D=u.find(function(V){return V[0]===I});return D&&D[1]},has:function(I){return!!M.get(I)},keys:function(){return u.map(function(I){var D=r(I,1),V=D[0];return V})},values:function(){return u.map(function(I){var D=r(I,2),V=D[1];return V})}},k=(0,n.default)(M,M.entries());return IM.default=k,IM}var EJ;function i4e(){if(EJ)return Eg;EJ=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.roles=Eg.roleElements=Eg.elementRoles=Eg.dom=Eg.aria=void 0;var n=s(bPe()),e=s(SPe()),t=s(nH()),r=s(n4e()),i=s(r4e());function s(f){return f&&f.__esModule?f:{default:f}}var a=n.default;Eg.aria=a;var o=e.default;Eg.dom=o;var l=t.default;Eg.roles=l;var c=r.default;Eg.elementRoles=c;var u=i.default;return Eg.roleElements=u,Eg}var b0=i4e(),NB={exports:{}},xJ;function s4e(){return xJ||(xJ=1,(function(n){var e=(function(){var t=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(l,c){if(!s[l]){s[l]={};for(var u=0;u<l.length;u++)s[l][l.charAt(u)]=u}return s[l][c]}var o={compressToBase64:function(l){if(l==null)return"";var c=o._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:o._decompress(l.length,32,function(c){return a(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":o._compress(l,15,function(c){return t(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:o._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=o.compress(l),u=new Uint8Array(c.length*2),f=0,h=c.length;f<h;f++){var g=c.charCodeAt(f);u[f*2]=g>>>8,u[f*2+1]=g%256}return u},decompressFromUint8Array:function(l){if(l==null)return o.decompress(l);for(var c=new Array(l.length/2),u=0,f=c.length;u<f;u++)c[u]=l[u*2]*256+l[u*2+1];var h=[];return c.forEach(function(g){h.push(t(g))}),o.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":o._compress(l,6,function(c){return i.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),o._decompress(l.length,32,function(c){return a(i,l.charAt(c))}))},compress:function(l){return o._compress(l,16,function(c){return t(c)})},_compress:function(l,c,u){if(l==null)return"";var f,h,g={},p={},_="",y="",v="",x=2,E=3,M=2,k=[],N=0,I=0,D;for(D=0;D<l.length;D+=1)if(_=l.charAt(D),Object.prototype.hasOwnProperty.call(g,_)||(g[_]=E++,p[_]=!0),y=v+_,Object.prototype.hasOwnProperty.call(g,y))v=y;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(f=0;f<M;f++)N=N<<1,I==c-1?(I=0,k.push(u(N)),N=0):I++;for(h=v.charCodeAt(0),f=0;f<8;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1}else{for(h=1,f=0;f<M;f++)N=N<<1|h,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=0;for(h=v.charCodeAt(0),f=0;f<16;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1}x--,x==0&&(x=Math.pow(2,M),M++),delete p[v]}else for(h=g[v],f=0;f<M;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1;x--,x==0&&(x=Math.pow(2,M),M++),g[y]=E++,v=String(_)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(f=0;f<M;f++)N=N<<1,I==c-1?(I=0,k.push(u(N)),N=0):I++;for(h=v.charCodeAt(0),f=0;f<8;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1}else{for(h=1,f=0;f<M;f++)N=N<<1|h,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=0;for(h=v.charCodeAt(0),f=0;f<16;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1}x--,x==0&&(x=Math.pow(2,M),M++),delete p[v]}else for(h=g[v],f=0;f<M;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1;x--,x==0&&(x=Math.pow(2,M),M++)}for(h=2,f=0;f<M;f++)N=N<<1|h&1,I==c-1?(I=0,k.push(u(N)),N=0):I++,h=h>>1;for(;;)if(N=N<<1,I==c-1){k.push(u(N));break}else I++;return k.join("")},decompress:function(l){return l==null?"":l==""?null:o._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var f=[],h=4,g=4,p=3,_="",y=[],v,x,E,M,k,N,I,D={val:u(0),position:c,index:1};for(v=0;v<3;v+=1)f[v]=v;for(E=0,k=Math.pow(2,2),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;switch(E){case 0:for(E=0,k=Math.pow(2,8),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;I=t(E);break;case 1:for(E=0,k=Math.pow(2,16),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;I=t(E);break;case 2:return""}for(f[3]=I,x=I,y.push(I);;){if(D.index>l)return"";for(E=0,k=Math.pow(2,p),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;switch(I=E){case 0:for(E=0,k=Math.pow(2,8),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;f[g++]=t(E),I=g-1,h--;break;case 1:for(E=0,k=Math.pow(2,16),N=1;N!=k;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;f[g++]=t(E),I=g-1,h--;break;case 2:return y.join("")}if(h==0&&(h=Math.pow(2,p),p++),f[I])_=f[I];else if(I===g)_=x+x.charAt(0);else return null;y.push(_),f[g++]=x+_.charAt(0),h--,x=_,h==0&&(h=Math.pow(2,p),p++)}}};return o})();n!=null?n.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(NB)),NB.exports}var a4e=s4e();const o4e=Bh(a4e);var Z7={};function nue(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const l4e=(n,e,t,r,i,s,a)=>{const o=r+t.indent,l=t.colors;return n.map(c=>{const u=e[c];let f=a(u,t,o,i,s);return typeof u!="string"&&(f.indexOf(`
`)!==-1&&(f=t.spacingOuter+o+f+t.spacingOuter+r),f="{"+f+"}"),t.spacingInner+r+l.prop.open+c+l.prop.close+"="+l.value.open+f+l.value.close}).join("")},c4e=3,u4e=(n,e,t,r,i,s)=>n.map(a=>{const o=typeof a=="string"?rue(a,e):s(a,e,t,r,i);return o===""&&typeof a=="object"&&a!==null&&a.nodeType!==c4e?"":e.spacingOuter+t+o}).join(""),rue=(n,e)=>{const t=e.colors.content;return t.open+nue(n)+t.close},f4e=(n,e)=>{const t=e.colors.comment;return t.open+"<!--"+nue(n)+"-->"+t.close},h4e=(n,e,t,r,i)=>{const s=r.colors.tag;return s.open+"<"+n+(e&&s.close+e+r.spacingOuter+i+s.open)+(t?">"+s.close+t+r.spacingOuter+i+s.open+"</"+n:(e&&!r.min?"":" ")+"/")+">"+s.close},d4e=(n,e)=>{const t=e.colors.tag;return t.open+"<"+n+t.close+" …"+t.open+" />"+t.close},p4e=1,iue=3,sue=8,aue=11,m4e=/^((HTML|SVG)\w*)?Element$/,oue=n=>{const{tagName:e}=n;return!!(typeof e=="string"&&e.includes("-")||typeof n.hasAttribute=="function"&&n.hasAttribute("is"))},g4e=n=>{const e=n.constructor.name,{nodeType:t}=n;return t===p4e&&(m4e.test(e)||oue(n))||t===iue&&e==="Text"||t===sue&&e==="Comment"||t===aue&&e==="DocumentFragment"};function _4e(n){return n.nodeType===iue}function v4e(n){return n.nodeType===sue}function PB(n){return n.nodeType===aue}function y4e(n){return{test:e=>{var t;return((e==null||(t=e.constructor)==null?void 0:t.name)||oue(e))&&g4e(e)},serialize:(e,t,r,i,s,a)=>{if(_4e(e))return rue(e.data,t);if(v4e(e))return f4e(e.data,t);const o=PB(e)?"DocumentFragment":e.tagName.toLowerCase();return++i>t.maxDepth?d4e(o,t):h4e(o,l4e(PB(e)?[]:Array.from(e.attributes).map(l=>l.name).sort(),PB(e)?{}:Array.from(e.attributes).reduce((l,c)=>(l[c.name]=c.value,l),{}),t,r+t.indent,i,s,a),u4e(Array.prototype.slice.call(e.childNodes||e.children).filter(n),t,r+t.indent,i,s,a),t,r)}}}let lue=null,rH=null,iH=null;try{const n=kh&&kh.require;rH=n.call(kh,"fs").readFileSync,iH=n.call(kh,"@babel/code-frame").codeFrameColumns,lue=n.call(kh,"picocolors")}catch{}function b4e(n){const e=n.indexOf("(")+1,t=n.indexOf(")"),r=n.slice(e,t),i=r.split(":"),[s,a,o]=[i[0],parseInt(i[1],10),parseInt(i[2],10)];let l="";try{l=rH(s,"utf-8")}catch{return""}const c=iH(l,{start:{line:a,column:o}},{highlightCode:!0,linesBelow:0});return lue.dim(r)+`
`+c+`
`}function S4e(){if(!rH||!iH)return"";const e=new Error().stack.split(`
`).slice(1).find(t=>!t.includes("node_modules/"));return b4e(e)}const cue=3;function DB(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function sH(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function E4e(n){if(n.defaultView)return n.defaultView;if(n.ownerDocument&&n.ownerDocument.defaultView)return n.ownerDocument.defaultView;if(n.window)return n.window;throw n.ownerDocument&&n.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):n.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(n)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof n.debug=="function"&&typeof n.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof n+".")}function yb(n){if(!n||typeof n.querySelector!="function"||typeof n.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+e(n)+".");function e(t){return typeof t=="object"?t===null?"null":t.constructor.name:typeof t}}const x4e=()=>{if(typeof Tl>"u")return!1;let n;try{var e;const t=(e=Z7)==null?void 0:e.COLORS;t&&(n=JSON.parse(t))}catch{}return typeof n=="boolean"?n:Tl.versions!==void 0&&Tl.versions.node!==void 0},{DOMCollection:T4e}=Wce.plugins,w4e=1,R4e=8;function A4e(n){return n.nodeType!==R4e&&(n.nodeType!==w4e||!n.matches(Ja().defaultIgnore))}function WD(n,e,t){if(t===void 0&&(t={}),n||(n=sH().body),typeof e!="number"&&(e=typeof Tl<"u"&&typeof Z7<"u"&&Z7.DEBUG_PRINT_LIMIT||7e3),e===0)return"";n.documentElement&&(n=n.documentElement);let r=typeof n;if(r==="object"?r=n.constructor.name:n={},!("outerHTML"in n))throw new TypeError("Expected an element or document but got "+r);const{filterNode:i=A4e,...s}=t,a=Wce.format(n,{plugins:[y4e(i),T4e],printFunctionName:!1,highlight:x4e(),...s});return e!==void 0&&n.outerHTML.length>e?a.slice(0,e)+"...":a}const TJ=function(){const n=S4e();console.log(n?WD(...arguments)+`

`+n:WD(...arguments))};let YD={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:n=>n(),unstable_advanceTimersWrapper:n=>n(),eventWrapper:n=>n(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(n,e){const t=WD(e),r=new Error([n,"Ignored nodes: comments, "+YD.defaultIgnore+`
`+t].filter(Boolean).join(`

`));return r.name="TestingLibraryElementError",r},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function C4e(n){try{return YD._disableExpensiveErrorDiagnostics=!0,n()}finally{YD._disableExpensiveErrorDiagnostics=!1}}function Ja(){return YD}const M4e=["button","meter","output","progress","select","textarea","input"];function uue(n){return M4e.includes(n.nodeName.toLowerCase())?"":n.nodeType===cue?n.textContent:Array.from(n.childNodes).map(e=>uue(e)).join("")}function J7(n){let e;return n.tagName.toLowerCase()==="label"?e=uue(n):e=n.value||n.textContent,e}function fue(n){if(n.labels!==void 0){var e;return(e=n.labels)!=null?e:[]}if(!O4e(n))return[];const t=n.ownerDocument.querySelectorAll("label");return Array.from(t).filter(r=>r.control===n)}function O4e(n){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(n.tagName)||n.tagName==="INPUT"&&n.getAttribute("type")!=="hidden"}function hue(n,e,t){let{selector:r="*"}=t===void 0?{}:t;const i=e.getAttribute("aria-labelledby"),s=i?i.split(" "):[];return s.length?s.map(a=>{const o=n.querySelector('[id="'+a+'"]');return o?{content:J7(o),formControl:null}:{content:"",formControl:null}}):Array.from(fue(e)).map(a=>{const o=J7(a),c=Array.from(a.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter(u=>u.matches(r))[0];return{content:o,formControl:c}})}function due(n){if(n==null)throw new Error("It looks like "+n+" was passed instead of a matcher. Did you do something like getByText("+n+")?")}function Zw(n,e,t,r){if(typeof n!="string")return!1;due(t);const i=r(n);return typeof t=="string"||typeof t=="number"?i.toLowerCase().includes(t.toString().toLowerCase()):typeof t=="function"?t(i,e):mue(t,i)}function eb(n,e,t,r){if(typeof n!="string")return!1;due(t);const i=r(n);return t instanceof Function?t(i,e):t instanceof RegExp?mue(t,i):i===String(t)}function pue(n){let{trim:e=!0,collapseWhitespace:t=!0}=n===void 0?{}:n;return r=>{let i=r;return i=e?i.trim():i,i=t?i.replace(/\s+/g," "):i,i}}function ex(n){let{trim:e,collapseWhitespace:t,normalizer:r}=n;if(!r)return pue({trim:e,collapseWhitespace:t});if(typeof e<"u"||typeof t<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return r}function mue(n,e){const t=n.test(e);return n.global&&n.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),n.lastIndex=0),t}function aU(n){return n.matches("input[type=submit], input[type=button], input[type=reset]")?n.value:Array.from(n.childNodes).filter(e=>e.nodeType===cue&&!!e.textContent).map(e=>e.textContent).join("")}const k4e=I4e(b0.elementRoles);function gue(n){return n.hidden===!0||n.getAttribute("aria-hidden")==="true"||n.ownerDocument.defaultView.getComputedStyle(n).display==="none"}function aH(n,e){e===void 0&&(e={});const{isSubtreeInaccessible:t=gue}=e;if(n.ownerDocument.defaultView.getComputedStyle(n).visibility==="hidden")return!0;let i=n;for(;i;){if(t(i))return!0;i=i.parentElement}return!1}function oH(n){for(const{match:e,roles:t}of k4e)if(e(n))return[...t];return[]}function I4e(n){function e(a){let{name:o,attributes:l}=a;return""+o+l.map(c=>{let{name:u,value:f,constraints:h=[]}=c;const g=h.indexOf("undefined")!==-1,p=h.indexOf("set")!==-1;return typeof f<"u"?"["+u+'="'+f+'"]':g?":not(["+u+"])":p?"["+u+"]:not(["+u+'=""])':"["+u+"]"}).join("")}function t(a){let{attributes:o=[]}=a;return o.length}function r(a,o){let{specificity:l}=a,{specificity:c}=o;return c-l}function i(a){let{attributes:o=[]}=a;const l=o.findIndex(u=>u.value&&u.name==="type"&&u.value==="text");l>=0&&(o=[...o.slice(0,l),...o.slice(l+1)]);const c=e({...a,attributes:o});return u=>l>=0&&u.type!=="text"?!1:u.matches(c)}let s=[];for(const[a,o]of n.entries())s=[...s,{match:i(a),roles:Array.from(o),specificity:t(a)}];return s.sort(r)}function N4e(n,e){let{hidden:t=!1}=e===void 0?{}:e;function r(i){return[i,...Array.from(i.children).reduce((s,a)=>[...s,...r(a)],[])]}return r(n).filter(i=>t===!1?aH(i)===!1:!0).reduce((i,s)=>{let a=[];return s.hasAttribute("role")?a=s.getAttribute("role").split(" ").slice(0,1):a=oH(s),a.reduce((o,l)=>Array.isArray(o[l])?{...o,[l]:[...o[l],s]}:{...o,[l]:[s]},i)},{})}function P4e(n,e){let{hidden:t,includeDescription:r}=e;const i=N4e(n,{hidden:t});return Object.entries(i).filter(s=>{let[a]=s;return a!=="generic"}).map(s=>{let[a,o]=s;const l="-".repeat(50),c=o.map(u=>{const f='Name "'+tH(u,{computedStyleSupportsPseudoElements:Ja().computedStyleSupportsPseudoElements})+`":
`,h=WD(u.cloneNode(!1));if(r){const g='Description "'+tue(u,{computedStyleSupportsPseudoElements:Ja().computedStyleSupportsPseudoElements})+`":
`;return""+f+g+h}return""+f+h}).join(`

`);return a+`:

`+c+`

`+l}).join(`
`)}function D4e(n){return n.tagName==="OPTION"?n.selected:Mk(n,"aria-selected")}function L4e(n){return n.getAttribute("aria-busy")==="true"}function U4e(n){if(!("indeterminate"in n&&n.indeterminate))return"checked"in n?n.checked:Mk(n,"aria-checked")}function B4e(n){return Mk(n,"aria-pressed")}function F4e(n){var e,t;return(e=(t=Mk(n,"aria-current"))!=null?t:n.getAttribute("aria-current"))!=null?e:!1}function z4e(n){return Mk(n,"aria-expanded")}function Mk(n,e){const t=n.getAttribute(e);if(t==="true")return!0;if(t==="false")return!1}function j4e(n){const e={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return n.getAttribute("aria-level")&&Number(n.getAttribute("aria-level"))||e[n.tagName]}function H4e(n){const e=n.getAttribute("aria-valuenow");return e===null?void 0:+e}function q4e(n){const e=n.getAttribute("aria-valuemax");return e===null?void 0:+e}function V4e(n){const e=n.getAttribute("aria-valuemin");return e===null?void 0:+e}function G4e(n){const e=n.getAttribute("aria-valuetext");return e===null?void 0:e}const wJ=pue();function $4e(n){return n.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function RJ(n){return new RegExp($4e(n.toLowerCase()),"i")}function Gb(n,e,t,r){let{variant:i,name:s}=r,a="";const o={},l=[["Role","TestId"].includes(n)?t:RJ(t)];s&&(o.name=RJ(s)),n==="Role"&&aH(e)&&(o.hidden=!0,a=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(o).length>0&&l.push(o);const c=i+"By"+n;return{queryName:n,queryMethod:c,queryArgs:l,variant:i,warning:a,toString(){a&&console.warn(a);let[u,f]=l;return u=typeof u=="string"?"'"+u+"'":u,f=f?", { "+Object.entries(f).map(h=>{let[g,p]=h;return g+": "+p}).join(", ")+" }":"",c+"("+u+f+")"}}}function $b(n,e,t){return t&&!0}function Q7(n,e,t){var r,i;if(e===void 0&&(e="get"),n.matches(Ja().defaultIgnore))return;const s=(r=n.getAttribute("role"))!=null?r:(i=oH(n))==null?void 0:i[0];if(s!=="generic"&&$b("Role",t,s))return Gb("Role",n,s,{variant:e,name:tH(n,{computedStyleSupportsPseudoElements:Ja().computedStyleSupportsPseudoElements})});const a=hue(document,n).map(h=>h.content).join(" ");if($b("LabelText",t,a))return Gb("LabelText",n,a,{variant:e});const o=n.getAttribute("placeholder");if($b("PlaceholderText",t,o))return Gb("PlaceholderText",n,o,{variant:e});const l=wJ(aU(n));if($b("Text",t,l))return Gb("Text",n,l,{variant:e});if($b("DisplayValue",t,n.value))return Gb("DisplayValue",n,wJ(n.value),{variant:e});const c=n.getAttribute("alt");if($b("AltText",t,c))return Gb("AltText",n,c,{variant:e});const u=n.getAttribute("title");if($b("Title",t,u))return Gb("Title",n,u,{variant:e});const f=n.getAttribute(Ja().testIdAttribute);if($b("TestId",t,f))return Gb("TestId",n,f,{variant:e})}function KI(n,e){n.stack=e.stack.replace(e.message,n.message)}function W4e(n,e){let{container:t=sH(),timeout:r=Ja().asyncUtilTimeout,showOriginalStackTrace:i=Ja().showOriginalStackTrace,stackTraceError:s,interval:a=50,onTimeout:o=c=>(Object.defineProperty(c,"message",{value:Ja().getElementError(c.message,t).message}),c),mutationObserverOptions:l={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=e;if(typeof n!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(c,u)=>{let f,h,g,p=!1,_="idle";const y=setTimeout(k,r),v=DB();if(v){const{unstable_advanceTimersWrapper:N}=Ja();for(M();!p;){if(!DB()){const I=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");i||KI(I,s),u(I);return}if(await N(async()=>{jest.advanceTimersByTime(a)}),p)break;M()}}else{try{yb(t)}catch(I){u(I);return}h=setInterval(E,a);const{MutationObserver:N}=E4e(t);g=new N(E),g.observe(t,l),M()}function x(N,I){p=!0,clearTimeout(y),v||(clearInterval(h),g.disconnect()),N?u(N):c(I)}function E(){if(DB()){const N=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return i||KI(N,s),u(N)}else return M()}function M(){if(_!=="pending")try{const N=C4e(n);typeof N?.then=="function"?(_="pending",N.then(I=>{_="resolved",x(null,I)},I=>{_="rejected",f=I})):x(null,N)}catch(N){f=N}}function k(){let N;f?(N=f,!i&&N.name==="TestingLibraryElementError"&&KI(N,s)):(N=new Error("Timed out in waitFor."),i||KI(N,s)),x(o(N),null)}})}function Y4e(n,e){const t=new Error("STACK_TRACE_MESSAGE");return Ja().asyncWrapper(()=>W4e(n,{stackTraceError:t,...e}))}function _ue(n,e){return Ja().getElementError(n,e)}function X4e(n,e){return _ue(n+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",e)}function oU(n,e,t,r){let{exact:i=!0,collapseWhitespace:s,trim:a,normalizer:o}=r===void 0?{}:r;const l=i?eb:Zw,c=ex({collapseWhitespace:s,trim:a,normalizer:o});return Array.from(e.querySelectorAll("["+n+"]")).filter(u=>l(u.getAttribute(n),u,t,c))}function XD(n,e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const a=n(t,...i);if(a.length>1){const o=a.map(l=>_ue(null,l).message).join(`

`);throw X4e(e(t,...i)+`

Here are the matching elements:

`+o,t)}return a[0]||null}}function vue(n,e){return Ja().getElementError(`A better query is available, try this:
`+n.toString()+`
`,e)}function K4e(n,e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const a=n(t,...i);if(!a.length)throw Ja().getElementError(e(t,...i),t);return a}}function KD(n){return(e,t,r,i)=>Y4e(()=>n(e,t,r),{container:e,...i})}const DT=(n,e,t)=>function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];const o=n(r,...s),[{suggest:l=Ja().throwSuggestions}={}]=s.slice(-1);if(o&&l){const c=Q7(o,t);if(c&&!e.endsWith(c.queryName))throw vue(c.toString(),r)}return o},H0=(n,e,t)=>function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];const o=n(r,...s),[{suggest:l=Ja().throwSuggestions}={}]=s.slice(-1);if(o.length&&l){const c=[...new Set(o.map(u=>{var f;return(f=Q7(u,t))==null?void 0:f.toString()}))];if(c.length===1&&!e.endsWith(Q7(o[0],t).queryName))throw vue(c[0],r)}return o};function tx(n,e,t){const r=DT(XD(n,e),n.name,"query"),i=K4e(n,t),s=XD(i,e),a=DT(s,n.name,"get"),o=H0(i,n.name.replace("query","get"),"getAll"),l=KD(H0(i,n.name,"findAll")),c=KD(DT(s,n.name,"find"));return[r,o,a,l,c]}function Z4e(n){return Array.from(n.querySelectorAll("label,input")).map(e=>({node:e,textToMatch:J7(e)})).filter(e=>{let{textToMatch:t}=e;return t!==null})}const J4e=function(n,e,t){let{exact:r=!0,trim:i,collapseWhitespace:s,normalizer:a}=t===void 0?{}:t;const o=r?eb:Zw,l=ex({collapseWhitespace:s,trim:i,normalizer:a});return Z4e(n).filter(u=>{let{node:f,textToMatch:h}=u;return o(h,f,e,l)}).map(u=>{let{node:f}=u;return f})},yO=function(n,e,t){let{selector:r="*",exact:i=!0,collapseWhitespace:s,trim:a,normalizer:o}=t===void 0?{}:t;yb(n);const l=i?eb:Zw,c=ex({collapseWhitespace:s,trim:a,normalizer:o}),u=Array.from(n.querySelectorAll("*")).filter(f=>fue(f).length||f.hasAttribute("aria-labelledby")).reduce((f,h)=>{const g=hue(n,h,{selector:r});g.filter(_=>!!_.formControl).forEach(_=>{l(_.content,_.formControl,e,c)&&_.formControl&&f.push(_.formControl)});const p=g.filter(_=>!!_.content).map(_=>_.content);return l(p.join(" "),h,e,c)&&f.push(h),p.length>1&&p.forEach((_,y)=>{l(_,h,e,c)&&f.push(h);const v=[...p];v.splice(y,1),v.length>1&&l(v.join(" "),h,e,c)&&f.push(h)}),f},[]).concat(oU("aria-label",n,e,{exact:i,normalizer:c}));return Array.from(new Set(u)).filter(f=>f.matches(r))},ME=function(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),i=2;i<t;i++)r[i-2]=arguments[i];const s=yO(n,e,...r);if(!s.length){const a=J4e(n,e,...r);if(a.length){const o=a.map(l=>Q4e(n,l)).filter(l=>!!l);throw o.length?Ja().getElementError(o.map(l=>"Found a label with the text of: "+e+", however the element associated with this label (<"+l+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+l+" />, you can use aria-label or aria-labelledby instead.").join(`

`),n):Ja().getElementError("Found a label with the text of: "+e+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,n)}else throw Ja().getElementError("Unable to find a label with the text of: "+e,n)}return s};function Q4e(n,e){const t=e.getAttribute("for");if(!t)return null;const r=n.querySelector('[id="'+t+'"]');return r?r.tagName.toLowerCase():null}const yue=(n,e)=>"Found multiple elements with the text of: "+e,eUe=DT(XD(yO,yue),yO.name,"query"),bue=XD(ME,yue),tUe=KD(H0(ME,ME.name,"findAll")),nUe=KD(DT(bue,ME.name,"find")),rUe=H0(ME,ME.name,"getAll"),iUe=DT(bue,ME.name,"get"),sUe=H0(yO,yO.name,"queryAll"),e9=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return yb(e[0]),oU("placeholder",...e)},aUe=(n,e)=>"Found multiple elements with the placeholder text of: "+e,oUe=(n,e)=>"Unable to find an element with the placeholder text of: "+e,lUe=H0(e9,e9.name,"queryAll"),[cUe,uUe,fUe,hUe,dUe]=tx(e9,aUe,oUe),t9=function(n,e,t){let{selector:r="*",exact:i=!0,collapseWhitespace:s,trim:a,ignore:o=Ja().defaultIgnore,normalizer:l}=t===void 0?{}:t;yb(n);const c=i?eb:Zw,u=ex({collapseWhitespace:s,trim:a,normalizer:l});let f=[];return typeof n.matches=="function"&&n.matches(r)&&(f=[n]),[...f,...Array.from(n.querySelectorAll(r))].filter(h=>!o||!h.matches(o)).filter(h=>c(aU(h),h,e,u))},pUe=(n,e)=>"Found multiple elements with the text: "+e,mUe=function(n,e,t){t===void 0&&(t={});const{collapseWhitespace:r,trim:i,normalizer:s,selector:a}=t,l=ex({collapseWhitespace:r,trim:i,normalizer:s})(e.toString()),c=l!==e.toString(),u=(a??"*")!=="*";return"Unable to find an element with the text: "+(c?l+" (normalized from '"+e+"')":e)+(u?", which matches selector '"+a+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},gUe=H0(t9,t9.name,"queryAll"),[_Ue,vUe,yUe,bUe,SUe]=tx(t9,pUe,mUe),n9=function(n,e,t){let{exact:r=!0,collapseWhitespace:i,trim:s,normalizer:a}=t===void 0?{}:t;yb(n);const o=r?eb:Zw,l=ex({collapseWhitespace:i,trim:s,normalizer:a});return Array.from(n.querySelectorAll("input,textarea,select")).filter(c=>c.tagName==="SELECT"?Array.from(c.options).filter(f=>f.selected).some(f=>o(aU(f),f,e,l)):o(c.value,c,e,l))},EUe=(n,e)=>"Found multiple elements with the display value: "+e+".",xUe=(n,e)=>"Unable to find an element with the display value: "+e+".",TUe=H0(n9,n9.name,"queryAll"),[wUe,RUe,AUe,CUe,MUe]=tx(n9,EUe,xUe),OUe=/^(img|input|area|.+-.+)$/i,r9=function(n,e,t){return t===void 0&&(t={}),yb(n),oU("alt",n,e,t).filter(r=>OUe.test(r.tagName))},kUe=(n,e)=>"Found multiple elements with the alt text: "+e,IUe=(n,e)=>"Unable to find an element with the alt text: "+e,NUe=H0(r9,r9.name,"queryAll"),[PUe,DUe,LUe,UUe,BUe]=tx(r9,kUe,IUe),FUe=n=>{var e;return n.tagName.toLowerCase()==="title"&&((e=n.parentElement)==null?void 0:e.tagName.toLowerCase())==="svg"},i9=function(n,e,t){let{exact:r=!0,collapseWhitespace:i,trim:s,normalizer:a}=t===void 0?{}:t;yb(n);const o=r?eb:Zw,l=ex({collapseWhitespace:i,trim:s,normalizer:a});return Array.from(n.querySelectorAll("[title], svg > title")).filter(c=>o(c.getAttribute("title"),c,e,l)||FUe(c)&&o(aU(c),c,e,l))},zUe=(n,e)=>"Found multiple elements with the title: "+e+".",jUe=(n,e)=>"Unable to find an element with the title: "+e+".",HUe=H0(i9,i9.name,"queryAll"),[qUe,VUe,GUe,$Ue,WUe]=tx(i9,zUe,jUe),s9=function(n,e,t){let{hidden:r=Ja().defaultHidden,name:i,description:s,queryFallbacks:a=!1,selected:o,busy:l,checked:c,pressed:u,current:f,level:h,expanded:g,value:{now:p,min:_,max:y,text:v}={}}=t===void 0?{}:t;if(yb(n),o!==void 0){var x;if(((x=b0.roles.get(e))==null?void 0:x.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+e+'".')}if(l!==void 0){var E;if(((E=b0.roles.get(e))==null?void 0:E.props["aria-busy"])===void 0)throw new Error('"aria-busy" is not supported on role "'+e+'".')}if(c!==void 0){var M;if(((M=b0.roles.get(e))==null?void 0:M.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+e+'".')}if(u!==void 0){var k;if(((k=b0.roles.get(e))==null?void 0:k.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+e+'".')}if(f!==void 0){var N;if(((N=b0.roles.get(e))==null?void 0:N.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+e+'".')}if(h!==void 0&&e!=="heading")throw new Error('Role "'+e+'" cannot have "level" property.');if(p!==void 0){var I;if(((I=b0.roles.get(e))==null?void 0:I.props["aria-valuenow"])===void 0)throw new Error('"aria-valuenow" is not supported on role "'+e+'".')}if(y!==void 0){var D;if(((D=b0.roles.get(e))==null?void 0:D.props["aria-valuemax"])===void 0)throw new Error('"aria-valuemax" is not supported on role "'+e+'".')}if(_!==void 0){var V;if(((V=b0.roles.get(e))==null?void 0:V.props["aria-valuemin"])===void 0)throw new Error('"aria-valuemin" is not supported on role "'+e+'".')}if(v!==void 0){var G;if(((G=b0.roles.get(e))==null?void 0:G.props["aria-valuetext"])===void 0)throw new Error('"aria-valuetext" is not supported on role "'+e+'".')}if(g!==void 0){var J;if(((J=b0.roles.get(e))==null?void 0:J.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+e+'".')}const B=new WeakMap;function $(U){return B.has(U)||B.set(U,gue(U)),B.get(U)}return Array.from(n.querySelectorAll(YUe(e))).filter(U=>{if(U.hasAttribute("role")){const q=U.getAttribute("role");if(a)return q.split(" ").filter(Boolean).some(ae=>ae===e);const[Y]=q.split(" ");return Y===e}return oH(U).some(q=>q===e)}).filter(U=>{if(o!==void 0)return o===D4e(U);if(l!==void 0)return l===L4e(U);if(c!==void 0)return c===U4e(U);if(u!==void 0)return u===B4e(U);if(f!==void 0)return f===F4e(U);if(g!==void 0)return g===z4e(U);if(h!==void 0)return h===j4e(U);if(p!==void 0||y!==void 0||_!==void 0||v!==void 0){let W=!0;if(p!==void 0&&W&&(W=p===H4e(U)),y!==void 0&&W&&(W=y===q4e(U)),_!==void 0&&W&&(W=_===V4e(U)),v!==void 0){var Q;W&&(W=eb((Q=G4e(U))!=null?Q:null,U,v,q=>q))}return W}return!0}).filter(U=>i===void 0?!0:eb(tH(U,{computedStyleSupportsPseudoElements:Ja().computedStyleSupportsPseudoElements}),U,i,Q=>Q)).filter(U=>s===void 0?!0:eb(tue(U,{computedStyleSupportsPseudoElements:Ja().computedStyleSupportsPseudoElements}),U,s,Q=>Q)).filter(U=>r===!1?aH(U,{isSubtreeInaccessible:$})===!1:!0)};function YUe(n){var e;const t='*[role~="'+n+'"]',r=(e=b0.roleElements.get(n))!=null?e:new Set,i=new Set(Array.from(r).map(s=>{let{name:a}=s;return a}));return[t].concat(Array.from(i)).join(",")}const Sue=n=>{let e="";return n===void 0?e="":typeof n=="string"?e=' and name "'+n+'"':e=" and name `"+n+"`",e},XUe=function(n,e,t){let{name:r}=t===void 0?{}:t;return'Found multiple elements with the role "'+e+'"'+Sue(r)},KUe=function(n,e,t){let{hidden:r=Ja().defaultHidden,name:i,description:s}=t===void 0?{}:t;if(Ja()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+e+'"'+Sue(i);let a="";Array.from(n.children).forEach(u=>{a+=P4e(u,{hidden:r,includeDescription:s!==void 0})});let o;a.length===0?r===!1?o="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":o="There are no available roles.":o=(`
Here are the `+(r===!1?"accessible":"available")+` roles:

  `+a.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let l="";i===void 0?l="":typeof i=="string"?l=' and name "'+i+'"':l=" and name `"+i+"`";let c="";return s===void 0?c="":typeof s=="string"?c=' and description "'+s+'"':c=" and description `"+s+"`",(`
Unable to find an `+(r===!1?"accessible ":"")+'element with the role "'+e+'"'+l+c+`

`+o).trim()},ZUe=H0(s9,s9.name,"queryAll"),[JUe,QUe,e6e,t6e,n6e]=tx(s9,XUe,KUe),lH=()=>Ja().testIdAttribute,a9=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return yb(e[0]),oU(lH(),...e)},r6e=(n,e)=>"Found multiple elements by: ["+lH()+'="'+e+'"]',i6e=(n,e)=>"Unable to find an element by: ["+lH()+'="'+e+'"]',s6e=H0(a9,a9.name,"queryAll"),[a6e,o6e,l6e,c6e,u6e]=tx(a9,r6e,i6e);var o9=Object.freeze({__proto__:null,queryAllByLabelText:sUe,queryByLabelText:eUe,getAllByLabelText:rUe,getByLabelText:iUe,findAllByLabelText:tUe,findByLabelText:nUe,queryByPlaceholderText:cUe,queryAllByPlaceholderText:lUe,getByPlaceholderText:fUe,getAllByPlaceholderText:uUe,findAllByPlaceholderText:hUe,findByPlaceholderText:dUe,queryByText:_Ue,queryAllByText:gUe,getByText:yUe,getAllByText:vUe,findAllByText:bUe,findByText:SUe,queryByDisplayValue:wUe,queryAllByDisplayValue:TUe,getByDisplayValue:AUe,getAllByDisplayValue:RUe,findAllByDisplayValue:CUe,findByDisplayValue:MUe,queryByAltText:PUe,queryAllByAltText:NUe,getByAltText:LUe,getAllByAltText:DUe,findAllByAltText:UUe,findByAltText:BUe,queryByTitle:qUe,queryAllByTitle:HUe,getByTitle:GUe,getAllByTitle:VUe,findAllByTitle:$Ue,findByTitle:WUe,queryByRole:JUe,queryAllByRole:ZUe,getAllByRole:QUe,getByRole:e6e,findAllByRole:t6e,findByRole:n6e,queryByTestId:a6e,queryAllByTestId:s6e,getByTestId:l6e,getAllByTestId:o6e,findAllByTestId:c6e,findByTestId:u6e});function f6e(n,e,t){return e===void 0&&(e=o9),t===void 0&&(t={}),Object.keys(e).reduce((r,i)=>{const s=e[i];return r[i]=s.bind(null,n),r},t)}const AJ={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},pageHide:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pageShow:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}}},h6e={doubleClick:"dblClick"};Object.keys(AJ).forEach(n=>{const{EventType:e,defaultInit:t}=AJ[n];n.toLowerCase()});Object.keys(h6e).forEach(n=>{});function d6e(n){return n.replace(/[ \t]*[\n][ \t]*/g,`
`)}function p6e(n){return o4e.compressToEncodedURIComponent(d6e(n))}function m6e(n){return"https://testing-playground.com/#markup="+p6e(n)}const g6e=(n,e,t)=>Array.isArray(n)?n.forEach(r=>TJ(r,e,t)):TJ(n,e,t),_6e=function(n){if(n===void 0&&(n=sH().body),!n||!("innerHTML"in n)){console.log("The element you're providing isn't a valid DOM element.");return}if(!n.innerHTML){console.log("The provided element doesn't have any children.");return}const e=m6e(n.innerHTML);return console.log(`Open this URL in your browser

`+e),e},CJ={debug:g6e,logTestingPlaygroundURL:_6e};typeof document<"u"&&document.body?f6e(document.body,o9,CJ):Object.keys(o9).reduce((n,e)=>(n[e]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},n),CJ);function aw(n,e){return Ja().eventWrapper(n)}function O1(n){const e=hNe(n,Qj),t=Ak(n.ownerDocument);(e??n.ownerDocument.body)!==t&&(aw(e?()=>e.focus():()=>t?.blur()),mNe(e??n.ownerDocument.body))}function v6e(n){!Qj(n)||!(Ak(n.ownerDocument)===n)||aw(()=>n.blur())}const k1={};k1.click=(n,e,t)=>{const r=e.closest("button,input,label,select,textarea"),i=r&&Ls(r,"label")&&r.control;if(i&&i!==e)return()=>{Qj(i)&&(O1(i),t.dispatchEvent(i,fNe(n)))};if(Ls(e,"input",{type:"file"}))return()=>{v6e(e),e.dispatchEvent(new(X0(e)).Event("fileDialog")),O1(e)}};const ow=Symbol("Displayed value in UI"),Xy=Symbol("Displayed selection in UI"),ZD=Symbol("Initial value to compare on blur");function y6e(n){return typeof n=="object"&&ow in n}function b6e(n){return!!n&&typeof n=="object"&&Xy in n}function S6e(n,e){n[ZD]===void 0&&(n[ZD]=n.value),n[ow]=e,n.value=Object.assign(new String(e),{[ow]:!0})}function Jv(n){return n[ow]===void 0?n.value:String(n[ow])}function cH(n){n[ow]=void 0}function Eue(n){n[ZD]=void 0}function E6e(n){return n[ZD]}function x6e(n,e){n[Xy]=e}function Jw(n,{focusOffset:e,anchorOffset:t=e},r="replace"){const i=Jv(n).length,s=f=>Math.max(0,Math.min(i,f)),a=r==="replace"||n[Xy]===void 0?s(t):n[Xy].anchorOffset,o=s(e),l=Math.min(a,o),c=Math.max(a,o);if(n[Xy]={anchorOffset:a,focusOffset:o},n.selectionStart===l&&n.selectionEnd===c)return;const u=Object.assign(new Number(l),{[Xy]:!0});try{n.setSelectionRange(u,c)}catch{}}function bO(n){var e,t,r;const i=(r=n[Xy])!==null&&r!==void 0?r:{anchorOffset:(e=n.selectionStart)!==null&&e!==void 0?e:0,focusOffset:(t=n.selectionEnd)!==null&&t!==void 0?t:0};return{...i,startOffset:Math.min(i.anchorOffset,i.focusOffset),endOffset:Math.max(i.anchorOffset,i.focusOffset)}}function T6e(n){return!!n[Xy]}function cP(n){n[Xy]=void 0}const JD=globalThis.parseInt;function w6e(n){const e=n.replace(/\D/g,"");if(e.length<2)return n;const t=JD(e[0],10),r=JD(e[1],10);if(t>=3||t===2&&r>=4){let i;return t>=3?i=1:i=2,MJ(e,i)}return n.length===2?n:MJ(e,2)}function MJ(n,e){const t=n.slice(0,e),r=Math.min(JD(t,10),23),i=n.slice(e),s=JD(i,10),a=Math.min(s,59);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function xue(n,e){const t=n.cloneNode();return t.value=e,t.value===e}var Tue=(function(n){return n.email="email",n.password="password",n.search="search",n.telephone="telephone",n.text="text",n.url="url",n})(Tue||{});function R6e(n){var e;const t=(e=n.getAttribute("maxlength"))!==null&&e!==void 0?e:"";return/^\d+$/.test(t)&&Number(t)>=0?Number(t):void 0}function A6e(n){return Ls(n,"textarea")||Ls(n,"input")&&n.type in Tue}function wue(n,e,t,r){if(uP(n)&&e+t>=0&&e+t<=n.nodeValue.length)return{node:n,offset:e+t};const i=OJ(n,e,t);if(i){if(uP(i))return{node:i,offset:t>0?Math.min(1,i.nodeValue.length):Math.max(i.nodeValue.length-1,0)};if(Ls(i,"br")){const s=OJ(i,void 0,t);return s?uP(s)?{node:s,offset:t>0?0:s.nodeValue.length}:t<0&&Ls(s,"br")?{node:i.parentNode,offset:ZI(i)}:{node:s.parentNode,offset:ZI(s)+(t>0?0:1)}:t<0&&r==="deleteContentBackward"?{node:i.parentNode,offset:ZI(i)}:void 0}else return{node:i.parentNode,offset:ZI(i)+(t>0?1:0)}}}function OJ(n,e,t){const r=Number(e)+(t<0?-1:0);return e!==void 0&&uH(n)&&r>=0&&r<n.children.length&&(n=n.children[r]),M6e(n,t===1?"next":"previous",C6e)}function C6e(n){if(uP(n))return!0;if(uH(n)){if(Ls(n,["input","textarea"]))return n.type!=="hidden";if(Ls(n,"br"))return!0}return!1}function ZI(n){let e=0;for(;n.previousSibling;)e++,n=n.previousSibling;return e}function uH(n){return n.nodeType===1}function uP(n){return n.nodeType===3}function M6e(n,e,t){for(;;){var r;const i=n[`${e}Sibling`];if(i){if(n=O6e(i,e==="next"?"first":"last"),t(n))return n}else if(n.parentNode&&(!uH(n.parentNode)||!CE(n.parentNode)&&n.parentNode!==((r=n.ownerDocument)===null||r===void 0?void 0:r.body)))n=n.parentNode;else break}}function O6e(n,e){for(;n.hasChildNodes();)n=n[`${e}Child`];return n}const SO=Symbol("Track programmatic changes for React workaround");function k6e(n){return Object.getOwnPropertyNames(n).some(e=>e.startsWith("__react"))&&X0(n).REACT_VERSION===17}function I6e(n){k6e(n)&&(n[SO]={previousValue:String(n.value),tracked:[]})}function N6e(n,e){var t,r;(r=n[SO])===null||r===void 0||(t=r.tracked)===null||t===void 0||t.push(e),n[SO]||(cH(n),Jw(n,{focusOffset:e.length}))}function P6e(n,e){var t;const r=n[SO];if(n[SO]=void 0,!(!(r==null||(t=r.tracked)===null||t===void 0)&&t.length))return;const i=r.tracked.length===2&&r.tracked[0]===r.previousValue&&r.tracked[1]===n.value;i||cH(n),T6e(n)&&Jw(n,{focusOffset:i?e:n.value.length})}function Rue(n){const e=D6e(n);if(e&&Zv(e))return{type:"input",selection:bO(e)};const t=e?.ownerDocument.getSelection();return{type:gO(n)&&t?.anchorNode&&gO(t.anchorNode)?"contenteditable":"default",selection:t}}function D6e(n){return n.nodeType===1?n:n.parentElement}function L6e(n){const e=Rue(n);if(e.type==="input")return e.selection;if(e.type==="contenteditable"){var t;return(t=e.selection)===null||t===void 0?void 0:t.getRangeAt(0)}}function OE({focusNode:n,focusOffset:e,anchorNode:t=n,anchorOffset:r=e}){var i,s;if(Rue(n).type==="input")return Jw(n,{anchorOffset:r,focusOffset:e});(s=t.ownerDocument)===null||s===void 0||(i=s.getSelection())===null||i===void 0||i.setBaseAndExtent(t,r,n,e)}function Aue(n){return Ls(n,"input")&&["date","time"].includes(n.type)}function lw(n,e,t,r="insertText"){const i=L6e(e);i&&(!Aue(e)&&!n.dispatchUIEvent(e,"beforeinput",{inputType:r,data:t})||("startContainer"in i?U6e(n,e,i,t,r):B6e(n,e,i,t,r)))}function U6e(n,e,t,r,i){let s=!1;if(!t.collapsed)s=!0,t.deleteContents();else if(["deleteContentBackward","deleteContentForward"].includes(i)){const a=wue(t.startContainer,t.startOffset,i==="deleteContentBackward"?-1:1,i);if(a){s=!0;const o=t.cloneRange();o.comparePoint(a.node,a.offset)<0?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),o.deleteContents()}}if(r)if(t.endContainer.nodeType===3){const a=t.endOffset;t.endContainer.insertData(a,r),t.setStart(t.endContainer,a+r.length),t.setEnd(t.endContainer,a+r.length)}else{const a=e.ownerDocument.createTextNode(r);t.insertNode(a),t.setStart(a,r.length),t.setEnd(a,r.length)}(s||r)&&n.dispatchUIEvent(e,"input",{inputType:i})}function B6e(n,e,t,r,i){let s=r;if(A6e(e)){const c=R6e(e);if(c!==void 0&&r.length>0){const u=c-e.value.length;if(u>0)s=r.substring(0,u);else return}}const{newValue:a,newOffset:o,oldValue:l}=F6e(s,e,t,i);a===l&&o===t.startOffset&&o===t.endOffset||Ls(e,"input",{type:"number"})&&!z6e(a)||(S6e(e,a),OE({focusNode:e,anchorOffset:o,focusOffset:o}),Aue(e)?xue(e,a)&&(kJ(n,e,o,{}),n.dispatchUIEvent(e,"change"),Eue(e)):kJ(n,e,o,{data:r,inputType:i}))}function F6e(n,e,{startOffset:t,endOffset:r},i){const s=Jv(e),a=Math.max(0,t===r&&i==="deleteContentBackward"?t-1:t),o=s.substring(0,a),l=Math.min(s.length,t===r&&i==="deleteContentForward"?t+1:r),c=s.substring(l,s.length);let u=`${o}${n}${c}`,f=a+n.length;if(Ls(e,"input",{type:"time"})){const h=w6e(u);h!==""&&xue(e,h)&&(u=h,f=h.length)}return{oldValue:s,newValue:u,newOffset:f}}function kJ(n,e,t,r){n.dispatchUIEvent(e,"input",r),P6e(e,t)}function z6e(n){var e,t;const r=n.split("e",2);return!(/[^\d.\-e]/.test(n)||Number((e=n.match(/-/g))===null||e===void 0?void 0:e.length)>2||Number((t=n.match(/\./g))===null||t===void 0?void 0:t.length)>1||r[1]&&!/^-?\d*$/.test(r[1]))}k1.cut=(n,e,t)=>()=>{sw(e)&&lw(t,e,"","deleteByCut")};function j6e(n){return n?CE(n)?n.textContent:Jv(n):null}function H6e(n){const e=X0(n);for(let t=n;t?.ownerDocument;t=t.parentElement){const{display:r,visibility:i}=e.getComputedStyle(t);if(r==="none"||i==="hidden")return!1}return!0}function q6e(n,e){const t=n.ownerDocument,r=t.querySelectorAll(zce),i=Array.from(r).filter(l=>l===n||!(Number(l.getAttribute("tabindex"))<0||fb(l)));Number(n.getAttribute("tabindex"))>=0&&i.sort((l,c)=>{const u=Number(l.getAttribute("tabindex")),f=Number(c.getAttribute("tabindex"));return u===f?0:u===0?1:f===0?-1:u-f});const s={};let a=[t.body];const o=Ls(n,"input",{type:"radio"})?n.name:void 0;i.forEach(l=>{const c=l;if(Ls(c,"input",{type:"radio"})&&c.name){if(c===n){a.push(c);return}else if(c.name===o)return;if(c.checked){a=a.filter(u=>!Ls(u,"input",{type:"radio",name:c.name})),a.push(c),s[c.name]=c;return}if(typeof s[c.name]<"u")return}a.push(c)});for(let l=a.findIndex(c=>c===n);;)if(l+=e?-1:1,l===a.length?l=0:l===-1&&(l=a.length-1),a[l]===n||a[l]===t.body||H6e(a[l]))return a[l]}function IJ(n,e){if(Zv(n)){const t=bO(n);OE({focusNode:n,focusOffset:t.startOffset===t.endOffset?t.focusOffset+e:e<0?t.startOffset:t.endOffset})}else{const t=n.ownerDocument.getSelection();if(!t?.focusNode)return;if(t.isCollapsed){const r=wue(t.focusNode,t.focusOffset,e);r&&OE({focusNode:r.node,focusOffset:r.offset})}else t[e<0?"collapseToStart":"collapseToEnd"]()}}function Cue(n){if(Zv(n))return OE({focusNode:n,anchorOffset:0,focusOffset:Jv(n).length});var e;const t=(e=gO(n))!==null&&e!==void 0?e:n.ownerDocument.body;OE({focusNode:t,anchorOffset:0,focusOffset:t.childNodes.length})}function V6e(n){if(Zv(n))return bO(n).startOffset===0&&bO(n).endOffset===Jv(n).length;var e;const t=(e=gO(n))!==null&&e!==void 0?e:n.ownerDocument.body,r=n.ownerDocument.getSelection();return r?.anchorNode===t&&r.focusNode===t&&r.anchorOffset===0&&r.focusOffset===t.childNodes.length}function m2(n,e,t){var r;if(Zv(n))return OE({focusNode:n,anchorOffset:e,focusOffset:t});if(CE(n)&&((r=n.firstChild)===null||r===void 0?void 0:r.nodeType)===3)return OE({focusNode:n.firstChild,anchorOffset:e,focusOffset:t});throw new Error("Not implemented. The result of this interaction is unreliable.")}function JI(n,e,t){const r=X0(e),i=Array.from(e.ownerDocument.querySelectorAll(e.name?`input[type="radio"][name="${r.CSS.escape(e.name)}"]`:'input[type="radio"][name=""], input[type="radio"]:not([name])'));for(let s=i.findIndex(a=>a===e)+t;;s+=t){if(i[s]||(s=t>0?0:i.length-1),i[s]===e)return;if(!fb(i[s])){O1(i[s]),n.dispatchUIEvent(i[s],"click");return}}}k1.keydown=(n,e,t)=>{var r,i;return(i=(r=NJ[n.key])===null||r===void 0?void 0:r.call(NJ,n,e,t))!==null&&i!==void 0?i:G6e(n,e,t)};const NJ={ArrowDown:(n,e,t)=>{if(Ls(e,"input",{type:"radio"}))return()=>JI(t,e,1)},ArrowLeft:(n,e,t)=>Ls(e,"input",{type:"radio"})?()=>JI(t,e,-1):()=>IJ(e,-1),ArrowRight:(n,e,t)=>Ls(e,"input",{type:"radio"})?()=>JI(t,e,1):()=>IJ(e,1),ArrowUp:(n,e,t)=>{if(Ls(e,"input",{type:"radio"}))return()=>JI(t,e,-1)},Backspace:(n,e,t)=>{if(sw(e))return()=>{lw(t,e,"","deleteContentBackward")}},Delete:(n,e,t)=>{if(sw(e))return()=>{lw(t,e,"","deleteContentForward")}},End:(n,e)=>{if(Ls(e,["input","textarea"])||CE(e))return()=>{var t,r;const i=(r=(t=j6e(e))===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0;m2(e,i,i)}},Home:(n,e)=>{if(Ls(e,["input","textarea"])||CE(e))return()=>{m2(e,0,0)}},PageDown:(n,e)=>{if(Ls(e,["input"]))return()=>{const t=Jv(e).length;m2(e,t,t)}},PageUp:(n,e)=>{if(Ls(e,["input"]))return()=>{m2(e,0,0)}},Tab:(n,e,t)=>()=>{const r=q6e(e,t.system.keyboard.modifiers.Shift);O1(r),Zv(r)&&Jw(r,{anchorOffset:0,focusOffset:r.value.length})}},G6e=(n,e,t)=>{if(n.code==="KeyA"&&t.system.keyboard.modifiers.Control)return()=>Cue(e)};k1.keypress=(n,e,t)=>{if(n.key==="Enter"){if(Ls(e,"button")||Ls(e,"input")&&$6e.includes(e.type)||Ls(e,"a")&&e.href)return()=>{t.dispatchUIEvent(e,"click")};if(Ls(e,"input")){const r=e.form,i=r?.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');return i?()=>t.dispatchUIEvent(i,"click"):r&&W6e.includes(e.type)&&r.querySelectorAll("input").length===1?()=>t.dispatchUIEvent(r,"submit"):void 0}}if(sw(e)){const r=n.key==="Enter"?CE(e)&&!t.system.keyboard.modifiers.Shift?"insertParagraph":"insertLineBreak":"insertText",i=n.key==="Enter"?`
`:n.key;return()=>lw(t,e,i,r)}};const $6e=["button","color","file","image","reset","submit"],W6e=["email","month","password","search","tel","text","url","week"];k1.keyup=(n,e,t)=>{var r;return(r=PJ[n.key])===null||r===void 0?void 0:r.call(PJ,n,e,t)};const PJ={" ":(n,e,t)=>{if(Hce(e))return()=>t.dispatchUIEvent(e,"click")}};k1.paste=(n,e,t)=>{if(sw(e))return()=>{var r;const i=(r=n.clipboardData)===null||r===void 0?void 0:r.getData("text");i&&lw(t,e,i,"insertFromPaste")}};const Mue={auxclick:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},beforeinput:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},click:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},contextmenu:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblclick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusin:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusout:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},keydown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keypress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyup:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},mousedown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseenter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseleave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mousemove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseout:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseover:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseup:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerover:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerenter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerdown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointermove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerup:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointercancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerout:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerleave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}}};function Oue(n){return Mue[n].EventType}const Y6e=["MouseEvent","PointerEvent"];function X6e(n){return Y6e.includes(Oue(n))}function K6e(n){return Oue(n)==="KeyboardEvent"}const Z6e={ClipboardEvent:[Q6e],Event:[],FocusEvent:[NM,e5e],InputEvent:[NM,t5e],MouseEvent:[NM,LB,DJ],PointerEvent:[NM,LB,DJ,r5e],KeyboardEvent:[NM,LB,n5e]};function kue(n,e,t){const r=X0(e),{EventType:i,defaultInit:s}=Mue[n],a=new(J6e(r))[i](n,s);return Z6e[i].forEach(o=>o(a,t??{})),a}function J6e(n){var e;const t=(e=n.Event)!==null&&e!==void 0?e:class{};var r;const i=(r=n.AnimationEvent)!==null&&r!==void 0?r:class extends t{};var s;const a=(s=n.ClipboardEvent)!==null&&s!==void 0?s:class extends t{};var o;const l=(o=n.PopStateEvent)!==null&&o!==void 0?o:class extends t{};var c;const u=(c=n.ProgressEvent)!==null&&c!==void 0?c:class extends t{};var f;const h=(f=n.TransitionEvent)!==null&&f!==void 0?f:class extends t{};var g;const p=(g=n.UIEvent)!==null&&g!==void 0?g:class extends t{};var _;const y=(_=n.CompositionEvent)!==null&&_!==void 0?_:class extends p{};var v;const x=(v=n.FocusEvent)!==null&&v!==void 0?v:class extends p{};var E;const M=(E=n.InputEvent)!==null&&E!==void 0?E:class extends p{};var k;const N=(k=n.KeyboardEvent)!==null&&k!==void 0?k:class extends p{};var I;const D=(I=n.MouseEvent)!==null&&I!==void 0?I:class extends p{};var V;const G=(V=n.DragEvent)!==null&&V!==void 0?V:class extends D{};var J;const B=(J=n.PointerEvent)!==null&&J!==void 0?J:class extends D{};var $;const U=($=n.TouchEvent)!==null&&$!==void 0?$:class extends p{};return{Event:t,AnimationEvent:i,ClipboardEvent:a,PopStateEvent:l,ProgressEvent:u,TransitionEvent:h,UIEvent:p,CompositionEvent:y,FocusEvent:x,InputEvent:M,KeyboardEvent:N,MouseEvent:D,DragEvent:G,PointerEvent:B,TouchEvent:U}}function X1(n,e){for(const[t,r]of Object.entries(e))Object.defineProperty(n,t,{get:()=>r??null})}function mu(n){return Number(n??0)}function Q6e(n,{clipboardData:e}){X1(n,{clipboardData:e})}function e5e(n,{relatedTarget:e}){X1(n,{relatedTarget:e})}function t5e(n,{data:e,inputType:t,isComposing:r}){X1(n,{data:e,isComposing:!!r,inputType:String(t)})}function NM(n,{view:e,detail:t}){X1(n,{view:e,detail:mu(t??0)})}function LB(n,{altKey:e,ctrlKey:t,metaKey:r,shiftKey:i,modifierAltGraph:s,modifierCapsLock:a,modifierFn:o,modifierFnLock:l,modifierNumLock:c,modifierScrollLock:u,modifierSymbol:f,modifierSymbolLock:h}){X1(n,{altKey:!!e,ctrlKey:!!t,metaKey:!!r,shiftKey:!!i,getModifierState(g){return!!{Alt:e,AltGraph:s,CapsLock:a,Control:t,Fn:o,FnLock:l,Meta:r,NumLock:c,ScrollLock:u,Shift:i,Symbol:f,SymbolLock:h}[g]}})}function n5e(n,{key:e,code:t,location:r,repeat:i,isComposing:s,charCode:a}){X1(n,{key:String(e),code:String(t),location:mu(r),repeat:!!i,isComposing:!!s,charCode:a})}function DJ(n,{x:e,y:t,screenX:r,screenY:i,clientX:s=e,clientY:a=t,button:o,buttons:l,relatedTarget:c,offsetX:u,offsetY:f,pageX:h,pageY:g}){X1(n,{screenX:mu(r),screenY:mu(i),clientX:mu(s),x:mu(s),clientY:mu(a),y:mu(a),button:mu(o),buttons:mu(l),relatedTarget:c,offsetX:mu(u),offsetY:mu(f),pageX:mu(h),pageY:mu(g)})}function r5e(n,{pointerId:e,width:t,height:r,pressure:i,tangentialPressure:s,tiltX:a,tiltY:o,twist:l,pointerType:c,isPrimary:u}){X1(n,{pointerId:mu(e),width:mu(t??1),height:mu(r??1),pressure:mu(i),tangentialPressure:mu(s),tiltX:mu(a),tiltY:mu(o),twist:mu(l),pointerType:String(c),isPrimary:!!u})}function i5e(n,e,t,r=!1){(X6e(e)||K6e(e))&&(t={...t,...this.system.getUIEventModifiers()});const i=kue(e,n,t);return Iue.call(this,n,i,r)}function Iue(n,e,t=!1){var r;const i=e.type,s=t?()=>{}:(r=k1[i])===null||r===void 0?void 0:r.call(k1,e,n,this);if(s){e.preventDefault();let a=!1;return Object.defineProperty(e,"defaultPrevented",{get:()=>a}),Object.defineProperty(e,"preventDefault",{value:()=>{a=e.cancelable}}),aw(()=>n.dispatchEvent(e)),a||s(),!a}return aw(()=>n.dispatchEvent(e))}function jS(n,e,t){const r=kue(e,n,t);aw(()=>n.dispatchEvent(r))}const LJ=Symbol("patched focus/blur methods");function Nue(n){if(n.prototype[LJ])return;const{focus:e,blur:t}=n.prototype;Object.defineProperties(n.prototype,{focus:{configurable:!0,get:()=>i},blur:{configurable:!0,get:()=>s},[LJ]:{configurable:!0,get:()=>({focus:e,blur:t})}});let r;function i(a){if(this.ownerDocument.visibilityState!=="hidden")return e.call(this,a);const o=UJ(this.ownerDocument);if(o===this)return;const l=Symbol("focus call");r=l,o&&(t.call(o),jS(o,"blur",{relatedTarget:this}),jS(o,"focusout",{relatedTarget:r===l?this:null})),r===l&&(e.call(this,a),jS(this,"focus",{relatedTarget:o})),r===l&&jS(this,"focusin",{relatedTarget:o})}function s(){if(this.ownerDocument.visibilityState!=="hidden")return t.call(this);const a=UJ(this.ownerDocument);if(a!==this)return;r=Symbol("blur call"),t.call(this),jS(a,"blur",{relatedTarget:null}),jS(a,"focusout",{relatedTarget:null})}}function UJ(n){const e=Ak(n);return e?.tagName==="BODY"?null:e}const UB=Symbol("Interceptor for programmatical calls");function RT(n,e,t){const r=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=Object.getOwnPropertyDescriptor(n,e),s=r?.set?"set":"value";if(typeof r?.[s]!="function"||r[s][UB])throw new Error(`Element ${n.tagName} does not implement "${String(e)}".`);function a(...o){const{applyNative:l=!1,realArgs:c,then:u}=t.call(this,...o),f=(!l&&i||r)[s];s==="set"?f.call(this,c):f.call(this,...c),u?.()}a[UB]=UB,Object.defineProperty(n,e,{...i??r,[s]:a})}function s5e(n){RT(n,"value",function(t){const r=y6e(t);return r&&I6e(this),{applyNative:!!r,realArgs:a5e(this,t),then:r?void 0:()=>N6e(this,String(t))}})}function a5e(n,e){return Ls(n,"input",{type:"number"})&&String(e)!==""&&!Number.isNaN(Number(e))?String(Number(e)):String(e)}function o5e(n){RT(n,"setSelectionRange",function(t,...r){const i=b6e(t);return{applyNative:!!i,realArgs:[Number(t),...r],then:()=>i?void 0:cP(n)}}),RT(n,"selectionStart",function(t){return{realArgs:t,then:()=>cP(n)}}),RT(n,"selectionEnd",function(t){return{realArgs:t,then:()=>cP(n)}}),RT(n,"select",function(){return{realArgs:[],then:()=>x6e(n,{anchorOffset:0,focusOffset:Jv(n).length})}})}function l5e(n){RT(n,"setRangeText",function(...t){return{realArgs:t,then:()=>{cH(n),cP(n)}}})}const LT=Symbol("Node prepared with document state workarounds");function Pue(n){n[LT]||(n.addEventListener("focus",e=>{const t=e.target;BJ(t)},{capture:!0,passive:!0}),n.activeElement&&BJ(n.activeElement),n.addEventListener("blur",e=>{const t=e.target,r=E6e(t);r!==void 0&&(t.value!==r&&jS(t,"change"),Eue(t))},{capture:!0,passive:!0}),n[LT]=LT)}function BJ(n){n[LT]||(Ls(n,["input","textarea"])&&(s5e(n),o5e(n),l5e(n)),n[LT]=LT)}function c5e(n){return u5e(n)?n:n.ownerDocument}function u5e(n){return n.nodeType===9}var wg=(function(n){return n[n.Trigger=2]="Trigger",n[n.Call=1]="Call",n})({});function g2(n,e){n.levelRefs[e]={}}function QI(n,e){return n.levelRefs[e]}function cw(n){const e=n.delay;if(typeof e=="number")return Promise.all([new Promise(t=>globalThis.setTimeout(()=>t(),e)),n.advanceTimers(e)])}var fP=(function(n){return n[n.EachTrigger=4]="EachTrigger",n[n.EachApiCall=2]="EachApiCall",n[n.EachTarget=1]="EachTarget",n[n.Never=0]="Never",n})({});function xS(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var sv=(function(n){return n[n.STANDARD=0]="STANDARD",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n[n.NUMPAD=3]="NUMPAD",n})({});const f5e=["Alt","AltGraph","Control","Fn","Meta","Shift","Symbol"];function FJ(n){return f5e.includes(n)}const h5e=["CapsLock","FnLock","NumLock","ScrollLock","SymbolLock"];function zJ(n){return h5e.includes(n)}class d5e{isKeyPressed(e){return this.pressed.has(String(e.code))}getPressedKeys(){return this.pressed.values().map(e=>e.keyDef)}async keydown(e,t){const r=String(t.key),i=String(t.code),s=MB(e.config.document);this.setKeydownTarget(s),this.pressed.add(i,t),FJ(r)&&(this.modifiers[r]=!0);const a=e.dispatchUIEvent(s,"keydown",{key:r,code:i});zJ(r)&&!this.modifiers[r]&&(this.modifiers[r]=!0,this.modifierLockStart[r]=!0),a&&this.pressed.setUnprevented(i),a&&this.hasKeyPress(r)&&e.dispatchUIEvent(MB(e.config.document),"keypress",{key:r,code:i,charCode:t.key==="Enter"?13:String(t.key).charCodeAt(0)})}async keyup(e,t){const r=String(t.key),i=String(t.code),s=this.pressed.isUnprevented(i);this.pressed.delete(i),FJ(r)&&!this.pressed.values().find(a=>a.keyDef.key===r)&&(this.modifiers[r]=!1),e.dispatchUIEvent(MB(e.config.document),"keyup",{key:r,code:i},!s),zJ(r)&&this.modifiers[r]&&(this.modifierLockStart[r]?this.modifierLockStart[r]=!1:this.modifiers[r]=!1)}setKeydownTarget(e){e!==this.lastKeydownTarget&&(this.carryChar=""),this.lastKeydownTarget=e}hasKeyPress(e){return(e.length===1||e==="Enter")&&!this.modifiers.Control&&!this.modifiers.Alt}constructor(e){xS(this,"system",void 0),xS(this,"modifiers",{Alt:!1,AltGraph:!1,CapsLock:!1,Control:!1,Fn:!1,FnLock:!1,Meta:!1,NumLock:!1,ScrollLock:!1,Shift:!1,Symbol:!1,SymbolLock:!1}),xS(this,"pressed",new class{add(t,r){var i,s,a;(a=(i=this.registry)[s=t])!==null&&a!==void 0||(i[s]={keyDef:r,unpreventedDefault:!1})}has(t){return!!this.registry[t]}setUnprevented(t){const r=this.registry[t];r&&(r.unpreventedDefault=!0)}isUnprevented(t){var r;return!!(!((r=this.registry[t])===null||r===void 0)&&r.unpreventedDefault)}delete(t){delete this.registry[t]}values(){return Object.values(this.registry)}constructor(){xS(this,"registry",{})}}),xS(this,"carryChar",""),xS(this,"lastKeydownTarget",void 0),xS(this,"modifierLockStart",{}),this.system=e}}const p5e=[..."0123456789".split("").map(n=>({code:`Digit${n}`,key:n})),...")!@#$%^&*(".split("").map((n,e)=>({code:`Digit${e}`,key:n,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map(n=>({code:`Key${n.toUpperCase()}`,key:n})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(n=>({code:`Key${n}`,key:n,shiftKey:!0})),{code:"BracketLeft",key:"["},{code:"BracketLeft",key:"{",shiftKey:!0},{code:"BracketRight",key:"]"},{code:"BracketRight",key:"}",shiftKey:!0},{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:sv.LEFT},{code:"AltRight",key:"Alt",location:sv.RIGHT},{code:"ShiftLeft",key:"Shift",location:sv.LEFT},{code:"ShiftRight",key:"Shift",location:sv.RIGHT},{code:"ControlLeft",key:"Control",location:sv.LEFT},{code:"ControlRight",key:"Control",location:sv.RIGHT},{code:"MetaLeft",key:"Meta",location:sv.LEFT},{code:"MetaRight",key:"Meta",location:sv.RIGHT},{code:"OSLeft",key:"OS",location:sv.LEFT},{code:"OSRight",key:"OS",location:sv.RIGHT},{code:"ContextMenu",key:"ContextMenu"},{code:"Tab",key:"Tab"},{code:"CapsLock",key:"CapsLock"},{code:"Backspace",key:"Backspace"},{code:"Enter",key:"Enter"},{code:"Escape",key:"Escape"},{code:"ArrowUp",key:"ArrowUp"},{code:"ArrowDown",key:"ArrowDown"},{code:"ArrowLeft",key:"ArrowLeft"},{code:"ArrowRight",key:"ArrowRight"},{code:"Home",key:"Home"},{code:"End",key:"End"},{code:"Delete",key:"Delete"},{code:"PageUp",key:"PageUp"},{code:"PageDown",key:"PageDown"},{code:"Fn",key:"Fn"},{code:"Symbol",key:"Symbol"},{code:"AltRight",key:"AltGraph"}],m5e=[{name:"MouseLeft",pointerType:"mouse",button:"primary"},{name:"MouseRight",pointerType:"mouse",button:"secondary"},{name:"MouseMiddle",pointerType:"mouse",button:"auxiliary"},{name:"TouchA",pointerType:"touch"},{name:"TouchB",pointerType:"touch"},{name:"TouchC",pointerType:"touch"}];function g5e(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Due{getButtons(){let e=0;for(const t of Object.keys(this.pressed))e|=2**Number(t);return e}down(e){const t=l9(e.button);if(t in this.pressed){this.pressed[t].push(e);return}return this.pressed[t]=[e],t}up(e){const t=l9(e.button);if(t in this.pressed&&(this.pressed[t]=this.pressed[t].filter(r=>r.name!==e.name),this.pressed[t].length===0))return delete this.pressed[t],t}constructor(){g5e(this,"pressed",{})}}const jJ={primary:0,secondary:1,auxiliary:2,back:3,X1:3,forward:4,X2:4};function l9(n=0){return n in jJ?jJ[n]:Number(n)}const HJ={1:2,2:1};function c9(n){return n=l9(n),n in HJ?HJ[n]:n}function _5e(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class v5e{get countPressed(){return this.pressedKeys.size}isPressed(e){return this.pressedKeys.has(e.name)}addPressed(e){return this.pressedKeys.add(e.name)}removePressed(e){return this.pressedKeys.delete(e.name)}constructor(){_5e(this,"pressedKeys",new Set)}}function F2(n,e){const t=[];for(let s=n;s;s=s.parentElement)t.push(s);const r=[];for(let s=e;s;s=s.parentElement)r.push(s);let i=0;for(;!(i>=t.length||i>=r.length||t[t.length-1-i]!==r[r.length-1-i]);i++);return[t.slice(0,t.length-i),r.slice(0,r.length-i),r.slice(r.length-i)]}function u9({target:n,node:e,offset:t}){return Zv(n)?{node:n,offset:t??Jv(n).length}:e?{node:e,offset:t??(e.nodeType===3?e.nodeValue.length:e.childNodes.length)}:Lue(n,t)}function Lue(n,e,t=!0){let r=e===void 0?n.childNodes.length-1:0;const i=e===void 0?-1:1;for(;e===void 0?r>=(t?Math.max(n.childNodes.length-1,0):0):r<=n.childNodes.length;){if(e&&r===n.childNodes.length)throw new Error("The given offset is out of bounds.");const s=n.childNodes.item(r),a=String(s.textContent);if(a.length)if(e!==void 0&&a.length<e)e-=a.length;else{if(s.nodeType===1)return Lue(s,e,!1);if(s.nodeType===3)return{node:s,offset:e??s.nodeValue.length}}r+=i}return{node:n,offset:n.childNodes.length}}function y5e({document:n,target:e,clickCount:t,node:r,offset:i}){if(pNe(e))return;const s=Zv(e),a=String(s?Jv(e):e.textContent),[o,l]=r?[i,i]:b5e(a,i,t);if(s)return Jw(e,{anchorOffset:o??a.length,focusOffset:l??a.length}),{node:e,start:o??0,end:l??a.length};{const{node:c,offset:u}=u9({target:e,node:r,offset:o}),{node:f,offset:h}=u9({target:e,node:r,offset:l}),g=e.ownerDocument.createRange();try{g.setStart(c,u),g.setEnd(f,h)}catch{throw new Error("The given offset is out of bounds.")}const p=n.getSelection();return p?.removeAllRanges(),p?.addRange(g.cloneRange()),g}}function b5e(n,e,t){if(t%3===1||n.length===0)return[e,e];const r=e??n.length;return t%3===2?[r-n.substr(0,e).match(/(\w+|\s+|\W)?$/)[0].length,e===void 0?e:e+n.substr(e).match(/^(\w+|\s+|\W)?/)[0].length]:[r-n.substr(0,e).match(/[^\r\n]*$/)[0].length,e===void 0?e:e+n.substr(e).match(/^[^\r\n]*/)[0].length]}function S5e(n,{document:e,target:t,node:r,offset:i}){const s=u9({target:t,node:r,offset:i});if("node"in n){if(s.node===n.node){const a=s.offset<n.start?n.end:n.start,o=s.offset>n.end||s.offset<n.start?s.offset:n.end;Jw(n.node,{anchorOffset:a,focusOffset:o})}}else{const a=n.cloneRange(),o=a.comparePoint(s.node,s.offset);o<0?a.setStart(s.node,s.offset):o>0&&a.setEnd(s.node,s.offset);const l=e.getSelection();l?.removeAllRanges(),l?.addRange(a.cloneRange())}}function Uue(n,e){var t,r,i,s,a,o,l,c,u,f,h,g,p,_,y,v,x,E,M,k,N,I,D,V;return n.target!==e.target||((t=n.coords)===null||t===void 0?void 0:t.x)!==((r=e.coords)===null||r===void 0?void 0:r.x)||((i=n.coords)===null||i===void 0?void 0:i.y)!==((s=e.coords)===null||s===void 0?void 0:s.y)||((a=n.coords)===null||a===void 0?void 0:a.clientX)!==((o=e.coords)===null||o===void 0?void 0:o.clientX)||((l=n.coords)===null||l===void 0?void 0:l.clientY)!==((c=e.coords)===null||c===void 0?void 0:c.clientY)||((u=n.coords)===null||u===void 0?void 0:u.offsetX)!==((f=e.coords)===null||f===void 0?void 0:f.offsetX)||((h=n.coords)===null||h===void 0?void 0:h.offsetY)!==((g=e.coords)===null||g===void 0?void 0:g.offsetY)||((p=n.coords)===null||p===void 0?void 0:p.pageX)!==((_=e.coords)===null||_===void 0?void 0:_.pageX)||((y=n.coords)===null||y===void 0?void 0:y.pageY)!==((v=e.coords)===null||v===void 0?void 0:v.pageY)||((x=n.coords)===null||x===void 0?void 0:x.screenX)!==((E=e.coords)===null||E===void 0?void 0:E.screenX)||((M=n.coords)===null||M===void 0?void 0:M.screenY)!==((k=e.coords)===null||k===void 0?void 0:k.screenY)||((N=n.caret)===null||N===void 0?void 0:N.node)!==((I=e.caret)===null||I===void 0?void 0:I.node)||((D=n.caret)===null||D===void 0?void 0:D.offset)!==((V=e.caret)===null||V===void 0?void 0:V.offset)}function TS(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class E5e{move(e,t,r){const i=this.position,s=this.getTarget(e);if(this.position=t,!Uue(i,t))return;const a=this.getTarget(e),o=this.getEventInit("mousemove"),[l,c]=F2(s,a);return{leave:()=>{s!==a&&(e.dispatchUIEvent(s,"mouseout",o),l.forEach(u=>e.dispatchUIEvent(u,"mouseleave",o)))},enter:()=>{s!==a&&(e.dispatchUIEvent(a,"mouseover",o),c.forEach(u=>e.dispatchUIEvent(u,"mouseenter",o)))},move:()=>{r||(e.dispatchUIEvent(a,"mousemove",o),this.modifySelecting(e))}}}down(e,t,r){const i=this.buttons.down(t);if(i===void 0)return;const s=this.getTarget(e);this.buttonDownTarget[i]=s;const a=this.getEventInit("mousedown",t.button),o=fb(s);!r&&(o||e.dispatchUIEvent(s,"mousedown",a))&&(this.startSelecting(e,a.detail),O1(s)),!o&&c9(t.button)===2&&e.dispatchUIEvent(s,"contextmenu",this.getEventInit("contextmenu",t.button))}up(e,t,r){const i=this.buttons.up(t);if(i===void 0)return;const s=this.getTarget(e);if(!fb(s)){if(!r){const o=this.getEventInit("mouseup",t.button);e.dispatchUIEvent(s,"mouseup",o),this.endSelecting()}const a=F2(this.buttonDownTarget[i],s)[2][0];if(a){const o=this.getEventInit("click",t.button);o.detail&&(e.dispatchUIEvent(a,o.button===0?"click":"auxclick",o),o.button===0&&o.detail===2&&e.dispatchUIEvent(a,"dblclick",{...this.getEventInit("dblclick",t.button),detail:o.detail}))}}}resetClickCount(){this.clickCount.reset()}getEventInit(e,t){const r={...this.position.coords};return r.button=c9(t),r.buttons=this.buttons.getButtons(),e==="mousedown"?r.detail=this.clickCount.getOnDown(r.button):e==="mouseup"?r.detail=this.clickCount.getOnUp(r.button):(e==="click"||e==="auxclick")&&(r.detail=this.clickCount.incOnClick(r.button)),r}getTarget(e){var t;return(t=this.position.target)!==null&&t!==void 0?t:e.config.document.body}startSelecting(e,t){var r,i;this.selecting=y5e({document:e.config.document,target:this.getTarget(e),node:(r=this.position.caret)===null||r===void 0?void 0:r.node,offset:(i=this.position.caret)===null||i===void 0?void 0:i.offset,clickCount:t})}modifySelecting(e){var t,r;this.selecting&&S5e(this.selecting,{document:e.config.document,target:this.getTarget(e),node:(t=this.position.caret)===null||t===void 0?void 0:t.node,offset:(r=this.position.caret)===null||r===void 0?void 0:r.offset})}endSelecting(){this.selecting=void 0}constructor(){TS(this,"position",{}),TS(this,"buttons",new Due),TS(this,"selecting",void 0),TS(this,"buttonDownTarget",{}),TS(this,"clickCount",new class{incOnClick(e){const t=this.down[e]===void 0?void 0:Number(this.down[e])+1;return this.count=this.count[e]===void 0?{}:{[e]:Number(this.count[e])+1},t}getOnDown(e){var t;this.down={[e]:(t=this.count[e])!==null&&t!==void 0?t:0};var r;return this.count={[e]:(r=this.count[e])!==null&&r!==void 0?r:0},Number(this.count[e])+1}getOnUp(e){return this.down[e]===void 0?void 0:Number(this.down[e])+1}reset(){this.count={}}constructor(){TS(this,"down",{}),TS(this,"count",{})}})}}function QD(n,e){var t;return((t=Bue(n,e))===null||t===void 0?void 0:t.pointerEvents)!=="none"}function x5e(n){const e=X0(n);for(let t=n,r=[];t?.ownerDocument;t=t.parentElement){r.push(t);const i=e.getComputedStyle(t).pointerEvents;if(i&&!["inherit","unset"].includes(i))return{pointerEvents:i,tree:r}}}const qJ=Symbol("Last check for pointer-events");function Bue(n,e){const t=e[qJ];if(!(n.config.pointerEventsCheck!==fP.Never&&(!t||VJ(n.config.pointerEventsCheck,fP.EachApiCall)&&t[wg.Call]!==QI(n,wg.Call)||VJ(n.config.pointerEventsCheck,fP.EachTrigger)&&t[wg.Trigger]!==QI(n,wg.Trigger))))return t?.result;const i=x5e(e);return e[qJ]={[wg.Call]:QI(n,wg.Call),[wg.Trigger]:QI(n,wg.Trigger),result:i},i}function _2(n,e){const t=Bue(n,e);if(t?.pointerEvents==="none")throw new Error([`Unable to perform pointer interaction as the element ${t.tree.length>1?"inherits":"has"} \`pointer-events: none\`:`,"",T5e(t.tree)].join(`
`))}function T5e(n){return n.reverse().map((e,t)=>["".padEnd(t),e.tagName,e.id&&`#${e.id}`,e.hasAttribute("data-testid")&&`(testId=${e.getAttribute("data-testid")})`,w5e(e),n.length>1&&t===0&&"  <-- This element declared `pointer-events: none`",n.length>1&&t===n.length-1&&"  <-- Asserted pointer events here"].filter(Boolean).join("")).join(`
`)}function w5e(n){var e;let t;if(n.hasAttribute("aria-label"))t=n.getAttribute("aria-label");else if(n.hasAttribute("aria-labelledby")){var r,i;t=(i=n.ownerDocument.getElementById(n.getAttribute("aria-labelledby")))===null||i===void 0||(r=i.textContent)===null||r===void 0?void 0:r.trim()}else if(Ls(n,["button","input","meter","output","progress","select","textarea"])&&(!((e=n.labels)===null||e===void 0)&&e.length))t=Array.from(n.labels).map(a=>{var o;return(o=a.textContent)===null||o===void 0?void 0:o.trim()}).join("|");else if(Ls(n,"button")){var s;t=(s=n.textContent)===null||s===void 0?void 0:s.trim()}return t=t?.replace(/\n/g,"  "),Number(t?.length)>30&&(t=`${t?.substring(0,29)}…`),t?`(label=${t})`:""}function VJ(n,e){return(n&e)>0}function wy(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class R5e{init(e){const t=this.getTarget(e),[,r]=F2(null,t),i=this.getEventInit();return _2(e,t),e.dispatchUIEvent(t,"pointerover",i),r.forEach(s=>e.dispatchUIEvent(s,"pointerenter",i)),this}move(e,t){const r=this.position,i=this.getTarget(e);if(this.position=t,!Uue(r,t))return;const s=this.getTarget(e),a=this.getEventInit(-1),[o,l]=F2(i,s);return{leave:()=>{QD(e,i)&&i!==s&&(e.dispatchUIEvent(i,"pointerout",a),o.forEach(c=>e.dispatchUIEvent(c,"pointerleave",a)))},enter:()=>{_2(e,s),i!==s&&(e.dispatchUIEvent(s,"pointerover",a),l.forEach(c=>e.dispatchUIEvent(c,"pointerenter",a)))},move:()=>{e.dispatchUIEvent(s,"pointermove",a)}}}down(e,t=0){if(this.isDown)return;const r=this.getTarget(e);_2(e,r),this.isDown=!0,this.isPrevented=!e.dispatchUIEvent(r,"pointerdown",this.getEventInit(t))}up(e,t=0){if(!this.isDown)return;const r=this.getTarget(e);_2(e,r),this.isPrevented=!1,this.isDown=!1,e.dispatchUIEvent(r,"pointerup",this.getEventInit(t))}release(e){const t=this.getTarget(e),[r]=F2(t,null),i=this.getEventInit();QD(e,t)&&(e.dispatchUIEvent(t,"pointerout",i),r.forEach(s=>e.dispatchUIEvent(s,"pointerleave",i))),this.isCancelled=!0}getTarget(e){var t;return(t=this.position.target)!==null&&t!==void 0?t:e.config.document.body}getEventInit(e){return{...this.position.coords,pointerId:this.pointerId,pointerType:this.pointerType,isPrimary:this.isPrimary,button:c9(e),buttons:this.buttons.getButtons()}}constructor({pointerId:e,pointerType:t,isPrimary:r},i){wy(this,"pointerId",void 0),wy(this,"pointerType",void 0),wy(this,"isPrimary",void 0),wy(this,"buttons",void 0),wy(this,"isMultitouch",!1),wy(this,"isCancelled",!1),wy(this,"isDown",!1),wy(this,"isPrevented",!1),wy(this,"position",{}),this.pointerId=e,this.pointerType=t,this.isPrimary=r,this.isMultitouch=!r,this.buttons=i}}function Wb(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class A5e{isKeyPressed(e){return this.devices.get(e.pointerType).isPressed(e)}async press(e,t,r){this.devices.get(t.pointerType).addPressed(t),this.buttons.down(t);const i=this.getPointerName(t),s=t.pointerType==="touch"?this.pointers.new(i,t.pointerType,this.buttons):this.pointers.get(i);s.position=r,s.pointerType!=="touch"&&(this.mouse.position=r),s.pointerType==="touch"&&s.init(e),s.down(e,t.button),s.pointerType!=="touch"&&this.mouse.down(e,t,s.isPrevented)}async move(e,t,r){const i=this.pointers.get(t),s=i.move(e,r),a=i.pointerType==="touch"?void 0:this.mouse.move(e,r,i.isPrevented);s?.leave(),a?.leave(),s?.enter(),a?.enter(),s?.move(),a?.move()}async release(e,t,r){const i=this.devices.get(t.pointerType);i.removePressed(t),this.buttons.up(t);const s=this.pointers.get(this.getPointerName(t)),a=s.isPrevented;if(s.position=r,s.pointerType!=="touch"&&(this.mouse.position=r),i.countPressed===0&&s.up(e,t.button),s.pointerType==="touch"&&s.release(e),s.pointerType==="touch"&&!s.isMultitouch){const o=this.mouse.move(e,r,a);o?.leave(),o?.enter(),o?.move(),this.mouse.down(e,t,a)}if(!s.isMultitouch){const o=this.mouse.move(e,r,a);o?.leave(),o?.enter(),o?.move(),this.mouse.up(e,t,a)}}getPointerName(e){return e.pointerType==="touch"?e.name:e.pointerType}getPreviousPosition(e){return this.pointers.has(e)?this.pointers.get(e).position:void 0}resetClickCount(){this.mouse.resetClickCount()}getMouseTarget(e){var t;return(t=this.mouse.position.target)!==null&&t!==void 0?t:e.config.document.body}setMousePosition(e){this.mouse.position=e,this.pointers.get("mouse").position=e}constructor(e){Wb(this,"system",void 0),Wb(this,"mouse",void 0),Wb(this,"buttons",void 0),Wb(this,"devices",new class{get(t){var r,i,s;return(s=(r=this.registry)[i=t])!==null&&s!==void 0?s:r[i]=new v5e}constructor(){Wb(this,"registry",{})}}),Wb(this,"pointers",new class{new(t,r,i){const s=r!=="touch"||!Object.values(this.registry).some(a=>a.pointerType==="touch"&&!a.isCancelled);return s||Object.values(this.registry).forEach(a=>{a.pointerType===r&&!a.isCancelled&&(a.isMultitouch=!0)}),this.registry[t]=new R5e({pointerId:this.nextId++,pointerType:r,isPrimary:s},i),this.registry[t]}get(t){if(!this.has(t))throw new Error(`Trying to access pointer "${t}" which does not exist.`);return this.registry[t]}has(t){return t in this.registry}constructor(){Wb(this,"registry",{}),Wb(this,"nextId",1)}}),this.system=e,this.buttons=new Due,this.mouse=new E5e,this.pointers.new("mouse","mouse",this.buttons)}}function GJ(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class Fue{getUIEventModifiers(){return{altKey:this.keyboard.modifiers.Alt,ctrlKey:this.keyboard.modifiers.Control,metaKey:this.keyboard.modifiers.Meta,shiftKey:this.keyboard.modifiers.Shift,modifierAltGraph:this.keyboard.modifiers.AltGraph,modifierCapsLock:this.keyboard.modifiers.CapsLock,modifierFn:this.keyboard.modifiers.Fn,modifierFnLock:this.keyboard.modifiers.FnLock,modifierNumLock:this.keyboard.modifiers.NumLock,modifierScrollLock:this.keyboard.modifiers.ScrollLock,modifierSymbol:this.keyboard.modifiers.Symbol,modifierSymbolLock:this.keyboard.modifiers.SymbolLock}}constructor(){GJ(this,"keyboard",new d5e(this)),GJ(this,"pointer",new A5e(this))}}async function C5e(n){const e=[];return this.config.skipHover||e.push({target:n}),e.push({keys:"[MouseLeft]",target:n}),this.pointer(e)}async function M5e(n){return this.pointer([{target:n},"[MouseLeft][MouseLeft]"])}async function O5e(n){return this.pointer([{target:n},"[MouseLeft][MouseLeft][MouseLeft]"])}async function k5e(n){return this.pointer({target:n})}async function I5e(n){return _2(this,this.system.pointer.getMouseTarget(this)),this.pointer({target:n.ownerDocument.body})}async function N5e({shift:n}={}){return this.keyboard(n===!0?"{Shift>}{Tab}{/Shift}":n===!1?"[/ShiftLeft][/ShiftRight]{Tab}":"{Tab}")}var fH=(function(n){return n["{"]="}",n["["]="]",n})(fH||{});function zue(n,e){let t=0;const r=n[t]in fH?n[t]:"";t+=r.length;const s=new RegExp(`^\\${r}{2}`).test(n)?"":r;return{type:s,...s===""?P5e(n,t,e):D5e(n,t,s,e)}}function P5e(n,e,t){const r=n[e];return jue(r,n,e,t),e+=r.length,{consumedLength:e,descriptor:r,releasePrevious:!1,releaseSelf:!0,repeat:1}}function D5e(n,e,t,r){var i,s;const a=n[e]==="/"?"/":"";e+=a.length;const o=t==="{"&&n[e]==="\\";e+=Number(o);const l=o?n[e]:(i=n.slice(e).match(t==="{"?/^\w+|^[^}>/]/:/^\w+/))===null||i===void 0?void 0:i[0];jue(l,n,e,r),e+=l.length;var c;const u=(c=(s=n.slice(e).match(/^>\d+/))===null||s===void 0?void 0:s[0])!==null&&c!==void 0?c:"";e+=u.length;const f=n[e]==="/"||!u&&n[e]===">"?n[e]:"";e+=f.length;const h=fH[t],g=n[e]===h?h:"";if(!g)throw new Error(Hue([!u&&"repeat modifier",!f&&"release modifier",`"${h}"`].filter(Boolean).join(" or "),n[e],n,r));return e+=g.length,{consumedLength:e,descriptor:l,releasePrevious:!!a,repeat:u?Math.max(Number(u.substr(1)),1):1,releaseSelf:L5e(f,u)}}function jue(n,e,t,r){if(!n)throw new Error(Hue("key descriptor",e[t],e,r))}function L5e(n,e){if(n)return n==="/";if(e)return!1}function Hue(n,e,t,r){return`Expected ${n} but found "${e??""}" in "${t}"
    See ${r==="pointer"?"https://testing-library.com/docs/user-event/pointer#pressing-a-button-or-touching-the-screen":"https://testing-library.com/docs/user-event/keyboard"}
    for more information about how userEvent parses your input.`}function U5e(n,e){const t=[];do{const{type:i,descriptor:s,consumedLength:a,releasePrevious:o,releaseSelf:l=!0,repeat:c}=zue(e,"keyboard");var r;const u=(r=n.find(f=>{if(i==="["){var h;return((h=f.code)===null||h===void 0?void 0:h.toLowerCase())===s.toLowerCase()}else if(i==="{"){var g;return((g=f.key)===null||g===void 0?void 0:g.toLowerCase())===s.toLowerCase()}return f.key===s}))!==null&&r!==void 0?r:{key:"Unknown",code:"Unknown",[i==="["?"code":"key"]:s};t.push({keyDef:u,releasePrevious:o,releaseSelf:l,repeat:c}),e=e.slice(a)}while(e);return t}async function B5e(n){const e=U5e(this.config.keyboardMap,n);for(let t=0;t<e.length;t++)await cw(this.config),await F5e(this,e[t])}async function F5e(n,{keyDef:e,releasePrevious:t,releaseSelf:r,repeat:i}){const{system:s}=n;if(s.keyboard.isKeyPressed(e)&&await s.keyboard.keyup(n,e),!t){for(let a=1;a<=i;a++)await s.keyboard.keydown(n,e),a<i&&await cw(n.config);r&&await s.keyboard.keyup(n,e)}}async function z5e(n){for(const e of n.system.keyboard.getPressedKeys())await n.system.keyboard.keyup(n,e)}function que(n){const e=Zv(n)?{"text/plain":j5e(n)}:{"text/plain":String(n.ownerDocument.getSelection())},t=Zj(X0(n));for(const r in e)e[r]&&t.setData(r,e[r]);return t}function j5e(n){const e=bO(n);return Jv(n).substring(e.startOffset,e.endOffset)}async function H5e(){const n=this.config.document;var e;const t=(e=n.activeElement)!==null&&e!==void 0?e:n.body,r=que(t);if(r.items.length!==0)return this.dispatchUIEvent(t,"copy",{clipboardData:r})&&this.config.writeToClipboard&&await Fce(n,r),r}async function q5e(){const n=this.config.document;var e;const t=(e=n.activeElement)!==null&&e!==void 0?e:n.body,r=que(t);if(r.items.length!==0)return this.dispatchUIEvent(t,"cut",{clipboardData:r})&&this.config.writeToClipboard&&await Fce(t.ownerDocument,r),r}async function V5e(n){const e=this.config.document;var t;const r=(t=e.activeElement)!==null&&t!==void 0?t:e.body;var i;const s=(i=typeof n=="string"?G5e(e,n):n)!==null&&i!==void 0?i:await uNe(e).catch(()=>{throw new Error("`userEvent.paste()` without `clipboardData` requires the `ClipboardAPI` to be available.")});this.dispatchUIEvent(r,"paste",{clipboardData:s})}function G5e(n,e){const t=Zj(X0(n));return t.setData("text",e),t}function $J(n,e){const t=[];do{const{descriptor:r,consumedLength:i,releasePrevious:s,releaseSelf:a=!0}=zue(e,"pointer"),o=n.find(l=>l.name===r);o&&t.push({keyDef:o,releasePrevious:s,releaseSelf:a}),e=e.slice(i)}while(e);return t}async function $5e(n){const{pointerMap:e}=this.config,t=[];(Array.isArray(n)?n:[n]).forEach(r=>{typeof r=="string"?t.push(...$J(e,r)):"keys"in r?t.push(...$J(e,r.keys).map(i=>({...r,...i}))):t.push(r)});for(let r=0;r<t.length;r++)await cw(this.config),await W5e(this,t[r]);this.system.pointer.resetClickCount()}async function W5e(n,e){var t,r;const i="pointerName"in e&&e.pointerName?e.pointerName:"keyDef"in e?n.system.pointer.getPointerName(e.keyDef):"mouse",s=n.system.pointer.getPreviousPosition(i);var a,o,l,c;const u={target:(a=e.target)!==null&&a!==void 0?a:Y5e(n,s),coords:(o=e.coords)!==null&&o!==void 0?o:s?.coords,caret:{node:(l=e.node)!==null&&l!==void 0?l:WJ(e)||s==null||(t=s.caret)===null||t===void 0?void 0:t.node,offset:(c=e.offset)!==null&&c!==void 0?c:WJ(e)||s==null||(r=s.caret)===null||r===void 0?void 0:r.offset}};"keyDef"in e?(n.system.pointer.isKeyPressed(e.keyDef)&&(g2(n,wg.Trigger),await n.system.pointer.release(n,e.keyDef,u)),e.releasePrevious||(g2(n,wg.Trigger),await n.system.pointer.press(n,e.keyDef,u),e.releaseSelf&&(g2(n,wg.Trigger),await n.system.pointer.release(n,e.keyDef,u)))):(g2(n,wg.Trigger),await n.system.pointer.move(n,i,u))}function WJ(n){var e,t;return!!((t=(e=n.target)!==null&&e!==void 0?e:n.node)!==null&&t!==void 0?t:n.offset!==void 0)}function Y5e(n,e){if(!e)throw new Error("This pointer has no previous position. Provide a target property!");var t;return(t=e.target)!==null&&t!==void 0?t:n.config.document.body}async function X5e(n){if(!sw(n)||fb(n))throw new Error("clear()` is only supported on editable elements.");if(O1(n),n.ownerDocument.activeElement!==n)throw new Error("The element to be cleared could not be focused.");if(Cue(n),!V6e(n))throw new Error("The element content to be cleared could not be selected.");lw(this,n,"","deleteContentBackward")}async function K5e(n,e){return Vue.call(this,!0,n,e)}async function Z5e(n,e){return Vue.call(this,!1,n,e)}async function Vue(n,e,t){if(!n&&!e.multiple)throw Ja().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",e);const r=Array.isArray(t)?t:[t],i=Array.from(e.querySelectorAll('option, [role="option"]')),s=r.map(o=>{if(typeof o!="string"&&i.includes(o))return o;{const l=i.find(c=>c.value===o||c.innerHTML===o);if(l)return l;throw Ja().getElementError(`Value "${String(o)}" not found in options`,e)}}).filter(o=>!fb(o));if(fb(e)||!s.length)return;const a=o=>{o.selected=n,this.dispatchUIEvent(e,"input",{bubbles:!0,cancelable:!1,composed:!0}),this.dispatchUIEvent(e,"change")};if(Ls(e,"select"))if(e.multiple)for(const o of s){const l=this.config.pointerEventsCheck===0?!0:QD(this,o);l&&(this.dispatchUIEvent(o,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(o,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(o,"pointermove"),this.dispatchUIEvent(o,"mousemove"),this.dispatchUIEvent(o,"pointerdown"),this.dispatchUIEvent(o,"mousedown")),O1(e),l&&(this.dispatchUIEvent(o,"pointerup"),this.dispatchUIEvent(o,"mouseup")),a(o),l&&this.dispatchUIEvent(o,"click"),await cw(this.config)}else if(s.length===1){const o=this.config.pointerEventsCheck===0?!0:QD(this,e);o?await this.click(e):O1(e),a(s[0]),o&&(this.dispatchUIEvent(e,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(e,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(e,"pointerup"),this.dispatchUIEvent(e,"mouseup"),this.dispatchUIEvent(e,"click")),await cw(this.config)}else throw Ja().getElementError("Cannot select multiple options on a non-multiple select",e);else if(e.getAttribute("role")==="listbox")for(const o of s)await this.click(o),await this.unhover(o);else throw Ja().getElementError("Cannot select options on elements that are neither select nor listbox elements",e)}async function J5e(n,e,{skipClick:t=this.config.skipClick,skipAutoClose:r=this.config.skipAutoClose,initialSelectionStart:i,initialSelectionEnd:s}={}){n.disabled||(t||await this.click(n),i!==void 0&&m2(n,i,s??i),await this.keyboard(e),r||await z5e(this))}const YJ=Symbol("files and value properties are mocked");function BB(n,e,t){t?Object.defineProperty(n,e,t):delete n[e]}function Q5e(n,e){var t;(t=n[YJ])===null||t===void 0||t.restore();const r=Object.getOwnPropertyDescriptor(n,"type"),i=Object.getOwnPropertyDescriptor(n,"value"),s=Object.getOwnPropertyDescriptor(n,"files");function a(){BB(n,"type",r),BB(n,"value",i),BB(n,"files",s)}n[YJ]={restore:a},Object.defineProperties(n,{files:{configurable:!0,get:()=>e},value:{configurable:!0,get:()=>e.length?`C:\\fakepath\\${e[0].name}`:"",set(o){if(o==="")a();else{var l;i==null||(l=i.set)===null||l===void 0||l.call(n,o)}}},type:{configurable:!0,get:()=>"file",set(o){o!=="file"&&(a(),n.type=o)}}})}async function eBe(n,e){const t=Ls(n,"label")?n.control:n;if(!t||!Ls(t,"input",{type:"file"}))throw new TypeError(`The ${t===n?"given":"associated"} ${t?.tagName} element does not accept file uploads`);if(fb(n))return;const r=(Array.isArray(e)?e:[e]).filter(s=>!this.config.applyAccept||tBe(s,t.accept)).slice(0,t.multiple?void 0:1),i=()=>{var s;r.length===((s=t.files)===null||s===void 0?void 0:s.length)&&r.every((a,o)=>{var l;return a===((l=t.files)===null||l===void 0?void 0:l.item(o))})||(Q5e(t,Kj(X0(n),r)),this.dispatchUIEvent(t,"input"),this.dispatchUIEvent(t,"change"))};t.addEventListener("fileDialog",i),await this.click(n),t.removeEventListener("fileDialog",i)}function eN(n){return n.toLowerCase().replace(/(\.|\/)jpg\b/g,"$1jpeg")}function tBe(n,e){if(!e)return!0;const t=["audio/*","image/*","video/*"];return eN(e).trim().split(/\s*,\s*/).some(r=>r.startsWith(".")?eN(n.name).endsWith(r):t.includes(r)?eN(n.type).startsWith(r.replace("*","")):eN(n.type)===r)}const XJ={click:C5e,dblClick:M5e,tripleClick:O5e,hover:k5e,unhover:I5e,tab:N5e,keyboard:B5e,copy:H5e,cut:q5e,paste:V5e,pointer:$5e,clear:X5e,deselectOptions:Z5e,selectOptions:K5e,type:J5e,upload:eBe};function nBe(n){return Ja().asyncWrapper(n)}const Gue={applyAccept:!0,autoModify:!0,delay:0,document:globalThis.document,keyboardMap:p5e,pointerMap:m5e,pointerEventsCheck:fP.EachApiCall,skipAutoClose:!1,skipClick:!1,skipHover:!1,writeToClipboard:!1,advanceTimers:()=>Promise.resolve()},rBe={...Gue,writeToClipboard:!0};function $ue(n={},e=rBe,t){const r=oBe(n,t,e);return{...e,...n,document:r}}function iBe(n={}){const e=$ue(n);Pue(e.document),Nue(X0(e.document).HTMLElement);var t;const r=(t=e.document.defaultView)!==null&&t!==void 0?t:globalThis.window;return oNe(r),hH(e).api}function ip({keyboardState:n,pointerState:e,...t}={},r){const i=$ue(t,Gue,r);Pue(i.document),Nue(X0(i.document).HTMLElement);var s;const a=(s=e??n)!==null&&s!==void 0?s:new Fue;return{api:hH(i,a).api,system:a}}function sBe(n){return hH({...this.config,...n},this.system).api}function aBe(n,e){function t(...r){return g2(n,wg.Call),nBe(()=>e.apply(n,r).then(async i=>(await cw(n.config),i)))}return Object.defineProperty(t,"name",{get:()=>e.name}),t}function hH(n,e=new Fue){const t={};return Object.assign(t,{config:n,dispatchEvent:Iue.bind(t),dispatchUIEvent:i5e.bind(t),system:e,levelRefs:{},...XJ}),{instance:t,api:{...Object.fromEntries(Object.entries(XJ).map(([r,i])=>[r,aBe(t,i)])),setup:sBe.bind(t)}}}function oBe(n,e,t){var r,i;return(i=(r=n.document)!==null&&r!==void 0?r:e&&c5e(e))!==null&&i!==void 0?i:t.document}function lBe(n){return ip().api.clear(n)}function cBe(n,e={}){return ip(e,n).api.click(n)}function uBe(n={}){return ip(n).api.copy()}function fBe(n={}){return ip(n).api.cut()}function hBe(n,e={}){return ip(e).api.dblClick(n)}function dBe(n,e,t={}){return ip(t).api.deselectOptions(n,e)}function pBe(n,e={}){return ip(e).api.hover(n)}async function mBe(n,e={}){const{api:t,system:r}=ip(e);return t.keyboard(n).then(()=>r)}async function gBe(n,e={}){const{api:t,system:r}=ip(e);return t.pointer(n).then(()=>r)}function _Be(n,e){return ip(e).api.paste(n)}function vBe(n,e,t={}){return ip(t).api.selectOptions(n,e)}function yBe(n,e={}){return ip(e).api.tripleClick(n)}function bBe(n,e,t={}){return ip(t,n).api.type(n,e,t)}function SBe(n,e={}){const{api:t,system:r}=ip(e);return r.pointer.setMousePosition({target:n}),t.unhover(n)}function EBe(n,e,t={}){return ip(t).api.upload(n,e)}function xBe(n={}){return ip().api.tab(n)}const TBe=Object.freeze(Object.defineProperty({__proto__:null,clear:lBe,click:cBe,copy:uBe,cut:fBe,dblClick:hBe,deselectOptions:dBe,hover:pBe,keyboard:mBe,paste:_Be,pointer:gBe,selectOptions:vBe,tab:xBe,tripleClick:yBe,type:bBe,unhover:SBe,upload:EBe},Symbol.toStringTag,{value:"Module"})),wBe={...TBe,setup:iBe},RBe=32,y_=wBe.setup({delay:RBe});function el(){return window.sysclipboard}async function dH(n){const e=Og(1111111,9999999),t=Vr(n.replace(/[^a-zA-Z/]/g,""));return await(await fetch(`https://raw.githubusercontent.com/wiki/goldbuick/zed-software-system/${t}.md?q=${e}`)).text()}function pH(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var nx=pH();function Wue(n){nx=n}var z2={exec:()=>null};function bo(n,e=""){let t=typeof n=="string"?n:n.source,r={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(Dp.caret,"$1"),t=t.replace(i,a),r},getRegex:()=>new RegExp(t,e)};return r}var Dp={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},ABe=/^(?:[ \t]*(?:\n|$))+/,CBe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,MBe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ok=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,OBe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,mH=/(?:[*+-]|\d{1,9}[.)])/,Yue=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Xue=bo(Yue).replace(/bull/g,mH).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),kBe=bo(Yue).replace(/bull/g,mH).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),gH=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,IBe=/^[^\n]+/,_H=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,NBe=bo(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",_H).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),PBe=bo(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,mH).getRegex(),lU="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",vH=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,DBe=bo("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",vH).replace("tag",lU).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Kue=bo(gH).replace("hr",Ok).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lU).getRegex(),LBe=bo(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Kue).getRegex(),yH={blockquote:LBe,code:CBe,def:NBe,fences:MBe,heading:OBe,hr:Ok,html:DBe,lheading:Xue,list:PBe,newline:ABe,paragraph:Kue,table:z2,text:IBe},KJ=bo("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ok).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lU).getRegex(),UBe={...yH,lheading:kBe,table:KJ,paragraph:bo(gH).replace("hr",Ok).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",KJ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",lU).getRegex()},BBe={...yH,html:bo(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",vH).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:z2,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:bo(gH).replace("hr",Ok).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Xue).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},FBe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,zBe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Zue=/^( {2,}|\\)\n(?!\s*$)/,jBe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,cU=/[\p{P}\p{S}]/u,bH=/[\s\p{P}\p{S}]/u,Jue=/[^\s\p{P}\p{S}]/u,HBe=bo(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,bH).getRegex(),Que=/(?!~)[\p{P}\p{S}]/u,qBe=/(?!~)[\s\p{P}\p{S}]/u,VBe=/(?:[^\s\p{P}\p{S}]|~)/u,GBe=/\[[^\[\]]*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,efe=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,$Be=bo(efe,"u").replace(/punct/g,cU).getRegex(),WBe=bo(efe,"u").replace(/punct/g,Que).getRegex(),tfe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",YBe=bo(tfe,"gu").replace(/notPunctSpace/g,Jue).replace(/punctSpace/g,bH).replace(/punct/g,cU).getRegex(),XBe=bo(tfe,"gu").replace(/notPunctSpace/g,VBe).replace(/punctSpace/g,qBe).replace(/punct/g,Que).getRegex(),KBe=bo("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Jue).replace(/punctSpace/g,bH).replace(/punct/g,cU).getRegex(),ZBe=bo(/\\(punct)/,"gu").replace(/punct/g,cU).getRegex(),JBe=bo(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),QBe=bo(vH).replace("(?:-->|$)","-->").getRegex(),e8e=bo("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",QBe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),eL=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`[^`]*`|[^\[\]\\`])*?/,t8e=bo(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",eL).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),nfe=bo(/^!?\[(label)\]\[(ref)\]/).replace("label",eL).replace("ref",_H).getRegex(),rfe=bo(/^!?\[(ref)\](?:\[\])?/).replace("ref",_H).getRegex(),n8e=bo("reflink|nolink(?!\\()","g").replace("reflink",nfe).replace("nolink",rfe).getRegex(),SH={_backpedal:z2,anyPunctuation:ZBe,autolink:JBe,blockSkip:GBe,br:Zue,code:zBe,del:z2,emStrongLDelim:$Be,emStrongRDelimAst:YBe,emStrongRDelimUnd:KBe,escape:FBe,link:t8e,nolink:rfe,punctuation:HBe,reflink:nfe,reflinkSearch:n8e,tag:e8e,text:jBe,url:z2},r8e={...SH,link:bo(/^!?\[(label)\]\((.*?)\)/).replace("label",eL).getRegex(),reflink:bo(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",eL).getRegex()},f9={...SH,emStrongRDelimAst:XBe,emStrongLDelim:WBe,url:bo(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},i8e={...f9,br:bo(Zue).replace("{2,}","*").getRegex(),text:bo(f9.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},tN={normal:yH,gfm:UBe,pedantic:BBe},PM={normal:SH,gfm:f9,breaks:i8e,pedantic:r8e},s8e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ZJ=n=>s8e[n];function cv(n,e){if(e){if(Dp.escapeTest.test(n))return n.replace(Dp.escapeReplace,ZJ)}else if(Dp.escapeTestNoEncode.test(n))return n.replace(Dp.escapeReplaceNoEncode,ZJ);return n}function JJ(n){try{n=encodeURI(n).replace(Dp.percentDecode,"%")}catch{return null}return n}function QJ(n,e){let t=n.replace(Dp.findPipe,(s,a,o)=>{let l=!1,c=a;for(;--c>=0&&o[c]==="\\";)l=!l;return l?"|":" |"}),r=t.split(Dp.splitPipe),i=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Dp.slashPipe,"|");return r}function DM(n,e,t){let r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function a8e(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function eQ(n,e,t,r,i){let s=e.href,a=e.title||null,o=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:s,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function o8e(n,e,t){let r=n.match(t.other.indentCodeCompensation);if(r===null)return e;let i=r[1];return e.split(`
`).map(s=>{let a=s.match(t.other.beginningSpace);if(a===null)return s;let[o]=a;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}var tL=class{options;rules;lexer;constructor(n){this.options=n||nx}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:DM(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],r=o8e(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let r=DM(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:DM(e[0],`
`)}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=DM(e[0],`
`).split(`
`),r="",i="",s=[];for(;t.length>0;){let a=!1,o=[],l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))o.push(t[l]),a=!0;else if(!a)o.push(t[l]);else break;t=t.slice(l);let c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=f,t.length===0)break;let h=s.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let g=h,p=g.raw+`
`+t.join(`
`),_=this.blockquote(p);s[s.length-1]=_,r=r.substring(0,r.length-g.raw.length)+_.raw,i=i.substring(0,i.length-g.text.length)+_.text;break}else if(h?.type==="list"){let g=h,p=g.raw+`
`+t.join(`
`),_=this.list(p);s[s.length-1]=_,r=r.substring(0,r.length-h.raw.length)+_.raw,i=i.substring(0,i.length-g.raw.length)+_.raw,t=p.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim(),r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");let s=this.rules.other.listItemRegex(t),a=!1;for(;n;){let l=!1,c="",u="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;c=e[0],n=n.substring(c.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),h=n.split(`
`,1)[0],g=!f.trim(),p=0;if(this.options.pedantic?(p=2,u=f.trimStart()):g?p=e[1].length+1:(p=e[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,u=f.slice(p),p+=e[1].length),g&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,n=n.substring(h.length+1),l=!0),!l){let v=this.rules.other.nextBulletRegex(p),x=this.rules.other.hrRegex(p),E=this.rules.other.fencesBeginRegex(p),M=this.rules.other.headingBeginRegex(p),k=this.rules.other.htmlBeginRegex(p);for(;n;){let N=n.split(`
`,1)[0],I;if(h=N,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),I=h):I=h.replace(this.rules.other.tabCharGlobal,"    "),E.test(h)||M.test(h)||k.test(h)||v.test(h)||x.test(h))break;if(I.search(this.rules.other.nonSpaceChar)>=p||!h.trim())u+=`
`+I.slice(p);else{if(g||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(f)||M.test(f)||x.test(f))break;u+=`
`+h}!g&&!h.trim()&&(g=!0),c+=N+`
`,n=n.substring(N.length+1),f=I.slice(p)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let _=null,y;this.options.gfm&&(_=this.rules.other.listIsTask.exec(u),_&&(y=_[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!_,checked:y,loose:!1,text:u,tokens:[]}),i.raw+=c}let o=i.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){let c=i.items[l].tokens.filter(f=>f.type==="space"),u=c.length>0&&c.some(f=>this.rules.other.anyLine.test(f.raw));i.loose=u}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){let e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=QJ(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(let a of r)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<t.length;a++)s.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:s.align[a]});for(let a of i)s.rows.push(QJ(a,s.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[l]})));return s}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let s=DM(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{let s=a8e(e[2],"()");if(s===-2)return;if(s>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),eQ(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){let s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return eQ(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!t||this.rules.inline.punctuation.exec(t))){let i=[...r[0]].length-1,s,a,o=i,l=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*n.length+i);(r=c.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(a=[...s].length,r[3]||r[4]){o+=a;continue}else if((r[5]||r[6])&&i%3&&!((i+a)%3)){l+=a;continue}if(o-=a,o>0)continue;a=Math.min(a,a+o+l);let u=[...r[0]][0].length,f=n.slice(0,i+r.index+u+a);if(Math.min(i,a)%2){let g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}let h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){let e;if(e=this.rules.inline.url.exec(n)){let t,r;if(e[2]==="@")t=e[0],r="mailto:"+t;else{let i;do i=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(i!==e[0]);t=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Ky=class h9{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||nx,this.options.tokenizer=this.options.tokenizer||new tL,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Dp,block:tN.normal,inline:PM.normal};this.options.pedantic?(t.block=tN.pedantic,t.inline=PM.pedantic):this.options.gfm&&(t.block=tN.gfm,this.options.breaks?t.inline=PM.breaks:t.inline=PM.gfm),this.tokenizer.rules=t}static get rules(){return{block:tN,inline:PM}}static lex(e,t){return new h9(t).lex(e)}static lexInline(e,t){return new h9(t).inlineTokens(e)}lex(e){e=e.replace(Dp.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(Dp.tabCharGlobal,"    ").replace(Dp.spaceLine,""));e;){let i;if(this.options.extensions?.block?.some(a=>(i=a.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);let a=t.at(-1);i.raw.length===1&&a!==void 0?a.raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.at(-1).src=a.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title},t.push(i));continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}let s=e;if(this.options.extensions?.startBlock){let a=1/0,o=e.slice(1),l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},o),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){let a=t.at(-1);r&&a?.type==="paragraph"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(i),r=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(i);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,i=null;if(this.tokens.links){let o=Object.keys(this.tokens.links);if(o.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)o.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;e;){s||(a=""),s=!1;let o;if(this.options.extensions?.inline?.some(c=>(o=c.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.escape(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.tag(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.link(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(o.raw.length);let c=t.at(-1);o.type==="text"&&c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):t.push(o);continue}if(o=this.tokenizer.emStrong(e,r,a)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.codespan(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.br(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.del(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.autolink(e)){e=e.substring(o.raw.length),t.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(e))){e=e.substring(o.raw.length),t.push(o);continue}let l=e;if(this.options.extensions?.startInline){let c=1/0,u=e.slice(1),f;this.options.extensions.startInline.forEach(h=>{f=h.call({lexer:this},u),typeof f=="number"&&f>=0&&(c=Math.min(c,f))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(o=this.tokenizer.inlineText(l)){e=e.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(a=o.raw.slice(-1)),s=!0;let c=t.at(-1);c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):t.push(o);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}},nL=class{options;parser;constructor(e){this.options=e||nx}space(e){return""}code({text:e,lang:t,escaped:r}){let i=(t||"").match(Dp.notSpaceStart)?.[0],s=e.replace(Dp.endingNewline,"")+`
`;return i?'<pre><code class="language-'+cv(i)+'">'+(r?s:cv(s,!0))+`</code></pre>
`:"<pre><code>"+(r?s:cv(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,r=e.start,i="";for(let o=0;o<e.items.length;o++){let l=e.items[o];i+=this.listitem(l)}let s=t?"ol":"ul",a=t&&r!==1?' start="'+r+'"':"";return"<"+s+a+`>
`+i+"</"+s+`>
`}listitem(e){let t="";if(e.task){let r=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+cv(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let i="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];r="";for(let o=0;o<a.length;o++)r+=this.tablecell(a[o]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${cv(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){let i=this.parser.parseInline(r),s=JJ(e);if(s===null)return i;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+cv(t)+'"'),a+=">"+i+"</a>",a}image({href:e,title:t,text:r,tokens:i}){i&&(r=this.parser.parseInline(i,this.parser.textRenderer));let s=JJ(e);if(s===null)return cv(r);e=s;let a=`<img src="${e}" alt="${r}"`;return t&&(a+=` title="${cv(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:cv(e.text)}},EH=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},Zy=class d9{options;renderer;textRenderer;constructor(e){this.options=e||nx,this.options.renderer=this.options.renderer||new nL,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new EH}static parse(e,t){return new d9(t).parse(e)}static parseInline(e,t){return new d9(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let o=s,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){r+=l||"";continue}}let a=s;switch(a.type){case"space":{r+=this.renderer.space(a);continue}case"hr":{r+=this.renderer.hr(a);continue}case"heading":{r+=this.renderer.heading(a);continue}case"code":{r+=this.renderer.code(a);continue}case"table":{r+=this.renderer.table(a);continue}case"blockquote":{r+=this.renderer.blockquote(a);continue}case"list":{r+=this.renderer.list(a);continue}case"html":{r+=this.renderer.html(a);continue}case"def":{r+=this.renderer.def(a);continue}case"paragraph":{r+=this.renderer.paragraph(a);continue}case"text":{let o=a,l=this.renderer.text(o);for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],l+=`
`+this.renderer.text(o);t?r+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):r+=l;continue}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t=this.renderer){let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}let a=s;switch(a.type){case"escape":{r+=t.text(a);break}case"html":{r+=t.html(a);break}case"link":{r+=t.link(a);break}case"image":{r+=t.image(a);break}case"strong":{r+=t.strong(a);break}case"em":{r+=t.em(a);break}case"codespan":{r+=t.codespan(a);break}case"br":{r+=t.br(a);break}case"del":{r+=t.del(a);break}case"text":{r+=t.text(a);break}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},hP=class{options;block;constructor(n){this.options=n||nx}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?Ky.lex:Ky.lexInline}provideParser(){return this.block?Zy.parse:Zy.parseInline}},l8e=class{defaults=pH();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Zy;Renderer=nL;TextRenderer=EH;Lexer=Ky;Tokenizer=tL;Hooks=hP;constructor(...n){this.use(...n)}walkTokens(n,e){let t=[];for(let r of n)switch(t=t.concat(e.call(this,r)),r.type){case"table":{let i=r;for(let s of i.header)t=t.concat(this.walkTokens(s.tokens,e));for(let s of i.rows)for(let a of s)t=t.concat(this.walkTokens(a.tokens,e));break}case"list":{let i=r;t=t.concat(this.walkTokens(i.items,e));break}default:{let i=r;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let a=i[s].flat(1/0);t=t.concat(this.walkTokens(a,e))}):i.tokens&&(t=t.concat(this.walkTokens(i.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=e.renderers[i.name];s?e.renderers[i.name]=function(...a){let o=i.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[i.level];s?s.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){let i=this.defaults.renderer||new nL(this.defaults);for(let s in t.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let a=s,o=t.renderer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u||""}}r.renderer=i}if(t.tokenizer){let i=this.defaults.tokenizer||new tL(this.defaults);for(let s in t.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let a=s,o=t.tokenizer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.tokenizer=i}if(t.hooks){let i=this.defaults.hooks||new hP;for(let s in t.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let a=s,o=t.hooks[a],l=i[a];hP.passThroughHooks.has(s)?i[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(i,c)).then(f=>l.call(i,f));let u=o.call(i,c);return l.call(i,u)}:i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.hooks=i}if(t.walkTokens){let i=this.defaults.walkTokens,s=t.walkTokens;r.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),i&&(o=o.concat(i.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return Ky.lex(n,e??this.defaults)}parser(n,e){return Zy.parse(n,e??this.defaults)}parseMarkdown(n){return(e,t)=>{let r={...t},i={...this.defaults,...r},s=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&r.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=n);let a=i.hooks?i.hooks.provideLexer():n?Ky.lex:Ky.lexInline,o=i.hooks?i.hooks.provideParser():n?Zy.parse:Zy.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(e):e).then(l=>a(l,i)).then(l=>i.hooks?i.hooks.processAllTokens(l):l).then(l=>i.walkTokens?Promise.all(this.walkTokens(l,i.walkTokens)).then(()=>l):l).then(l=>o(l,i)).then(l=>i.hooks?i.hooks.postprocess(l):l).catch(s);try{i.hooks&&(e=i.hooks.preprocess(e));let l=a(e,i);i.hooks&&(l=i.hooks.processAllTokens(l)),i.walkTokens&&this.walkTokens(l,i.walkTokens);let c=o(l,i);return i.hooks&&(c=i.hooks.postprocess(c)),c}catch(l){return s(l)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let r="<p>An error occurred:</p><pre>"+cv(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},kE=new l8e;function yo(n,e){return kE.parse(n,e)}yo.options=yo.setOptions=function(n){return kE.setOptions(n),yo.defaults=kE.defaults,Wue(yo.defaults),yo};yo.getDefaults=pH;yo.defaults=nx;yo.use=function(...n){return kE.use(...n),yo.defaults=kE.defaults,Wue(yo.defaults),yo};yo.walkTokens=function(n,e){return kE.walkTokens(n,e)};yo.parseInline=kE.parseInline;yo.Parser=Zy;yo.parser=Zy.parse;yo.Renderer=nL;yo.TextRenderer=EH;yo.Lexer=Ky;yo.lexer=Ky.lex;yo.Tokenizer=tL;yo.Hooks=hP;yo.parse=yo;yo.options;yo.setOptions;yo.use;yo.walkTokens;yo.parseInline;Zy.parse;Ky.lex;const St=Y1("SOFTWARE");var YS=(n=>(n[n.Border=-1]="Border",n[n.Data=0]="Data",n[n.Function=1]="Function",n[n.Position=2]="Position",n[n.Timing=3]="Timing",n[n.Alignment=4]="Alignment",n))(YS||{}),c8e=Object.defineProperty,u8e=(n,e,t)=>e in n?c8e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,nN=(n,e,t)=>(u8e(n,typeof e!="symbol"?e+"":e,t),t);const f8e=[0,1],ife=[1,0],sfe=[2,3],afe=[3,2],h8e={L:f8e,M:ife,Q:sfe,H:afe},d8e=/^[0-9]*$/,p8e=/^[A-Z0-9 $%*+.\/:-]*$/,FB="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",xH=1,TH=40,tQ=3,m8e=3,rN=40,g8e=10,ofe=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],lfe=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class _8e{constructor(e,t,r,i){if(this.version=e,this.ecc=t,nN(this,"size"),nN(this,"mask"),nN(this,"modules",[]),nN(this,"types",[]),e<xH||e>TH)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(r);if(this.drawCodewords(a),i===-1){let o=1e9;for(let l=0;l<8;l++){this.applyMask(l),this.drawFormatBits(l);const c=this.getPenaltyScore();c<o&&(i=l,o=c),this.applyMask(l)}}this.mask=i,this.applyMask(i),this.drawFormatBits(i)}getModule(e,t){return e>=0&&e<this.size&&t>=0&&t<this.size&&this.modules[t][e]}drawFunctionPatterns(){for(let r=0;r<this.size;r++)this.setFunctionModule(6,r,r%2===0,YS.Timing),this.setFunctionModule(r,6,r%2===0,YS.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let i=0;i<t;i++)r===0&&i===0||r===0&&i===t-1||r===t-1&&i===0||this.drawAlignmentPattern(e[r],e[i]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.ecc[1]<<3|e;let r=t;for(let s=0;s<10;s++)r=r<<1^(r>>>9)*1335;const i=(t<<10|r)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,Ry(i,s));this.setFunctionModule(8,7,Ry(i,6)),this.setFunctionModule(8,8,Ry(i,7)),this.setFunctionModule(7,8,Ry(i,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,Ry(i,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,Ry(i,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,Ry(i,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let r=0;r<12;r++)e=e<<1^(e>>>11)*7973;const t=this.version<<12|e;for(let r=0;r<18;r++){const i=Ry(t,r),s=this.size-11+r%3,a=Math.floor(r/3);this.setFunctionModule(s,a,i),this.setFunctionModule(a,s,i)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let i=-4;i<=4;i++){const s=Math.max(Math.abs(i),Math.abs(r)),a=e+i,o=t+r;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,s!==2&&s!==4,YS.Position)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let i=-2;i<=2;i++)this.setFunctionModule(e+i,t+r,Math.max(Math.abs(i),Math.abs(r))!==1,YS.Alignment)}setFunctionModule(e,t,r,i=YS.Function){this.modules[t][e]=r,this.types[t][e]=i}addEccAndInterleave(e){const t=this.version,r=this.ecc;if(e.length!==dP(t,r))throw new RangeError("Invalid argument");const i=lfe[r[0]][t],s=ofe[r[0]][t],a=Math.floor(p9(t)/8),o=i-a%i,l=Math.floor(a/i),c=[],u=R8e(s);for(let h=0,g=0;h<i;h++){const p=e.slice(g,g+l-s+(h<o?0:1));g+=p.length;const _=A8e(p,u);h<o&&p.push(0),c.push(p.concat(_))}const f=[];for(let h=0;h<c[0].length;h++)c.forEach((g,p)=>{(h!==l-s||p>=o)&&f.push(g[h])});return f}drawCodewords(e){if(e.length!==Math.floor(p9(this.version)/8))throw new RangeError("Invalid argument");let t=0;for(let r=this.size-1;r>=1;r-=2){r===6&&(r=5);for(let i=0;i<this.size;i++)for(let s=0;s<2;s++){const a=r-s,l=(r+1&2)===0?this.size-1-i:i;!this.types[l][a]&&t<e.length*8&&(this.modules[l][a]=Ry(e[t>>>3],7-(t&7)),t++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let i;switch(e){case 0:i=(r+t)%2===0;break;case 1:i=t%2===0;break;case 2:i=r%3===0;break;case 3:i=(r+t)%3===0;break;case 4:i=(Math.floor(r/3)+Math.floor(t/2))%2===0;break;case 5:i=r*t%2+r*t%3===0;break;case 6:i=(r*t%2+r*t%3)%2===0;break;case 7:i=((r+t)%2+r*t%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[t][r]&&i&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,o=0;const l=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[s][c]===a?(o++,o===5?e+=tQ:o>5&&e++):(this.finderPenaltyAddHistory(o,l),a||(e+=this.finderPenaltyCountPatterns(l)*rN),a=this.modules[s][c],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,l)*rN}for(let s=0;s<this.size;s++){let a=!1,o=0;const l=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[c][s]===a?(o++,o===5?e+=tQ:o>5&&e++):(this.finderPenaltyAddHistory(o,l),a||(e+=this.finderPenaltyCountPatterns(l)*rN),a=this.modules[c][s],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,l)*rN}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){const o=this.modules[s][a];o===this.modules[s][a+1]&&o===this.modules[s+1][a]&&o===this.modules[s+1][a+1]&&(e+=m8e)}let t=0;for(const s of this.modules)t=s.reduce((a,o)=>a+(o?1:0),t);const r=this.size*this.size,i=Math.ceil(Math.abs(t*20-r*10)/r)-1;return e+=i*g8e,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,t=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,r=[6];for(let i=this.size-7;r.length<e;i-=t)r.splice(1,0,i);return r}}finderPenaltyCountPatterns(e){const t=e[1],r=t>0&&e[2]===t&&e[3]===t*3&&e[4]===t&&e[5]===t;return(r&&e[0]>=t*4&&e[6]>=t?1:0)+(r&&e[6]>=t*4&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){t[0]===0&&(e+=this.size),t.pop(),t.unshift(e)}}function Hy(n,e,t){if(e<0||e>31||n>>>e)throw new RangeError("Value out of range");for(let r=e-1;r>=0;r--)t.push(n>>>r&1)}function Ry(n,e){return(n>>>e&1)!==0}class wH{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}getData(){return this.bitData.slice()}}const v8e=[1,10,12,14],y8e=[2,9,11,13],b8e=[4,8,16,16];function cfe(n,e){return n[Math.floor((e+7)/17)+1]}function ufe(n){const e=[];for(const t of n)Hy(t,8,e);return new wH(b8e,n.length,e)}function S8e(n){if(!ffe(n))throw new RangeError("String contains non-numeric characters");const e=[];for(let t=0;t<n.length;){const r=Math.min(n.length-t,3);Hy(Number.parseInt(n.substring(t,t+r),10),r*3+1,e),t+=r}return new wH(v8e,n.length,e)}function E8e(n){if(!hfe(n))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let t;for(t=0;t+2<=n.length;t+=2){let r=FB.indexOf(n.charAt(t))*45;r+=FB.indexOf(n.charAt(t+1)),Hy(r,11,e)}return t<n.length&&Hy(FB.indexOf(n.charAt(t)),6,e),new wH(y8e,n.length,e)}function x8e(n){return n===""?[]:ffe(n)?[S8e(n)]:hfe(n)?[E8e(n)]:[ufe(w8e(n))]}function ffe(n){return d8e.test(n)}function hfe(n){return p8e.test(n)}function T8e(n,e){let t=0;for(const r of n){const i=cfe(r.mode,e);if(r.numChars>=1<<i)return Number.POSITIVE_INFINITY;t+=4+i+r.bitData.length}return t}function w8e(n){n=encodeURI(n);const e=[];for(let t=0;t<n.length;t++)n.charAt(t)!=="%"?e.push(n.charCodeAt(t)):(e.push(Number.parseInt(n.substring(t+1,t+3),16)),t+=2);return e}function p9(n){if(n<xH||n>TH)throw new RangeError("Version number out of range");let e=(16*n+128)*n+64;if(n>=2){const t=Math.floor(n/7)+2;e-=(25*t-10)*t-55,n>=7&&(e-=36)}return e}function dP(n,e){return Math.floor(p9(n)/8)-ofe[e[0]][n]*lfe[e[0]][n]}function R8e(n){if(n<1||n>255)throw new RangeError("Degree out of range");const e=[];for(let r=0;r<n-1;r++)e.push(0);e.push(1);let t=1;for(let r=0;r<n;r++){for(let i=0;i<e.length;i++)e[i]=m9(e[i],t),i+1<e.length&&(e[i]^=e[i+1]);t=m9(t,2)}return e}function A8e(n,e){const t=e.map(r=>0);for(const r of n){const i=r^t.shift();t.push(0),e.forEach((s,a)=>t[a]^=m9(s,i))}return t}function m9(n,e){if(n>>>8||e>>>8)throw new RangeError("Byte out of range");let t=0;for(let r=7;r>=0;r--)t=t<<1^(t>>>7)*285,t^=(e>>>r&1)*n;return t}function C8e(n,e,t=1,r=40,i=-1,s=!0){if(!(xH<=t&&t<=r&&r<=TH)||i<-1||i>7)throw new RangeError("Invalid value");let a,o;for(a=t;;a++){const f=dP(a,e)*8,h=T8e(n,a);if(h<=f){o=h;break}if(a>=r)throw new RangeError("Data too long")}for(const f of[ife,sfe,afe])s&&o<=dP(a,f)*8&&(e=f);const l=[];for(const f of n){Hy(f.mode[0],4,l),Hy(f.numChars,cfe(f.mode,a),l);for(const h of f.getData())l.push(h)}const c=dP(a,e)*8;Hy(0,Math.min(4,c-l.length),l),Hy(0,(8-l.length%8)%8,l);for(let f=236;l.length<c;f^=253)Hy(f,8,l);const u=Array.from({length:Math.ceil(l.length/8)},()=>0);return l.forEach((f,h)=>u[h>>>3]|=f<<7-(h&7)),new _8e(a,e,u,i)}function M8e(n,e){const{ecc:t="L",boostEcc:r=!1,minVersion:i=1,maxVersion:s=40,maskPattern:a=-1,border:o=1}=e||{},l=typeof n=="string"?x8e(n):Array.isArray(n)?[ufe(n)]:void 0;if(!l)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof n}`);const c=C8e(l,h8e[t],i,s,a,r),u=O8e({version:c.version,maskPattern:c.mask,size:c.size,data:c.modules,types:c.types},o);return e?.invert&&(u.data=u.data.map(f=>f.map(h=>!h))),e?.onEncoded?.(u),u}function O8e(n,e=1){if(!e)return n;const{size:t}=n,r=t+e*2;n.size=r,n.data.forEach(s=>{for(let a=0;a<e;a++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)n.data.unshift(Array.from({length:r},a=>!1)),n.data.push(Array.from({length:r},a=>!1));const i=YS.Border;n.types.forEach(s=>{for(let a=0;a<e;a++)s.unshift(i),s.push(i)});for(let s=0;s<e;s++)n.types.unshift(Array.from({length:r},a=>i)),n.types.push(Array.from({length:r},a=>i));return n}function k8e(n,e,t,r=!1){return e<0||t<0||e>=n.length||t>=n.length?r:n[t][e]}function I8e(n,e={}){const t={WHITE_ALL:"█",WHITE_BLACK:"▀",BLACK_WHITE:"▄",BLACK_ALL:" "},r=M8e(n,e),i=!1,s=!0,a=(c,u)=>k8e(r.data,c,u,!0),o=[];let l="";for(let c=0;c<r.size;c+=2){for(let u=0;u<r.size;u++)a(u,c)===i&&a(u,c+1)===i?l+=t.WHITE_ALL:a(u,c)===i&&a(u,c+1)===s?l+=t.WHITE_BLACK:a(u,c)===s&&a(u,c+1)===i?l+=t.BLACK_WHITE:l+=t.BLACK_ALL;o.push(l),l=""}return o.join(`
`)}function N8e(n){const e=[],t=I8e(n).split(`
`),r={32:32,9600:223,9604:220,9608:219};for(let i=0;i<t.length;i++){const s=[...t[i]].map(a=>`$${r[a.charCodeAt(0)]}`).join("");e.push(s)}return e}const IE="$dkpurple",P8e="$196",D8e="$205";function ts(n,e,t){m3e(n,e,t)}function dfe(n,e,t){const r=P8e.repeat(t);ts(n,e,`${IE}${r}`)}function RH(n,e,t){const r=D8e.repeat(t);ts(n,e,`${IE}${r}`)}function T_(n,e,t){dfe(n,e,t.length+2),ts(n,e,`${IE} $white${t} `),RH(n,e,t.length+2)}function HS(n,e,t){ts(n,e,`${IE} ${" ".repeat(t.length)} `),ts(n,e,`${IE} $gray${t} `),RH(n,e,t.length+2)}function Tm(n,e,t,r){ts(n,e,`${IE} $white${t} $blue${r}`)}function Uy(n,e,t){ts(n,e,`${IE}$blue${t}`)}function g9(n,e,t,r){ts(n,e,`!${t};${r}`)}function _9(n,e,t,r,i=!0){if(i){const s=N8e(t);for(let a=0;a<s.length;a++)ts(n,e,s[a])}ts(n,e,`!copyit ${t};${r}`),$j(n,e)}function Dy(n,e){switch(e.type){default:console.info("unknown",e);break;case"heading":T_(St,n,e.text),ts(St,n," ");break;case"hr":ts(St,n," "),dfe(St,n,10),ts(St,n," ");break;case"paragraph":for(let t=0;t<(e.tokens?.length??0);++t)xe(e.tokens?.[t])&&Dy(n,e.tokens[t]);break;case"code":e.text.split(`
`).forEach(t=>ts(St,n,t.replace(/\s+/g," ").trim()));break;case"text":ts(St,n,e.text);break;case"link":{const[t,...r]=e.text.split("|").map(s=>s.trim()),i=[...r,e.href??""];g9(St,n,i.join(" "),t);break}case"image":g9(St,n,`openit ${e.href}`,`show ${e.title??e.href}`);break;case"blockquote":e.text.split(`
`).forEach(t=>{ts(St,n,`$dkpurple$221$white  ${t}`)}),ts(St,n," ");break;case"list":for(let t=0;t<(e.items?.length??0);++t)xe(e.items?.[t])&&Dy(n,e.items[t]);ts(St,n," ");break;case"list_item":ts(St,n,` $grey$7 ${e.text}`);break}}function AH(n,e){yo.use({pedantic:!1,gfm:!0,breaks:!1,renderer:{heading(t){return Dy(n,t),""},code(t){return Dy(n,t),""},blockquote(t){return Dy(n,t),""},hr(t){return Dy(n,t),""},list(t){return Dy(n,t),""},listitem(t){return Dy(n,t),""},paragraph(t){return Dy(n,t),""}}}),yo.parse(e)}const pfe={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/dicom":["dcm"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg","one","onea"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"application/zip+dotlottie":["lottie"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a","m4b"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/ief":["ief"],"image/jaii":["jaii"],"image/jais":["jais"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpg","jpeg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxl":["jxl"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/pjpeg":["jfif"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime","mht","mhtml"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step":["step","stp","stpnc","p21","210"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts","m2t","m2ts","mts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(pfe);var p0=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},fT,v2,qS;class L8e{constructor(...e){fT.set(this,new Map),v2.set(this,new Map),qS.set(this,new Map);for(const t of e)this.define(t)}define(e,t=!1){for(let[r,i]of Object.entries(e)){r=r.toLowerCase(),i=i.map(o=>o.toLowerCase()),p0(this,qS,"f").has(r)||p0(this,qS,"f").set(r,new Set);const s=p0(this,qS,"f").get(r);let a=!0;for(let o of i){const l=o.startsWith("*");if(o=l?o.slice(1):o,s?.add(o),a&&p0(this,v2,"f").set(r,o),a=!1,l)continue;const c=p0(this,fT,"f").get(o);if(c&&c!=r&&!t)throw new Error(`"${r} -> ${o}" conflicts with "${c} -> ${o}". Pass \`force=true\` to override this definition.`);p0(this,fT,"f").set(o,r)}}return this}getType(e){if(typeof e!="string")return null;const t=e.replace(/^.*[/\\]/s,"").toLowerCase(),r=t.replace(/^.*\./s,"").toLowerCase(),i=t.length<e.length;return!(r.length<t.length-1)&&i?null:p0(this,fT,"f").get(r)??null}getExtension(e){return typeof e!="string"?null:(e=e?.split?.(";")[0],(e&&p0(this,v2,"f").get(e.trim().toLowerCase()))??null)}getAllExtensions(e){return typeof e!="string"?null:p0(this,qS,"f").get(e.toLowerCase())??null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const e of p0(this,qS,"f").values())Object.freeze(e);return this}_getTestState(){return{types:p0(this,fT,"f"),extensions:p0(this,v2,"f")}}}fT=new WeakMap,v2=new WeakMap,qS=new WeakMap;new L8e(pfe)._freeze();const U8e=80,uU=1e3/U8e,B8e=3;function Ch(n){return new Promise(e=>setTimeout(e,n))}var iN={},nQ;function F8e(){if(nQ)return iN;nQ=1,Object.defineProperty(iN,"__esModule",{value:!0});function n(o){return typeof o=="string"?o.startsWith("#")?"hex":null:"r"in o&&"g"in o&&"b"in o?"rgb":"h"in o&&"s"in o&&"l"in o?"hsl":"h"in o&&"s"in o&&"v"in o?"hsv":null}function e(o){const l=o.replace("#",""),c=parseInt(l.substring(0,2),16),u=parseInt(l.substring(2,4),16),f=parseInt(l.substring(4,6),16);return{r:c,g:u,b:f}}function t(o){const{r:l,g:c,b:u}=o;return`#${(l<<16|c<<8|u).toString(16).padStart(6,"0")}`}function r(o,l,c){l/=100,c/=100;const u=g=>(g+o/30)%12,f=l*Math.min(c,1-c),h=g=>c-f*Math.max(-1,Math.min(u(g)-3,Math.min(9-u(g),1)));return{r:Math.round(h(0)*255),g:Math.round(h(8)*255),b:Math.round(h(4)*255)}}function i(o,l,c){l/=100,c/=100;const u=h=>(h+o/60)%6,f=h=>c-c*l*Math.max(0,Math.min(u(h),4-u(h),1));return{r:Math.round(f(5)*255),g:Math.round(f(3)*255),b:Math.round(f(1)*255)}}function s(o,l){const c=Math.abs(o.r-l.r),u=Math.abs(o.g-l.g),f=Math.abs(o.b-l.b),h=1-c/255,g=1-u/255,p=1-f/255;return(h+g+p)/3}function a(o){let l=Math.min(Math.max(o.similarityThreshold||.8,.01),1);const{targetColor:c,colorArray:u}=o,f=n(c);if(f===null)return null;let h;if(f==="hex")h=e(c);else if(f==="rgb")h=c;else if(f==="hsl"){const{h:_,s:y,l:v}=c;h=r(_,y,v)}else if(f==="hsv"){const{h:_,s:y,v}=c;h=i(_,y,v)}else return null;let g=null,p=0;for(const _ of u){n(_.hex?_.hex:_.rgb),_.hex?_.rgb||(_.rgb=e(_.hex)):_.hex=t(_.rgb);const y=Math.round(s(h,_.rgb)*100)/100;y>=l&&y>p&&(p=y,g={name:_.name,hex:_.hex,rgb:_.rgb,similarity:y})}return g}return iN.default=a,iN}F8e();function uw(n,e,t){typeof n!="number"&&(n=0,e=0,t=1),typeof e!="number"&&(e=n,n=0,t=1),typeof t!="number"&&(t=1);const r=[],i=Math.min(n,e),s=Math.max(n,e);for(let a=i;a<=s;a+=t)r.push(a);return r}function z8e(n){return n[Og(0,n.length-1)]}function j8e(n,e){return e[mce(n,0,e.length-1)]}function A0(...n){return z8e(n.flat())}function H8e(n,...e){return j8e(n,e.flat())}function q8e(n){return[...new Set(n)].filter(xe)}const $n=60,mi=25,w_=$n*mi;var ri=(n=>(n[n.ERROR=0]="ERROR",n[n.LOADER=1]="LOADER",n[n.BOARD=2]="BOARD",n[n.OBJECT=3]="OBJECT",n[n.TERRAIN=4]="TERRAIN",n[n.CHARSET=5]="CHARSET",n[n.PALETTE=6]="PALETTE",n))(ri||{});const v9=14,fw=3,Jd=8,Qd=14,P0=16,y9=16,mfe=16;var lo=(n=>(n[n.BLANK=0]="BLANK",n[n.TILES=1]="TILES",n[n.SPRITES=2]="SPRITES",n[n.DITHER=3]="DITHER",n[n.MEDIA=4]="MEDIA",n[n.CONTROL=5]="CONTROL",n))(lo||{}),tl=(n=>(n[n.FAR=1]="FAR",n[n.MID=1.5]="MID",n[n.NEAR=3]="NEAR",n))(tl||{});function Qw(n){let e=0,t=0,r=$n*.5,i=mi*.5,s=1.5,a="flat",o=0;return n.forEach(l=>{switch(l.type){case 1:e=Math.max(e,l.width),t=Math.max(t,l.height);break;case 3:e=Math.max(e,l.width),t=Math.max(t,l.height);break;case 5:r=l.focusx,i=l.focusy,s=l.viewscale,a=l.graphics,o=l.facing;break}}),{width:e,height:t,focusx:r,focusy:i,viewscale:s,graphics:a,facing:o}}function K1(n,e){return`${n}:${e}`}const CH=1,MH=16,OH=256;var Tn=(n=>(n[n.NONE=0]="NONE",n[n.ALT=1]="ALT",n[n.CTRL=2]="CTRL",n[n.SHIFT=3]="SHIFT",n[n.MOVE_UP=4]="MOVE_UP",n[n.MOVE_DOWN=5]="MOVE_DOWN",n[n.MOVE_LEFT=6]="MOVE_LEFT",n[n.MOVE_RIGHT=7]="MOVE_RIGHT",n[n.OK_BUTTON=8]="OK_BUTTON",n[n.CANCEL_BUTTON=9]="CANCEL_BUTTON",n[n.MENU_BUTTON=10]="MENU_BUTTON",n))(Tn||{});function hw(n,e=16){return n?uw(e-1).map(t=>{const r=t*fw;return new cr(n.bits[r]/63,n.bits[r+1]/63,n.bits[r+2]/63)}):[]}var pP={exports:{}},mP={exports:{}},V8e=mP.exports,rQ;function G8e(){return rQ||(rQ=1,(function(n,e){(function(t,r){n.exports=r()})(V8e,function(){function t(_){return!isNaN(parseFloat(_))&&isFinite(_)}function r(_){return _.charAt(0).toUpperCase()+_.substring(1)}function i(_){return function(){return this[_]}}var s=["isConstructor","isEval","isNative","isToplevel"],a=["columnNumber","lineNumber"],o=["fileName","functionName","source"],l=["args"],c=["evalOrigin"],u=s.concat(a,o,l,c);function f(_){if(_)for(var y=0;y<u.length;y++)_[u[y]]!==void 0&&this["set"+r(u[y])](_[u[y]])}f.prototype={getArgs:function(){return this.args},setArgs:function(_){if(Object.prototype.toString.call(_)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=_},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(_){if(_ instanceof f)this.evalOrigin=_;else if(_ instanceof Object)this.evalOrigin=new f(_);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var _=this.getFileName()||"",y=this.getLineNumber()||"",v=this.getColumnNumber()||"",x=this.getFunctionName()||"";return this.getIsEval()?_?"[eval] ("+_+":"+y+":"+v+")":"[eval]:"+y+":"+v:x?x+" ("+_+":"+y+":"+v+")":_+":"+y+":"+v}},f.fromString=function(y){var v=y.indexOf("("),x=y.lastIndexOf(")"),E=y.substring(0,v),M=y.substring(v+1,x).split(","),k=y.substring(x+1);if(k.indexOf("@")===0)var N=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(k,""),I=N[1],D=N[2],V=N[3];return new f({functionName:E,args:M||void 0,fileName:I,lineNumber:D||void 0,columnNumber:V||void 0})};for(var h=0;h<s.length;h++)f.prototype["get"+r(s[h])]=i(s[h]),f.prototype["set"+r(s[h])]=(function(_){return function(y){this[_]=!!y}})(s[h]);for(var g=0;g<a.length;g++)f.prototype["get"+r(a[g])]=i(a[g]),f.prototype["set"+r(a[g])]=(function(_){return function(y){if(!t(y))throw new TypeError(_+" must be a Number");this[_]=Number(y)}})(a[g]);for(var p=0;p<o.length;p++)f.prototype["get"+r(o[p])]=i(o[p]),f.prototype["set"+r(o[p])]=(function(_){return function(y){this[_]=String(y)}})(o[p]);return f})})(mP)),mP.exports}var $8e=pP.exports,iQ;function W8e(){return iQ||(iQ=1,(function(n,e){(function(t,r){n.exports=r(G8e())})($8e,function(r){var i=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,a=/^(eval@)?(\[native code])?$/;return{parse:function(l){if(typeof l.stacktrace<"u"||typeof l["opera#sourceloc"]<"u")return this.parseOpera(l);if(l.stack&&l.stack.match(s))return this.parseV8OrIE(l);if(l.stack)return this.parseFFOrSafari(l);throw new Error("Cannot parse given Error object")},extractLocation:function(l){if(l.indexOf(":")===-1)return[l];var c=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=c.exec(l.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(l){var c=l.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return c.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var f=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),h=f.match(/ (\(.+\)$)/);f=h?f.replace(h[0],""):f;var g=this.extractLocation(h?h[1]:f),p=h&&f||void 0,_=["eval","<anonymous>"].indexOf(g[0])>-1?void 0:g[0];return new r({functionName:p,fileName:_,lineNumber:g[1],columnNumber:g[2],source:u})},this)},parseFFOrSafari:function(l){var c=l.stack.split(`
`).filter(function(u){return!u.match(a)},this);return c.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new r({functionName:u});var f=/((.*".+"[^@]*)?[^@]*)(?:@)/,h=u.match(f),g=h&&h[1]?h[1]:void 0,p=this.extractLocation(u.replace(f,""));return new r({functionName:g,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(l){return!l.stacktrace||l.message.indexOf(`
`)>-1&&l.message.split(`
`).length>l.stacktrace.split(`
`).length?this.parseOpera9(l):l.stack?this.parseOpera11(l):this.parseOpera10(l)},parseOpera9:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)/i,u=l.message.split(`
`),f=[],h=2,g=u.length;h<g;h+=2){var p=c.exec(u[h]);p&&f.push(new r({fileName:p[2],lineNumber:p[1],source:u[h]}))}return f},parseOpera10:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=l.stacktrace.split(`
`),f=[],h=0,g=u.length;h<g;h+=2){var p=c.exec(u[h]);p&&f.push(new r({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[h]}))}return f},parseOpera11:function(l){var c=l.stack.split(`
`).filter(function(u){return!!u.match(i)&&!u.match(/^Error created at/)},this);return c.map(function(u){var f=u.split("@"),h=this.extractLocation(f.pop()),g=f.shift()||"",p=g.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,_;g.match(/\(([^)]*)\)/)&&(_=g.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var y=_===void 0||_==="[arguments not available]"?void 0:_.split(",");return new r({functionName:p,args:y,fileName:h[0],lineNumber:h[1],columnNumber:h[2],source:u})},this)}}})})(pP)),pP.exports}var Y8e=W8e();const X8e=Bh(Y8e),Hv=!!JSON.parse("false"),K8e=!!JSON.parse("false"),Z8e=!!JSON.parse("false"),sQ=!!JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");const Gn={HALT_AT_COUNT:256,DRAW_CHAR_SCALE:2,DRAW_CHAR_WIDTH(){return Jd*Gn.DRAW_CHAR_SCALE},DRAW_CHAR_HEIGHT(){return Qd*Gn.DRAW_CHAR_SCALE}};function bb(n){const e={},t={everytick(){},aftertick(){},listcommands(){return ub(e)},...n,getcommand(r){return e[r]},command(r,i){return e[r]=i,t}};return t}var b9;try{b9=new TextDecoder}catch{}var lr,Nv,jt=0,Fl={},xa,g1,E0=0,Ev=0,Oh,tb,Fm=[],fa,aQ={useRecords:!1,mapsAsObjects:!0};class gfe{}const _fe=new gfe;_fe.name="MessagePack 0xC1";var y1=!1,vfe=2,J8e;try{new Function("")}catch{vfe=1/0}class EO{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(lr)return Tfe(()=>(E9(),this?this.unpack(e,t):EO.prototype.unpack.call(aQ,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Bl<"u"?Bl.from(e):new Uint8Array(e)),typeof t=="object"?(Nv=t.end||e.length,jt=t.start||0):(jt=0,Nv=t>-1?t:e.length),Ev=0,g1=null,Oh=null,lr=e;try{fa=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw lr=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof EO){if(Fl=this,this.structures)return xa=this.structures,sN(t);(!xa||xa.length>0)&&(xa=[])}else Fl=aQ,(!xa||xa.length>0)&&(xa=[]);return sN(t)}unpackMultiple(e,t){let r,i=0;try{y1=!0;let s=e.length,a=this?this.unpack(e,s):fU.unpack(e,s);if(t){if(t(a,i,jt)===!1)return;for(;jt<s;)if(i=jt,t(sN(),i,jt)===!1)return}else{for(r=[a];jt<s;)i=jt,r.push(sN());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{y1=!1,E9()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(r=>r.slice(0)));for(let r=0,i=e.length;r<i;r++){let s=e[r];s&&(s.isShared=!0,r>=32&&(s.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],s=t[r];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=s)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function sN(n){try{if(!Fl.trusted&&!y1){let t=xa.sharedLength||0;t<xa.length&&(xa.length=t)}let e;if(Fl.randomAccessStructure&&lr[jt]<64&&lr[jt]>=32&&J8e||(e=Vu()),Oh&&(jt=Oh.postBundlePosition,Oh=null),y1&&(xa.restoreStructures=null),jt==Nv)xa&&xa.restoreStructures&&oQ(),xa=null,lr=null,tb&&(tb=null);else{if(jt>Nv)throw new Error("Unexpected end of MessagePack data");if(!y1){let t;try{t=JSON.stringify(e,(r,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(r){t="(JSON view not available "+r+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw xa&&xa.restoreStructures&&oQ(),E9(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||jt>Nv)&&(e.incomplete=!0),e}}function oQ(){for(let n in xa.restoreStructures)xa[n]=xa.restoreStructures[n];xa.restoreStructures=null}function Vu(){let n=lr[jt++];if(n<160)if(n<128){if(n<64)return n;{let e=xa[n&63]||Fl.getStructures&&yfe()[n&63];return e?(e.read||(e.read=kH(e,n&63)),e.read()):n}}else if(n<144)if(n-=128,Fl.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=Sfe();r==="__proto__"&&(r="__proto_"),e[r]=Vu()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(Vu(),Vu());return e}else{n-=144;let e=new Array(n);for(let t=0;t<n;t++)e[t]=Vu();return Fl.freezeData?Object.freeze(e):e}else if(n<192){let e=n-160;if(Ev>=jt)return g1.slice(jt-E0,(jt+=e)-E0);if(Ev==0&&Nv<140){let t=e<16?IH(e):bfe(e);if(t!=null)return t}return S9(e)}else{let e;switch(n){case 192:return null;case 193:return Oh?(e=Vu(),e>0?Oh[1].slice(Oh.position1,Oh.position1+=e):Oh[0].slice(Oh.position0,Oh.position0-=e)):_fe;case 194:return!1;case 195:return!0;case 196:if(e=lr[jt++],e===void 0)throw new Error("Unexpected end of buffer");return zB(e);case 197:return e=fa.getUint16(jt),jt+=2,zB(e);case 198:return e=fa.getUint32(jt),jt+=4,zB(e);case 199:return wS(lr[jt++]);case 200:return e=fa.getUint16(jt),jt+=2,wS(e);case 201:return e=fa.getUint32(jt),jt+=4,wS(e);case 202:if(e=fa.getFloat32(jt),Fl.useFloat32>2){let t=NH[(lr[jt]&127)<<1|lr[jt+1]>>7];return jt+=4,(t*e+(e>0?.5:-.5)>>0)/t}return jt+=4,e;case 203:return e=fa.getFloat64(jt),jt+=8,e;case 204:return lr[jt++];case 205:return e=fa.getUint16(jt),jt+=2,e;case 206:return e=fa.getUint32(jt),jt+=4,e;case 207:return Fl.int64AsType==="number"?(e=fa.getUint32(jt)*4294967296,e+=fa.getUint32(jt+4)):Fl.int64AsType==="string"?e=fa.getBigUint64(jt).toString():Fl.int64AsType==="auto"?(e=fa.getBigUint64(jt),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=fa.getBigUint64(jt),jt+=8,e;case 208:return fa.getInt8(jt++);case 209:return e=fa.getInt16(jt),jt+=2,e;case 210:return e=fa.getInt32(jt),jt+=4,e;case 211:return Fl.int64AsType==="number"?(e=fa.getInt32(jt)*4294967296,e+=fa.getUint32(jt+4)):Fl.int64AsType==="string"?e=fa.getBigInt64(jt).toString():Fl.int64AsType==="auto"?(e=fa.getBigInt64(jt),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=fa.getBigInt64(jt),jt+=8,e;case 212:if(e=lr[jt++],e==114)return dQ(lr[jt++]&63);{let t=Fm[e];if(t)return t.read?(jt++,t.read(Vu())):t.noBuffer?(jt++,t()):t(lr.subarray(jt,++jt));throw new Error("Unknown extension "+e)}case 213:return e=lr[jt],e==114?(jt++,dQ(lr[jt++]&63,lr[jt++])):wS(2);case 214:return wS(4);case 215:return wS(8);case 216:return wS(16);case 217:return e=lr[jt++],Ev>=jt?g1.slice(jt-E0,(jt+=e)-E0):eFe(e);case 218:return e=fa.getUint16(jt),jt+=2,Ev>=jt?g1.slice(jt-E0,(jt+=e)-E0):tFe(e);case 219:return e=fa.getUint32(jt),jt+=4,Ev>=jt?g1.slice(jt-E0,(jt+=e)-E0):nFe(e);case 220:return e=fa.getUint16(jt),jt+=2,cQ(e);case 221:return e=fa.getUint32(jt),jt+=4,cQ(e);case 222:return e=fa.getUint16(jt),jt+=2,uQ(e);case 223:return e=fa.getUint32(jt),jt+=4,uQ(e);default:if(n>=224)return n-256;if(n===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+n)}}}const Q8e=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function kH(n,e){function t(){if(t.count++>vfe){let i=n.read=new Function("r","return function(){return "+(Fl.freezeData?"Object.freeze":"")+"({"+n.map(s=>s==="__proto__"?"__proto_:r()":Q8e.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(Vu);return n.highByte===0&&(n.read=lQ(e,n.read)),i()}let r={};for(let i=0,s=n.length;i<s;i++){let a=n[i];a==="__proto__"&&(a="__proto_"),r[a]=Vu()}return Fl.freezeData?Object.freeze(r):r}return t.count=0,n.highByte===0?lQ(e,t):t}const lQ=(n,e)=>function(){let t=lr[jt++];if(t===0)return e();let r=n<32?-(n+(t<<5)):n+(t<<5),i=xa[r]||yfe()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=kH(i,n)),i.read()};function yfe(){let n=Tfe(()=>(lr=null,Fl.getStructures()));return xa=Fl._mergeStructures(n,xa)}var S9=kk,eFe=kk,tFe=kk,nFe=kk;function kk(n){let e;if(n<16&&(e=IH(n)))return e;if(n>64&&b9)return b9.decode(lr.subarray(jt,jt+=n));const t=jt+n,r=[];for(e="";jt<t;){const i=lr[jt++];if((i&128)===0)r.push(i);else if((i&224)===192){const s=lr[jt++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=lr[jt++]&63,a=lr[jt++]&63;r.push((i&31)<<12|s<<6|a)}else if((i&248)===240){const s=lr[jt++]&63,a=lr[jt++]&63,o=lr[jt++]&63;let l=(i&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(i);r.length>=4096&&(e+=wh.apply(String,r),r.length=0)}return r.length>0&&(e+=wh.apply(String,r)),e}function cQ(n){let e=new Array(n);for(let t=0;t<n;t++)e[t]=Vu();return Fl.freezeData?Object.freeze(e):e}function uQ(n){if(Fl.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=Sfe();r==="__proto__"&&(r="__proto_"),e[r]=Vu()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(Vu(),Vu());return e}}var wh=String.fromCharCode;function bfe(n){let e=jt,t=new Array(n);for(let r=0;r<n;r++){const i=lr[jt++];if((i&128)>0){jt=e;return}t[r]=i}return wh.apply(String,t)}function IH(n){if(n<4)if(n<2){if(n===0)return"";{let e=lr[jt++];if((e&128)>1){jt-=1;return}return wh(e)}}else{let e=lr[jt++],t=lr[jt++];if((e&128)>0||(t&128)>0){jt-=2;return}if(n<3)return wh(e,t);let r=lr[jt++];if((r&128)>0){jt-=3;return}return wh(e,t,r)}else{let e=lr[jt++],t=lr[jt++],r=lr[jt++],i=lr[jt++];if((e&128)>0||(t&128)>0||(r&128)>0||(i&128)>0){jt-=4;return}if(n<6){if(n===4)return wh(e,t,r,i);{let s=lr[jt++];if((s&128)>0){jt-=5;return}return wh(e,t,r,i,s)}}else if(n<8){let s=lr[jt++],a=lr[jt++];if((s&128)>0||(a&128)>0){jt-=6;return}if(n<7)return wh(e,t,r,i,s,a);let o=lr[jt++];if((o&128)>0){jt-=7;return}return wh(e,t,r,i,s,a,o)}else{let s=lr[jt++],a=lr[jt++],o=lr[jt++],l=lr[jt++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){jt-=8;return}if(n<10){if(n===8)return wh(e,t,r,i,s,a,o,l);{let c=lr[jt++];if((c&128)>0){jt-=9;return}return wh(e,t,r,i,s,a,o,l,c)}}else if(n<12){let c=lr[jt++],u=lr[jt++];if((c&128)>0||(u&128)>0){jt-=10;return}if(n<11)return wh(e,t,r,i,s,a,o,l,c,u);let f=lr[jt++];if((f&128)>0){jt-=11;return}return wh(e,t,r,i,s,a,o,l,c,u,f)}else{let c=lr[jt++],u=lr[jt++],f=lr[jt++],h=lr[jt++];if((c&128)>0||(u&128)>0||(f&128)>0||(h&128)>0){jt-=12;return}if(n<14){if(n===12)return wh(e,t,r,i,s,a,o,l,c,u,f,h);{let g=lr[jt++];if((g&128)>0){jt-=13;return}return wh(e,t,r,i,s,a,o,l,c,u,f,h,g)}}else{let g=lr[jt++],p=lr[jt++];if((g&128)>0||(p&128)>0){jt-=14;return}if(n<15)return wh(e,t,r,i,s,a,o,l,c,u,f,h,g,p);let _=lr[jt++];if((_&128)>0){jt-=15;return}return wh(e,t,r,i,s,a,o,l,c,u,f,h,g,p,_)}}}}}function fQ(){let n=lr[jt++],e;if(n<192)e=n-160;else switch(n){case 217:e=lr[jt++];break;case 218:e=fa.getUint16(jt),jt+=2;break;case 219:e=fa.getUint32(jt),jt+=4;break;default:throw new Error("Expected string")}return kk(e)}function zB(n){return Fl.copyBuffers?Uint8Array.prototype.slice.call(lr,jt,jt+=n):lr.subarray(jt,jt+=n)}function wS(n){let e=lr[jt++];if(Fm[e]){let t;return Fm[e](lr.subarray(jt,t=jt+=n),r=>{jt=r;try{return Vu()}finally{jt=t}})}else throw new Error("Unknown extension type "+e)}var hQ=new Array(4096);function Sfe(){let n=lr[jt++];if(n>=160&&n<192){if(n=n-160,Ev>=jt)return g1.slice(jt-E0,(jt+=n)-E0);if(!(Ev==0&&Nv<180))return S9(n)}else return jt--,Efe(Vu());let e=(n<<5^(n>1?fa.getUint16(jt):n>0?lr[jt]:0))&4095,t=hQ[e],r=jt,i=jt+n-3,s,a=0;if(t&&t.bytes==n){for(;r<i;){if(s=fa.getUint32(r),s!=t[a++]){r=1879048192;break}r+=4}for(i+=3;r<i;)if(s=lr[r++],s!=t[a++]){r=1879048192;break}if(r===i)return jt=r,t.string;i-=3,r=jt}for(t=[],hQ[e]=t,t.bytes=n;r<i;)s=fa.getUint32(r),t.push(s),r+=4;for(i+=3;r<i;)s=lr[r++],t.push(s);let o=n<16?IH(n):bfe(n);return o!=null?t.string=o:t.string=S9(n)}function Efe(n){if(typeof n=="string")return n;if(typeof n=="number"||typeof n=="boolean"||typeof n=="bigint")return n.toString();if(n==null)return n+"";if(Fl.allowArraysInMapKeys&&Array.isArray(n)&&n.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return n.flat().toString();throw new Error(`Invalid property type for record: ${typeof n}`)}const dQ=(n,e)=>{let t=Vu().map(Efe),r=n;e!==void 0&&(n=n<32?-((e<<5)+n):(e<<5)+n,t.highByte=e);let i=xa[n];return i&&(i.isShared||y1)&&((xa.restoreStructures||(xa.restoreStructures=[]))[n]=i),xa[n]=t,t.read=kH(t,r),t.read()};Fm[0]=()=>{};Fm[0].noBuffer=!0;Fm[66]=n=>{let e=n.byteLength%8||8,t=BigInt(n[0]&128?n[0]-256:n[0]);for(let r=1;r<e;r++)t<<=BigInt(8),t+=BigInt(n[r]);if(n.byteLength!==e){let r=new DataView(n.buffer,n.byteOffset,n.byteLength),i=(s,a)=>{let o=a-s;if(o<=40){let f=r.getBigUint64(s);for(let h=s+8;h<a;h+=8)f<<=64n,f|=r.getBigUint64(h);return f}let l=s+(o>>4<<3),c=i(s,l),u=i(l,a);return c<<BigInt((a-l)*8)|u};t=t<<BigInt((r.byteLength-e)*8)|i(e,r.byteLength)}return t};let pQ={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,AggregateError:typeof AggregateError=="function"?AggregateError:null};Fm[101]=()=>{let n=Vu();if(!pQ[n[0]]){let e=Error(n[1],{cause:n[2]});return e.name=n[0],e}return pQ[n[0]](n[1],{cause:n[2]})};Fm[105]=n=>{if(Fl.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=fa.getUint32(jt-4);tb||(tb=new Map);let t=lr[jt],r;t>=144&&t<160||t==220||t==221?r=[]:t>=128&&t<144||t==222||t==223?r=new Map:(t>=199&&t<=201||t>=212&&t<=216)&&lr[jt+1]===115?r=new Set:r={};let i={target:r};tb.set(e,i);let s=Vu();if(i.used)Object.assign(r,s);else return i.target=s;if(r instanceof Map)for(let[a,o]of s.entries())r.set(a,o);if(r instanceof Set)for(let a of Array.from(s))r.add(a);return r};Fm[112]=n=>{if(Fl.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=fa.getUint32(jt-4),t=tb.get(e);return t.used=!0,t.target};Fm[115]=()=>new Set(Vu());const xfe=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(n=>n+"Array");let rFe=typeof globalThis=="object"?globalThis:window;Fm[116]=n=>{let e=n[0],t=Uint8Array.prototype.slice.call(n,1).buffer,r=xfe[e];if(!r){if(e===16)return t;if(e===17)return new DataView(t);throw new Error("Could not find typed array for code "+e)}return new rFe[r](t)};Fm[120]=()=>{let n=Vu();return new RegExp(n[0],n[1])};const iFe=[];Fm[98]=n=>{let e=(n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3],t=jt;return jt+=e-n.length,Oh=iFe,Oh=[fQ(),fQ()],Oh.position0=0,Oh.position1=0,Oh.postBundlePosition=jt,jt=t,Vu()};Fm[255]=n=>n.length==4?new Date((n[0]*16777216+(n[1]<<16)+(n[2]<<8)+n[3])*1e3):n.length==8?new Date(((n[0]<<22)+(n[1]<<14)+(n[2]<<6)+(n[3]>>2))/1e6+((n[3]&3)*4294967296+n[4]*16777216+(n[5]<<16)+(n[6]<<8)+n[7])*1e3):n.length==12?new Date(((n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3])/1e6+((n[4]&128?-281474976710656:0)+n[6]*1099511627776+n[7]*4294967296+n[8]*16777216+(n[9]<<16)+(n[10]<<8)+n[11])*1e3):new Date("invalid");function Tfe(n){let e=Nv,t=jt,r=E0,i=Ev,s=g1,a=tb,o=Oh,l=new Uint8Array(lr.slice(0,Nv)),c=xa,u=xa.slice(0,xa.length),f=Fl,h=y1,g=n();return Nv=e,jt=t,E0=r,Ev=i,g1=s,tb=a,Oh=o,lr=l,y1=h,xa=c,xa.splice(0,xa.length,...u),Fl=f,fa=new DataView(lr.buffer,lr.byteOffset,lr.byteLength),g}function E9(){lr=null,tb=null,xa=null}const NH=new Array(147);for(let n=0;n<256;n++)NH[n]=+("1e"+Math.floor(45.15-n*.30103));var fU=new EO({useRecords:!1});fU.unpack;fU.unpackMultiple;fU.unpack;let sFe=new Float32Array(1);new Uint8Array(sFe.buffer,0,4);let gP;try{gP=new TextEncoder}catch{}let x9,wfe;const dw=typeof Bl<"u",aN=dw?function(n){return Bl.allocUnsafeSlow(n)}:Uint8Array,Rfe=dw?Bl:Uint8Array,mQ=dw?4294967296:2144337920;let sn,LM,Sl,qt=0,$d,zc=null,aFe;const oFe=21760,lFe=/[\u0080-\uFFFF]/,Jx=Symbol("record-id");class cFe extends EO{constructor(e){super(e),this.offset=0;let t,r,i,s,a=Rfe.prototype.utf8Write?function($,U){return sn.utf8Write($,U,sn.byteLength-U)}:gP&&gP.encodeInto?function($,U){return gP.encodeInto($,sn.subarray(U)).written}:!1,o=this;e||(e={});let l=e&&e.sequential,c=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=c?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let f=e.maxOwnStructures;f==null&&(f=c?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let h=u>32||f+u>64,g=u+64,p=u+f+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let _=[],y=0,v=0;this.pack=this.encode=function($,U){if(sn||(sn=new aN(8192),Sl=sn.dataView||(sn.dataView=new DataView(sn.buffer,0,8192)),qt=0),$d=sn.length-10,$d-qt<2048?(sn=new aN(sn.length),Sl=sn.dataView||(sn.dataView=new DataView(sn.buffer,0,sn.length)),$d=sn.length-10,qt=0):qt=qt+7&2147483640,t=qt,U&pFe&&(qt+=U&255),s=o.structuredClone?new Map:null,o.bundleStrings&&typeof $!="string"?(zc=[],zc.size=1/0):zc=null,i=o.structures,i){i.uninitialized&&(i=o._mergeStructures(o.getStructures()));let W=i.sharedLength||0;if(W>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let q=0;q<W;q++){let Y=i[q];if(!Y)continue;let ae,Z=i.transitions;for(let K=0,ne=Y.length;K<ne;K++){let le=Y[K];ae=Z[le],ae||(ae=Z[le]=Object.create(null)),Z=ae}Z[Jx]=q+64}this.lastNamedStructuresLength=W}l||(i.nextId=W+64)}r&&(r=!1);let Q;try{o.randomAccessStructure&&$&&$.constructor&&$.constructor===Object?B($):M($);let W=zc;if(zc&&_Q(t,M,0),s&&s.idsToInsert){let q=s.idsToInsert.sort((K,ne)=>K.offset>ne.offset?1:-1),Y=q.length,ae=-1;for(;W&&Y>0;){let K=q[--Y].offset+t;K<W.stringsPosition+t&&ae===-1&&(ae=0),K>W.position+t?ae>=0&&(ae+=6):(ae>=0&&(Sl.setUint32(W.position+t,Sl.getUint32(W.position+t)+ae),ae=-1),W=W.previous,Y++)}ae>=0&&W&&Sl.setUint32(W.position+t,Sl.getUint32(W.position+t)+ae),qt+=q.length*6,qt>$d&&V(qt),o.offset=qt;let Z=uFe(sn.subarray(t,qt),q);return s=null,Z}return o.offset=qt,U&hFe?(sn.start=t,sn.end=qt,sn):sn.subarray(t,qt)}catch(W){throw Q=W,W}finally{if(i&&(x(),r&&o.saveStructures)){let W=i.sharedLength||0,q=sn.subarray(t,qt),Y=fFe(i,o);if(!Q)return o.saveStructures(Y,Y.isCompatible)===!1?o.pack($,U):(o.lastNamedStructuresLength=W,sn.length>1073741824&&(sn=null),q)}sn.length>1073741824&&(sn=null),U&dFe&&(qt=t)}};const x=()=>{v<10&&v++;let $=i.sharedLength||0;if(i.length>$&&!l&&(i.length=$),y>1e4)i.transitions=null,v=0,y=0,_.length>0&&(_=[]);else if(_.length>0&&!l){for(let U=0,Q=_.length;U<Q;U++)_[U][Jx]=0;_=[]}},E=$=>{var U=$.length;U<16?sn[qt++]=144|U:U<65536?(sn[qt++]=220,sn[qt++]=U>>8,sn[qt++]=U&255):(sn[qt++]=221,Sl.setUint32(qt,U),qt+=4);for(let Q=0;Q<U;Q++)M($[Q])},M=$=>{qt>$d&&(sn=V(qt));var U=typeof $,Q;if(U==="string"){let W=$.length;if(zc&&W>=4&&W<4096){if((zc.size+=W)>oFe){let Z,K=(zc[0]?zc[0].length*3+zc[1].length:0)+10;qt+K>$d&&(sn=V(qt+K));let ne;zc.position?(ne=zc,sn[qt]=200,qt+=3,sn[qt++]=98,Z=qt-t,qt+=4,_Q(t,M,0),Sl.setUint16(Z+t-3,qt-t-Z)):(sn[qt++]=214,sn[qt++]=98,Z=qt-t,qt+=4),zc=["",""],zc.previous=ne,zc.size=0,zc.position=Z}let ae=lFe.test($);zc[ae?0:1]+=$,sn[qt++]=193,M(ae?-W:W);return}let q;W<32?q=1:W<256?q=2:W<65536?q=3:q=5;let Y=W*3;if(qt+Y>$d&&(sn=V(qt+Y)),W<64||!a){let ae,Z,K,ne=qt+q;for(ae=0;ae<W;ae++)Z=$.charCodeAt(ae),Z<128?sn[ne++]=Z:Z<2048?(sn[ne++]=Z>>6|192,sn[ne++]=Z&63|128):(Z&64512)===55296&&((K=$.charCodeAt(ae+1))&64512)===56320?(Z=65536+((Z&1023)<<10)+(K&1023),ae++,sn[ne++]=Z>>18|240,sn[ne++]=Z>>12&63|128,sn[ne++]=Z>>6&63|128,sn[ne++]=Z&63|128):(sn[ne++]=Z>>12|224,sn[ne++]=Z>>6&63|128,sn[ne++]=Z&63|128);Q=ne-qt-q}else Q=a($,qt+q);Q<32?sn[qt++]=160|Q:Q<256?(q<2&&sn.copyWithin(qt+2,qt+1,qt+1+Q),sn[qt++]=217,sn[qt++]=Q):Q<65536?(q<3&&sn.copyWithin(qt+3,qt+2,qt+2+Q),sn[qt++]=218,sn[qt++]=Q>>8,sn[qt++]=Q&255):(q<5&&sn.copyWithin(qt+5,qt+3,qt+3+Q),sn[qt++]=219,Sl.setUint32(qt,Q),qt+=4),qt+=Q}else if(U==="number")if($>>>0===$)$<32||$<128&&this.useRecords===!1||$<64&&!this.randomAccessStructure?sn[qt++]=$:$<256?(sn[qt++]=204,sn[qt++]=$):$<65536?(sn[qt++]=205,sn[qt++]=$>>8,sn[qt++]=$&255):(sn[qt++]=206,Sl.setUint32(qt,$),qt+=4);else if($>>0===$)$>=-32?sn[qt++]=256+$:$>=-128?(sn[qt++]=208,sn[qt++]=$+256):$>=-32768?(sn[qt++]=209,Sl.setInt16(qt,$),qt+=2):(sn[qt++]=210,Sl.setInt32(qt,$),qt+=4);else{let W;if((W=this.useFloat32)>0&&$<4294967296&&$>=-2147483648){sn[qt++]=202,Sl.setFloat32(qt,$);let q;if(W<4||(q=$*NH[(sn[qt]&127)<<1|sn[qt+1]>>7])>>0===q){qt+=4;return}else qt--}sn[qt++]=203,Sl.setFloat64(qt,$),qt+=8}else if(U==="object"||U==="function")if(!$)sn[qt++]=192;else{if(s){let q=s.get($);if(q){if(!q.id){let Y=s.idsToInsert||(s.idsToInsert=[]);q.id=Y.push(q)}sn[qt++]=214,sn[qt++]=112,Sl.setUint32(qt,q.id),qt+=4;return}else s.set($,{offset:qt-t})}let W=$.constructor;if(W===Object)D($);else if(W===Array)E($);else if(W===Map)if(this.mapAsEmptyObject)sn[qt++]=128;else{Q=$.size,Q<16?sn[qt++]=128|Q:Q<65536?(sn[qt++]=222,sn[qt++]=Q>>8,sn[qt++]=Q&255):(sn[qt++]=223,Sl.setUint32(qt,Q),qt+=4);for(let[q,Y]of $)M(q),M(Y)}else{for(let q=0,Y=x9.length;q<Y;q++){let ae=wfe[q];if($ instanceof ae){let Z=x9[q];if(Z.write){Z.type&&(sn[qt++]=212,sn[qt++]=Z.type,sn[qt++]=0);let de=Z.write.call(this,$);de===$?Array.isArray($)?E($):D($):M(de);return}let K=sn,ne=Sl,le=qt;sn=null;let ce;try{ce=Z.pack.call(this,$,de=>(sn=K,K=null,qt+=de,qt>$d&&V(qt),{target:sn,targetView:Sl,position:qt-de}),M)}finally{K&&(sn=K,Sl=ne,qt=le,$d=sn.length-10)}ce&&(ce.length+qt>$d&&V(ce.length+qt),qt=gQ(ce,sn,qt,Z.type));return}}if(Array.isArray($))E($);else{if($.toJSON){const q=$.toJSON();if(q!==$)return M(q)}if(U==="function")return M(this.writeFunction&&this.writeFunction($));D($)}}}else if(U==="boolean")sn[qt++]=$?195:194;else if(U==="bigint"){if($<9223372036854776e3&&$>=-9223372036854776e3)sn[qt++]=211,Sl.setBigInt64(qt,$);else if($<18446744073709552e3&&$>0)sn[qt++]=207,Sl.setBigUint64(qt,$);else if(this.largeBigIntToFloat)sn[qt++]=203,Sl.setFloat64(qt,Number($));else{if(this.largeBigIntToString)return M($.toString());if(this.useBigIntExtension||this.moreTypes){let W=$<0?BigInt(-1):BigInt(0),q;if($>>BigInt(65536)===W){let Y=BigInt(18446744073709552e3)-BigInt(1),ae=[];for(;ae.push($&Y),$>>BigInt(63)!==W;)$>>=BigInt(64);q=new Uint8Array(new BigUint64Array(ae).buffer),q.reverse()}else{let Y=$<0,ae=(Y?~$:$).toString(16);if(ae.length%2?ae="0"+ae:parseInt(ae.charAt(0),16)>=8&&(ae="00"+ae),dw)q=Bl.from(ae,"hex");else{q=new Uint8Array(ae.length/2);for(let Z=0;Z<q.length;Z++)q[Z]=parseInt(ae.slice(Z*2,Z*2+2),16)}if(Y)for(let Z=0;Z<q.length;Z++)q[Z]=~q[Z]}q.length+qt>$d&&V(q.length+qt),qt=gQ(q,sn,qt,66);return}else throw new RangeError($+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}qt+=8}else if(U==="undefined")this.encodeUndefinedAsNil?sn[qt++]=192:(sn[qt++]=212,sn[qt++]=0,sn[qt++]=0);else throw new Error("Unknown type: "+U)},k=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?$=>{let U;if(this.skipValues){U=[];for(let q in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(q))&&!this.skipValues.includes($[q])&&U.push(q)}else U=Object.keys($);let Q=U.length;Q<16?sn[qt++]=128|Q:Q<65536?(sn[qt++]=222,sn[qt++]=Q>>8,sn[qt++]=Q&255):(sn[qt++]=223,Sl.setUint32(qt,Q),qt+=4);let W;if(this.coercibleKeyAsNumber)for(let q=0;q<Q;q++){W=U[q];let Y=Number(W);M(isNaN(Y)?W:Y),M($[W])}else for(let q=0;q<Q;q++)M(W=U[q]),M($[W])}:$=>{sn[qt++]=222;let U=qt-t;qt+=2;let Q=0;for(let W in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(W))&&(M(W),M($[W]),Q++);if(Q>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');sn[U+++t]=Q>>8,sn[U+t]=Q&255},N=this.useRecords===!1?k:e.progressiveRecords&&!h?$=>{let U,Q=i.transitions||(i.transitions=Object.create(null)),W=qt++-t,q;for(let Y in $)if(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y)){if(U=Q[Y],U)Q=U;else{let ae=Object.keys($),Z=Q;Q=i.transitions;let K=0;for(let ne=0,le=ae.length;ne<le;ne++){let ce=ae[ne];U=Q[ce],U||(U=Q[ce]=Object.create(null),K++),Q=U}W+t+1==qt?(qt--,G(Q,ae,K)):J(Q,ae,W,K),q=!0,Q=Z[Y]}M($[Y])}if(!q){let Y=Q[Jx];Y?sn[W+t]=Y:J(Q,Object.keys($),W,0)}}:$=>{let U,Q=i.transitions||(i.transitions=Object.create(null)),W=0;for(let Y in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y))&&(U=Q[Y],U||(U=Q[Y]=Object.create(null),W++),Q=U);let q=Q[Jx];q?q>=96&&h?(sn[qt++]=((q-=96)&31)+96,sn[qt++]=q>>5):sn[qt++]=q:G(Q,Q.__keys__||Object.keys($),W);for(let Y in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y))&&M($[Y])},I=typeof this.useRecords=="function"&&this.useRecords,D=I?$=>{I($)?N($):k($)}:N,V=$=>{let U;if($>16777216){if($-t>mQ)throw new Error("Packed buffer would be larger than maximum buffer size");U=Math.min(mQ,Math.round(Math.max(($-t)*($>67108864?1.25:2),4194304)/4096)*4096)}else U=(Math.max($-t<<2,sn.length-1)>>12)+1<<12;let Q=new aN(U);return Sl=Q.dataView||(Q.dataView=new DataView(Q.buffer,0,U)),$=Math.min($,sn.length),sn.copy?sn.copy(Q,0,t,$):Q.set(sn.slice(t,$)),qt-=t,t=0,$d=Q.length-10,sn=Q},G=($,U,Q)=>{let W=i.nextId;W||(W=64),W<g&&this.shouldShareStructure&&!this.shouldShareStructure(U)?(W=i.nextOwnId,W<p||(W=g),i.nextOwnId=W+1):(W>=p&&(W=g),i.nextId=W+1);let q=U.highByte=W>=96&&h?W-96>>5:-1;$[Jx]=W,$.__keys__=U,i[W-64]=U,W<g?(U.isShared=!0,i.sharedLength=W-63,r=!0,q>=0?(sn[qt++]=(W&31)+96,sn[qt++]=q):sn[qt++]=W):(q>=0?(sn[qt++]=213,sn[qt++]=114,sn[qt++]=(W&31)+96,sn[qt++]=q):(sn[qt++]=212,sn[qt++]=114,sn[qt++]=W),Q&&(y+=v*Q),_.length>=f&&(_.shift()[Jx]=0),_.push($),M(U))},J=($,U,Q,W)=>{let q=sn,Y=qt,ae=$d,Z=t;sn=LM,qt=0,t=0,sn||(LM=sn=new aN(8192)),$d=sn.length-10,G($,U,W),LM=sn;let K=qt;if(sn=q,qt=Y,$d=ae,t=Z,K>1){let ne=qt+K-1;ne>$d&&V(ne);let le=Q+t;sn.copyWithin(le+K,le+1,qt),sn.set(LM.slice(0,K),le),qt=ne}else sn[Q+t]=LM[0]},B=$=>{let U=aFe($,sn,t,qt,i,V,(Q,W,q)=>{if(q)return r=!0;qt=W;let Y=sn;return M(Q),x(),Y!==sn?{position:qt,targetView:Sl,target:sn}:qt},this);if(U===0)return D($);qt=U}}useBuffer(e){sn=e,sn.dataView||(sn.dataView=new DataView(sn.buffer,sn.byteOffset,sn.byteLength)),Sl=sn.dataView,qt=0}set position(e){qt=e}get position(){return qt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}wfe=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,gfe];x9=[{pack(n,e,t){let r=n.getTime()/1e3;if((this.useTimestamp32||n.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:i,targetView:s,position:a}=e(6);i[a++]=214,i[a++]=255,s.setUint32(a,r)}else if(r>0&&r<4294967296){let{target:i,targetView:s,position:a}=e(10);i[a++]=215,i[a++]=255,s.setUint32(a,n.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(a+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:i,targetView:s,position:a}=e(3);i[a++]=212,i[a++]=255,i[a++]=255}else{let{target:i,targetView:s,position:a}=e(15);i[a++]=199,i[a++]=12,i[a++]=255,s.setUint32(a,n.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(r)))}}},{pack(n,e,t){if(this.setAsEmptyObject)return e(0),t({});let r=Array.from(n),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),t(r)}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),t([n.name,n.message,n.cause])}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),t([n.source,n.flags])}},{pack(n,e){this.moreTypes?jB(n,16,e):HB(dw?Bl.from(n):new Uint8Array(n),e)}},{pack(n,e){let t=n.constructor;t!==Rfe&&this.moreTypes?jB(n,xfe.indexOf(t.name),e):HB(n,e)}},{pack(n,e){this.moreTypes?jB(n,17,e):HB(dw?Bl.from(n):new Uint8Array(n),e)}},{pack(n,e){let{target:t,position:r}=e(1);t[r]=193}}];function jB(n,e,t,r){let i=n.byteLength;if(i+1<256){var{target:s,position:a}=t(4+i);s[a++]=199,s[a++]=i+1}else if(i+1<65536){var{target:s,position:a}=t(5+i);s[a++]=200,s[a++]=i+1>>8,s[a++]=i+1&255}else{var{target:s,position:a,targetView:o}=t(7+i);s[a++]=201,o.setUint32(a,i+1),a+=4}s[a++]=116,s[a++]=e,n.buffer||(n=new Uint8Array(n)),s.set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),a)}function HB(n,e){let t=n.byteLength;var r,i;if(t<256){var{target:r,position:i}=e(t+2);r[i++]=196,r[i++]=t}else if(t<65536){var{target:r,position:i}=e(t+3);r[i++]=197,r[i++]=t>>8,r[i++]=t&255}else{var{target:r,position:i,targetView:s}=e(t+5);r[i++]=198,s.setUint32(i,t),i+=4}r.set(n,i)}function gQ(n,e,t,r){let i=n.length;switch(i){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:i<256?(e[t++]=199,e[t++]=i):i<65536?(e[t++]=200,e[t++]=i>>8,e[t++]=i&255):(e[t++]=201,e[t++]=i>>24,e[t++]=i>>16&255,e[t++]=i>>8&255,e[t++]=i&255)}return e[t++]=r,e.set(n,t),t+=i,t}function uFe(n,e){let t,r=e.length*6,i=n.length-r;for(;t=e.pop();){let s=t.offset,a=t.id;n.copyWithin(s+r,s,i),r-=6;let o=s+r;n[o++]=214,n[o++]=105,n[o++]=a>>24,n[o++]=a>>16&255,n[o++]=a>>8&255,n[o++]=a&255,i=s}return n}function _Q(n,e,t){if(zc.length>0){Sl.setUint32(zc.position+n,qt+t-zc.position-n),zc.stringsPosition=qt-n;let r=zc;zc=null,e(r[0]),e(r[1])}}function fFe(n,e){return n.isCompatible=t=>{let r=!t||(e.lastNamedStructuresLength||0)===t.length;return r||e._mergeStructures(t),r},n}let Afe=new cFe({useRecords:!1});Afe.pack;Afe.pack;const hFe=512,dFe=1024,pFe=2048;function PH(n,e,t={}){if(xe(n))try{const r={};for(let i=0;i<n.length;i+=2){let s=n[i],a=n[i+1];const o=e[s];xe(o)&&(s=o);const l=t[s];xe(l)&&(a=l(a)),r[s]=a}return r}catch(r){xi(St,"","format",r.message)}}function mFe(n,e){return n%e}function gFe(n,e){return Math.floor(n/e)}function pw(n,e){return{x:mFe(n,e),y:gFe(n,e)}}function vQ(n,e){const t=n.x-e.x,r=n.y-e.y;return Math.sqrt(t*t+r*r)}function _f(n,e){return n.x+n.y*e}function _Fe(n,e,t,r,i,s){return n>=s&&n<=r&&e>=t&&e<=i}function yQ(n,e,t,r){const i=[],s=Math.abs(t-n),a=Math.abs(r-e),o=n<t?1:-1,l=e<r?1:-1;let c=s-a;for(i.push({x:n,y:e});n!==t||e!==r;){const u=2*c;u>-a&&(c-=a,n+=o),u<s&&(c+=s,e+=l),i.push({x:n,y:e})}return i}function b1(n){return xe(n)&&xe(n.x)&&xe(n.y)}function hu(n,e){switch(e){case Hn.NORTH:--n.y;break;case Hn.SOUTH:++n.y;break;case Hn.WEST:--n.x;break;case Hn.EAST:++n.x;break}return n}function rE(n,e){return n<0?Hn.WEST:n>0?Hn.EAST:e<0?Hn.NORTH:e>0?Hn.SOUTH:Hn.IDLE}function mv(n,e){return rE(e.x-n.x,e.y-n.y)}const Cfe={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",over:"OVER",under:"UNDER",within:"WITHIN",awayby:"AWAYBY"};function q0(n){return ui(n)&&Mfe(n[0])}function Mfe(n){return xe(Hn[n])&&Vn(n)}function Ofe(n){const e=Hn[n];return xe(e)?e:Hn.IDLE}function hU(n){if(Vn(n))return Cfe[Vr(n)]}function vFe(n){if(q0(n))return n;if(Mfe(n))return[n];const e=hU(n);if(xe(e))return[e]}function bQ(n){const e=Ce.words[n],t=vFe(e);return q0(t)?[t,n+1]:[void 0,n]}function kfe(n){const e=[];let[t,r]=bQ(n);for(;q0(t);){switch(e.push(...t),t[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[o,l,c]=ln(Ce.words,r,[Pt.NUMBER,Pt.NUMBER]);e.push(o,l),r=c;break}case"FLEE":case"FIND":{const[o,l]=ln(Ce.words,r,[Pt.KIND]);console.info("kind",o),r=l;break}case"TO":{const[o,l,c]=ln(Ce.words,r,[Pt.DIR,Pt.DIR]),u=Ce.element?.x??0,f=Ce.element?.y??0;o.destpt.x-=u,o.destpt.y-=f,l.destpt.x-=u,l.destpt.y-=f,e.push(u+o.destpt.x+l.destpt.x,f+o.destpt.y+l.destpt.y),r=c;break}case"WITHIN":case"AWAYBY":{const[o,l]=ln(Ce.words,r,[Pt.NUMBER]);e.push(o),r=l;break}}const i=r;switch(t[0]){case"CW":case"CCW":case"OPP":case"RNDP":case"OVER":case"UNDER":case"WITHIN":case"AWAYBY":break;default:return[e,r]}const[s,a]=bQ(i);t=s,r=a}return e.length?[e,r]:[void 0,n]}function yFe(n){if(xe(n)&&(n<bn.ONBLACK||n>bn.ONCLEAR))return n}function DH(n){return xe(n)&&n>bn.WHITE&&n<bn.ONCLEAR?n-bn.ONBLACK:void 0}const dU={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR",blblack:"BLBLACK",bldkblue:"BLDKBLUE",bldkgreen:"BLDKGREEN",bldkcyan:"BLDKCYAN",bldkred:"BLDKRED",bldkpurple:"BLDKPURPLE",bldkyellow:"BLDKYELLOW",blltgray:"BLLTGRAY",bldkgray:"BLDKGRAY",blblue:"BLBLUE",blgreen:"BLGREEN",blcyan:"BLCYAN",blred:"BLRED",blpurple:"BLPURPLE",blyellow:"BLYELLOW",blwhite:"BLWHITE",blbrown:"BLDKYELLOW",bldkwhite:"BLLTGRAY",blltgrey:"BLLTGRAY",blgray:"BLLTGRAY",blgrey:"BLLTGRAY",bldkgrey:"BLDKGRAY",blltblack:"BLDKGRAY"};function Lp(n){return ui(n)&&Ife(n[0])}function bFe(n){return Lp(n)&&n[0].startsWith("ON")}function Ife(n){return xe(bn[n])&&Vn(n)}function xO(n){if(Vn(n))return dU[Vr(n)]}function pU(n,e){return[xe(n)?`${bn[n]}`:void 0,xe(e)?`ON${bn[e]}`:void 0].filter(xe)}function rL(n){return n.map(e=>bn[e]).find(e=>xe(e)&&e<bn.ONBLACK)}function iL(n){return n.map(e=>bn[e]).find(e=>xe(e)&&e>=bn.ONBLACK)}function SFe(n){if(Lp(n))return n;if(Ife(n))return[n];const e=xO(n);if(xe(e))return[e]}function SQ(n){const e=Ce.words[n],t=SFe(e);return Lp(t)?[t,n+1]:[void 0,n]}function sL(n){const e=[];let t=n;const r=parseFloat(Ce.words[n]);if(Mn(r))return[pU(r,void 0),n+1];const[i,s]=SQ(n);Lp(i)&&(e.push(...i),t=s);const[a,o]=SQ(s);return bFe(a)&&(e.push(...a),t=o),e.length?[e,t]:[void 0,n]}function Nfe(n){const e={};for(let t=0;t<n.length;++t){const r=n[t],i=bn[r];xe(i)&&(i<bn.ONBLACK?e.color=i:e.bg=DH(i))}return e}function hE(n){return ui(n)&&typeof n[0]=="string"}function EFe(n){const e=Ce.words[n];return Vn(e)?[e,n+1]:[void 0,n]}function qB(n){const e=Ce.words[n];if(hE(e))return[e,n+1];const[t,r]=sL(n),[i,s]=EFe(r);return Vn(i)&&(i==="empty"||U1({kind:i}))?[[i,t],s]:[void 0,n]}function TO(n){if(!hE(n))return;const[e]=n;return e}function aL(n){if(!hE(n))return;const[,e]=n,t=xe(e)?rL(e):void 0;return xe(t)?t:void 0}function Pfe(n){if(!hE(n))return;const[,e]=n,t=xe(e)?iL(e):void 0;return xe(t)?DH(t):void 0}function xFe(n){const e=document.createElement("canvas");if(e.width=n?.width||1,e.height=n?.height||1,n){const t=e.getContext("2d"),r=t?.getImageData(0,0,n.width,n.height);if(r&&t){let i=0;const{data:s}=r;for(let a=0;a<s.length;a+=4){const o=n.bits[i];s[a]=o,s[a+1]=o,s[a+2]=o,s[a+3]=255,i+=1}t.putImageData(r,0,0)}}return e}function LH(n,e){return{width:n,height:e,size:n*e,bits:new Uint8Array(n*e).fill(0)}}function VB(n,e,t){return{width:n,height:e,size:n*e,bits:new Uint8Array(t)}}function GB(n,e,t){if(!xe(n))return;const r=Math.round(n.height/t),i=Math.round(n.width/e),s=e+2,a=t+2,o=i*e,l=i*s,c=r*a,u=LH(l,c);for(let f=0;f<r;++f)for(let h=0;h<i;++h)for(let g=0;g<t;++g)for(let p=0;p<e;++p){const _=h*e+p,y=f*t+g,v=n.bits[_+y*o],x=h*s+p+1,E=f*a+g+1,M=x+E*l;u.bits[M]=v,p===0&&(u.bits[M-1]=v),p===Jd-1&&(u.bits[M+1]=v),g===0&&(u.bits[M-l]=v),g===Qd-1&&(u.bits[M+l]=v)}return u}function rx(n){const e=Math.floor(n.length/fw);if(e*fw!==n.length)return;const t=LH(3,e);for(let r=0;r<t.bits.length;++r)t.bits[r]=n[r];return t}function TFe(n,e){return n&1<<e?255:0}function ix(n){const e=Math.floor(n.length/v9);if(e*v9!==n.length)return;const t=Math.ceil(e/P0),r=Jd*P0,i=LH(r,Qd*t);let s=0,a=0,o=0;for(let l=0;l<n.length;++l){const c=a*Qd+o,u=n[l];for(let f=0;f<Jd;++f){const h=s*Jd+f;i.bits[h+c*r]=TFe(u,7-f)}++o,o===Qd&&(o=0,++s,s===P0&&(s=0,++a))}return i}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const xQ="0123456789abcdef",Dfe=[],oL=[];for(let n=0;n<256;n++)Dfe[n]=xQ[n>>4&15]+xQ[n&15],n<16&&(n<10?oL[48+n]=n:oL[87+n]=n);const Lfe=n=>{const e=n.length;let t="",r=0;for(;r<e;)t+=Dfe[n[r++]];return t},Pg=n=>{const e=n.length>>1,t=e<<1,r=new Uint8Array(e);let i=0,s=0;for(;s<t;)r[i++]=oL[n.charCodeAt(s++)]<<4|oL[n.charCodeAt(s++)];return r};var TQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wFe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var oN=0;oN<TQ.length;oN++)wFe[TQ.charCodeAt(oN)]=oN;new TextDecoder;new TextEncoder;const wQ=typeof window<"u"?window:self,RQ=wQ.crypto||wQ.msCrypto||{};RQ.subtle||RQ.webkitSubtle;const eR=Pg("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),tR=Pg("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f"),Jy=globalThis||void 0||self;var Ufe=typeof Jy=="object"&&Jy&&Jy.Object===Object&&Jy,RFe=typeof self=="object"&&self&&self.Object===Object&&self,Qv=Ufe||RFe||Function("return this")(),V0=Qv.Symbol,Bfe=Object.prototype,AFe=Bfe.hasOwnProperty,CFe=Bfe.toString,UM=V0?V0.toStringTag:void 0;function MFe(n){var e=AFe.call(n,UM),t=n[UM];try{n[UM]=void 0;var r=!0}catch{}var i=CFe.call(n);return r&&(e?n[UM]=t:delete n[UM]),i}var OFe=Object.prototype,kFe=OFe.toString;function IFe(n){return kFe.call(n)}var NFe="[object Null]",PFe="[object Undefined]",AQ=V0?V0.toStringTag:void 0;function Z1(n){return n==null?n===void 0?PFe:NFe:AQ&&AQ in Object(n)?MFe(n):IFe(n)}function M_(n){return n!=null&&typeof n=="object"}var DFe="[object Symbol]";function mU(n){return typeof n=="symbol"||M_(n)&&Z1(n)==DFe}function gU(n,e){for(var t=-1,r=n==null?0:n.length,i=Array(r);++t<r;)i[t]=e(n[t],t,n);return i}var ka=Array.isArray,CQ=V0?V0.prototype:void 0,MQ=CQ?CQ.toString:void 0;function Ffe(n){if(typeof n=="string")return n;if(ka(n))return gU(n,Ffe)+"";if(mU(n))return MQ?MQ.call(n):"";var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}var LFe=/\s/;function UFe(n){for(var e=n.length;e--&&LFe.test(n.charAt(e)););return e}var BFe=/^\s+/;function FFe(n){return n&&n.slice(0,UFe(n)+1).replace(BFe,"")}function G0(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var OQ=NaN,zFe=/^[-+]0x[0-9a-f]+$/i,jFe=/^0b[01]+$/i,HFe=/^0o[0-7]+$/i,qFe=parseInt;function VFe(n){if(typeof n=="number")return n;if(mU(n))return OQ;if(G0(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=G0(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=FFe(n);var t=jFe.test(n);return t||HFe.test(n)?qFe(n.slice(2),t?2:8):zFe.test(n)?OQ:+n}var kQ=1/0,GFe=17976931348623157e292;function $Fe(n){if(!n)return n===0?n:0;if(n=VFe(n),n===kQ||n===-kQ){var e=n<0?-1:1;return e*GFe}return n===n?n:0}function _U(n){var e=$Fe(n),t=e%1;return e===e?t?e-t:e:0}function mw(n){return n}var WFe="[object AsyncFunction]",YFe="[object Function]",XFe="[object GeneratorFunction]",KFe="[object Proxy]";function Sb(n){if(!G0(n))return!1;var e=Z1(n);return e==YFe||e==XFe||e==WFe||e==KFe}var $B=Qv["__core-js_shared__"],IQ=(function(){var n=/[^.]+$/.exec($B&&$B.keys&&$B.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function ZFe(n){return!!IQ&&IQ in n}var JFe=Function.prototype,QFe=JFe.toString;function sx(n){if(n!=null){try{return QFe.call(n)}catch{}try{return n+""}catch{}}return""}var e7e=/[\\^$.*+?()[\]{}|]/g,t7e=/^\[object .+?Constructor\]$/,n7e=Function.prototype,r7e=Object.prototype,i7e=n7e.toString,s7e=r7e.hasOwnProperty,a7e=RegExp("^"+i7e.call(s7e).replace(e7e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function o7e(n){if(!G0(n)||ZFe(n))return!1;var e=Sb(n)?a7e:t7e;return e.test(sx(n))}function l7e(n,e){return n?.[e]}function ax(n,e){var t=l7e(n,e);return o7e(t)?t:void 0}var T9=ax(Qv,"WeakMap"),NQ=Object.create,c7e=(function(){function n(){}return function(e){if(!G0(e))return{};if(NQ)return NQ(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}})();function u7e(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function qf(){}function f7e(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var h7e=800,d7e=16,p7e=Date.now;function m7e(n){var e=0,t=0;return function(){var r=p7e(),i=d7e-(r-t);if(t=r,i>0){if(++e>=h7e)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function g7e(n){return function(){return n}}var lL=(function(){try{var n=ax(Object,"defineProperty");return n({},"",{}),n}catch{}})(),_7e=lL?function(n,e){return lL(n,"toString",{configurable:!0,enumerable:!1,value:g7e(e),writable:!0})}:mw,v7e=m7e(_7e);function zfe(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}function jfe(n,e,t,r){for(var i=n.length,s=t+-1;++s<i;)if(e(n[s],s,n))return s;return-1}function y7e(n){return n!==n}function b7e(n,e,t){for(var r=t-1,i=n.length;++r<i;)if(n[r]===e)return r;return-1}function UH(n,e,t){return e===e?b7e(n,e,t):jfe(n,y7e,t)}function Hfe(n,e){var t=n==null?0:n.length;return!!t&&UH(n,e,0)>-1}var S7e=9007199254740991,E7e=/^(?:0|[1-9]\d*)$/;function vU(n,e){var t=typeof n;return e=e??S7e,!!e&&(t=="number"||t!="symbol"&&E7e.test(n))&&n>-1&&n%1==0&&n<e}function BH(n,e,t){e=="__proto__"&&lL?lL(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function Ik(n,e){return n===e||n!==n&&e!==e}var x7e=Object.prototype,T7e=x7e.hasOwnProperty;function yU(n,e,t){var r=n[e];(!(T7e.call(n,e)&&Ik(r,t))||t===void 0&&!(e in n))&&BH(n,e,t)}function FH(n,e,t,r){var i=!t;t||(t={});for(var s=-1,a=e.length;++s<a;){var o=e[s],l=void 0;l===void 0&&(l=n[o]),i?BH(t,o,l):yU(t,o,l)}return t}var PQ=Math.max;function w7e(n,e,t){return e=PQ(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,s=PQ(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=t(a),u7e(n,this,o)}}function zH(n,e){return v7e(w7e(n,e,mw),n+"")}var R7e=9007199254740991;function jH(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=R7e}function ey(n){return n!=null&&jH(n.length)&&!Sb(n)}function qfe(n,e,t){if(!G0(t))return!1;var r=typeof e;return(r=="number"?ey(t)&&vU(e,t.length):r=="string"&&e in t)?Ik(t[e],n):!1}function A7e(n){return zH(function(e,t){var r=-1,i=t.length,s=i>1?t[i-1]:void 0,a=i>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(i--,s):void 0,a&&qfe(t[0],t[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=t[r];o&&n(e,o,r,s)}return e})}var C7e=Object.prototype;function Nk(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||C7e;return n===t}function M7e(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var O7e="[object Arguments]";function DQ(n){return M_(n)&&Z1(n)==O7e}var Vfe=Object.prototype,k7e=Vfe.hasOwnProperty,I7e=Vfe.propertyIsEnumerable,bU=DQ((function(){return arguments})())?DQ:function(n){return M_(n)&&k7e.call(n,"callee")&&!I7e.call(n,"callee")};function N7e(){return!1}var Gfe=typeof Lg=="object"&&Lg&&!Lg.nodeType&&Lg,LQ=Gfe&&typeof kh=="object"&&kh&&!kh.nodeType&&kh,P7e=LQ&&LQ.exports===Gfe,UQ=P7e?Qv.Buffer:void 0,D7e=UQ?UQ.isBuffer:void 0,wO=D7e||N7e,L7e="[object Arguments]",U7e="[object Array]",B7e="[object Boolean]",F7e="[object Date]",z7e="[object Error]",j7e="[object Function]",H7e="[object Map]",q7e="[object Number]",V7e="[object Object]",G7e="[object RegExp]",$7e="[object Set]",W7e="[object String]",Y7e="[object WeakMap]",X7e="[object ArrayBuffer]",K7e="[object DataView]",Z7e="[object Float32Array]",J7e="[object Float64Array]",Q7e="[object Int8Array]",e9e="[object Int16Array]",t9e="[object Int32Array]",n9e="[object Uint8Array]",r9e="[object Uint8ClampedArray]",i9e="[object Uint16Array]",s9e="[object Uint32Array]",rc={};rc[Z7e]=rc[J7e]=rc[Q7e]=rc[e9e]=rc[t9e]=rc[n9e]=rc[r9e]=rc[i9e]=rc[s9e]=!0;rc[L7e]=rc[U7e]=rc[X7e]=rc[B7e]=rc[K7e]=rc[F7e]=rc[z7e]=rc[j7e]=rc[H7e]=rc[q7e]=rc[V7e]=rc[G7e]=rc[$7e]=rc[W7e]=rc[Y7e]=!1;function a9e(n){return M_(n)&&jH(n.length)&&!!rc[Z1(n)]}function SU(n){return function(e){return n(e)}}var $fe=typeof Lg=="object"&&Lg&&!Lg.nodeType&&Lg,j2=$fe&&typeof kh=="object"&&kh&&!kh.nodeType&&kh,o9e=j2&&j2.exports===$fe,WB=o9e&&Ufe.process,I1=(function(){try{var n=j2&&j2.require&&j2.require("util").types;return n||WB&&WB.binding&&WB.binding("util")}catch{}})(),BQ=I1&&I1.isTypedArray,HH=BQ?SU(BQ):a9e,l9e=Object.prototype,c9e=l9e.hasOwnProperty;function Wfe(n,e){var t=ka(n),r=!t&&bU(n),i=!t&&!r&&wO(n),s=!t&&!r&&!i&&HH(n),a=t||r||i||s,o=a?M7e(n.length,String):[],l=o.length;for(var c in n)(e||c9e.call(n,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||vU(c,l)))&&o.push(c);return o}function Yfe(n,e){return function(t){return n(e(t))}}var u9e=Yfe(Object.keys,Object),f9e=Object.prototype,h9e=f9e.hasOwnProperty;function Xfe(n){if(!Nk(n))return u9e(n);var e=[];for(var t in Object(n))h9e.call(n,t)&&t!="constructor"&&e.push(t);return e}function $0(n){return ey(n)?Wfe(n):Xfe(n)}var d9e=Object.prototype,p9e=d9e.hasOwnProperty,zm=A7e(function(n,e){if(Nk(e)||ey(e)){FH(e,$0(e),n);return}for(var t in e)p9e.call(e,t)&&yU(n,t,e[t])});function m9e(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var g9e=Object.prototype,_9e=g9e.hasOwnProperty;function v9e(n){if(!G0(n))return m9e(n);var e=Nk(n),t=[];for(var r in n)r=="constructor"&&(e||!_9e.call(n,r))||t.push(r);return t}function Kfe(n){return ey(n)?Wfe(n,!0):v9e(n)}var y9e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,b9e=/^\w*$/;function qH(n,e){if(ka(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||mU(n)?!0:b9e.test(n)||!y9e.test(n)||e!=null&&n in Object(e)}var RO=ax(Object,"create");function S9e(){this.__data__=RO?RO(null):{},this.size=0}function E9e(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var x9e="__lodash_hash_undefined__",T9e=Object.prototype,w9e=T9e.hasOwnProperty;function R9e(n){var e=this.__data__;if(RO){var t=e[n];return t===x9e?void 0:t}return w9e.call(e,n)?e[n]:void 0}var A9e=Object.prototype,C9e=A9e.hasOwnProperty;function M9e(n){var e=this.__data__;return RO?e[n]!==void 0:C9e.call(e,n)}var O9e="__lodash_hash_undefined__";function k9e(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=RO&&e===void 0?O9e:e,this}function NE(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}NE.prototype.clear=S9e;NE.prototype.delete=E9e;NE.prototype.get=R9e;NE.prototype.has=M9e;NE.prototype.set=k9e;function I9e(){this.__data__=[],this.size=0}function EU(n,e){for(var t=n.length;t--;)if(Ik(n[t][0],e))return t;return-1}var N9e=Array.prototype,P9e=N9e.splice;function D9e(n){var e=this.__data__,t=EU(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():P9e.call(e,t,1),--this.size,!0}function L9e(n){var e=this.__data__,t=EU(e,n);return t<0?void 0:e[t][1]}function U9e(n){return EU(this.__data__,n)>-1}function B9e(n,e){var t=this.__data__,r=EU(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function Eb(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Eb.prototype.clear=I9e;Eb.prototype.delete=D9e;Eb.prototype.get=L9e;Eb.prototype.has=U9e;Eb.prototype.set=B9e;var AO=ax(Qv,"Map");function F9e(){this.size=0,this.__data__={hash:new NE,map:new(AO||Eb),string:new NE}}function z9e(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function xU(n,e){var t=n.__data__;return z9e(e)?t[typeof e=="string"?"string":"hash"]:t.map}function j9e(n){var e=xU(this,n).delete(n);return this.size-=e?1:0,e}function H9e(n){return xU(this,n).get(n)}function q9e(n){return xU(this,n).has(n)}function V9e(n,e){var t=xU(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function xb(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}xb.prototype.clear=F9e;xb.prototype.delete=j9e;xb.prototype.get=H9e;xb.prototype.has=q9e;xb.prototype.set=V9e;var G9e="Expected a function";function VH(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(G9e);var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=t.cache;if(s.has(i))return s.get(i);var a=n.apply(this,r);return t.cache=s.set(i,a)||s,a};return t.cache=new(VH.Cache||xb),t}VH.Cache=xb;var $9e=500;function W9e(n){var e=VH(n,function(r){return t.size===$9e&&t.clear(),r}),t=e.cache;return e}var Y9e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X9e=/\\(\\)?/g,K9e=W9e(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(Y9e,function(t,r,i,s){e.push(i?s.replace(X9e,"$1"):r||t)}),e});function Zfe(n){return n==null?"":Ffe(n)}function TU(n,e){return ka(n)?n:qH(n,e)?[n]:K9e(Zfe(n))}function Pk(n){if(typeof n=="string"||mU(n))return n;var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}function GH(n,e){e=TU(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[Pk(e[t++])];return t&&t==r?n:void 0}function Z9e(n,e,t){var r=n==null?void 0:GH(n,e);return r===void 0?t:r}function $H(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}var FQ=V0?V0.isConcatSpreadable:void 0;function J9e(n){return ka(n)||bU(n)||!!(FQ&&n&&n[FQ])}function WH(n,e,t,r,i){var s=-1,a=n.length;for(t||(t=J9e),i||(i=[]);++s<a;){var o=n[s];t(o)?$H(i,o):r||(i[i.length]=o)}return i}function Pm(n){var e=n==null?0:n.length;return e?WH(n):[]}var Jfe=Yfe(Object.getPrototypeOf,Object);function YH(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function Q9e(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:YH(n,e,t)}var eze="\\ud800-\\udfff",tze="\\u0300-\\u036f",nze="\\ufe20-\\ufe2f",rze="\\u20d0-\\u20ff",ize=tze+nze+rze,sze="\\ufe0e\\ufe0f",aze="\\u200d",oze=RegExp("["+aze+eze+ize+sze+"]");function Qfe(n){return oze.test(n)}function lze(n){return n.split("")}var ehe="\\ud800-\\udfff",cze="\\u0300-\\u036f",uze="\\ufe20-\\ufe2f",fze="\\u20d0-\\u20ff",hze=cze+uze+fze,dze="\\ufe0e\\ufe0f",pze="["+ehe+"]",w9="["+hze+"]",R9="\\ud83c[\\udffb-\\udfff]",mze="(?:"+w9+"|"+R9+")",the="[^"+ehe+"]",nhe="(?:\\ud83c[\\udde6-\\uddff]){2}",rhe="[\\ud800-\\udbff][\\udc00-\\udfff]",gze="\\u200d",ihe=mze+"?",she="["+dze+"]?",_ze="(?:"+gze+"(?:"+[the,nhe,rhe].join("|")+")"+she+ihe+")*",vze=she+ihe+_ze,yze="(?:"+[the+w9+"?",w9,nhe,rhe,pze].join("|")+")",bze=RegExp(R9+"(?="+R9+")|"+yze+vze,"g");function Sze(n){return n.match(bze)||[]}function Eze(n){return Qfe(n)?Sze(n):lze(n)}function xze(n){return function(e){e=Zfe(e);var t=Qfe(e)?Eze(e):void 0,r=t?t[0]:e.charAt(0),i=t?Q9e(t,1).join(""):e.slice(1);return r[n]()+i}}var ahe=xze("toUpperCase");function Tze(n,e,t,r){var i=-1,s=n==null?0:n.length;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function wze(){this.__data__=new Eb,this.size=0}function Rze(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function Aze(n){return this.__data__.get(n)}function Cze(n){return this.__data__.has(n)}var Mze=200;function Oze(n,e){var t=this.__data__;if(t instanceof Eb){var r=t.__data__;if(!AO||r.length<Mze-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new xb(r)}return t.set(n,e),this.size=t.size,this}function Pv(n){var e=this.__data__=new Eb(n);this.size=e.size}Pv.prototype.clear=wze;Pv.prototype.delete=Rze;Pv.prototype.get=Aze;Pv.prototype.has=Cze;Pv.prototype.set=Oze;function kze(n,e){return n&&FH(e,$0(e),n)}var ohe=typeof Lg=="object"&&Lg&&!Lg.nodeType&&Lg,zQ=ohe&&typeof kh=="object"&&kh&&!kh.nodeType&&kh,Ize=zQ&&zQ.exports===ohe,jQ=Ize?Qv.Buffer:void 0,HQ=jQ?jQ.allocUnsafe:void 0;function Nze(n,e){var t=n.length,r=HQ?HQ(t):new n.constructor(t);return n.copy(r),r}function XH(n,e){for(var t=-1,r=n==null?0:n.length,i=0,s=[];++t<r;){var a=n[t];e(a,t,n)&&(s[i++]=a)}return s}function lhe(){return[]}var Pze=Object.prototype,Dze=Pze.propertyIsEnumerable,qQ=Object.getOwnPropertySymbols,KH=qQ?function(n){return n==null?[]:(n=Object(n),XH(qQ(n),function(e){return Dze.call(n,e)}))}:lhe;function Lze(n,e){return FH(n,KH(n),e)}var Uze=Object.getOwnPropertySymbols,Bze=Uze?function(n){for(var e=[];n;)$H(e,KH(n)),n=Jfe(n);return e}:lhe;function che(n,e,t){var r=e(n);return ka(n)?r:$H(r,t(n))}function A9(n){return che(n,$0,KH)}function Fze(n){return che(n,Kfe,Bze)}var C9=ax(Qv,"DataView"),M9=ax(Qv,"Promise"),UT=ax(Qv,"Set"),VQ="[object Map]",zze="[object Object]",GQ="[object Promise]",$Q="[object Set]",WQ="[object WeakMap]",YQ="[object DataView]",jze=sx(C9),Hze=sx(AO),qze=sx(M9),Vze=sx(UT),Gze=sx(T9),T0=Z1;(C9&&T0(new C9(new ArrayBuffer(1)))!=YQ||AO&&T0(new AO)!=VQ||M9&&T0(M9.resolve())!=GQ||UT&&T0(new UT)!=$Q||T9&&T0(new T9)!=WQ)&&(T0=function(n){var e=Z1(n),t=e==zze?n.constructor:void 0,r=t?sx(t):"";if(r)switch(r){case jze:return YQ;case Hze:return VQ;case qze:return GQ;case Vze:return $Q;case Gze:return WQ}return e});var $ze=Object.prototype,Wze=$ze.hasOwnProperty;function Yze(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&Wze.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var cL=Qv.Uint8Array;function Xze(n){var e=new n.constructor(n.byteLength);return new cL(e).set(new cL(n)),e}function Kze(n,e){var t=n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var Zze=/\w*$/;function Jze(n){var e=new n.constructor(n.source,Zze.exec(n));return e.lastIndex=n.lastIndex,e}var XQ=V0?V0.prototype:void 0,KQ=XQ?XQ.valueOf:void 0;function Qze(n){return KQ?Object(KQ.call(n)):{}}function eje(n,e){var t=n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var tje="[object Boolean]",nje="[object Date]",rje="[object Map]",ije="[object Number]",sje="[object RegExp]",aje="[object Set]",oje="[object String]",lje="[object Symbol]",cje="[object ArrayBuffer]",uje="[object DataView]",fje="[object Float32Array]",hje="[object Float64Array]",dje="[object Int8Array]",pje="[object Int16Array]",mje="[object Int32Array]",gje="[object Uint8Array]",_je="[object Uint8ClampedArray]",vje="[object Uint16Array]",yje="[object Uint32Array]";function bje(n,e,t){var r=n.constructor;switch(e){case cje:return Xze(n);case tje:case nje:return new r(+n);case uje:return Kze(n);case fje:case hje:case dje:case pje:case mje:case gje:case _je:case vje:case yje:return eje(n);case rje:return new r;case ije:case oje:return new r(n);case sje:return Jze(n);case aje:return new r;case lje:return Qze(n)}}function Sje(n){return typeof n.constructor=="function"&&!Nk(n)?c7e(Jfe(n)):{}}var Eje="[object Map]";function xje(n){return M_(n)&&T0(n)==Eje}var ZQ=I1&&I1.isMap,Tje=ZQ?SU(ZQ):xje,wje="[object Set]";function Rje(n){return M_(n)&&T0(n)==wje}var JQ=I1&&I1.isSet,Aje=JQ?SU(JQ):Rje,uhe="[object Arguments]",Cje="[object Array]",Mje="[object Boolean]",Oje="[object Date]",kje="[object Error]",fhe="[object Function]",Ije="[object GeneratorFunction]",Nje="[object Map]",Pje="[object Number]",hhe="[object Object]",Dje="[object RegExp]",Lje="[object Set]",Uje="[object String]",Bje="[object Symbol]",Fje="[object WeakMap]",zje="[object ArrayBuffer]",jje="[object DataView]",Hje="[object Float32Array]",qje="[object Float64Array]",Vje="[object Int8Array]",Gje="[object Int16Array]",$je="[object Int32Array]",Wje="[object Uint8Array]",Yje="[object Uint8ClampedArray]",Xje="[object Uint16Array]",Kje="[object Uint32Array]",Ll={};Ll[uhe]=Ll[Cje]=Ll[zje]=Ll[jje]=Ll[Mje]=Ll[Oje]=Ll[Hje]=Ll[qje]=Ll[Vje]=Ll[Gje]=Ll[$je]=Ll[Nje]=Ll[Pje]=Ll[hhe]=Ll[Dje]=Ll[Lje]=Ll[Uje]=Ll[Bje]=Ll[Wje]=Ll[Yje]=Ll[Xje]=Ll[Kje]=!0;Ll[kje]=Ll[fhe]=Ll[Fje]=!1;function _P(n,e,t,r,i,s){var a;if(a!==void 0)return a;if(!G0(n))return n;var o=ka(n);if(o)return a=Yze(n),f7e(n,a);var l=T0(n),c=l==fhe||l==Ije;if(wO(n))return Nze(n);if(l==hhe||l==uhe||c&&!i)return a=c?{}:Sje(n),Lze(n,kze(a,n));if(!Ll[l])return i?n:{};a=bje(n,l),s||(s=new Pv);var u=s.get(n);if(u)return u;s.set(n,a),Aje(n)?n.forEach(function(g){a.add(_P(g,e,t,g,n,s))}):Tje(n)&&n.forEach(function(g,p){a.set(p,_P(g,e,t,p,n,s))});var f=A9,h=o?void 0:f(n);return zfe(h||n,function(g,p){h&&(p=g,g=n[p]),yU(a,p,_P(g,e,t,p,n,s))}),a}var Zje=4;function Td(n){return _P(n,Zje)}function Dk(n){for(var e=-1,t=n==null?0:n.length,r=0,i=[];++e<t;){var s=n[e];s&&(i[r++]=s)}return i}var Jje="__lodash_hash_undefined__";function Qje(n){return this.__data__.set(n,Jje),this}function eHe(n){return this.__data__.has(n)}function gw(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new xb;++e<t;)this.add(n[e])}gw.prototype.add=gw.prototype.push=Qje;gw.prototype.has=eHe;function dhe(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function ZH(n,e){return n.has(e)}var tHe=1,nHe=2;function phe(n,e,t,r,i,s){var a=t&tHe,o=n.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(n),u=s.get(e);if(c&&u)return c==e&&u==n;var f=-1,h=!0,g=t&nHe?new gw:void 0;for(s.set(n,e),s.set(e,n);++f<o;){var p=n[f],_=e[f];if(r)var y=a?r(_,p,f,e,n,s):r(p,_,f,n,e,s);if(y!==void 0){if(y)continue;h=!1;break}if(g){if(!dhe(e,function(v,x){if(!ZH(g,x)&&(p===v||i(p,v,t,r,s)))return g.push(x)})){h=!1;break}}else if(!(p===_||i(p,_,t,r,s))){h=!1;break}}return s.delete(n),s.delete(e),h}function rHe(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}function JH(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var iHe=1,sHe=2,aHe="[object Boolean]",oHe="[object Date]",lHe="[object Error]",cHe="[object Map]",uHe="[object Number]",fHe="[object RegExp]",hHe="[object Set]",dHe="[object String]",pHe="[object Symbol]",mHe="[object ArrayBuffer]",gHe="[object DataView]",QQ=V0?V0.prototype:void 0,YB=QQ?QQ.valueOf:void 0;function _He(n,e,t,r,i,s,a){switch(t){case gHe:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case mHe:return!(n.byteLength!=e.byteLength||!s(new cL(n),new cL(e)));case aHe:case oHe:case uHe:return Ik(+n,+e);case lHe:return n.name==e.name&&n.message==e.message;case fHe:case dHe:return n==e+"";case cHe:var o=rHe;case hHe:var l=r&iHe;if(o||(o=JH),n.size!=e.size&&!l)return!1;var c=a.get(n);if(c)return c==e;r|=sHe,a.set(n,e);var u=phe(o(n),o(e),r,i,s,a);return a.delete(n),u;case pHe:if(YB)return YB.call(n)==YB.call(e)}return!1}var vHe=1,yHe=Object.prototype,bHe=yHe.hasOwnProperty;function SHe(n,e,t,r,i,s){var a=t&vHe,o=A9(n),l=o.length,c=A9(e),u=c.length;if(l!=u&&!a)return!1;for(var f=l;f--;){var h=o[f];if(!(a?h in e:bHe.call(e,h)))return!1}var g=s.get(n),p=s.get(e);if(g&&p)return g==e&&p==n;var _=!0;s.set(n,e),s.set(e,n);for(var y=a;++f<l;){h=o[f];var v=n[h],x=e[h];if(r)var E=a?r(x,v,h,e,n,s):r(v,x,h,n,e,s);if(!(E===void 0?v===x||i(v,x,t,r,s):E)){_=!1;break}y||(y=h=="constructor")}if(_&&!y){var M=n.constructor,k=e.constructor;M!=k&&"constructor"in n&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof k=="function"&&k instanceof k)&&(_=!1)}return s.delete(n),s.delete(e),_}var EHe=1,eee="[object Arguments]",tee="[object Array]",lN="[object Object]",xHe=Object.prototype,nee=xHe.hasOwnProperty;function THe(n,e,t,r,i,s){var a=ka(n),o=ka(e),l=a?tee:T0(n),c=o?tee:T0(e);l=l==eee?lN:l,c=c==eee?lN:c;var u=l==lN,f=c==lN,h=l==c;if(h&&wO(n)){if(!wO(e))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new Pv),a||HH(n)?phe(n,e,t,r,i,s):_He(n,e,l,t,r,i,s);if(!(t&EHe)){var g=u&&nee.call(n,"__wrapped__"),p=f&&nee.call(e,"__wrapped__");if(g||p){var _=g?n.value():n,y=p?e.value():e;return s||(s=new Pv),i(_,y,t,r,s)}}return h?(s||(s=new Pv),SHe(n,e,t,r,i,s)):!1}function QH(n,e,t,r,i){return n===e?!0:n==null||e==null||!M_(n)&&!M_(e)?n!==n&&e!==e:THe(n,e,t,r,QH,i)}var wHe=1,RHe=2;function AHe(n,e,t,r){var i=t.length,s=i;if(n==null)return!s;for(n=Object(n);i--;){var a=t[i];if(a[2]?a[1]!==n[a[0]]:!(a[0]in n))return!1}for(;++i<s;){a=t[i];var o=a[0],l=n[o],c=a[1];if(a[2]){if(l===void 0&&!(o in n))return!1}else{var u=new Pv,f;if(!(f===void 0?QH(c,l,wHe|RHe,r,u):f))return!1}}return!0}function mhe(n){return n===n&&!G0(n)}function CHe(n){for(var e=$0(n),t=e.length;t--;){var r=e[t],i=n[r];e[t]=[r,i,mhe(i)]}return e}function ghe(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}function MHe(n){var e=CHe(n);return e.length==1&&e[0][2]?ghe(e[0][0],e[0][1]):function(t){return t===n||AHe(t,n,e)}}function OHe(n,e){return n!=null&&e in Object(n)}function _he(n,e,t){e=TU(e,n);for(var r=-1,i=e.length,s=!1;++r<i;){var a=Pk(e[r]);if(!(s=n!=null&&t(n,a)))break;n=n[a]}return s||++r!=i?s:(i=n==null?0:n.length,!!i&&jH(i)&&vU(a,i)&&(ka(n)||bU(n)))}function kHe(n,e){return n!=null&&_he(n,e,OHe)}var IHe=1,NHe=2;function PHe(n,e){return qH(n)&&mhe(e)?ghe(Pk(n),e):function(t){var r=Z9e(t,n);return r===void 0&&r===e?kHe(t,n):QH(e,r,IHe|NHe)}}function DHe(n){return function(e){return e?.[n]}}function LHe(n){return function(e){return GH(e,n)}}function UHe(n){return qH(n)?DHe(Pk(n)):LHe(n)}function ty(n){return typeof n=="function"?n:n==null?mw:typeof n=="object"?ka(n)?PHe(n[0],n[1]):MHe(n):UHe(n)}function BHe(n,e,t,r){for(var i=-1,s=n==null?0:n.length;++i<s;){var a=n[i];e(r,a,t(a),n)}return r}function FHe(n){return function(e,t,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var l=a[++i];if(t(s[l],l,s)===!1)break}return e}}var zHe=FHe();function jHe(n,e){return n&&zHe(n,e,$0)}function HHe(n,e){return function(t,r){if(t==null)return t;if(!ey(t))return n(t,r);for(var i=t.length,s=-1,a=Object(t);++s<i&&r(a[s],s,a)!==!1;);return t}}var ox=HHe(jHe);function qHe(n,e,t,r){return ox(n,function(i,s,a){e(r,i,t(i),a)}),r}function VHe(n,e){return function(t,r){var i=ka(t)?BHe:qHe,s=e?e():{};return i(t,n,ty(r),s)}}var vhe=Object.prototype,GHe=vhe.hasOwnProperty,eq=zH(function(n,e){n=Object(n);var t=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&qfe(e[0],e[1],i)&&(r=1);++t<r;)for(var s=e[t],a=Kfe(s),o=-1,l=a.length;++o<l;){var c=a[o],u=n[c];(u===void 0||Ik(u,vhe[c])&&!GHe.call(n,c))&&(n[c]=s[c])}return n});function ree(n){return M_(n)&&ey(n)}var $He=200;function WHe(n,e,t,r){var i=-1,s=Hfe,a=!0,o=n.length,l=[],c=e.length;if(!o)return l;e.length>=$He&&(s=ZH,a=!1,e=new gw(e));e:for(;++i<o;){var u=n[i],f=u;if(u=u!==0?u:0,a&&f===f){for(var h=c;h--;)if(e[h]===f)continue e;l.push(u)}else s(e,f,r)||l.push(u)}return l}var wU=zH(function(n,e){return ree(n)?WHe(n,WH(e,1,ree,!0)):[]});function _w(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function yd(n,e,t){var r=n==null?0:n.length;return r?(e=e===void 0?1:_U(e),YH(n,e<0?0:e,r)):[]}function CO(n,e,t){var r=n==null?0:n.length;return r?(e=e===void 0?1:_U(e),e=r-e,YH(n,0,e<0?0:e)):[]}function YHe(n){return typeof n=="function"?n:mw}function Ai(n,e){var t=ka(n)?zfe:ox;return t(n,YHe(e))}function XHe(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(!e(n[t],t,n))return!1;return!0}function KHe(n,e){var t=!0;return ox(n,function(r,i,s){return t=!!e(r,i,s),t}),t}function A_(n,e,t){var r=ka(n)?XHe:KHe;return r(n,ty(e))}function yhe(n,e){var t=[];return ox(n,function(r,i,s){e(r,i,s)&&t.push(r)}),t}function K0(n,e){var t=ka(n)?XH:yhe;return t(n,ty(e))}function ZHe(n){return function(e,t,r){var i=Object(e);if(!ey(e)){var s=ty(t);e=$0(e),t=function(o){return s(i[o],o,i)}}var a=n(e,t,r);return a>-1?i[s?e[a]:a]:void 0}}var JHe=Math.max;function QHe(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var i=t==null?0:_U(t);return i<0&&(i=JHe(r+i,0)),jfe(n,ty(e),i)}var vw=ZHe(QHe);function O_(n){return n&&n.length?n[0]:void 0}function eqe(n,e){var t=-1,r=ey(n)?Array(n.length):[];return ox(n,function(i,s,a){r[++t]=e(i,s,a)}),r}function Cr(n,e){var t=ka(n)?gU:eqe;return t(n,ty(e))}function B0(n,e){return WH(Cr(n,e))}var tqe=Object.prototype,nqe=tqe.hasOwnProperty,bhe=VHe(function(n,e,t){nqe.call(n,t)?n[t].push(e):BH(n,t,[e])}),rqe=Object.prototype,iqe=rqe.hasOwnProperty;function sqe(n,e){return n!=null&&iqe.call(n,e)}function pi(n,e){return n!=null&&_he(n,e,sqe)}var aqe="[object String]";function jm(n){return typeof n=="string"||!ka(n)&&M_(n)&&Z1(n)==aqe}function oqe(n,e){return gU(e,function(t){return n[t]})}function vf(n){return n==null?[]:oqe(n,$0(n))}var lqe=Math.max;function Vp(n,e,t,r){n=ey(n)?n:vf(n),t=t?_U(t):0;var i=n.length;return t<0&&(t=lqe(i+t,0)),jm(n)?t<=i&&n.indexOf(e,t)>-1:!!i&&UH(n,e,t)>-1}function iee(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var i=0;return UH(n,e,i)}var cqe="[object Map]",uqe="[object Set]",fqe=Object.prototype,hqe=fqe.hasOwnProperty;function jl(n){if(n==null)return!0;if(ey(n)&&(ka(n)||typeof n=="string"||typeof n.splice=="function"||wO(n)||HH(n)||bU(n)))return!n.length;var e=T0(n);if(e==cqe||e==uqe)return!n.size;if(Nk(n))return!Xfe(n).length;for(var t in n)if(hqe.call(n,t))return!1;return!0}var dqe="[object RegExp]";function pqe(n){return M_(n)&&Z1(n)==dqe}var see=I1&&I1.isRegExp,hb=see?SU(see):pqe;function db(n){return n===void 0}var mqe="Expected a function";function gqe(n){if(typeof n!="function")throw new TypeError(mqe);return function(){var e=arguments;switch(e.length){case 0:return!n.call(this);case 1:return!n.call(this,e[0]);case 2:return!n.call(this,e[0],e[1]);case 3:return!n.call(this,e[0],e[1],e[2])}return!n.apply(this,e)}}function _qe(n,e,t,r){if(!G0(n))return n;e=TU(e,n);for(var i=-1,s=e.length,a=s-1,o=n;o!=null&&++i<s;){var l=Pk(e[i]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(i!=a){var u=o[l];c=void 0,c===void 0&&(c=G0(u)?u:vU(e[i+1])?[]:{})}yU(o,l,c),o=o[l]}return n}function vqe(n,e,t){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=GH(n,a);t(o,a)&&_qe(s,TU(a,n),o)}return s}function z_(n,e){if(n==null)return{};var t=gU(Fze(n),function(r){return[r]});return e=ty(e),vqe(n,t,function(r,i){return e(r,i[0])})}function yqe(n,e,t,r,i){return i(n,function(s,a,o){t=r?(r=!1,s):e(t,s,a,o)}),t}function Hm(n,e,t){var r=ka(n)?Tze:yqe,i=arguments.length<3;return r(n,ty(e),t,i,ox)}function RU(n,e){var t=ka(n)?XH:yhe;return t(n,gqe(ty(e)))}function bqe(n,e){var t;return ox(n,function(r,i,s){return t=e(r,i,s),!t}),!!t}function tq(n,e,t){var r=ka(n)?dhe:bqe;return r(n,ty(e))}var Sqe=1/0,Eqe=UT&&1/JH(new UT([,-0]))[1]==Sqe?function(n){return new UT(n)}:qf,xqe=200;function Tqe(n,e,t){var r=-1,i=Hfe,s=n.length,a=!0,o=[],l=o;if(s>=xqe){var c=Eqe(n);if(c)return JH(c);a=!1,i=ZH,l=new gw}else l=o;e:for(;++r<s;){var u=n[r],f=u;if(u=u!==0?u:0,a&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;o.push(u)}else i(l,f,t)||(l!==o&&l.push(f),o.push(u))}return o}function AU(n){return n&&n.length?Tqe(n):[]}function O9(n){console&&console.error&&console.error(`Error: ${n}`)}function She(n){console&&console.warn&&console.warn(`Warning: ${n}`)}function Ehe(n){const e=new Date().getTime(),t=n();return{time:new Date().getTime()-e,value:t}}function xhe(n){function e(){}e.prototype=n;const t=new e;function r(){return typeof t.bar}return r(),r(),n}function wqe(n){return Rqe(n)?n.LABEL:n.name}function Rqe(n){return jm(n.LABEL)&&n.LABEL!==""}class ny{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Ai(this.definition,t=>{t.accept(e)})}}class qm extends ny{constructor(e){super([]),this.idx=1,zm(this,z_(e,t=>t!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class nR extends ny{constructor(e){super(e.definition),this.orgText="",zm(this,z_(e,t=>t!==void 0))}}class Vm extends ny{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,zm(this,z_(e,t=>t!==void 0))}}class Dm extends ny{constructor(e){super(e.definition),this.idx=1,zm(this,z_(e,t=>t!==void 0))}}class ry extends ny{constructor(e){super(e.definition),this.idx=1,zm(this,z_(e,t=>t!==void 0))}}class iy extends ny{constructor(e){super(e.definition),this.idx=1,zm(this,z_(e,t=>t!==void 0))}}class Wf extends ny{constructor(e){super(e.definition),this.idx=1,zm(this,z_(e,t=>t!==void 0))}}class j_ extends ny{constructor(e){super(e.definition),this.idx=1,zm(this,z_(e,t=>t!==void 0))}}class H_ extends ny{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,zm(this,z_(e,t=>t!==void 0))}}class Vc{constructor(e){this.idx=1,zm(this,z_(e,t=>t!==void 0))}accept(e){e.visit(this)}}function Aqe(n){return Cr(n,vP)}function vP(n){function e(t){return Cr(t,vP)}if(n instanceof qm){const t={type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};return jm(n.label)&&(t.label=n.label),t}else{if(n instanceof Vm)return{type:"Alternative",definition:e(n.definition)};if(n instanceof Dm)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof ry)return{type:"RepetitionMandatory",idx:n.idx,definition:e(n.definition)};if(n instanceof iy)return{type:"RepetitionMandatoryWithSeparator",idx:n.idx,separator:vP(new Vc({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof j_)return{type:"RepetitionWithSeparator",idx:n.idx,separator:vP(new Vc({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Wf)return{type:"Repetition",idx:n.idx,definition:e(n.definition)};if(n instanceof H_)return{type:"Alternation",idx:n.idx,definition:e(n.definition)};if(n instanceof Vc){const t={type:"Terminal",name:n.terminalType.name,label:wqe(n.terminalType),idx:n.idx};jm(n.label)&&(t.terminalLabel=n.label);const r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=hb(r)?r.source:r),t}else{if(n instanceof nR)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}}class lx{visit(e){const t=e;switch(t.constructor){case qm:return this.visitNonTerminal(t);case Vm:return this.visitAlternative(t);case Dm:return this.visitOption(t);case ry:return this.visitRepetitionMandatory(t);case iy:return this.visitRepetitionMandatoryWithSeparator(t);case j_:return this.visitRepetitionWithSeparator(t);case Wf:return this.visitRepetition(t);case H_:return this.visitAlternation(t);case Vc:return this.visitTerminal(t);case nR:return this.visitRule(t);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function Cqe(n){return n instanceof Vm||n instanceof Dm||n instanceof Wf||n instanceof ry||n instanceof iy||n instanceof j_||n instanceof Vc||n instanceof nR}function uL(n,e=[]){return n instanceof Dm||n instanceof Wf||n instanceof j_?!0:n instanceof H_?tq(n.definition,r=>uL(r,e)):n instanceof qm&&Vp(e,n)?!1:n instanceof ny?(n instanceof qm&&e.push(n),A_(n.definition,r=>uL(r,e))):!1}function Mqe(n){return n instanceof H_}function gv(n){if(n instanceof qm)return"SUBRULE";if(n instanceof Dm)return"OPTION";if(n instanceof H_)return"OR";if(n instanceof ry)return"AT_LEAST_ONE";if(n instanceof iy)return"AT_LEAST_ONE_SEP";if(n instanceof j_)return"MANY_SEP";if(n instanceof Wf)return"MANY";if(n instanceof Vc)return"CONSUME";throw Error("non exhaustive match")}class CU{walk(e,t=[]){Ai(e.definition,(r,i)=>{const s=yd(e.definition,i+1);if(r instanceof qm)this.walkProdRef(r,s,t);else if(r instanceof Vc)this.walkTerminal(r,s,t);else if(r instanceof Vm)this.walkFlat(r,s,t);else if(r instanceof Dm)this.walkOption(r,s,t);else if(r instanceof ry)this.walkAtLeastOne(r,s,t);else if(r instanceof iy)this.walkAtLeastOneSep(r,s,t);else if(r instanceof j_)this.walkManySep(r,s,t);else if(r instanceof Wf)this.walkMany(r,s,t);else if(r instanceof H_)this.walkOr(r,s,t);else throw Error("non exhaustive match")})}walkTerminal(e,t,r){}walkProdRef(e,t,r){}walkFlat(e,t,r){const i=t.concat(r);this.walk(e,i)}walkOption(e,t,r){const i=t.concat(r);this.walk(e,i)}walkAtLeastOne(e,t,r){const i=[new Dm({definition:e.definition})].concat(t,r);this.walk(e,i)}walkAtLeastOneSep(e,t,r){const i=aee(e,t,r);this.walk(e,i)}walkMany(e,t,r){const i=[new Dm({definition:e.definition})].concat(t,r);this.walk(e,i)}walkManySep(e,t,r){const i=aee(e,t,r);this.walk(e,i)}walkOr(e,t,r){const i=t.concat(r);Ai(e.definition,s=>{const a=new Vm({definition:[s]});this.walk(a,i)})}}function aee(n,e,t){return[new Dm({definition:[new Vc({terminalType:n.separator})].concat(n.definition)})].concat(e,t)}function Lk(n){if(n instanceof qm)return Lk(n.referencedRule);if(n instanceof Vc)return Iqe(n);if(Cqe(n))return Oqe(n);if(Mqe(n))return kqe(n);throw Error("non exhaustive match")}function Oqe(n){let e=[];const t=n.definition;let r=0,i=t.length>r,s,a=!0;for(;i&&a;)s=t[r],a=uL(s),e=e.concat(Lk(s)),r=r+1,i=t.length>r;return AU(e)}function kqe(n){const e=Cr(n.definition,t=>Lk(t));return AU(Pm(e))}function Iqe(n){return[n.terminalType]}const The="_~IN~_";class Nqe extends CU{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,t,r){}walkProdRef(e,t,r){const i=Dqe(e.referencedRule,e.idx)+this.topProd.name,s=t.concat(r),a=new Vm({definition:s}),o=Lk(a);this.follows[i]=o}}function Pqe(n){const e={};return Ai(n,t=>{const r=new Nqe(t).startWalking();zm(e,r)}),e}function Dqe(n,e){return n.name+e+The}function Ii(n){return n.charCodeAt(0)}function XB(n,e){Array.isArray(n)?n.forEach(function(t){e.push(t)}):e.push(n)}function BM(n,e){if(n[e]===!0)throw"duplicate flag "+e;n[e],n[e]=!0}function Qx(n){if(n===void 0)throw Error("Internal Error - Should never get here!");return!0}function Lqe(){throw Error("Internal Error - Should never get here!")}function oee(n){return n.type==="Character"}const fL=[];for(let n=Ii("0");n<=Ii("9");n++)fL.push(n);const hL=[Ii("_")].concat(fL);for(let n=Ii("a");n<=Ii("z");n++)hL.push(n);for(let n=Ii("A");n<=Ii("Z");n++)hL.push(n);const lee=[Ii(" "),Ii("\f"),Ii(`
`),Ii("\r"),Ii("	"),Ii("\v"),Ii("	"),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii(" "),Ii("\u2028"),Ii("\u2029"),Ii(" "),Ii(" "),Ii("　"),Ii("\uFEFF")],Uqe=/[0-9a-fA-F]/,cN=/[0-9]/,Bqe=/[1-9]/;class Fqe{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const t=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":BM(r,"global");break;case"i":BM(r,"ignoreCase");break;case"m":BM(r,"multiLine");break;case"u":BM(r,"unicode");break;case"y":BM(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t,loc:this.loc(0)}}disjunction(){const e=[],t=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){const e=[],t=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(t)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let t;switch(this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead";break}Qx(t);const r=this.disjunction();return this.consumeChar(")"),{type:t,value:r,loc:this.loc(e)}}return Lqe()}quantifier(e=!1){let t;const r=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),t={atLeast:i,atMost:s}):t={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&t===void 0)return;Qx(t);break}if(!(e===!0&&t===void 0)&&Qx(t))return this.peekChar(0)==="?"?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t.loc=this.loc(r),t}atom(){let e;const t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),Qx(e))return e.loc=this.loc(t),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Ii(`
`),Ii("\r"),Ii("\u2028"),Ii("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,t=!1;switch(this.popChar()){case"d":e=fL;break;case"D":e=fL,t=!0;break;case"s":e=lee;break;case"S":e=lee,t=!0;break;case"w":e=hL;break;case"W":e=hL,t=!0;break}if(Qx(e))return{type:"Set",value:e,complement:t}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Ii("\f");break;case"n":e=Ii(`
`);break;case"r":e=Ii("\r");break;case"t":e=Ii("	");break;case"v":e=Ii("\v");break}if(Qx(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Ii("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Ii(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Ii(e)}}}characterClass(){const e=[];let t=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),t=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,oee(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,oee(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.value})}else XB(r.value,e),e.push(Ii("-")),XB(i.value,e)}else XB(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Ii("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const t=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(Bqe.test(e)===!1)throw Error("Expecting a positive integer");for(;cN.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(cN.test(e)===!1)throw Error("Expecting an integer");for(;cN.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Ii(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return cN.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let t="";for(let i=0;i<e;i++){const s=this.popChar();if(Uqe.test(s)===!1)throw Error("Expecting a HexDecimal digits");t+=s}return{type:"Character",value:parseInt(t,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class nq{visitChildren(e){for(const t in e){const r=e[t];e.hasOwnProperty(t)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let yP={};const zqe=new Fqe;function MU(n){const e=n.toString();if(yP.hasOwnProperty(e))return yP[e];{const t=zqe.pattern(e);return yP[e]=t,t}}function jqe(){yP={}}const whe="Complement Sets are not supported for first char optimization",dL=`Unable to use "first char" lexer optimizations:
`;function Hqe(n,e=!1){try{const t=MU(n);return k9(t.value,{},t.flags.ignoreCase)}catch(t){if(t.message===whe)e&&She(`${dL}	Unable to optimize: < ${n.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),O9(`${dL}
	Failed parsing: < ${n.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function k9(n,e,t){switch(n.type){case"Disjunction":for(let i=0;i<n.value.length;i++)k9(n.value[i],e,t);break;case"Alternative":const r=n.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":uN(a.value,e,t);break;case"Set":if(a.complement===!0)throw Error(whe);Ai(a.value,l=>{if(typeof l=="number")uN(l,e,t);else{const c=l;if(t===!0)for(let u=c.from;u<=c.to;u++)uN(u,e,t);else{for(let u=c.from;u<=c.to&&u<b2;u++)uN(u,e,t);if(c.to>=b2){const u=c.from>=b2?c.from:b2,f=c.to,h=N1(u),g=N1(f);for(let p=h;p<=g;p++)e[p]=p}}}});break;case"Group":k9(a.value,e,t);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&I9(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return vf(e)}function uN(n,e,t){const r=N1(n);e[r]=r,t===!0&&qqe(n,e)}function qqe(n,e){const t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){const i=N1(r.charCodeAt(0));e[i]=i}else{const i=t.toLowerCase();if(i!==t){const s=N1(i.charCodeAt(0));e[s]=s}}}function cee(n,e){return vw(n.value,t=>{if(typeof t=="number")return Vp(e,t);{const r=t;return vw(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function I9(n){const e=n.quantifier;return e&&e.atLeast===0?!0:n.value?ka(n.value)?A_(n.value,I9):I9(n.value):!1}class Vqe extends nq{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){Vp(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?cee(e,this.targetCharCodes)===void 0&&(this.found=!0):cee(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function rq(n,e){if(e instanceof RegExp){const t=MU(e),r=new Vqe(n);return r.visit(t),r.found}else return vw(e,t=>Vp(n,t.charCodeAt(0)))!==void 0}const PE="PATTERN",y2="defaultMode",fN="modes";let Rhe=typeof new RegExp("(?:)").sticky=="boolean";function Gqe(n,e){e=eq(e,{useSticky:Rhe,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(x,E)=>E()});const t=e.tracer;t("initCharCodeToOptimizedIndexMap",()=>{pVe()});let r;t("Reject Lexer.NA",()=>{r=RU(n,x=>x[PE]===Nh.NA)});let i=!1,s;t("Transform Patterns",()=>{i=!1,s=Cr(r,x=>{const E=x[PE];if(hb(E)){const M=E.source;return M.length===1&&M!=="^"&&M!=="$"&&M!=="."&&!E.ignoreCase?M:M.length===2&&M[0]==="\\"&&!Vp(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],M[1])?M[1]:e.useSticky?fee(E):uee(E)}else{if(Sb(E))return i=!0,{exec:E};if(typeof E=="object")return i=!0,E;if(typeof E=="string"){if(E.length===1)return E;{const M=E.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),k=new RegExp(M);return e.useSticky?fee(k):uee(k)}}else throw Error("non exhaustive match")}})});let a,o,l,c,u;t("misc mapping",()=>{a=Cr(r,x=>x.tokenTypeIdx),o=Cr(r,x=>{const E=x.GROUP;if(E!==Nh.SKIPPED){if(jm(E))return E;if(db(E))return!1;throw Error("non exhaustive match")}}),l=Cr(r,x=>{const E=x.LONGER_ALT;if(E)return ka(E)?Cr(E,k=>iee(r,k)):[iee(r,E)]}),c=Cr(r,x=>x.PUSH_MODE),u=Cr(r,x=>pi(x,"POP_MODE"))});let f;t("Line Terminator Handling",()=>{const x=Mhe(e.lineTerminatorCharacters);f=Cr(r,E=>!1),e.positionTracking!=="onlyOffset"&&(f=Cr(r,E=>pi(E,"LINE_BREAKS")?!!E.LINE_BREAKS:Che(E,x)===!1&&rq(x,E.PATTERN)))});let h,g,p,_;t("Misc Mapping #2",()=>{h=Cr(r,Ahe),g=Cr(s,fVe),p=Hm(r,(x,E)=>{const M=E.GROUP;return jm(M)&&M!==Nh.SKIPPED&&(x[M]=[]),x},{}),_=Cr(s,(x,E)=>({pattern:s[E],longerAlt:l[E],canLineTerminator:f[E],isCustom:h[E],short:g[E],group:o[E],push:c[E],pop:u[E],tokenTypeIdx:a[E],tokenType:r[E]}))});let y=!0,v=[];return e.safeMode||t("First Char Optimization",()=>{v=Hm(r,(x,E,M)=>{if(typeof E.PATTERN=="string"){const k=E.PATTERN.charCodeAt(0),N=N1(k);KB(x,N,_[M])}else if(ka(E.START_CHARS_HINT)){let k;Ai(E.START_CHARS_HINT,N=>{const I=typeof N=="string"?N.charCodeAt(0):N,D=N1(I);k!==D&&(k=D,KB(x,D,_[M]))})}else if(hb(E.PATTERN))if(E.PATTERN.unicode)y=!1,e.ensureOptimizations&&O9(`${dL}	Unable to analyze < ${E.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const k=Hqe(E.PATTERN,e.ensureOptimizations);jl(k)&&(y=!1),Ai(k,N=>{KB(x,N,_[M])})}else e.ensureOptimizations&&O9(`${dL}	TokenType: <${E.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return x},[])}),{emptyGroups:p,patternIdxToConfig:_,charCodeToPatternIdxToConfig:v,hasCustom:i,canBeOptimized:y}}function $qe(n,e){let t=[];const r=Yqe(n);t=t.concat(r.errors);const i=Xqe(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(Wqe(s)),t=t.concat(rVe(s)),t=t.concat(iVe(s,e)),t=t.concat(sVe(s)),t}function Wqe(n){let e=[];const t=K0(n,r=>hb(r[PE]));return e=e.concat(Zqe(t)),e=e.concat(eVe(t)),e=e.concat(tVe(t)),e=e.concat(nVe(t)),e=e.concat(Jqe(t)),e}function Yqe(n){const e=K0(n,i=>!pi(i,PE)),t=Cr(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:yu.MISSING_PATTERN,tokenTypes:[i]})),r=wU(n,e);return{errors:t,valid:r}}function Xqe(n){const e=K0(n,i=>{const s=i[PE];return!hb(s)&&!Sb(s)&&!pi(s,"exec")&&!jm(s)}),t=Cr(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:yu.INVALID_PATTERN,tokenTypes:[i]})),r=wU(n,e);return{errors:t,valid:r}}const Kqe=/[^\\][$]/;function Zqe(n){class e extends nq{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const t=K0(n,i=>{const s=i.PATTERN;try{const a=MU(s),o=new e;return o.visit(a),o.found}catch{return Kqe.test(s.source)}});return Cr(t,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:yu.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function Jqe(n){const e=K0(n,r=>r.PATTERN.test(""));return Cr(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:yu.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const Qqe=/[^\\[][\^]|^\^/;function eVe(n){class e extends nq{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const t=K0(n,i=>{const s=i.PATTERN;try{const a=MU(s),o=new e;return o.visit(a),o.found}catch{return Qqe.test(s.source)}});return Cr(t,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:yu.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function tVe(n){const e=K0(n,r=>{const i=r[PE];return i instanceof RegExp&&(i.multiline||i.global)});return Cr(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:yu.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function nVe(n){const e=[];let t=Cr(n,s=>Hm(n,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!Vp(e,o)&&o.PATTERN!==Nh.NA&&(e.push(o),a.push(o)),a),[]));t=Dk(t);const r=K0(t,s=>s.length>1);return Cr(r,s=>{const a=Cr(s,l=>l.name);return{message:`The same RegExp pattern ->${O_(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:yu.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function rVe(n){const e=K0(n,r=>{if(!pi(r,"GROUP"))return!1;const i=r.GROUP;return i!==Nh.SKIPPED&&i!==Nh.NA&&!jm(i)});return Cr(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:yu.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function iVe(n,e){const t=K0(n,i=>i.PUSH_MODE!==void 0&&!Vp(e,i.PUSH_MODE));return Cr(t,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:yu.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function sVe(n){const e=[],t=Hm(n,(r,i,s)=>{const a=i.PATTERN;return a===Nh.NA||(jm(a)?r.push({str:a,idx:s,tokenType:i}):hb(a)&&oVe(a)&&r.push({str:a.source,idx:s,tokenType:i})),r},[]);return Ai(n,(r,i)=>{Ai(t,({str:s,idx:a,tokenType:o})=>{if(i<a&&aVe(s,r.PATTERN)){const l=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:l,type:yu.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function aVe(n,e){if(hb(e)){const t=e.exec(n);return t!==null&&t.index===0}else{if(Sb(e))return e(n,0,[],{});if(pi(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function oVe(n){return vw([".","\\","[","]","|","^","$","(",")","?","*","+","{"],t=>n.source.indexOf(t)!==-1)===void 0}function uee(n){const e=n.ignoreCase?"i":"";return new RegExp(`^(?:${n.source})`,e)}function fee(n){const e=n.ignoreCase?"iy":"y";return new RegExp(`${n.source}`,e)}function lVe(n,e,t){const r=[];return pi(n,y2)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+y2+`> property in its definition
`,type:yu.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),pi(n,fN)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+fN+`> property in its definition
`,type:yu.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),pi(n,fN)&&pi(n,y2)&&!pi(n.modes,n.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${y2}: <${n.defaultMode}>which does not exist
`,type:yu.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),pi(n,fN)&&Ai(n.modes,(i,s)=>{Ai(i,(a,o)=>{if(db(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:yu.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(pi(a,"LONGER_ALT")){const l=ka(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];Ai(l,c=>{!db(c)&&!Vp(i,c)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${c.name}> on token <${a.name}> outside of mode <${s}>
`,type:yu.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function cVe(n,e,t){const r=[];let i=!1;const s=Dk(Pm(vf(n.modes))),a=RU(s,l=>l[PE]===Nh.NA),o=Mhe(t);return e&&Ai(a,l=>{const c=Che(l,o);if(c!==!1){const f={message:dVe(l,c),type:c.issue,tokenType:l};r.push(f)}else pi(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):rq(o,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:yu.NO_LINE_BREAKS_FLAGS}),r}function uVe(n){const e={},t=$0(n);return Ai(t,r=>{const i=n[r];if(ka(i))e[r]=[];else throw Error("non exhaustive match")}),e}function Ahe(n){const e=n.PATTERN;if(hb(e))return!1;if(Sb(e))return!0;if(pi(e,"exec"))return!0;if(jm(e))return!1;throw Error("non exhaustive match")}function fVe(n){return jm(n)&&n.length===1?n.charCodeAt(0):!1}const hVe={test:function(n){const e=n.length;for(let t=this.lastIndex;t<e;t++){const r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function Che(n,e){if(pi(n,"LINE_BREAKS"))return!1;if(hb(n.PATTERN)){try{rq(e,n.PATTERN)}catch(t){return{issue:yu.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(jm(n.PATTERN))return!1;if(Ahe(n))return{issue:yu.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function dVe(n,e){if(e.issue===yu.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${n.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===yu.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${n.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function Mhe(n){return Cr(n,t=>jm(t)?t.charCodeAt(0):t)}function KB(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}const b2=256;let bP=[];function N1(n){return n<b2?n:bP[n]}function pVe(){if(jl(bP)){bP=new Array(65536);for(let n=0;n<65536;n++)bP[n]=n>255?255+~~(n/255):n}}function Uk(n,e){const t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function pL(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}let hee=1;const Ohe={};function Bk(n){const e=mVe(n);gVe(e),vVe(e),_Ve(e),Ai(e,t=>{t.isParent=t.categoryMatches.length>0})}function mVe(n){let e=Td(n),t=n,r=!0;for(;r;){t=Dk(Pm(Cr(t,s=>s.CATEGORIES)));const i=wU(t,e);e=e.concat(i),jl(i)?r=!1:t=i}return e}function gVe(n){Ai(n,e=>{Ihe(e)||(Ohe[hee]=e,e.tokenTypeIdx=hee++),dee(e)&&!ka(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),dee(e)||(e.CATEGORIES=[]),yVe(e)||(e.categoryMatches=[]),bVe(e)||(e.categoryMatchesMap={})})}function _Ve(n){Ai(n,e=>{e.categoryMatches=[],Ai(e.categoryMatchesMap,(t,r)=>{e.categoryMatches.push(Ohe[r].tokenTypeIdx)})})}function vVe(n){Ai(n,e=>{khe([],e)})}function khe(n,e){Ai(n,t=>{e.categoryMatchesMap[t.tokenTypeIdx]=!0}),Ai(e.CATEGORIES,t=>{const r=n.concat(e);Vp(r,t)||khe(r,t)})}function Ihe(n){return pi(n,"tokenTypeIdx")}function dee(n){return pi(n,"CATEGORIES")}function yVe(n){return pi(n,"categoryMatches")}function bVe(n){return pi(n,"categoryMatchesMap")}function SVe(n){return pi(n,"tokenTypeIdx")}const EVe={buildUnableToPopLexerModeMessage(n){return`Unable to pop Lexer Mode after encountering Token ->${n.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(n,e,t,r,i){return`unexpected character: ->${n.charAt(e)}<- at offset: ${e}, skipped ${t} characters.`}};var yu;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",n[n.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(yu||(yu={}));const S2={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:EVe,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(S2);let Nh=class{constructor(e,t=S2){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:l}=Ehe(s),c=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,l}else return s()},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=zm({},S2,t);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===S2.lineTerminatorsPattern)this.config.lineTerminatorsPattern=hVe;else if(this.config.lineTerminatorCharacters===S2.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),ka(e)?i={modes:{defaultMode:Td(e)},defaultMode:y2}:(s=!1,i=Td(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(lVe(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(cVe(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},Ai(i.modes,(o,l)=>{i.modes[l]=RU(o,c=>db(c))});const a=$0(i.modes);if(Ai(i.modes,(o,l)=>{this.TRACE_INIT(`Mode: <${l}> processing`,()=>{if(this.modes.push(l),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat($qe(o,a))}),jl(this.lexerDefinitionErrors)){Bk(o);let c;this.TRACE_INIT("analyzeTokenTypes",()=>{c=Gqe(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[l]=c.patternIdxToConfig,this.charCodeToPatternIdxToConfig[l]=c.charCodeToPatternIdxToConfig,this.emptyGroups=zm({},this.emptyGroups,c.emptyGroups),this.hasCustom=c.hasCustom||this.hasCustom,this.canModeBeOptimized[l]=c.canBeOptimized}})}),this.defaultMode=i.defaultMode,!jl(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const l=Cr(this.lexerDefinitionErrors,c=>c.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}Ai(this.lexerDefinitionWarning,o=>{She(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(Rhe?(this.chopInput=mw,this.match=this.matchWithTest):(this.updateLastIndex=qf,this.match=this.matchWithExec),s&&(this.handleModes=qf),this.trackStartLines===!1&&(this.computeNewColumn=mw),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=qf),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=Hm(this.canModeBeOptimized,(l,c,u)=>(c===!1&&l.push(u),l),[]);if(t.ensureOptimizations&&!jl(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{jqe()}),this.TRACE_INIT("toFastProperties",()=>{xhe(this)})})}tokenize(e,t=this.defaultMode){if(!jl(this.lexerDefinitionErrors)){const i=Cr(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let r,i,s,a,o,l,c,u,f,h,g,p,_,y,v;const x=e,E=x.length;let M=0,k=0;const N=this.hasCustom?0:Math.floor(e.length/10),I=new Array(N),D=[];let V=this.trackStartLines?1:void 0,G=this.trackStartLines?1:void 0;const J=uVe(this.emptyGroups),B=this.trackStartLines,$=this.config.lineTerminatorsPattern;let U=0,Q=[],W=[];const q=[],Y=[];Object.freeze(Y);let ae;function Z(){return Q}function K(Me){const qe=N1(Me),Ne=W[qe];return Ne===void 0?Y:Ne}const ne=Me=>{if(q.length===1&&Me.tokenType.PUSH_MODE===void 0){const qe=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Me);D.push({offset:Me.startOffset,line:Me.startLine,column:Me.startColumn,length:Me.image.length,message:qe})}else{q.pop();const qe=_w(q);Q=this.patternIdxToConfig[qe],W=this.charCodeToPatternIdxToConfig[qe],U=Q.length;const Ne=this.canModeBeOptimized[qe]&&this.config.safeMode===!1;W&&Ne?ae=K:ae=Z}};function le(Me){q.push(Me),W=this.charCodeToPatternIdxToConfig[Me],Q=this.patternIdxToConfig[Me],U=Q.length,U=Q.length;const qe=this.canModeBeOptimized[Me]&&this.config.safeMode===!1;W&&qe?ae=K:ae=Z}le.call(this,t);let ce;const de=this.config.recoveryEnabled;for(;M<E;){l=null;const Me=x.charCodeAt(M),qe=ae(Me),Ne=qe.length;for(r=0;r<Ne;r++){ce=qe[r];const Ae=ce.pattern;c=null;const Xe=ce.short;if(Xe!==!1?Me===Xe&&(l=Ae):ce.isCustom===!0?(v=Ae.exec(x,M,I,J),v!==null?(l=v[0],v.payload!==void 0&&(c=v.payload)):l=null):(this.updateLastIndex(Ae,M),l=this.match(Ae,e,M)),l!==null){if(o=ce.longerAlt,o!==void 0){const $e=o.length;for(s=0;s<$e;s++){const at=Q[o[s]],pt=at.pattern;if(u=null,at.isCustom===!0?(v=pt.exec(x,M,I,J),v!==null?(a=v[0],v.payload!==void 0&&(u=v.payload)):a=null):(this.updateLastIndex(pt,M),a=this.match(pt,e,M)),a&&a.length>l.length){l=a,c=u,ce=at;break}}}break}}if(l!==null){if(f=l.length,h=ce.group,h!==void 0&&(g=ce.tokenTypeIdx,p=this.createTokenInstance(l,M,g,ce.tokenType,V,G,f),this.handlePayload(p,c),h===!1?k=this.addToken(I,k,p):J[h].push(p)),e=this.chopInput(e,f),M=M+f,G=this.computeNewColumn(G,f),B===!0&&ce.canLineTerminator===!0){let Ae=0,Xe,$e;$.lastIndex=0;do Xe=$.test(l),Xe===!0&&($e=$.lastIndex-1,Ae++);while(Xe===!0);Ae!==0&&(V=V+Ae,G=f-$e,this.updateTokenEndLineColumnLocation(p,h,$e,Ae,V,G,f))}this.handleModes(ce,ne,le,p)}else{const Ae=M,Xe=V,$e=G;let at=de===!1;for(;at===!1&&M<E;)for(e=this.chopInput(e,1),M++,i=0;i<U;i++){const pt=Q[i],oe=pt.pattern,Ue=pt.short;if(Ue!==!1?x.charCodeAt(M)===Ue&&(at=!0):pt.isCustom===!0?at=oe.exec(x,M,I,J)!==null:(this.updateLastIndex(oe,M),at=oe.exec(e)!==null),at===!0)break}if(_=M-Ae,G=this.computeNewColumn(G,_),y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(x,Ae,_,Xe,$e),D.push({offset:Ae,line:Xe,column:$e,length:_,message:y}),de===!1)break}}return this.hasCustom||(I.length=k),{tokens:I,groups:J,errors:D}}handleModes(e,t,r,i){if(e.pop===!0){const s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,r,i,s,a,o){let l,c;t!==void 0&&(l=r===o-1,c=l?-1:0,i===1&&l===!0||(e.endLine=s+c,e.endColumn=a-1+-c))}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,t,r,i,s,a){return{image:e,startOffset:t,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,t,r,i,s,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,t,r){return e.push(r),t}addTokenUsingMemberAccess(e,t,r){return e[t]=r,t++,t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){t!==null&&(e.payload=t)}matchWithTest(e,t,r){return e.test(t)===!0?t.substring(r,e.lastIndex):null}matchWithExec(e,t){const r=e.exec(t);return r!==null?r[0]:null}};Nh.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Nh.NA=/NOT_APPLICABLE/;function H2(n){return Nhe(n)?n.LABEL:n.name}function Nhe(n){return jm(n.LABEL)&&n.LABEL!==""}const xVe="parent",pee="categories",mee="label",gee="group",_ee="push_mode",vee="pop_mode",yee="longer_alt",bee="line_breaks",See="start_chars_hint";function Yg(n){return TVe(n)}function TVe(n){const e=n.pattern,t={};if(t.name=n.name,db(e)||(t.PATTERN=e),pi(n,xVe))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return pi(n,pee)&&(t.CATEGORIES=n[pee]),Bk([t]),pi(n,mee)&&(t.LABEL=n[mee]),pi(n,gee)&&(t.GROUP=n[gee]),pi(n,vee)&&(t.POP_MODE=n[vee]),pi(n,_ee)&&(t.PUSH_MODE=n[_ee]),pi(n,yee)&&(t.LONGER_ALT=n[yee]),pi(n,bee)&&(t.LINE_BREAKS=n[bee]),pi(n,See)&&(t.START_CHARS_HINT=n[See]),t}const DE=Yg({name:"EOF",pattern:Nh.NA});Bk([DE]);function Fk(n,e,t,r,i,s,a,o){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function wVe(n,e){return Uk(n,e)}const Phe={buildMismatchTokenMessage({expected:n,actual:e,previous:t,ruleName:r}){return`Expecting ${Nhe(n)?`--> ${H2(n)} <--`:`token of type --> ${n.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:n,ruleName:e}){return"Redundant input, expecting EOF but found: "+n.image},buildNoViableAltMessage({expectedPathsPerAlt:n,actual:e,previous:t,customUserDescription:r,ruleName:i}){const s="Expecting: ",o=`
but found: '`+O_(e).image+"'";if(r)return s+r+o;{const l=Hm(n,(h,g)=>h.concat(g),[]),c=Cr(l,h=>`[${Cr(h,g=>H2(g)).join(", ")}]`),f=`one of these possible Token sequences:
${Cr(c,(h,g)=>`  ${g+1}. ${h}`).join(`
`)}`;return s+f+o}},buildEarlyExitMessage({expectedIterationPaths:n,actual:e,customUserDescription:t,ruleName:r}){const i="Expecting: ",a=`
but found: '`+O_(e).image+"'";if(t)return i+t+a;{const l=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Cr(n,c=>`[${Cr(c,u=>H2(u)).join(",")}]`).join(" ,")}>`;return i+l+a}}};Object.freeze(Phe);const RVe={buildRuleNotFoundError(n,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-"}},iE={buildDuplicateFoundError(n,e){function t(u){return u instanceof Vc?u.terminalType.name:u instanceof qm?u.nonTerminalName:""}const r=n.name,i=O_(e),s=i.idx,a=gv(i),o=t(i),l=s>0;let c=`->${a}${l?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError(n){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${n.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(n){const e=Cr(n.prefixPath,i=>H2(i)).join(", "),t=n.alternation.idx===0?"":n.alternation.idx;return`Ambiguous alternatives: <${n.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${t}> inside <${n.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(n){const e=Cr(n.prefixPath,i=>H2(i)).join(", "),t=n.alternation.idx===0?"":n.alternation.idx;let r=`Ambiguous Alternatives Detected: <${n.ambiguityIndices.join(" ,")}> in <OR${t}> inside <${n.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(n){let e=gv(n.repetition);return n.repetition.idx!==0&&(e+=n.repetition.idx),`The repetition <${e}> within Rule <${n.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(n){return"deprecated"},buildEmptyAlternationError(n){return`Ambiguous empty alternative: <${n.emptyChoiceIdx+1}> in <OR${n.alternation.idx}> inside <${n.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(n){return`An Alternation cannot have more than 256 alternatives:
<OR${n.alternation.idx}> inside <${n.topLevelRule.name}> Rule.
 has ${n.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(n){const e=n.topLevelRule.name,t=Cr(n.leftRecursionPath,s=>s.name),r=`${e} --> ${t.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(n){return"deprecated"},buildDuplicateRuleNameError(n){let e;return n.topLevelRule instanceof nR?e=n.topLevelRule.name:e=n.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${n.grammarName}<-`}};function AVe(n,e){const t=new CVe(n,e);return t.resolveRefs(),t.errors}class CVe extends lx{constructor(e,t){super(),this.nameToTopRule=e,this.errMsgProvider=t,this.errors=[]}resolveRefs(){Ai(vf(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:jp.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class MVe extends CU{constructor(e,t){super(),this.topProd=e,this.path=t,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Td(this.path.ruleStack).reverse(),this.occurrenceStack=Td(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,t=[]){this.found||super.walk(e,t)}walkProdRef(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){jl(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class OVe extends MVe{constructor(e,t){super(e,t),this.path=t,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=t.concat(r),s=new Vm({definition:i});this.possibleTokTypes=Lk(s),this.found=!0}}}class OU extends CU{constructor(e,t){super(),this.topRule=e,this.occurrence=t,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class kVe extends OU{walkMany(e,t,r){if(e.idx===this.occurrence){const i=O_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Vc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,t,r)}}class Eee extends OU{walkManySep(e,t,r){if(e.idx===this.occurrence){const i=O_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Vc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,t,r)}}class IVe extends OU{walkAtLeastOne(e,t,r){if(e.idx===this.occurrence){const i=O_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Vc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,t,r)}}class xee extends OU{walkAtLeastOneSep(e,t,r){if(e.idx===this.occurrence){const i=O_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Vc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,t,r)}}function N9(n,e,t=[]){t=Td(t);let r=[],i=0;function s(o){return o.concat(yd(n,i+1))}function a(o){const l=N9(s(o),e,t);return r.concat(l)}for(;t.length<e&&i<n.length;){const o=n[i];if(o instanceof Vm)return a(o.definition);if(o instanceof qm)return a(o.definition);if(o instanceof Dm)r=a(o.definition);else if(o instanceof ry){const l=o.definition.concat([new Wf({definition:o.definition})]);return a(l)}else if(o instanceof iy){const l=[new Vm({definition:o.definition}),new Wf({definition:[new Vc({terminalType:o.separator})].concat(o.definition)})];return a(l)}else if(o instanceof j_){const l=o.definition.concat([new Wf({definition:[new Vc({terminalType:o.separator})].concat(o.definition)})]);r=a(l)}else if(o instanceof Wf){const l=o.definition.concat([new Wf({definition:o.definition})]);r=a(l)}else{if(o instanceof H_)return Ai(o.definition,l=>{jl(l.definition)===!1&&(r=a(l.definition))}),r;if(o instanceof Vc)t.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:yd(n,i)}),r}function Dhe(n,e,t,r){const i="EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const l=e.length,c=l-r-1,u=[],f=[];for(f.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!jl(f);){const h=f.pop();if(h===a){o&&_w(f).idx<=c&&f.pop();continue}const g=h.def,p=h.idx,_=h.ruleStack,y=h.occurrenceStack;if(jl(g))continue;const v=g[0];if(v===i){const x={idx:p,def:yd(g),ruleStack:CO(_),occurrenceStack:CO(y)};f.push(x)}else if(v instanceof Vc)if(p<l-1){const x=p+1,E=e[x];if(t(E,v.terminalType)){const M={idx:x,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(M)}}else if(p===l-1)u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:_,occurrenceStack:y}),o=!0;else throw Error("non exhaustive match");else if(v instanceof qm){const x=Td(_);x.push(v.nonTerminalName);const E=Td(y);E.push(v.idx);const M={idx:p,def:v.definition.concat(s,yd(g)),ruleStack:x,occurrenceStack:E};f.push(M)}else if(v instanceof Dm){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E={idx:p,def:v.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y};f.push(E)}else if(v instanceof ry){const x=new Wf({definition:v.definition,idx:v.idx}),E=v.definition.concat([x],yd(g)),M={idx:p,def:E,ruleStack:_,occurrenceStack:y};f.push(M)}else if(v instanceof iy){const x=new Vc({terminalType:v.separator}),E=new Wf({definition:[x].concat(v.definition),idx:v.idx}),M=v.definition.concat([E],yd(g)),k={idx:p,def:M,ruleStack:_,occurrenceStack:y};f.push(k)}else if(v instanceof j_){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E=new Vc({terminalType:v.separator}),M=new Wf({definition:[E].concat(v.definition),idx:v.idx}),k=v.definition.concat([M],yd(g)),N={idx:p,def:k,ruleStack:_,occurrenceStack:y};f.push(N)}else if(v instanceof Wf){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E=new Wf({definition:v.definition,idx:v.idx}),M=v.definition.concat([E],yd(g)),k={idx:p,def:M,ruleStack:_,occurrenceStack:y};f.push(k)}else if(v instanceof H_)for(let x=v.definition.length-1;x>=0;x--){const E=v.definition[x],M={idx:p,def:E.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y};f.push(M),f.push(a)}else if(v instanceof Vm)f.push({idx:p,def:v.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y});else if(v instanceof nR)f.push(NVe(v,p,_,y));else throw Error("non exhaustive match")}return u}function NVe(n,e,t,r){const i=Td(t);i.push(n.name);const s=Td(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var _u;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(_u||(_u={}));function Lhe(n){if(n instanceof Dm||n==="Option")return _u.OPTION;if(n instanceof Wf||n==="Repetition")return _u.REPETITION;if(n instanceof ry||n==="RepetitionMandatory")return _u.REPETITION_MANDATORY;if(n instanceof iy||n==="RepetitionMandatoryWithSeparator")return _u.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof j_||n==="RepetitionWithSeparator")return _u.REPETITION_WITH_SEPARATOR;if(n instanceof H_||n==="Alternation")return _u.ALTERNATION;throw Error("non exhaustive match")}function PVe(n,e,t,r,i,s){const a=iq(n,e,t),o=Fhe(a)?pL:Uk;return s(a,r,o,i)}function DVe(n,e,t,r,i,s){const a=sq(n,e,i,t),o=Fhe(a)?pL:Uk;return s(a[0],o,r)}function LVe(n,e,t,r){const i=n.length,s=A_(n,a=>A_(a,o=>o.length===1));if(e)return function(a){const o=Cr(a,l=>l.GATE);for(let l=0;l<i;l++){const c=n[l],u=c.length,f=o[l];if(!(f!==void 0&&f.call(this)===!1))e:for(let h=0;h<u;h++){const g=c[h],p=g.length;for(let _=0;_<p;_++){const y=this.LA(_+1);if(t(y,g[_])===!1)continue e}return l}}};if(s&&!r){const a=Cr(n,l=>Pm(l)),o=Hm(a,(l,c,u)=>(Ai(c,f=>{pi(l,f.tokenTypeIdx)||(l[f.tokenTypeIdx]=u),Ai(f.categoryMatches,h=>{pi(l,h)||(l[h]=u)})}),l),{});return function(){const l=this.LA(1);return o[l.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=n[a],l=o.length;e:for(let c=0;c<l;c++){const u=o[c],f=u.length;for(let h=0;h<f;h++){const g=this.LA(h+1);if(t(g,u[h])===!1)continue e}return a}}}}function UVe(n,e,t){const r=A_(n,s=>s.length===1),i=n.length;if(r&&!t){const s=Pm(n);if(s.length===1&&jl(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=Hm(s,(o,l,c)=>(o[l.tokenTypeIdx]=!0,Ai(l.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=n[s],o=a.length;for(let l=0;l<o;l++){const c=this.LA(l+1);if(e(c,a[l])===!1)continue e}return!0}return!1}}class BVe extends CU{constructor(e,t,r){super(),this.topProd=e,this.targetOccurrence=t,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,t,r,i){return e.idx===this.targetOccurrence&&this.targetProdType===t?(this.restDef=r.concat(i),!0):!1}walkOption(e,t,r){this.checkIsTarget(e,_u.OPTION,t,r)||super.walkOption(e,t,r)}walkAtLeastOne(e,t,r){this.checkIsTarget(e,_u.REPETITION_MANDATORY,t,r)||super.walkOption(e,t,r)}walkAtLeastOneSep(e,t,r){this.checkIsTarget(e,_u.REPETITION_MANDATORY_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}walkMany(e,t,r){this.checkIsTarget(e,_u.REPETITION,t,r)||super.walkOption(e,t,r)}walkManySep(e,t,r){this.checkIsTarget(e,_u.REPETITION_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}}class Uhe extends lx{constructor(e,t,r){super(),this.targetOccurrence=e,this.targetProdType=t,this.targetRef=r,this.result=[]}checkIsTarget(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,_u.OPTION)}visitRepetition(e){this.checkIsTarget(e,_u.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,_u.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,_u.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,_u.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,_u.ALTERNATION)}}function Tee(n){const e=new Array(n);for(let t=0;t<n;t++)e[t]=[];return e}function ZB(n){let e=[""];for(let t=0;t<n.length;t++){const r=n[t],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const l="_"+r.categoryMatches[o];i.push(a+l)}}e=i}return e}function FVe(n,e,t){for(let r=0;r<n.length;r++){if(r===t)continue;const i=n[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function Bhe(n,e){const t=Cr(n,a=>N9([a],1)),r=Tee(t.length),i=Cr(t,a=>{const o={};return Ai(a,l=>{const c=ZB(l.partialPath);Ai(c,u=>{o[u]=!0})}),o});let s=t;for(let a=1;a<=e;a++){const o=s;s=Tee(o.length);for(let l=0;l<o.length;l++){const c=o[l];for(let u=0;u<c.length;u++){const f=c[u].partialPath,h=c[u].suffixDef,g=ZB(f);if(FVe(i,g,l)||jl(h)||f.length===e){const _=r[l];if(P9(_,f)===!1){_.push(f);for(let y=0;y<g.length;y++){const v=g[y];i[l][v]=!0}}}else{const _=N9(h,a+1,f);s[l]=s[l].concat(_),Ai(_,y=>{const v=ZB(y.partialPath);Ai(v,x=>{i[l][x]=!0})})}}}}return r}function iq(n,e,t,r){const i=new Uhe(n,_u.ALTERNATION,r);return e.accept(i),Bhe(i.result,t)}function sq(n,e,t,r){const i=new Uhe(n,t);e.accept(i);const s=i.result,o=new BVe(e,n,t).startWalking(),l=new Vm({definition:s}),c=new Vm({definition:o});return Bhe([l,c],r)}function P9(n,e){e:for(let t=0;t<n.length;t++){const r=n[t];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function zVe(n,e){return n.length<e.length&&A_(n,(t,r)=>{const i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function Fhe(n){return A_(n,e=>A_(e,t=>A_(t,r=>jl(r.categoryMatches))))}function jVe(n){const e=n.lookaheadStrategy.validate({rules:n.rules,tokenTypes:n.tokenTypes,grammarName:n.grammarName});return Cr(e,t=>Object.assign({type:jp.CUSTOM_LOOKAHEAD_VALIDATION},t))}function HVe(n,e,t,r){const i=B0(n,l=>qVe(l,t)),s=tGe(n,e,t),a=B0(n,l=>ZVe(l,t)),o=B0(n,l=>$Ve(l,n,r,t));return i.concat(s,a,o)}function qVe(n,e){const t=new GVe;n.accept(t);const r=t.allProductions,i=bhe(r,VVe),s=z_(i,o=>o.length>1);return Cr(vf(s),o=>{const l=O_(o),c=e.buildDuplicateFoundError(n,o),u=gv(l),f={message:c,type:jp.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:u,occurrence:l.idx},h=zhe(l);return h&&(f.parameter=h),f})}function VVe(n){return`${gv(n)}_#_${n.idx}_#_${zhe(n)}`}function zhe(n){return n instanceof Vc?n.terminalType.name:n instanceof qm?n.nonTerminalName:""}class GVe extends lx{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function $Ve(n,e,t,r){const i=[];if(Hm(e,(a,o)=>o.name===n.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:a,type:jp.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function WVe(n,e,t){const r=[];let i;return Vp(e,n)||(i=`Invalid rule override, rule: ->${n}<- cannot be overridden in the grammar: ->${t}<-as it is not defined in any of the super grammars `,r.push({message:i,type:jp.INVALID_RULE_OVERRIDE,ruleName:n})),r}function jhe(n,e,t,r=[]){const i=[],s=SP(e.definition);if(jl(s))return[];{const a=n.name;Vp(s,n)&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:jp.LEFT_RECURSION,ruleName:a});const l=wU(s,r.concat([n])),c=B0(l,u=>{const f=Td(r);return f.push(u),jhe(n,u,t,f)});return i.concat(c)}}function SP(n){let e=[];if(jl(n))return e;const t=O_(n);if(t instanceof qm)e.push(t.referencedRule);else if(t instanceof Vm||t instanceof Dm||t instanceof ry||t instanceof iy||t instanceof j_||t instanceof Wf)e=e.concat(SP(t.definition));else if(t instanceof H_)e=Pm(Cr(t.definition,s=>SP(s.definition)));else if(!(t instanceof Vc))throw Error("non exhaustive match");const r=uL(t),i=n.length>1;if(r&&i){const s=yd(n);return e.concat(SP(s))}else return e}class aq extends lx{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function YVe(n,e){const t=new aq;n.accept(t);const r=t.alternations;return B0(r,s=>{const a=CO(s.definition);return B0(a,(o,l)=>{const c=Dhe([o],[],Uk,1);return jl(c)?[{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:s,emptyChoiceIdx:l}),type:jp.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:s.idx,alternative:l+1}]:[]})})}function XVe(n,e,t){const r=new aq;n.accept(r);let i=r.alternations;return i=RU(i,a=>a.ignoreAmbiguities===!0),B0(i,a=>{const o=a.idx,l=a.maxLookahead||e,c=iq(o,n,l,a),u=QVe(c,a,n,t),f=eGe(c,a,n,t);return u.concat(f)})}class KVe extends lx{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function ZVe(n,e){const t=new aq;n.accept(t);const r=t.alternations;return B0(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:s}),type:jp.TOO_MANY_ALTS,ruleName:n.name,occurrence:s.idx}]:[])}function JVe(n,e,t){const r=[];return Ai(n,i=>{const s=new KVe;i.accept(s);const a=s.allProductions;Ai(a,o=>{const l=Lhe(o),c=o.maxLookahead||e,u=o.idx,h=sq(u,i,l,c)[0];if(jl(Pm(h))){const g=t.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:g,type:jp.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function QVe(n,e,t,r){const i=[],s=Hm(n,(o,l,c)=>(e.definition[c].ignoreAmbiguities===!0||Ai(l,u=>{const f=[c];Ai(n,(h,g)=>{c!==g&&P9(h,u)&&e.definition[g].ignoreAmbiguities!==!0&&f.push(g)}),f.length>1&&!P9(i,u)&&(i.push(u),o.push({alts:f,path:u}))}),o),[]);return Cr(s,o=>{const l=Cr(o.alts,u=>u+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:o.path}),type:jp.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:o.alts}})}function eGe(n,e,t,r){const i=Hm(n,(a,o,l)=>{const c=Cr(o,u=>({idx:l,path:u}));return a.concat(c)},[]);return Dk(B0(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const l=a.idx,c=a.path,u=K0(i,h=>e.definition[h.idx].ignoreAmbiguities!==!0&&h.idx<l&&zVe(h.path,c));return Cr(u,h=>{const g=[h.idx+1,l+1],p=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:g,prefixPath:h.path}),type:jp.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:p,alternatives:g}})}))}function tGe(n,e,t){const r=[],i=Cr(e,s=>s.name);return Ai(n,s=>{const a=s.name;if(Vp(i,a)){const o=t.buildNamespaceConflictError(s);r.push({message:o,type:jp.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function nGe(n){const e=eq(n,{errMsgProvider:RVe}),t={};return Ai(n.rules,r=>{t[r.name]=r}),AVe(t,e.errMsgProvider)}function rGe(n){return n=eq(n,{errMsgProvider:iE}),HVe(n.rules,n.tokenTypes,n.errMsgProvider,n.grammarName)}const Hhe="MismatchedTokenException",qhe="NoViableAltException",Vhe="EarlyExitException",Ghe="NotAllInputParsedException",$he=[Hhe,qhe,Vhe,Ghe];Object.freeze($he);function mL(n){return Vp($he,n.name)}class kU extends Error{constructor(e,t){super(e),this.token=t,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Whe extends kU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=Hhe}}class iGe extends kU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=qhe}}class sGe extends kU{constructor(e,t){super(e,t),this.name=Ghe}}class aGe extends kU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=Vhe}}const JB={},Yhe="InRuleRecoveryException";class oGe extends Error{constructor(e){super(e),this.name=Yhe}}class lGe{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=pi(e,"recoveryEnabled")?e.recoveryEnabled:pb.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=cGe)}getTokenToInsert(e){const t=Fk(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,t,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let l=!1;const c=this.LA(1);let u=this.LA(1);const f=()=>{const h=this.LA(0),g=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:h,ruleName:this.getCurrRuleFullName()}),p=new Whe(g,c,this.LA(0));p.resyncedTokens=CO(o),this.SAVE_ERROR(p)};for(;!l;)if(this.tokenMatcher(u,i)){f();return}else if(r.call(this)){f(),e.apply(this,t);return}else this.tokenMatcher(u,s)?l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,t,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))}getFollowsForInRuleRecovery(e,t){const r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new oGe("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e)||jl(t))return!1;const r=this.LA(1);return vw(t,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Vp(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let t=this.LA(1),r=2;for(;;){const i=vw(e,s=>wVe(t,s));if(i!==void 0)return i;t=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return JB;const e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,t=this.RULE_OCCURRENCE_STACK;return Cr(e,(r,i)=>i===0?JB:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:t[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=Cr(this.buildFullFollowKeyStack(),t=>this.getFollowSetFromFollowKey(t));return Pm(e)}getFollowSetFromFollowKey(e){if(e===JB)return[DE];const t=e.ruleName+e.idxInCallingRule+The+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){return this.tokenMatcher(e,DE)||t.push(e),t}reSyncTo(e){const t=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return CO(t)}attemptInRepetitionRecovery(e,t,r,i,s,a,o){}getCurrentGrammarPath(e,t){const r=this.getHumanReadableRuleStack(),i=Td(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t}}getHumanReadableRuleStack(){return Cr(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function cGe(n,e,t,r,i,s,a){const o=this.getKeyForAutomaticLookahead(r,i);let l=this.firstAfterRepMap[o];if(l===void 0){const h=this.getCurrRuleFullName(),g=this.getGAstProductions()[h];l=new s(g,i).startWalking(),this.firstAfterRepMap[o]=l}let c=l.token,u=l.occurrence;const f=l.isEndOfRule;this.RULE_STACK.length===1&&f&&c===void 0&&(c=DE,u=1),!(c===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(c,u,a)&&this.tryInRepetitionRecovery(n,e,t,c)}const uGe=4,J1=8,Xhe=1<<J1,Khe=2<<J1,D9=3<<J1,L9=4<<J1,U9=5<<J1,EP=6<<J1;function QB(n,e,t){return t|e|n}class fGe{constructor(e){var t;this.maxLookahead=(t=e?.maxLookahead)!==null&&t!==void 0?t:pb.maxLookahead}validate(e){const t=this.validateNoLeftRecursion(e.rules);if(jl(t)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...t,...r,...i,...s]}return t}validateNoLeftRecursion(e){return B0(e,t=>jhe(t,t,iE))}validateEmptyOrAlternatives(e){return B0(e,t=>YVe(t,iE))}validateAmbiguousAlternationAlternatives(e,t){return B0(e,r=>XVe(r,t,iE))}validateSomeNonEmptyLookaheadPath(e,t){return JVe(e,t,iE)}buildLookaheadForAlternation(e){return PVe(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,LVe)}buildLookaheadForOptional(e){return DVe(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,Lhe(e.prodType),UVe)}}class hGe{initLooksAhead(e){this.dynamicTokensEnabled=pi(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:pb.dynamicTokensEnabled,this.maxLookahead=pi(e,"maxLookahead")?e.maxLookahead:pb.maxLookahead,this.lookaheadStrategy=pi(e,"lookaheadStrategy")?e.lookaheadStrategy:new fGe({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Ai(e,t=>{this.TRACE_INIT(`${t.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:l}=pGe(t);Ai(r,c=>{const u=c.idx===0?"":c.idx;this.TRACE_INIT(`${gv(c)}${u}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:c.idx,rule:t,maxLookahead:c.maxLookahead||this.maxLookahead,hasPredicates:c.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),h=QB(this.fullRuleNameToShort[t.name],Xhe,c.idx);this.setLaFuncCache(h,f)})}),Ai(i,c=>{this.computeLookaheadFunc(t,c.idx,D9,"Repetition",c.maxLookahead,gv(c))}),Ai(s,c=>{this.computeLookaheadFunc(t,c.idx,Khe,"Option",c.maxLookahead,gv(c))}),Ai(a,c=>{this.computeLookaheadFunc(t,c.idx,L9,"RepetitionMandatory",c.maxLookahead,gv(c))}),Ai(o,c=>{this.computeLookaheadFunc(t,c.idx,EP,"RepetitionMandatoryWithSeparator",c.maxLookahead,gv(c))}),Ai(l,c=>{this.computeLookaheadFunc(t,c.idx,U9,"RepetitionWithSeparator",c.maxLookahead,gv(c))})})})}computeLookaheadFunc(e,t,r,i,s,a){this.TRACE_INIT(`${a}${t===0?"":t}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),l=QB(this.fullRuleNameToShort[e.name],r,t);this.setLaFuncCache(l,o)})}getKeyForAutomaticLookahead(e,t){const r=this.getLastExplicitRuleShortName();return QB(r,e,t)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}}class dGe extends lx{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const hN=new dGe;function pGe(n){hN.reset(),n.accept(hN);const e=hN.dslMethods;return hN.reset(),e}function wee(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function Ree(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function mGe(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function gGe(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}const _Ge="name";function Zhe(n,e){Object.defineProperty(n,_Ge,{enumerable:!1,configurable:!0,writable:!1,value:e})}function vGe(n,e){const t=$0(n),r=t.length;for(let i=0;i<r;i++){const s=t[i],a=n[s],o=a.length;for(let l=0;l<o;l++){const c=a[l];c.tokenTypeIdx===void 0&&this[c.name](c.children,e)}}}function yGe(n,e){const t=function(){};Zhe(t,n+"BaseSemantics");const r={visit:function(i,s){if(ka(i)&&(i=i[0]),!db(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=SGe(this,e);if(!jl(i)){const s=Cr(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function bGe(n,e,t){const r=function(){};Zhe(r,n+"BaseSemanticsWithDefaults");const i=Object.create(t.prototype);return Ai(e,s=>{i[s]=vGe}),r.prototype=i,r.prototype.constructor=r,r}var B9;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(B9||(B9={}));function SGe(n,e){return EGe(n,e)}function EGe(n,e){const t=K0(e,i=>Sb(n[i])===!1),r=Cr(t,i=>({msg:`Missing visitor method: <${i}> on ${n.constructor.name} CST Visitor.`,type:B9.MISSING_METHOD,methodName:i}));return Dk(r)}class xGe{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=pi(e,"nodeLocationTracking")?e.nodeLocationTracking:pb.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=qf,this.cstFinallyStateUpdate=qf,this.cstPostTerminal=qf,this.cstPostNonTerminal=qf,this.cstPostRule=qf;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ree,this.setNodeLocationFromNode=Ree,this.cstPostRule=qf,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=wee,this.setNodeLocationFromNode=wee,this.cstPostRule=qf,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=qf,this.setInitialNodeLocation=qf;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t),this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN}cstPostTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];mGe(r,t,e),this.setNodeLocationFromToken(r.location,t)}cstPostNonTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];gGe(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(db(this.baseCstVisitorConstructor)){const e=yGe(this.className,$0(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(db(this.baseCstVisitorWithDefaultsConstructor)){const e=bGe(this.className,$0(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class TGe{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):_L}LA(e){const t=this.currIdx+e;return t<0||this.tokVectorLength<=t?_L:this.tokVector[t]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class wGe{ACTION(e){return e.call(this)}consume(e,t,r){return this.consumeInternal(t,e,r)}subrule(e,t,r){return this.subruleInternal(t,e,r)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,r=vL){if(Vp(this.definedRulesNames,e)){const a={message:iE.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:jp.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,t,r);return this[e]=i,i}OVERRIDE_RULE(e,t,r=vL){const i=WVe(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,t,r);return this[e]=s,s}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(mL(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return Aqe(vf(this.gastProductionsCache))}}class RGe{initRecognizerEngine(e,t){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=pL,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},pi(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(ka(e)){if(jl(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(ka(e))this.tokensMap=Hm(e,(s,a)=>(s[a.name]=a,s),{});else if(pi(e,"modes")&&A_(Pm(vf(e.modes)),SVe)){const s=Pm(vf(e.modes)),a=AU(s);this.tokensMap=Hm(a,(o,l)=>(o[l.name]=l,o),{})}else if(G0(e))this.tokensMap=Td(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=DE;const r=pi(e,"modes")?Pm(vf(e.modes)):vf(e),i=A_(r,s=>jl(s.categoryMatches));this.tokenMatcher=i?pL:Uk,Bk(vf(this.tokensMap))}defineRule(e,t,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=pi(r,"resyncEnabled")?r.resyncEnabled:vL.resyncEnabled,s=pi(r,"recoveryValueFunc")?r.recoveryValueFunc:vL.recoveryValueFunc,a=this.ruleShortNameIdx<<uGe+J1;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),t.apply(this,u);const f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),t.apply(this,u)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:t})}invokeRuleCatch(e,t,r){const i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(mL(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r(e);else{if(this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,t){const r=this.getKeyForAutomaticLookahead(Khe,t);return this.optionInternalLogic(e,t,r)}optionInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,t){const r=this.getKeyForAutomaticLookahead(L9,e);return this.atLeastOneInternalLogic(e,t,r)}atLeastOneInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const a=t.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=t;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,_u.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,L9,e,IVe)}atLeastOneSepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead(EP,e);this.atLeastOneSepFirstInternalLogic(e,t,r)}atLeastOneSepFirstInternalLogic(e,t,r){const i=t.DEF,s=t.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,xee],o,EP,e,xee)}else throw this.raiseEarlyExitException(e,_u.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)}manyInternal(e,t){const r=this.getKeyForAutomaticLookahead(D9,e);return this.manyInternalLogic(e,t,r)}manyInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const o=t.GATE;if(o!==void 0){const l=i;i=()=>o.call(this)&&l.call(this)}}else s=t;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,D9,e,kVe,a)}manySepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead(U9,e);this.manySepFirstInternalLogic(e,t,r)}manySepFirstInternalLogic(e,t,r){const i=t.DEF,s=t.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,Eee],o,U9,e,Eee)}}repetitionSepSecondInternal(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,EP,e,s)}doSingleRepetition(e){const t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t}orInternal(e,t){const r=this.getKeyForAutomaticLookahead(Xhe,t),i=ka(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new sGe(t,e))}}subruleInternal(e,t,r){let i;try{const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=t,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,t,r){throw mL(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,t,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,t,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,t,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Whe(i,t,s))}consumeInternalRecovery(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===Yhe?r:s}}else throw r}saveRecogState(){const e=this.errors,t=Td(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),DE)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class AGe{initErrorHandler(e){this._errors=[],this.errorMessageProvider=pi(e,"errorMessageProvider")?e.errorMessageProvider:pb.errorMessageProvider}SAVE_ERROR(e){if(mL(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Td(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Td(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=sq(e,s,t,this.maxLookahead)[0],l=[];for(let u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));const c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new aGe(c,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=iq(e,i,this.maxLookahead),a=[];for(let c=1;c<=this.maxLookahead;c++)a.push(this.LA(c));const o=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new iGe(l,this.LA(1),o))}}class CGe{initContentAssist(){}computeContentAssist(e,t){const r=this.gastProductionsCache[e];if(db(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return Dhe([r],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const t=O_(e.ruleStack),i=this.getGAstProductions()[t];return new OVe(i,e).startWalking()}}const IU={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(IU);const Aee=!0,Cee=Math.pow(2,J1)-1,Jhe=Yg({name:"RECORDING_PHASE_TOKEN",pattern:Nh.NA});Bk([Jhe]);const Qhe=Fk(Jhe,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Qhe);const MGe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class OGe{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const t=e>0?e:"";this[`CONSUME${t}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${t}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${t}`]=function(r){return this.optionInternalRecord(r,e)},this[`OR${t}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${t}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${t}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${t}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${t}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},this.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},this.option=function(e,t){return this.optionInternalRecord(t,e)},this.or=function(e,t){return this.orInternalRecord(t,e)},this.many=function(e,t){this.manyInternalRecord(e,t)},this.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let t=0;t<10;t++){const r=t>0?t:"";delete e[`CONSUME${r}`],delete e[`SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>!0}LA_RECORD(e){return _L}topLevelRuleRecord(e,t){try{const r=new nR({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,t){return FM.call(this,Dm,e,t)}atLeastOneInternalRecord(e,t){FM.call(this,ry,t,e)}atLeastOneSepFirstInternalRecord(e,t){FM.call(this,iy,t,e,Aee)}manyInternalRecord(e,t){FM.call(this,Wf,t,e)}manySepFirstInternalRecord(e,t){FM.call(this,j_,t,e,Aee)}orInternalRecord(e,t){return kGe.call(this,e,t)}subruleInternalRecord(e,t,r){if(gL(t),!e||pi(e,"ruleName")===!1){const o=new Error(`<SUBRULE${Mee(t)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=_w(this.recordingProdStack),s=e.ruleName,a=new qm({idx:t,nonTerminalName:s,label:r?.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?MGe:IU}consumeInternalRecord(e,t,r){if(gL(t),!Ihe(e)){const a=new Error(`<CONSUME${Mee(t)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=_w(this.recordingProdStack),s=new Vc({idx:t,terminalType:e,label:r?.LABEL});return i.definition.push(s),Qhe}}function FM(n,e,t,r=!1){gL(t);const i=_w(this.recordingProdStack),s=Sb(e)?e:e.DEF,a=new n({definition:[],idx:t});return r&&(a.separator=e.SEP),pi(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.pop(),IU}function kGe(n,e){gL(e);const t=_w(this.recordingProdStack),r=ka(n)===!1,i=r===!1?n:n.DEF,s=new H_({definition:[],idx:e,ignoreAmbiguities:r&&n.IGNORE_AMBIGUITIES===!0});pi(n,"MAX_LOOKAHEAD")&&(s.maxLookahead=n.MAX_LOOKAHEAD);const a=tq(i,o=>Sb(o.GATE));return s.hasPredicates=a,t.definition.push(s),Ai(i,o=>{const l=new Vm({definition:[]});s.definition.push(l),pi(o,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:pi(o,"GATE")&&(l.ignoreAmbiguities=!0),this.recordingProdStack.push(l),o.ALT.call(this),this.recordingProdStack.pop()}),IU}function Mee(n){return n===0?"":`${n}`}function gL(n){if(n<0||n>Cee){const e=new Error(`Invalid DSL Method idx value: <${n}>
	Idx value must be a none negative value smaller than ${Cee+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class IGe{initPerformanceTracer(e){if(pi(e,"traceInitPerf")){const t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=pb.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${e}>`);const{time:i,value:s}=Ehe(t),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return t()}}function NGe(n,e){e.forEach(t=>{const r=t.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]})})}const _L=Fk(DE,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(_L);const pb=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Phe,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),vL=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var jp;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",n[n.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(jp||(jp={}));let oq=class ede{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const t=this.className;this.TRACE_INIT("toFastProps",()=>{xhe(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Ai(this.definedRulesNames,i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=nGe({rules:vf(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(jl(r)&&this.skipValidations===!1){const i=rGe({rules:vf(this.gastProductionsCache),tokenTypes:vf(this.tokensMap),errMsgProvider:iE,grammarName:t}),s=jVe({lookaheadStrategy:this.lookaheadStrategy,rules:vf(this.gastProductionsCache),tokenTypes:vf(this.tokensMap),grammarName:t});this.definitionErrors=this.definitionErrors.concat(i,s)}}),jl(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=Pqe(vf(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:vf(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(vf(this.gastProductionsCache))})),!ede.DEFER_DEFINITION_ERRORS_HANDLING&&!jl(this.definitionErrors))throw e=Cr(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,t){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),pi(t,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=pi(t,"skipValidations")?t.skipValidations:pb.skipValidations}};oq.DEFER_DEFINITION_ERRORS_HANDLING=!1;NGe(oq,[lGe,hGe,xGe,TGe,RGe,wGe,AGe,CGe,OGe,IGe]);class PGe extends oq{constructor(e,t=pb){const r=Td(t);r.outputCst=!0,super(e,r)}}function DGe(n){const e=new LGe,t=vf(n);return Cr(t,r=>e.visitRule(r))}class LGe extends lx{visitRule(e){const t=this.visitEach(e.definition),r=bhe(t,s=>s.propertyName),i=Cr(r,(s,a)=>{const o=!tq(s,c=>!c.canBeNull);let l=s[0].type;return s.length>1&&(l=Cr(s,c=>c.type)),{name:a,type:l,optional:o}});return{name:e.name,properties:i}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:dN(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:dN(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:dN(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:dN(e)}]}visitEachAndOverrideWith(e,t){return Cr(this.visitEach(e),r=>zm({},r,t))}visitEach(e){return Pm(Cr(e,t=>this.visit(t)))}}function dN(n){return n instanceof qm?{kind:"rule",name:n.referencedRule.name}:{kind:"token"}}function UGe(n,e){let t=[];return t=t.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),t=t.concat(Pm(Cr(n,r=>BGe(r)))),e.includeVisitorInterface&&(t=t.concat(HGe(e.visitorInterfaceName,n))),t.join(`

`)+`
`}function BGe(n){const e=FGe(n),t=zGe(n);return[e,t]}function FGe(n){const e=tde(n.name),t=lq(n.name);return`export interface ${e} extends CstNode {
  name: "${n.name}";
  children: ${t};
}`}function zGe(n){return`export type ${lq(n.name)} = {
  ${Cr(n.properties,t=>jGe(t)).join(`
  `)}
};`}function jGe(n){const e=VGe(n.type);return`${n.name}${n.optional?"?":""}: ${e}[];`}function HGe(n,e){return`export interface ${n}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${Cr(e,t=>qGe(t)).join(`
  `)}
}`}function qGe(n){const e=lq(n.name);return`${n.name}(children: ${e}, param?: IN): OUT;`}function VGe(n){if(ka(n)){const e=AU(Cr(n,r=>Oee(r)));return"("+Hm(e,(r,i)=>r+" | "+i)+")"}else return Oee(n)}function Oee(n){return n.kind==="token"?"IToken":tde(n.name)}function tde(n){return ahe(n)+"CstNode"}function lq(n){return ahe(n)+"CstChildren"}const GGe={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function $Ge(n,e){const t=Object.assign(Object.assign({},GGe),e),r=DGe(n);return UGe(r,t)}const zk=uw(32,126).map(n=>String.fromCharCode(n));function vs(n){return Yg({...n,name:`token_${n.name}`})}function un(n){return vs({name:n,pattern:new RegExp(n.toLowerCase(),"i"),longer_alt:Eu})}const MO=vs({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),nde=vs({name:"whitespace",pattern:/ +/,group:Nh.SKIPPED}),rde=vs({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:Nh.SKIPPED}),LE=vs({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),qy=vs({name:"command",pattern:/#/,start_chars_hint:["#"]});let ide=!1;const WGe="@#/?':!",YGe=/^(by|at|away|toward|find|flee|to|cw|ccw|opp|rndp)/i;function XGe(n,e){if(!ide)return null;let t=e;const r=n[t-1]??"";if(t>0&&r!==" "&&r!==`
`)return null;if(n[t]===" "){for(;n[t]===" ";)t++;if(WGe.includes(n[t]))return null}for(;t>0&&`$"@#':!/?
`.includes(n[t])===!1;)t--;switch(n[t]){case"?":case"/":{const a=n.substring(t+1,e+1).toLowerCase();if(a.indexOf(" ")<1||YGe.test(a))return null;break}case"#":return null;case'"':{for(t--;t>0&&n[t]===" ";)t--;if(!(t<1||n[t]===`
`))return null;break}case"@":case"'":case":":case"!":return null}let i=e;for(n[i]==='"'&&++i;i<n.length&&n[i]!==`
`;)i++;const s=n.substring(e,i);return s.trim().length===0||s.toLowerCase()==="do"?null:[s]}const OO=vs({name:"text",pattern:XGe,line_breaks:!1,start_chars_hint:zk}),kO=vs({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),yw=vs({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),IO=vs({name:"hyperlink",pattern:/![^;\n]*/,start_chars_hint:["!"]}),cq=vs({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),Eu=vs({name:"stringliteral",pattern:/[^-0-9"!:;@#/?()\s]+[^-"!:;@#/?()\s]*/,start_chars_hint:zk}),q2=vs({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),yL=vs({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),sde=un("isterrain"),ade=un("isobject"),ode=un("issolid"),lde=un("iswalk"),cde=un("isswim"),ude=un("isbullet"),fde=un("isghost"),hde=un("iswalking"),dde=un("iswalkable"),pde=un("isswimming"),mde=un("isswimmable"),gde=un("black"),_de=un("dkblue"),vde=un("dkgreen"),yde=un("dkcyan"),bde=un("dkred"),Sde=un("dkpurple"),Ede=un("dkyellow"),xde=un("ltgray"),Tde=un("dkgray"),wde=un("blue"),Rde=un("green"),Ade=un("cyan"),Cde=un("red"),Mde=un("purple"),Ode=un("yellow"),kde=un("white"),Ide=un("brown"),Nde=un("dkwhite"),Pde=un("ltgrey"),Dde=un("gray"),Lde=un("grey"),Ude=un("dkgrey"),Bde=un("ltblack"),Fde=un("onblack"),zde=un("ondkblue"),jde=un("ondkgreen"),Hde=un("ondkcyan"),qde=un("ondkred"),Vde=un("ondkpurple"),Gde=un("ondkyellow"),$de=un("onltgray"),Wde=un("ondkgray"),Yde=un("onblue"),Xde=un("ongreen"),Kde=un("oncyan"),Zde=un("onred"),Jde=un("onpurple"),Qde=un("onyellow"),epe=un("onwhite"),tpe=un("onbrown"),npe=un("ondkwhite"),rpe=un("onltgrey"),ipe=un("ongray"),spe=un("ongrey"),ape=un("ondkgrey"),ope=un("onltblack"),lpe=un("onclear"),cpe=un("blblack"),upe=un("bldkblue"),fpe=un("bldkgreen"),hpe=un("bldkcyan"),dpe=un("bldkred"),ppe=un("bldkpurple"),mpe=un("bldkyellow"),gpe=un("blltgray"),_pe=un("bldkgray"),vpe=un("blblue"),ype=un("blgreen"),bpe=un("blcyan"),Spe=un("blred"),Epe=un("blpurple"),xpe=un("blyellow"),Tpe=un("blwhite"),wpe=un("blbrown"),Rpe=un("bldkwhite"),Ape=un("blltgrey"),Cpe=un("blgray"),Mpe=un("blgrey"),Ope=un("bldkgrey"),kpe=un("blltblack"),Ipe=un("idle"),Npe=un("up"),Ppe=un("down"),Dpe=un("left"),Lpe=un("right"),Upe=un("by"),Bpe=un("at"),Fpe=un("flow"),zpe=un("seek"),jpe=un("rndns"),Hpe=un("rndne"),qpe=un("rnd"),Vpe=un("cw"),Gpe=un("ccw"),$pe=un("opp"),Wpe=un("rndp"),Ype=un("away"),Xpe=un("toward"),Kpe=un("find"),Zpe=un("flee"),Jpe=un("to"),Qpe=un("i"),eme=un("u"),tme=un("north"),nme=un("n"),rme=un("d"),ime=un("south"),sme=un("s"),ame=un("l"),ome=un("west"),lme=un("w"),cme=un("r"),ume=un("east"),fme=un("e"),hme=un("over"),dme=un("under"),pme=un("within"),mme=un("awayby"),gme=vs({name:"expr_aligned",pattern:/aligned|alligned/i,longer_alt:Eu}),_me=un("contact"),vme=un("blocked"),yme=un("any"),bme=un("countof"),Sme=un("abs"),Eme=un("intceil"),xme=un("intfloor"),Tme=un("intround"),wme=un("clamp"),Rme=un("min"),Ame=un("max"),Cme=un("pick"),Mme=un("pickwith"),Ome=un("random"),kme=un("randomwith"),Ime=un("run"),Nme=un("runwith"),Pme=vs({name:"stop",pattern:/\|/,start_chars_hint:["|"]}),uq=vs({name:"iseq",pattern:/=|is|eq|equal/i,longer_alt:Eu}),fq=vs({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/i,longer_alt:Eu}),hq=vs({name:"islessthan",pattern:/<|below/i,longer_alt:Eu}),dq=vs({name:"isgreaterthan",pattern:/>|above/i,longer_alt:Eu}),pq=vs({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/i,longer_alt:Eu}),mq=vs({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/i,longer_alt:Eu}),bL=vs({name:"or",pattern:/or/i,longer_alt:Eu}),SL=vs({name:"not",pattern:/not/i,longer_alt:Eu}),EL=vs({name:"and",pattern:/and/i,longer_alt:Eu}),xL=vs({name:"plus",pattern:/\+/}),TL=vs({name:"minus",pattern:/-/}),gq=vs({name:"power",pattern:/\*\*/}),_q=vs({name:"multiply",pattern:/\*/}),dE=vs({name:"divide",pattern:/\//}),vq=vs({name:"moddivide",pattern:/%/}),yq=vs({name:"floordivide",pattern:/%%/}),NO=vs({name:"query",pattern:/\?/}),bq=vs({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),Sq=vs({name:"rparen",pattern:/\)/,pop_mode:!0}),Eq=vs({name:"command_play",pattern:/(play|bgplay|bgplayon64n|bgplayon32n|bgplayon16n|bgplayon8n|bgplayon4n|bgplayon2n|bgplayon1n) .*/i,start_chars_hint:zk,longer_alt:Eu}),Dme=vs({name:"command_toast",pattern:/toast .*/i,start_chars_hint:zk,longer_alt:Eu}),Lme=vs({name:"command_ticker",pattern:/ticker .*/i,start_chars_hint:zk,longer_alt:Eu}),pE=vs({name:"if",pattern:/if|try|take|give|duplicate/i,longer_alt:Eu}),mE=vs({name:"do",pattern:new RegExp("(?<!(zap |send |restore ))(?<=\\s)do","i"),start_chars_hint:["d"],longer_alt:Eu}),wL=un("done"),gE=un("else"),xq=un("while"),Tq=un("repeat"),wq=un("waitfor"),Rq=vs({name:"foreach",pattern:/foreach|for/i,longer_alt:Eu}),Aq=un("break"),Cq=un("continue");function Ume(n,e){return[...n,Ppe,...e,yL,sde,ade,ode,dde,hde,lde,mde,pde,cde,ude,fde,gde,_de,vde,yde,bde,Sde,Ede,xde,Tde,wde,Rde,Ade,Cde,Mde,Ode,kde,Ide,Nde,Pde,Dde,Lde,Ude,Bde,Fde,zde,jde,Hde,qde,Vde,Gde,$de,Wde,Yde,Xde,Kde,Zde,Jde,Qde,epe,tpe,npe,rpe,ipe,spe,ape,ope,lpe,cpe,upe,fpe,hpe,dpe,ppe,mpe,gpe,_pe,vpe,ype,bpe,Spe,Epe,xpe,Tpe,wpe,Rpe,Ape,Cpe,Mpe,Ope,kpe,Ipe,Npe,Dpe,Lpe,Upe,Bpe,Fpe,zpe,Wpe,jpe,Hpe,qpe,Vpe,Gpe,$pe,pme,mme,Ype,Xpe,Kpe,Zpe,Jpe,tme,ime,ome,ume,hme,dme,gme,_me,vme,yme,bme,Sme,Eme,xme,Tme,wme,Rme,Ame,Mme,Cme,kme,Ome,Nme,Ime,Pme,uq,fq,pq,hq,mq,dq,bL,SL,EL,xL,TL,gq,_q,dE,yq,vq,NO,bq,Sq,Qpe,eme,nme,rme,sme,ame,lme,cme,fme,q2,Eu]}const Bme=Ume([OO,LE,Eq,Dme,Lme,qy,kO,yw,IO,cq,MO,nde],[Aq,Cq,wL,mE,gE,Rq,pE,Tq,wq,xq]),KGe=new Nh({defaultMode:"use_newlines",modes:{use_newlines:Bme,ignore_newlines:Ume([rde],[])}},{skipValidations:!Hv,ensureOptimizations:Hv,positionTracking:"full"});function Fme(n){ide=!0;const e=KGe.tokenize(n||` 
`),[t]=(ui(e.tokens)?e.tokens:[]).slice(-1);return t&&t.tokenType.name!=="Newline"&&e.tokens.push(Fk(MO,`
`,t.startOffset,t.endOffset??NaN,t.startLine??NaN,t.endLine??NaN,t.startColumn??NaN,t.endColumn??NaN)),e}function F9(n,e,t=!0){if(t){const[r,...i]=e;switch(Vr(r??"")){default:return{type:hr.OBJECT,values:e};case"loader":return{type:hr.LOADER,values:i};case"board":return{type:hr.BOARD,values:i};case"object":return{type:hr.OBJECT,values:i};case"terrain":return{type:hr.TERRAIN,values:i};case"charset":return{type:hr.CHARSET,values:i};case"palette":return{type:hr.PALETTE,values:i}}}else{const[r,i,...s]=e,a=Vr(i??""),o=[r,n,...s];switch(a){default:return{type:hr.CONST,values:e};case"rn":case"range":return{type:hr.RANGE,values:o};case"sl":case"select":return{type:hr.SELECT,values:o};case"nm":case"number":return{type:hr.NUMBER,values:o};case"tx":case"text":return{type:hr.TEXT,values:o};case"hk":case"hotkey":return{type:hr.HOTKEY,values:o};case"copyit":return{type:hr.COPYIT,values:o};case"openit":return{type:hr.OPENIT,values:o};case"zssedit":return{type:hr.ZSSEDIT,values:o};case"charedit":return{type:hr.CHAREDIT,values:o};case"coloredit":return{type:hr.COLOREDIT,values:o}}}}function s1(n){switch(n){case hr.LOADER:return"loader";case hr.BOARD:return"board";case hr.OBJECT:return"object";case hr.TERRAIN:return"terrain";case hr.CHARSET:return"charset";case hr.PALETTE:return"palette";case hr.CONST:return"const";case hr.RANGE:return"range";case hr.SELECT:return"select";case hr.NUMBER:return"number";case hr.TEXT:return"text";case hr.HOTKEY:return"hotkey";case hr.COPYIT:return"copyit";case hr.OPENIT:return"openit";case hr.VIEWIT:return"viewit";case hr.ZSSEDIT:return"zssedit";case hr.CHAREDIT:return"charedit";case hr.COLOREDIT:return"coloredit"}}function kee(){return{id:Sc()}}function Gu(n){return n?.category===RE.ISOBJECT}function PO(n,e){if(!xe(n)||!Lp(e))return;const{color:t,bg:r}=Nfe(e);xe(t)&&(n.color=t),xe(r)&&(n.bg=r)}function ZGe(n,e){return{id:Sc(),code:n,...e}}function pN(n){const e={...jk(n)};return Object.keys(e).forEach(t=>{switch(t){case"type":case"name":delete e[t];break}}),e}function zme(n){const e=Fme(n),t={};let r=!0;for(let i=0;i<e.tokens.length;++i){const s=e.tokens[i];if(s.tokenType===LE){const a=s.image.slice(1),[o,l]=a.split(";").map(h=>h.trim()),c=o.split(" "),u=F9(Vn(l)?l:"",c,r),f=u.values.join(" ");switch(r=!1,u.type){case hr.LOADER:t.type=ri.LOADER,t.name=f;break;case hr.BOARD:t.type=ri.BOARD,t.name=f;break;case hr.OBJECT:t.type=ri.OBJECT,t.name=f||"object";break;case hr.TERRAIN:t.type=ri.TERRAIN,t.name=f;break;case hr.CHARSET:t.type=ri.CHARSET,t.name=f;break;case hr.PALETTE:t.type=ri.PALETTE,t.name=f;break;case hr.CONST:{const[h,...g]=u.values;if(Vn(h)){const p=Vr(h),_=g.join(" ");if(Vn(_)){const y=parseFloat(_);t[p]=Mn(y)?y:_}else t[p]=1}break}case hr.RANGE:case hr.SELECT:case hr.NUMBER:case hr.TEXT:case hr.HOTKEY:case hr.ZSSEDIT:case hr.CHAREDIT:case hr.COLOREDIT:{const[h,...g]=u.values;if(Vn(h)){const p=Vr(h);t[p]=[s1(u.type),...g]}break}}}}return t}function jk(n){return xe(n)?(xe(n.stats?.type)||(n.stats=zme(n.code),xe(n.stats.type)||(n.stats.type=ri.OBJECT)),n.stats):{}}function jme(n){switch(n){default:case ri.ERROR:return"error";case ri.LOADER:return s1(hr.LOADER);case ri.BOARD:return s1(hr.BOARD);case ri.OBJECT:return s1(hr.OBJECT);case ri.TERRAIN:return s1(hr.TERRAIN);case ri.CHARSET:return s1(hr.CHARSET);case ri.PALETTE:return s1(hr.PALETTE)}}function P1(n){return jk(n).type??ri.ERROR}function eT(n){return jme(P1(n))}function Mh(n){return jk(n).name??""}function JGe(n,e){return jk(n)[e]}const mN=new cr;function QGe(n){if(!Vn(n))return;const e=xO(n);if(xe(e)&&xe(bn[e]))return bn[e];const t=Vr(n),r=Hn[t];if(xe(r))return r}function z9(n,e){const t=Object.keys(n);for(let r=0;r<t.length;++r){const i=t[r],s=n[i];if(ui(s)){const[a,...o]=s;switch(a){case"text":xe(e[i])||(e[i]="");break;case"range":xe(e[i])||(e[i]=4);break;case"number":xe(e[i])||(e[i]=0);break;case"select":if(!xe(e[i])){const[,l]=o;e[i]=l}break}continue}switch(i){case"name":case"char":case"light":case"group":case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"cycle":case"stepx":case"stepy":case"shootx":case"shooty":case"displaychar":e[i]=s;break;case"color":case"bg":case"lightdir":case"displaycolor":case"displaybg":e[i]=QGe(s)??s;break;case"isitem":e.item=1;break;case"notitem":e.item=0;break;case"ispushable":e.pushable=s===""?1:s;break;case"notpushable":e.pushable=0;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=wr.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=wr.ISSWIM;break;case"issolid":e.collision=wr.ISSOLID;break;case"isbullet":e.collision=wr.ISBULLET;break;case"isghost":e.collision=wr.ISGHOST;break;case"isbreakable":e.breakable=1;break;case"notbreakable":e.breakable=0;break}}}function Qf(n){if(xe(n))switch(P1(n)){default:return;case ri.ERROR:return n.code??"";case ri.LOADER:return n.code??"";case ri.BOARD:{xe(n.board)||(n.board=DU()),n.board.id=n.id,n.board.name=Mh(n);const e=pN(n);return xe(e.isdark)&&(n.board.isdark=1),xe(e.notdark)&&(n.board.isdark=0),Mn(e.startx)&&(n.board.startx=e.startx),Mn(e.starty)&&(n.board.starty=e.starty),Vn(e.over)&&(Vr(e.over)==="empty"?n.board.over=void 0:n.board.over=e.over),Vn(e.under)&&(Vr(e.under)==="empty"?n.board.under=void 0:n.board.under=e.under),Vn(e.camera)&&(Vr(e.camera)==="empty"?n.board.camera=void 0:n.board.camera=e.camera),Vn(e.graphics)&&(Vr(e.graphics)==="empty"?n.board.graphics=void 0:n.board.graphics=e.graphics),Mn(e.facing)&&(n.board.facing=e.facing),Vn(e.facing)&&Vr(e.facing)==="empty"&&(n.board.facing=void 0),Vn(e.exitnorth)&&(n.board.exitnorth=e.exitnorth),Vn(e.exitsouth)&&(n.board.exitsouth=e.exitsouth),Vn(e.exitwest)&&(n.board.exitwest=e.exitwest),Vn(e.exiteast)&&(n.board.exiteast=e.exiteast),Mn(e.timelimit)&&(n.board.timelimit=e.timelimit),xe(e.restartonzap)&&(n.board.restartonzap=1),xe(e.norestartonzap)&&(n.board.restartonzap=0),Mn(e.maxplayershots)&&(n.board.maxplayershots=e.maxplayershots),n.board}case ri.OBJECT:return xe(n.object)||(n.object=kee()),n.object.id=n.id,n.object.code=n.code,n.object.name=Mh(n),n.object.category=RE.ISOBJECT,z9(pN(n),n.object),n.object;case ri.TERRAIN:return xe(n.terrain)||(n.terrain=kee()),n.terrain.id=n.id,n.terrain.name=Mh(n),n.terrain.category=RE.ISTERRAIN,z9(pN(n),n.terrain),n.terrain;case ri.PALETTE:{if(xe(n.palette)||(n.palette=rx(tR)),xe(n.palette?.bits)){const e=pN(n),t=ub(e);for(let r=0;r<t.length;++r){const i=t[r].toLowerCase(),s=e[i];if(i.startsWith("color")&&Vn(s)){const a=parseFloat(i.replace("color",""));if(a>=0&&a<=15){mN.set(s);const o=a*fw,l=mN.r*63,c=mN.g*63,u=mN.b*63;n.palette.bits[o+0]=Li(l,0,63),n.palette.bits[o+1]=Li(c,0,63),n.palette.bits[o+2]=Li(u,0,63)}}}}return n.palette}case ri.CHARSET:return xe(n.charset)||(n.charset=ix(eR)),n.charset}}function Hme(n){return{id:Sc(),name:Ice(),timestamp:0,activelist:[],pages:n,flags:{}}}function qme(n){xe(n)&&(n.token=`${UIe()}${Og(1111,9999)}`)}function DO(n,e){if(!xe(n))return;const t=Vr(e);return n.pages.find(i=>i.id===e||t===Mh(i))}function qg(n,e,t){if(!xe(n))return;const r=Vr(t);return n.pages.find(s=>P1(s)===e&&(s.id===t||r===Mh(s)))}function j9(n,e,t){let r=qg(n,e,t);if(!xe(r)){const i=jme(e);return r=ZGe(i==="object"?`@${t||"object"}
`:`@${i} ${t}
`,{}),e$e(n,r),[r,!0]}return[r,!1]}function H9(n,e,t){if(!xe(n))return[];const r=Vr(t);return n.pages.filter(s=>P1(s)===e).filter(s=>{const a=jk(s),o=Vr(Mh(s));return s.id===t||r===o||xe(a[t])})}function zM(n){return xe(n)?El(n.pages).sort((t,r)=>{const i=P1(t),s=P1(r);return i===s?Mh(t).localeCompare(Mh(r)):s-i}):[]}function e$e(n,e){if(!xe(n)||!xe(e))return!1;const t=DO(n,e.id);return xe(t)?!1:(n.pages.push(e),qme(n),!0)}function Vme(n,e){const t=DO(n,e);if(xe(n)&&xe(t)){const r=Vr(e);return n.pages=n.pages.filter(i=>i.id!==e&&r!==Mh(i)),qme(n),t}}function Gm(n,e=1,t=bn.WHITE,r=bn.BLACK){const i=n?.kinddata;return{name:Vr(n?.name??i?.name),char:n?.displaychar??i?.displaychar??n?.char??i?.char??e,color:n?.displaycolor??i?.displaycolor??n?.color??i?.color??t,bg:n?.displaybg??i?.displaybg??n?.bg??i?.bg??r,light:n?.light??i?.light??0}}function NU(n,e){return n?(n.flags[e]=n.flags[e]??{},n.flags[e]):{}}function t$e(n,e){n&&delete n.flags[e]}function RL(n,e,t){return NU(n,e)?.[t]}function q9(n,e,t,r){const i=NU(n,e);return i&&(i[t]=r),r}function PU(n,e){const t=n??wr.ISWALK,r=e??wr.ISWALK;if(t===wr.ISGHOST||r===wr.ISGHOST)return!1;switch(t){case wr.ISWALK:return r!==wr.ISWALK;case wr.ISSWIM:return r!==wr.ISSWIM;case wr.ISSOLID:return!0;case wr.ISBULLET:return r!==wr.ISWALK&&r!==wr.ISSWIM}}function LO(n,e,t){const r=n?.objects[t];if(xe(r))return r;const i=rR(n,"player");return xe(e)?(e.x<0&&(e.x=Og(0,$n-1)),e.y<0&&(e.y=Og(0,mi-1)),$me(e,i)):A0(...i)}function rR(n,e){const t=n?.named?.[e];return xe(t)?[...t.values()].map(i=>typeof i=="string"?n?.objects[i]:n?.terrain[i]).filter(xe):[]}function n$e(n){const e=[];for(let t=0;t<mi;++t)for(let r=0;r<$n;++r){const i={x:r,y:t},s=Lo(n,i);!s?.name&&!s?.kind&&e.push(i)}return e}function V9(n,e,t,r){if(!xe(n))return!1;const i=Gm(n);return!(xe(e)&&e!==i.name||xe(t)&&t!==i.color||xe(r)&&r!==i.bg)}function AL(n,e){const t=TO(e),r=aL(e),i=Pfe(e);return rR(n,t??"").filter(s=>V9(s,t,r,i))}function Iee(n,e){const t=xe(e)?rL(e):void 0,r=xe(e)?iL(e):void 0,i=[];if(xe(n)){for(let a=0;a<n.terrain.length;++a){const o=n.terrain[a];xe(o)&&V9(o,void 0,t,r)&&i.push(o)}const s=Object.values(n.objects);for(let a=0;a<s.length;++a){const o=s[a];V9(o,void 0,t,r)&&i.push(o)}}return i}function Gme(n,e){return xe(n)?e.map(t=>{if(typeof t=="string"){const r=n.objects[t];if(xe(r))return r;const i=rR(n,Vr(t));if(i.length)return i}else if(b1(t)&&t.x>=0&&t.x<$n&&t.y>=0&&t.y<mi){const r=t.x+t.y*$n,i=n.lookup?.[r];return xe(i)?n.objects[i]:n.terrain[r]}}).flat().filter(xe):[]}function $me(n,e){let t=0,r;for(let i=0;i<e.length;++i){const s=e[i];if(s){const a=n.x-(s.x??0),o=n.y-(s.y??0),l=Math.sqrt(a*a+o*o);(r===void 0||l<t)&&(t=l,r=s)}}return r}function Up(n){if(!xe(n)||xe(n.lookup)&&xe(n.named))return;const e=new Array($n*mi).fill(void 0),t={},r=Object.values(n.objects);for(let a=0;a<r.length;++a){const o=r[a];if(xe(o.x)&&xe(o.y)&&xe(o.id)&&!xe(o.removed)&&ji(o,"collision")!==wr.ISGHOST){o.category=RE.ISOBJECT,e[o.x+o.y*$n]=o.id,Vn(o.code)&&!xe(o.name)&&z9(zme(o.code),o);const l=Gm(o);t[l.name]||(t[l.name]=new Set),t[l.name].add(o.id)}}let i=0,s=0;for(let a=0;a<n.terrain.length;++a){const o=n.terrain[a];if(xe(o)){o.x=i,o.y=s,o.category=RE.ISTERRAIN;const l=Gm(U1(o));t[l.name]||(t[l.name]=new Set),t[l.name].add(a)}++i,i>=$n&&(i=0,++s)}n.lookup=e,n.named=t}function UO(n){xe(n)&&(delete n.named,delete n.lookup,Up(n))}function G9(n,e,t){if(!xe(n)||!xe(n.named)||!xe(e))return;const r=Vr(e.name??e.kinddata?.name??"");n.named[r]||(n.named[r]=new Set),n.named[r].add(e?.id??t??"")}function Wme(n,e){if(!(!xe(n)||!xe(n.lookup)||!xe(e?.id))&&!xe(e.removed)&&ji(e,"collision")!==wr.ISGHOST){const t=e.x??0,r=e.y??0;n.lookup[t+r*$n]=e.id}}function r$e(n,e){if(xe(n)&&xe(e?.x)&&xe(e.y)){const t=Gm(e),r=BO(n,e);xe(n.named?.[t.name])&&n.named[t.name].delete(r)}}function Mq(n,e){if(xe(n)&&xe(e?.id)){if(xe(n.lookup)&&xe(e.x)&&xe(e.y)){const r=e.x+e.y*$n;n.lookup[r]===e.id&&(n.lookup[r]=void 0)}const t=Gm(e);xe(n.named?.[t.name])&&xe(e.id)&&n.named[t.name].delete(e.id)}}function i$e(n,e,t,r){if(!xe(n))return;xe(n.distmaps)||(n.distmaps={});const i=`${e}.${t.x}.${t.y}.${r.x}.${r.y}`;let s=n.distmaps[i];if(!xe(s)){s=new Array(w_).fill(-2);const a=[{...r}];let o=0;for(;a.length;){const l=a.shift();if(xe(l)&&bw(l)){const c=_f(l,$n);if(s[c]===-2){const u=UE(n,l.x,l.y);PU(e,ji(u,"collision"))||(s[c]=o,a.push({x:l.x,y:l.y-1},{x:l.x,y:l.y+1},{x:l.x-1,y:l.y},{x:l.x+1,y:l.y})),++o}}}n.distmaps[i]=s}return s}function Nee(n,e){return bw(n)?e[_f(n,$n)]:-1}function Pee(n,e,t,r,i){if(!xe(n))return;const s=i$e(n,e,t,r);if(!xe(s))return;const a=[{x:t.x,y:t.y-1},{x:t.x,y:t.y+1},{x:t.x-1,y:t.y},{x:t.x+1,y:t.y}];let o;if(i){let l=i?0:1e4;for(let c=0;c<a.length;++c){const u=Nee(a[c],s);u>=0&&u>l&&(l=u,o=a[c])}}else{let l=1e5;for(let c=0;c<a.length;++c){const u=Nee(a[c],s);u>=0&&u<l&&(l=u,o=a[c])}}return o}function s$e(){return new Array($n*mi).map(()=>{})}function DU(n=bm){const e={terrain:s$e(),objects:{},id:"",name:""};return n(e)}function bw(n){return _Fe(n.x,n.y,0,$n-1,mi-1,0)}function BO(n,e){return!xe(n)||!xe(e?.x)||!xe(e?.y)||e.x<0||e.x>=$n||e.y<0||e.y>=mi?-1:e.x+e.y*$n}function Lo(n,e){const t=BO(n,e);if(t<0||!xe(n?.lookup))return;const r=Fg(n,n.lookup[t]??"");return xe(r)?r:n.terrain[t]}function a$e(n,e){const t=Fg(n,e);if(xe(t))return t;const r=parseFloat(e),i=pw(isNaN(r)?-1:r,$n);return UE(n,i.x,i.y)}function UE(n,e,t){return(e>=0&&e<$n)??(t>=0&&t<mi)?n?.terrain[e+t*$n]:void 0}function Ed(n,e){if(!xe(n)||!xe(e)||!xe(e.x)||!xe(e.y)||e.x<0||e.x>=$n||e.y<0||e.y>=mi)return;const t=El(e),r=e.x+e.y*$n;return n.terrain[r]=t,delete n.distmaps,n.terrain[r]}function o$e(n,e){if(!xe(n)||!xe(e))return;const t=El(e);return t.id=t.id??Sc(),n.objects[t.id]=t,n.objects[t.id]}function l$e(n,e,t){return Ed(n,{...e,kind:t})}function Yme(n,e,t,r){return o$e(n,{...e,kind:t,id:r})}function Fg(n,e){if(n)return n.objects[e]}function c$e(n){return xe(n)?[...Object.values(n.objects)]:[]}function Dee(n,e){const t=BO(n,e);if(t<0||!xe(n?.lookup))return;const r=Fg(n,n.lookup[t]??"");if(xe(r))return r}function zg(n,e,t){return!xe(e)||Gm(e).name==="player"?!1:(e.id?(e.removed=t,Mq(n,e)):(Ed(n,{x:e?.x??0,y:e?.y??0}),r$e(n,e)),!0)}function u$e(n,e,t){if(!xe(n)||!xe(e))return;const r=n.objects[t];if(xe(r))return r;if(b1(e))return $me(e,rR(n,"player"))}function E2(n,e,t,r,i){const s=Hn.MID;if(!xe(n)||!xe(e))return{dir:r,startpt:i,destpt:i,layer:s,targets:[]};const a={x:e.x??0,y:e.y??0},o={x:a.x+(e.stepx??0),y:a.y+(e.stepy??0)},l=mv(a,o),c=$n-1,u=mi-1;for(let f=0;f<r.length;++f){const h=Ofe(r[f]);switch(h){case Hn.IDLE:break;case Hn.NORTH:case Hn.SOUTH:case Hn.WEST:case Hn.EAST:hu(a,h);break;case Hn.BY:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Li(a.x+g,0,c),a.y=Li(a.y+p,0,u)),f+=2;break}case Hn.TO:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Li(g,0,c),a.y=Li(p,0,u)),f+=2;break}case Hn.AT:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Li(g,0,c),a.y=Li(p,0,u)),f+=2;break}case Hn.FLOW:hu(a,l);break;case Hn.SEEK:{const g=u$e(n,e,t);b1(g)&&hu(a,mv(i,g));break}case Hn.RNDNS:hu(a,A0(Hn.NORTH,Hn.SOUTH));break;case Hn.RNDNE:hu(a,A0(Hn.NORTH,Hn.EAST));break;case Hn.RND:hu(a,A0(Hn.NORTH,Hn.SOUTH,Hn.WEST,Hn.EAST));break;case Hn.CW:case Hn.CCW:case Hn.OPP:case Hn.RNDP:{const g=E2(n,e,t,r.slice(f+1),i);switch(a.x=i.x,a.y=i.y,h){case Hn.CW:switch(mv(i,g.destpt)){case Hn.NORTH:hu(a,Hn.EAST);break;case Hn.SOUTH:hu(a,Hn.WEST);break;case Hn.EAST:hu(a,Hn.SOUTH);break;case Hn.WEST:hu(a,Hn.NORTH);break}break;case Hn.CCW:switch(mv(i,g.destpt)){case Hn.NORTH:hu(a,Hn.WEST);break;case Hn.SOUTH:hu(a,Hn.EAST);break;case Hn.EAST:hu(a,Hn.NORTH);break;case Hn.WEST:hu(a,Hn.SOUTH);break}break;case Hn.OPP:switch(mv(i,g.destpt)){case Hn.NORTH:hu(a,Hn.SOUTH);break;case Hn.SOUTH:hu(a,Hn.NORTH);break;case Hn.EAST:hu(a,Hn.WEST);break;case Hn.WEST:hu(a,Hn.EAST);break}break;case Hn.RNDP:switch(mv(i,g.destpt)){case Hn.NORTH:case Hn.SOUTH:a.x+=A0(-1,1);break;case Hn.WEST:case Hn.EAST:a.y+=A0(-1,1);break}break}return{dir:r,startpt:i,destpt:a,layer:s,targets:[]}}case Hn.FLEE:break;case Hn.AWAY:{const[g,p]=r.slice(f+1);if(Mn(g)&&Mn(p)){const _={x:Li(g,0,c),y:Li(p,0,u)},y=_.x-a.x,v=_.y-a.y;if(Math.abs(y)>1||Math.abs(v)>1){const x=ji(e,"collision"),E=Pee(n,x,a,_,!0);xe(E)&&E.x!==g&&E.y!==p&&!Dee(n,E)&&(a.x=E.x,a.y=E.y)}else{const x=rE(-y,-v);hu(a,x)}}f+=2;break}case Hn.FIND:break;case Hn.TOWARD:{const[g,p]=r.slice(f+1);if(Mn(g)&&Mn(p)){const _={x:Li(g,0,c),y:Li(p,0,u)},y=_.x-a.x,v=_.y-a.y;if(Math.abs(y)>1||Math.abs(v)>1){const x=ji(e,"collision"),E=Pee(n,x,a,_,!1);xe(E)&&E.x!==g&&E.y!==p&&!Dee(n,E)&&(a.x=E.x,a.y=E.y)}else{const x=rE(y,v);hu(a,x)}}f+=2;break}case Hn.OVER:case Hn.UNDER:{const g=E2(n,e,t,r.slice(f+1),i);return g.layer=h,g}case Hn.WITHIN:{const[g]=r.slice(f+1),p=E2(n,e,t,r.slice(f+2),i);if(p.targets.length===0&&Mn(g)&&g>0)for(let _=-g;_<=g;++_)for(let y=-g;y<=g;++y){const v={x:p.destpt.x+y,y:p.destpt.y+_};bw(v)&&p.targets.push(v)}return Mn(g)&&g>0?{...p,targets:p.targets.filter(_=>b1(_)?vQ(_,p.destpt)<=g:!1)}:p}case Hn.AWAYBY:{const[g]=r.slice(f+1),p=E2(n,e,t,r.slice(f+2),i);if(p.targets.length===0)for(let _=-$n;_<=$n;++_)for(let y=-$n;y<=$n;++y){const v={x:p.destpt.x+y,y:p.destpt.y+_};bw(v)&&p.targets.push(v)}return Mn(g)&&g>0?{...p,targets:p.targets.filter(_=>b1(_)?vQ(_,p.destpt)>=g:!1)}:p}}}return{dir:r,startpt:i,destpt:a,layer:s,targets:[]}}function LU(n,e,t,r=!1){if(!xe(n)||!xe(n.lookup)||t.x<0||t.x>=$n||t.y<0||t.y>=mi)return{name:"edge",kind:"edge",collision:wr.ISSOLID,x:t.x,y:t.y};const i=t.x+t.y*$n,s=Fg(n,n.lookup[i]??"404");if(xe(s))return r&&R0(s.id)?void 0:s;const a=n.terrain[i];if(xe(a)&&PU(e,ji(a,"collision")))return a}function f$e(n,e,t){const r=Fg(n,e?.id??""),i=r?.x??-1,s=r?.y??-1;if(i-t.x===0&&s-t.y===0)return!0;const a=ji(r,"collision");return xe(LU(n,a,t))}function $9(n,e,t){const r=Fg(n,e?.id??"");if(!xe(n)||!xe(r)||!xe(r.x)||!xe(r.y)||!xe(n.lookup)||t.x<0||t.x>=$n||t.y<0||t.y>=mi)return{name:"edge",kind:"edge",collision:wr.ISSOLID,x:t.x,y:t.y};if(r.x-t.x===0&&r.y-t.y===0)return;const i=BO(n,r),s=BO(n,t),a=ji(r,"collision");if(a===wr.ISGHOST){r.x=t.x,r.y=t.y;return}const o=R0(r?.id),l=Fg(n,n.lookup[s]??"");if(ji(l,"collision")===wr.ISGHOST)return;const c=R0(l?.id??"");if(xe(l)&&(!o||!c))return{...l};const u=n.terrain[s],f=u?.collision??u?.kinddata?.collision??wr.ISWALK;if(PU(a,f))return{...u,x:t.x,y:t.y};r.x=t.x,r.y=t.y,xe(r.removed)||(n.lookup[i]=void 0,n.lookup[s]=r.id??"")}function Xme(n,e,t){const r=[],i=[];if(!xe(n))return{objectelements:r,terrainelements:i};function s(o,l){switch(t){case"all":return!0;case"self":return o?.id===e;case"others":return o?.id!==e;case"terrain":return l===!0;case"object":return l===!1}const c=ji(o,t);return xe(c)||Gm(o).name===t||ji(o,"group")===t}const a=Object.values(n.objects);for(let o=0;o<a.length;++o){const l=a[o];s(l,!1)&&r.push(l)}for(let o=0;o<w_;++o){const l=n.terrain[o];xe(l)&&s(l,!0)&&i.push(l)}return{objectelements:r,terrainelements:i}}const Kme={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function FO(n){return ui(n)&&Zme(n[0])}function Zme(n){return xe(RE[n])&&Vn(n)}function Jme(n){if(Vn(n))return Kme[Vr(n)]}function Lee(n){if(FO(n))return n;if(Zme(n))return[n];const e=Jme(n);if(xe(e))return[e]}function h$e(n){const e=Ce.words[n],t=Lee(e);if(FO(t))return[t,n+1];const[r,i]=Rp(n),s=Lee(r);return FO(s)?[s,i]:[void 0,n]}const Qme={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",isghost:"ISGHOST",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};wr.ISSOLID,wr.ISWALK,wr.ISSWIM,wr.ISBULLET,wr.ISGHOST,wr.ISWALK,wr.ISSWIM;function CL(n){return ui(n)&&W9(n[0])}function W9(n){return xe(wr[n])&&Vn(n)}function d$e(n){if(Vn(n))return Qme[Vr(n)]}function p$e(n){const e=Ce.words[n];if(CL(e))return[e,n+1];if(W9(e))return[[e],n+1];const[t,r]=Rp(n);return CL(t)?[t,r]:W9(t)?[[t],r]:[void 0,n]}function tT(n,e=0){const t=[];let r=n;for(;r<Ce.words.length;){const[i,s]=Rp(r);if(ui(i)&&!q0(i)&&!FO(i)&&!CL(i)&&!Lp(i)&&t.push(...i),i==="|")return[t,s];if(r=s,t.push(i),e>0&&t.length>=e)return[t,r]}return[t,r]}function Rp(n){const e=Ce.words[n],t=n+1;if(Jme(e)){const[r,i]=h$e(n);if(xe(r))return[r,i]}if(d$e(e)){const[r,i]=p$e(n);if(xe(r))return[r,i]}if(xO(e)){const[r,i]=sL(n);if(xe(r))return[r,i]}if(Vn(e)&&Vr(e)==="rnd"){const[r,i]=Rp(t),[s,a]=Rp(i);return Mn(r)&&Mn(s)?[Og(r,s),a]:Mn(r)?[Og(0,r),i]:[Og(0,1),t]}if(hU(e)){const[r,i]=kfe(n);if(xe(r))return[r,i]}if(!xe(e))return[void 0,n];if(Mn(e)||ui(e))return[e,t];if(Vn(e)){const r=Vr(e),i=Ce.get?.(e);if(xe(i))return[i,t];switch(r){case"aligned":case"alligned":{const s=LO(Ce.board,{x:Ce.element?.x??-1,y:Ce.element?.y??-1},Ce.elementfocus);return!xe(Ce.element)||!xe(s)?[0,t]:[Ce.element.x===s.x||Ce.element.y===s.y?1:0,t]}case"contact":{const s=LO(Ce.board,{x:Ce.element?.x??-1,y:Ce.element?.y??-1},Ce.elementfocus);if(!xe(Ce.element)||!xe(s))return[0,t];const a=(s.x??0)-(Ce.element?.x??0),o=(s.y??0)-(Ce.element?.y??0);return[a===0&&Math.abs(o)<2||o===0&&Math.abs(a)<2?1:0,t]}case"blocked":{const[s,a]=ln(Ce.words,t,[Pt.DIR]);return[f$e(Ce.board,Ce.element,s.destpt)?1:0,a]}case"any":{const[s]=ln(Ce.words,t,[Pt.ANY]);if(q0(s)){const[c,u,f]=ln(Ce.words,t,[Pt.DIR,Pt.COLOR_OR_KIND]);if(c.targets.length){const[g,p]=u,_=[];for(let y=0;y<c.targets.length;++y){const v=c.targets[y],x=["any","at",v.x,v.y,p,g].filter(M=>M!==void 0),[E]=ln(x,0,[Pt.ANY]);ui(E)&&E.length&&_.push(...E)}return[_,f]}const h=c.layer===Hn.MID?Lo(Ce.board,c.destpt):UE(Ce.board,c.destpt.x,c.destpt.y);if(xe(h)){const g=Gm(h);if(Lp(u))return[rL(u)===g.color||iL(u)===g.bg?[h]:[],f];const p=Vr(TO(u)),_=aL(u);if((p.length&&p!==g.name||xe(_)&&_!==g.color)===!1)return[[h],f]}return[[],f]}const[a,o]=ln(Ce.words,t,[Pt.COLOR_OR_KIND]);return Lp(a)?[Iee(Ce.board,a),o]:[AL(Ce.board,a),o]}case"countof":{const[s]=ln(Ce.words,t,[Pt.ANY]);if(q0(s)){const[c,u,f]=ln(Ce.words,t,[Pt.DIR,Pt.COLOR_OR_KIND]);if(c.targets.length){let g=0;const[p,_]=u;for(let y=0;y<c.targets.length;++y){const v=c.targets[y],x=["countof","at",v.x,v.y,_,p].filter(M=>M!==void 0),[E]=ln(x,0,[Pt.ANY]);Mn(E)&&(g+=E)}return[g,f]}const h=c.layer===Hn.MID?Lo(Ce.board,c.destpt):UE(Ce.board,c.destpt.x,c.destpt.y);if(xe(h)){const g=Gm(h);if(Lp(u))return[rL(u)===g.color||iL(u)===g.bg?1:0,f];const p=Vr(TO(u)),_=aL(u),y=p.length?p===g.name:!0,v=xe(_)?_===g.color:!0;if(y&&v)return[1,f]}return[0,f]}const[a,o]=ln(Ce.words,t,[Pt.COLOR_OR_KIND]);return Lp(a)?[Iee(Ce.board,a).length,o]:[AL(Ce.board,a).length,o]}case"rnd":return[Og(0,1),t];case"abs":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER]);return[Math.abs(s),a]}case"intceil":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER]);return[Math.ceil(s),a]}case"intfloor":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER]);return[Math.floor(s),a]}case"intround":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER]);return[Math.round(s),a]}case"clamp":{const[s,a,o,l]=ln(Ce.words,t,[Pt.NUMBER,Pt.NUMBER,Pt.NUMBER]);return[Li(s,a,o),l]}case"min":{const[s,a]=tT(t);return[Math.min(...s),a]}case"max":{const[s,a]=tT(t);return[Math.max(...s),a]}case"pick":{const[s,a]=tT(t);return[A0(s),a]}case"pickwith":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER_OR_STRING]),[o,l]=tT(a);return[H8e(`${s}`,o),l]}case"random":{const[s,a]=tT(t,2),[o,l]=s;return[Og(o,l??0),a]}case"randomwith":{const[s,a]=ln(Ce.words,t,[Pt.NUMBER_OR_STRING]),[o,l]=tT(a,2),[c,u]=o;return[mce(`${s}`,c,u??0),l]}case"run":{const[s,a]=ln(Ce.words,t,[Pt.NAME]);return zL(s),[Ce.get?.("arg"),a]}case"runwith":{const[s,a,o]=ln(Ce.words,t,[Pt.ANY,Pt.NAME]);return xe(Ce.element)&&(Ce.element.arg=s),zL(a),[Ce.get?.("arg"),o]}}}return[e,t]}const Ce={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var Pt=(n=>(n[n.COLOR=0]="COLOR",n[n.KIND=1]="KIND",n[n.DIR=2]="DIR",n[n.NAME=3]="NAME",n[n.NUMBER=4]="NUMBER",n[n.STRING=5]="STRING",n[n.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",n[n.COLOR_OR_KIND=7]="COLOR_OR_KIND",n[n.MAYBE_KIND=8]="MAYBE_KIND",n[n.MAYBE_NAME=9]="MAYBE_NAME",n[n.MAYBE_NUMBER=10]="MAYBE_NUMBER",n[n.MAYBE_STRING=11]="MAYBE_STRING",n[n.MAYBE_NUMBER_OR_STRING=12]="MAYBE_NUMBER_OR_STRING",n[n.ANY=13]="ANY",n))(Pt||{});function Th(n,e,t){throw console.info(t,Ce.element,Ce.elementid,Ce.elementfocus),new Error(`Invalid arg, expected: ${n} but got ${JSON.stringify(e)}`)}function Uee(n){const e={x:Ce.element?.x??0,y:Ce.element?.y??0};return E2(Ce.board,Ce.element,Ce.elementfocus,n,e)}function ln(n,e,t){const r=Ce.words;Ce.words=n;const i=[];let s=e;for(let a=0;a<t.length;++a)switch(t[a]){case 1:{const[o,l]=qB(s);hE(o)?(s=l,i.push(o)):Th("kind",o,n);break}case 0:{if(xO(n[s])===void 0){const[o,l]=Rp(s);Lp(o)?(s=l,i.push(o)):Mn(o)?(s=l,i.push(pU(o,void 0))):Th("color",o,n)}else{const[o,l]=sL(s);Lp(o)?(s=l,i.push(o)):Th("color",o,n)}break}case 2:{if(hU(n[s])===void 0){const[o,l]=Rp(s);q0(o)?(s=l,i.push(Uee(o))):Th("direction",o,n)}else{const[o,l]=kfe(s);q0(o)?(s=l,i.push(Uee(o))):Th("direction",o,n)}break}case 3:{const o=Ce.words[s];Vn(o)||Th("string",o,n),++s,i.push(o);break}case 4:{const[o,l]=Rp(s);if(Vn(o)){const c=parseFloat(o);Mn(c)?i.push(c):Th("number",o,n)}else Mn(o)?i.push(o):Th("number",o,n);s=l;break}case 5:{const[o,l]=Rp(s);Vn(o)||Th("string",o,n),s=l,i.push(o);break}case 6:{const[o,l]=Rp(s);let c=o;if(Vn(c)){const u=parseFloat(c);Mn(u)&&(c=u)}else Mn(c)||Th("number or string",c,n);s=l,i.push(c);break}case 7:{const[o,l]=qB(s);if(hE(o))s=l,i.push(o);else if(xO(n[s])===void 0){const[c,u]=Rp(s);Lp(c)?(s=u,i.push(c)):Th("color",c,n)}else{const[c,u]=sL(s);Lp(c)?(s=u,i.push(c)):Th("color or kind",c,n)}break}case 8:{const[o,l]=qB(s);o!==void 0&&!hE(o)&&Th("optional kind",o,n),s=l,i.push(o);break}case 9:{const o=Ce.words[s];o!==void 0&&!Vn(o)&&Th("optional string",o,n),++s,i.push(o);break}case 10:{const[o,l]=Rp(s);if(Vn(o)){const c=parseFloat(o);Mn(c)?i.push(c):Th("optional number",o,n)}else Mn(o)||o===void 0?i.push(o):Th("optional number",o,n);s=l;break}case 11:{const[o,l]=Rp(s);o!==void 0&&!Vn(o)&&Th("optional string",o,n),s=l,i.push(o);break}case 12:{const[o,l]=Rp(s);let c=o;if(Vn(c)){const u=parseFloat(c);Mn(u)&&(c=u)}else c!==void 0&&!Mn(c)&&Th("number or string",c,n);s=l,i.push(c);break}case 13:{const[o,l]=Rp(s);s=l,i.push(o);break}}return Ce.words=r,[...i,s]}function xm(n,e,t,r){const[i,s]=ln(r,0,[Pt.NUMBER_OR_STRING,Pt.MAYBE_NUMBER_OR_STRING]);bce(St,n,e,t,i,s)}const m$e=["echo","reverb","phaser","distortion","vibrato","fc","fcrush","autowah"];function Oq(n,e,t){const[r,i]=ln(t,0,[Pt.NUMBER_OR_STRING]);if(Mn(r))_B(St,n,e,"volume",r);else if(m$e.includes(Vr(r))){const[s,a]=ln(t,i,[Pt.NUMBER_OR_STRING,Pt.MAYBE_NUMBER_OR_STRING]);bce(St,n,e,r,s,a)}else{const[s]=ln(t,i,[Pt.MAYBE_NUMBER_OR_STRING]);if(Mn(s)){const a=t.length-i,o=new Array(a).fill(Pt.NUMBER),l=ln(t,i,o).slice(0,a),c=l.length===1?l[0]:l;_B(St,n,e,r,c)}else{const[a]=ln(t,i,[Pt.MAYBE_NUMBER_OR_STRING]);_B(St,n,e,r,a)}}}function Yb(n,e){const[t]=ln(n,0,[Pt.MAYBE_NAME]);U3e(St,Ce.elementfocus,Ce.board?.id??"",t??"",e)}const UU=bb().command("tts",(n,e)=>{const[t,r]=ln(e,0,[Pt.STRING,Pt.STRING]);return P3e(St,Ce.elementfocus,t,r),0}).command("ttsqueue",(n,e)=>{const[t,r]=ln(e,0,[Pt.STRING,Pt.STRING]);return D3e(St,Ce.elementfocus,t,r),0}).command("bpm",(n,e)=>{const[t]=ln(e,0,[Pt.NUMBER]);return B3e(St,Ce.elementfocus,t),0}).command("vol",(n,e)=>{const[t]=ln(e,0,[Pt.NUMBER]);return F3e(St,Ce.elementfocus,t),0}).command("bgvol",(n,e)=>{const[t]=ln(e,0,[Pt.NUMBER]);return z3e(St,Ce.elementfocus,t),0}).command("ttsvol",(n,e)=>{const[t]=ln(e,0,[Pt.NUMBER]);return j3e(St,Ce.elementfocus,t),0}).command("play",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]);return L3e(St,Ce.elementfocus,Ce.board?.id??"",t??""),0}).command("bgplay",(n,e)=>(Yb(e,""),0)).command("bgplayon64n",(n,e)=>(Yb(e,"@64n"),0)).command("bgplayon32n",(n,e)=>(Yb(e,"@32n"),0)).command("bgplayon16n",(n,e)=>(Yb(e,"@16n"),0)).command("bgplayon8n",(n,e)=>(Yb(e,"@8n"),0)).command("bgplayon4n",(n,e)=>(Yb(e,"@4n"),0)).command("bgplayon2n",(n,e)=>(Yb(e,"@2n"),0)).command("bgplayon1n",(n,e)=>(Yb(e,"@1m"),0)).command("synth",(n,e)=>{for(let t=0;t<4;++t)Oq(Ce.elementfocus,t,e);return 0}).command("synthrecord",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_STRING]);return H3e(St,Ce.elementfocus,t??""),0}).command("synthflush",()=>(q3e(St,Ce.elementfocus),0)).command("echo",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"echo",e);return 0}).command("fcrush",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"fc",e);return 0}).command("phaser",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"phaser",e);return 0}).command("reverb",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"reverb",e);return 0}).command("distort",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"distort",e);return 0}).command("vibrato",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"vibrato",e);return 0}).command("autowah",(n,e)=>{for(let t=0;t<2;++t)xm(Ce.elementfocus,t,"autowah",e);return 0});for(let n=0;n<4;++n)UU.command(`synth${n+1}`,(e,t)=>(Oq(Ce.elementfocus,n,t),0));UU.command("synth5",(n,e)=>{for(let t=4;t<8;++t)Oq(Ce.elementfocus,t,e);return 0});for(let n=0;n<3;++n){const e=n+1;UU.command(`echo${e}`,(t,r)=>(xm(Ce.elementfocus,n,"echo",r),0)).command(`fcrush${e}`,(t,r)=>(xm(Ce.elementfocus,n,"fcrush",r),0)).command(`phaser${e}`,(t,r)=>(xm(Ce.elementfocus,n,"phaser",r),0)).command(`reverb${e}`,(t,r)=>(xm(Ce.elementfocus,n,"reverb",r),0)).command(`distort${e}`,(t,r)=>(xm(Ce.elementfocus,n,"distort",r),0)).command(`vibrato${e}`,(t,r)=>(xm(Ce.elementfocus,n,"vibrato",r),0)).command(`autowah${e}`,(t,r)=>(xm(Ce.elementfocus,n,"autowah",r),0))}function Bee(n,e,t,r){for(let i=t.y;i<=r.y;++i)for(let s=t.x;s<=r.x;++s){const a=Lo(e,{x:s,y:i});Gu(a)&&zg(e,a,n.timestamp),Ed(e,{x:s,y:i})}}function g$e(n,e,t){for(let r=e.y;r<=t.y;++r)for(let i=e.x;i<=t.x;++i)Ed(n,{x:i,y:r})}function Fee(n,e,t,r){for(let i=t.y;i<=r.y;++i)for(let s=t.x;s<=r.x;++s){const a=Lo(e,{x:s,y:i});Gu(a)&&zg(e,a,n.timestamp),Ed(e,{x:s,y:i})}}function BE(n,e){xe(n)&&(n.name=e.name,n.char=e.char,n.color=e.color,n.bg=e.bg,n.displaychar=e.displaychar,n.displaycolor=e.displaycolor,n.displaybg=e.displaybg,n.p1=e.p1,n.p2=e.p2,n.p3=e.p3,n.p4=e.p4,n.p5=e.p5,n.p6=e.p6,n.code=e.code,n.item=e.item,n.group=e.group,n.party=e.party,n.cycle=e.cycle,n.light=e.light,n.lightdir=e.lightdir,n.stepx=e.stepx,n.stepy=e.stepy,n.shootx=e.shootx,n.shooty=e.shooty,n.pushable=e.pushable,n.collision=e.collision,n.breakable=e.breakable,n.tickertext=e.tickertext,n.tickertime=e.tickertime)}function BU(n,e,t,r,i){switch(i){case"all":case"object":case"terrain":break;default:return _$e(n,e,t,"",i)}if(!xe(Ce.book))return;const s=Ce.book,a=qg(s,ri.BOARD,n),o=Qf(a);if(!xe(o))return;const l=qg(s,ri.BOARD,e),c=Qf(l);if(!xe(c))return;Up(o),Up(c);let u=!1;if(xe(o)&&xe(c)){switch(i){case"all":Bee(s,c,t,r);break;case"object":Fee(s,c,t,r);break;case"terrain":g$e(c,t,r);break;default:u=!0;break}for(let f=t.y;f<=r.y;++f)for(let h=t.x;h<=r.x;++h){let g=!1,p=!1;switch(i){case"all":g=!0,p=!0;break;case"object":g=!0;break;case"terrain":p=!0;break}const _={x:h,y:f};let y,v=Lo(o,_);if(Gu(v)?(y=UE(o,h,f),R0(v?.id)&&(v=void 0)):(y=v,v=void 0),xe(y)&&(p||u&&ji(y,"group")===i)){u&&Bee(s,c,_,_);const x=F0(c,[y.kind??""],_);BE(x,y)}if(xe(v)&&(g||u&&ji(v,"group")===i)){u&&Fee(s,c,_,_);const x=F0(c,[v.kind??""],_);BE(x,v)}}UO(c)}}function _$e(n,e,t,r,i){if(!xe(Ce.book))return;const s=Ce.book,a=qg(s,ri.BOARD,n),o=Qf(a);if(!xe(o))return;const l=qg(s,ri.BOARD,e),c=Qf(l);if(xe(c)&&(Up(o),Up(c),xe(o)&&xe(c))){const{terrainelements:u,objectelements:f}=Xme(o,r,i);if(u.length===0&&f.length===0)return;const h={x:$n,y:mi};for(let g=0;g<u.length;++g){const p=u[g];Mn(p.x)&&(h.x=Math.min(h.x,p.x)),Mn(p.y)&&(h.y=Math.min(h.y,p.y))}for(let g=0;g<f.length;++g){const p=f[g];Mn(p.x)&&(h.x=Math.min(h.x,p.x)),Mn(p.y)&&(h.y=Math.min(h.y,p.y))}for(let g=0;g<u.length;++g){const p=u[g],_={x:t.x+(p.x??0)-h.x,y:t.y+(p.y??0)-h.y},y=Lo(c,_);xe(y)&&(Gu(y)&&zg(c,y,s.timestamp),Ed(c,_));const v=F0(c,[p.kind??""],_);BE(v,p)}for(let g=0;g<f.length;++g){const p=f[g],_={x:t.x+(p.x??0)-h.x,y:t.y+(p.y??0)-h.y},y=F0(c,[p.kind??""],_);BE(y,p)}UO(c)}}function jc(n){return`${n??""}`}function vd(n,e){const t=parseFloat(jc(n));return isNaN(t)?e:t}function Bp(n,e){return typeof n==typeof e?n:e}function v$e(n,e,t){if(!xe(n))return;q9(n,e,"board",t);const r=Np(t);xe(r)?n.activelist.includes(e)||n.activelist.push(e):n.activelist=n.activelist.filter(i=>i!==e)}function AT(n,e,t,r,i=!1){const s=nnt(e);if(!xe(n)||!xe(s))return;const a=Fg(s,e);if(!Gu(a)||!a?.id)return;const o=Np(t);if(!xe(o))return;Up(o);const l=LU(o,wr.ISWALK,r,!0);if(i===!1&&xe(l))if(ji(l,"item"))Hu(e,a,l,"touch");else return;Mq(s,a),delete s.objects[a.id],a.x=r.x,a.y=r.y,o.objects[a.id]=a,G9(o,a),Wme(o,a),q9(n,e,"enterx",r.x),q9(n,e,"entery",r.y),v$e(n,e,o.id)}function y$e(n){const t=(n?.activelist??[]).map(r=>{const i=RL(n,r,"board");return Vn(i)?i:""});return q8e(t)}function ege(n){const e=y$e(n),t=new Set,r=[];for(let i=0;i<e.length;++i){const s=Np(e[i]);if(xe(s)&&!t.has(s.id)){if(Vn(s.over))if(Vn(s.overboard)){const a=Np(s.overboard);xe(a)?t.has(a.id)||r.push(a):delete s.overboard}else{const a=Np(s.over);xe(a)&&(s.overboard=a.id)}else Vn(s.overboard)&&delete s.overboard;if(r.push(s),Vn(s.under))if(Vn(s.underboard)){const a=Np(s.underboard);xe(a)||delete s.underboard}else{const a=Np(s.under);xe(a)&&(s.underboard=a.id)}else Vn(s.underboard)&&delete s.underboard}}return r}const b$e=uw(32,126).map(n=>String.fromCharCode(n)),tge=Yg({name:"Whitespace",pattern:/ +/}),S$e=Yg({name:"WhitespaceSkipped",pattern:/ +/,group:Nh.SKIPPED}),FU=Yg({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),zU=Yg({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:b$e}),jU=Yg({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),HU=Yg({name:"EscapedDollar",pattern:"$$"}),qU=Yg({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),VU=Yg({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),GU=Yg({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function E$e(n,e=""){return Yg({name:e||n,pattern:new RegExp(n.toLowerCase(),"i")})}const x$e=Object.keys(dU),nge=x$e.map(n=>E$e(`\\$(${n})`,n)),T$e=[tge,FU,...nge,jU,zU,VU,HU,GU,qU],w$e=new Nh(T$e,{skipValidations:!Hv,ensureOptimizations:Hv}),R$e=new Nh([S$e,FU,...nge,jU,zU,VU,HU,GU,qU],{skipValidations:!Hv,ensureOptimizations:Hv}),zee=/\$CENTER/i;function kq(n){if(zee.test(n))return n.replace(zee,"")}function Hk(n,e=!1){return e?R$e.tokenize(n):w$e.tokenize(n)}function Tb(n,e,t,r,i,s,a,o){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:t,bg:r,topedge:i,leftedge:s,rightedge:a,bottomedge:o},reset:{color:t,bg:r,topedge:i,leftedge:s,rightedge:a,bottomedge:o},width:n,height:e,char:[],color:[],bg:[],changed(){}}}function Iq(n){n.active={...n.reset}}function Nq(n,e){const t=e.y;function r(){++e.x;const o=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>o&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function i(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(o){for(let l=0;l<o.length;++l){if(e.measureonly!==!0&&i()){const c=e.x+e.y*e.width;e.char[c]=o.charCodeAt(l),e.active.color!==void 0&&(e.color[c]=e.active.color),e.active.bg!==void 0&&(e.bg[c]=e.active.bg)}r()}}for(let o=0;o<n.length;++o){const l=n[o];switch(l.tokenType){case HU:s("$");break;case VU:if(e.measureonly!==!0&&i()){const c=e.x+e.y*e.width;e.char[c]=parseFloat(l.image.replace("$","")),e.active.color!==void 0&&(e.color[c]=e.active.color),e.active.bg!==void 0&&(e.bg[c]=e.active.bg)}r();break;case jU:s(l.image.substring(1,l.image.length-1).replaceAll('\\"','"'));break;case FU:{e.x=e.active.leftedge??0,++e.y;break}default:{const c=l.tokenType.name,u=dU[c],f=yFe(bn[u]),h=DH(bn[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):xe(f)?e.active.color=f:xe(h)?e.active.bg=h:s(l.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const a=e.active.leftedge??0;if(xe(e.writefullwidth)&&(e.x>a||e.y===t)){const l=(e.active.rightedge??e.width-1)-e.x;if(l>0){Iq(e);const c=String.fromCharCode(e.writefullwidth).repeat(l),u=e.x+e.y*e.width;Sw(u,u+c.length,e.active.color,e.active.bg,e),$U(u,c,e)}}}function fi(n,e,t){const r=Hk(n);r.tokens&&(Nq(r.tokens,e),t&&Iq(e),e.changed())}function jee(n){const e=Hk(n);if(!e.tokens)return"";const t=e.tokens.filter(r=>{switch(r.tokenType){case tge:case FU:case jU:case zU:case VU:case HU:case GU:case qU:return!0;default:return!1}}).map(r=>r.image).join("");return t.trim().length===0?"":t}function Q1(n,e,t){const r=Hk(n);if(!r.tokens)return;const i=Tb(e,t,bn.WHITE,bn.BLACK);return i.measureonly=!0,Nq(r.tokens,i),i.x>0&&++i.y,i}function $U(n,e,t){let r=0;const i=n+e.length;for(let s=n;s<i;++s)t.char[s]=e.charCodeAt(r++);t.changed()}function Sw(n,e,t,r,i){const s=Math.min(n,e),a=Math.max(n,e);for(let o=s;o<=a;++o)i.color[o]=t,i.bg[o]=r;i.changed()}function A$e(n,e,t,r){const i=Math.min(n,e),s=Math.max(n,e);for(let a=i;a<=s;++a)r.bg[a]=t;r.changed()}function m0(n,e,t,r,i,s,a){const o=Math.min(t,r),l=Math.max(t,r);if(o>e||l<0)return;const c=Math.max(0,o),u=Math.min(e,l);Sw(n+c,n+u,i,s,a)}function Hee(n,e,t,r,i,s){const a=Math.min(t,r),o=Math.max(t,r);if(a>e||o<0)return;const l=Math.max(0,a),c=Math.min(e,o);A$e(n+l,n+c,i,s)}function Y9(n,e,t){const r=Fk(zU,n,0,0,0,0,0,0);Nq([r],e),t&&Iq(e),e.changed()}function Z0(n){const e=n.reset.leftedge??0,t=n.reset.rightedge??n.width-1,r=n.reset.topedge??0,i=n.reset.bottomedge??n.height-1,s=t-e+1,a=i-r+1;return{left:e,right:t,top:r,bottom:i,width:s,height:a}}function gN(n,e,t){if(!xe(Ce.element?.x)||!xe(Ce.element.y))return 0;if(Ce.elementisplayer){const o=Ce.board?.maxplayershots??0;if(o>0&&c$e(Ce.board).filter(c=>!c.removed&&R0(c.party)&&ji(c,"collision")===wr.ISBULLET).length>=o)return n.set("didshoot",0),n.yield(),0}const[r,i]=ln(e,0,[Pt.DIR,Pt.MAYBE_KIND]);Ce.element.shootx=Li(r.destpt.x-r.startpt.x,-1,1),Ce.element.shooty=Li(r.destpt.y-r.startpt.y,-1,1);const s=i??["bullet"],a=Qtt(Ce.board,s,{x:Ce.element.x,y:Ce.element.y});if(xe(a)){xe(t)&&(a.arg=t),a.cycle=1,a.party=Ce.elementid,a.collision=wr.ISBULLET,a.breakable=1,a.stepx=r.destpt.x-Ce.element.x,a.stepy=r.destpt.y-Ce.element.y,a.bg=bn.ONCLEAR;const o=U1(a),l=a.code??o?.code??"";snt(Ce.book,Ce.board,a,l)}return Ce.elementisplayer&&n.set("didshoot",xe(a)?1:0),n.yield(),0}function x2(n,e,t){if(!b1(Ce.element)||!xe(Ce.book)||!xe(Ce.board)||!xe(Ce.element))return 0;const[r,i]=ln(n,0,[Pt.DIR,Pt.KIND]);if(r.targets.length){for(let h=0;h<r.targets.length;++h){const g=r.targets[h];x2(["at",g.x,g.y,...i],e,t)}return 0}const{destpt:s}=r;if(s.x<0||s.x>=$n||s.y<0||s.y>=mi)return 0;const[a]=i,o={x:Ce.element?.x??0,y:Ce.element?.y??0},l=U1({kind:a}),c=ji(l,"collision");if(c===wr.ISGHOST)return F0(Ce.board,i,r.destpt,e),0;let u=Lo(Ce.board,r.destpt);if(ji(u,"pushable")){const h=El(r.destpt),g=hu(h,mv(o,h));kg(Ce.book,Ce.board,u,g),u=Lo(Ce.board,r.destpt)}if(a==="empty")return zg(Ce.board,u,Ce.timestamp),0;if(Gu(u)&&zg(Ce.board,u,Ce.timestamp),Gu(l)||F0(Ce.board,i,r.destpt,e),Gu(l)){const h=LU(Ce.board,c,r.destpt);if(!xe(h)){const g=F0(Ce.board,i,r.destpt,e);xe(g)&&xe(t)&&(g.arg=t)}}return 0}function _N(n,e,t){if(!xe(Ce.book)||!xe(Ce.board))return 1;const[r,i]=ln(e,0,[Pt.DIR,Pt.DIR]),s=Lo(Ce.board,r.destpt);if(xe(s)&&xe(s.kind)){const a=ji(s,"collision"),o=LU(Ce.board,a,i.destpt);if(xe(o))return 1;const l=F0(Ce.board,[s.kind],i.destpt);if(!xe(l))return 1;BE(l,s),xe(t)&&(l.arg=t)}else return 1;return 0}const C$e={x:0,y:0},M$e={x:$n-1,y:mi-1},O$e="all",k$e=bb().command("build",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board)||!xe(Ce.element))return 0;const[t,r]=ln(e,0,[Pt.NAME,Pt.MAYBE_STRING]),i=DU();if(xe(i)){if(Vn(r)){const s=Np(r);xe(s)&&BU(s.id,i.id,C$e,M$e,O$e)}n.set(t,i.id)}return 0}).command("goto",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.STRING]),[i,s]=ln(e,r,[Pt.MAYBE_NUMBER,Pt.MAYBE_NUMBER]),a=Np(t);if(!xe(a))return 0;const o={x:i??a.startx??Math.round($n*.5),y:s??a.starty??Math.round(mi*.5)},l=Gm(Ce.element);if(l.name!=="player"){const c=ji(Ce.element,"color"),u=ji(Ce.element,"bg"),f=pU(c,u),h=AL(a,[l.name,f]),[g]=h.sort((p,_)=>{const y=p.y??1e4,v=_.y??1e4,x=y-v;if(x!==0)return x;const E=p.x??1e4,M=_.x??1e4;return E-M});xe(g)&&Mn(g.x)&&Mn(g.y)&&(o.x=g.x,o.y=g.y)}return AT(Ce.book,Ce.elementfocus,a.id,o,!0),0}).command("transport",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board)||!xe(Ce.element))return 0;const[t]=ln(e,0,[Pt.STRING]),r=Fg(Ce.board,t);if(xe(Ce.element?.x)&&xe(Ce.element.y)&&xe(r?.x)&&xe(r.y)){let i=!0;const s={x:Ce.element.x,y:Ce.element.y},a=s.x-r.x,o=s.y-r.y;if(ji(Ce.element,"shootx")!==a||ji(Ce.element,"shooty")!==o)return 0;for(;i&&(s.x+=a,s.y+=o,!(s.x<0||s.x>=$n||s.y<0||s.y>=mi));){const l=Lo(Ce.board,s);l?.kind===Ce.element.kind&&ji(l,"shootx")===-a&&ji(l,"shooty")===-o&&kg(Ce.book,Ce.board,r,{x:s.x+a,y:s.y+o})&&(i=!1)}i&&kg(Ce.book,Ce.board,r,{x:Ce.element.x+a,y:Ce.element.y+o})}return 0}).command("shove",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.DIR,Pt.DIR]),i=Lo(Ce.board,t.destpt);if(Gu(i)){const s=t.destpt.x+(r.destpt.x-r.startpt.x),a=t.destpt.y+(r.destpt.y-r.startpt.y);kg(Ce.book,Ce.board,i,{x:s,y:a})}return 0}).command("push",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.DIR,Pt.DIR]),i=Lo(Ce.board,t.destpt);if(Gu(i)&&ji(i,"pushable")){const s=t.destpt.x+(r.destpt.x-r.startpt.x),a=t.destpt.y+(r.destpt.y-r.startpt.y);kg(Ce.book,Ce.board,i,{x:s,y:a})}return 0}).command("duplicate",_N).command("duplicatewith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return _N(e.slice(r),t)}).command("dupe",_N).command("dupewith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return _N(e.slice(r),t)}).command("write",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r,i]=ln(e,0,[Pt.DIR,Pt.COLOR]),s=e.slice(i).map(jc).join(" "),{color:a,bg:o}=Nfe(r),l=Q1(s,256,1)?.measuredwidth??1,c=Tb(256,1,a??bn.WHITE,o??bn.BLACK);fi(s,c,!1);const u=l-1;switch(mv(t.startpt,t.destpt)){case Hn.EAST:for(let h=0;h<l;++h)Ed(Ce.board,{x:t.destpt.x+h,y:t.destpt.y,name:"text",char:c.char[h],color:c.color[h],bg:c.bg[h]});break;case Hn.WEST:for(let h=0;h<l;++h)Ed(Ce.board,{x:t.destpt.x+h-u,y:t.destpt.y,name:"text",char:c.char[h],color:c.color[h],bg:c.bg[h]});break;case Hn.NORTH:for(let h=0;h<l;++h)Ed(Ce.board,{x:t.destpt.x,y:t.destpt.y+h-u,name:"text",char:c.char[h],color:c.color[h],bg:c.bg[h]});break;case Hn.SOUTH:for(let h=0;h<l;++h)Ed(Ce.board,{x:t.destpt.x,y:t.destpt.y+h,name:"text",char:c.char[h],color:c.color[h],bg:c.bg[h]});break}return 0}).command("change",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.KIND,Pt.KIND]);(TO(t)??"")==="empty"&&n$e(Ce.board).forEach(l=>{F0(Ce.board,r,l)});const s=TO(r),a=aL(r),o=Pfe(r);return AL(Ce.board,t).forEach(l=>{if(xe(a)&&(l.color=a),xe(o)&&(l.bg=o),Gm(l).name!==s){const u=ji(l,"color"),f=ji(l,"bg");if(zg(Ce.board,l,Ce.timestamp),s!=="empty"){const h={x:l.x??0,y:l.y??0},g=F0(Ce.board,r,h);xe(g)&&(g.color=u,g.bg=f)}}}),0}).command("put",(n,e)=>x2(e)).command("putwith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return x2(e.slice(r),void 0,t)}).command("oneof",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return xe(Ce.board)&&Fg(Ce.board,t)?0:x2(e.slice(r),t)}).command("oneofwith",(n,e)=>{const[t,r,i]=ln(e,0,[Pt.ANY,Pt.ANY]);return xe(Ce.board)&&Fg(Ce.board,r)?0:x2(e.slice(i),r,t)}).command("shoot",gN).command("shootwith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return gN(n,e.slice(r),t)}).command("throwstar",(n,e)=>gN(n,[...e,"star"])).command("throwstarwith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY]);return gN(n,[...e.slice(r),"star"],t)}),C_=()=>new Map,X9=n=>{const e=C_();return n.forEach((t,r)=>{e.set(r,t)}),e},eS=(n,e,t)=>{let r=n.get(e);return r===void 0&&n.set(e,r=t()),r},I$e=(n,e)=>{const t=[];for(const[r,i]of n)t.push(e(i,r));return t},N$e=(n,e)=>{for(const[t,r]of n)if(e(r,t))return!0;return!1},Ew=()=>new Set,e8=n=>n[n.length-1],P$e=(n,e)=>{for(let t=0;t<e.length;t++)n.push(e[t])},FE=Array.from,D$e=(n,e)=>{for(let t=0;t<n.length;t++)if(e(n[t],t,n))return!0;return!1},K9=Array.isArray;class rge{constructor(){this._observers=C_()}on(e,t){return eS(this._observers,e,Ew).add(t),t}once(e,t){const r=(...i)=>{this.off(e,r),t(...i)};this.on(e,r)}off(e,t){const r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return FE((this._observers.get(e)||C_()).values()).forEach(r=>r(...t))}destroy(){this._observers=C_()}}const D1=Math.floor,xP=Math.abs,ige=(n,e)=>n<e?n:e,cx=(n,e)=>n>e?n:e,sge=n=>n!==0?n<0:1/n<0,qee=1,Vee=2,t8=4,n8=8,zO=32,nb=64,jg=128,WU=31,Z9=63,_E=127,L$e=2147483647,age=Number.MAX_SAFE_INTEGER,U$e=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&D1(n)===n),B$e=n=>n.toLowerCase(),F$e=/^\s*/g,z$e=n=>n.replace(F$e,""),j$e=/([A-Z])/g,Gee=(n,e)=>z$e(n.replace(j$e,t=>`${e}${B$e(t)}`)),H$e=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.codePointAt(i);return r},jO=typeof TextEncoder<"u"?new TextEncoder:null,q$e=n=>jO.encode(n),V$e=jO?q$e:H$e;let V2=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});V2&&V2.decode(new Uint8Array).length===1&&(V2=null);class qk{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const YU=()=>new qk,G$e=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},Cv=n=>{const e=new Uint8Array(G$e(n));let t=0;for(let r=0;r<n.bufs.length;r++){const i=n.bufs[r];e.set(i,t),t+=i.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},$$e=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(cx(t,e)*2),n.cpos=0)},Ah=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},J9=Ah,za=(n,e)=>{for(;e>_E;)Ah(n,jg|_E&e),e=D1(e/128);Ah(n,_E&e)},Pq=(n,e)=>{const t=sge(e);for(t&&(e=-e),Ah(n,(e>Z9?jg:0)|(t?nb:0)|Z9&e),e=D1(e/64);e>0;)Ah(n,(e>_E?jg:0)|_E&e),e=D1(e/128)},Q9=new Uint8Array(3e4),W$e=Q9.length/3,Y$e=(n,e)=>{if(e.length<W$e){const t=jO.encodeInto(e,Q9).written||0;za(n,t);for(let r=0;r<t;r++)Ah(n,Q9[r])}else xg(n,V$e(e))},X$e=(n,e)=>{const t=unescape(encodeURIComponent(e)),r=t.length;za(n,r);for(let i=0;i<r;i++)Ah(n,t.codePointAt(i))},BT=jO&&jO.encodeInto?Y$e:X$e,XU=(n,e)=>{const t=n.cbuf.length,r=n.cpos,i=ige(t-r,e.length),s=e.length-i;n.cbuf.set(e.subarray(0,i),r),n.cpos+=i,s>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(cx(t*2,s)),n.cbuf.set(e.subarray(i)),n.cpos=s)},xg=(n,e)=>{za(n,e.byteLength),XU(n,e)},Dq=(n,e)=>{$$e(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},K$e=(n,e)=>Dq(n,4).setFloat32(0,e,!1),Z$e=(n,e)=>Dq(n,8).setFloat64(0,e,!1),J$e=(n,e)=>Dq(n,8).setBigInt64(0,e,!1),$ee=new DataView(new ArrayBuffer(4)),Q$e=n=>($ee.setFloat32(0,n),$ee.getFloat32(0)===n),HO=(n,e)=>{switch(typeof e){case"string":Ah(n,119),BT(n,e);break;case"number":U$e(e)&&xP(e)<=L$e?(Ah(n,125),Pq(n,e)):Q$e(e)?(Ah(n,124),K$e(n,e)):(Ah(n,123),Z$e(n,e));break;case"bigint":Ah(n,122),J$e(n,e);break;case"object":if(e===null)Ah(n,126);else if(K9(e)){Ah(n,117),za(n,e.length);for(let t=0;t<e.length;t++)HO(n,e[t])}else if(e instanceof Uint8Array)Ah(n,116),xg(n,e);else{Ah(n,118);const t=Object.keys(e);za(n,t.length);for(let r=0;r<t.length;r++){const i=t[r];BT(n,i),HO(n,e[i])}}break;case"boolean":Ah(n,e?120:121);break;default:Ah(n,127)}};class Wee extends qk{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&za(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Yee=n=>{n.count>0&&(Pq(n.encoder,n.count===1?n.s:-n.s),n.count>1&&za(n.encoder,n.count-2))};class TP{constructor(){this.encoder=new qk,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Yee(this),this.count=1,this.s=e)}toUint8Array(){return Yee(this),Cv(this.encoder)}}const Xee=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);Pq(n.encoder,e),n.count>1&&za(n.encoder,n.count-2)}};class r8{constructor(){this.encoder=new qk,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Xee(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Xee(this),Cv(this.encoder)}}class eWe{constructor(){this.sarr=[],this.s="",this.lensE=new TP}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new qk;return this.sarr.push(this.s),this.s="",BT(e,this.sarr.join("")),XU(e,this.lensE.toUint8Array()),Cv(e)}}const L1=n=>new Error(n),Dv=()=>{throw L1("Method unimplemented")},qv=()=>{throw L1("Unexpected case")},oge=L1("Unexpected end of array"),lge=L1("Integer out of Range");let KU=class{constructor(e){this.arr=e,this.pos=0}};const iR=n=>new KU(n),tWe=n=>n.pos!==n.arr.length,nWe=(n,e)=>{const t=new Uint8Array(n.arr.buffer,n.pos+n.arr.byteOffset,e);return n.pos+=e,t},Tg=n=>nWe(n,Ys(n)),xw=n=>n.arr[n.pos++],Ys=n=>{let e=0,t=1;const r=n.arr.length;for(;n.pos<r;){const i=n.arr[n.pos++];if(e=e+(i&_E)*t,t*=128,i<jg)return e;if(e>age)throw lge}throw oge},Lq=n=>{let e=n.arr[n.pos++],t=e&Z9,r=64;const i=(e&nb)>0?-1:1;if((e&jg)===0)return i*t;const s=n.arr.length;for(;n.pos<s;){if(e=n.arr[n.pos++],t=t+(e&_E)*r,r*=128,e<jg)return i*t;if(t>age)throw lge}throw oge},rWe=n=>{let e=Ys(n);if(e===0)return"";{let t=String.fromCodePoint(xw(n));if(--e<100)for(;e--;)t+=String.fromCodePoint(xw(n));else for(;e>0;){const r=e<1e4?e:1e4,i=n.arr.subarray(n.pos,n.pos+r);n.pos+=r,t+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(t))}},iWe=n=>V2.decode(Tg(n)),FT=V2?iWe:rWe,Uq=(n,e)=>{const t=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,e);return n.pos+=e,t},sWe=n=>Uq(n,4).getFloat32(0,!1),aWe=n=>Uq(n,8).getFloat64(0,!1),oWe=n=>Uq(n,8).getBigInt64(0,!1),lWe=[n=>{},n=>null,Lq,sWe,aWe,oWe,n=>!1,n=>!0,FT,n=>{const e=Ys(n),t={};for(let r=0;r<e;r++){const i=FT(n);t[i]=qO(n)}return t},n=>{const e=Ys(n),t=[];for(let r=0;r<e;r++)t.push(qO(n));return t},Tg],qO=n=>lWe[127-xw(n)](n);class Kee extends KU{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),tWe(this)?this.count=Ys(this)+1:this.count=-1),this.count--,this.s}}class wP extends KU{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Lq(this);const e=sge(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ys(this)+2)}return this.count--,this.s}}class i8 extends KU{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Lq(this),t=e&1;this.diff=D1(e/2),this.count=1,t&&(this.count=Ys(this)+2)}return this.s+=this.diff,this.count--,this.s}}class cWe{constructor(e){this.decoder=new wP(e),this.str=FT(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const uWe=crypto.getRandomValues.bind(crypto),cge=()=>uWe(new Uint32Array(1))[0],fWe="10000000-1000-4000-8000"+-1e11,hWe=()=>fWe.replace(/[018]/g,n=>(n^cge()&15>>n/4).toString(16)),dWe=Date.now,Zee=n=>new Promise(n);Promise.all.bind(Promise);const Jee=n=>n===void 0?null:n;class pWe{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let uge=new pWe,mWe=!0;try{typeof localStorage<"u"&&localStorage&&(uge=localStorage,mWe=!1)}catch{}const gWe=uge,_We=Object.assign,vWe=Object.keys,yWe=(n,e)=>{for(const t in n)e(n[t],t)},Qee=n=>vWe(n).length,bWe=n=>{for(const e in n)return!1;return!0},SWe=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},EWe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),xWe=(n,e)=>n===e||Qee(n)===Qee(e)&&SWe(n,(t,r)=>(t!==void 0||EWe(e,r))&&e[r]===t),TWe=Object.freeze,fge=n=>{for(const e in n){const t=n[e];(typeof t=="object"||typeof t=="function")&&fge(n[e])}return TWe(n)},Bq=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&Bq(n,e,t+1)}},wWe=n=>n,RWe=(n,e)=>e.includes(n);var hge={};const VO=typeof Tl<"u"&&Tl.release&&/node|io\.js/.test(Tl.release.name)&&Object.prototype.toString.call(typeof Tl<"u"?Tl:0)==="[object process]";let av;const AWe=()=>{if(av===void 0)if(VO){av=C_();const n=Tl.argv;let e=null;for(let t=0;t<n.length;t++){const r=n[t];r[0]==="-"?(e!==null&&av.set(e,""),e=r):e!==null&&(av.set(e,r),e=null)}e!==null&&av.set(e,"")}else typeof location=="object"?(av=C_(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");av.set(`--${Gee(e,"-")}`,t),av.set(`-${Gee(e,"-")}`,t)}})):av=C_();return av},ez=n=>AWe().has(n),ML=n=>Jee(VO?hge[n.toUpperCase().replaceAll("-","_")]:gWe.getItem(n)),dge=n=>ez("--"+n)||ML(n)!==null;dge("production");const CWe=VO&&RWe(hge.FORCE_COLOR,["true","1","2"]),MWe=CWe||!ez("--no-colors")&&!dge("no-color")&&(!VO||Tl.stdout.isTTY)&&(!VO||ez("--color")||ML("COLORTERM")!==null||(ML("TERM")||"").includes("color")),OWe=n=>new Uint8Array(n),kWe=n=>{const e=OWe(n.byteLength);return e.set(n),e};class IWe{constructor(e,t){this.left=e,this.right=t}}const Ay=(n,e)=>new IWe(n,e);typeof DOMParser<"u"&&new DOMParser;const NWe=n=>I$e(n,(e,t)=>`${t}:${e};`).join(""),wb=Symbol,pge=wb(),mge=wb(),PWe=wb(),DWe=wb(),LWe=wb(),gge=wb(),UWe=wb(),Fq=wb(),BWe=wb(),FWe=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[];let r=0;for(;r<n.length;r++){const i=n[r];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else if(i.constructor===Object)break}for(r>0&&t.push(e.join(""));r<n.length;r++){const i=n[r];i instanceof Symbol||t.push(i)}return t},zWe={[pge]:Ay("font-weight","bold"),[mge]:Ay("font-weight","normal"),[PWe]:Ay("color","blue"),[LWe]:Ay("color","green"),[DWe]:Ay("color","grey"),[gge]:Ay("color","red"),[UWe]:Ay("color","purple"),[Fq]:Ay("color","orange"),[BWe]:Ay("color","black")},jWe=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[],r=C_();let i=[],s=0;for(;s<n.length;s++){const a=n[s],o=zWe[a];if(o!==void 0)r.set(o.left,o.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const l=NWe(r);s>0||l.length>0?(e.push("%c"+a),t.push(l)):e.push(a)}else break}}for(s>0&&(i=t,i.unshift(e.join("")));s<n.length;s++){const a=n[s];a instanceof Symbol||i.push(a)}return i},_ge=MWe?jWe:FWe,HWe=(...n)=>{console.log(..._ge(n)),yge.forEach(e=>e.print(n))},vge=(...n)=>{console.warn(..._ge(n)),n.unshift(Fq),yge.forEach(e=>e.print(n))},yge=Ew(),bge=n=>({[Symbol.iterator](){return this},next:n}),qWe=(n,e)=>bge(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),s8=(n,e)=>bge(()=>{const{done:t,value:r}=n.next();return{done:t,value:t?void 0:e(r)}});class zq{constructor(e,t){this.clock=e,this.len=t}}class sR{constructor(){this.clients=new Map}}const Tw=(n,e,t)=>e.clients.forEach((r,i)=>{const s=n.doc.store.clients.get(i);if(s!=null){const a=s[s.length-1],o=a.id.clock+a.length;for(let l=0,c=r[l];l<r.length&&c.clock<o;c=r[++l])Mge(n,s,c.clock,c.len,t)}}),VWe=(n,e)=>{let t=0,r=n.length-1;for(;t<=r;){const i=D1((t+r)/2),s=n[i],a=s.clock;if(a<=e){if(e<a+s.len)return i;t=i+1}else r=i-1}return null},Vk=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&VWe(t,e.clock)!==null},jq=n=>{n.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let t,r;for(t=1,r=1;t<e.length;t++){const i=e[r-1],s=e[t];i.clock+i.len>=s.clock?i.len=cx(i.len,s.clock+s.len-i.clock):(r<t&&(e[r]=s),r++)}e.length=r})},tz=n=>{const e=new sR;for(let t=0;t<n.length;t++)n[t].clients.forEach((r,i)=>{if(!e.clients.has(i)){const s=r.slice();for(let a=t+1;a<n.length;a++)P$e(s,n[a].clients.get(i)||[]);e.clients.set(i,s)}});return jq(e),e},GO=(n,e,t,r)=>{eS(n.clients,e,()=>[]).push(new zq(t,r))},GWe=()=>new sR,$We=n=>{const e=GWe();return n.clients.forEach((t,r)=>{const i=[];for(let s=0;s<t.length;s++){const a=t[s];if(a.deleted){const o=a.id.clock;let l=a.length;if(s+1<t.length)for(let c=t[s+1];s+1<t.length&&c.deleted;c=t[++s+1])l+=c.length;i.push(new zq(o,l))}}i.length>0&&e.clients.set(r,i)}),e},aR=(n,e)=>{za(n.restEncoder,e.clients.size),FE(e.clients.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{n.resetDsCurVal(),za(n.restEncoder,t);const i=r.length;za(n.restEncoder,i);for(let s=0;s<i;s++){const a=r[s];n.writeDsClock(a.clock),n.writeDsLen(a.len)}})},Hq=n=>{const e=new sR,t=Ys(n.restDecoder);for(let r=0;r<t;r++){n.resetDsCurVal();const i=Ys(n.restDecoder),s=Ys(n.restDecoder);if(s>0){const a=eS(e.clients,i,()=>[]);for(let o=0;o<s;o++)a.push(new zq(n.readDsClock(),n.readDsLen()))}}return e},ete=(n,e,t)=>{const r=new sR,i=Ys(n.restDecoder);for(let s=0;s<i;s++){n.resetDsCurVal();const a=Ys(n.restDecoder),o=Ys(n.restDecoder),l=t.clients.get(a)||[],c=Kf(t,a);for(let u=0;u<o;u++){const f=n.readDsClock(),h=f+n.readDsLen();if(f<c){c<h&&GO(r,a,c,h-c);let g=Vv(l,f),p=l[g];for(!p.deleted&&p.id.clock<f&&(l.splice(g+1,0,UL(e,p,f-p.id.clock)),g++);g<l.length&&(p=l[g++],p.id.clock<h);)p.deleted||(h<p.id.clock+p.length&&l.splice(g,0,UL(e,p,h-p.id.clock)),p.delete(e))}else GO(r,a,f,h-f)}}if(r.clients.size>0){const s=new zE;return za(s.restEncoder,0),aR(s,r),s.toUint8Array()}return null},Sge=cge;class ux extends rge{constructor({guid:e=hWe(),collectionid:t=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=Sge(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Age,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Zee(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>Zee(c=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),c())};this.on("sync",u)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&xl(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(FE(this.subdocs).map(e=>e.guid))}transact(e,t=null){return xl(this,e,t)}get(e,t=Ph){const r=eS(this.share,e,()=>{const s=new t;return s._integrate(this,null),s}),i=r.constructor;if(t!==Ph&&i!==t)if(i===Ph){const s=new t;s._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=r._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,jT)}getText(e=""){return this.get(e,Gv)}getMap(e=""){return this.get(e,Rw)}getXmlElement(e=""){return this.get(e,Aw)}getXmlFragment(e=""){return this.get(e,jE)}toJSON(){const e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,FE(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new ux({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,xl(e.parent.doc,r=>{const i=t.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Ege{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ys(this.restDecoder)}readDsLen(){return Ys(this.restDecoder)}}class xge extends Ege{readLeftID(){return Xs(Ys(this.restDecoder),Ys(this.restDecoder))}readRightID(){return Xs(Ys(this.restDecoder),Ys(this.restDecoder))}readClient(){return Ys(this.restDecoder)}readInfo(){return xw(this.restDecoder)}readString(){return FT(this.restDecoder)}readParentInfo(){return Ys(this.restDecoder)===1}readTypeRef(){return Ys(this.restDecoder)}readLen(){return Ys(this.restDecoder)}readAny(){return qO(this.restDecoder)}readBuf(){return kWe(Tg(this.restDecoder))}readJSON(){return JSON.parse(FT(this.restDecoder))}readKey(){return FT(this.restDecoder)}}class WWe{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ys(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ys(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class ww extends WWe{constructor(e){super(e),this.keys=[],Ys(e),this.keyClockDecoder=new i8(Tg(e)),this.clientDecoder=new wP(Tg(e)),this.leftClockDecoder=new i8(Tg(e)),this.rightClockDecoder=new i8(Tg(e)),this.infoDecoder=new Kee(Tg(e),xw),this.stringDecoder=new cWe(Tg(e)),this.parentInfoDecoder=new Kee(Tg(e),xw),this.typeRefDecoder=new wP(Tg(e)),this.lenDecoder=new wP(Tg(e))}readLeftID(){return new zT(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new zT(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return qO(this.restDecoder)}readBuf(){return Tg(this.restDecoder)}readJSON(){return qO(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class YWe{constructor(){this.restEncoder=YU()}toUint8Array(){return Cv(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){za(this.restEncoder,e)}writeDsLen(e){za(this.restEncoder,e)}}class Gk extends YWe{writeLeftID(e){za(this.restEncoder,e.client),za(this.restEncoder,e.clock)}writeRightID(e){za(this.restEncoder,e.client),za(this.restEncoder,e.clock)}writeClient(e){za(this.restEncoder,e)}writeInfo(e){J9(this.restEncoder,e)}writeString(e){BT(this.restEncoder,e)}writeParentInfo(e){za(this.restEncoder,e?1:0)}writeTypeRef(e){za(this.restEncoder,e)}writeLen(e){za(this.restEncoder,e)}writeAny(e){HO(this.restEncoder,e)}writeBuf(e){xg(this.restEncoder,e)}writeJSON(e){BT(this.restEncoder,JSON.stringify(e))}writeKey(e){BT(this.restEncoder,e)}}class XWe{constructor(){this.restEncoder=YU(),this.dsCurrVal=0}toUint8Array(){return Cv(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,za(this.restEncoder,t)}writeDsLen(e){e===0&&qv(),za(this.restEncoder,e-1),this.dsCurrVal+=e}}class zE extends XWe{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new r8,this.clientEncoder=new TP,this.leftClockEncoder=new r8,this.rightClockEncoder=new r8,this.infoEncoder=new Wee(J9),this.stringEncoder=new eWe,this.parentInfoEncoder=new Wee(J9),this.typeRefEncoder=new TP,this.lenEncoder=new TP}toUint8Array(){const e=YU();return za(e,0),xg(e,this.keyClockEncoder.toUint8Array()),xg(e,this.clientEncoder.toUint8Array()),xg(e,this.leftClockEncoder.toUint8Array()),xg(e,this.rightClockEncoder.toUint8Array()),xg(e,Cv(this.infoEncoder)),xg(e,this.stringEncoder.toUint8Array()),xg(e,Cv(this.parentInfoEncoder)),xg(e,this.typeRefEncoder.toUint8Array()),xg(e,this.lenEncoder.toUint8Array()),XU(e,Cv(this.restEncoder)),Cv(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){HO(this.restEncoder,e)}writeBuf(e){xg(this.restEncoder,e)}writeJSON(e){HO(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const KWe=(n,e,t,r)=>{r=cx(r,e[0].id.clock);const i=Vv(e,r);za(n.restEncoder,e.length-i),n.writeClient(t),za(n.restEncoder,r);const s=e[i];s.write(n,r-s.id.clock);for(let a=i+1;a<e.length;a++)e[a].write(n,0)},qq=(n,e,t)=>{const r=new Map;t.forEach((i,s)=>{Kf(e,s)>i&&r.set(s,i)}),Vq(e).forEach((i,s)=>{t.has(s)||r.set(s,0)}),za(n.restEncoder,r.size),FE(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{KWe(n,e.clients.get(i),i,s)})},ZWe=(n,e)=>{const t=C_(),r=Ys(n.restDecoder);for(let i=0;i<r;i++){const s=Ys(n.restDecoder),a=new Array(s),o=n.readClient();let l=Ys(n.restDecoder);t.set(o,{i:0,refs:a});for(let c=0;c<s;c++){const u=n.readInfo();switch(WU&u){case 0:{const f=n.readLen();a[c]=new C0(Xs(o,l),f),l+=f;break}case 10:{const f=Ys(n.restDecoder);a[c]=new M0(Xs(o,l),f),l+=f;break}default:{const f=(u&(nb|jg))===0,h=new ac(Xs(o,l),null,(u&jg)===jg?n.readLeftID():null,null,(u&nb)===nb?n.readRightID():null,f?n.readParentInfo()?e.get(n.readString()):n.readLeftID():null,f&&(u&zO)===zO?n.readString():null,Xge(n,u));a[c]=h,l+=h.length}}}}return t},JWe=(n,e,t)=>{const r=[];let i=FE(t.keys()).sort((g,p)=>g-p);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let g=t.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=t.get(i[i.length-1]);else return null;return g};let a=s();if(a===null)return null;const o=new Age,l=new Map,c=(g,p)=>{const _=l.get(g);(_==null||_>p)&&l.set(g,p)};let u=a.refs[a.i++];const f=new Map,h=()=>{for(const g of r){const p=g.id.client,_=t.get(p);_?(_.i--,o.clients.set(p,_.refs.slice(_.i)),t.delete(p),_.i=0,_.refs=[]):o.clients.set(p,[g]),i=i.filter(y=>y!==p)}r.length=0};for(;;){if(u.constructor!==M0){const p=eS(f,u.id.client,()=>Kf(e,u.id.client))-u.id.clock;if(p<0)r.push(u),c(u.id.client,u.id.clock-1),h();else{const _=u.getMissing(n,e);if(_!==null){r.push(u);const y=t.get(_)||{refs:[],i:0};if(y.refs.length===y.i)c(_,Kf(e,_)),h();else{u=y.refs[y.i++];continue}}else(p===0||p<u.length)&&(u.integrate(n,p),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(o.clients.size>0){const g=new zE;return qq(g,o,new Map),za(g.restEncoder,0),{missing:l,update:g.toUint8Array()}}return null},QWe=(n,e)=>qq(n,e.doc.store,e.beforeState),eYe=(n,e,t,r=new ww(n))=>xl(e,i=>{i.local=!1;let s=!1;const a=i.doc,o=a.store,l=ZWe(r,a),c=JWe(i,o,l),u=o.pendingStructs;if(u){for(const[h,g]of u.missing)if(g<Kf(o,h)){s=!0;break}if(c){for(const[h,g]of c.missing){const p=u.missing.get(h);(p==null||p>g)&&u.missing.set(h,g)}u.update=kL([u.update,c.update])}}else o.pendingStructs=c;const f=ete(r,i,o);if(o.pendingDs){const h=new ww(iR(o.pendingDs));Ys(h.restDecoder);const g=ete(h,i,o);f&&g?o.pendingDs=kL([f,g]):o.pendingDs=f||g}else o.pendingDs=f;if(s){const h=o.pendingStructs.update;o.pendingStructs=null,Tge(i.doc,h)}},t,!1),Tge=(n,e,t,r=ww)=>{const i=iR(e);eYe(i,n,t,new r(i))},tte=(n,e,t)=>Tge(n,e,t,xge),tYe=(n,e,t=new Map)=>{qq(n,e.store,t),aR(n,$We(e.store))},nYe=(n,e=new Uint8Array([0]),t=new zE)=>{const r=wge(e);tYe(t,n,r);const i=[t.toUint8Array()];if(n.store.pendingDs&&i.push(n.store.pendingDs),n.store.pendingStructs&&i.push(_Ye(n.store.pendingStructs.update,e)),i.length>1){if(t.constructor===Gk)return mYe(i.map((s,a)=>a===0?s:yYe(s)));if(t.constructor===zE)return kL(i)}return i[0]},rYe=(n,e)=>nYe(n,e,new Gk),iYe=n=>{const e=new Map,t=Ys(n.restDecoder);for(let r=0;r<t;r++){const i=Ys(n.restDecoder),s=Ys(n.restDecoder);e.set(i,s)}return e},wge=n=>iYe(new Ege(iR(n)));class sYe{constructor(){this.l=[]}}const nte=()=>new sYe,rte=(n,e)=>n.l.push(e),ite=(n,e)=>{const t=n.l,r=t.length;n.l=t.filter(i=>e!==i),r===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Rge=(n,e,t)=>Bq(n.l,[e,t]);class zT{constructor(e,t){this.client=e,this.clock=t}}const vN=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,Xs=(n,e)=>new zT(n,e),aYe=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw qv()},OL=(n,e)=>{for(;e!==null;){if(e.parent===n)return!0;e=e.parent._item}return!1},hT=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!Vk(e.ds,n.id),nz=(n,e)=>{const t=eS(n.meta,nz,Ew),r=n.doc.store;t.has(e)||(e.sv.forEach((i,s)=>{i<Kf(r,s)&&Am(n,Xs(s,i))}),Tw(n,e.ds,i=>{}),t.add(e))};class Age{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Vq=n=>{const e=new Map;return n.clients.forEach((t,r)=>{const i=t[t.length-1];e.set(r,i.id.clock+i.length)}),e},Kf=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const r=t[t.length-1];return r.id.clock+r.length},Cge=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const r=t[t.length-1];if(r.id.clock+r.length!==e.id.clock)throw qv()}t.push(e)},Vv=(n,e)=>{let t=0,r=n.length-1,i=n[r],s=i.id.clock;if(s===e)return r;let a=D1(e/(s+i.length-1)*r);for(;t<=r;){if(i=n[a],s=i.id.clock,s<=e){if(e<s+i.length)return a;t=a+1}else r=a-1;a=D1((t+r)/2)}throw qv()},oYe=(n,e)=>{const t=n.clients.get(e.client);return t[Vv(t,e.clock)]},RP=oYe,rz=(n,e,t)=>{const r=Vv(e,t),i=e[r];return i.id.clock<t&&i instanceof ac?(e.splice(r+1,0,UL(n,i,t-i.id.clock)),r+1):r},Am=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[rz(n,t,e.clock)]},ste=(n,e,t)=>{const r=e.clients.get(t.client),i=Vv(r,t.clock),s=r[i];return t.clock!==s.id.clock+s.length-1&&s.constructor!==C0&&r.splice(i+1,0,UL(n,s,t.clock-s.id.clock+1)),s},lYe=(n,e,t)=>{const r=n.clients.get(e.id.client);r[Vv(r,e.id.clock)]=t},Mge=(n,e,t,r,i)=>{if(r===0)return;const s=t+r;let a=rz(n,e,t),o;do o=e[a++],s<o.id.clock+o.length&&rz(n,e,s),i(o);while(a<e.length&&e[a].id.clock<s)};class cYe{constructor(e,t,r){this.doc=e,this.deleteSet=new sR,this.beforeState=Vq(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const ate=(n,e)=>e.deleteSet.clients.size===0&&!N$e(e.afterState,(t,r)=>e.beforeState.get(r)!==t)?!1:(jq(e.deleteSet),QWe(n,e),aR(n,e.deleteSet),!0),ote=(n,e,t)=>{const r=e._item;(r===null||r.id.clock<(n.beforeState.get(r.id.client)||0)&&!r.deleted)&&eS(n.changed,e,Ew).add(t)},AP=(n,e)=>{let t=n[e],r=n[e-1],i=e;for(;i>0;t=r,r=n[--i-1]){if(r.deleted===t.deleted&&r.constructor===t.constructor&&r.mergeWith(t)){t instanceof ac&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,r);continue}break}const s=e-i;return s&&n.splice(e+1-s,s),s},uYe=(n,e,t)=>{for(const[r,i]of n.clients.entries()){const s=e.clients.get(r);for(let a=i.length-1;a>=0;a--){const o=i[a],l=o.clock+o.len;for(let c=Vv(s,o.clock),u=s[c];c<s.length&&u.id.clock<l;u=s[++c]){const f=s[c];if(o.clock+o.len<=f.id.clock)break;f instanceof ac&&f.deleted&&!f.keep&&t(f)&&f.gc(e,!1)}}}},fYe=(n,e)=>{n.clients.forEach((t,r)=>{const i=e.clients.get(r);for(let s=t.length-1;s>=0;s--){const a=t[s],o=ige(i.length-1,1+Vv(i,a.clock+a.len-1));for(let l=o,c=i[l];l>0&&c.id.clock>=a.clock;c=i[l])l-=1+AP(i,l)}})},Oge=(n,e)=>{if(e<n.length){const t=n[e],r=t.doc,i=r.store,s=t.deleteSet,a=t._mergeStructs;try{jq(s),t.afterState=Vq(t.doc.store),r.emit("beforeObserverCalls",[t,r]);const o=[];t.changed.forEach((l,c)=>o.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(t,l)})),o.push(()=>{t.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(u=>u.target._item===null||!u.target._item.deleted),l.forEach(u=>{u.currentTarget=c,u._path=null}),l.sort((u,f)=>u.path.length-f.path.length),Rge(c._dEH,l,t))})}),o.push(()=>r.emit("afterTransaction",[t,r])),Bq(o,[]),t._needFormattingCleanup&&NYe(t)}finally{r.gc&&uYe(s,i,r.gcFilter),fYe(s,i),t.afterState.forEach((u,f)=>{const h=t.beforeState.get(f)||0;if(h!==u){const g=i.clients.get(f),p=cx(Vv(g,h),1);for(let _=g.length-1;_>=p;)_-=1+AP(g,_)}});for(let u=a.length-1;u>=0;u--){const{client:f,clock:h}=a[u].id,g=i.clients.get(f),p=Vv(g,h);p+1<g.length&&AP(g,p+1)>1||p>0&&AP(g,p)}if(!t.local&&t.afterState.get(r.clientID)!==t.beforeState.get(r.clientID)&&(HWe(Fq,pge,"[yjs] ",mge,gge,"Changed the client-id because another client seems to be using it."),r.clientID=Sge()),r.emit("afterTransactionCleanup",[t,r]),r._observers.has("update")){const u=new Gk;ate(u,t)&&r.emit("update",[u.toUint8Array(),t.origin,r,t])}if(r._observers.has("updateV2")){const u=new zE;ate(u,t)&&r.emit("updateV2",[u.toUint8Array(),t.origin,r,t])}const{subdocsAdded:o,subdocsLoaded:l,subdocsRemoved:c}=t;(o.size>0||c.size>0||l.size>0)&&(o.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),c.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:l,added:o,removed:c},r,t]),c.forEach(u=>u.destroy())),n.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,n])):Oge(n,e+1)}}},xl=(n,e,t=null,r=!0)=>{const i=n._transactionCleanups;let s=!1,a=null;n._transaction===null&&(s=!0,n._transaction=new cYe(n,t,r),i.push(n._transaction),i.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{a=e(n._transaction)}finally{if(s){const o=n._transaction===i[0];n._transaction=null,o&&Oge(i,0)}}return a};class hYe{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const lte=(n,e,t)=>{Tw(n,t.deletions,r=>{r instanceof ac&&e.scope.some(i=>i===n.doc||OL(i,r))&&Jq(r,!1)})},cte=(n,e,t)=>{let r=null;const i=n.doc,s=n.scope;xl(i,o=>{for(;e.length>0&&n.currStackItem===null;){const l=i.store,c=e.pop(),u=new Set,f=[];let h=!1;Tw(o,c.insertions,g=>{if(g instanceof ac){if(g.redone!==null){let{item:p,diff:_}=aXe(l,g.id);_>0&&(p=Am(o,Xs(p.id.client,p.id.clock+_))),g=p}!g.deleted&&s.some(p=>p===o.doc||OL(p,g))&&f.push(g)}}),Tw(o,c.deletions,g=>{g instanceof ac&&s.some(p=>p===o.doc||OL(p,g))&&!Vk(c.insertions,g.id)&&u.add(g)}),u.forEach(g=>{h=Yge(o,g,u,c.insertions,n.ignoreRemoteMapChanges,n)!==null||h});for(let g=f.length-1;g>=0;g--){const p=f[g];n.deleteFilter(p)&&(p.delete(o),h=!0)}n.currStackItem=h?c:null}o.changed.forEach((l,c)=>{l.has(null)&&c._searchMarker&&(c._searchMarker.length=0)}),r=o},n);const a=n.currStackItem;if(a!=null){const o=r.changedParentTypes;n.emit("stack-item-popped",[{stackItem:a,type:t,changedParentTypes:o,origin:n},n]),n.currStackItem=null}return a};class dYe extends rge{constructor(e,{captureTimeout:t=500,captureTransaction:r=l=>!0,deleteFilter:i=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:o=K9(e)?e[0].doc:e instanceof ux?e:e.doc}={}){super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=t,this.afterTransactionHandler=l=>{if(!this.captureTransaction(l)||!this.scope.some(y=>l.changedParentTypes.has(y)||y===this.doc)||!this.trackedOrigins.has(l.origin)&&(!l.origin||!this.trackedOrigins.has(l.origin.constructor)))return;const c=this.undoing,u=this.redoing,f=c?this.redoStack:this.undoStack;c?this.stopCapturing():u||this.clear(!1,!0);const h=new sR;l.afterState.forEach((y,v)=>{const x=l.beforeState.get(v)||0,E=y-x;E>0&&GO(h,v,x,E)});const g=dWe();let p=!1;if(this.lastChange>0&&g-this.lastChange<this.captureTimeout&&f.length>0&&!c&&!u){const y=f[f.length-1];y.deletions=tz([y.deletions,l.deleteSet]),y.insertions=tz([y.insertions,h])}else f.push(new hYe(l.deleteSet,h)),p=!0;!c&&!u&&(this.lastChange=g),Tw(l,l.deleteSet,y=>{y instanceof ac&&this.scope.some(v=>v===l.doc||OL(v,y))&&Jq(y,!0)});const _=[{stackItem:f[f.length-1],origin:l.origin,type:c?"redo":"undo",changedParentTypes:l.changedParentTypes},this];p?this.emit("stack-item-added",_):this.emit("stack-item-updated",_)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);e=K9(e)?e:[e],e.forEach(r=>{t.has(r)||(t.add(r),(r instanceof Ph?r.doc!==this.doc:r!==this.doc)&&vge("[yjs#509] Not same Y.Doc"),this.scope.push(r))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(i=>lte(r,this,i)),this.undoStack=[]),t&&(this.redoStack.forEach(i=>lte(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=cte(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=cte(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*pYe(n){const e=Ys(n.restDecoder);for(let t=0;t<e;t++){const r=Ys(n.restDecoder),i=n.readClient();let s=Ys(n.restDecoder);for(let a=0;a<r;a++){const o=n.readInfo();if(o===10){const l=Ys(n.restDecoder);yield new M0(Xs(i,s),l),s+=l}else if((WU&o)!==0){const l=(o&(nb|jg))===0,c=new ac(Xs(i,s),null,(o&jg)===jg?n.readLeftID():null,null,(o&nb)===nb?n.readRightID():null,l?n.readParentInfo()?n.readString():n.readLeftID():null,l&&(o&zO)===zO?n.readString():null,Xge(n,o));yield c,s+=c.length}else{const l=n.readLen();yield new C0(Xs(i,s),l),s+=l}}}}class Gq{constructor(e,t){this.gen=pYe(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===M0);return this.curr}}class $q{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const mYe=n=>kL(n,xge,Gk),gYe=(n,e)=>{if(n.constructor===C0){const{client:t,clock:r}=n.id;return new C0(Xs(t,r+e),n.length-e)}else if(n.constructor===M0){const{client:t,clock:r}=n.id;return new M0(Xs(t,r+e),n.length-e)}else{const t=n,{client:r,clock:i}=t.id;return new ac(Xs(r,i+e),null,Xs(r,i+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},kL=(n,e=ww,t=zE)=>{if(n.length===1)return n[0];const r=n.map(u=>new e(iR(u)));let i=r.map(u=>new Gq(u,!0)),s=null;const a=new t,o=new $q(a);for(;i=i.filter(h=>h.curr!==null),i.sort((h,g)=>{if(h.curr.id.client===g.curr.id.client){const p=h.curr.id.clock-g.curr.id.clock;return p===0?h.curr.constructor===g.curr.constructor?0:h.curr.constructor===M0?1:-1:p}else return g.curr.id.client-h.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let h=u.curr,g=!1;for(;h!==null&&h.id.clock+h.length<=s.struct.id.clock+s.struct.length&&h.id.client>=s.struct.id.client;)h=u.next(),g=!0;if(h===null||h.id.client!==f||g&&h.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)f1(o,s.struct,s.offset),s={struct:h,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<h.id.clock)if(s.struct.constructor===M0)s.struct.length=h.id.clock+h.length-s.struct.id.clock;else{f1(o,s.struct,s.offset);const p=h.id.clock-s.struct.id.clock-s.struct.length;s={struct:new M0(Xs(f,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-h.id.clock;p>0&&(s.struct.constructor===M0?s.struct.length-=p:h=gYe(h,p)),s.struct.mergeWith(h)||(f1(o,s.struct,s.offset),s={struct:h,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let h=u.curr;h!==null&&h.id.client===f&&h.id.clock===s.struct.id.clock+s.struct.length&&h.constructor!==M0;h=u.next())f1(o,s.struct,s.offset),s={struct:h,offset:0}}s!==null&&(f1(o,s.struct,s.offset),s=null),Wq(o);const l=r.map(u=>Hq(u)),c=tz(l);return aR(a,c),a.toUint8Array()},_Ye=(n,e,t=ww,r=zE)=>{const i=wge(e),s=new r,a=new $q(s),o=new t(iR(n)),l=new Gq(o,!1);for(;l.curr;){const u=l.curr,f=u.id.client,h=i.get(f)||0;if(l.curr.constructor===M0){l.next();continue}if(u.id.clock+u.length>h)for(f1(a,u,cx(h-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===f;)f1(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===f&&l.curr.id.clock+l.curr.length<=h;)l.next()}Wq(a);const c=Hq(o);return aR(s,c),s.toUint8Array()},kge=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:Cv(n.encoder.restEncoder)}),n.encoder.restEncoder=YU(),n.written=0)},f1=(n,e,t)=>{n.written>0&&n.currClient!==e.id.client&&kge(n),n.written===0&&(n.currClient=e.id.client,n.encoder.writeClient(e.id.client),za(n.encoder.restEncoder,e.id.clock+t)),e.write(n.encoder,t),n.written++},Wq=n=>{kge(n);const e=n.encoder.restEncoder;za(e,n.clientStructs.length);for(let t=0;t<n.clientStructs.length;t++){const r=n.clientStructs[t];za(e,r.written),XU(e,r.restEncoder)}},vYe=(n,e,t,r)=>{const i=new t(iR(n)),s=new Gq(i,!1),a=new r,o=new $q(a);for(let c=s.curr;c!==null;c=s.next())f1(o,e(c),0);Wq(o);const l=Hq(i);return aR(a,l),a.toUint8Array()},yYe=n=>vYe(n,wWe,ww,Gk),ute="You must not compute changes after the event-handler fired.";class ZU{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=bYe(this.currentTarget,this.target))}deletes(e){return Vk(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw L1(ute);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(i=>{if(i!==null){const s=t._map.get(i);let a,o;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))a="delete",o=e8(l.content.getContent());else return;else l!==null&&this.deletes(l)?(a="update",o=e8(l.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=e8(s.content.getContent());else return;e.set(i,{action:a,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw L1(ute);const t=this.target,r=Ew(),i=Ew(),s=[];if(e={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let o=null;const l=()=>{o&&s.push(o)};for(let c=t._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((o===null||o.delete===void 0)&&(l(),o={delete:0}),o.delete+=c.length,i.add(c)):this.adds(c)?((o===null||o.insert===void 0)&&(l(),o={insert:[]}),o.insert=o.insert.concat(c.content.getContent()),r.add(c)):((o===null||o.retain===void 0)&&(l(),o={retain:0}),o.retain+=c.length);o!==null&&o.retain===void 0&&l()}this._changes=e}return e}}const bYe=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;t.unshift(r)}e=e._item.parent}return t},ep=()=>{vge("Invalid access: Add Yjs type to a document before reading data.")},Ige=80;let Yq=0;class SYe{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Yq++}}const EYe=n=>{n.timestamp=Yq++},Nge=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=Yq++},xYe=(n,e,t)=>{if(n.length>=Ige){const r=n.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Nge(r,e,t),r}else{const r=new SYe(e,t);return n.push(r),r}},JU=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((s,a)=>xP(e-s.index)<xP(e-a.index)?s:a);let r=n._start,i=0;for(t!==null&&(r=t.p,i=t.index,EYe(t));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return t!==null&&xP(t.index-i)<r.parent.length/Ige?(Nge(t,r,i),t):xYe(n._searchMarker,r,i)},$O=(n,e,t)=>{for(let r=n.length-1;r>=0;r--){const i=n[r];if(t>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){n.splice(r,1);continue}i.p=s,s.marker=!0}(e<i.index||t>0&&e===i.index)&&(i.index=cx(e,i.index+t))}},QU=(n,e,t)=>{const r=n,i=e.changedParentTypes;for(;eS(i,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;Rge(r._eH,t,e)};class Ph{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=nte(),this._dEH=nte(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw Dv()}clone(){throw Dv()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){rte(this._eH,e)}observeDeep(e){rte(this._dEH,e)}unobserve(e){ite(this._eH,e)}unobserveDeep(e){ite(this._dEH,e)}toJSON(){}}const Pge=(n,e,t)=>{n.doc??ep(),e<0&&(e=n._length+e),t<0&&(t=n._length+t);let r=t-e;const i=[];let s=n._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let o=e;o<a.length&&r>0;o++)i.push(a[o]),r--;e=0}}s=s.right}return i},Dge=n=>{n.doc??ep();const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const r=t.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}t=t.right}return e},WO=(n,e)=>{let t=0,r=n._start;for(n.doc??ep();r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)e(i[s],t++,n)}r=r.right}},Lge=(n,e)=>{const t=[];return WO(n,(r,i)=>{t.push(e(r,i,n))}),t},TYe=n=>{let e=n._start,t=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),r=0,e=e.right}const i=t[r++];return t.length<=r&&(t=null),{done:!1,value:i}}}},Uge=(n,e)=>{n.doc??ep();const t=JU(n,e);let r=n._start;for(t!==null&&(r=t.p,e-=t.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},IL=(n,e,t,r)=>{let i=t;const s=n.doc,a=s.clientID,o=s.store,l=t===null?e._start:t.right;let c=[];const u=()=>{c.length>0&&(i=new ac(Xs(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new HE(c)),i.integrate(n,0),c=[])};r.forEach(f=>{if(f===null)c.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new ac(Xs(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new $k(new Uint8Array(f))),i.integrate(n,0);break;case ux:i=new ac(Xs(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new Wk(f)),i.integrate(n,0);break;default:if(f instanceof Ph)i=new ac(Xs(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new Rb(f)),i.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Bge=()=>L1("Length exceeded!"),Fge=(n,e,t,r)=>{if(t>e._length)throw Bge();if(t===0)return e._searchMarker&&$O(e._searchMarker,t,r.length),IL(n,e,null,r);const i=t,s=JU(e,t);let a=e._start;for(s!==null&&(a=s.p,t-=s.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&Am(n,Xs(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&$O(e._searchMarker,i,r.length),IL(n,e,a,r)},wYe=(n,e,t)=>{let i=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return IL(n,e,i,t)},zge=(n,e,t,r)=>{if(r===0)return;const i=t,s=r,a=JU(e,t);let o=e._start;for(a!==null&&(o=a.p,t-=a.index);o!==null&&t>0;o=o.right)!o.deleted&&o.countable&&(t<o.length&&Am(n,Xs(o.id.client,o.id.clock+t)),t-=o.length);for(;r>0&&o!==null;)o.deleted||(r<o.length&&Am(n,Xs(o.id.client,o.id.clock+r)),o.delete(n),r-=o.length),o=o.right;if(r>0)throw Bge();e._searchMarker&&$O(e._searchMarker,i,-s+r)},NL=(n,e,t)=>{const r=e._map.get(t);r!==void 0&&r.delete(n)},Xq=(n,e,t,r)=>{const i=e._map.get(t)||null,s=n.doc,a=s.clientID;let o;if(r==null)o=new HE([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:o=new HE([r]);break;case Uint8Array:o=new $k(r);break;case ux:o=new Wk(r);break;default:if(r instanceof Ph)o=new Rb(r);else throw new Error("Unexpected content type")}new ac(Xs(a,Kf(s.store,a)),i,i&&i.lastId,null,null,e,t,o).integrate(n,0)},Kq=(n,e)=>{n.doc??ep();const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},jge=n=>{const e={};return n.doc??ep(),n._map.forEach((t,r)=>{t.deleted||(e[r]=t.content.getContent()[t.length-1])}),e},Hge=(n,e)=>{n.doc??ep();const t=n._map.get(e);return t!==void 0&&!t.deleted},RYe=(n,e)=>{const t={};return n._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&hT(s,e)&&(t[i]=s.content.getContent()[s.length-1])}),t},yN=n=>(n.doc??ep(),qWe(n._map.entries(),e=>!e[1].deleted));class AYe extends ZU{}class jT extends Ph{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new jT;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new jT}clone(){const e=new jT;return e.insert(0,this.toArray().map(t=>t instanceof Ph?t.clone():t)),e}get length(){return this.doc??ep(),this._length}_callObserver(e,t){super._callObserver(e,t),QU(this,e,new AYe(this,e))}insert(e,t){this.doc!==null?xl(this.doc,r=>{Fge(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?xl(this.doc,t=>{wYe(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?xl(this.doc,r=>{zge(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return Uge(this,e)}toArray(){return Dge(this)}slice(e=0,t=this.length){return Pge(this,e,t)}toJSON(){return this.map(e=>e instanceof Ph?e.toJSON():e)}map(e){return Lge(this,e)}forEach(e){WO(this,e)}[Symbol.iterator](){return TYe(this)}_write(e){e.writeTypeRef(JYe)}}const CYe=n=>new jT;class MYe extends ZU{constructor(e,t,r){super(e,t),this.keysChanged=r}}class Rw extends Ph{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Rw}clone(){const e=new Rw;return this.forEach((t,r)=>{e.set(r,t instanceof Ph?t.clone():t)}),e}_callObserver(e,t){QU(this,e,new MYe(this,e,t))}toJSON(){this.doc??ep();const e={};return this._map.forEach((t,r)=>{if(!t.deleted){const i=t.content.getContent()[t.length-1];e[r]=i instanceof Ph?i.toJSON():i}}),e}get size(){return[...yN(this)].length}keys(){return s8(yN(this),e=>e[0])}values(){return s8(yN(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return s8(yN(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??ep(),this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?xl(this.doc,t=>{NL(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?xl(this.doc,r=>{Xq(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return Kq(this,e)}has(e){return Hge(this,e)}clear(){this.doc!==null?xl(this.doc,e=>{this.forEach(function(t,r,i){NL(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(QYe)}}const OYe=n=>new Rw,_1=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&xWe(n,e);class iz{constructor(e,t,r,i){this.left=e,this.right=t,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&qv(),this.right.content.constructor){case eh:this.right.deleted||oR(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const fte=(n,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case eh:e.right.deleted||oR(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Am(n,Xs(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},bN=(n,e,t,r)=>{const i=new Map,s=r?JU(e,t):null;if(s){const a=new iz(s.p.left,s.p,s.index,i);return fte(n,a,t-s.index)}else{const a=new iz(null,e._start,0,i);return fte(n,a,t)}},qge=(n,e,t,r)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===eh&&_1(r.get(t.right.content.key),t.right.content.value));)t.right.deleted||r.delete(t.right.content.key),t.forward();const i=n.doc,s=i.clientID;r.forEach((a,o)=>{const l=t.left,c=t.right,u=new ac(Xs(s,Kf(i.store,s)),l,l&&l.lastId,c,c&&c.id,e,null,new eh(o,a));u.integrate(n,0),t.right=u,t.forward()})},oR=(n,e)=>{const{key:t,value:r}=e;r===null?n.delete(t):n.set(t,r)},Vge=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===eh&&_1(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},Gge=(n,e,t,r)=>{const i=n.doc,s=i.clientID,a=new Map;for(const o in r){const l=r[o],c=t.currentAttributes.get(o)??null;if(!_1(c,l)){a.set(o,c);const{left:u,right:f}=t;t.right=new ac(Xs(s,Kf(i.store,s)),u,u&&u.lastId,f,f&&f.id,e,null,new eh(o,l)),t.right.integrate(n,0),t.forward()}}return a},a8=(n,e,t,r,i)=>{t.currentAttributes.forEach((h,g)=>{i[g]===void 0&&(i[g]=null)});const s=n.doc,a=s.clientID;Vge(t,i);const o=Gge(n,e,t,i),l=r.constructor===String?new $v(r):r instanceof Ph?new Rb(r):new fx(r);let{left:c,right:u,index:f}=t;e._searchMarker&&$O(e._searchMarker,t.index,l.getLength()),u=new ac(Xs(a,Kf(s.store,a)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(n,0),t.right=u,t.index=f,t.forward(),qge(n,e,t,o)},hte=(n,e,t,r,i)=>{const s=n.doc,a=s.clientID;Vge(t,i);const o=Gge(n,e,t,i);e:for(;t.right!==null&&(r>0||o.size>0&&(t.right.deleted||t.right.content.constructor===eh));){if(!t.right.deleted)switch(t.right.content.constructor){case eh:{const{key:l,value:c}=t.right.content,u=i[l];if(u!==void 0){if(_1(u,c))o.delete(l);else{if(r===0)break e;o.set(l,c)}t.right.delete(n)}else t.currentAttributes.set(l,c);break}default:r<t.right.length&&Am(n,Xs(t.right.id.client,t.right.id.clock+r)),r-=t.right.length;break}t.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;t.right=new ac(Xs(a,Kf(s.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new $v(l)),t.right.integrate(n,0),t.forward()}qge(n,e,t,o)},$ge=(n,e,t,r,i)=>{let s=e;const a=C_();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===eh){const c=s.content;a.set(c.key,c)}s=s.right}let o=0,l=!1;for(;e!==s;){if(t===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case eh:{const{key:u,value:f}=c,h=r.get(u)??null;(a.get(u)!==c||h===f)&&(e.delete(n),o++,!l&&(i.get(u)??null)===f&&h!==f&&(h===null?i.delete(u):i.set(u,h))),!l&&!e.deleted&&oR(i,c);break}}}e=e.right}return o},kYe=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===eh){const r=e.content.key;t.has(r)?e.delete(n):t.add(r)}e=e.left}},IYe=n=>{let e=0;return xl(n.doc,t=>{let r=n._start,i=n._start,s=C_();const a=X9(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case eh:oR(a,i.content);break;default:e+=$ge(t,r,i,s,a),s=X9(a),r=i;break}i=i.right}}),e},NYe=n=>{const e=new Set,t=n.doc;for(const[r,i]of n.afterState.entries()){const s=n.beforeState.get(r)||0;i!==s&&Mge(n,t.store.clients.get(r),s,i,a=>{!a.deleted&&a.content.constructor===eh&&a.constructor!==C0&&e.add(a.parent)})}xl(t,r=>{Tw(n,n.deleteSet,i=>{if(i instanceof C0||!i.parent._hasFormatting||e.has(i.parent))return;const s=i.parent;i.content.constructor===eh?e.add(s):kYe(r,i)});for(const i of e)IYe(i)})},dte=(n,e,t)=>{const r=t,i=X9(e.currentAttributes),s=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Rb:case fx:case $v:t<e.right.length&&Am(n,Xs(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}s&&$ge(n,s,e.right,i,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&$O(a._searchMarker,e.index,-r+t),e};class PYe extends ZU{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];xl(e,r=>{const i=new Map,s=new Map;let a=this.target._start,o=null;const l={};let c="",u=0,f=0;const h=()=>{if(o!==null){let g=null;switch(o){case"delete":f>0&&(g={delete:f}),f=0;break;case"insert":(typeof c=="object"||c.length>0)&&(g={insert:c},i.size>0&&(g.attributes={},i.forEach((p,_)=>{p!==null&&(g.attributes[_]=p)}))),c="";break;case"retain":u>0&&(g={retain:u},bWe(l)||(g.attributes=_We({},l))),u=0;break}g&&t.push(g),o=null}};for(;a!==null;){switch(a.content.constructor){case Rb:case fx:this.adds(a)?this.deletes(a)||(h(),o="insert",c=a.content.getContent()[0],h()):this.deletes(a)?(o!=="delete"&&(h(),o="delete"),f+=1):a.deleted||(o!=="retain"&&(h(),o="retain"),u+=1);break;case $v:this.adds(a)?this.deletes(a)||(o!=="insert"&&(h(),o="insert"),c+=a.content.str):this.deletes(a)?(o!=="delete"&&(h(),o="delete"),f+=a.length):a.deleted||(o!=="retain"&&(h(),o="retain"),u+=a.length);break;case eh:{const{key:g,value:p}=a.content;if(this.adds(a)){if(!this.deletes(a)){const _=i.get(g)??null;_1(_,p)?p!==null&&a.delete(r):(o==="retain"&&h(),_1(p,s.get(g)??null)?delete l[g]:l[g]=p)}}else if(this.deletes(a)){s.set(g,p);const _=i.get(g)??null;_1(_,p)||(o==="retain"&&h(),l[g]=_)}else if(!a.deleted){s.set(g,p);const _=l[g];_!==void 0&&(_1(_,p)?_!==null&&a.delete(r):(o==="retain"&&h(),p===null?delete l[g]:l[g]=p))}a.deleted||(o==="insert"&&h(),oR(i,a.content));break}}a=a.right}for(h();t.length>0;){const g=t[t.length-1];if(g.retain!==void 0&&g.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class Gv extends Ph{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??ep(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Gv}clone(){const e=new Gv;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const r=new PYe(this,e,t);QU(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??ep();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===$v&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?xl(this.doc,r=>{const i=new iz(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const a=e[s];if(a.insert!==void 0){const o=!t&&typeof a.insert=="string"&&s===e.length-1&&i.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&a8(r,this,i,o,a.attributes||{})}else a.retain!==void 0?hte(r,this,i,a.retain,a.attributes||{}):a.delete!==void 0&&dte(r,i,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){this.doc??ep();const i=[],s=new Map,a=this.doc;let o="",l=this._start;function c(){if(o.length>0){const f={};let h=!1;s.forEach((p,_)=>{h=!0,f[_]=p});const g={insert:o};h&&(g.attributes=f),i.push(g),o=""}}const u=()=>{for(;l!==null;){if(hT(l,e)||t!==void 0&&hT(l,t))switch(l.content.constructor){case $v:{const f=s.get("ychange");e!==void 0&&!hT(l,e)?(f===void 0||f.user!==l.id.client||f.type!=="removed")&&(c(),s.set("ychange",r?r("removed",l.id):{type:"removed"})):t!==void 0&&!hT(l,t)?(f===void 0||f.user!==l.id.client||f.type!=="added")&&(c(),s.set("ychange",r?r("added",l.id):{type:"added"})):f!==void 0&&(c(),s.delete("ychange")),o+=l.content.str;break}case Rb:case fx:{c();const f={insert:l.content.getContent()[0]};if(s.size>0){const h={};f.attributes=h,s.forEach((g,p)=>{h[p]=g})}i.push(f);break}case eh:hT(l,e)&&(c(),oR(s,l.content));break}l=l.right}c()};return e||t?xl(a,f=>{e&&nz(f,e),t&&nz(f,t),u()},"cleanup"):u(),i}insert(e,t,r){if(t.length<=0)return;const i=this.doc;i!==null?xl(i,s=>{const a=bN(s,this,e,!r);r||(r={},a.currentAttributes.forEach((o,l)=>{r[l]=o})),a8(s,this,a,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){const i=this.doc;i!==null?xl(i,s=>{const a=bN(s,this,e,!r);a8(s,this,a,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(t===0)return;const r=this.doc;r!==null?xl(r,i=>{dte(i,bN(i,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(t===0)return;const i=this.doc;i!==null?xl(i,s=>{const a=bN(s,this,e,!1);a.right!==null&&hte(s,this,a,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){this.doc!==null?xl(this.doc,t=>{NL(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?xl(this.doc,r=>{Xq(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return Kq(this,e)}getAttributes(){return jge(this)}_write(e){e.writeTypeRef(eXe)}}const DYe=n=>new Gv;class o8{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??ep()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===Aw||t.constructor===jE)&&t._start!==null)e=t._start;else for(;e!==null;){const r=e.next;if(r!==null){e=r;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class jE extends Ph{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new jE}clone(){const e=new jE;return e.insert(0,this.toArray().map(t=>t instanceof Ph?t.clone():t)),e}get length(){return this.doc??ep(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new o8(this,e)}querySelector(e){e=e.toUpperCase();const r=new o8(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),FE(new o8(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){QU(this,e,new BYe(this,t,e))}toString(){return Lge(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),WO(this,s=>{i.insertBefore(s.toDOM(e,t,r),null)}),i}insert(e,t){this.doc!==null?xl(this.doc,r=>{Fge(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)xl(this.doc,r=>{const i=e&&e instanceof Ph?e._item:e;IL(r,this,i,t)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw L1("Reference item not found");r.splice(i,0,...t)}}delete(e,t=1){this.doc!==null?xl(this.doc,r=>{zge(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return Dge(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Uge(this,e)}slice(e=0,t=this.length){return Pge(this,e,t)}forEach(e){WO(this,e)}_write(e){e.writeTypeRef(nXe)}}const LYe=n=>new jE;class Aw extends jE{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Aw(this.nodeName)}clone(){const e=new Aw(this.nodeName),t=this.getAttributes();return yWe(t,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof Ph?r.clone():r)),e}toString(){const e=this.getAttributes(),t=[],r=[];for(const o in e)r.push(o);r.sort();const i=r.length;for(let o=0;o<i;o++){const l=r[o];t.push(l+'="'+e[l]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?xl(this.doc,t=>{NL(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?xl(this.doc,r=>{Xq(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return Kq(this,e)}hasAttribute(e){return Hge(this,e)}getAttributes(e){return e?RYe(this,e):jge(this)}toDOM(e=document,t={},r){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const a in s){const o=s[a];typeof o=="string"&&i.setAttribute(a,o)}return WO(this,a=>{i.appendChild(a.toDOM(e,t,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(tXe),e.writeKey(this.nodeName)}}const UYe=n=>new Aw(n.readKey());class BYe extends ZU{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class PL extends Rw{constructor(e){super(),this.hookName=e}_copy(){return new PL(this.hookName)}clone(){const e=new PL(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){const i=t[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(rXe),e.writeKey(this.hookName)}}const FYe=n=>new PL(n.readKey());class DL extends Gv{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new DL}clone(){const e=new DL;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){const i=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const t=[];for(const i in e.attributes){const s=[];for(const a in e.attributes[i])s.push({key:a,value:e.attributes[i][a]});s.sort((a,o)=>a.key<o.key?-1:1),t.push({nodeName:i,attrs:s})}t.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<t.length;i++){const s=t[i];r+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];r+=` ${o.key}="${o.value}"`}r+=">"}r+=e.insert;for(let i=t.length-1;i>=0;i--)r+=`</${t[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(iXe)}}const zYe=n=>new DL;class Zq{constructor(e,t){this.id=e,this.length=t}get deleted(){throw Dv()}mergeWith(e){return!1}write(e,t,r){throw Dv()}integrate(e,t){throw Dv()}}const jYe=0;class C0 extends Zq{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),Cge(e.doc.store,this)}write(e,t){e.writeInfo(jYe),e.writeLen(this.length-t)}getMissing(e,t){return null}}class $k{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new $k(this.content)}splice(e){throw Dv()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const HYe=n=>new $k(n.readBuf());class YO{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new YO(this.len)}splice(e){const t=new YO(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){GO(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const qYe=n=>new YO(n.readLen()),Wge=(n,e)=>new ux({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Wk{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Wk(Wge(this.doc.guid,this.opts))}splice(e){throw Dv()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const VYe=n=>new Wk(Wge(n.readString(),n.readAny()));class fx{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new fx(this.embed)}splice(e){throw Dv()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const GYe=n=>new fx(n.readJSON());class eh{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new eh(this.key,this.value)}splice(e){throw Dv()}mergeWith(e){return!1}integrate(e,t){const r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const $Ye=n=>new eh(n.readKey(),n.readJSON());class LL{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new LL(this.arr)}splice(e){const t=new LL(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const WYe=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++){const i=n.readString();i==="undefined"?t.push(void 0):t.push(JSON.parse(i))}return new LL(t)},YYe=ML("node_env")==="development";class HE{constructor(e){this.arr=e,YYe&&fge(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new HE(this.arr)}splice(e){const t=new HE(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const s=this.arr[i];e.writeAny(s)}}getRef(){return 8}}const XYe=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++)t.push(n.readAny());return new HE(t)};class $v{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new $v(this.str)}splice(e){const t=new $v(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const KYe=n=>new $v(n.readString()),ZYe=[CYe,OYe,DYe,UYe,LYe,FYe,zYe],JYe=0,QYe=1,eXe=2,tXe=3,nXe=4,rXe=5,iXe=6;class Rb{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Rb(this.type._copy())}splice(e){throw Dv()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const sXe=n=>new Rb(ZYe[n.readTypeRef()](n)),aXe=(n,e)=>{let t=e,r=0,i;do r>0&&(t=Xs(t.client,t.clock+r)),i=RP(n,t),r=t.clock-i.id.clock,t=i.redone;while(t!==null&&i instanceof ac);return{item:i,diff:r}},Jq=(n,e)=>{for(;n!==null&&n.keep!==e;)n.keep=e,n=n.parent._item},UL=(n,e,t)=>{const{client:r,clock:i}=e.id,s=new ac(Xs(r,i+t),e,Xs(r,i+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Xs(e.redone.client,e.redone.clock+t)),e.right=s,s.right!==null&&(s.right.left=s),n._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=t,s},pte=(n,e)=>D$e(n,t=>Vk(t.deletions,e)),Yge=(n,e,t,r,i,s)=>{const a=n.doc,o=a.store,l=a.clientID,c=e.redone;if(c!==null)return Am(n,c);let u=e.parent._item,f=null,h;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!t.has(u)||Yge(n,u,t,r,i,s)===null))return null;for(;u.redone!==null;)u=Am(n,u.redone)}const g=u===null?e.parent:u.content.type;if(e.parentSub===null){for(f=e.left,h=e;f!==null;){let v=f;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Am(n,v.redone);if(v!==null&&v.parent._item===u){f=v;break}f=f.left}for(;h!==null;){let v=h;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Am(n,v.redone);if(v!==null&&v.parent._item===u){h=v;break}h=h.right}}else if(h=null,e.right&&!i){for(f=e;f!==null&&f.right!==null&&(f.right.redone||Vk(r,f.right.id)||pte(s.undoStack,f.right.id)||pte(s.redoStack,f.right.id));)for(f=f.right;f.redone;)f=Am(n,f.redone);if(f&&f.right!==null)return null}else f=g._map.get(e.parentSub)||null;const p=Kf(o,l),_=Xs(l,p),y=new ac(_,f,f&&f.lastId,h,h&&h.id,g,e.parentSub,e.content.copy());return e.redone=_,Jq(y,!0),y.integrate(n,0),y};class ac extends Zq{constructor(e,t,r,i,s,a,o,l){super(e,l.getLength()),this.origin=r,this.left=t,this.right=i,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=l,this.info=this.content.isCountable()?Vee:0}set marker(e){(this.info&n8)>0!==e&&(this.info^=n8)}get marker(){return(this.info&n8)>0}get keep(){return(this.info&qee)>0}set keep(e){this.keep!==e&&(this.info^=qee)}get countable(){return(this.info&Vee)>0}get deleted(){return(this.info&t8)>0}set deleted(e){this.deleted!==e&&(this.info^=t8)}markDeleted(){this.info|=t8}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Kf(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Kf(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===zT&&this.id.client!==this.parent.client&&this.parent.clock>=Kf(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=ste(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Am(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===C0||this.right&&this.right.constructor===C0)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===ac?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===ac&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===zT){const r=RP(t,this.parent);r.constructor===C0?this.parent=null:this.parent=r.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=ste(e,e.doc.store,Xs(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,a=new Set;for(;i!==null&&i!==this.right;){if(a.add(i),s.add(i),vN(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(vN(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&a.has(RP(e.doc.store,i.origin)))s.has(RP(e.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Cge(e.doc.store,this),this.content.integrate(e,this),ote(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new C0(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Xs(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&vN(e.origin,this.lastId)&&this.right===e&&vN(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),GO(e.deleteSet,this.id.client,this.id.clock,this.length),ote(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw qv();this.content.gc(e),t?lYe(e,this,new C0(this.id,this.length)):this.content=new YO(this.length)}write(e,t){const r=t>0?Xs(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&WU|(r===null?0:jg)|(i===null?0:nb)|(s===null?0:zO);if(e.writeInfo(a),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const o=this.parent;if(o._item!==void 0){const l=o._item;if(l===null){const c=aYe(o);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else o.constructor===String?(e.writeParentInfo(!0),e.writeString(o)):o.constructor===zT?(e.writeParentInfo(!1),e.writeLeftID(o)):qv();s!==null&&e.writeString(s)}this.content.write(e,t)}}const Xge=(n,e)=>oXe[e&WU](n),oXe=[()=>{qv()},qYe,WYe,HYe,KYe,GYe,$Ye,sXe,XYe,VYe,()=>{qv()}],lXe=10;class M0 extends Zq{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){qv()}write(e,t){e.writeInfo(lXe),za(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const Kge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Jy<"u"?Jy:{},Zge="__ $YJS$ __";Kge[Zge]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Kge[Zge]=!0;let mte=!1;const Cm=new ux;function Jge(n){const e=Cm.getMap(),[,t]=it.useState(0);if(it.useEffect(()=>{function r(){t(i=>1-i)}return e.observe(r),()=>{e.unobserve(r)}},[e,t]),e.has(n))return e.get(n)}function Yk(n){const e=Jge(n);if(Mn(e))return e}function Qge(n){const e=Jge(n);if(!(!xe(e)||!(e instanceof Gv)))return e}function e0e(n,e,t){const r=Cm.getMap();if(!r.has(n))switch(e){case 0:case 1:r.set(n,t);break}}function cXe(n,e){e0e(n,0,e)}function t0e(n,e){const t=new Gv(e);e0e(n,1,t)}function Ip(n,e){Cm.getMap().set(n,e)}function uXe(n,e){const t=Cm.getMap(),r=new Gv(e);t.set(n,r)}function n0e(n,e){const t=Cm.getMap();function r(i){const s=t.get(n);for(let a=0;a<i.length;++a)(i[a].target===t||i[a].target===s)&&e(s)}return t.has(n)&&e(t.get(n)),t.observeDeep(r),()=>{t.observeDeep(r)}}function fXe(n,e){return n0e(n,t=>{Mn(t)&&e(t)})}function hXe(n,e){return n0e(n,t=>{t instanceof Gv&&e(t.toJSON())})}const VS=Y1("modem",["second"],n=>{if(VS.session(n))switch(n.target){case"second":!mte&&n.data%2===0&&VS.emit(n.player,"modem:join");break;case"join":n.sender!==VS.id()&&VS.reply(n,"joinack",Lfe(rYe(Cm)));break;case"joinack":n.sender!==VS.id()&&(mte=!0,tte(Cm,Pg(n.data),Cm));break;case"sync":{n.sender!==VS.id()&&xe(n.data)&&tte(Cm,Pg(n.data),Cm);break}}});function r0e(n,e){e!==Cm&&VS.emit("","modem:sync",Lfe(n))}Cm.on("update",r0e);Cm.on("destroy",()=>{Cm.off("update",r0e)});const dXe=`desc;$DKGRAYname and type of codepage
`,pXe=Object.freeze(Object.defineProperty({__proto__:null,default:dXe},Symbol.toStringTag,{value:"Module"})),mXe="desc;changes object into specified element",gXe=Object.freeze(Object.defineProperty({__proto__:null,default:mXe},Symbol.toStringTag,{value:"Module"})),_Xe="desc;like #play but for sound effects",vXe=Object.freeze(Object.defineProperty({__proto__:null,default:_Xe},Symbol.toStringTag,{value:"Module"})),yXe="",bXe=Object.freeze(Object.defineProperty({__proto__:null,default:yXe},Symbol.toStringTag,{value:"Module"})),SXe="",EXe=Object.freeze(Object.defineProperty({__proto__:null,default:SXe},Symbol.toStringTag,{value:"Module"})),xXe="",TXe=Object.freeze(Object.defineProperty({__proto__:null,default:xXe},Symbol.toStringTag,{value:"Module"})),wXe="",RXe=Object.freeze(Object.defineProperty({__proto__:null,default:wXe},Symbol.toStringTag,{value:"Module"})),AXe="",CXe=Object.freeze(Object.defineProperty({__proto__:null,default:AXe},Symbol.toStringTag,{value:"Module"})),MXe="",OXe=Object.freeze(Object.defineProperty({__proto__:null,default:MXe},Symbol.toStringTag,{value:"Module"})),kXe="",IXe=Object.freeze(Object.defineProperty({__proto__:null,default:kXe},Symbol.toStringTag,{value:"Module"})),NXe="",PXe=Object.freeze(Object.defineProperty({__proto__:null,default:NXe},Symbol.toStringTag,{value:"Module"})),DXe="",LXe=Object.freeze(Object.defineProperty({__proto__:null,default:DXe},Symbol.toStringTag,{value:"Module"})),UXe="",BXe=Object.freeze(Object.defineProperty({__proto__:null,default:UXe},Symbol.toStringTag,{value:"Module"})),FXe="",zXe=Object.freeze(Object.defineProperty({__proto__:null,default:FXe},Symbol.toStringTag,{value:"Module"})),jXe="",HXe=Object.freeze(Object.defineProperty({__proto__:null,default:jXe},Symbol.toStringTag,{value:"Module"})),qXe="",VXe=Object.freeze(Object.defineProperty({__proto__:null,default:qXe},Symbol.toStringTag,{value:"Module"})),GXe="",$Xe=Object.freeze(Object.defineProperty({__proto__:null,default:GXe},Symbol.toStringTag,{value:"Module"})),WXe="",YXe=Object.freeze(Object.defineProperty({__proto__:null,default:WXe},Symbol.toStringTag,{value:"Module"})),XXe=`desc;$DKGRAYstarts a section of an if-do-done block
`,KXe=Object.freeze(Object.defineProperty({__proto__:null,default:XXe},Symbol.toStringTag,{value:"Module"})),ZXe=`desc;$DKGRAYcompletes an if-do-done block
`,JXe=Object.freeze(Object.defineProperty({__proto__:null,default:ZXe},Symbol.toStringTag,{value:"Module"})),QXe="",eKe=Object.freeze(Object.defineProperty({__proto__:null,default:QXe},Symbol.toStringTag,{value:"Module"})),tKe="",nKe=Object.freeze(Object.defineProperty({__proto__:null,default:tKe},Symbol.toStringTag,{value:"Module"})),rKe="",iKe=Object.freeze(Object.defineProperty({__proto__:null,default:rKe},Symbol.toStringTag,{value:"Module"})),sKe=`desc;$DKGRAYelse logic in an if-do-done block
`,aKe=Object.freeze(Object.defineProperty({__proto__:null,default:sKe},Symbol.toStringTag,{value:"Module"})),oKe=`desc;$DKGRAYconditional else logic in an if-do-done block
`,lKe=Object.freeze(Object.defineProperty({__proto__:null,default:oKe},Symbol.toStringTag,{value:"Module"})),cKe="",uKe=Object.freeze(Object.defineProperty({__proto__:null,default:cKe},Symbol.toStringTag,{value:"Module"})),fKe="",hKe=Object.freeze(Object.defineProperty({__proto__:null,default:fKe},Symbol.toStringTag,{value:"Module"})),dKe="",pKe=Object.freeze(Object.defineProperty({__proto__:null,default:dKe},Symbol.toStringTag,{value:"Module"})),mKe="",gKe=Object.freeze(Object.defineProperty({__proto__:null,default:mKe},Symbol.toStringTag,{value:"Module"})),_Ke="",vKe=Object.freeze(Object.defineProperty({__proto__:null,default:_Ke},Symbol.toStringTag,{value:"Module"})),yKe="",bKe=Object.freeze(Object.defineProperty({__proto__:null,default:yKe},Symbol.toStringTag,{value:"Module"})),SKe="",EKe=Object.freeze(Object.defineProperty({__proto__:null,default:SKe},Symbol.toStringTag,{value:"Module"})),xKe="",TKe=Object.freeze(Object.defineProperty({__proto__:null,default:xKe},Symbol.toStringTag,{value:"Module"})),wKe=`desc;$DKGRAYhalt until the next cycle
`,RKe=Object.freeze(Object.defineProperty({__proto__:null,default:wKe},Symbol.toStringTag,{value:"Module"})),AKe=`desc;$DKGRAYevals condition for true or false
`,CKe=Object.freeze(Object.defineProperty({__proto__:null,default:AKe},Symbol.toStringTag,{value:"Module"})),MKe="",OKe=Object.freeze(Object.defineProperty({__proto__:null,default:MKe},Symbol.toStringTag,{value:"Module"})),kKe="",IKe=Object.freeze(Object.defineProperty({__proto__:null,default:kKe},Symbol.toStringTag,{value:"Module"})),NKe="",PKe=Object.freeze(Object.defineProperty({__proto__:null,default:NKe},Symbol.toStringTag,{value:"Module"})),DKe="",LKe=Object.freeze(Object.defineProperty({__proto__:null,default:DKe},Symbol.toStringTag,{value:"Module"})),UKe="",BKe=Object.freeze(Object.defineProperty({__proto__:null,default:UKe},Symbol.toStringTag,{value:"Module"})),FKe="",zKe=Object.freeze(Object.defineProperty({__proto__:null,default:FKe},Symbol.toStringTag,{value:"Module"})),jKe="",HKe=Object.freeze(Object.defineProperty({__proto__:null,default:jKe},Symbol.toStringTag,{value:"Module"})),qKe="",VKe=Object.freeze(Object.defineProperty({__proto__:null,default:qKe},Symbol.toStringTag,{value:"Module"})),GKe="",$Ke=Object.freeze(Object.defineProperty({__proto__:null,default:GKe},Symbol.toStringTag,{value:"Module"})),WKe="",YKe=Object.freeze(Object.defineProperty({__proto__:null,default:WKe},Symbol.toStringTag,{value:"Module"})),XKe="",KKe=Object.freeze(Object.defineProperty({__proto__:null,default:XKe},Symbol.toStringTag,{value:"Module"})),ZKe="",JKe=Object.freeze(Object.defineProperty({__proto__:null,default:ZKe},Symbol.toStringTag,{value:"Module"})),QKe="",eZe=Object.freeze(Object.defineProperty({__proto__:null,default:QKe},Symbol.toStringTag,{value:"Module"})),tZe="",nZe=Object.freeze(Object.defineProperty({__proto__:null,default:tZe},Symbol.toStringTag,{value:"Module"})),rZe="",iZe=Object.freeze(Object.defineProperty({__proto__:null,default:rZe},Symbol.toStringTag,{value:"Module"})),sZe="",aZe=Object.freeze(Object.defineProperty({__proto__:null,default:sZe},Symbol.toStringTag,{value:"Module"})),oZe="",lZe=Object.freeze(Object.defineProperty({__proto__:null,default:oZe},Symbol.toStringTag,{value:"Module"})),cZe="",uZe=Object.freeze(Object.defineProperty({__proto__:null,default:cZe},Symbol.toStringTag,{value:"Module"})),fZe="",hZe=Object.freeze(Object.defineProperty({__proto__:null,default:fZe},Symbol.toStringTag,{value:"Module"})),dZe="",pZe=Object.freeze(Object.defineProperty({__proto__:null,default:dZe},Symbol.toStringTag,{value:"Module"})),mZe="",gZe=Object.freeze(Object.defineProperty({__proto__:null,default:mZe},Symbol.toStringTag,{value:"Module"})),_Ze=`desc;$DKGRAYlaunches a bullet
words;dir
words2;dir,kind
`,vZe=Object.freeze(Object.defineProperty({__proto__:null,default:_Ze},Symbol.toStringTag,{value:"Module"})),yZe="",bZe=Object.freeze(Object.defineProperty({__proto__:null,default:yZe},Symbol.toStringTag,{value:"Module"})),SZe="",EZe=Object.freeze(Object.defineProperty({__proto__:null,default:SZe},Symbol.toStringTag,{value:"Module"})),xZe="",TZe=Object.freeze(Object.defineProperty({__proto__:null,default:xZe},Symbol.toStringTag,{value:"Module"})),wZe="",RZe=Object.freeze(Object.defineProperty({__proto__:null,default:wZe},Symbol.toStringTag,{value:"Module"})),AZe="",CZe=Object.freeze(Object.defineProperty({__proto__:null,default:AZe},Symbol.toStringTag,{value:"Module"})),MZe="",OZe=Object.freeze(Object.defineProperty({__proto__:null,default:MZe},Symbol.toStringTag,{value:"Module"})),kZe="",IZe=Object.freeze(Object.defineProperty({__proto__:null,default:kZe},Symbol.toStringTag,{value:"Module"})),NZe="",PZe=Object.freeze(Object.defineProperty({__proto__:null,default:NZe},Symbol.toStringTag,{value:"Module"})),DZe="",LZe=Object.freeze(Object.defineProperty({__proto__:null,default:DZe},Symbol.toStringTag,{value:"Module"})),UZe="",BZe=Object.freeze(Object.defineProperty({__proto__:null,default:UZe},Symbol.toStringTag,{value:"Module"})),FZe="",zZe=Object.freeze(Object.defineProperty({__proto__:null,default:FZe},Symbol.toStringTag,{value:"Module"})),jZe="",HZe=Object.freeze(Object.defineProperty({__proto__:null,default:jZe},Symbol.toStringTag,{value:"Module"})),qZe="",VZe=Object.freeze(Object.defineProperty({__proto__:null,default:qZe},Symbol.toStringTag,{value:"Module"})),GZe="",$Ze=Object.freeze(Object.defineProperty({__proto__:null,default:GZe},Symbol.toStringTag,{value:"Module"})),WZe="",YZe=Object.freeze(Object.defineProperty({__proto__:null,default:WZe},Symbol.toStringTag,{value:"Module"})),XZe="",KZe=Object.freeze(Object.defineProperty({__proto__:null,default:XZe},Symbol.toStringTag,{value:"Module"})),ZZe="",JZe=Object.freeze(Object.defineProperty({__proto__:null,default:ZZe},Symbol.toStringTag,{value:"Module"})),QZe="",eJe=Object.freeze(Object.defineProperty({__proto__:null,default:QZe},Symbol.toStringTag,{value:"Module"})),tJe="",nJe=Object.freeze(Object.defineProperty({__proto__:null,default:tJe},Symbol.toStringTag,{value:"Module"})),rJe=`desc;$DKGRAYdesignates an inactive label or comment
`,iJe=Object.freeze(Object.defineProperty({__proto__:null,default:rJe},Symbol.toStringTag,{value:"Module"})),sJe=`desc;$DKGRAYadds hyperlink text

`,aJe=Object.freeze(Object.defineProperty({__proto__:null,default:sJe},Symbol.toStringTag,{value:"Module"})),oJe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,lJe=Object.freeze(Object.defineProperty({__proto__:null,default:oJe},Symbol.toStringTag,{value:"Module"})),cJe=`desc;$DKGRAYread number input into given stat/flag
`,uJe=Object.freeze(Object.defineProperty({__proto__:null,default:cJe},Symbol.toStringTag,{value:"Module"})),fJe=`desc;$DKGRAYa slider input from 1 to 9 

`,hJe=Object.freeze(Object.defineProperty({__proto__:null,default:fJe},Symbol.toStringTag,{value:"Module"})),dJe=`desc;$DKGRAYlist with label value pairs to pick from
`,pJe=Object.freeze(Object.defineProperty({__proto__:null,default:dJe},Symbol.toStringTag,{value:"Module"})),mJe=`desc;$DKGRAYread text input into given stat/flag
`,gJe=Object.freeze(Object.defineProperty({__proto__:null,default:mJe},Symbol.toStringTag,{value:"Module"})),_Je=`desc;$DKGRAYdesignates a starting point for running code
`,vJe=Object.freeze(Object.defineProperty({__proto__:null,default:_Je},Symbol.toStringTag,{value:"Module"})),yJe=`desc;$DKGRAYwaits until the object can move in the given direction and moves
`,bJe=Object.freeze(Object.defineProperty({__proto__:null,default:yJe},Symbol.toStringTag,{value:"Module"})),SJe=`desc;$DKGRAYwill move the object in the given direction
`,EJe=Object.freeze(Object.defineProperty({__proto__:null,default:SJe},Symbol.toStringTag,{value:"Module"})),xJe=`desc;$DKGRAYcreates a 60x25 space for terrain and object elements
`,TJe=Object.freeze(Object.defineProperty({__proto__:null,default:xJe},Symbol.toStringTag,{value:"Module"})),wJe=`desc;$DKGRAYcustom 8x14 charset
`,RJe=Object.freeze(Object.defineProperty({__proto__:null,default:wJe},Symbol.toStringTag,{value:"Module"})),AJe=`desc;$DKGRAYsets stat to given value

`,CJe=Object.freeze(Object.defineProperty({__proto__:null,default:AJe},Symbol.toStringTag,{value:"Module"})),MJe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,OJe=Object.freeze(Object.defineProperty({__proto__:null,default:MJe},Symbol.toStringTag,{value:"Module"})),kJe=`desc;$DKGRAYread external content and/or handle events
`,IJe=Object.freeze(Object.defineProperty({__proto__:null,default:kJe},Symbol.toStringTag,{value:"Module"})),NJe=`desc;$DKGRAYread number input into given stat/flag
`,PJe=Object.freeze(Object.defineProperty({__proto__:null,default:NJe},Symbol.toStringTag,{value:"Module"})),DJe=`desc;$DKGRAYelements that can walk, swim, or be used with #shoot

`,LJe=Object.freeze(Object.defineProperty({__proto__:null,default:DJe},Symbol.toStringTag,{value:"Module"})),UJe=`desc;$DKGRAYcustom palette colors
`,BJe=Object.freeze(Object.defineProperty({__proto__:null,default:UJe},Symbol.toStringTag,{value:"Module"})),FJe=`desc;$DKGRAYa slider input from 1 to 9 

`,zJe=Object.freeze(Object.defineProperty({__proto__:null,default:FJe},Symbol.toStringTag,{value:"Module"})),jJe=`desc;$DKGRAYlist with label value pairs to pick from
`,HJe=Object.freeze(Object.defineProperty({__proto__:null,default:jJe},Symbol.toStringTag,{value:"Module"})),qJe=`desc;$DKGRAYterrain for solid, walkable, swimable board elements
`,VJe=Object.freeze(Object.defineProperty({__proto__:null,default:qJe},Symbol.toStringTag,{value:"Module"})),GJe=`desc;$DKGRAYread text input into given stat/flag
`,$Je=Object.freeze(Object.defineProperty({__proto__:null,default:GJe},Symbol.toStringTag,{value:"Module"})),WJe=`desc;$DKGRAYadds text
`,YJe=Object.freeze(Object.defineProperty({__proto__:null,default:WJe},Symbol.toStringTag,{value:"Module"})),XJe=`header;zss controls and inputs
section;keyboard input
option;arrow keys;move
option;shift + arrow keys;shoot
option;enter;ok / accept
option;escape;cancel / close
option;tab;menu / action
section;controller input
option;left stick;move
option;right stick;aim
option;a;ok / accept
option;b;cancel / close
option;y;menu / action
option;x;shoot
option;triggers;shoot
`,KJe=Object.freeze(Object.defineProperty({__proto__:null,default:XJe},Symbol.toStringTag,{value:"Module"})),ZJe=`header;developer commands
option;#books;list books in memory
option;#pages;list pages in opened book
option;@[pagetype:]page name;create & edit a new codepage in the currently opened book
option;#trash;list books and pages from open book you can delete
option;#save;flush state to register
option;#share;creates a click to copy share url and QR code
`,JJe=Object.freeze(Object.defineProperty({__proto__:null,default:ZJe},Symbol.toStringTag,{value:"Module"})),QJe=`header;H E L P
keyboard input
option;? or /;open terminal
option;esc;close terminal, scroll, or editor
option;tab;change layout
option;up or down arrow keys;navigate terminal items
option;left or right arrow keys;change terminal items
option;enter;activate terminal items
option;alt + arrow keys;skip words and terminal lines
option;ctrl + up / down arrow keys;input history
$32
option;controls;zss controls and inputs
!helpcontrols;read help controls
$32
option;text;zss text and inputs
!helptext;read help text
$32
option;developer;developer commands
!helpdeveloper;read help developer
$32
option;player;player settings & hotkeys
!helpplayer;read help player
`,eQe=Object.freeze(Object.defineProperty({__proto__:null,default:QJe},Symbol.toStringTag,{value:"Module"})),tQe=`$white no pages found
$white use @ to create a page
$white @board name of board
$white @object name of object
$white @terrain name of terrain
$white You can omit the type and it will default to object
$white @object name of object
$white @name of object`,nQe=Object.freeze(Object.defineProperty({__proto__:null,default:tQe},Symbol.toStringTag,{value:"Module"})),rQe=`header;player settings
#set user "name goes here"
`,iQe=Object.freeze(Object.defineProperty({__proto__:null,default:rQe},Symbol.toStringTag,{value:"Module"})),sQe=`header;text formatting
section;typography
plain text
use"@quoted strings for special chars"
$$0-255 for ascii chars $159$176$240
use color names like $RED$$red$BLUE to change foreground color
use color names like $ONGREEN$$ongreen$ONCLEAR to change background color
use onclear $WHITE$$onclear$BLUE to change background to transparent
section;hyperlinks
option;!hotkey label <shortcut> [shortcutword];
send the given #label when the <shortcut> is pressed
!openit https://github.com/ianstormtaylor/is-hotkey;$BLUEuses is-hotkey
option;!range flag [minword] [maxword];
uses the standard 1 to 9 values input range
option;!select flag ...list of <word> <value> pairs;
gives a user a way to cycle through preset values
option;!text flag;
write user text input into a flag
`,aQe=Object.freeze(Object.defineProperty({__proto__:null,default:sQe},Symbol.toStringTag,{value:"Module"})),oQe=`section;#autowah on
#autowah <number>
$white 0-100, 0 is off, 100 is full volume
#autowah basefrequency <frequency>
$white The frequency the filter is set to at the
$white low point of the wah.
#autowah octaves <number>
$white The number of octaves above the baseFrequency 
$white the filter will sweep to when fully open.
#autowah sensitivity <number>
$white The decibel threshold sensitivity for 
$white the incoming signal.
$white Normal range of -40 to 0.
#autowah gain <number>
$white Controls the loudness of the effect.
#autowah follower <seconds>
$white Sets the smoothing time for the effect.`,lQe=Object.freeze(Object.defineProperty({__proto__:null,default:oQe},Symbol.toStringTag,{value:"Module"})),cQe=`section;#distort on
#distort <number>
$white 0-100, 0 is off, 100 is full volume
#distort distortion <number>
$white 0 or higher, controls strength of effect.
#distort oversample <2x|4x|none>
$white oversample improves quality.`,uQe=Object.freeze(Object.defineProperty({__proto__:null,default:cQe},Symbol.toStringTag,{value:"Module"})),fQe=`section;#echo on
#echo <number>
$white 0-100, 0 is off, 100 is full volume
#echo delaytime <seconds>
$white duration between echos.
#echo feedback <number>
$white A number that is between [0, 1]
$white 1 is forever feedback and 0 is none.`,hQe=Object.freeze(Object.defineProperty({__proto__:null,default:fQe},Symbol.toStringTag,{value:"Module"})),dQe=`!fcrushscroll hk f F next;#fcrush on
!echoscroll hk e E next;#echo on
!reverbscroll hk r R next;#reverb on
!phaserscroll hk p P next;#phaser on
!distortscroll hk d D next;#distort on
!vibratoscroll hk v V next;#vibrato on
!autowahscroll hk a A next;#autowah on`,pQe=Object.freeze(Object.defineProperty({__proto__:null,default:dQe},Symbol.toStringTag,{value:"Module"})),mQe=`section;#fcrush on
#fcrush <number>
$white 0-100, 0 is off, 100 is full volume
#fcrush rate <number>
$white 1 or higher, more rate, more crush`,gQe=Object.freeze(Object.defineProperty({__proto__:null,default:mQe},Symbol.toStringTag,{value:"Module"})),_Qe=`section;helper scrolls
!termscroll hk t T next;terminal commands
!dictionary hk d D next;dictionary of commands
!charscroll hk a A next;char
!colorscroll hk c C next;color
!bgscroll hk b B next;bg
!notesscroll hk n N next;notes
!synthscroll hk s S next;synth
!effectsscroll hk e E next;effects
!voicescroll hk v V next;tts voices
`,vQe=Object.freeze(Object.defineProperty({__proto__:null,default:_Qe},Symbol.toStringTag,{value:"Module"})),yQe=`"duration             cdefgab = notes 
"y = 64th note        x = rest
"t = 32nd note        
"s = 16th note        drums
"i = eight note       0 = hihat
"q = quarter note     1 = open hihat
"h = half note        2 = cowbell
"w = whole note       p = clap
"mods                 4 = high snare
"3 = triplet          5 = high woodblock
". = time and a half  6 = low snare
"# = sharp            7 = low tom
"! = flat             8 = low woodblock
"+ = increase octave  9 = bass drum
"- = decrease octave`,bQe=Object.freeze(Object.defineProperty({__proto__:null,default:yQe},Symbol.toStringTag,{value:"Module"})),SQe=`section;sine, square, triangle, sawtooth
#synth phase <degrees>
$white The phase is the starting position within 
$white the oscillator's cycle. For example a phase 
$white of 180 would start halfway through the
$white oscillator's cycle.
section;amsine, amsquare, amtriangle, amsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
section;fmsine, fmsquare, fmtriangle, fmsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
#synth modindex <degrees>
$white The modulation index which is in essence
$white the depth or amount of the modulation.
$white In other terms it is the ratio of the 
$white frequency of the modulating signal (mf) 
$white to the amplitude of the modulating signal 
$white (ma) -- as in ma/mf
section;fatsine, fatsquare, fattriangle, fatsawtooth
#synth phase <degrees>
#synth count <number>
$white This sets the number of oscillators to 
$white spread along the given range.
#synth spread <cents>
$white This signals the number of cents between
$white oscillators.`,EQe=Object.freeze(Object.defineProperty({__proto__:null,default:SQe},Symbol.toStringTag,{value:"Module"})),xQe=`section;#phaser on
#phaser <number>
$white 0-100, 0 is off, 100 is full volume
#phaser frequency <frequency>
$white The rate of oscilation of the effect.
#phaser octaves <number>
$white Controls the range of the effect.
#phaser basefrequency <frequency>
$white The base frequency of the filters.
`,TQe=Object.freeze(Object.defineProperty({__proto__:null,default:xQe},Symbol.toStringTag,{value:"Module"})),wQe=`section;pulse
#synth width <range>
$white A number that is between [-1, 1] altering
$white this value changes the shape of the square
$white wave`,RQe=Object.freeze(Object.defineProperty({__proto__:null,default:wQe},Symbol.toStringTag,{value:"Module"})),AQe=`section;pwm
#synth modfreq <frequency>
$white This sets the frequency of change for the 
$white pulse width of this oscillator.`,CQe=Object.freeze(Object.defineProperty({__proto__:null,default:AQe},Symbol.toStringTag,{value:"Module"})),MQe=`section;#reverb on
#reverb <number>
$white 0-100, 0 is off, 100 is full volume
#reverb predelay <seconds>
$white The amount of time before the reverb
$white is fully ramped in.
#reverb decay <seconds>
$white The duration of the reverb.
`,OQe=Object.freeze(Object.defineProperty({__proto__:null,default:MQe},Symbol.toStringTag,{value:"Module"})),kQe=`switching voices
#synth <sine, square, triangle, sawtooth> 
#synth <pwm, pulse, bells, doot>
#synth <retro, buzz, clang, metallic>

voice settings
#synth restart - resets voice to default
#synth vol <db> - control volume
#synth port <seconds>
#synth env <attack> <delay> <sustain> <release>

voice specific 
!oscscroll hk o O next;sine, square, triangle, sawtooth
!pwmscroll hk m M next;pwm
!pulsescroll hk p P next;pulse`,IQe=Object.freeze(Object.defineProperty({__proto__:null,default:kQe},Symbol.toStringTag,{value:"Module"})),NQe=`press$white C$yellow to chat
press$white #$yellow to run a quick command
section;dev-tools
#gadget
$white toggles inspector tool on/off
#zztrandom
$white downloads random from the museumofzzt api
#zztsearch <field> <value>
$white searches the museumofzzt api for zzt games
section;multi-player
#set user <name>
$white sets your display name when talking to others
#joincode OR ctrl+O 
$white starts a multi-player session showing a
$white QR code. It also provides are sharable link
$white you can give to other to join the game.`,PQe=Object.freeze(Object.defineProperty({__proto__:null,default:NQe},Symbol.toStringTag,{value:"Module"})),DQe=`section;#vibrato on
#vibrato <number>
$white 0-100, 0 is off, 100 is full volume
#vibrato maxdelay <seconds>
$white longer delay increases the vibrato`,LQe=Object.freeze(Object.defineProperty({__proto__:null,default:DQe},Symbol.toStringTag,{value:"Module"})),UQe=`!copyit "ar-SA-HamedNeural";ar-SA-HamedNeural
!copyit "ar-SA-ZariyahNeural";ar-SA-ZariyahNeural
!copyit "de-DE-AmalaNeural";de-DE-AmalaNeural
!copyit "de-DE-ConradNeural";de-DE-ConradNeural
!copyit "de-DE-KatjaNeural";de-DE-KatjaNeural
!copyit "de-DE-KillianNeural";de-DE-KillianNeural
!copyit "en-US-AnaNeural";en-US-AnaNeural
!copyit "en-US-AndrewNeural";en-US-AndrewNeural
!copyit "en-US-AriaNeural";en-US-AriaNeural
!copyit "en-US-ChristopherNeural";en-US-ChristopherNeural
!copyit "en-US-EricNeural";en-US-EricNeural
!copyit "en-US-GuyNeural";en-US-GuyNeural
!copyit "en-US-JennyNeural";en-US-JennyNeural
!copyit "en-US-MichelleNeural";en-US-MichelleNeural
!copyit "en-US-RogerNeural";en-US-RogerNeural
!copyit "en-US-SteffanNeural";en-US-SteffanNeural
!copyit "es-ES-AlvaroNeural";es-ES-AlvaroNeural
!copyit "es-ES-ElviraNeural";es-ES-ElviraNeural
!copyit "fr-FR-DeniseNeural";fr-FR-DeniseNeural
!copyit "fr-FR-EloiseNeural";fr-FR-EloiseNeural
!copyit "fr-FR-HenriNeural";fr-FR-HenriNeural`,BQe=Object.freeze(Object.defineProperty({__proto__:null,default:UQe},Symbol.toStringTag,{value:"Module"})),CP={},dT={};function FQe(){return{id:Sc(),board:"",layers:[],scroll:[],sidebar:[]}}const zQe=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit","bgedit"]),jQe=new Set(["tx","text"]),HQe={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},gte={};let qQe=n=>{let e=gte[n];return xe(e)||(gte[n]=e=FQe()),e};function l8(n){return qQe(n)}function Qq(n){return xe(CP[n])||(CP[n]=[]),CP[n]}function VQe(n,e,t){Object.values(dT).forEach(r=>{if(r[e]!==void 0){const i=K1(n.id(),e);Mn(t)&&Ip(i,t),Vn(t)&&uXe(i,t)}})}function GQe(n){const e=Qq(n);return CP[n]=[],e}function _te(n){const e=[];let t;for(let r=0;r<n.length;++r){const i=n[r],s=Vn(i)&&xe(kq(i));xe(t)&&t!==s&&e.push(" "),e.push(i),t=s}return e}function $Qe(n,e){Qq(n).push(e)}function WQe(n,e,t,r,i=()=>0,s=bm){const a=[e,t,...r],o=Vr(`${a[3]}`),l={...Ce};function c(u,f){xe(f)&&f!==i(u)&&(Ce.board=l.board,Ce.element=l.element,Ce.elementfocus=l.elementfocus,s(u,f))}if(zQe.has(o)){const u=`${a[2]}`;dT[e]=dT[e]??{};const f=i(u)??HQe[o];if(dT[e][u]===void 0){const h=K1(e,u);Mn(f)&&cXe(h,f),Vn(f)&&t0e(h,f),jQe.has(o)?dT[e][u]=hXe(h,g=>{c(u,g)}):dT[e][u]=fXe(h,g=>{c(u,g)})}}Qq(n).push(a)}const vte=Object.assign({"./editor/codepagename.txt":pXe,"./editor/command/become.txt":gXe,"./editor/command/bgplay.txt":vXe,"./editor/command/bgvol.txt":bXe,"./editor/command/bind.txt":EXe,"./editor/command/board.txt":TXe,"./editor/command/bpm.txt":RXe,"./editor/command/break.txt":CXe,"./editor/command/change.txt":OXe,"./editor/command/char.txt":IXe,"./editor/command/charset.txt":PXe,"./editor/command/clear.txt":LXe,"./editor/command/color.txt":BXe,"./editor/command/continue.txt":zXe,"./editor/command/copy.txt":HXe,"./editor/command/cycle.txt":VXe,"./editor/command/die.txt":$Xe,"./editor/command/distort.txt":YXe,"./editor/command/do.txt":KXe,"./editor/command/done.txt":JXe,"./editor/command/duplicate.txt":eKe,"./editor/command/echo.txt":nKe,"./editor/command/edge.txt":iKe,"./editor/command/else.txt":aKe,"./editor/command/elseif.txt":lKe,"./editor/command/end.txt":uKe,"./editor/command/endgame.txt":hKe,"./editor/command/endwith.txt":pKe,"./editor/command/fcrush.txt":gKe,"./editor/command/fetch.txt":vKe,"./editor/command/fetchwith.txt":bKe,"./editor/command/foreach.txt":EKe,"./editor/command/go.txt":TKe,"./editor/command/idle.txt":RKe,"./editor/command/if.txt":CKe,"./editor/command/lock.txt":OKe,"./editor/command/oneof.txt":IKe,"./editor/command/oneofwith.txt":PKe,"./editor/command/palette.txt":LKe,"./editor/command/phaser.txt":BKe,"./editor/command/pivot.txt":zKe,"./editor/command/play.txt":HKe,"./editor/command/put.txt":VKe,"./editor/command/putwith.txt":$Ke,"./editor/command/readbin.txt":YKe,"./editor/command/readjson.txt":KKe,"./editor/command/readline.txt":JKe,"./editor/command/readrexpaint.txt":eZe,"./editor/command/remix.txt":nZe,"./editor/command/repeat.txt":iZe,"./editor/command/restore.txt":aZe,"./editor/command/reverb.txt":lZe,"./editor/command/revert.txt":uZe,"./editor/command/run.txt":hZe,"./editor/command/runwith.txt":pZe,"./editor/command/set.txt":gZe,"./editor/command/shoot.txt":vZe,"./editor/command/shootwith.txt":bZe,"./editor/command/shove.txt":EZe,"./editor/command/snapshot.txt":TZe,"./editor/command/synth.txt":RZe,"./editor/command/toast.txt":CZe,"./editor/command/tts.txt":OZe,"./editor/command/ttsvol.txt":IZe,"./editor/command/twitchbroadcast.txt":PZe,"./editor/command/twitchchat.txt":LZe,"./editor/command/unlock.txt":BZe,"./editor/command/vibrato.txt":zZe,"./editor/command/vol.txt":HZe,"./editor/command/waitfor.txt":VZe,"./editor/command/walk.txt":$Ze,"./editor/command/weave.txt":YZe,"./editor/command/while.txt":KZe,"./editor/command/with.txt":JZe,"./editor/command/write.txt":eJe,"./editor/command/zap.txt":nJe,"./editor/comment.txt":iJe,"./editor/hyperlink.txt":aJe,"./editor/hyperlink/hotkey.txt":lJe,"./editor/hyperlink/number.txt":uJe,"./editor/hyperlink/range.txt":hJe,"./editor/hyperlink/select.txt":pJe,"./editor/hyperlink/text.txt":gJe,"./editor/label.txt":vJe,"./editor/shortgo.txt":bJe,"./editor/shorttry.txt":EJe,"./editor/stat/board.txt":TJe,"./editor/stat/charset.txt":RJe,"./editor/stat/const.txt":CJe,"./editor/stat/hotkey.txt":OJe,"./editor/stat/loader.txt":IJe,"./editor/stat/number.txt":PJe,"./editor/stat/object.txt":LJe,"./editor/stat/palette.txt":BJe,"./editor/stat/range.txt":zJe,"./editor/stat/select.txt":HJe,"./editor/stat/terrain.txt":VJe,"./editor/stat/text.txt":$Je,"./editor/text.txt":YJe,"./help/controls.txt":KJe,"./help/developer.txt":JJe,"./help/menu.txt":eQe,"./help/nopages.txt":nQe,"./help/player.txt":iQe,"./help/text.txt":aQe,"./refscroll/autowahscroll.txt":lQe,"./refscroll/distortscroll.txt":uQe,"./refscroll/echoscroll.txt":hQe,"./refscroll/effectsscroll.txt":pQe,"./refscroll/fcrushscroll.txt":gQe,"./refscroll/menu.txt":vQe,"./refscroll/notesscroll.txt":bQe,"./refscroll/oscscroll.txt":EQe,"./refscroll/phaserscroll.txt":TQe,"./refscroll/pulsescroll.txt":RQe,"./refscroll/pwmscroll.txt":CQe,"./refscroll/reverbscroll.txt":OQe,"./refscroll/synthscroll.txt":IQe,"./refscroll/termscroll.txt":PQe,"./refscroll/vibratoscroll.txt":LQe,"./refscroll/voicescroll.txt":BQe}),i0e={};ub(vte).forEach(n=>{const e=n.replace(".txt","").replace("./","").replaceAll("/",":");i0e[e]=vte[n].default});function s0e(n){const e=Vr(n.trim().replaceAll(`
`,"").replace(/:+$/,"")),t=i0e[e];if(xe(t))return t;const{target:r,path:i}=AE(e);switch(r){case"editor":{const s=AE(i);switch(s.target){case"command":if(s.path.length)return`desc;$DKGRAYsends the message ${s.path}`}break}}}function a0e(n,e){const t=(n??"").split(`
`);for(let r=0;r<t.length;++r)e(t[r].split(";"))}function YQe(n,e){const[t,...r]=e,i=r[0]??"",s=r[1]??"";switch(Vr(t.trim())){case"header":T_(St,n,i);break;case"section":HS(St,n,i);break;case"option":Tm(St,n,i,s);break;default:t.trimStart().startsWith("!")?g9(St,n,t.trimStart().slice(1),i):ts(St,n,t);break}}function XQe(n){const e={};return a0e(n,t=>{const[r,...i]=t,s=i[0]??"";e[r]=s}),e}function rb(n,e=!1){const[t]=ln(n,0,[Pt.ANY]);if(e&&q0(t)){const[r,i,s]=ln(n,0,[Pt.DIR,Pt.MAYBE_NAME]);return Vn(i)&&i.startsWith(":")?{targetdir:r,label:[i.substring(1).trim(),...n.slice(s)].join(" ")}:{targetdir:r,label:n.slice(s-1).join(" ")}}else if(Vn(t)){const[r,i,s]=ln(n,0,[Pt.NAME,Pt.MAYBE_NAME]);if(Vn(i)&&i.startsWith(":")){const o=[i.substring(1).trim(),...n.slice(s)];return{targetname:r,label:o.join(" ")}}return{targetname:"self",label:[r,...n.slice(s-1)].join(" ")}}return{targetname:"",label:""}}function RS(){pIe(St,MT())}function pT(n){a0e(s0e(`help:${n}`),e=>YQe(Ce.elementfocus,e))}function yte(n){switch(n.label){case"helpmenu":pT("menu");break;case"helpcontrols":pT("controls");break;case"helptext":pT("text");break;case"helpdeveloper":pT("developer");break;case"helpplayer":pT("player");break;default:{const e=Mv(x0.MAIN),t=ege(e);xe(n.targetname)?FL(n.targetname,n.label,void 0,t):xe(n.targetdir)&&FL(n.targetdir.destpt,n.label,void 0,t);break}}}const KQe=bb().command("endgame",()=>(xce(St,Ce.elementfocus),0)).command("shortsend",(n,e)=>{const t=rb(e);yte(t);const[r,...i]=e.map(jc);return U0(St,Ce.elementfocus,void 0,"text",`cli:${r}`,i.join(" ")),0}).command("send",(n,e)=>{const t=rb(e,!0);return yte(t),0}).command("stat",(n,e)=>(aIe(St,Ce.elementfocus,e.map(jc).join(" ")),0)).command("text",(n,e)=>{const t=e.map(jc).join(" ");if(xe(Ce.element)&&Ce.elementisplayer){const{user:r}=E1(Ce.elementid),i=Vn(r)?r:"player";Ce.element.tickertext=`${i}:$WHITE ${t}`,Ce.element.tickertime=Ce.timestamp;const s=Gm(Ce.element);g3e(St,Ce.elementid,`$${bn[s.color]}$ON${bn[s.bg]}$${s.char}$ONCLEAR$CYAN ${i}:$WHITE ${t}`),U0(St,Ce.elementid,void 0,"text","chat:message:game",`${i}:${t}`)}return 0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=jc(t),s=rb(r);if(xe(s.targetname)){const{user:a}=E1(Ce.elementid),o=Vn(a)?a:"player",l=Gm(Ce.element),c=`$${bn[l.color]}$ON${bn[l.bg]}$${l.char}$ONCLEAR $WHITE${o}$BLUE ${i}`;Ts(St,Ce.elementid,`!${s.targetname}:${s.label};${c}`)}return 0}).command("config",(n,e)=>{const[t,r]=ln(e,0,[Pt.MAYBE_NAME,Pt.MAYBE_STRING]);return Vn(t)&&Vn(r)?eX(St,Ce.elementfocus,t,r):G3e(St,Ce.elementfocus),0}).command("bookcreate",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]),r=k0e(t);return xe(r)&&n.command("bookopen",r.id),0}).command("bookopen",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=Vy(t);return xe(r)?(eX(St,Ce.elementfocus,"selected",r.id),RS()):xi(St,Ce.elementfocus,"bookopen",`book ${t} not found`),0}).command("booktrash",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=Mv(x0.MAIN),i=Vy(t);return xe(i)&&(r===i&&O0e(x0.MAIN,""),tnt(t),Ts(St,Ce.elementfocus,`trashed [book] ${i.name}`),RS(),n.command("pages")),0}).command("boardopen",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=Np(t);return xe(r)&&AT(Ce.book,Ce.elementfocus,r.id,{x:Og(0,$n-1),y:Og(0,mi-1)},!0),0}).command("pageopen",(n,e)=>{const[t,r]=ln(e,0,[Pt.NAME,Pt.MAYBE_NAME]);let i,s;const a=By();for(let o=0;o<a.length&&(s=a[o],i=DO(s,t),!xe(i));++o);if(xe(i)&&xe(s)){const o=Mh(i),l=[i.id,r];t0e(Rce(s.id,l),i.code);const c=eT(i);Y3e(St,Ce.elementfocus,s.id,l,c,`${o} - ${s.name}`)}else xi(St,"pageopen",`page ${t} not found`,Ce.elementfocus);return 0}).command("pagetrash",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=S1(x0.MAIN),i=Vme(r,t);if(xe(t)){const s=Mh(i),a=eT(i);Ts(St,Ce.elementfocus,`trashed [${a}] ${s}`),RS(),n.command("pages")}return 0}).command("help",(n,e)=>{const t=e.map(jc).join(" ")||"menu";return n.command(`help${t}`),0}).command("books",()=>{HS(St,Ce.elementfocus,"books");const n=Mv(x0.MAIN);Tm(St,Ce.elementfocus,"main",`${n?.name??"empty"} $GREEN${n?.id??""}`);const e=Mv(x0.MAIN);Tm(St,Ce.elementfocus,"content",`${e?.name??"empty"} ${e?.id??""}`),RH(St,Ce.elementfocus,7);const t=By();return t.length?t.forEach(r=>{ts(St,Ce.elementfocus,`!bookopen ${r.id};${r.name}`)}):Uy(St,Ce.elementfocus,"no books found"),ts(St,Ce.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const n=S1(x0.MAIN);if(!xe(n))return 0;HS(St,Ce.elementfocus,"pages"),Tm(St,Ce.elementfocus,"main",`${n.name} $GREEN${n.id}`),n.pages.length?zM(n).forEach(r=>{const i=Mh(r),s=eT(r);ts(St,Ce.elementfocus,`!pageopen ${r.id};$blue[${s}]$white ${i}`)}):(ts(St,Ce.elementfocus,""),pT("nopages"));const e=By();for(let t=0;t<e.length;++t){const r=e[t];r.id!==n.id&&(Tm(St,Ce.elementfocus,"content",`${r.name} $GREEN${r.id}`),zM(r).forEach(s=>{const a=Mh(s),o=eT(s);ts(St,Ce.elementfocus,`!pageopen ${s.id};$blue[${o}]$white ${a}`)}))}return 0}).command("boards",()=>{HS(St,Ce.elementfocus,"boards");const n=S1(x0.MAIN);if(xe(n)){Tm(St,Ce.elementfocus,"main",`${n.name} $GREEN${n.id}`);const t=zM(n);t.filter(r=>P1(r)===ri.BOARD).forEach(r=>{const i=Mh(r);ts(St,Ce.elementfocus,`!boardopen ${r.id};$blue[#goto]$white ${i}`)}),t.length===0&&(ts(St,Ce.elementfocus,""),Uy(St,Ce.elementfocus,"$white no boards found"),Uy(St,Ce.elementfocus,"$white use @ to create a board"),Uy(St,Ce.elementfocus,"$white @board name of board"))}const e=By();for(let t=0;t<e.length;++t){const r=e[t];r.id!==n.id&&(Tm(St,Ce.elementfocus,"content",`${r.name} $GREEN${r.id}`),zM(r).filter(s=>P1(s)===ri.BOARD).forEach(s=>{const a=Mh(s);ts(St,Ce.elementfocus,`!boardopen ${s.id};$blue[#goto]$white ${a}`)}))}return 0}).command("trash",()=>{HS(St,Ce.elementfocus,"$REDTRASH"),Uy(St,Ce.elementfocus,"books");const n=By();n.length&&(n.forEach(t=>{ts(St,Ce.elementfocus,`!booktrash ${t.id};$REDTRASH ${t.name}`)}),ts(St,Ce.elementfocus,""));const e=Mv(x0.MAIN);return xe(e)&&(Uy(St,Ce.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(t=>{const r=Mh(t);ts(St,Ce.elementfocus,`!pagetrash ${t.id};$REDTRASH ${r}`)}),ts(St,Ce.elementfocus,"")),0}).command("dev",()=>(RS(),M3e(St,Ce.elementfocus),0)).command("share",()=>(RS(),O3e(St,Ce.elementfocus),0)).command("save",()=>(RS(),0)).command("fork",()=>(mIe(St,Ce.elementfocus),0)).command("itchiopublish",()=>(gIe(St,Ce.elementfocus),0)).command("nuke",()=>(k3e(St,Ce.elementfocus),0)).command("restart",()=>(hIe(St,Ce.elementfocus),RS(),0)).command("export",()=>{T_(St,Ce.elementfocus,"E X P O R T"),HS(St,Ce.elementfocus,"books");const n=By();return n.length&&n.forEach(e=>ts(St,Ce.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=Vy(t);return xe(r)&&(T_(St,Ce.elementfocus,"E X P O R T"),HS(St,Ce.elementfocus,"pages"),setTimeout(()=>{if(r.pages.length){const i=zM(r);ts(St,Ce.elementfocus,`!bookallexport ${t};$blue[all]$white export book`),i.forEach(s=>{const a=Mh(s),o=eT(s);ts(St,Ce.elementfocus,`!pageexport ${t}:${s.id};$blue[${o}]$white ${a}`)})}},1e3)),0}).command("bookallexport",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=Vy(t);return xe(r)&&QY(St,Ce.elementfocus,El(r),`${r.name}.book.json`),0}).command("pageexport",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),{target:r,path:i}=AE(t),s=Vy(r),a=DO(s,i);return xe(a)&&QY(St,Ce.elementfocus,El(a),`${Mh(a)}.${eT(a)}.json`),0}).command("gadget",()=>($3e(St,Ce.elementfocus),0)).command("findany",(n,e)=>{const[t]=ln(e,0,[Pt.ANY]);if(ui(t)){const r=t.filter(b1);tX(St,Ce.elementfocus,r)}else tX(St,Ce.elementfocus,[]);return 0}).command("zztsearch",(n,e)=>{const[t,r]=ln(e,0,[Pt.NAME,Pt.MAYBE_NAME]),i=xe(r)?t:"title",s=xe(r)?r:t;return J3e(St,Ce.elementfocus,i,s),0}).command("zztrandom",()=>(Q3e(St,Ce.elementfocus),0)).command("admin",()=>(Z3e(St,Ce.elementfocus),0)).command("joincode",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]);return x3e(St,Ce.elementfocus,!!t),0}).command("jointab",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]);return T3e(St,Ce.elementfocus,!!t),0}).command("broadcast",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]);return t?_3e(St,Ce.elementfocus,t):v3e(St,Ce.elementfocus),0}).command("startlookingglass",()=>(I3e(St,Ce.elementfocus),0)),ZQe=bb().command("toast",(n,e)=>{const t=e.map(jc).join("");return yce(St,Ce.elementfocus,t),0}).command("ticker",(n,e)=>{const t=e.map(jc).join("");return xe(Ce.element)&&(Ce.element.tickertext=t,Ce.element.tickertime=Ce.timestamp),0}).command("palette",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=$ne(),i=k_(ri.PALETTE,t);return xe(i)?(r.palette=i.id,Ts(St,Ce.elementfocus,`loaded palette ${t}`)):xi(St,Ce.elementfocus,"not-found",`unabled to find palette ${t}`),0}).command("charset",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=$ne(),i=k_(ri.CHARSET,t);return xe(i)?(r.charset=i.id,Ts(St,Ce.elementfocus,`loaded charset ${t}`)):xi(St,Ce.elementfocus,"not-found",`unabled to find charset ${t}`),0}),JQe=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),bte=new Set(["char","color","bg","displaychar","displaycolor","displaybg","item","group","party","player","pushable","collision","breakable","p1","p2","p3","p4","p5","p6","p7","p8","p9","p10","cycle","stepx","stepy","shootx","shooty","light","lightdir","arg"]),QQe=["NORTH","SOUTH","WEST","EAST"];function eet(n,e,t){const r=E1(n);if(Mn(r.inputcurrent)||(r.inputcurrent=0),ui(r.inputqueue)||(r.inputqueue=[]),r.inputcurrent>0)return r;const[i]=r.inputqueue,[s=Tn.NONE,a=0]=i??[Tn.NONE,0];switch(r.inputmove=[],r.inputok=0,r.inputcancel=0,r.inputmenu=0,r.inputalt=a&CH?1:0,r.inputctrl=a&MH?1:0,r.inputshift=a&OH?1:0,s){case Tn.MOVE_UP:case Tn.MOVE_DOWN:case Tn.MOVE_LEFT:case Tn.MOVE_RIGHT:{const o=QQe[s-Tn.MOVE_UP];if(Vn(e)&&e==="fpv"&&Mn(t))switch(Math.round(t/90)){default:case 0:r.inputmove=[o];break;case 1:switch(o){default:case"NORTH":r.inputmove=["EAST"];break;case"EAST":r.inputmove=["SOUTH"];break;case"SOUTH":r.inputmove=["WEST"];break;case"WEST":r.inputmove=["NORTH"];break}break;case 2:switch(o){default:case"NORTH":r.inputmove=["SOUTH"];break;case"EAST":r.inputmove=["WEST"];break;case"SOUTH":r.inputmove=["NORTH"];break;case"WEST":r.inputmove=["EAST"];break}break;case 3:switch(o){default:case"NORTH":r.inputmove=["WEST"];break;case"EAST":r.inputmove=["NORTH"];break;case"SOUTH":r.inputmove=["EAST"];break;case"WEST":r.inputmove=["SOUTH"];break}break}else r.inputmove=[o];break}case Tn.OK_BUTTON:r.inputok=1;break;case Tn.CANCEL_BUTTON:r.inputcancel=1;break;case Tn.MENU_BUTTON:r.inputmenu=1;break}return r.inputcurrent=s,r.inputqueue=r.inputqueue.filter(o=>{const[l]=o;return l!==Tn.NONE&&l!==s}),r}function tet(n){const e=Kme[n];if(xe(e))return e;const t=Qme[n];if(xe(t))return t;const r=dU[n];if(xe(r))return r;const i=Cfe[n];if(xe(i))return i}function Ste(){if(zg(Ce.board,Ce.element,Ce.timestamp),!!ji(Ce.element,"item")){const e={x:Ce.element?.x??-1,y:Ce.element?.y??-1},t=LO(Ce.board,e,Ce.elementfocus);xe(t)&&(t.x=e.x,t.y=e.y)}}const net=bb({get(n,e){const t=tet(e);if(xe(t))return[!0,t];if(Ce.elementisplayer&&JQe.has(e)){const l=n.get("graphics"),c=n.get("facing"),u=eet(Ce.elementid,l,c)[e];return[xe(u),u]}const r=LO(Ce.board,{x:Ce.element?.x??-1,y:Ce.element?.y??-1},Ce.elementfocus),i=r?.id??Ce.elementfocus??MT(),s=Ce.element?.sender,a=a$e(Ce.board,Vn(s)?s:"");switch(e){case"camera":case"graphics":case"facing":{const l=E1(i)[e];return[!0,xe(l)?l:Ce.board?.[e]??0]}case"isdark":return[!0,Ce.board?.isdark?1:0];case"startx":return[!0,Ce.board?.startx??0];case"starty":return[!0,Ce.board?.starty??0];case"over":return[!0,Ce.board?.over??""];case"under":return[!0,Ce.board?.under??""];case"exitnorth":return[!0,Ce.board?.exitnorth??""];case"exitsouth":return[!0,Ce.board?.exitsouth??""];case"exitwest":return[!0,Ce.board?.exitwest??""];case"exiteast":return[!0,Ce.board?.exiteast??""];case"timelimit":return[!0,Ce.board?.timelimit??0];case"restartonzap":return[!0,Ce.board?.restartonzap??0];case"maxplayershots":return[!0,Ce.board?.maxplayershots??0];case"b1":return[!0,Ce.board?.b1??0];case"b2":return[!0,Ce.board?.b1??0];case"b3":return[!0,Ce.board?.b1??0];case"b4":return[!0,Ce.board?.b1??0];case"b5":return[!0,Ce.board?.b1??0];case"b6":return[!0,Ce.board?.b1??0];case"b7":return[!0,Ce.board?.b1??0];case"b8":return[!0,Ce.board?.b1??0];case"b9":return[!0,Ce.board?.b1??0];case"b10":return[!0,Ce.board?.b1??0];case"currenttick":return[!0,Ce.timestamp];case"boardid":return[!0,Ce.board?.id??""];case"playerid":return[!0,i];case"playerx":return[!0,r?.x??-1];case"playery":return[!0,r?.y??-1];case"thisid":return[!0,Ce.element?.id??""];case"thisx":return[!0,Ce.element?.x??-1];case"thisy":return[!0,Ce.element?.y??-1];case"senderid":return[!0,a?.id??""];case"senderx":return[!0,a?.x??-1];case"sendery":return[!0,a?.y??-1];default:{if(bte.has(e))return[!0,ji(Ce.element,e)??0];break}}const o=E1(i)[e];return[xe(o),o]},set(n,e,t){const r={x:Ce.element?.x??-1,y:Ce.element?.y??-1},s=LO(Ce.board,r,Ce.elementfocus)?.id??Ce.elementfocus;switch(e){case"camera":case"graphics":break;case"facing":t=(t%360+360)%360;break;case"isdark":if(xe(Ce.board))return Ce.board.isdark=t?1:0,[!0,Ce.board.isdark];break;case"startx":if(xe(Ce.board))return Ce.board.startx=vd(t,0),[!0,Ce.board.startx];break;case"starty":if(xe(Ce.board))return Ce.board.starty=vd(t,0),[!0,Ce.board.starty];break;case"over":if(xe(Ce.board)){const o=jc(t);return Ce.board.over!==o&&(Ce.board.overboard=void 0),Ce.board.over=o,[!0,o]}break;case"under":if(xe(Ce.board)){const o=jc(t);return Ce.board.under!==o&&(Ce.board.underboard=void 0),Ce.board.under=o,[!0,o]}break;case"exitnorth":if(xe(Ce.board))return[!0,Ce.board.exitnorth=jc(t)];break;case"exitsouth":if(xe(Ce.board))return[!0,Ce.board.exitsouth=jc(t)];break;case"exitwest":if(xe(Ce.board))return[!0,Ce.board.exitwest=jc(t)];break;case"exiteast":if(xe(Ce.board))return[!0,Ce.board.exiteast=jc(t)];break;case"timelimit":if(xe(Ce.board))return[!0,Ce.board.timelimit=vd(t,0)];break;case"restartonzap":if(xe(Ce.board))return[!0,Ce.board.restartonzap=t?1:0];break;case"maxplayershots":if(xe(Ce.board))return[!0,Ce.board.maxplayershots=vd(t,0)];break;case"b1":if(xe(Ce.board))return[!0,Ce.board.b1=vd(t,0)];break;case"b2":if(xe(Ce.board))return[!0,Ce.board.b2=vd(t,0)];break;case"b3":if(xe(Ce.board))return[!0,Ce.board.b3=vd(t,0)];break;case"b4":if(xe(Ce.board))return[!0,Ce.board.b4=vd(t,0)];break;case"b5":if(xe(Ce.board))return[!0,Ce.board.b5=vd(t,0)];break;case"b6":if(xe(Ce.board))return[!0,Ce.board.b6=vd(t,0)];break;case"b7":if(xe(Ce.board))return[!0,Ce.board.b7=vd(t,0)];break;case"b8":if(xe(Ce.board))return[!0,Ce.board.b8=vd(t,0)];break;case"b9":if(xe(Ce.board))return[!0,Ce.board.b9=vd(t,0)];break;case"b10":if(xe(Ce.board))return[!0,Ce.board.b10=vd(t,0)];break;case"currenttick":case"boardid":return[!0,t];case"playerid":case"playerx":case"playery":return[!0,t];case"thisid":case"thisx":case"thisy":return[!0,t];case"senderid":return xe(Ce.element)&&(Ce.element.sender=t),[!0,t];case"senderx":case"sendery":return[!0,t];default:{if(bte.has(e))return xe(Ce.element)&&(Ce.element[e]=t),[!0,t];break}}const a=E1(s);return xe(a)?(a[e]=t,[!0,t]):[!1,t]},everytick(n){if(Ce.elementisplayer){const e=n.get("health");Mn(e)&&e<=0&&(n.endofprogram(),xce(St,Ce.elementid))}!Ce.element?.removed&&xe(Ce.element?.x)&&xe(Ce.element.y)&&xe(Ce.element.stepx)&&xe(Ce.element.stepy)&&(Ce.element.stepx||Ce.element.stepy)&&kg(Ce.book,Ce.board,Ce.element,{x:Ce.element.x+Ce.element.stepx,y:Ce.element.y+Ce.element.stepy})}}).command("clear",(n,e)=>{for(let t=0;t<e.length;++t)n.set(jc(e[t]),0);return 0}).command("set",(n,e)=>{const[t,r]=ln(e,0,[Pt.NAME,Pt.ANY]);return n.set(t,r??1),0}).command("become",(n,e)=>{const[t]=ln(e,0,[Pt.KIND]);Up(Ce.board);const r=Gm(Ce.element),[i,s]=t,a=[...pU(r.color,r.bg),...s??[]],o=[i,a];if(Mq(Ce.board,Ce.element),zg(Ce.board,Ce.element,Ce.timestamp)){const l={x:Ce.element?.x??0,y:Ce.element?.y??0};F0(Ce.board,o,l)}return n.endofprogram(),0}).command("bind",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]),r=rR(Ce.board,t);return xe(Ce.element)&&r.length>0&&(Ce.element.code=A0(...r).code??"",ant(Ce.elementid)),0}).command("char",(n,e)=>{const[t]=ln(e,0,[Pt.ANY]);if(q0(t)){const[r,i]=ln(e,0,[Pt.DIR,Pt.NUMBER]),s=Lo(Ce.board,r.destpt);xe(s)&&(s.char=i)}else xe(Ce.element)&&Mn(t)&&(Ce.element.char=t);return 0}).command("color",(n,e)=>{const[t]=ln(e,0,[Pt.ANY]);if(q0(t)){const[r,i]=ln(e,0,[Pt.DIR,Pt.COLOR]),s=Lo(Ce.board,r.destpt);xe(s)&&PO(Ce.element,i)}else{const[r]=ln(e,0,[Pt.COLOR]);xe(Ce.element)&&xe(r)&&PO(Ce.element,r)}return 0}).command("go",(n,e)=>{if(xe(Ce.element)){const[t]=ln(e,0,[Pt.DIR]);if(kg(Ce.book,Ce.board,Ce.element,t.destpt),n.yield(),Ce.element.x===t.destpt.x&&Ce.element.y===t.destpt.y)return 0}return 1}).command("walk",(n,e)=>{if(!xe(Ce.element))return 0;const[t]=ln(e,0,[Pt.DIR]),r=Ce.element.x??0,i=Ce.element.y??0;return Ce.element.stepx=t.destpt.x-r,Ce.element.stepy=t.destpt.y-i,0}).command("idle",n=>(n.yield(),0)).command("end",n=>(n.endofprogram(),0)).command("endwith",(n,e)=>{const[t]=ln(e,0,[Pt.ANY]);return n.set("arg",t),n.command("end")}).command("lock",n=>(n.lock(n.id()),0)).command("restore",(n,e)=>(n.restore(jc(e[0])),0)).command("unlock",n=>(n.unlock(),0)).command("zap",(n,e)=>(n.zap(jc(e[0])),0)).command("cycle",(n,e)=>{if(xe(Ce.element)){const[t]=ln(e,0,[Pt.NUMBER]);Ce.element.cycle=Li(Math.round(t),1,255)}return 0}).command("die",n=>(Ste(),n.endofprogram(),0)).command("dieonend",()=>(Ste(),0)).command("run",(n,e)=>{const[t]=ln(e,0,[Pt.NAME]);return zL(t),0}).command("runwith",(n,e)=>{const[t,r]=ln(e,0,[Pt.ANY,Pt.NAME]);return n.set("arg",t),zL(r),0}),o0e={};function ret(n){return o0e[n]?.format}function HT(n){return o0e[n]?.content}function Ete(n,e){if(!xe(n))return;const t=Vr(e),r=t.endsWith("le");switch(t){case"float32":case"float32le":{const i=n.dataview.getFloat32(n.cursor,r);return n.cursor+=4,i}case"float64":case"float64le":{const i=n.dataview.getFloat64(n.cursor,r);return n.cursor+=8,i}case"int8":case"int8le":{const i=n.dataview.getInt8(n.cursor);return n.cursor+=1,i}case"int16":case"int16le":{const i=n.dataview.getInt16(n.cursor,r);return n.cursor+=2,i}case"int32":case"int32le":{const i=n.dataview.getInt32(n.cursor,r);return n.cursor+=4,i}case"int64":case"int64le":{const i=n.dataview.getBigInt64(n.cursor,r);return n.cursor+=8,i}case"uint8":case"uint8le":{const i=n.dataview.getUint8(n.cursor);return n.cursor+=1,i}case"uint16":case"uint16le":{const i=n.dataview.getUint16(n.cursor,r);return n.cursor+=2,i}case"uint32":case"uint32le":{const i=n.dataview.getUint32(n.cursor,r);return n.cursor+=4,i}case"uint64":case"uint64le":{const i=n.dataview.getBigUint64(n.cursor,r);return n.cursor+=8,i}}}const iet=(n,e)=>{const t=HT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Pt.NAME]),s=Vr(r);switch(s){case"seek":{const[a]=ln(e,i,[Pt.NUMBER]);t.cursor=a;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[a]=ln(e,i,[Pt.NAME]);n.set(a,Ete(t,s));break}case"text":{const[a,o]=ln(e,i,[Pt.NAME,Pt.NAME]),l=Ete(t,a);if(Mn(l)&&Vn(o)){const c=new Uint8Array(t.bytes.buffer,t.cursor,l),f=new TextDecoder("utf-8").decode(c);n.set(o,f),t.cursor+=l}break}case"palette":{const[a]=ln(e,i,[Pt.NAME]),[o]=j9(Ce.book,ri.PALETTE,a),l=Qf(o);if(xe(l)){const c=mfe*fw,u=rx(new Uint8Array(t.bytes.buffer,t.cursor,c));xe(u)&&(l.bits=u.bits),t.cursor+=c}break}case"charset":{const[a]=ln(e,i,[Pt.NAME]),[o]=j9(Ce.book,ri.CHARSET,a),l=Qf(o);if(xe(l)){const c=P0*y9*v9,u=ix(new Uint8Array(t.bytes.buffer,t.cursor,c));xe(u)&&(l.bits=u.bits),t.cursor+=c}break}}return 0},Cw=n=>n!==null&&Object.prototype.toString.call(n)==="[object Object]",BL=(n,e)=>{if(n===e)return!0;if(typeof n!=typeof e)return!1;if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t+=1)if(!BL(n[t],e[t]))return!1;return!0}if(Cw(n)&&Cw(e)){const t=Object.entries(n),r=new Set(Object.keys(e));if(t.length!==r.size)return!1;for(const[i,s]of t){if(!BL(s,e[i]))return!1;r.delete(i)}return r.size===0}return!1},SN=n=>{if(n===""||n===!1||n===null||n===void 0||Array.isArray(n)&&n.length===0)return!0;if(Cw(n)){for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}return!1},set=n=>n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_",xte=n=>n>="0"&&n<="9"||n==="-",aet=n=>n>="a"&&n<="z"||n>="A"&&n<="Z"||n>="0"&&n<="9"||n==="_";var en;(function(n){n.TOK_EOF="EOF",n.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",n.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",n.TOK_RBRACKET="Rbracket",n.TOK_RPAREN="Rparen",n.TOK_COMMA="Comma",n.TOK_COLON="Colon",n.TOK_RBRACE="Rbrace",n.TOK_NUMBER="Number",n.TOK_CURRENT="Current",n.TOK_ROOT="Root",n.TOK_EXPREF="Expref",n.TOK_PIPE="Pipe",n.TOK_OR="Or",n.TOK_AND="And",n.TOK_EQ="EQ",n.TOK_GT="GT",n.TOK_LT="LT",n.TOK_GTE="GTE",n.TOK_LTE="LTE",n.TOK_NE="NE",n.TOK_FLATTEN="Flatten",n.TOK_STAR="Star",n.TOK_FILTER="Filter",n.TOK_DOT="Dot",n.TOK_NOT="Not",n.TOK_LBRACE="Lbrace",n.TOK_LBRACKET="Lbracket",n.TOK_LPAREN="Lparen",n.TOK_LITERAL="Literal"})(en||(en={}));const Tte={"(":en.TOK_LPAREN,")":en.TOK_RPAREN,"*":en.TOK_STAR,",":en.TOK_COMMA,".":en.TOK_DOT,":":en.TOK_COLON,"@":en.TOK_CURRENT,$:en.TOK_ROOT,"]":en.TOK_RBRACKET,"{":en.TOK_LBRACE,"}":en.TOK_RBRACE},oet={"!":!0,"<":!0,"=":!0,">":!0},cet={"	":!0,"\n":!0,"\r":!0," ":!0};class uet{constructor(){this._current=0}tokenize(e){const t=[];this._current=0;let r,i,s;for(;this._current<e.length;)if(set(e[this._current]))r=this._current,i=this.consumeUnquotedIdentifier(e),t.push({start:r,type:en.TOK_UNQUOTEDIDENTIFIER,value:i});else if(Tte[e[this._current]]!==void 0)t.push({start:this._current,type:Tte[e[this._current]],value:e[this._current]}),this._current+=1;else if(xte(e[this._current]))s=this.consumeNumber(e),t.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),t.push(s);else if(e[this._current]==='"')r=this._current,i=this.consumeQuotedIdentifier(e),t.push({start:r,type:en.TOK_QUOTEDIDENTIFIER,value:i});else if(e[this._current]==="'")r=this._current,i=this.consumeRawStringLiteral(e),t.push({start:r,type:en.TOK_LITERAL,value:i});else if(e[this._current]==="`"){r=this._current;const a=this.consumeLiteral(e);t.push({start:r,type:en.TOK_LITERAL,value:a})}else if(oet[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&t.push(s);else if(cet[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")r=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,t.push({start:r,type:en.TOK_AND,value:"&&"})):t.push({start:r,type:en.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")r=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,t.push({start:r,type:en.TOK_OR,value:"||"})):t.push({start:r,type:en.TOK_PIPE,value:"|"});else{const a=new Error(`Unknown character: ${e[this._current]}`);throw a.name="LexerError",a}return t}consumeUnquotedIdentifier(e){const t=this._current;for(this._current+=1;this._current<e.length&&aet(e[this._current]);)this._current+=1;return e.slice(t,this._current)}consumeQuotedIdentifier(e){const t=this._current;this._current+=1;const r=e.length;for(;e[this._current]!=='"'&&this._current<r;){let i=this._current;e[i]==="\\"&&(e[i+1]==="\\"||e[i+1]==='"')?i+=2:i+=1,this._current=i}return this._current+=1,JSON.parse(e.slice(t,this._current))}consumeRawStringLiteral(e){const t=this._current;this._current+=1;const r=e.length;for(;e[this._current]!=="'"&&this._current<r;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(t+1,this._current-1).replace("\\'","'")}consumeNumber(e){const t=this._current;this._current+=1;const r=e.length;for(;xte(e[this._current])&&this._current<r;)this._current+=1;const i=parseInt(e.slice(t,this._current),10);return{start:t,value:i,type:en.TOK_NUMBER}}consumeLBracket(e){const t=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:t,type:en.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:t,type:en.TOK_FLATTEN,value:"[]"}):{start:t,type:en.TOK_LBRACKET,value:"["}}consumeOperator(e){const t=this._current,r=e[t];if(this._current+=1,r==="!")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_NE,value:"!="}):{start:t,type:en.TOK_NOT,value:"!"};if(r==="<")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_LTE,value:"<="}):{start:t,type:en.TOK_LT,value:"<"};if(r===">")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_GTE,value:">="}):{start:t,type:en.TOK_GT,value:">"};if(r==="="&&e[this._current]==="=")return this._current+=1,{start:t,type:en.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const t=this._current,r=e.length;for(;e[this._current]!=="`"&&this._current<r;){let a=this._current;e[a]==="\\"&&(e[a+1]==="\\"||e[a+1]==="`")?a+=2:a+=1,this._current=a}let i=e.slice(t,this._current).trimLeft();i=i.replace("\\`","`");const s=this.looksLikeJSON(i)?JSON.parse(i):JSON.parse(`"${i}"`);return this._current+=1,s}looksLikeJSON(e){const r=["true","false","null"],i="-0123456789";if(e==="")return!1;if('[{"'.includes(e[0])||r.includes(e))return!0;if(i.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const fet=new uet,Wd={[en.TOK_EOF]:0,[en.TOK_UNQUOTEDIDENTIFIER]:0,[en.TOK_QUOTEDIDENTIFIER]:0,[en.TOK_RBRACKET]:0,[en.TOK_RPAREN]:0,[en.TOK_COMMA]:0,[en.TOK_RBRACE]:0,[en.TOK_NUMBER]:0,[en.TOK_CURRENT]:0,[en.TOK_EXPREF]:0,[en.TOK_ROOT]:0,[en.TOK_PIPE]:1,[en.TOK_OR]:2,[en.TOK_AND]:3,[en.TOK_EQ]:5,[en.TOK_GT]:5,[en.TOK_LT]:5,[en.TOK_GTE]:5,[en.TOK_LTE]:5,[en.TOK_NE]:5,[en.TOK_FLATTEN]:9,[en.TOK_STAR]:20,[en.TOK_FILTER]:21,[en.TOK_DOT]:40,[en.TOK_NOT]:45,[en.TOK_LBRACE]:50,[en.TOK_LBRACKET]:55,[en.TOK_LPAREN]:60};class het{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const t=this.expression(0);if(this.lookahead(0)!==en.TOK_EOF){const r=this.lookaheadToken(0);this.errorToken(r,`Unexpected token type: ${r.type}, value: ${r.value}`)}return t}loadTokens(e){this.tokens=[...fet.tokenize(e),{type:en.TOK_EOF,value:"",start:e.length}]}expression(e){const t=this.lookaheadToken(0);this.advance();let r=this.nud(t),i=this.lookahead(0);for(;e<Wd[i];)this.advance(),r=this.led(i,r),i=this.lookahead(0);return r}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let t,r,i;switch(e.type){case en.TOK_LITERAL:return{type:"Literal",value:e.value};case en.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case en.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===en.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case en.TOK_NOT:return r=this.expression(Wd.Not),{type:"NotExpression",children:[r]};case en.TOK_STAR:return t={type:"Identity"},r=this.lookahead(0)===en.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(Wd.Star),{type:"ValueProjection",children:[t,r]};case en.TOK_FILTER:return this.led(e.type,{type:"Identity"});case en.TOK_LBRACE:return this.parseMultiselectHash();case en.TOK_FLATTEN:return t={type:en.TOK_FLATTEN,children:[{type:"Identity"}]},r=this.parseProjectionRHS(Wd.Flatten),{type:"Projection",children:[t,r]};case en.TOK_LBRACKET:return this.lookahead(0)===en.TOK_NUMBER||this.lookahead(0)===en.TOK_COLON?(r=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},r)):this.lookahead(0)===en.TOK_STAR&&this.lookahead(1)===en.TOK_RBRACKET?(this.advance(),this.advance(),r=this.parseProjectionRHS(Wd.Star),{children:[{type:"Identity"},r],type:"Projection"}):this.parseMultiselectList();case en.TOK_CURRENT:return{type:en.TOK_CURRENT};case en.TOK_ROOT:return{type:en.TOK_ROOT};case en.TOK_EXPREF:return i=this.expression(Wd.Expref),{type:"ExpressionReference",children:[i]};case en.TOK_LPAREN:const a=[];for(;this.lookahead(0)!==en.TOK_RPAREN;)this.lookahead(0)===en.TOK_CURRENT?(i={type:en.TOK_CURRENT},this.advance()):i=this.expression(0),a.push(i);return this.match(en.TOK_RPAREN),a[0];default:this.errorToken(e)}}led(e,t){let r;switch(e){case en.TOK_DOT:const i=Wd.Dot;return this.lookahead(0)!==en.TOK_STAR?(r=this.parseDotRHS(i),{type:"Subexpression",children:[t,r]}):(this.advance(),r=this.parseProjectionRHS(i),{type:"ValueProjection",children:[t,r]});case en.TOK_PIPE:return r=this.expression(Wd.Pipe),{type:en.TOK_PIPE,children:[t,r]};case en.TOK_OR:return r=this.expression(Wd.Or),{type:"OrExpression",children:[t,r]};case en.TOK_AND:return r=this.expression(Wd.And),{type:"AndExpression",children:[t,r]};case en.TOK_LPAREN:const s=t.name,a=[];let o;for(;this.lookahead(0)!==en.TOK_RPAREN;)this.lookahead(0)===en.TOK_CURRENT?(o={type:en.TOK_CURRENT},this.advance()):o=this.expression(0),this.lookahead(0)===en.TOK_COMMA&&this.match(en.TOK_COMMA),a.push(o);return this.match(en.TOK_RPAREN),{name:s,type:"Function",children:a};case en.TOK_FILTER:const c=this.expression(0);return this.match(en.TOK_RBRACKET),r=this.lookahead(0)===en.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(Wd.Filter),{type:"FilterProjection",children:[t,r,c]};case en.TOK_FLATTEN:const u={type:en.TOK_FLATTEN,children:[t]},f=this.parseProjectionRHS(Wd.Flatten);return{type:"Projection",children:[u,f]};case en.TOK_EQ:case en.TOK_NE:case en.TOK_GT:case en.TOK_GTE:case en.TOK_LT:case en.TOK_LTE:return this.parseComparator(t,e);case en.TOK_LBRACKET:const h=this.lookaheadToken(0);return h.type===en.TOK_NUMBER||h.type===en.TOK_COLON?(r=this.parseIndexExpression(),this.projectIfSlice(t,r)):(this.match(en.TOK_STAR),this.match(en.TOK_RBRACKET),r=this.parseProjectionRHS(Wd.Star),{type:"Projection",children:[t,r]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const t=this.lookaheadToken(0);this.errorToken(t,`Expected ${e}, got: ${t.type}`)}}errorToken(e,t=""){const r=new Error(t||`Invalid token (${e.type}): "${e.value}"`);throw r.name="ParserError",r}parseIndexExpression(){if(this.lookahead(0)===en.TOK_COLON||this.lookahead(1)===en.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(en.TOK_RBRACKET),e}projectIfSlice(e,t){const r={type:"IndexExpression",children:[e,t]};return t.type==="Slice"?{children:[r,this.parseProjectionRHS(Wd.Star)],type:"Projection"}:r}parseSliceExpression(){const e=[null,null,null];let t=0,r=this.lookahead(0);for(;r!==en.TOK_RBRACKET&&t<3;){if(r===en.TOK_COLON)t+=1,this.advance();else if(r===en.TOK_NUMBER)e[t]=this.lookaheadToken(0).value,this.advance();else{const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}r=this.lookahead(0)}return this.match(en.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,t){const r=this.expression(Wd[t]);return{type:"Comparator",name:t,children:[e,r]}}parseDotRHS(e){const t=this.lookahead(0);if([en.TOK_UNQUOTEDIDENTIFIER,en.TOK_QUOTEDIDENTIFIER,en.TOK_STAR].includes(t))return this.expression(e);if(t===en.TOK_LBRACKET)return this.match(en.TOK_LBRACKET),this.parseMultiselectList();if(t===en.TOK_LBRACE)return this.match(en.TOK_LBRACE),this.parseMultiselectHash();const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}parseProjectionRHS(e){if(Wd[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===en.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===en.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===en.TOK_DOT)return this.match(en.TOK_DOT),this.parseDotRHS(e);const t=this.lookaheadToken(0);this.errorToken(t,`Syntax error, unexpected token: ${t.value}(${t.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==en.TOK_RBRACKET;){const t=this.expression(0);if(e.push(t),this.lookahead(0)===en.TOK_COMMA&&(this.match(en.TOK_COMMA),this.lookahead(0)===en.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(en.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],t=[en.TOK_UNQUOTEDIDENTIFIER,en.TOK_QUOTEDIDENTIFIER];let r,i,s;for(;;){if(r=this.lookaheadToken(0),!t.includes(r.type))throw new Error(`Expecting an identifier token, got: ${r.type}`);if(i=r.value,this.advance(),this.match(en.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:i}),this.lookahead(0)===en.TOK_COMMA)this.match(en.TOK_COMMA);else if(this.lookahead(0)===en.TOK_RBRACE){this.match(en.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const det=new het;var Pn;(function(n){n[n.TYPE_NUMBER=0]="TYPE_NUMBER",n[n.TYPE_ANY=1]="TYPE_ANY",n[n.TYPE_STRING=2]="TYPE_STRING",n[n.TYPE_ARRAY=3]="TYPE_ARRAY",n[n.TYPE_OBJECT=4]="TYPE_OBJECT",n[n.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",n[n.TYPE_EXPREF=6]="TYPE_EXPREF",n[n.TYPE_NULL=7]="TYPE_NULL",n[n.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",n[n.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})(Pn||(Pn={}));class pet{constructor(e){this.TYPE_NAME_TABLE={[Pn.TYPE_NUMBER]:"number",[Pn.TYPE_ANY]:"any",[Pn.TYPE_STRING]:"string",[Pn.TYPE_ARRAY]:"array",[Pn.TYPE_OBJECT]:"object",[Pn.TYPE_BOOLEAN]:"boolean",[Pn.TYPE_EXPREF]:"expression",[Pn.TYPE_NULL]:"null",[Pn.TYPE_ARRAY_NUMBER]:"Array<number>",[Pn.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([t])=>Math.abs(t),this.functionAvg=([t])=>{let r=0;for(let i=0;i<t.length;i+=1)r+=t[i];return r/t.length},this.functionCeil=([t])=>Math.ceil(t),this.functionContains=t=>{const[r,i]=t;return r.includes(i)},this.functionEndsWith=t=>{const[r,i]=t;return r.includes(i,r.length-i.length)},this.functionFloor=([t])=>Math.floor(t),this.functionJoin=t=>{const[r,i]=t;return i.join(r)},this.functionKeys=([t])=>Object.keys(t),this.functionLength=([t])=>Cw(t)?Object.keys(t).length:t.length,this.functionMap=t=>{if(!this._interpreter)return[];const r=[],i=this._interpreter,s=t[0],a=t[1];for(let o=0;o<a.length;o+=1)r.push(i.visit(s,a[o]));return r},this.functionMax=([t])=>{if(!t.length)return null;if(this.getTypeName(t[0])===Pn.TYPE_NUMBER)return Math.max(...t);const i=t;let s=i[0];for(let a=1;a<i.length;a+=1)s.localeCompare(i[a])<0&&(s=i[a]);return s},this.functionMaxBy=t=>{const r=t[1],i=t[0],s=this.createKeyFunction(r,[Pn.TYPE_NUMBER,Pn.TYPE_STRING]);let a=-1/0,o,l;for(let c=0;c<i.length;c+=1)l=s&&s(i[c]),l!==void 0&&l>a&&(a=l,o=i[c]);return o},this.functionMerge=t=>{let r={};for(let i=0;i<t.length;i+=1){const s=t[i];r=Object.assign(r,s)}return r},this.functionMin=([t])=>{if(!t.length)return null;if(this.getTypeName(t[0])===Pn.TYPE_NUMBER)return Math.min(...t);const i=t;let s=i[0];for(let a=1;a<i.length;a+=1)i[a].localeCompare(s)<0&&(s=i[a]);return s},this.functionMinBy=t=>{const r=t[1],i=t[0],s=this.createKeyFunction(r,[Pn.TYPE_NUMBER,Pn.TYPE_STRING]);let a=1/0,o,l;for(let c=0;c<i.length;c+=1)l=s&&s(i[c]),l!==void 0&&l<a&&(a=l,o=i[c]);return o},this.functionNotNull=t=>{for(let r=0;r<t.length;r+=1)if(this.getTypeName(t[r])!==Pn.TYPE_NULL)return t[r];return null},this.functionReverse=([t])=>{if(this.getTypeName(t)===Pn.TYPE_STRING){const s=t;let a="";for(let o=s.length-1;o>=0;o-=1)a+=s[o];return a}const i=t.slice(0);return i.reverse(),i},this.functionSort=([t])=>[...t].sort(),this.functionSortBy=t=>{if(!this._interpreter)return[];const r=t[0].slice(0);if(r.length===0)return r;const i=this._interpreter,s=t[1],a=this.getTypeName(i.visit(s,r[0]));if(a!==void 0&&![Pn.TYPE_NUMBER,Pn.TYPE_STRING].includes(a))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[a]})`);const o=[];for(let l=0;l<r.length;l+=1)o.push([l,r[l]]);o.sort((l,c)=>{const u=i.visit(s,l[1]),f=i.visit(s,c[1]);if(this.getTypeName(u)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(f)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(f)]}`);return u>f?1:u<f?-1:l[0]-c[0]});for(let l=0;l<o.length;l+=1)r[l]=o[l][1];return r},this.functionStartsWith=([t,r])=>t.startsWith(r),this.functionSum=([t])=>t.reduce((r,i)=>r+i,0),this.functionToArray=([t])=>this.getTypeName(t)===Pn.TYPE_ARRAY?t:[t],this.functionToNumber=([t])=>{const r=this.getTypeName(t);let i;return r===Pn.TYPE_NUMBER?t:r===Pn.TYPE_STRING&&(i=+t,!isNaN(i))?i:null},this.functionToString=([t])=>this.getTypeName(t)===Pn.TYPE_STRING?t:JSON.stringify(t),this.functionType=([t])=>{switch(this.getTypeName(t)){case Pn.TYPE_NUMBER:return"number";case Pn.TYPE_STRING:return"string";case Pn.TYPE_ARRAY:return"array";case Pn.TYPE_OBJECT:return"object";case Pn.TYPE_BOOLEAN:return"boolean";case Pn.TYPE_EXPREF:return"expref";case Pn.TYPE_NULL:return"null";default:return}},this.functionValues=([t])=>Object.values(t),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[Pn.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[Pn.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY]},{types:[Pn.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[Pn.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[Pn.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY,Pn.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[Pn.TYPE_EXPREF]},{types:[Pn.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER,Pn.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[Pn.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER,Pn.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[Pn.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[Pn.TYPE_ARRAY_STRING,Pn.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[Pn.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[Pn.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[Pn.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[Pn.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[Pn.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,t,r){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:t.bind(this),_signature:r}}callFunction(e,t){const r=this.functionTable[e];if(r===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,t,r._signature),r._func.call(this,t)}validateInputSignatures(e,t){for(let r=0;r<t.length;r+=1)if("variadic"in t[r]&&r!==t.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${r+1} must occur last`)}validateArgs(e,t,r){var i,s;let a;this.validateInputSignatures(e,r);const o=r.filter(_=>{var y;return(y=!_.optional)!==null&&y!==void 0?y:!1}).length,l=(s=(i=r[r.length-1])===null||i===void 0?void 0:i.variadic)!==null&&s!==void 0?s:!1,c=t.length<o,u=t.length>r.length,f=c&&(!l&&o>1||l)?"at least ":"";if(l&&c||!l&&(c||u))throw a=r.length>1,new Error(`ArgumentError: ${e}() takes ${f}${o} argument${a&&"s"||""} but received ${t.length}`);let h,g,p;for(let _=0;_<r.length;_+=1){p=!1,h=r[_].types,g=this.getTypeName(t[_]);let y;for(y=0;y<h.length;y+=1)if(g!==void 0&&this.typeMatches(g,h[y],t[_])){p=!0;break}if(!p&&g!==void 0){const v=h.map(x=>this.TYPE_NAME_TABLE[x]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${_+1} to be type (${v}) but received type ${this.TYPE_NAME_TABLE[g]} instead.`)}}}typeMatches(e,t,r){if(t===Pn.TYPE_ANY)return!0;if(t===Pn.TYPE_ARRAY_STRING||t===Pn.TYPE_ARRAY_NUMBER||t===Pn.TYPE_ARRAY){if(t===Pn.TYPE_ARRAY)return e===Pn.TYPE_ARRAY;if(e===Pn.TYPE_ARRAY){let i;t===Pn.TYPE_ARRAY_NUMBER?i=Pn.TYPE_NUMBER:t===Pn.TYPE_ARRAY_STRING&&(i=Pn.TYPE_STRING);for(let s=0;s<r.length;s+=1){const a=this.getTypeName(r[s]);if(a!==void 0&&i!==void 0&&!this.typeMatches(a,i,r[s]))return!1}return!0}}else return e===t;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return Pn.TYPE_STRING;case"[object Number]":return Pn.TYPE_NUMBER;case"[object Array]":return Pn.TYPE_ARRAY;case"[object Boolean]":return Pn.TYPE_BOOLEAN;case"[object Null]":return Pn.TYPE_NULL;case"[object Object]":return e.jmespathType===en.TOK_EXPREF?Pn.TYPE_EXPREF:Pn.TYPE_OBJECT;default:return}}createKeyFunction(e,t){if(!this._interpreter)return;const r=this._interpreter;return s=>{const a=r.visit(e,s);if(!t.includes(this.getTypeName(a))){const o=`TypeError: expected one of (${t.map(l=>this.TYPE_NAME_TABLE[l]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(a)]}`;throw new Error(o)}return a}}}class met{constructor(){this._rootValue=null,this.runtime=new pet(this)}search(e,t){return this._rootValue=t,this.visit(e,t)}visit(e,t){let r,i,s,a,o,l,c,u,f,h,g;switch(e.type){case"Field":return t===null?null:Cw(t)?(l=t[e.name],l===void 0?null:l):null;case"Subexpression":for(s=this.visit(e.children[0],t),h=1;h<e.children.length;h+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return c=this.visit(e.children[0],t),u=this.visit(e.children[1],c),u;case"Index":if(!Array.isArray(t))return null;let p=e.value;return p<0&&(p=t.length+p),s=t[p],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(t))return null;const _=[...e.children],y=this.computeSliceParams(t.length,_),[v,x,E]=y;if(s=[],E>0)for(h=v;h<x;h+=E)s.push(t[h]);else for(h=v;h>x;h+=E)s.push(t[h]);return s;case"Projection":if(g=this.visit(e.children[0],t),!Array.isArray(g))return null;for(f=[],h=0;h<g.length;h+=1)i=this.visit(e.children[1],g[h]),i!==null&&f.push(i);return f;case"ValueProjection":if(g=this.visit(e.children[0],t),!Cw(g))return null;f=[];const M=Object.values(g);for(h=0;h<M.length;h+=1)i=this.visit(e.children[1],M[h]),i!==null&&f.push(i);return f;case"FilterProjection":if(g=this.visit(e.children[0],t),!Array.isArray(g))return null;const k=[],N=[];for(h=0;h<g.length;h+=1)r=this.visit(e.children[2],g[h]),SN(r)||k.push(g[h]);for(let B=0;B<k.length;B+=1)i=this.visit(e.children[1],k[B]),i!==null&&N.push(i);return N;case"Comparator":switch(a=this.visit(e.children[0],t),o=this.visit(e.children[1],t),e.name){case en.TOK_EQ:s=BL(a,o);break;case en.TOK_NE:s=!BL(a,o);break;case en.TOK_GT:s=a>o;break;case en.TOK_GTE:s=a>=o;break;case en.TOK_LT:s=a<o;break;case en.TOK_LTE:s=a<=o;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case en.TOK_FLATTEN:const I=this.visit(e.children[0],t);if(!Array.isArray(I))return null;let D=[];for(h=0;h<I.length;h+=1)i=I[h],Array.isArray(i)?D=[...D,...i]:D.push(i);return D;case"Identity":return t;case"MultiSelectList":if(t===null)return null;for(f=[],h=0;h<e.children.length;h+=1)f.push(this.visit(e.children[h],t));return f;case"MultiSelectHash":if(t===null)return null;f={};let V;for(h=0;h<e.children.length;h+=1)V=e.children[h],f[V.name]=this.visit(V.value,t);return f;case"OrExpression":return r=this.visit(e.children[0],t),SN(r)&&(r=this.visit(e.children[1],t)),r;case"AndExpression":return a=this.visit(e.children[0],t),SN(a)?a:this.visit(e.children[1],t);case"NotExpression":return a=this.visit(e.children[0],t),SN(a);case"Literal":return e.value;case en.TOK_PIPE:return c=this.visit(e.children[0],t),this.visit(e.children[1],c);case en.TOK_CURRENT:return t;case en.TOK_ROOT:return this._rootValue;case"Function":const G=[];for(let B=0;B<e.children.length;B+=1)G.push(this.visit(e.children[B],t));return this.runtime.callFunction(e.name,G);case"ExpressionReference":const J=e.children[0];return J.jmespathType=en.TOK_EXPREF,J;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,t){let[r,i,s]=t;if(s===null)s=1;else if(s===0){const o=new Error("Invalid slice, step cannot be 0");throw o.name="RuntimeError",o}const a=s<0;return r=r===null?a?e-1:0:this.capSliceRange(e,r,s),i=i===null?a?-1:e:this.capSliceRange(e,i,s),[r,i,s]}capSliceRange(e,t,r){let i=t;return i<0?(i+=e,i<0&&(i=r<0?-1:0)):i>=e&&(i=r<0?e-1:e),i}}const get=new met;Pn.TYPE_ANY;Pn.TYPE_ARRAY;Pn.TYPE_ARRAY_NUMBER;Pn.TYPE_ARRAY_STRING;Pn.TYPE_BOOLEAN;Pn.TYPE_EXPREF;Pn.TYPE_NULL;Pn.TYPE_NUMBER;Pn.TYPE_OBJECT;Pn.TYPE_STRING;function _et(n,e){const t=det.parse(e);return get.search(t,n)}const vet=(n,e)=>{const t=HT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Pt.NAME,Pt.NAME]),s=_et(t.json,r);return n.set(i,s),0},yet=(n,e)=>{const t=HT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Pt.NAME]);switch(Vr(r)){case"seek":{const[a]=ln(e,i,[Pt.NUMBER]);t.cursor=Li(a,0,t.lines.length-1);break}case"line":t.cursor=Li(t.cursor+1,0,t.lines.length-1);break;default:{const a=t.lines[t.cursor]??"",l=new RegExp(r,"i").exec(a)??[];let c=1;for(let u=i;u<e.length;){const[f,h]=ln(e,u,[Pt.NAME]);n.set(f,l[c]??0),++c,u=h}break}}return 0};function wte(n){const e=Mv(x0.MAIN),t=ege(e);xe(n.targetdir)?FL(n.targetdir.destpt,n.label,void 0,t):xe(n.targetname)&&FL(n.targetname,n.label,void 0,t)}const bet=bb({get(n,e){const t=ret(n.id());if(e==="format")return[!0,t];switch(t){case"text":{const r=HT(n.id());switch(e){case"filename":return[!0,r.filename];case"cursor":return[!0,r.cursor];case"lines":return[!0,r.lines.length]}break}case"json":{const r=HT(n.id());switch(e){case"filename":return[!0,r.filename]}break}case"binary":{const r=HT(n.id());switch(e){case"filename":return[!0,r.filename];case"cursor":return[!0,r.cursor];case"bytes":return[!0,r.bytes.length]}break}}return[!1,void 0]}}).command("endgame",()=>0).command("shortsend",(n,e)=>{const t=rb(e);return wte(t),0}).command("send",(n,e)=>{const t=rb(e,!0);return wte(t),0}).command("stat",()=>0).command("text",(n,e)=>{const t=e.map(jc).join(" ");return Ts(St,Ce.elementfocus,"$175",t),0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=jc(t),s=rb(r);return xe(s.targetname)&&Ts(St,Ce.elementfocus,"$175",`!${s.targetname}${s.label};${i}`),0}).command("readline",yet).command("readjson",vet).command("readbin",iet).command("withboard",(n,e)=>{const[t]=ln(e,0,[Pt.STRING]),r=Np(t);return xe(r)&&(Ce.board=r,Ce.element={x:-1,y:-1}),0});function Rte(n,e,t,r,i,s){const a=[];for(let o=s;o<i.length;){const[l,c]=ln(i,o,[Pt.ANY]);ui(l)&&!q0(l)&&!FO(l)&&!CL(l)&&!Lp(l)?a.push(...l):a.push(l),o=c}switch(Vr(r)){case"get":case"post:json":S3e(St,Ce.elementfocus,n,e,t,r,a);break}return 0}const Eet=bb().command("fetch",(n,e)=>{const[t,r,i="get",s]=ln(e,0,[Pt.NAME,Pt.NAME,Pt.MAYBE_STRING]);return Rte(void 0,t,r,i,e,s),0}).command("fetchwith",(n,e)=>{const[t,r,i,s="get",a]=ln(e,0,[Pt.ANY,Pt.NAME,Pt.NAME,Pt.MAYBE_STRING]);return Rte(t,r,i,s,e,a),0}).command("chat",(n,e)=>{const[t]=ln(e,0,[Pt.MAYBE_NAME]);return t?y3e(St,Ce.elementfocus,t):b3e(St,Ce.elementfocus),0});function jM(n,e,t){if(xe(Ce.board)){switch(t){case"shot":case"bombed":ji(e,"breakable")&&zg(Ce.board,e,Ce.timestamp);break}xe(e?.id)&&n.send(Ce.elementfocus,e.id,t)}}function Ate(n,e){if(xe(e.targetname)){const t=Object.keys(Ce.board?.objects??{});switch(e.targetname){case"all":for(let r=0;r<t.length;++r){const i=t[r],s=Fg(Ce.board,i);xe(s)&&jM(n,s,e.label)}break;case"others":for(let r=0;r<t.length;++r){const i=t[r],s=Fg(Ce.board,i);i!==n.id()&&xe(s)&&jM(n,s,e.label)}break;case"self":Ce.elementid!==n.id()?n.send(Ce.elementfocus,Ce.elementid,e.label):n.message({session:St.session(),player:Ce.elementfocus,id:Sc(),sender:Ce.elementid,target:e.label});break;default:{const r=Gme(Ce.board,[e.targetname]);for(let i=0;i<r.length;++i){const s=r[i];xe(s)&&jM(n,s,e.label)}break}}}else if(xe(e.targetdir))if(e.targetdir.targets.length)for(let t=0;t<e.targetdir.targets.length;++t){const r=Lo(Ce.board,e.targetdir.targets[t]);xe(r)&&jM(n,r,e.label)}else{const t=Lo(Ce.board,e.targetdir.destpt);xe(t)&&jM(n,t,e.label)}}const xet=bb({set(n,e,t){return VQe(n,e,t),[!1,void 0]},aftertick(){const n=GQe(Ce.elementid),[e]=n;if(n.length===1&&Vn(e)){if(xe(Ce.element))if(e.trim().length===0){const t=l8(Ce.elementid);t.sidebar=[]}else Ce.element.tickertext=e,Ce.element.tickertime=Ce.timestamp}else if(n.length>1)if(Ce.elementisplayer){const t=l8(Ce.elementid);t.sidebar=_te(n)}else{const t=l8(Ce.elementfocus);t.scrollname=Ce.element?.name??Ce.element?.kinddata?.name??"",t.scroll=_te(n)}}}).command("endgame",n=>(n.set("health",0),0)).command("shortsend",(n,e)=>{const t=rb(e);return Ate(n,t),0}).command("send",(n,e)=>{const t=rb(e,!0);return Ate(n,t),0}).command("stat",()=>0).command("text",(n,e)=>{const t=e.map(jc).join("");return $Qe(Ce.elementid,t),0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=jc(t),s=rb(r);return xe(s.targetname)&&WQe(Ce.elementid,n.id(),i,`${s.targetname}:${s.label}`.split(" "),n.get,n.set),0});function Tet(n,e,t,r,i){if(!xe(Ce.book))return;const s=Ce.book,a=qg(s,ri.BOARD,n),o=Qf(a);if(!xe(o))return;const l=DU(),c=i==="all"||i==="object",u=i==="all"||i==="terrain";Up(o),Up(l);const f=-Math.tan(e*.5),h=Math.sin(e),g=Math.round(12.5*f),p=Math.round(12.5*h),_=new Array(mi).fill(0);yQ(g,0,-g,mi-1).forEach(M=>{M.x<0?_[M.y]=Math.min(_[M.y],M.x):_[M.y]=Math.max(_[M.y],M.x)});const v=new Array($n).fill(0);yQ(0,p,$n-1,-p).forEach(M=>{M.y<0?v[M.x]=Math.min(v[M.x],M.y):v[M.x]=Math.max(v[M.x],M.y)});const E=[_,v,_];for(let M=0;M<E.length;++M){const k=E[M];if(M!==1){for(let N=0;N<mi;++N){const I=k[N],D=N*$n;for(let V=0;V<$n;V++){const G=(V+I+$n)%$n;u&&(l.terrain[G+D]=o.terrain[V+D])}}if(c){const N=Object.keys(o.objects);for(let I=0;I<N.length;++I){const D=N[I],{x:V,y:G}=o.objects[D];if(xe(V)&&xe(G)){const J=k[G];o.objects[D].x=(V+J+$n)%$n,o.objects[D].lx=o.objects[D].x}}}}if(M===1){for(let N=0;N<$n;++N){const I=k[N];for(let D=0;D<mi;++D){const V=(D+I+mi)%mi;u&&(l.terrain[N+V*$n]=o.terrain[N+D*$n])}}if(c){const N=Object.keys(o.objects);for(let I=0;I<N.length;++I){const D=N[I],{x:V,y:G}=o.objects[D];if(xe(V)&&xe(G)){const J=k[V];o.objects[D].y=(G+J+mi)%mi,o.objects[D].ly=o.objects[D].y}}}}u&&(o.terrain=[...l.terrain]),delete l.named,delete l.lookup,delete o.named,delete o.lookup,Up(l),Up(o)}}var c8,Cte;function wet(){if(Cte)return c8;Cte=1;function n(e,t){let r=0,i=0,s=0;for(;s<e.length;s++)r+=e[s];for(s=0,t*=r;t&&s<e.length;){if(i+=e[s],t<=i)return s;s++}return 0}return c8=n,c8}var u8,Mte;function l0e(){if(Mte)return u8;Mte=1;const n=wet(),e=function(){};return e.prototype.FMX=0,e.prototype.FMY=0,e.prototype.FMXxFMY=0,e.prototype.T=0,e.prototype.N=0,e.prototype.initiliazedField=!1,e.prototype.generationComplete=!1,e.prototype.wave=null,e.prototype.compatible=null,e.prototype.weightLogWeights=null,e.prototype.sumOfWeights=0,e.prototype.sumOfWeightLogWeights=0,e.prototype.startingEntropy=0,e.prototype.sumsOfOnes=null,e.prototype.sumsOfWeights=null,e.prototype.sumsOfWeightLogWeights=null,e.prototype.entropies=null,e.prototype.propagator=null,e.prototype.observed=null,e.prototype.distribution=null,e.prototype.stack=null,e.prototype.stackSize=0,e.prototype.DX=[-1,0,1,0],e.prototype.DY=[0,1,0,-1],e.prototype.opposite=[2,3,0,1],e.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let t=0;t<this.FMXxFMY;t++){this.wave[t]=new Array(this.T),this.compatible[t]=new Array(this.T);for(let r=0;r<this.T;r++)this.compatible[t][r]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0},e.prototype.observe=function(t){let r=1e3,i=-1;for(let o=0;o<this.FMXxFMY;o++){if(this.onBoundary(o%this.FMX,o/this.FMX|0))continue;const l=this.sumsOfOnes[o];if(l===0)return!1;const c=this.entropies[o];if(l>1&&c<=r){const u=1e-6*t();c+u<r&&(r=c+u,i=o)}}if(i===-1){this.observed=new Array(this.FMXxFMY);for(let o=0;o<this.FMXxFMY;o++)for(let l=0;l<this.T;l++)if(this.wave[o][l]){this.observed[o]=l;break}return!0}for(let o=0;o<this.T;o++)this.distribution[o]=this.wave[i][o]?this.weights[o]:0;const s=n(this.distribution,t()),a=this.wave[i];for(let o=0;o<this.T;o++)a[o]!==(o===s)&&this.ban(i,o);return null},e.prototype.propagate=function(){for(;this.stackSize>0;){const t=this.stack[this.stackSize-1];this.stackSize--;const r=t[0],i=r%this.FMX,s=r/this.FMX|0;for(let a=0;a<4;a++){const o=this.DX[a],l=this.DY[a];let c=i+o,u=s+l;if(this.onBoundary(c,u))continue;c<0?c+=this.FMX:c>=this.FMX&&(c-=this.FMX),u<0?u+=this.FMY:u>=this.FMY&&(u-=this.FMY);const f=c+u*this.FMX,h=this.propagator[a][t[1]],g=this.compatible[f];for(let p=0;p<h.length;p++){const _=h[p],y=g[_];y[a]--,y[a]==0&&this.ban(f,_)}}}},e.prototype.singleIteration=function(t){const r=this.observe(t);return r!==null?(this.generationComplete=r,!!r):(this.propagate(),null)},e.prototype.iterate=function(t,r){this.wave||this.initialize(),this.initiliazedField||this.clear(),t=t||0,r=r||Math.random;for(let i=0;i<t||t===0;i++){const s=this.singleIteration(r);if(s!==null)return!!s}return!0},e.prototype.generate=function(t){for(t=t||Math.random,this.wave||this.initialize(),this.clear();;){const r=this.singleIteration(t);if(r!==null)return!!r}},e.prototype.isGenerationComplete=function(){return this.generationComplete},e.prototype.ban=function(t,r){const i=this.compatible[t][r];for(let a=0;a<4;a++)i[a]=0;this.wave[t][r]=!1,this.stack[this.stackSize]=[t,r],this.stackSize++,this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[r],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[r];const s=this.sumsOfWeights[t];this.entropies[t]=Math.log(s)-this.sumsOfWeightLogWeights[t]/s},e.prototype.clear=function(){for(let t=0;t<this.FMXxFMY;t++){for(let r=0;r<this.T;r++){this.wave[t][r]=!0;for(let i=0;i<4;i++)this.compatible[t][r][i]=this.propagator[this.opposite[i]][r].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1},u8=e,u8}var f8,Ote;function Ret(){if(Ote)return f8;Ote=1;const n=l0e(),e=function(r,i,s,a,o,l,c,u,f,h){h=h||0,this.N=a,this.FMX=o,this.FMY=l,this.FMXxFMY=o*l,this.periodic=u;const g=i,p=new Array(g);for(let J=0;J<g;J++)p[J]=new Array(s);this.colors=[];const _={};for(let J=0;J<s;J++)for(let B=0;B<i;B++){const $=(J*i+B)*4,U=[r[$],r[$+1],r[$+2],r[$+3]],Q=U.join("-");_.hasOwnProperty(Q)||(_[Q]=this.colors.length,this.colors.push(U)),p[B][J]=_[Q]}const y=this.colors.length,v=Math.pow(y,a*a),x=function(B){let $=new Array(a*a);for(let U=0;U<a;U++)for(let Q=0;Q<a;Q++)$[Q+U*a]=B(Q,U);return $},E=function(B,$){return x(function(U,Q){return p[(B+U)%i][($+Q)%s]})},M=function(B){return x(function($,U){return B[a-1-U+$*a]})},k=function(B){return x(function($,U){return B[a-1-$+U*a]})},N=function(B){let $=0,U=1;for(let Q=0;Q<B.length;Q++)$+=B[B.length-1-Q]*U,U*=y;return $},I=function(B){let $=B,U=v;const Q=new Array(a*a);for(let W=0;W<Q.length;W++){U/=y;let q=0;for(;$>=U;)$-=U,q++;Q[W]=q}return Q},D={},V=[];for(let J=0;J<(c?s:s-a+1);J++)for(let B=0;B<(c?i:i-a+1);B++){const $=new Array(8);$[0]=E(B,J),$[1]=k($[0]),$[2]=M($[0]),$[3]=k($[2]),$[4]=M($[2]),$[5]=k($[4]),$[6]=M($[4]),$[7]=k($[6]);for(let U=0;U<f;U++){const Q=N($[U]);D[Q]?D[Q]++:(V.push(Q),D[Q]=1)}}this.T=V.length,this.ground=(h+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let J=0;J<this.T;J++){const B=parseInt(V[J],10);this.patterns[J]=I(B),this.weights[J]=D[B]}const G=function(B,$,U,Q){const W=U<0?0:U,q=U<0?U+a:a,Y=Q<0?0:Q,ae=Q<0?Q+a:a;for(let Z=Y;Z<ae;Z++)for(let K=W;K<q;K++)if(B[K+a*Z]!=$[K-U+a*(Z-Q)])return!1;return!0};this.propagator=new Array(4);for(let J=0;J<4;J++){this.propagator[J]=new Array(this.T);for(let B=0;B<this.T;B++){const $=[];for(let U=0;U<this.T;U++)G(this.patterns[B],this.patterns[U],this.DX[J],this.DY[J])&&$.push(U);this.propagator[J][B]=$}}};return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(t,r){return!this.periodic&&(t+this.N>this.FMX||r+this.N>this.FMY||t<0||r<0)},e.prototype.clear=function(){if(n.prototype.clear.call(this),this.ground!==0){for(let t=0;t<this.FMX;t++){for(let r=0;r<this.T;r++)r!==this.ground&&this.ban(t+(this.FMY-1)*this.FMX,r);for(let r=0;r<this.FMY-1;r++)this.ban(t+r*this.FMX,this.ground)}this.propagate()}},e.prototype.graphics=function(t){return t=t||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t),t},e.prototype.graphicsComplete=function(t){for(let r=0;r<this.FMY;r++){const i=r<this.FMY-this.N+1?0:this.N-1;for(let s=0;s<this.FMX;s++){const a=s<this.FMX-this.N+1?0:this.N-1,o=(r*this.FMX+s)*4,l=this.colors[this.patterns[this.observed[s-a+(r-i)*this.FMX]][a+i*this.N]];t[o]=l[0],t[o+1]=l[1],t[o+2]=l[2],t[o+3]=l[3]}}},e.prototype.graphicsIncomplete=function(t){for(let r=0;r<this.FMXxFMY;r++){const i=r%this.FMX,s=r/this.FMX|0;let a=0,o=0,l=0,c=0,u=0;for(let h=0;h<this.N;h++)for(let g=0;g<this.N;g++){let p=i-g;p<0&&(p+=this.FMX);let _=s-h;if(_<0&&(_+=this.FMY),this.onBoundary(p,_))continue;const y=p+_*this.FMX;for(let v=0;v<this.T;v++)if(this.wave[y][v]){a++;const x=this.colors[this.patterns[v][g+h*this.N]];o+=x[0],l+=x[1],c+=x[2],u+=x[3]}}const f=r*4;t[f]=o/a,t[f+1]=l/a,t[f+2]=c/a,t[f+3]=u/a}},f8=e,f8}var h8,kte;function Aet(){if(kte)return h8;kte=1;const n=l0e(),e=function(r,i,s,a,o){const l=r.tilesize||16;this.FMX=s,this.FMY=a,this.FMXxFMY=s*a,this.periodic=o,this.tilesize=l;const c=!!r.unique;let u=null;i&&r.subsets&&r.subsets[i]&&(u=r.subsets[i]);const f=function(N){const I=new Array(l*l);for(let D=0;D<l;D++)for(let V=0;V<l;V++)I[V+D*l]=N(V,D);return I},h=function(N){return f(function(I,D){return N[l-1-D+I*l]})},g=function(N){return f(function(I,D){return N[l-1-I+D*l]})};this.tiles=[];const p=[],_=[],y={};let v,x,E;for(let k=0;k<r.tiles.length;k++){const N=r.tiles[k];if(u!==null&&u.indexOf(N.name)===-1)continue;switch(N.symmetry){case"L":E=4,v=function(D){return(D+1)%4},x=function(D){return D%2===0?D+1:D-1};break;case"T":E=4,v=function(D){return(D+1)%4},x=function(D){return D%2===0?D:4-D};break;case"I":E=2,v=function(D){return 1-D},x=function(D){return D};break;case"\\":E=2,v=function(D){return 1-D},x=function(D){return 1-D};break;case"F":E=8,v=function(D){return D<4?(D+1)%4:4+(D-1)%4},x=function(D){return D<4?D+4:D-4};break;default:E=1,v=function(D){return D},x=function(D){return D};break}this.T=_.length,y[N.name]=this.T;for(let D=0;D<E;D++)_.push([this.T+D,this.T+v(D),this.T+v(v(D)),this.T+v(v(v(D))),this.T+x(D),this.T+x(v(D)),this.T+x(v(v(D))),this.T+x(v(v(v(D))))]);let I;if(c)for(let D=0;D<E;D++)I=N.bitmap[D],this.tiles.push(f(function(V,G){return[I[(l*G+V)*4],I[(l*G+V)*4+1],I[(l*G+V)*4+2],I[(l*G+V)*4+3]]}));else{I=N.bitmap,this.tiles.push(f(function(D,V){return[I[(l*V+D)*4],I[(l*V+D)*4+1],I[(l*V+D)*4+2],I[(l*V+D)*4+3]]}));for(let D=1;D<E;D++)this.tiles.push(D<4?h(this.tiles[this.T+D-1]):g(this.tiles[this.T+D-4]))}for(let D=0;D<E;D++)p.push(N.weight||1)}this.T=_.length,this.weights=p,this.propagator=new Array(4);const M=new Array(4);for(let k=0;k<4;k++){this.propagator[k]=new Array(this.T),M[k]=new Array(this.T);for(let N=0;N<this.T;N++){M[k][N]=new Array(this.T);for(let I=0;I<this.T;I++)M[k][N][I]=!1}}for(let k=0;k<r.neighbors.length;k++){const N=r.neighbors[k],I=N.left.split(" ").filter(function($){return $.length}),D=N.right.split(" ").filter(function($){return $.length});if(u!==null&&(u.indexOf(I[0])===-1||u.indexOf(D[0])===-1))continue;const V=_[y[I[0]]][I.length==1?0:parseInt(I[1],10)],G=_[V][1],J=_[y[D[0]]][D.length==1?0:parseInt(D[1],10)],B=_[J][1];M[0][J][V]=!0,M[0][_[J][6]][_[V][6]]=!0,M[0][_[V][4]][_[J][4]]=!0,M[0][_[V][2]][_[J][2]]=!0,M[1][B][G]=!0,M[1][_[G][6]][_[B][6]]=!0,M[1][_[B][4]][_[G][4]]=!0,M[1][_[G][2]][_[B][2]]=!0}for(let k=0;k<this.T;k++)for(let N=0;N<this.T;N++)M[2][k][N]=M[0][N][k],M[3][k][N]=M[1][N][k];for(let k=0;k<4;k++)for(let N=0;N<this.T;N++){const I=[],D=M[k][N];for(let V=0;V<this.T;V++)D[V]&&I.push(V);this.propagator[k][N]=I}};return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(t,r){return!this.periodic&&(t<0||r<0||t>=this.FMX||r>=this.FMY)},e.prototype.graphics=function(t,r){return t=t||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,r),t},e.prototype.graphicsComplete=function(t){for(let r=0;r<this.FMX;r++)for(let i=0;i<this.FMY;i++){const s=this.tiles[this.observed[r+i*this.FMX]];for(let a=0;a<this.tilesize;a++)for(let o=0;o<this.tilesize;o++){const l=(r*this.tilesize+o+(i*this.tilesize+a)*this.FMX*this.tilesize)*4,c=s[o+a*this.tilesize];t[l]=c[0],t[l+1]=c[1],t[l+2]=c[2],t[l+3]=c[3]}}},e.prototype.graphicsIncomplete=function(t,r){(!r||r.length!==4)&&(r=!1);for(let i=0;i<this.FMX;i++)for(let s=0;s<this.FMY;s++){const a=this.wave[i+s*this.FMX];let o=0,l=0;for(let u=0;u<this.T;u++)a[u]&&(o++,l+=this.weights[u]);const c=1/l;for(let u=0;u<this.tilesize;u++)for(let f=0;f<this.tilesize;f++){const h=(i*this.tilesize+f+(s*this.tilesize+u)*this.FMX*this.tilesize)*4;if(r&&o===this.T)t[h]=r[0],t[h+1]=r[1],t[h+2]=r[2],t[h+3]=r[3];else{let g=0,p=0,_=0,y=0;for(let v=0;v<this.T;v++)if(a[v]){const x=this.tiles[v][f+u*this.tilesize],E=this.weights[v]*c;g+=x[0]*E,p+=x[1]*E,_+=x[2]*E,y+=x[3]*E}t[h]=g,t[h+1]=p,t[h+2]=_,t[h+3]=y}}}},h8=e,h8}var d8,Ite;function Cet(){return Ite||(Ite=1,d8={OverlappingModel:Ret(),SimpleTiledModel:Aet()}),d8}var Met=Cet();const Oet=Bh(Met),Nte=5;function ket(n,e,t,r,i,s,a){if(!xe(Ce.book))return!1;const o=Ce.book,l=qg(o,ri.BOARD,n),c=qg(o,ri.BOARD,e),u=Qf(l),f=Qf(c);if(!xe(u)||!xe(f))return!1;Up(u),Up(f);let h=0;const g=new Map,p=new Map;let _=0;const y=32,v=new Uint8Array(w_*4);for(let I=0;I<mi;++I)for(let D=0;D<$n;++D){const V=Lo(f,{x:D,y:I}),G=V?.char??0,J=V?.color??y,B=V?.bg??y;v[_++]=G,v[_++]=J,v[_++]=B;const $=U1(V),U=Vr($?.name??"empty"),Q=g.get(U);Mn(Q)?v[_++]=Q:(g.set(U,h),p.set(h,U),v[_++]=h++)}const x=s.x-i.x+1,E=s.y-i.y+1,M=new Oet.OverlappingModel(v,$n,mi,t,x,E,!1,!1,r,0);let k=0;for(;k<Nte&&!M.generate();++k);if(k===Nte)return!1;_=0;const N=M.graphics();for(let I=i.y;I<=s.y;++I)for(let D=i.x;D<=s.x;++D){const V={x:D,y:I},G=N[_++],J=N[_++],B=N[_++];switch(h=N[_++],a){case"all":{const W=Lo(u,{x:D,y:I});Gu(W)&&zg(u,W,o.timestamp),Ed(u,{x:D,y:I});break}case"object":{const W=Lo(u,{x:D,y:I});Gu(W)&&zg(u,W,o.timestamp);break}case"terrain":Ed(u,{x:D,y:I});break}let $=p.get(h)??"";const U=U1({kind:$});switch(a){case"all":break;case"object":Gu(U)||($="");break;case"terrain":Gu(U)&&($="");break;default:if(ji(U,"group")!==a&&($=""),$){const W=Lo(u,{x:D,y:I});Gu(W)&&zg(u,W,o.timestamp),Ed(u,{x:D,y:I})}break}const Q=$?F0(u,[$],V):void 0;if(!(!xe(Q)||!xe(U))&&(BE(Q,U),G>0&&(Q.char=G),J<y&&(Q.color=J),B<y&&(Q.bg=B),Gu(Q))){const W=A0(rR(f,$));xe(W)&&(Ed(u,{...UE(f,W.x??0,W.y??0),x:D,y:I}),BE(Q,W))}}return!0}function c0e(n){return`zss_snapshot_${n}`}const u0e={x:0,y:0},f0e={x:$n-1,y:mi-1},h0e="all";function Iet(n){const e=qg(Ce.book,ri.BOARD,n),t=Qf(e);if(!xe(t))return;const r=c0e(t.id);Vme(Ce.book,r);const[i]=Jtt(x0.MAIN,r,ri.BOARD),s=Qf(i);if(xe(s))return BU(n,s.id,u0e,f0e,h0e),s}function Net(n){const e=qg(Ce.book,ri.BOARD,n),t=Qf(e);if(!xe(t))return;const r=c0e(t.id),i=qg(Ce.book,ri.BOARD,r),s=Qf(i);if(xe(s))return BU(s.id,n,u0e,f0e,h0e),s}function Pet(n,e,t,r,i,s){switch(s){case"all":case"object":case"terrain":break;default:return Det(n,e,i,s)}if(!xe(Ce.book))return;const a=Ce.book,o=qg(a,ri.BOARD,n),l=Qf(o);if(!xe(l))return;const c=DU();Up(l);for(let u=t.y;u<=r.y;++u)for(let f=t.x;f<=r.x;++f){let h=!1,g=!1;switch(s){case"all":h=!0,g=!0;break;case"object":h=!0;break;case"terrain":g=!0;break}const p=(f+e.x+$n)%$n,_=(u+e.y+mi)%mi;if(h){const y=Lo(l,{x:f,y:u});Gu(y)&&xe(y?.x)&&xe(y?.y)&&(y.x=p,y.lx=p,y.y=_,y.ly=_)}g&&(c.terrain[p+_*$n]=l.terrain[f+u*$n])}(s==="all"||s==="terrain")&&(l.terrain=[...c.terrain]),UO(l)}function Det(n,e,t,r){if(!xe(Ce.book))return;const i=Ce.book,s=qg(i,ri.BOARD,n),a=Qf(s);if(!xe(a))return;Up(a);const{terrainelements:o,objectelements:l}=Xme(a,t,r);if(o.length===0&&l.length===0)return;e.x<0&&(o.sort((p,_)=>{const y=p.x??0,v=_.x??0;return y-v}),l.sort((p,_)=>{const y=p.x??0,v=_.x??0;return y-v})),e.x>0&&(o.sort((p,_)=>{const y=p.x??0;return(_.x??0)-y}),l.sort((p,_)=>{const y=p.x??0;return(_.x??0)-y})),e.y<0&&(o.sort((p,_)=>{const y=p.y??0,v=_.y??0;return y-v}),l.sort((p,_)=>{const y=p.y??0,v=_.y??0;return y-v})),e.y>0&&(o.sort((p,_)=>{const y=p.y??0;return(_.y??0)-y}),l.sort((p,_)=>{const y=p.y??0;return(_.y??0)-y}));const c=l.map(p=>p.id??""),u=o.map(p=>_f({x:p.x??0,y:p.y??0},$n)),f=[],h=[];for(let p=0;p<o.length;++p){const _=o[p],y={x:_.x??-1,y:_.y??-1},v=Lo(a,y);xe(v)&&Gu(v)&&(f.push(v.id??""),f.push(v.id??""),h.push(_f({x:v.x??0,y:v.y??0},$n)))}let g=!1;for(let p=0;p<o.length;++p){const _=o[p],y=ji(_,"collision"),v={x:_.x??-1,y:_.y??-1},x=_f(v,$n),E={x:v.x+e.x,y:v.y+e.y};if(bw(E)){const M=Lo(a,E),k=M?.id??"",N=_f({x:M?.x??0,y:M?.y??0},$n),I=ji(M,"collision");if(xe(M)&&Gu(M)&&f.includes(k)!==!0&&c.includes(k)!==!0){let D=!1;const V=h.includes(x),G=V?Lo(a,v):void 0,J=V?ji(G,"pushable"):!1,B=V&&J;if(lz(_,M)&&(y!==wr.ISWALK||V)){let $=V;xe(G)&&J&&(g=kg(i,a,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0,g||($=!1)),($||y!==wr.ISWALK)&&(g=kg(i,a,M,{x:(M.x??0)+e.x,y:(M.y??0)+e.y})!==!0,g&&(D=B))}else(y!==wr.ISWALK||B)&&(g=!0,D=B);D&&xe(G)&&(g=kg(i,a,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0)}else I===wr.ISSOLID&&u.includes(N)===!1&&(g=!0)}else g=!0}if(!g){for(let p=0;p<l.length;++p){const _=l[p],y=ji(_,"collision"),v={x:_.x??0,y:_.y??0},x={x:v.x+e.x,y:v.y+e.y};if(bw(x)){const E=Lo(a,x),M=E?.id??"",k=ji(E,"collision"),N=ji(E,"group");xe(E)&&Gu(E)&&f.includes(M)&&c.includes(M)!==!0?lz(_,E)?g=kg(i,a,E,x)!==!0:g=!0:PU(y,k)&&r!==N&&(g=!0)}else g=!0}if(!g){for(let p=0;p<o.length;++p){const _=o[p],y={x:_.x??-1,y:_.y??-1},v={x:y.x+e.x,y:y.y+e.y},x=UE(a,v.x,v.y);if(xe(_)&&xe(x)){Ed(a,{..._,x:v.x,y:v.y}),Ed(a,{...x,x:y.x,y:y.y});const E=Lo(a,y);Gu(E)&&xe(E)&&(E.x=(E.x??0)+e.x,E.y=(E.y??0)+e.y,E.lx=(E.lx??0)+e.x,E.ly=(E.ly??0)+e.y)}}UO(a);for(let p=0;p<l.length;++p){const _=l[p],y={x:_.x??-1,y:_.y??-1},v={x:y.x+e.x,y:y.y+e.y};if(!kg(i,a,_,v))break}UO(a)}}}function EN(n,e){let t="all";const r={x:0,y:0},i={x:$n-1,y:mi-1};for(let s=e;s<n.length;){const[a,o]=ln(n,s,[Pt.MAYBE_NUMBER_OR_STRING]);if(Vn(a))t=Vr(a),s=o;else if(Mn(a)){const[l,c,u,f]=ln(n,o,[Pt.NUMBER,Pt.MAYBE_NUMBER,Pt.MAYBE_NUMBER]);r.x=Math.min(a,c??a),r.y=Math.min(l,u??l),i.x=Math.max(a,c??a),i.y=Math.max(l,u??l),s=f}else break}return{targetset:t,pt1:r,pt2:i}}function Pte(n,e){const t=By();for(let r=0;r<t.length;++r){const i=t[r],s=A0(H9(i,n,e));if(xe(s))return s}}const Let=bb().command("snapshot",()=>(!xe(Ce.book)||!xe(Ce.board)||Iet(Ce.board.id),0)).command("revert",()=>(!xe(Ce.book)||!xe(Ce.board)||Net(Ce.board.id),0)).command("copy",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.STRING]),i=Pte(ri.BOARD,t);if(xe(i)){const s=EN(e,r);BU(i.id,Ce.board.id,s.pt1,s.pt2,s.targetset)}return 0}).command("remix",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r,i,s]=ln(e,0,[Pt.STRING,Pt.NUMBER,Pt.NUMBER]),a=Pte(ri.BOARD,t);if(xe(a)){const o=EN(e,s);ket(Ce.board.id,a.id,r,i,o.pt1,o.pt2,o.targetset)}return 0}).command("weave",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.DIR]),i={x:t.destpt.x-(Ce.element?.x??0),y:t.destpt.y-(Ce.element?.y??0)},s=EN(e,r);return Pet(Ce.board.id,i,s.pt1,s.pt2,Ce.elementid,s.targetset),0}).command("pivot",(n,e)=>{if(!xe(Ce.book)||!xe(Ce.board))return 0;const[t,r]=ln(e,0,[Pt.NUMBER]),i=EN(e,r);return Tet(Ce.board.id,qke(t),i.pt1,i.pt2,i.targetset),0});var eV=(n=>(n[n.ERROR=0]="ERROR",n[n.CLI=1]="CLI",n[n.LOADER=2]="LOADER",n[n.RUNTIME=3]="RUNTIME",n))(eV||{});const Uet={audio:UU,board:k$e,cli:KQe,display:ZQe,element:net,runtime:xet,loader:bet,network:Eet,transform:Let},p8=["audio","board","display","network","transform","element"],Bet={0:[],1:["cli",...p8],2:["loader",...p8],3:["runtime",...p8]},Fet={0:new Map,1:new Map,2:new Map,3:new Map};function Xk(n){return(Bet[n]??[]).map(t=>Uet[t]).filter(xe)}function zet(n,e){const t=Fet[n];if(!t.has(e)){let r;const i=Xk(n);for(let s=0;s<i.length&&(r=i[s].getcommand(e),!xe(r));++s);t.set(e,r)}return t.get(e)}function jet(n,e,t){const r=Xk(n);for(let i=0;i<r.length;++i){const s=r[i];if(s.get!==void 0){const[a,o]=s.get(e,t);if(a)return[a,o]}}return[!1,void 0]}function Het(n,e,t,r){const i=Xk(n);for(let s=0;s<i.length;++s){const a=i[s];if(a.set!==void 0){const[o]=a.set(e,t,r);if(o)return[o,r]}}return[!1,void 0]}function qet(n,e){const t=Xk(n);for(let r=0;r<t.length;++r)t[r].everytick(e)}function Vet(n,e){const t=Xk(n);for(let r=0;r<t.length;++r)t[r].aftertick(e)}var HM={},m8={},g8={},_8={},Dte;function Get(){if(Dte)return _8;Dte=1;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return _8.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},_8}var Lte;function d0e(){if(Lte)return g8;Lte=1;const n=Get(),e=5,t=1<<e,r=t-1,i=t;function s(a){return a<0?(-a<<1)+1:(a<<1)+0}return g8.encode=function(o){let l="",c,u=s(o);do c=u&r,u>>>=e,u>0&&(c|=i),l+=n.encode(c);while(u>0);return l},g8}var h_={},AS={},T2={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */var $et=T2.exports,Ute;function Wet(){return Ute||(Ute=1,(function(n,e){(function(t){var r=e&&!e.nodeType&&e,i=n&&!n.nodeType&&n,s=typeof k0=="object"&&k0;(s.global===s||s.window===s||s.self===s)&&(t=s);var a,o=2147483647,l=36,c=1,u=26,f=38,h=700,g=72,p=128,_="-",y=/^xn--/,v=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=l-c,k=Math.floor,N=String.fromCharCode,I;function D(Z){throw new RangeError(E[Z])}function V(Z,K){for(var ne=Z.length,le=[];ne--;)le[ne]=K(Z[ne]);return le}function G(Z,K){var ne=Z.split("@"),le="";ne.length>1&&(le=ne[0]+"@",Z=ne[1]),Z=Z.replace(x,".");var ce=Z.split("."),de=V(ce,K).join(".");return le+de}function J(Z){for(var K=[],ne=0,le=Z.length,ce,de;ne<le;)ce=Z.charCodeAt(ne++),ce>=55296&&ce<=56319&&ne<le?(de=Z.charCodeAt(ne++),(de&64512)==56320?K.push(((ce&1023)<<10)+(de&1023)+65536):(K.push(ce),ne--)):K.push(ce);return K}function B(Z){return V(Z,function(K){var ne="";return K>65535&&(K-=65536,ne+=N(K>>>10&1023|55296),K=56320|K&1023),ne+=N(K),ne}).join("")}function $(Z){return Z-48<10?Z-22:Z-65<26?Z-65:Z-97<26?Z-97:l}function U(Z,K){return Z+22+75*(Z<26)-((K!=0)<<5)}function Q(Z,K,ne){var le=0;for(Z=ne?k(Z/h):Z>>1,Z+=k(Z/K);Z>M*u>>1;le+=l)Z=k(Z/M);return k(le+(M+1)*Z/(Z+f))}function W(Z){var K=[],ne=Z.length,le,ce=0,de=p,Me=g,qe,Ne,Ae,Xe,$e,at,pt,oe,Ue;for(qe=Z.lastIndexOf(_),qe<0&&(qe=0),Ne=0;Ne<qe;++Ne)Z.charCodeAt(Ne)>=128&&D("not-basic"),K.push(Z.charCodeAt(Ne));for(Ae=qe>0?qe+1:0;Ae<ne;){for(Xe=ce,$e=1,at=l;Ae>=ne&&D("invalid-input"),pt=$(Z.charCodeAt(Ae++)),(pt>=l||pt>k((o-ce)/$e))&&D("overflow"),ce+=pt*$e,oe=at<=Me?c:at>=Me+u?u:at-Me,!(pt<oe);at+=l)Ue=l-oe,$e>k(o/Ue)&&D("overflow"),$e*=Ue;le=K.length+1,Me=Q(ce-Xe,le,Xe==0),k(ce/le)>o-de&&D("overflow"),de+=k(ce/le),ce%=le,K.splice(ce++,0,de)}return B(K)}function q(Z){var K,ne,le,ce,de,Me,qe,Ne,Ae,Xe,$e,at=[],pt,oe,Ue,Ge;for(Z=J(Z),pt=Z.length,K=p,ne=0,de=g,Me=0;Me<pt;++Me)$e=Z[Me],$e<128&&at.push(N($e));for(le=ce=at.length,ce&&at.push(_);le<pt;){for(qe=o,Me=0;Me<pt;++Me)$e=Z[Me],$e>=K&&$e<qe&&(qe=$e);for(oe=le+1,qe-K>k((o-ne)/oe)&&D("overflow"),ne+=(qe-K)*oe,K=qe,Me=0;Me<pt;++Me)if($e=Z[Me],$e<K&&++ne>o&&D("overflow"),$e==K){for(Ne=ne,Ae=l;Xe=Ae<=de?c:Ae>=de+u?u:Ae-de,!(Ne<Xe);Ae+=l)Ge=Ne-Xe,Ue=l-Xe,at.push(N(U(Xe+Ge%Ue,0))),Ne=k(Ge/Ue);at.push(N(U(Ne,0))),de=Q(ne,oe,le==ce),ne=0,++le}++ne,++K}return at.join("")}function Y(Z){return G(Z,function(K){return y.test(K)?W(K.slice(4).toLowerCase()):K})}function ae(Z){return G(Z,function(K){return v.test(K)?"xn--"+q(K):K})}if(a={version:"1.4.1",ucs2:{decode:J,encode:B},decode:W,encode:q,toASCII:ae,toUnicode:Y},r&&i)if(n.exports==r)i.exports=a;else for(I in a)a.hasOwnProperty(I)&&(r[I]=a[I]);else t.punycode=a})($et)})(T2,T2.exports)),T2.exports}var v8,Bte;function lR(){return Bte||(Bte=1,v8=TypeError),v8}const Yet={},Xet=Object.freeze(Object.defineProperty({__proto__:null,default:Yet},Symbol.toStringTag,{value:"Module"})),Ket=Pae(Xet);var y8,Fte;function e6(){if(Fte)return y8;Fte=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=n&&e&&typeof e.get=="function"?e.get:null,r=n&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=i&&s&&typeof s.get=="function"?s.get:null,o=i&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,c=l?WeakMap.prototype.has:null,u=typeof WeakSet=="function"&&WeakSet.prototype,f=u?WeakSet.prototype.has:null,h=typeof WeakRef=="function"&&WeakRef.prototype,g=h?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,_=Object.prototype.toString,y=Function.prototype.toString,v=String.prototype.match,x=String.prototype.slice,E=String.prototype.replace,M=String.prototype.toUpperCase,k=String.prototype.toLowerCase,N=RegExp.prototype.test,I=Array.prototype.concat,D=Array.prototype.join,V=Array.prototype.slice,G=Math.floor,J=typeof BigInt=="function"?BigInt.prototype.valueOf:null,B=Object.getOwnPropertySymbols,$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,U=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Q=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===U||!0)?Symbol.toStringTag:null,W=Object.prototype.propertyIsEnumerable,q=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Oe){return Oe.__proto__}:null);function Y(Oe,we){if(Oe===1/0||Oe===-1/0||Oe!==Oe||Oe&&Oe>-1e3&&Oe<1e3||N.call(/e/,we))return we;var st=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Oe=="number"){var Ve=Oe<0?-G(-Oe):G(Oe);if(Ve!==Oe){var tt=String(Ve),Ze=x.call(we,tt.length+1);return E.call(tt,st,"$&_")+"."+E.call(E.call(Ze,/([0-9]{3})/g,"$&_"),/_$/,"")}}return E.call(we,st,"$&_")}var ae=Ket,Z=ae.custom,K=oe(Z)?Z:null,ne={__proto__:null,double:'"',single:"'"},le={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};y8=function Oe(we,st,Ve,tt){var Ze=st||{};if(ze(Ze,"quoteStyle")&&!ze(ne,Ze.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ze(Ze,"maxStringLength")&&(typeof Ze.maxStringLength=="number"?Ze.maxStringLength<0&&Ze.maxStringLength!==1/0:Ze.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var nt=ze(Ze,"customInspect")?Ze.customInspect:!0;if(typeof nt!="boolean"&&nt!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ze(Ze,"indent")&&Ze.indent!==null&&Ze.indent!=="	"&&!(parseInt(Ze.indent,10)===Ze.indent&&Ze.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ze(Ze,"numericSeparator")&&typeof Ze.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var vt=Ze.numericSeparator;if(typeof we>"u")return"undefined";if(we===null)return"null";if(typeof we=="boolean")return we?"true":"false";if(typeof we=="string")return Vt(we,Ze);if(typeof we=="number"){if(we===0)return 1/0/we>0?"0":"-0";var Je=String(we);return vt?Y(we,Je):Je}if(typeof we=="bigint"){var ht=String(we)+"n";return vt?Y(we,ht):ht}var mt=typeof Ze.depth>"u"?5:Ze.depth;if(typeof Ve>"u"&&(Ve=0),Ve>=mt&&mt>0&&typeof we=="object")return qe(we)?"[Array]":"[Object]";var ft=_e(Ze,Ve);if(typeof tt>"u")tt=[];else if(Se(tt,we)>=0)return"[Circular]";function _t(Rs,ra,ls){if(ra&&(tt=V.call(tt),tt.push(ra)),ls){var We={depth:Ze.depth};return ze(Ze,"quoteStyle")&&(We.quoteStyle=Ze.quoteStyle),Oe(Rs,We,Ve+1,tt)}return Oe(Rs,Ze,Ve+1,tt)}if(typeof we=="function"&&!Ae(we)){var gn=me(we),_n=De(we,_t);return"[Function"+(gn?": "+gn:" (anonymous)")+"]"+(_n.length>0?" { "+D.call(_n,", ")+" }":"")}if(oe(we)){var Bt=U?E.call(String(we),/^(Symbol\(.*\))_[^)]*$/,"$1"):$.call(we);return typeof we=="object"&&!U?Ut(Bt):Bt}if(ct(we)){for(var Yt="<"+k.call(String(we.nodeName)),Mt=we.attributes||[],fn=0;fn<Mt.length;fn++)Yt+=" "+Mt[fn].name+"="+ce(de(Mt[fn].value),"double",Ze);return Yt+=">",we.childNodes&&we.childNodes.length&&(Yt+="..."),Yt+="</"+k.call(String(we.nodeName))+">",Yt}if(qe(we)){if(we.length===0)return"[]";var Bn=De(we,_t);return ft&&!se(Bn)?"["+Ie(Bn,ft)+"]":"[ "+D.call(Bn,", ")+" ]"}if(Xe(we)){var cn=De(we,_t);return!("cause"in Error.prototype)&&"cause"in we&&!W.call(we,"cause")?"{ ["+String(we)+"] "+D.call(I.call("[cause]: "+_t(we.cause),cn),", ")+" }":cn.length===0?"["+String(we)+"]":"{ ["+String(we)+"] "+D.call(cn,", ")+" }"}if(typeof we=="object"&&nt){if(K&&typeof we[K]=="function"&&ae)return ae(we,{depth:mt-Ve});if(nt!=="symbol"&&typeof we.inspect=="function")return we.inspect()}if(ke(we)){var In=[];return r&&r.call(we,function(Rs,ra){In.push(_t(ra,we,!0)+" => "+_t(Rs,we))}),ge("Map",t.call(we),In,ft)}if(ot(we)){var Wn=[];return o&&o.call(we,function(Rs){Wn.push(_t(Rs,we))}),ge("Set",a.call(we),Wn,ft)}if(be(we))return je("WeakMap");if(lt(we))return je("WeakSet");if(Ke(we))return je("WeakRef");if(at(we))return Ut(_t(Number(we)));if(Ue(we))return Ut(_t(J.call(we)));if(pt(we))return Ut(p.call(we));if($e(we))return Ut(_t(String(we)));if(typeof window<"u"&&we===window)return"{ [object Window] }";if(typeof globalThis<"u"&&we===globalThis||typeof k0<"u"&&we===k0)return"{ [object globalThis] }";if(!Ne(we)&&!Ae(we)){var er=De(we,_t),os=q?q(we)===Object.prototype:we instanceof Object||we.constructor===Object,gi=we instanceof Object?"":"null prototype",Ni=!os&&Q&&Object(we)===we&&Q in we?x.call(Be(we),8,-1):gi?"Object":"",Fs=os||typeof we.constructor!="function"?"":we.constructor.name?we.constructor.name+" ":"",_i=Fs+(Ni||gi?"["+D.call(I.call([],Ni||[],gi||[]),": ")+"] ":"");return er.length===0?_i+"{}":ft?_i+"{"+Ie(er,ft)+"}":_i+"{ "+D.call(er,", ")+" }"}return String(we)};function ce(Oe,we,st){var Ve=st.quoteStyle||we,tt=ne[Ve];return tt+Oe+tt}function de(Oe){return E.call(String(Oe),/"/g,"&quot;")}function Me(Oe){return!Q||!(typeof Oe=="object"&&(Q in Oe||typeof Oe[Q]<"u"))}function qe(Oe){return Be(Oe)==="[object Array]"&&Me(Oe)}function Ne(Oe){return Be(Oe)==="[object Date]"&&Me(Oe)}function Ae(Oe){return Be(Oe)==="[object RegExp]"&&Me(Oe)}function Xe(Oe){return Be(Oe)==="[object Error]"&&Me(Oe)}function $e(Oe){return Be(Oe)==="[object String]"&&Me(Oe)}function at(Oe){return Be(Oe)==="[object Number]"&&Me(Oe)}function pt(Oe){return Be(Oe)==="[object Boolean]"&&Me(Oe)}function oe(Oe){if(U)return Oe&&typeof Oe=="object"&&Oe instanceof Symbol;if(typeof Oe=="symbol")return!0;if(!Oe||typeof Oe!="object"||!$)return!1;try{return $.call(Oe),!0}catch{}return!1}function Ue(Oe){if(!Oe||typeof Oe!="object"||!J)return!1;try{return J.call(Oe),!0}catch{}return!1}var Ge=Object.prototype.hasOwnProperty||function(Oe){return Oe in this};function ze(Oe,we){return Ge.call(Oe,we)}function Be(Oe){return _.call(Oe)}function me(Oe){if(Oe.name)return Oe.name;var we=v.call(y.call(Oe),/^function\s*([\w$]+)/);return we?we[1]:null}function Se(Oe,we){if(Oe.indexOf)return Oe.indexOf(we);for(var st=0,Ve=Oe.length;st<Ve;st++)if(Oe[st]===we)return st;return-1}function ke(Oe){if(!t||!Oe||typeof Oe!="object")return!1;try{t.call(Oe);try{a.call(Oe)}catch{return!0}return Oe instanceof Map}catch{}return!1}function be(Oe){if(!c||!Oe||typeof Oe!="object")return!1;try{c.call(Oe,c);try{f.call(Oe,f)}catch{return!0}return Oe instanceof WeakMap}catch{}return!1}function Ke(Oe){if(!g||!Oe||typeof Oe!="object")return!1;try{return g.call(Oe),!0}catch{}return!1}function ot(Oe){if(!a||!Oe||typeof Oe!="object")return!1;try{a.call(Oe);try{t.call(Oe)}catch{return!0}return Oe instanceof Set}catch{}return!1}function lt(Oe){if(!f||!Oe||typeof Oe!="object")return!1;try{f.call(Oe,f);try{c.call(Oe,c)}catch{return!0}return Oe instanceof WeakSet}catch{}return!1}function ct(Oe){return!Oe||typeof Oe!="object"?!1:typeof HTMLElement<"u"&&Oe instanceof HTMLElement?!0:typeof Oe.nodeName=="string"&&typeof Oe.getAttribute=="function"}function Vt(Oe,we){if(Oe.length>we.maxStringLength){var st=Oe.length-we.maxStringLength,Ve="... "+st+" more character"+(st>1?"s":"");return Vt(x.call(Oe,0,we.maxStringLength),we)+Ve}var tt=le[we.quoteStyle||"single"];tt.lastIndex=0;var Ze=E.call(E.call(Oe,tt,"\\$1"),/[\x00-\x1f]/g,Ot);return ce(Ze,"single",we)}function Ot(Oe){var we=Oe.charCodeAt(0),st={8:"b",9:"t",10:"n",12:"f",13:"r"}[we];return st?"\\"+st:"\\x"+(we<16?"0":"")+M.call(we.toString(16))}function Ut(Oe){return"Object("+Oe+")"}function je(Oe){return Oe+" { ? }"}function ge(Oe,we,st,Ve){var tt=Ve?Ie(st,Ve):D.call(st,", ");return Oe+" ("+we+") {"+tt+"}"}function se(Oe){for(var we=0;we<Oe.length;we++)if(Se(Oe[we],`
`)>=0)return!1;return!0}function _e(Oe,we){var st;if(Oe.indent==="	")st="	";else if(typeof Oe.indent=="number"&&Oe.indent>0)st=D.call(Array(Oe.indent+1)," ");else return null;return{base:st,prev:D.call(Array(we+1),st)}}function Ie(Oe,we){if(Oe.length===0)return"";var st=`
`+we.prev+we.base;return st+D.call(Oe,","+st)+`
`+we.prev}function De(Oe,we){var st=qe(Oe),Ve=[];if(st){Ve.length=Oe.length;for(var tt=0;tt<Oe.length;tt++)Ve[tt]=ze(Oe,tt)?we(Oe[tt],Oe):""}var Ze=typeof B=="function"?B(Oe):[],nt;if(U){nt={};for(var vt=0;vt<Ze.length;vt++)nt["$"+Ze[vt]]=Ze[vt]}for(var Je in Oe)ze(Oe,Je)&&(st&&String(Number(Je))===Je&&Je<Oe.length||U&&nt["$"+Je]instanceof Symbol||(N.call(/[^\w$]/,Je)?Ve.push(we(Je,Oe)+": "+we(Oe[Je],Oe)):Ve.push(Je+": "+we(Oe[Je],Oe))));if(typeof B=="function")for(var ht=0;ht<Ze.length;ht++)W.call(Oe,Ze[ht])&&Ve.push("["+we(Ze[ht])+"]: "+we(Oe[Ze[ht]],Oe));return Ve}return y8}var b8,zte;function Zet(){if(zte)return b8;zte=1;var n=e6(),e=lR(),t=function(o,l,c){for(var u=o,f;(f=u.next)!=null;u=f)if(f.key===l)return u.next=f.next,c||(f.next=o.next,o.next=f),f},r=function(o,l){if(o){var c=t(o,l);return c&&c.value}},i=function(o,l,c){var u=t(o,l);u?u.value=c:o.next={key:l,next:o.next,value:c}},s=function(o,l){return o?!!t(o,l):!1},a=function(o,l){if(o)return t(o,l,!0)};return b8=function(){var l,c={assert:function(u){if(!c.has(u))throw new e("Side channel does not contain "+n(u))},delete:function(u){var f=l&&l.next,h=a(l,u);return h&&f&&f===h&&(l=void 0),!!h},get:function(u){return r(l,u)},has:function(u){return s(l,u)},set:function(u,f){l||(l={next:void 0}),i(l,u,f)}};return c},b8}var S8,jte;function p0e(){return jte||(jte=1,S8=Object),S8}var E8,Hte;function Jet(){return Hte||(Hte=1,E8=Error),E8}var x8,qte;function Qet(){return qte||(qte=1,x8=EvalError),x8}var T8,Vte;function ett(){return Vte||(Vte=1,T8=RangeError),T8}var w8,Gte;function ttt(){return Gte||(Gte=1,w8=ReferenceError),w8}var R8,$te;function ntt(){return $te||($te=1,R8=SyntaxError),R8}var A8,Wte;function rtt(){return Wte||(Wte=1,A8=URIError),A8}var C8,Yte;function itt(){return Yte||(Yte=1,C8=Math.abs),C8}var M8,Xte;function stt(){return Xte||(Xte=1,M8=Math.floor),M8}var O8,Kte;function att(){return Kte||(Kte=1,O8=Math.max),O8}var k8,Zte;function ott(){return Zte||(Zte=1,k8=Math.min),k8}var I8,Jte;function ltt(){return Jte||(Jte=1,I8=Math.pow),I8}var N8,Qte;function ctt(){return Qte||(Qte=1,N8=Math.round),N8}var P8,ene;function utt(){return ene||(ene=1,P8=Number.isNaN||function(e){return e!==e}),P8}var D8,tne;function ftt(){if(tne)return D8;tne=1;var n=utt();return D8=function(t){return n(t)||t===0?t:t<0?-1:1},D8}var L8,nne;function htt(){return nne||(nne=1,L8=Object.getOwnPropertyDescriptor),L8}var U8,rne;function m0e(){if(rne)return U8;rne=1;var n=htt();if(n)try{n([],"length")}catch{n=null}return U8=n,U8}var B8,ine;function dtt(){if(ine)return B8;ine=1;var n=Object.defineProperty||!1;if(n)try{n({},"a",{value:1})}catch{n=!1}return B8=n,B8}var F8,sne;function ptt(){return sne||(sne=1,F8=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),F8}var z8,ane;function mtt(){if(ane)return z8;ane=1;var n=typeof Symbol<"u"&&Symbol,e=ptt();return z8=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},z8}var j8,one;function g0e(){return one||(one=1,j8=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),j8}var H8,lne;function _0e(){if(lne)return H8;lne=1;var n=p0e();return H8=n.getPrototypeOf||null,H8}var q8,cne;function gtt(){if(cne)return q8;cne=1;var n="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",i=function(l,c){for(var u=[],f=0;f<l.length;f+=1)u[f]=l[f];for(var h=0;h<c.length;h+=1)u[h+l.length]=c[h];return u},s=function(l,c){for(var u=[],f=c,h=0;f<l.length;f+=1,h+=1)u[h]=l[f];return u},a=function(o,l){for(var c="",u=0;u<o.length;u+=1)c+=o[u],u+1<o.length&&(c+=l);return c};return q8=function(l){var c=this;if(typeof c!="function"||e.apply(c)!==r)throw new TypeError(n+c);for(var u=s(arguments,1),f,h=function(){if(this instanceof f){var v=c.apply(this,i(u,arguments));return Object(v)===v?v:this}return c.apply(l,i(u,arguments))},g=t(0,c.length-u.length),p=[],_=0;_<g;_++)p[_]="$"+_;if(f=Function("binder","return function ("+a(p,",")+"){ return binder.apply(this,arguments); }")(h),c.prototype){var y=function(){};y.prototype=c.prototype,f.prototype=new y,y.prototype=null}return f},q8}var V8,une;function t6(){if(une)return V8;une=1;var n=gtt();return V8=Function.prototype.bind||n,V8}var G8,fne;function tV(){return fne||(fne=1,G8=Function.prototype.call),G8}var $8,hne;function v0e(){return hne||(hne=1,$8=Function.prototype.apply),$8}var W8,dne;function _tt(){return dne||(dne=1,W8=typeof Reflect<"u"&&Reflect&&Reflect.apply),W8}var Y8,pne;function vtt(){if(pne)return Y8;pne=1;var n=t6(),e=v0e(),t=tV(),r=_tt();return Y8=r||n.call(t,e),Y8}var X8,mne;function y0e(){if(mne)return X8;mne=1;var n=t6(),e=lR(),t=tV(),r=vtt();return X8=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return r(n,t,s)},X8}var K8,gne;function ytt(){if(gne)return K8;gne=1;var n=y0e(),e=m0e(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var r=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return K8=r&&typeof r.get=="function"?n([r.get]):typeof s=="function"?function(o){return s(o==null?o:i(o))}:!1,K8}var Z8,_ne;function btt(){if(_ne)return Z8;_ne=1;var n=g0e(),e=_0e(),t=ytt();return Z8=n?function(i){return n(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,Z8}var J8,vne;function Stt(){if(vne)return J8;vne=1;var n=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=t6();return J8=t.call(n,e),J8}var Q8,yne;function nV(){if(yne)return Q8;yne=1;var n,e=p0e(),t=Jet(),r=Qet(),i=ett(),s=ttt(),a=ntt(),o=lR(),l=rtt(),c=itt(),u=stt(),f=att(),h=ott(),g=ltt(),p=ctt(),_=ftt(),y=Function,v=function(Ae){try{return y('"use strict"; return ('+Ae+").constructor;")()}catch{}},x=m0e(),E=dtt(),M=function(){throw new o},k=x?(function(){try{return arguments.callee,M}catch{try{return x(arguments,"callee").get}catch{return M}}})():M,N=mtt()(),I=btt(),D=_0e(),V=g0e(),G=v0e(),J=tV(),B={},$=typeof Uint8Array>"u"||!I?n:I(Uint8Array),U={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?n:ArrayBuffer,"%ArrayIteratorPrototype%":N&&I?I([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":B,"%AsyncGenerator%":B,"%AsyncGeneratorFunction%":B,"%AsyncIteratorPrototype%":B,"%Atomics%":typeof Atomics>"u"?n:Atomics,"%BigInt%":typeof BigInt>"u"?n:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?n:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?n:Float16Array,"%Float32Array%":typeof Float32Array>"u"?n:Float32Array,"%Float64Array%":typeof Float64Array>"u"?n:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?n:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":B,"%Int8Array%":typeof Int8Array>"u"?n:Int8Array,"%Int16Array%":typeof Int16Array>"u"?n:Int16Array,"%Int32Array%":typeof Int32Array>"u"?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&I?I(I([][Symbol.iterator]())):n,"%JSON%":typeof JSON=="object"?JSON:n,"%Map%":typeof Map>"u"?n:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!I?n:I(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":x,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?n:Promise,"%Proxy%":typeof Proxy>"u"?n:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?n:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?n:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!I?n:I(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&I?I(""[Symbol.iterator]()):n,"%Symbol%":N?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":k,"%TypedArray%":$,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?n:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?n:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?n:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?n:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?n:WeakMap,"%WeakRef%":typeof WeakRef>"u"?n:WeakRef,"%WeakSet%":typeof WeakSet>"u"?n:WeakSet,"%Function.prototype.call%":J,"%Function.prototype.apply%":G,"%Object.defineProperty%":E,"%Object.getPrototypeOf%":D,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":f,"%Math.min%":h,"%Math.pow%":g,"%Math.round%":p,"%Math.sign%":_,"%Reflect.getPrototypeOf%":V};if(I)try{null.error}catch(Ae){var Q=I(I(Ae));U["%Error.prototype%"]=Q}var W=function Ae(Xe){var $e;if(Xe==="%AsyncFunction%")$e=v("async function () {}");else if(Xe==="%GeneratorFunction%")$e=v("function* () {}");else if(Xe==="%AsyncGeneratorFunction%")$e=v("async function* () {}");else if(Xe==="%AsyncGenerator%"){var at=Ae("%AsyncGeneratorFunction%");at&&($e=at.prototype)}else if(Xe==="%AsyncIteratorPrototype%"){var pt=Ae("%AsyncGenerator%");pt&&I&&($e=I(pt.prototype))}return U[Xe]=$e,$e},q={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y=t6(),ae=Stt(),Z=Y.call(J,Array.prototype.concat),K=Y.call(G,Array.prototype.splice),ne=Y.call(J,String.prototype.replace),le=Y.call(J,String.prototype.slice),ce=Y.call(J,RegExp.prototype.exec),de=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Me=/\\(\\)?/g,qe=function(Xe){var $e=le(Xe,0,1),at=le(Xe,-1);if($e==="%"&&at!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(at==="%"&&$e!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var pt=[];return ne(Xe,de,function(oe,Ue,Ge,ze){pt[pt.length]=Ge?ne(ze,Me,"$1"):Ue||oe}),pt},Ne=function(Xe,$e){var at=Xe,pt;if(ae(q,at)&&(pt=q[at],at="%"+pt[0]+"%"),ae(U,at)){var oe=U[at];if(oe===B&&(oe=W(at)),typeof oe>"u"&&!$e)throw new o("intrinsic "+Xe+" exists, but is not available. Please file an issue!");return{alias:pt,name:at,value:oe}}throw new a("intrinsic "+Xe+" does not exist!")};return Q8=function(Xe,$e){if(typeof Xe!="string"||Xe.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof $e!="boolean")throw new o('"allowMissing" argument must be a boolean');if(ce(/^%?[^%]*%?$/,Xe)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var at=qe(Xe),pt=at.length>0?at[0]:"",oe=Ne("%"+pt+"%",$e),Ue=oe.name,Ge=oe.value,ze=!1,Be=oe.alias;Be&&(pt=Be[0],K(at,Z([0,1],Be)));for(var me=1,Se=!0;me<at.length;me+=1){var ke=at[me],be=le(ke,0,1),Ke=le(ke,-1);if((be==='"'||be==="'"||be==="`"||Ke==='"'||Ke==="'"||Ke==="`")&&be!==Ke)throw new a("property names with quotes must have matching quotes");if((ke==="constructor"||!Se)&&(ze=!0),pt+="."+ke,Ue="%"+pt+"%",ae(U,Ue))Ge=U[Ue];else if(Ge!=null){if(!(ke in Ge)){if(!$e)throw new o("base intrinsic for "+Xe+" exists, but the property is not available.");return}if(x&&me+1>=at.length){var ot=x(Ge,ke);Se=!!ot,Se&&"get"in ot&&!("originalValue"in ot.get)?Ge=ot.get:Ge=Ge[ke]}else Se=ae(Ge,ke),Ge=Ge[ke];Se&&!ze&&(U[Ue]=Ge)}}return Ge},Q8}var eF,bne;function b0e(){if(bne)return eF;bne=1;var n=nV(),e=y0e(),t=e([n("%String.prototype.indexOf%")]);return eF=function(i,s){var a=n(i,!!s);return typeof a=="function"&&t(i,".prototype.")>-1?e([a]):a},eF}var tF,Sne;function S0e(){if(Sne)return tF;Sne=1;var n=nV(),e=b0e(),t=e6(),r=lR(),i=n("%Map%",!0),s=e("Map.prototype.get",!0),a=e("Map.prototype.set",!0),o=e("Map.prototype.has",!0),l=e("Map.prototype.delete",!0),c=e("Map.prototype.size",!0);return tF=!!i&&function(){var f,h={assert:function(g){if(!h.has(g))throw new r("Side channel does not contain "+t(g))},delete:function(g){if(f){var p=l(f,g);return c(f)===0&&(f=void 0),p}return!1},get:function(g){if(f)return s(f,g)},has:function(g){return f?o(f,g):!1},set:function(g,p){f||(f=new i),a(f,g,p)}};return h},tF}var nF,Ene;function Ett(){if(Ene)return nF;Ene=1;var n=nV(),e=b0e(),t=e6(),r=S0e(),i=lR(),s=n("%WeakMap%",!0),a=e("WeakMap.prototype.get",!0),o=e("WeakMap.prototype.set",!0),l=e("WeakMap.prototype.has",!0),c=e("WeakMap.prototype.delete",!0);return nF=s?function(){var f,h,g={assert:function(p){if(!g.has(p))throw new i("Side channel does not contain "+t(p))},delete:function(p){if(s&&p&&(typeof p=="object"||typeof p=="function")){if(f)return c(f,p)}else if(r&&h)return h.delete(p);return!1},get:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?a(f,p):h&&h.get(p)},has:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?l(f,p):!!h&&h.has(p)},set:function(p,_){s&&p&&(typeof p=="object"||typeof p=="function")?(f||(f=new s),o(f,p,_)):r&&(h||(h=r()),h.set(p,_))}};return g}:r,nF}var rF,xne;function xtt(){if(xne)return rF;xne=1;var n=lR(),e=e6(),t=Zet(),r=S0e(),i=Ett(),s=i||r||t;return rF=function(){var o,l={assert:function(c){if(!l.has(c))throw new n("Side channel does not contain "+e(c))},delete:function(c){return!!o&&o.delete(c)},get:function(c){return o&&o.get(c)},has:function(c){return!!o&&o.has(c)},set:function(c,u){o||(o=s()),o.set(c,u)}};return l},rF}var iF,Tne;function rV(){if(Tne)return iF;Tne=1;var n=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return iF={default:t.RFC3986,formatters:{RFC1738:function(r){return n.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},iF}var sF,wne;function E0e(){if(wne)return sF;wne=1;var n=rV(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=(function(){for(var y=[],v=0;v<256;++v)y.push("%"+((v<16?"0":"")+v.toString(16)).toUpperCase());return y})(),i=function(v){for(;v.length>1;){var x=v.pop(),E=x.obj[x.prop];if(t(E)){for(var M=[],k=0;k<E.length;++k)typeof E[k]<"u"&&M.push(E[k]);x.obj[x.prop]=M}}},s=function(v,x){for(var E=x&&x.plainObjects?{__proto__:null}:{},M=0;M<v.length;++M)typeof v[M]<"u"&&(E[M]=v[M]);return E},a=function y(v,x,E){if(!x)return v;if(typeof x!="object"&&typeof x!="function"){if(t(v))v.push(x);else if(v&&typeof v=="object")(E&&(E.plainObjects||E.allowPrototypes)||!e.call(Object.prototype,x))&&(v[x]=!0);else return[v,x];return v}if(!v||typeof v!="object")return[v].concat(x);var M=v;return t(v)&&!t(x)&&(M=s(v,E)),t(v)&&t(x)?(x.forEach(function(k,N){if(e.call(v,N)){var I=v[N];I&&typeof I=="object"&&k&&typeof k=="object"?v[N]=y(I,k,E):v.push(k)}else v[N]=k}),v):Object.keys(x).reduce(function(k,N){var I=x[N];return e.call(k,N)?k[N]=y(k[N],I,E):k[N]=I,k},M)},o=function(v,x){return Object.keys(x).reduce(function(E,M){return E[M]=x[M],E},v)},l=function(y,v,x){var E=y.replace(/\+/g," ");if(x==="iso-8859-1")return E.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(E)}catch{return E}},c=1024,u=function(v,x,E,M,k){if(v.length===0)return v;var N=v;if(typeof v=="symbol"?N=Symbol.prototype.toString.call(v):typeof v!="string"&&(N=String(v)),E==="iso-8859-1")return escape(N).replace(/%u[0-9a-f]{4}/gi,function($){return"%26%23"+parseInt($.slice(2),16)+"%3B"});for(var I="",D=0;D<N.length;D+=c){for(var V=N.length>=c?N.slice(D,D+c):N,G=[],J=0;J<V.length;++J){var B=V.charCodeAt(J);if(B===45||B===46||B===95||B===126||B>=48&&B<=57||B>=65&&B<=90||B>=97&&B<=122||k===n.RFC1738&&(B===40||B===41)){G[G.length]=V.charAt(J);continue}if(B<128){G[G.length]=r[B];continue}if(B<2048){G[G.length]=r[192|B>>6]+r[128|B&63];continue}if(B<55296||B>=57344){G[G.length]=r[224|B>>12]+r[128|B>>6&63]+r[128|B&63];continue}J+=1,B=65536+((B&1023)<<10|V.charCodeAt(J)&1023),G[G.length]=r[240|B>>18]+r[128|B>>12&63]+r[128|B>>6&63]+r[128|B&63]}I+=G.join("")}return I},f=function(v){for(var x=[{obj:{o:v},prop:"o"}],E=[],M=0;M<x.length;++M)for(var k=x[M],N=k.obj[k.prop],I=Object.keys(N),D=0;D<I.length;++D){var V=I[D],G=N[V];typeof G=="object"&&G!==null&&E.indexOf(G)===-1&&(x.push({obj:N,prop:V}),E.push(G))}return i(x),v},h=function(v){return Object.prototype.toString.call(v)==="[object RegExp]"},g=function(v){return!v||typeof v!="object"?!1:!!(v.constructor&&v.constructor.isBuffer&&v.constructor.isBuffer(v))},p=function(v,x){return[].concat(v,x)},_=function(v,x){if(t(v)){for(var E=[],M=0;M<v.length;M+=1)E.push(x(v[M]));return E}return x(v)};return sF={arrayToObject:s,assign:o,combine:p,compact:f,decode:l,encode:u,isBuffer:g,isRegExp:h,maybeMap:_,merge:a},sF}var aF,Rne;function Ttt(){if(Rne)return aF;Rne=1;var n=xtt(),e=E0e(),t=rV(),r=Object.prototype.hasOwnProperty,i={brackets:function(y){return y+"[]"},comma:"comma",indices:function(y,v){return y+"["+v+"]"},repeat:function(y){return y}},s=Array.isArray,a=Array.prototype.push,o=function(_,y){a.apply(_,s(y)?y:[y])},l=Date.prototype.toISOString,c=t.default,u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:c,formatter:t.formatters[c],indices:!1,serializeDate:function(y){return l.call(y)},skipNulls:!1,strictNullHandling:!1},f=function(y){return typeof y=="string"||typeof y=="number"||typeof y=="boolean"||typeof y=="symbol"||typeof y=="bigint"},h={},g=function _(y,v,x,E,M,k,N,I,D,V,G,J,B,$,U,Q,W,q){for(var Y=y,ae=q,Z=0,K=!1;(ae=ae.get(h))!==void 0&&!K;){var ne=ae.get(y);if(Z+=1,typeof ne<"u"){if(ne===Z)throw new RangeError("Cyclic object value");K=!0}typeof ae.get(h)>"u"&&(Z=0)}if(typeof V=="function"?Y=V(v,Y):Y instanceof Date?Y=B(Y):x==="comma"&&s(Y)&&(Y=e.maybeMap(Y,function(Ue){return Ue instanceof Date?B(Ue):Ue})),Y===null){if(k)return D&&!Q?D(v,u.encoder,W,"key",$):v;Y=""}if(f(Y)||e.isBuffer(Y)){if(D){var le=Q?v:D(v,u.encoder,W,"key",$);return[U(le)+"="+U(D(Y,u.encoder,W,"value",$))]}return[U(v)+"="+U(String(Y))]}var ce=[];if(typeof Y>"u")return ce;var de;if(x==="comma"&&s(Y))Q&&D&&(Y=e.maybeMap(Y,D)),de=[{value:Y.length>0?Y.join(",")||null:void 0}];else if(s(V))de=V;else{var Me=Object.keys(Y);de=G?Me.sort(G):Me}var qe=I?String(v).replace(/\./g,"%2E"):String(v),Ne=E&&s(Y)&&Y.length===1?qe+"[]":qe;if(M&&s(Y)&&Y.length===0)return Ne+"[]";for(var Ae=0;Ae<de.length;++Ae){var Xe=de[Ae],$e=typeof Xe=="object"&&Xe&&typeof Xe.value<"u"?Xe.value:Y[Xe];if(!(N&&$e===null)){var at=J&&I?String(Xe).replace(/\./g,"%2E"):String(Xe),pt=s(Y)?typeof x=="function"?x(Ne,at):Ne:Ne+(J?"."+at:"["+at+"]");q.set(y,Z);var oe=n();oe.set(h,q),o(ce,_($e,pt,x,E,M,k,N,I,x==="comma"&&Q&&s(Y)?null:D,V,G,J,B,$,U,Q,W,oe))}}return ce},p=function(y){if(!y)return u;if(typeof y.allowEmptyArrays<"u"&&typeof y.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof y.encodeDotInKeys<"u"&&typeof y.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(y.encoder!==null&&typeof y.encoder<"u"&&typeof y.encoder!="function")throw new TypeError("Encoder has to be a function.");var v=y.charset||u.charset;if(typeof y.charset<"u"&&y.charset!=="utf-8"&&y.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var x=t.default;if(typeof y.format<"u"){if(!r.call(t.formatters,y.format))throw new TypeError("Unknown format option provided.");x=y.format}var E=t.formatters[x],M=u.filter;(typeof y.filter=="function"||s(y.filter))&&(M=y.filter);var k;if(y.arrayFormat in i?k=y.arrayFormat:"indices"in y?k=y.indices?"indices":"repeat":k=u.arrayFormat,"commaRoundTrip"in y&&typeof y.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var N=typeof y.allowDots>"u"?y.encodeDotInKeys===!0?!0:u.allowDots:!!y.allowDots;return{addQueryPrefix:typeof y.addQueryPrefix=="boolean"?y.addQueryPrefix:u.addQueryPrefix,allowDots:N,allowEmptyArrays:typeof y.allowEmptyArrays=="boolean"?!!y.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:k,charset:v,charsetSentinel:typeof y.charsetSentinel=="boolean"?y.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!y.commaRoundTrip,delimiter:typeof y.delimiter>"u"?u.delimiter:y.delimiter,encode:typeof y.encode=="boolean"?y.encode:u.encode,encodeDotInKeys:typeof y.encodeDotInKeys=="boolean"?y.encodeDotInKeys:u.encodeDotInKeys,encoder:typeof y.encoder=="function"?y.encoder:u.encoder,encodeValuesOnly:typeof y.encodeValuesOnly=="boolean"?y.encodeValuesOnly:u.encodeValuesOnly,filter:M,format:x,formatter:E,serializeDate:typeof y.serializeDate=="function"?y.serializeDate:u.serializeDate,skipNulls:typeof y.skipNulls=="boolean"?y.skipNulls:u.skipNulls,sort:typeof y.sort=="function"?y.sort:null,strictNullHandling:typeof y.strictNullHandling=="boolean"?y.strictNullHandling:u.strictNullHandling}};return aF=function(_,y){var v=_,x=p(y),E,M;typeof x.filter=="function"?(M=x.filter,v=M("",v)):s(x.filter)&&(M=x.filter,E=M);var k=[];if(typeof v!="object"||v===null)return"";var N=i[x.arrayFormat],I=N==="comma"&&x.commaRoundTrip;E||(E=Object.keys(v)),x.sort&&E.sort(x.sort);for(var D=n(),V=0;V<E.length;++V){var G=E[V],J=v[G];x.skipNulls&&J===null||o(k,g(J,G,N,I,x.allowEmptyArrays,x.strictNullHandling,x.skipNulls,x.encodeDotInKeys,x.encode?x.encoder:null,x.filter,x.sort,x.allowDots,x.serializeDate,x.format,x.formatter,x.encodeValuesOnly,x.charset,D))}var B=k.join(x.delimiter),$=x.addQueryPrefix===!0?"?":"";return x.charsetSentinel&&(x.charset==="iso-8859-1"?$+="utf8=%26%2310003%3B&":$+="utf8=%E2%9C%93&"),B.length>0?$+B:""},aF}var oF,Ane;function wtt(){if(Ane)return oF;Ane=1;var n=E0e(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},i=function(h){return h.replace(/&#(\d+);/g,function(g,p){return String.fromCharCode(parseInt(p,10))})},s=function(h,g,p){if(h&&typeof h=="string"&&g.comma&&h.indexOf(",")>-1)return h.split(",");if(g.throwOnLimitExceeded&&p>=g.arrayLimit)throw new RangeError("Array limit exceeded. Only "+g.arrayLimit+" element"+(g.arrayLimit===1?"":"s")+" allowed in an array.");return h},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",l=function(g,p){var _={__proto__:null},y=p.ignoreQueryPrefix?g.replace(/^\?/,""):g;y=y.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var v=p.parameterLimit===1/0?void 0:p.parameterLimit,x=y.split(p.delimiter,p.throwOnLimitExceeded?v+1:v);if(p.throwOnLimitExceeded&&x.length>v)throw new RangeError("Parameter limit exceeded. Only "+v+" parameter"+(v===1?"":"s")+" allowed.");var E=-1,M,k=p.charset;if(p.charsetSentinel)for(M=0;M<x.length;++M)x[M].indexOf("utf8=")===0&&(x[M]===o?k="utf-8":x[M]===a&&(k="iso-8859-1"),E=M,M=x.length);for(M=0;M<x.length;++M)if(M!==E){var N=x[M],I=N.indexOf("]="),D=I===-1?N.indexOf("="):I+1,V,G;D===-1?(V=p.decoder(N,r.decoder,k,"key"),G=p.strictNullHandling?null:""):(V=p.decoder(N.slice(0,D),r.decoder,k,"key"),G=n.maybeMap(s(N.slice(D+1),p,t(_[V])?_[V].length:0),function(B){return p.decoder(B,r.decoder,k,"value")})),G&&p.interpretNumericEntities&&k==="iso-8859-1"&&(G=i(String(G))),N.indexOf("[]=")>-1&&(G=t(G)?[G]:G);var J=e.call(_,V);J&&p.duplicates==="combine"?_[V]=n.combine(_[V],G):(!J||p.duplicates==="last")&&(_[V]=G)}return _},c=function(h,g,p,_){var y=0;if(h.length>0&&h[h.length-1]==="[]"){var v=h.slice(0,-1).join("");y=Array.isArray(g)&&g[v]?g[v].length:0}for(var x=_?g:s(g,p,y),E=h.length-1;E>=0;--E){var M,k=h[E];if(k==="[]"&&p.parseArrays)M=p.allowEmptyArrays&&(x===""||p.strictNullHandling&&x===null)?[]:n.combine([],x);else{M=p.plainObjects?{__proto__:null}:{};var N=k.charAt(0)==="["&&k.charAt(k.length-1)==="]"?k.slice(1,-1):k,I=p.decodeDotInKeys?N.replace(/%2E/g,"."):N,D=parseInt(I,10);!p.parseArrays&&I===""?M={0:x}:!isNaN(D)&&k!==I&&String(D)===I&&D>=0&&p.parseArrays&&D<=p.arrayLimit?(M=[],M[D]=x):I!=="__proto__"&&(M[I]=x)}x=M}return x},u=function(g,p,_,y){if(g){var v=_.allowDots?g.replace(/\.([^.[]+)/g,"[$1]"):g,x=/(\[[^[\]]*])/,E=/(\[[^[\]]*])/g,M=_.depth>0&&x.exec(v),k=M?v.slice(0,M.index):v,N=[];if(k){if(!_.plainObjects&&e.call(Object.prototype,k)&&!_.allowPrototypes)return;N.push(k)}for(var I=0;_.depth>0&&(M=E.exec(v))!==null&&I<_.depth;){if(I+=1,!_.plainObjects&&e.call(Object.prototype,M[1].slice(1,-1))&&!_.allowPrototypes)return;N.push(M[1])}if(M){if(_.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+_.depth+" and strictDepth is true");N.push("["+v.slice(M.index)+"]")}return c(N,p,_,y)}},f=function(g){if(!g)return r;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.decodeDotInKeys<"u"&&typeof g.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(g.decoder!==null&&typeof g.decoder<"u"&&typeof g.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof g.throwOnLimitExceeded<"u"&&typeof g.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var p=typeof g.charset>"u"?r.charset:g.charset,_=typeof g.duplicates>"u"?r.duplicates:g.duplicates;if(_!=="combine"&&_!=="first"&&_!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var y=typeof g.allowDots>"u"?g.decodeDotInKeys===!0?!0:r.allowDots:!!g.allowDots;return{allowDots:y,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:r.allowEmptyArrays,allowPrototypes:typeof g.allowPrototypes=="boolean"?g.allowPrototypes:r.allowPrototypes,allowSparse:typeof g.allowSparse=="boolean"?g.allowSparse:r.allowSparse,arrayLimit:typeof g.arrayLimit=="number"?g.arrayLimit:r.arrayLimit,charset:p,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:r.charsetSentinel,comma:typeof g.comma=="boolean"?g.comma:r.comma,decodeDotInKeys:typeof g.decodeDotInKeys=="boolean"?g.decodeDotInKeys:r.decodeDotInKeys,decoder:typeof g.decoder=="function"?g.decoder:r.decoder,delimiter:typeof g.delimiter=="string"||n.isRegExp(g.delimiter)?g.delimiter:r.delimiter,depth:typeof g.depth=="number"||g.depth===!1?+g.depth:r.depth,duplicates:_,ignoreQueryPrefix:g.ignoreQueryPrefix===!0,interpretNumericEntities:typeof g.interpretNumericEntities=="boolean"?g.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof g.parameterLimit=="number"?g.parameterLimit:r.parameterLimit,parseArrays:g.parseArrays!==!1,plainObjects:typeof g.plainObjects=="boolean"?g.plainObjects:r.plainObjects,strictDepth:typeof g.strictDepth=="boolean"?!!g.strictDepth:r.strictDepth,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:r.strictNullHandling,throwOnLimitExceeded:typeof g.throwOnLimitExceeded=="boolean"?g.throwOnLimitExceeded:!1}};return oF=function(h,g){var p=f(g);if(h===""||h===null||typeof h>"u")return p.plainObjects?{__proto__:null}:{};for(var _=typeof h=="string"?l(h,p):h,y=p.plainObjects?{__proto__:null}:{},v=Object.keys(_),x=0;x<v.length;++x){var E=v[x],M=u(E,_[E],p,typeof h=="string");y=n.merge(y,M,p)}return p.allowSparse===!0?y:n.compact(y)},oF}var lF,Cne;function Rtt(){if(Cne)return lF;Cne=1;var n=Ttt(),e=wtt(),t=rV();return lF={formats:t,parse:e,stringify:n},lF}var Mne;function Att(){if(Mne)return AS;Mne=1;var n=Wet();function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var t=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,i=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r",`
`,"	"],a=["{","}","|","\\","^","`"].concat(s),o=["'"].concat(a),l=["%","/","?",";","#"].concat(o),c=["/","?","#"],u=255,f=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=Rtt();function v(k,N,I){if(k&&typeof k=="object"&&k instanceof e)return k;var D=new e;return D.parse(k,N,I),D}e.prototype.parse=function(k,N,I){if(typeof k!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof k);var D=k.indexOf("?"),V=D!==-1&&D<k.indexOf("#")?"?":"#",G=k.split(V),J=/\\/g;G[0]=G[0].replace(J,"/"),k=G.join(V);var B=k;if(B=B.trim(),!I&&k.split("#").length===1){var $=i.exec(B);if($)return this.path=B,this.href=B,this.pathname=$[1],$[2]?(this.search=$[2],N?this.query=y.parse(this.search.substr(1)):this.query=this.search.substr(1)):N&&(this.search="",this.query={}),this}var U=t.exec(B);if(U){U=U[0];var Q=U.toLowerCase();this.protocol=Q,B=B.substr(U.length)}if(I||U||B.match(/^\/\/[^@/]+@[^@/]+/)){var W=B.substr(0,2)==="//";W&&!(U&&p[U])&&(B=B.substr(2),this.slashes=!0)}if(!p[U]&&(W||U&&!_[U])){for(var q=-1,Y=0;Y<c.length;Y++){var ae=B.indexOf(c[Y]);ae!==-1&&(q===-1||ae<q)&&(q=ae)}var Z,K;q===-1?K=B.lastIndexOf("@"):K=B.lastIndexOf("@",q),K!==-1&&(Z=B.slice(0,K),B=B.slice(K+1),this.auth=decodeURIComponent(Z)),q=-1;for(var Y=0;Y<l.length;Y++){var ae=B.indexOf(l[Y]);ae!==-1&&(q===-1||ae<q)&&(q=ae)}q===-1&&(q=B.length),this.host=B.slice(0,q),B=B.slice(q),this.parseHost(),this.hostname=this.hostname||"";var ne=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ne)for(var le=this.hostname.split(/\./),Y=0,ce=le.length;Y<ce;Y++){var de=le[Y];if(de&&!de.match(f)){for(var Me="",qe=0,Ne=de.length;qe<Ne;qe++)de.charCodeAt(qe)>127?Me+="x":Me+=de[qe];if(!Me.match(f)){var Ae=le.slice(0,Y),Xe=le.slice(Y+1),$e=de.match(h);$e&&(Ae.push($e[1]),Xe.unshift($e[2])),Xe.length&&(B="/"+Xe.join(".")+B),this.hostname=Ae.join(".");break}}}this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),ne||(this.hostname=n.toASCII(this.hostname));var at=this.port?":"+this.port:"",pt=this.hostname||"";this.host=pt+at,this.href+=this.host,ne&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),B[0]!=="/"&&(B="/"+B))}if(!g[Q])for(var Y=0,ce=o.length;Y<ce;Y++){var oe=o[Y];if(B.indexOf(oe)!==-1){var Ue=encodeURIComponent(oe);Ue===oe&&(Ue=escape(oe)),B=B.split(oe).join(Ue)}}var Ge=B.indexOf("#");Ge!==-1&&(this.hash=B.substr(Ge),B=B.slice(0,Ge));var ze=B.indexOf("?");if(ze!==-1?(this.search=B.substr(ze),this.query=B.substr(ze+1),N&&(this.query=y.parse(this.query)),B=B.slice(0,ze)):N&&(this.search="",this.query={}),B&&(this.pathname=B),_[Q]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var at=this.pathname||"",Be=this.search||"";this.path=at+Be}return this.href=this.format(),this};function x(k){return typeof k=="string"&&(k=v(k)),k instanceof e?k.format():e.prototype.format.call(k)}e.prototype.format=function(){var k=this.auth||"";k&&(k=encodeURIComponent(k),k=k.replace(/%3A/i,":"),k+="@");var N=this.protocol||"",I=this.pathname||"",D=this.hash||"",V=!1,G="";this.host?V=k+this.host:this.hostname&&(V=k+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(V+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(G=y.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var J=this.search||G&&"?"+G||"";return N&&N.substr(-1)!==":"&&(N+=":"),this.slashes||(!N||_[N])&&V!==!1?(V="//"+(V||""),I&&I.charAt(0)!=="/"&&(I="/"+I)):V||(V=""),D&&D.charAt(0)!=="#"&&(D="#"+D),J&&J.charAt(0)!=="?"&&(J="?"+J),I=I.replace(/[?#]/g,function(B){return encodeURIComponent(B)}),J=J.replace("#","%23"),N+V+I+J+D};function E(k,N){return v(k,!1,!0).resolve(N)}e.prototype.resolve=function(k){return this.resolveObject(v(k,!1,!0)).format()};function M(k,N){return k?v(k,!1,!0).resolveObject(N):N}return e.prototype.resolveObject=function(k){if(typeof k=="string"){var N=new e;N.parse(k,!1,!0),k=N}for(var I=new e,D=Object.keys(this),V=0;V<D.length;V++){var G=D[V];I[G]=this[G]}if(I.hash=k.hash,k.href==="")return I.href=I.format(),I;if(k.slashes&&!k.protocol){for(var J=Object.keys(k),B=0;B<J.length;B++){var $=J[B];$!=="protocol"&&(I[$]=k[$])}return _[I.protocol]&&I.hostname&&!I.pathname&&(I.pathname="/",I.path=I.pathname),I.href=I.format(),I}if(k.protocol&&k.protocol!==I.protocol){if(!_[k.protocol]){for(var U=Object.keys(k),Q=0;Q<U.length;Q++){var W=U[Q];I[W]=k[W]}return I.href=I.format(),I}if(I.protocol=k.protocol,!k.host&&!p[k.protocol]){for(var ce=(k.pathname||"").split("/");ce.length&&!(k.host=ce.shift()););k.host||(k.host=""),k.hostname||(k.hostname=""),ce[0]!==""&&ce.unshift(""),ce.length<2&&ce.unshift(""),I.pathname=ce.join("/")}else I.pathname=k.pathname;if(I.search=k.search,I.query=k.query,I.host=k.host||"",I.auth=k.auth,I.hostname=k.hostname||k.host,I.port=k.port,I.pathname||I.search){var q=I.pathname||"",Y=I.search||"";I.path=q+Y}return I.slashes=I.slashes||k.slashes,I.href=I.format(),I}var ae=I.pathname&&I.pathname.charAt(0)==="/",Z=k.host||k.pathname&&k.pathname.charAt(0)==="/",K=Z||ae||I.host&&k.pathname,ne=K,le=I.pathname&&I.pathname.split("/")||[],ce=k.pathname&&k.pathname.split("/")||[],de=I.protocol&&!_[I.protocol];if(de&&(I.hostname="",I.port=null,I.host&&(le[0]===""?le[0]=I.host:le.unshift(I.host)),I.host="",k.protocol&&(k.hostname=null,k.port=null,k.host&&(ce[0]===""?ce[0]=k.host:ce.unshift(k.host)),k.host=null),K=K&&(ce[0]===""||le[0]==="")),Z)I.host=k.host||k.host===""?k.host:I.host,I.hostname=k.hostname||k.hostname===""?k.hostname:I.hostname,I.search=k.search,I.query=k.query,le=ce;else if(ce.length)le||(le=[]),le.pop(),le=le.concat(ce),I.search=k.search,I.query=k.query;else if(k.search!=null){if(de){I.host=le.shift(),I.hostname=I.host;var Me=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Me&&(I.auth=Me.shift(),I.hostname=Me.shift(),I.host=I.hostname)}return I.search=k.search,I.query=k.query,(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.href=I.format(),I}if(!le.length)return I.pathname=null,I.search?I.path="/"+I.search:I.path=null,I.href=I.format(),I;for(var qe=le.slice(-1)[0],Ne=(I.host||k.host||le.length>1)&&(qe==="."||qe==="..")||qe==="",Ae=0,Xe=le.length;Xe>=0;Xe--)qe=le[Xe],qe==="."?le.splice(Xe,1):qe===".."?(le.splice(Xe,1),Ae++):Ae&&(le.splice(Xe,1),Ae--);if(!K&&!ne)for(;Ae--;Ae)le.unshift("..");K&&le[0]!==""&&(!le[0]||le[0].charAt(0)!=="/")&&le.unshift(""),Ne&&le.join("/").substr(-1)!=="/"&&le.push("");var $e=le[0]===""||le[0]&&le[0].charAt(0)==="/";if(de){I.hostname=$e?"":le.length?le.shift():"",I.host=I.hostname;var Me=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Me&&(I.auth=Me.shift(),I.hostname=Me.shift(),I.host=I.hostname)}return K=K||I.host&&le.length,K&&!$e&&le.unshift(""),le.length>0?I.pathname=le.join("/"):(I.pathname=null,I.path=null),(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.auth=k.auth||I.auth,I.slashes=I.slashes||k.slashes,I.href=I.format(),I},e.prototype.parseHost=function(){var k=this.host,N=r.exec(k);N&&(N=N[0],N!==":"&&(this.port=N.substr(1)),k=k.substr(0,k.length-N.length)),k&&(this.hostname=k)},AS.parse=v,AS.resolve=E,AS.resolveObject=M,AS.format=x,AS.Url=e,AS}var cF,One;function Ctt(){return One||(One=1,cF=typeof URL=="function"?URL:Att().URL),cF}var kne;function n6(){if(kne)return h_;kne=1;const n=Ctt();function e(G,J,B){if(J in G)return G[J];if(arguments.length===3)return B;throw new Error('"'+J+'" is a required argument.')}h_.getArg=e;const t=(function(){return!("__proto__"in Object.create(null))})();function r(G){return G}function i(G){return a(G)?"$"+G:G}h_.toSetString=t?r:i;function s(G){return a(G)?G.slice(1):G}h_.fromSetString=t?r:s;function a(G){if(!G)return!1;const J=G.length;if(J<9||G.charCodeAt(J-1)!==95||G.charCodeAt(J-2)!==95||G.charCodeAt(J-3)!==111||G.charCodeAt(J-4)!==116||G.charCodeAt(J-5)!==111||G.charCodeAt(J-6)!==114||G.charCodeAt(J-7)!==112||G.charCodeAt(J-8)!==95||G.charCodeAt(J-9)!==95)return!1;for(let B=J-10;B>=0;B--)if(G.charCodeAt(B)!==36)return!1;return!0}function o(G,J){return G===J?0:G===null?1:J===null?-1:G>J?1:-1}function l(G,J){let B=G.generatedLine-J.generatedLine;return B!==0||(B=G.generatedColumn-J.generatedColumn,B!==0)||(B=o(G.source,J.source),B!==0)||(B=G.originalLine-J.originalLine,B!==0)||(B=G.originalColumn-J.originalColumn,B!==0)?B:o(G.name,J.name)}h_.compareByGeneratedPositionsInflated=l;function c(G){return JSON.parse(G.replace(/^\)]}'[^\n]*\n/,""))}h_.parseSourceMapInput=c;const u="http:",f=`${u}//host`;function h(G){return J=>{const B=v(J),$=_(J),U=new n(J,$);G(U);const Q=U.toString();return B==="absolute"?Q:B==="scheme-relative"?Q.slice(u.length):B==="path-absolute"?Q.slice(f.length):x($,Q)}}function g(G,J){return new n(G,J).toString()}function p(G,J){let B=0;do{const $=G+B++;if(J.indexOf($)===-1)return $}while(!0)}function _(G){const J=G.split("..").length-1,B=p("p",G);let $=`${f}/`;for(let U=0;U<J;U++)$+=`${B}/`;return $}const y=/^[A-Za-z0-9\+\-\.]+:/;function v(G){return G[0]==="/"?G[1]==="/"?"scheme-relative":"path-absolute":y.test(G)?"absolute":"path-relative"}function x(G,J){typeof G=="string"&&(G=new n(G)),typeof J=="string"&&(J=new n(J));const B=J.pathname.split("/"),$=G.pathname.split("/");for($.length>0&&!$[$.length-1]&&$.pop();B.length>0&&$.length>0&&B[0]===$[0];)B.shift(),$.shift();return $.map(()=>"..").concat(B).join("/")+J.search+J.hash}const E=h(G=>{G.pathname=G.pathname.replace(/\/?$/,"/")}),M=h(G=>{G.href=new n(".",G.toString()).toString()}),k=h(G=>{});h_.normalize=k;function N(G,J){const B=v(J),$=v(G);if(G=E(G),B==="absolute")return g(J,void 0);if($==="absolute")return g(J,G);if(B==="scheme-relative")return k(J);if($==="scheme-relative")return g(J,g(G,f)).slice(u.length);if(B==="path-absolute")return k(J);if($==="path-absolute")return g(J,g(G,f)).slice(f.length);const U=_(J+G),Q=g(J,g(G,U));return x(U,Q)}h_.join=N;function I(G,J){const B=D(G,J);return typeof B=="string"?B:k(J)}h_.relative=I;function D(G,J){if(v(G)!==v(J))return null;const $=_(G+J),U=new n(G,$),Q=new n(J,$);try{new n("",Q.toString())}catch{return null}return Q.protocol!==U.protocol||Q.user!==U.user||Q.password!==U.password||Q.hostname!==U.hostname||Q.port!==U.port?null:x(U,Q)}function V(G,J,B){G&&v(J)==="path-absolute"&&(J=J.replace(/^\//,""));let $=k(J||"");return G&&($=N(G,$)),B&&($=N(M(B),$)),$}return h_.computeSourceURL=V,h_}var uF={},Ine;function x0e(){if(Ine)return uF;Ine=1;class n{constructor(){this._array=[],this._set=new Map}static fromArray(t,r){const i=new n;for(let s=0,a=t.length;s<a;s++)i.add(t[s],r);return i}size(){return this._set.size}add(t,r){const i=this.has(t),s=this._array.length;(!i||r)&&this._array.push(t),i||this._set.set(t,s)}has(t){return this._set.has(t)}indexOf(t){const r=this._set.get(t);if(r>=0)return r;throw new Error('"'+t+'" is not in the set.')}at(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)}toArray(){return this._array.slice()}}return uF.ArraySet=n,uF}var fF={},Nne;function Mtt(){if(Nne)return fF;Nne=1;const n=n6();function e(r,i){const s=r.generatedLine,a=i.generatedLine,o=r.generatedColumn,l=i.generatedColumn;return a>s||a==s&&l>=o||n.compareByGeneratedPositionsInflated(r,i)<=0}class t{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(i,s){this._array.forEach(i,s)}add(i){e(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))}toArray(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}return fF.MappingList=t,fF}var Pne;function T0e(){if(Pne)return m8;Pne=1;const n=d0e(),e=n6(),t=x0e().ArraySet,r=Mtt().MappingList;class i{constructor(a){a||(a={}),this._file=e.getArg(a,"file",null),this._sourceRoot=e.getArg(a,"sourceRoot",null),this._skipValidation=e.getArg(a,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new r,this._sourcesContents=null}static fromSourceMap(a){const o=a.sourceRoot,l=new i({file:a.file,sourceRoot:o});return a.eachMapping(function(c){const u={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(u.source=c.source,o!=null&&(u.source=e.relative(o,u.source)),u.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(u.name=c.name)),l.addMapping(u)}),a.sources.forEach(function(c){let u=c;o!=null&&(u=e.relative(o,c)),l._sources.has(u)||l._sources.add(u);const f=a.sourceContentFor(c);f!=null&&l.setSourceContent(c,f)}),l}addMapping(a){const o=e.getArg(a,"generated"),l=e.getArg(a,"original",null);let c=e.getArg(a,"source",null),u=e.getArg(a,"name",null);this._skipValidation||this._validateMapping(o,l,c,u),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:o.line,generatedColumn:o.column,originalLine:l&&l.line,originalColumn:l&&l.column,source:c,name:u})}setSourceContent(a,o){let l=a;this._sourceRoot!=null&&(l=e.relative(this._sourceRoot,l)),o!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(l)]=o):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(a,o,l){let c=o;if(o==null){if(a.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=a.file}const u=this._sourceRoot;u!=null&&(c=e.relative(u,c));const f=this._mappings.toArray().length>0?new t:this._sources,h=new t;this._mappings.unsortedForEach(function(g){if(g.source===c&&g.originalLine!=null){const y=a.originalPositionFor({line:g.originalLine,column:g.originalColumn});y.source!=null&&(g.source=y.source,l!=null&&(g.source=e.join(l,g.source)),u!=null&&(g.source=e.relative(u,g.source)),g.originalLine=y.line,g.originalColumn=y.column,y.name!=null&&(g.name=y.name))}const p=g.source;p!=null&&!f.has(p)&&f.add(p);const _=g.name;_!=null&&!h.has(_)&&h.add(_)},this),this._sources=f,this._names=h,a.sources.forEach(function(g){const p=a.sourceContentFor(g);p!=null&&(l!=null&&(g=e.join(l,g)),u!=null&&(g=e.relative(u,g)),this.setSourceContent(g,p))},this)}_validateMapping(a,o,l,c){if(o&&typeof o.line!="number"&&typeof o.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!o&&!l&&!c)){if(!(a&&"line"in a&&"column"in a&&o&&"line"in o&&"column"in o&&a.line>0&&a.column>=0&&o.line>0&&o.column>=0&&l))throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:l,original:o,name:c}))}}_serializeMappings(){let a=0,o=1,l=0,c=0,u=0,f=0,h="",g,p,_,y;const v=this._mappings.toArray();for(let x=0,E=v.length;x<E;x++){if(p=v[x],g="",p.generatedLine!==o)for(a=0;p.generatedLine!==o;)g+=";",o++;else if(x>0){if(!e.compareByGeneratedPositionsInflated(p,v[x-1]))continue;g+=","}g+=n.encode(p.generatedColumn-a),a=p.generatedColumn,p.source!=null&&(y=this._sources.indexOf(p.source),g+=n.encode(y-f),f=y,g+=n.encode(p.originalLine-1-c),c=p.originalLine-1,g+=n.encode(p.originalColumn-l),l=p.originalColumn,p.name!=null&&(_=this._names.indexOf(p.name),g+=n.encode(_-u),u=_)),h+=g}return h}_generateSourcesContent(a,o){return a.map(function(l){if(!this._sourcesContents)return null;o!=null&&(l=e.relative(o,l));const c=e.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)}toJSON(){const a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(a.file=this._file),this._sourceRoot!=null&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a}toString(){return JSON.stringify(this.toJSON())}}return i.prototype._version=3,m8.SourceMapGenerator=i,m8}var qM={},hF={},Dne;function Ott(){return Dne||(Dne=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,r,i,s,a,o){const l=Math.floor((r-t)/2)+t,c=a(i,s[l],!0);return c===0?l:c>0?r-l>1?e(l,r,i,s,a,o):o===n.LEAST_UPPER_BOUND?r<s.length?r:-1:l:l-t>1?e(t,l,i,s,a,o):o==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(r,i,s,a){if(i.length===0)return-1;let o=e(-1,i.length,r,i,s,a||n.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(i[o],i[o-1],!0)===0;)--o;return o}})(hF)),hF}var xN={exports:{}},Lne;function w0e(){if(Lne)return xN.exports;Lne=1;let n=null;return xN.exports=function(){if(typeof n=="string")return fetch(n).then(t=>t.arrayBuffer());if(n instanceof ArrayBuffer)return Promise.resolve(n);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},xN.exports.initialize=e=>{n=e},xN.exports}var dF,Une;function ktt(){if(Une)return dF;Une=1;const n=w0e();function e(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let t=null;return dF=function(){if(t)return t;const i=[];return t=n().then(s=>WebAssembly.instantiate(s,{env:{mapping_callback(a,o,l,c,u,f,h,g,p,_){const y=new e;y.generatedLine=a+1,y.generatedColumn=o,l&&(y.lastGeneratedColumn=c-1),u&&(y.source=f,y.originalLine=h+1,y.originalColumn=g,p&&(y.name=_)),i[i.length-1](y)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(s=>({exports:s.instance.exports,withMappingCallback:(a,o)=>{i.push(a);try{o()}finally{i.pop()}}})).then(null,s=>{throw t=null,s}),t},dF}var Bne;function Itt(){if(Bne)return qM;Bne=1;const n=n6(),e=Ott(),t=x0e().ArraySet;d0e();const r=w0e(),i=ktt(),s=Symbol("smcInternal");class a{constructor(h,g){return h==s?Promise.resolve(this):c(h,g)}static initialize(h){r.initialize(h["lib/mappings.wasm"])}static fromSourceMap(h,g){return u(h,g)}static async with(h,g,p){const _=await new a(h,g);try{return await p(_)}finally{_.destroy()}}eachMapping(h,g,p){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(h){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}a.prototype._version=3,a.GENERATED_ORDER=1,a.ORIGINAL_ORDER=2,a.GREATEST_LOWER_BOUND=1,a.LEAST_UPPER_BOUND=2,qM.SourceMapConsumer=a;class o extends a{constructor(h,g){return super(s).then(p=>{let _=h;typeof h=="string"&&(_=n.parseSourceMapInput(h));const y=n.getArg(_,"version"),v=n.getArg(_,"sources").map(String),x=n.getArg(_,"names",[]),E=n.getArg(_,"sourceRoot",null),M=n.getArg(_,"sourcesContent",null),k=n.getArg(_,"mappings"),N=n.getArg(_,"file",null),I=n.getArg(_,"x_google_ignoreList",null);if(y!=p._version)throw new Error("Unsupported version: "+y);return p._sourceLookupCache=new Map,p._names=t.fromArray(x.map(String),!0),p._sources=t.fromArray(v,!0),p._absoluteSources=t.fromArray(p._sources.toArray().map(function(D){return n.computeSourceURL(E,D,g)}),!0),p.sourceRoot=E,p.sourcesContent=M,p._mappings=k,p._sourceMapURL=g,p.file=N,p.x_google_ignoreList=I,p._computedColumnSpans=!1,p._mappingsPtr=0,p._wasm=null,i().then(D=>(p._wasm=D,p))})}_findSourceIndex(h){const g=this._sourceLookupCache.get(h);if(typeof g=="number")return g;const p=n.computeSourceURL(null,h,this._sourceMapURL);if(this._absoluteSources.has(p)){const y=this._absoluteSources.indexOf(p);return this._sourceLookupCache.set(h,y),y}const _=n.computeSourceURL(this.sourceRoot,h,this._sourceMapURL);if(this._absoluteSources.has(_)){const y=this._absoluteSources.indexOf(_);return this._sourceLookupCache.set(h,y),y}return-1}static fromSourceMap(h,g){return new o(h.toString())}get sources(){return this._absoluteSources.toArray()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(),this._mappingsPtr}_parseMappings(){const h=this._mappings,g=h.length,p=this._wasm.exports.allocate_mappings(g)>>>0,_=new Uint8Array(this._wasm.exports.memory.buffer,p,g);for(let v=0;v<g;v++)_[v]=h.charCodeAt(v);const y=this._wasm.exports.parse_mappings(p);if(!y){const v=this._wasm.exports.get_last_error();let x=`Error parsing mappings (code ${v}): `;switch(v){case 1:x+="the mappings contained a negative line, column, source index, or name index";break;case 2:x+="the mappings contained a number larger than 2**32";break;case 3:x+="reached EOF while in the middle of parsing a VLQ";break;case 4:x+="invalid base 64 character while parsing a VLQ";break;default:x+="unknown error code";break}throw new Error(x)}this._mappingsPtr=y}eachMapping(h,g,p){const _=g||null,y=p||a.GENERATED_ORDER;this._wasm.withMappingCallback(v=>{v.source!==null&&(v.source=this._absoluteSources.at(v.source),v.name!==null&&(v.name=this._names.at(v.name))),this._computedColumnSpans&&v.lastGeneratedColumn===null&&(v.lastGeneratedColumn=1/0),h.call(_,v)},()=>{switch(y){case a.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case a.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(h){let g=n.getArg(h,"source");const p=n.getArg(h,"line"),_=h.column||0;if(g=this._findSourceIndex(g),g<0)return[];if(p<1)throw new Error("Line numbers must be >= 1");if(_<0)throw new Error("Column numbers must be >= 0");const y=[];return this._wasm.withMappingCallback(v=>{let x=v.lastGeneratedColumn;this._computedColumnSpans&&x===null&&(x=1/0),y.push({line:v.generatedLine,column:v.generatedColumn,lastColumn:x})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),g,p-1,"column"in h,_)}),y}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(h){const g={generatedLine:n.getArg(h,"line"),generatedColumn:n.getArg(h,"column")};if(g.generatedLine<1)throw new Error("Line numbers must be >= 1");if(g.generatedColumn<0)throw new Error("Column numbers must be >= 0");let p=n.getArg(h,"bias",a.GREATEST_LOWER_BOUND);p==null&&(p=a.GREATEST_LOWER_BOUND);let _;if(this._wasm.withMappingCallback(y=>_=y,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),g.generatedLine-1,g.generatedColumn,p)}),_&&_.generatedLine===g.generatedLine){let y=n.getArg(_,"source",null);y!==null&&(y=this._absoluteSources.at(y));let v=n.getArg(_,"name",null);return v!==null&&(v=this._names.at(v)),{source:y,line:n.getArg(_,"originalLine",null),column:n.getArg(_,"originalColumn",null),name:v}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(h){return h==null}):!1}sourceContentFor(h,g){if(!this.sourcesContent)return null;const p=this._findSourceIndex(h);if(p>=0)return this.sourcesContent[p];if(g)return null;throw new Error('"'+h+'" is not in the SourceMap.')}generatedPositionFor(h){let g=n.getArg(h,"source");if(g=this._findSourceIndex(g),g<0)return{line:null,column:null,lastColumn:null};const p={source:g,originalLine:n.getArg(h,"line"),originalColumn:n.getArg(h,"column")};if(p.originalLine<1)throw new Error("Line numbers must be >= 1");if(p.originalColumn<0)throw new Error("Column numbers must be >= 0");let _=n.getArg(h,"bias",a.GREATEST_LOWER_BOUND);_==null&&(_=a.GREATEST_LOWER_BOUND);let y;if(this._wasm.withMappingCallback(v=>y=v,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),p.source,p.originalLine-1,p.originalColumn,_)}),y&&y.source===p.source){let v=y.lastGeneratedColumn;return this._computedColumnSpans&&v===null&&(v=1/0),{line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:v}}return{line:null,column:null,lastColumn:null}}}o.prototype.consumer=a,qM.BasicSourceMapConsumer=o;class l extends a{constructor(h,g){return super(s).then(p=>{let _=h;typeof h=="string"&&(_=n.parseSourceMapInput(h));const y=n.getArg(_,"version"),v=n.getArg(_,"sections");if(y!=p._version)throw new Error("Unsupported version: "+y);let x={line:-1,column:0};return Promise.all(v.map(E=>{if(E.url)throw new Error("Support for url field in sections not implemented.");const M=n.getArg(E,"offset"),k=n.getArg(M,"line"),N=n.getArg(M,"column");if(k<x.line||k===x.line&&N<x.column)throw new Error("Section offsets must be ordered and non-overlapping.");return x=M,new a(n.getArg(E,"map"),g).then(D=>({generatedOffset:{generatedLine:k+1,generatedColumn:N+1},consumer:D}))})).then(E=>(p._sections=E,p))})}get sources(){const h=[];for(let g=0;g<this._sections.length;g++)for(let p=0;p<this._sections[g].consumer.sources.length;p++)h.push(this._sections[g].consumer.sources[p]);return h}originalPositionFor(h){const g={generatedLine:n.getArg(h,"line"),generatedColumn:n.getArg(h,"column")},p=e.search(g,this._sections,function(y,v){const x=y.generatedLine-v.generatedOffset.generatedLine;return x||y.generatedColumn-(v.generatedOffset.generatedColumn-1)}),_=this._sections[p];return _?_.consumer.originalPositionFor({line:g.generatedLine-(_.generatedOffset.generatedLine-1),column:g.generatedColumn-(_.generatedOffset.generatedLine===g.generatedLine?_.generatedOffset.generatedColumn-1:0),bias:h.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(h){return h.consumer.hasContentsOfAllSources()})}sourceContentFor(h,g){for(let p=0;p<this._sections.length;p++){const y=this._sections[p].consumer.sourceContentFor(h,!0);if(y)return y}if(g)return null;throw new Error('"'+h+'" is not in the SourceMap.')}_findSectionIndex(h){for(let g=0;g<this._sections.length;g++){const{consumer:p}=this._sections[g];if(p._findSourceIndex(h)!==-1)return g}return-1}generatedPositionFor(h){const g=this._findSectionIndex(n.getArg(h,"source")),p=g>=0?this._sections[g]:null,_=g>=0&&g+1<this._sections.length?this._sections[g+1]:null,y=p&&p.consumer.generatedPositionFor(h);if(y&&y.line!==null){const v=p.generatedOffset.generatedLine-1,x=p.generatedOffset.generatedColumn-1;return y.line===1&&(y.column+=x,typeof y.lastColumn=="number"&&(y.lastColumn+=x)),y.lastColumn===1/0&&_&&y.line===_.generatedOffset.generatedLine&&(y.lastColumn=_.generatedOffset.generatedColumn-2),y.line+=v,y}return{line:null,column:null,lastColumn:null}}allGeneratedPositionsFor(h){const g=this._findSectionIndex(n.getArg(h,"source")),p=g>=0?this._sections[g]:null,_=g>=0&&g+1<this._sections.length?this._sections[g+1]:null;return p?p.consumer.allGeneratedPositionsFor(h).map(y=>{const v=p.generatedOffset.generatedLine-1,x=p.generatedOffset.generatedColumn-1;return y.line===1&&(y.column+=x,typeof y.lastColumn=="number"&&(y.lastColumn+=x)),y.lastColumn===1/0&&_&&y.line===_.generatedOffset.generatedLine&&(y.lastColumn=_.generatedOffset.generatedColumn-2),y.line+=v,y}):[]}eachMapping(h,g,p){this._sections.forEach((_,y)=>{const v=y+1<this._sections.length?this._sections[y+1]:null,{generatedOffset:x}=_,E=x.generatedLine-1,M=x.generatedColumn-1;_.consumer.eachMapping(function(k){k.generatedLine===1&&(k.generatedColumn+=M,typeof k.lastGeneratedColumn=="number"&&(k.lastGeneratedColumn+=M)),k.lastGeneratedColumn===1/0&&v&&k.generatedLine===v.generatedOffset.generatedLine&&(k.lastGeneratedColumn=v.generatedOffset.generatedColumn-2),k.generatedLine+=E,h.call(this,k)},g,p)})}computeColumnSpans(){for(let h=0;h<this._sections.length;h++)this._sections[h].consumer.computeColumnSpans()}destroy(){for(let h=0;h<this._sections.length;h++)this._sections[h].consumer.destroy()}}qM.IndexedSourceMapConsumer=l;function c(f,h){let g=f;typeof f=="string"&&(g=n.parseSourceMapInput(f));const p=g.sections!=null?new l(g,h):new o(g,h);return Promise.resolve(p)}function u(f,h){return o.fromSourceMap(f,h)}return qM}var pF={},Fne;function Ntt(){if(Fne)return pF;Fne=1;const n=T0e().SourceMapGenerator,e=n6(),t=/(\r?\n)/,r=10,i="$$$isSourceNode$$$";class s{constructor(o,l,c,u,f){this.children=[],this.sourceContents={},this.line=o??null,this.column=l??null,this.source=c??null,this.name=f??null,this[i]=!0,u!=null&&this.add(u)}static fromStringWithSourceMap(o,l,c){const u=new s,f=o.split(t);let h=0;const g=function(){const E=k(),M=k()||"";return E+M;function k(){return h<f.length?f[h++]:void 0}};let p=1,_=0,y=null,v;return l.eachMapping(function(E){if(y!==null)if(p<E.generatedLine)x(y,g()),p++,_=0;else{v=f[h]||"";const M=v.substr(0,E.generatedColumn-_);f[h]=v.substr(E.generatedColumn-_),_=E.generatedColumn,x(y,M),y=E;return}for(;p<E.generatedLine;)u.add(g()),p++;_<E.generatedColumn&&(v=f[h]||"",u.add(v.substr(0,E.generatedColumn)),f[h]=v.substr(E.generatedColumn),_=E.generatedColumn),y=E},this),h<f.length&&(y&&x(y,g()),u.add(f.splice(h).join(""))),l.sources.forEach(function(E){const M=l.sourceContentFor(E);M!=null&&(c!=null&&(E=e.join(c,E)),u.setSourceContent(E,M))}),u;function x(E,M){if(E===null||E.source===void 0)u.add(M);else{const k=c?e.join(c,E.source):E.source;u.add(new s(E.originalLine,E.originalColumn,k,M,E.name))}}}add(o){if(Array.isArray(o))o.forEach(function(l){this.add(l)},this);else if(o[i]||typeof o=="string")o&&this.children.push(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this}prepend(o){if(Array.isArray(o))for(let l=o.length-1;l>=0;l--)this.prepend(o[l]);else if(o[i]||typeof o=="string")this.children.unshift(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this}walk(o){let l;for(let c=0,u=this.children.length;c<u;c++)l=this.children[c],l[i]?l.walk(o):l!==""&&o(l,{source:this.source,line:this.line,column:this.column,name:this.name})}join(o){let l,c;const u=this.children.length;if(u>0){for(l=[],c=0;c<u-1;c++)l.push(this.children[c]),l.push(o);l.push(this.children[c]),this.children=l}return this}replaceRight(o,l){const c=this.children[this.children.length-1];return c[i]?c.replaceRight(o,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(o,l):this.children.push("".replace(o,l)),this}setSourceContent(o,l){this.sourceContents[e.toSetString(o)]=l}walkSourceContents(o){for(let c=0,u=this.children.length;c<u;c++)this.children[c][i]&&this.children[c].walkSourceContents(o);const l=Object.keys(this.sourceContents);for(let c=0,u=l.length;c<u;c++)o(e.fromSetString(l[c]),this.sourceContents[l[c]])}toString(){let o="";return this.walk(function(l){o+=l}),o}toStringWithSourceMap(o){const l={code:"",line:1,column:0},c=new n(o);let u=!1,f=null,h=null,g=null,p=null;return this.walk(function(_,y){l.code+=_,y.source!==null&&y.line!==null&&y.column!==null?((f!==y.source||h!==y.line||g!==y.column||p!==y.name)&&c.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:l.line,column:l.column},name:y.name}),f=y.source,h=y.line,g=y.column,p=y.name,u=!0):u&&(c.addMapping({generated:{line:l.line,column:l.column}}),f=null,u=!1);for(let v=0,x=_.length;v<x;v++)_.charCodeAt(v)===r?(l.line++,l.column=0,v+1===x?(f=null,u=!1):u&&c.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:l.line,column:l.column},name:y.name})):l.column++}),this.walkSourceContents(function(_,y){c.setSourceContent(_,y)}),{code:l.code,map:c}}}return pF.SourceNode=s,pF}var zne;function Ptt(){return zne||(zne=1,HM.SourceMapGenerator=T0e().SourceMapGenerator,HM.SourceMapConsumer=Itt().SourceMapConsumer,HM.SourceNode=Ntt().SourceNode),HM}var Dtt=Ptt();let jne=0;const Hne=Hv,Ltt=["Command","lines"];class Utt extends PGe{constructor(){super(Bme,{traceInitPerf:Hv,skipValidations:!Hv,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"}),this.performSelfAnalysis()}PEEK(e,t,...r){console.info(e,r.map(i=>[i.image,i.tokenType]),t)}RULED(e,t,r){const i=Ltt.some(s=>e.includes(s));return this.RULE(e,()=>{const a=(jne++).toString().padStart(3),o=i?"font-weight: bold;":"";if(Hne&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(c=>`[${c.tokenType.name} ${c.image.replaceAll(`
`,"\\n")}]`);console.info(`${a}%c> ${e} ${l.join(" ")}`,o)}t(),Hne&&!this.RECORDING_PHASE&&console.info(`${a}%c< ${e} `,o),jne--},r)}program=this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))});line=this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(MO)}])});stmt=this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])});inline_go=this.RULED("inline_go",()=>{this.SUBRULE(this.short_go),this.OPTION(()=>this.SUBRULE(this.inline))});inline_try=this.RULED("inline_try",()=>{this.SUBRULE(this.short_try),this.OPTION(()=>this.SUBRULE(this.inline))});inline_command=this.RULED("inline_command",()=>{this.SUBRULE(this.stmt_command),this.OPTION(()=>this.SUBRULE(this.inline))});inline=this.RULED("inline",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.structured_cmd)},{ALT:()=>this.SUBRULE(this.inline_go)},{ALT:()=>this.SUBRULE(this.inline_try)},{ALT:()=>this.SUBRULE(this.inline_command)}])});stmt_label=this.RULED("stmt_label",()=>{this.CONSUME(yw)});stmt_stat=this.RULED("stmt_stat",()=>{this.CONSUME(LE)});stmt_text=this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(OO)}])});stmt_comment=this.RULED("stmt_comment",()=>{this.CONSUME(kO)});stmt_hyperlink=this.RULED("stmt_hyperlink",()=>{this.CONSUME(IO),this.CONSUME(cq)});stmt_command=this.RULED("stmt_command",()=>{this.CONSUME(qy),this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])});structured_cmd=this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])});short_go=this.RULED("short_go",()=>{this.CONSUME(dE),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});short_try=this.RULED("short_try",()=>{this.CONSUME(NO),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});command_if=this.RULED("command_if",()=>{this.CONSUME(pE),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))});command_if_block=this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mE),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(MO)),this.CONSUME4(qy),this.CONSUME4(wL)}}])});command_block=this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mE),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(qy),this.CONSUME(wL)}}])});command_fork=this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(mE),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])});command_else_if=this.RULED("command_else_if",()=>{this.CONSUME(qy),this.CONSUME(gE),this.CONSUME(pE),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))});command_else=this.RULED("command_else",()=>{this.CONSUME(qy),this.CONSUME(gE),this.OPTION1(()=>this.SUBRULE(this.words)),this.OPTION2(()=>this.SUBRULE(this.command_fork))});command_while=this.RULED("command_while",()=>{this.CONSUME(xq),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_repeat=this.RULED("command_repeat",()=>{this.CONSUME(Tq),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_waitfor=this.RULED("command_waitfor",()=>{this.CONSUME(wq),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_foreach=this.RULED("command_foreach",()=>{this.CONSUME(Rq),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_break=this.RULED("command_break",()=>{this.CONSUME(Aq)});command_continue=this.RULED("command_continue",()=>{this.CONSUME(Cq)});command_play=this.RULED("command_play",()=>{this.CONSUME(Eq)});command_toast=this.RULED("command_toast",()=>{this.CONSUME(Dme)});command_ticker=this.RULED("command_ticker",()=>{this.CONSUME(Lme)});expr=this.RULED("expr",()=>{this.SUBRULE1(this.and_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(bL),this.SUBRULE2(this.and_test,{LABEL:"RHS"})})});and_test=this.RULED("and_test",()=>{this.SUBRULE1(this.not_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(EL),this.SUBRULE2(this.not_test,{LABEL:"RHS"})})});not_test=this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(SL),this.SUBRULE1(this.not_test,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.comparison)}])});comparison=this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr,{LABEL:"LHS"}),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr,{LABEL:"RHS"})})});comp_op=this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(uq)},{ALT:()=>this.CONSUME(fq)},{ALT:()=>this.CONSUME(hq)},{ALT:()=>this.CONSUME(dq)},{ALT:()=>this.CONSUME(pq)},{ALT:()=>this.CONSUME(mq)}])});expr_value=this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(bL),this.SUBRULE2(this.and_test_value,{LABEL:"RHS"})})});and_test_value=this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(EL),this.SUBRULE2(this.not_test_value,{LABEL:"RHS"})})});not_test_value=this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(SL),this.SUBRULE1(this.not_test_value,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])});arith_expr=this.RULED("arith_expr",()=>{this.OR([{ALT:()=>this.SUBRULE(this.token_expr,{LABEL:"LHS"})},{ALT:()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item,{LABEL:"RHS"}))}}])});arith_expr_item=this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(xL)},{ALT:()=>this.CONSUME(TL)}]),this.SUBRULE(this.term)});term=this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))});term_item=this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(_q)},{ALT:()=>this.CONSUME(dE)},{ALT:()=>this.CONSUME(vq)},{ALT:()=>this.CONSUME(yq)}]),this.SUBRULE(this.factor)});factor=this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(xL)},{ALT:()=>this.CONSUME(TL)}]),this.SUBRULE(this.factor,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE(this.power)}])});power=this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(gq),this.SUBRULE(this.factor)})});words=this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))});kind=this.RULED("kind",()=>{this.OPTION(()=>this.SUBRULE(this.color)),this.SUBRULE(this.string_token)});category=this.RULED("category",()=>{this.OR([{ALT:()=>this.CONSUME(sde)},{ALT:()=>this.CONSUME(ade)}])});collision=this.RULED("collision",()=>{this.OR([{ALT:()=>this.CONSUME(ode)},{ALT:()=>this.CONSUME(lde)},{ALT:()=>this.CONSUME(cde)},{ALT:()=>this.CONSUME(ude)},{ALT:()=>this.CONSUME(fde)},{ALT:()=>this.CONSUME(hde)},{ALT:()=>this.CONSUME(dde)},{ALT:()=>this.CONSUME(pde)},{ALT:()=>this.CONSUME(mde)}])});color=this.RULED("color",()=>{this.OR([{ALT:()=>this.CONSUME(gde)},{ALT:()=>this.CONSUME(_de)},{ALT:()=>this.CONSUME(vde)},{ALT:()=>this.CONSUME(yde)},{ALT:()=>this.CONSUME(bde)},{ALT:()=>this.CONSUME(Sde)},{ALT:()=>this.CONSUME(Ede)},{ALT:()=>this.CONSUME(xde)},{ALT:()=>this.CONSUME(Tde)},{ALT:()=>this.CONSUME(wde)},{ALT:()=>this.CONSUME(Rde)},{ALT:()=>this.CONSUME(Ade)},{ALT:()=>this.CONSUME(Cde)},{ALT:()=>this.CONSUME(Mde)},{ALT:()=>this.CONSUME(Ode)},{ALT:()=>this.CONSUME(kde)},{ALT:()=>this.CONSUME(Ide)},{ALT:()=>this.CONSUME(Nde)},{ALT:()=>this.CONSUME(Pde)},{ALT:()=>this.CONSUME(Dde)},{ALT:()=>this.CONSUME(Lde)},{ALT:()=>this.CONSUME(Ude)},{ALT:()=>this.CONSUME(Bde)},{ALT:()=>this.CONSUME(Fde)},{ALT:()=>this.CONSUME(zde)},{ALT:()=>this.CONSUME(jde)},{ALT:()=>this.CONSUME(Hde)},{ALT:()=>this.CONSUME(qde)},{ALT:()=>this.CONSUME(Vde)},{ALT:()=>this.CONSUME(Gde)},{ALT:()=>this.CONSUME($de)},{ALT:()=>this.CONSUME(Wde)},{ALT:()=>this.CONSUME(Yde)},{ALT:()=>this.CONSUME(Xde)},{ALT:()=>this.CONSUME(Kde)},{ALT:()=>this.CONSUME(Zde)},{ALT:()=>this.CONSUME(Jde)},{ALT:()=>this.CONSUME(Qde)},{ALT:()=>this.CONSUME(epe)},{ALT:()=>this.CONSUME(tpe)},{ALT:()=>this.CONSUME(npe)},{ALT:()=>this.CONSUME(rpe)},{ALT:()=>this.CONSUME(ipe)},{ALT:()=>this.CONSUME(spe)},{ALT:()=>this.CONSUME(ape)},{ALT:()=>this.CONSUME(ope)},{ALT:()=>this.CONSUME(lpe)},{ALT:()=>this.CONSUME(cpe)},{ALT:()=>this.CONSUME(upe)},{ALT:()=>this.CONSUME(fpe)},{ALT:()=>this.CONSUME(hpe)},{ALT:()=>this.CONSUME(dpe)},{ALT:()=>this.CONSUME(ppe)},{ALT:()=>this.CONSUME(mpe)},{ALT:()=>this.CONSUME(gpe)},{ALT:()=>this.CONSUME(_pe)},{ALT:()=>this.CONSUME(vpe)},{ALT:()=>this.CONSUME(ype)},{ALT:()=>this.CONSUME(bpe)},{ALT:()=>this.CONSUME(Spe)},{ALT:()=>this.CONSUME(Epe)},{ALT:()=>this.CONSUME(xpe)},{ALT:()=>this.CONSUME(Tpe)},{ALT:()=>this.CONSUME(wpe)},{ALT:()=>this.CONSUME(Rpe)},{ALT:()=>this.CONSUME(Ape)},{ALT:()=>this.CONSUME(Cpe)},{ALT:()=>this.CONSUME(Mpe)},{ALT:()=>this.CONSUME(Ope)},{ALT:()=>this.CONSUME(kpe)}])});dir_mod=this.RULED("dir_mod",()=>{this.OR([{ALT:()=>this.CONSUME(Vpe)},{ALT:()=>this.CONSUME(Gpe)},{ALT:()=>this.CONSUME($pe)},{ALT:()=>this.CONSUME(Wpe)},{ALT:()=>this.CONSUME(hme)},{ALT:()=>this.CONSUME(dme)},{ALT:()=>this.SUBRULE(this.dir_within)},{ALT:()=>this.SUBRULE(this.dir_awayby)}])});dir_by=this.RULED("dir_by",()=>{this.CONSUME(Upe),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_at=this.RULED("dir_at",()=>{this.CONSUME(Bpe),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_away=this.RULED("dir_away",()=>{this.CONSUME(Ype),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_toward=this.RULED("dir_toward",()=>{this.CONSUME(Xpe),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_find=this.RULED("dir_find",()=>{this.CONSUME(Kpe),this.SUBRULE1(this.kind)});dir_flee=this.RULED("dir_flee",()=>{this.CONSUME(Zpe),this.SUBRULE1(this.kind)});dir_to=this.RULED("dir_to",()=>{this.CONSUME(Jpe),this.SUBRULE1(this.dir),this.SUBRULE2(this.dir)});dir_within=this.RULED("dir_within",()=>{this.CONSUME(pme),this.SUBRULE1(this.simple_token)});dir_awayby=this.RULED("dir_awayby",()=>{this.CONSUME(mme),this.SUBRULE1(this.simple_token)});dir=this.RULED("dir",()=>{this.MANY(()=>this.SUBRULE(this.dir_mod)),this.OR([{ALT:()=>this.CONSUME(Ipe)},{ALT:()=>this.CONSUME(Npe)},{ALT:()=>this.CONSUME(Ppe)},{ALT:()=>this.CONSUME(Dpe)},{ALT:()=>this.CONSUME(Lpe)},{ALT:()=>this.SUBRULE(this.dir_by)},{ALT:()=>this.SUBRULE(this.dir_at)},{ALT:()=>this.SUBRULE(this.dir_away)},{ALT:()=>this.SUBRULE(this.dir_toward)},{ALT:()=>this.CONSUME(Fpe)},{ALT:()=>this.CONSUME(zpe)},{ALT:()=>this.CONSUME(jpe)},{ALT:()=>this.CONSUME(Hpe)},{ALT:()=>this.CONSUME(qpe)},{ALT:()=>this.SUBRULE(this.dir_find)},{ALT:()=>this.SUBRULE(this.dir_flee)},{ALT:()=>this.SUBRULE(this.dir_to)},{ALT:()=>this.CONSUME(Qpe)},{ALT:()=>this.CONSUME(eme)},{ALT:()=>this.CONSUME(tme)},{ALT:()=>this.CONSUME(nme)},{ALT:()=>this.CONSUME(rme)},{ALT:()=>this.CONSUME(ime)},{ALT:()=>this.CONSUME(sme)},{ALT:()=>this.CONSUME(ame)},{ALT:()=>this.CONSUME(ome)},{ALT:()=>this.CONSUME(lme)},{ALT:()=>this.CONSUME(cme)},{ALT:()=>this.CONSUME(ume)},{ALT:()=>this.CONSUME(fme)}])});expr_any=this.RULED("expr_any",()=>{this.OR1([{ALT:()=>this.SUBRULE1(this.kind)},{ALT:()=>this.SUBRULE1(this.color)},{ALT:()=>{this.SUBRULE(this.dir),this.OR2([{ALT:()=>this.SUBRULE2(this.kind)},{ALT:()=>this.SUBRULE2(this.color)}])}}])});token_expr_any=this.RULED("token_expr_any",()=>{this.CONSUME(yme),this.SUBRULE(this.expr_any)});token_expr_count=this.RULED("token_expr_count",()=>{this.CONSUME(bme),this.SUBRULE(this.expr_any)});token_expr_blocked=this.RULED("token_expr_blocked",()=>{this.CONSUME(vme),this.SUBRULE(this.dir)});token_expr_abs=this.RULED("token_expr_abs",()=>{this.CONSUME(Sme),this.SUBRULE(this.simple_token)});token_expr_intceil=this.RULED("token_expr_intceil",()=>{this.CONSUME(Eme),this.SUBRULE(this.simple_token)});token_expr_intfloor=this.RULED("token_expr_intfloor",()=>{this.CONSUME(xme),this.SUBRULE(this.simple_token)});token_expr_intround=this.RULED("token_expr_intround",()=>{this.CONSUME(Tme),this.SUBRULE(this.simple_token)});token_expr_clamp=this.RULED("token_expr_clamp",()=>{this.CONSUME(wme),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.SUBRULE3(this.simple_token)});token_expr_min=this.RULED("token_expr_min",()=>{this.CONSUME(Rme),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_max=this.RULED("token_expr_max",()=>{this.CONSUME(Ame),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pick=this.RULED("token_expr_pick",()=>{this.CONSUME(Cme),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pickwith=this.RULED("token_expr_pickwith",()=>{this.CONSUME(Mme),this.SUBRULE1(this.simple_token),this.AT_LEAST_ONE(()=>this.SUBRULE2(this.simple_token))});token_expr_random=this.RULED("token_expr_random",()=>{this.CONSUME(Ome),this.SUBRULE1(this.simple_token),this.OPTION(()=>this.SUBRULE2(this.simple_token))});token_expr_randomwith=this.RULED("token_expr_randomwith",()=>{this.CONSUME(kme),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.OPTION(()=>this.SUBRULE3(this.simple_token))});token_expr_run=this.RULED("token_expr_run",()=>{this.CONSUME(Ime),this.SUBRULE(this.string_token)});token_expr_runwith=this.RULED("token_expr_runwith",()=>{this.CONSUME(Nme),this.SUBRULE(this.simple_token),this.SUBRULE(this.string_token)});token_expr=this.RULED("token_expr",()=>{this.OR([{ALT:()=>this.CONSUME(gme)},{ALT:()=>this.CONSUME(_me)},{ALT:()=>this.SUBRULE(this.token_expr_any)},{ALT:()=>this.SUBRULE(this.token_expr_count)},{ALT:()=>this.SUBRULE(this.token_expr_blocked)},{ALT:()=>this.SUBRULE(this.token_expr_abs)},{ALT:()=>this.SUBRULE(this.token_expr_intceil)},{ALT:()=>this.SUBRULE(this.token_expr_intfloor)},{ALT:()=>this.SUBRULE(this.token_expr_intround)},{ALT:()=>this.SUBRULE(this.token_expr_clamp)},{ALT:()=>this.SUBRULE(this.token_expr_min)},{ALT:()=>this.SUBRULE(this.token_expr_max)},{ALT:()=>this.SUBRULE(this.token_expr_pick)},{ALT:()=>this.SUBRULE(this.token_expr_pickwith)},{ALT:()=>this.SUBRULE(this.token_expr_random)},{ALT:()=>this.SUBRULE(this.token_expr_randomwith)},{ALT:()=>this.SUBRULE(this.token_expr_run)},{ALT:()=>this.SUBRULE(this.token_expr_runwith)}])});string_token=this.RULED("string_token",()=>{this.OR([{ALT:()=>this.CONSUME(Eu)},{ALT:()=>this.CONSUME(q2)}])});simple_token=this.RULED("simple_token",()=>{this.OR([{ALT:()=>this.CONSUME(yL)},{ALT:()=>this.CONSUME(Eu)},{ALT:()=>this.CONSUME(q2)},{ALT:()=>this.SUBRULE(this.color)}])});token=this.RULED("token",()=>{this.OR([{ALT:()=>this.SUBRULE(this.category)},{ALT:()=>this.SUBRULE(this.collision)},{ALT:()=>this.SUBRULE(this.color)},{ALT:()=>this.SUBRULE(this.dir)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.command_ticker)},{ALT:()=>this.CONSUME(yw)},{ALT:()=>this.CONSUME(q2)},{ALT:()=>this.CONSUME(Eu)},{ALT:()=>this.CONSUME(yL)},{ALT:()=>this.CONSUME(Pme)},{ALT:()=>{this.CONSUME(bq),this.SUBRULE(this.expr),this.CONSUME(Sq)}}])})}const CT=new Utt;if(K8e){const n=CT.getGAstProductions(),e=$Ge(n);console.info(e)}const Btt=CT.getBaseCstVisitorConstructor();var ir=(n=>(n[n.PROGRAM=0]="PROGRAM",n[n.API=1]="API",n[n.LINE=2]="LINE",n[n.MARK=3]="MARK",n[n.GOTO=4]="GOTO",n[n.COUNT=5]="COUNT",n[n.TEXT=6]="TEXT",n[n.LABEL=7]="LABEL",n[n.HYPERLINK=8]="HYPERLINK",n[n.STAT=9]="STAT",n[n.MOVE=10]="MOVE",n[n.COMMAND=11]="COMMAND",n[n.LITERAL=12]="LITERAL",n[n.IF=13]="IF",n[n.IF_CHECK=14]="IF_CHECK",n[n.IF_BLOCK=15]="IF_BLOCK",n[n.ELSE_IF=16]="ELSE_IF",n[n.ELSE=17]="ELSE",n[n.WHILE=18]="WHILE",n[n.BREAK=19]="BREAK",n[n.CONTINUE=20]="CONTINUE",n[n.REPEAT=21]="REPEAT",n[n.WAITFOR=22]="WAITFOR",n[n.FOREACH=23]="FOREACH",n[n.OR=24]="OR",n[n.AND=25]="AND",n[n.NOT=26]="NOT",n[n.COMPARE=27]="COMPARE",n[n.COMPARE_ITEM=28]="COMPARE_ITEM",n[n.OPERATOR=29]="OPERATOR",n[n.OPERATOR_ITEM=30]="OPERATOR_ITEM",n[n.EXPR=31]="EXPR",n))(ir||{}),GS=(n=>(n[n.IS_EQ=0]="IS_EQ",n[n.IS_NOT_EQ=1]="IS_NOT_EQ",n[n.IS_LESS_THAN=2]="IS_LESS_THAN",n[n.IS_GREATER_THAN=3]="IS_GREATER_THAN",n[n.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",n[n.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",n))(GS||{}),uv=(n=>(n[n.EMPTY=0]="EMPTY",n[n.PLUS=1]="PLUS",n[n.MINUS=2]="MINUS",n[n.POWER=3]="POWER",n[n.MULTIPLY=4]="MULTIPLY",n[n.DIVIDE=5]="DIVIDE",n[n.MOD_DIVIDE=6]="MOD_DIVIDE",n[n.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",n[n.UNI_PLUS=8]="UNI_PLUS",n[n.UNI_MINUS=9]="UNI_MINUS",n))(uv||{}),MP=(n=>(n[n.NUMBER=0]="NUMBER",n[n.STRING=1]="STRING",n[n.TEMPLATE=2]="TEMPLATE",n))(MP||{});function zu(n,e){const[t]=n??[];return(t?.image??e).trimStart().replaceAll(/^"|"$/g,"")}class Ftt extends Btt{unique=0;constructor(){super(),Hv&&this.validateVisitor()}visit(e){if(ui(e)&&(e=e[0]),!!xe(e))return this[e.name](e.children,e.location)}createcodenode(e,t){return[{...t,...e,lineindex:0}]}createstringnode(e,t){return this.createcodenode(e,{type:12,literal:1,value:t})}createtemplatenode(e,t){return this.createcodenode(e,{type:12,literal:2,value:t})}createmarknode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:3,id:t,comment:r}))}creategotonode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:4,id:t,comment:r}))}createlinenode(e,t){return this.createcodenode(e,{type:2,stmts:t})}createapinode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:1,words:r,method:t}))}createlogicnode(e,t,r,i){return this.createlinenode(e,this.createcodenode(e,{type:14,skip:r,words:i,method:t}))}createcountnode(e){return this.createcodenode(e,{type:5,index:this.unique++})}createexprnodeondemand(e,t){return e.length===1?e[0]:this.createcodenode(t,{type:31,words:e})[0]}go(e){return Array.isArray(e)?e.map(t=>this.visit(t)).flat():xe(e)?[this.visit(e)].flat():[]}program(e,t){return this.unique=0,this.createcodenode(t,{type:0,lines:[this.createlinenode(t,this.createcodenode(t,{type:7,active:!0,name:"restart"})),this.go(e.line)].flat()})}line(e){return e.stmt?this.go(e.stmt):[]}stmt(e){return e.stmt_label?this.go(e.stmt_label):e.stmt_stat?this.go(e.stmt_stat):e.stmt_text?this.go(e.stmt_text):e.stmt_comment?this.go(e.stmt_comment):e.stmt_hyperlink?this.go(e.stmt_hyperlink):e.stmt_command?this.go(e.stmt_command):e.short_go?this.go(e.short_go):e.short_try?this.go(e.short_try):[]}inline_go(e){const t=[];return e.short_go&&t.push(...this.go(e.short_go)),e.inline&&t.push(...this.go(e.inline)),t}inline_try(e){const t=[];return e.short_try&&t.push(...this.go(e.short_try)),e.inline&&t.push(...this.go(e.inline)),t}inline_command(e){const t=[];return e.stmt_command&&t.push(...this.go(e.stmt_command)),e.inline&&t.push(...this.go(e.inline)),t}inline(e){const t=[];return e.stmt_stat&&t.push(...this.go(e.stmt_stat)),e.stmt_text&&t.push(...this.go(e.stmt_text)),e.stmt_comment&&t.push(...this.go(e.stmt_comment)),e.stmt_hyperlink&&t.push(...this.go(e.stmt_hyperlink)),e.inline_go&&t.push(...this.go(e.inline_go)),e.inline_try&&t.push(...this.go(e.inline_try)),e.inline_command&&t.push(...this.go(e.inline_command)),e.structured_cmd&&t.push(...this.go(e.structured_cmd)),t}stmt_label(e,t){return this.createlinenode(t,this.createcodenode(t,{type:7,active:!0,name:zu(e.token_label,":").slice(1).trim()}))}stmt_stat(e,t){return this.createlinenode(t,this.createcodenode(t,{type:9,value:zu(e.token_stat,"@").slice(1)}))}stmt_text(e,t){const r=zu(e.token_text,"");return this.createlinenode(t,this.createcodenode(t,{type:6,value:r}))}stmt_comment(e,t){return this.createlinenode(t,this.createcodenode(t,{type:7,active:!1,name:zu(e.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(e,t){return this.createlinenode(t,this.createcodenode(t,{type:8,link:zu(e.token_hyperlink,"!").slice(1),text:zu(e.token_hyperlinktext,";").slice(1)}))}stmt_command(e,t){return e.structured_cmd?this.go(e.structured_cmd):this.createlinenode(t,this.createcodenode(t,{type:11,words:this.go(e.words)}))}structured_cmd(e){return e.command_if?this.go(e.command_if):e.command_while?this.go(e.command_while):e.command_repeat?this.go(e.command_repeat):e.command_waitfor?this.go(e.command_waitfor):e.command_foreach?this.go(e.command_foreach):e.command_break?this.go(e.command_break):e.command_continue?this.go(e.command_continue):[]}short_go(e,t){return e.token_divide?this.createlinenode(t,this.createcodenode(t,{type:10,wait:!0,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}short_try(e,t){return e.token_query?this.createlinenode(t,this.createcodenode(t,{type:10,wait:!1,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}command_if(e,t){const[r]=this.createlogicnode(t,zu(e.token_if,"if").toLowerCase(),"",this.go(e.words)),[i]=this.go(e.command_if_block)??[];return this.createcodenode(t,{type:13,check:r,block:i})}command_if_block(e,t){const r=Sc(),i=Sc();return this.createcodenode(t,{type:15,skip:r,done:i,lines:[this.go(e.inline),this.go(e.line),this.creategotonode(t,i,"end of if"),this.createmarknode(t,r,"alt logic")].flat(),altlines:[this.go(e.command_else_if),this.go(e.command_else),this.createmarknode(t,i,"end of if")].flat()})}command_block(e){return[this.go(e.inline),this.go(e.line)].flat()}command_fork(e){return[this.go(e.inline),this.go(e.line)].flat()}command_else_if(e,t){const r=Sc(),i=Sc();return this.createcodenode(t,{type:16,done:i,lines:[this.createlogicnode(t,zu(e.token_if,"if"),r,this.go(e.words)),this.go(e.command_fork),this.creategotonode(t,i,"end of if"),this.createmarknode(t,r,"skip")].flat()})}command_else(e,t){const r=[];return e.words&&r.push(...this.createlinenode(t,this.createcodenode(t,{type:11,words:this.go(e.words)}))),e.command_fork&&r.push(...this.go(e.command_fork)),this.createcodenode(t,{type:17,lines:r})}command_while(e,t){const r=Sc(),i=Sc();return this.createcodenode(t,{type:18,loop:r,done:i,lines:[this.createmarknode(t,r,"start of while"),this.createlogicnode(t,"if",i,this.go(e.words)),this.go(e.command_block),this.creategotonode(t,r,"loop of while"),this.createmarknode(t,i,"end of while")].flat()})}command_repeat(e,t){const r=Sc(),i=Sc(),a=[this.createcountnode(t),this.go(e.words)].flat();return this.createcodenode(t,{type:21,loop:r,done:i,lines:[this.createapinode(t,"repeatstart",a),this.createmarknode(t,r,"start of repeat"),this.createlogicnode(t,"repeat",i,a),this.go(e.command_block),this.creategotonode(t,r,"loop of repeat"),this.createmarknode(t,i,"end of repeat")].flat()})}command_foreach(e,t){const r=Sc(),i=Sc(),a=[this.createcountnode(t),this.go(e.words)].flat();return this.createcodenode(t,{type:23,loop:r,done:i,lines:[this.createapinode(t,"foreachstart",a),this.createmarknode(t,r,"start of foreach"),this.createlogicnode(t,"foreach",i,a),this.go(e.command_block),this.creategotonode(t,r,"loop of foreach"),this.createmarknode(t,i,"end of foreach")].flat()})}command_waitfor(e,t){const r=Sc();return this.createcodenode(t,{type:22,loop:r,lines:[this.createmarknode(t,r,"start of waitfor"),this.createlogicnode(t,"waitfor",r,this.go(e.words))].flat()})}command_break(e,t){return this.createcodenode(t,{type:19,goto:0})}command_continue(e,t){return this.createcodenode(t,{type:20,goto:0})}command_play(e,t){const r=zu(e.token_command_play,"").trim(),[i,...s]=r.split(" ");return[this.createstringnode(t,i),this.createstringnode(t,s.join(" "))].flat()}command_toast(e,t){const i=zu(e.token_command_toast,"").replace("toast","").trim();return[this.createstringnode(t,"toast"),this.createtemplatenode(t,i)].flat()}command_ticker(e,t){const i=zu(e.token_command_ticker,"").replace("ticker","").trim();return[this.createstringnode(t,"ticker"),this.createtemplatenode(t,i)].flat()}expr(e,t){return e.RHS?this.createcodenode(t,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}and_test(e,t){return e.RHS?this.createcodenode(t,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}not_test(e,t){return e.comparison?this.go(e.comparison):e.LHS?this.createcodenode(t,{type:26,items:this.go(e.LHS)}):[]}comparison(e,t){if(e.RHS){const[r]=this.go(e.comp_op);return this.createcodenode(t,{type:27,compare:r,lhs:this.createexprnodeondemand(this.go(e.LHS),t),rhs:this.createexprnodeondemand(this.go(e.RHS),t)})}return this.go(e.LHS)}comp_op(e,t){return e.token_iseq?this.createcodenode(t,{type:28,method:0}):e.token_isnoteq?this.createcodenode(t,{type:28,method:1}):e.token_islessthan?this.createcodenode(t,{type:28,method:2}):e.token_isgreaterthan?this.createcodenode(t,{type:28,method:3}):e.token_islessthanorequal?this.createcodenode(t,{type:28,method:4}):e.token_isgreaterthanorequal?this.createcodenode(t,{type:28,method:5}):[]}expr_value(e,t){return e.RHS?this.createcodenode(t,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}and_test_value(e,t){return e.RHS?this.createcodenode(t,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}not_test_value(e,t){return e.arith_expr?this.go(e.arith_expr):e.LHS?this.createcodenode(t,{type:26,items:this.go(e.LHS)}):[]}arith_expr(e,t){if(e.LHS)return this.go(e.LHS);const r=this.go(e.term);return e.RHS?this.createcodenode(t,{type:29,lhs:r[0],items:this.go(e.RHS)}):r}arith_expr_item(e,t){return this.createcodenode(t,{type:30,operator:e.token_plus?1:2,rhs:this.go(e.term)[0]})}term(e,t){return e.term_item?this.createcodenode(t,{type:29,lhs:this.go(e.factor)[0],items:this.go(e.term_item)}):this.go(e.factor)}term_item(e,t){let r=0;return e.token_multiply&&(r=4),e.token_divide&&(r=5),e.token_moddivide&&(r=6),e.token_floordivide&&(r=7),this.createcodenode(t,{type:30,operator:r,rhs:this.go(e.factor)[0]})}factor(e,t){if(e.power)return this.go(e.power);let r=0;return e.token_plus&&(r=8),e.token_minus&&(r=9),this.createcodenode(t,{type:29,lhs:void 0,items:this.createcodenode(t,{type:30,operator:r,rhs:this.go(e.LHS)[0]})})}power(e,t){const r=this.go(e.token);return e.factor?this.createcodenode(t,{type:29,lhs:r[0],items:this.createcodenode(t,{type:30,operator:3,rhs:this.go(e.factor)[0]})}):r}words(e){return this.go(e.expr)}kind(e){return[this.go(e.color),this.go(e.string_token)].flat()}category(e,t){return e.token_isterrain?this.createcodenode(t,{type:12,literal:1,value:"isterrain"}):e.token_isobject?this.createcodenode(t,{type:12,literal:1,value:"isobject"}):[]}collision(e,t){return e.token_iswalkable?this.createcodenode(t,{type:12,literal:1,value:"iswalkable"}):e.token_iswalking?this.createcodenode(t,{type:12,literal:1,value:"iswalking"}):e.token_iswalk?this.createcodenode(t,{type:12,literal:1,value:"iswalk"}):e.token_isswimmable?this.createcodenode(t,{type:12,literal:1,value:"isswimmable"}):e.token_isswimming?this.createcodenode(t,{type:12,literal:1,value:"isswimming"}):e.token_isswim?this.createcodenode(t,{type:12,literal:1,value:"isswim"}):e.token_issolid?this.createcodenode(t,{type:12,literal:1,value:"issolid"}):e.token_isbullet?this.createcodenode(t,{type:12,literal:1,value:"isbullet"}):e.token_isghost?this.createcodenode(t,{type:12,literal:1,value:"isghost"}):[]}color(e,t){let r="ERROR";return e.token_black&&(r="black"),e.token_dkblue&&(r="dkblue"),e.token_dkgreen&&(r="dkgreen"),e.token_dkcyan&&(r="dkcyan"),e.token_dkred&&(r="dkred"),e.token_dkpurple&&(r="dkpurple"),e.token_dkyellow&&(r="dkyellow"),e.token_ltgray&&(r="ltgray"),e.token_dkgray&&(r="dkgray"),e.token_blue&&(r="blue"),e.token_green&&(r="green"),e.token_cyan&&(r="cyan"),e.token_red&&(r="red"),e.token_purple&&(r="purple"),e.token_yellow&&(r="yellow"),e.token_white&&(r="white"),e.token_brown&&(r="brown"),e.token_dkwhite&&(r="dkwhite"),e.token_ltgrey&&(r="ltgrey"),e.token_gray&&(r="gray"),e.token_grey&&(r="grey"),e.token_dkgrey&&(r="dkgrey"),e.token_ltblack&&(r="ltblack"),e.token_onblack&&(r="onblack"),e.token_ondkblue&&(r="ondkblue"),e.token_ondkgreen&&(r="ondkgreen"),e.token_ondkcyan&&(r="ondkcyan"),e.token_ondkred&&(r="ondkred"),e.token_ondkpurple&&(r="ondkpurple"),e.token_ondkyellow&&(r="ondkyellow"),e.token_onltgray&&(r="onltgray"),e.token_ondkgray&&(r="ondkgray"),e.token_onblue&&(r="onblue"),e.token_ongreen&&(r="ongreen"),e.token_oncyan&&(r="oncyan"),e.token_onred&&(r="onred"),e.token_onpurple&&(r="onpurple"),e.token_onyellow&&(r="onyellow"),e.token_onwhite&&(r="onwhite"),e.token_onbrown&&(r="onbrown"),e.token_ondkwhite&&(r="ondkwhite"),e.token_onltgrey&&(r="onltgrey"),e.token_ongray&&(r="ongray"),e.token_ongrey&&(r="ongrey"),e.token_ondkgrey&&(r="ondkgrey"),e.token_onltblack&&(r="onltblack"),e.token_onclear&&(r="onclear"),this.createcodenode(t,{type:12,literal:1,value:r})}dir_mod(e,t){if(e.dir_within)return this.go(e.dir_within);if(e.dir_awayby)return this.go(e.dir_awayby);let r="ERROR";return e.token_cw&&(r="cw"),e.token_ccw&&(r="ccw"),e.token_opp&&(r="opp"),e.token_rndp&&(r="rndp"),e.token_over&&(r="over"),e.token_under&&(r="under"),this.createcodenode(t,{type:12,literal:1,value:r})}dir_by(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"by"}),...this.go(e.simple_token)]}dir_at(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"at"}),...this.go(e.simple_token)]}dir_away(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"away"}),...this.go(e.simple_token)]}dir_toward(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"toward"}),...this.go(e.simple_token)]}dir_find(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"find"}),...this.go(e.kind)]}dir_flee(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"flee"}),...this.go(e.kind)]}dir_to(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"to"}),...this.go(e.dir)]}dir_within(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"within"}),...this.go(e.simple_token)]}dir_awayby(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"awayby"}),...this.go(e.simple_token)]}dir(e,t){const r=this.go(e.dir_mod)??[];return e.token_i&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"i"})),e.token_idle&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"idle"})),e.token_n&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"n"})),e.token_u&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"u"})),e.token_north&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"north"})),e.token_up&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"up"})),e.token_s&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"s"})),e.token_d&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"d"})),e.token_south&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"south"})),e.token_down&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"down"})),e.token_w&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"w"})),e.token_l&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"l"})),e.token_west&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"west"})),e.token_left&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"left"})),e.token_e&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"e"})),e.token_r&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"r"})),e.token_east&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"east"})),e.token_right&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"right"})),e.token_rnd&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rnd"})),e.token_rndne&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rndne"})),e.token_rndns&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rndns"})),e.token_flow&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"flow"})),e.token_seek&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"seek"})),e.dir_by&&r.push(...this.go(e.dir_by)),e.dir_at&&r.push(...this.go(e.dir_at)),e.dir_away&&r.push(...this.go(e.dir_away)),e.dir_toward&&r.push(...this.go(e.dir_toward)),e.dir_find&&r.push(...this.go(e.dir_find)),e.dir_flee&&r.push(...this.go(e.dir_flee)),e.dir_to&&r.push(...this.go(e.dir_to)),r.flat()}expr_any(e){return[this.go(e.dir),this.go(e.kind),this.go(e.color)].flat()}token_expr_any(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"any"}),this.go(e.expr_any)].flat()}token_expr_count(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"countof"}),this.go(e.expr_any)].flat()}token_expr_blocked(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"blocked"}),this.go(e.dir)].flat()}token_expr_abs(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"abs"}),...this.go(e.simple_token)]}token_expr_intceil(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intceil"}),...this.go(e.simple_token)]}token_expr_intfloor(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intfloor"}),...this.go(e.simple_token)]}token_expr_intround(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intround"}),...this.go(e.simple_token)]}token_expr_clamp(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"clamp"}),...this.go(e.simple_token)]}token_expr_min(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"min"}),...this.go(e.simple_token)]}token_expr_max(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"max"}),...this.go(e.simple_token)]}token_expr_pick(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"pick"}),...this.go(e.simple_token)]}token_expr_pickwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"pickwith"}),...this.go(e.simple_token)]}token_expr_random(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"random"}),...this.go(e.simple_token)]}token_expr_randomwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"randomwith"}),...this.go(e.simple_token)]}token_expr_run(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"run"}),...this.go(e.string_token)]}token_expr_runwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"runwith"}),...this.go(e.simple_token),...this.go(e.string_token)]}token_expr(e,t){return e.token_expr_aligned?this.createcodenode(t,{type:12,literal:1,value:"aligned"}):e.token_contact?this.createcodenode(t,{type:12,literal:1,value:"contact"}):e.token_expr_any?this.go(e.token_expr_any):e.token_expr_count?this.go(e.token_expr_count):e.token_expr_blocked?this.go(e.token_expr_blocked):e.token_expr_abs?this.go(e.token_expr_abs):e.token_expr_intceil?this.go(e.token_expr_intceil):e.token_expr_intfloor?this.go(e.token_expr_intfloor):e.token_expr_intround?this.go(e.token_expr_intround):e.token_expr_clamp?this.go(e.token_expr_clamp):e.token_expr_min?this.go(e.token_expr_min):e.token_expr_max?this.go(e.token_expr_max):e.token_expr_pick?this.go(e.token_expr_pick):e.token_expr_pickwith?this.go(e.token_expr_pickwith):e.token_expr_random?this.go(e.token_expr_random):e.token_expr_randomwith?this.go(e.token_expr_randomwith):e.token_expr_run?this.go(e.token_expr_run):e.token_expr_runwith?this.go(e.token_expr_runwith):[]}string_token(e,t){if(e.token_stringliteraldouble){const r=zu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=zu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}return[]}simple_token(e,t){if(e.token_stringliteraldouble){const r=zu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=zu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_numberliteral){const r=parseFloat(zu(e.token_numberliteral,"0"));return this.createcodenode(t,{type:12,literal:0,value:r})}return e.color?this.go(e.color):[]}token(e,t){if(e.category)return this.go(e.category);if(e.collision)return this.go(e.collision);if(e.color)return this.go(e.color);if(e.dir)return this.go(e.dir);if(e.command_play)return this.go(e.command_play);if(e.command_toast)return this.go(e.command_toast);if(e.command_ticker)return this.go(e.command_ticker);if(e.token_label){const r=zu(e.token_label,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_stringliteraldouble){const r=zu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=zu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_numberliteral){const r=parseFloat(zu(e.token_numberliteral,"0"));return this.createcodenode(t,{type:12,literal:0,value:r})}if(e.token_lparen)return[this.createexprnodeondemand(this.go(e.expr),t)];if(e.token_stop){const r=zu(e.token_stop,"");return this.createcodenode(t,{type:12,literal:1,value:r})}return[]}}const ztt=new Ftt,Mm={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},r6="zss.js";function Sa(n,e){return new Dtt.SourceNode(n.startLine??1,n.startColumn??1,r6,e)}function sz(n){return n.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function TN(n){return`'${sz(n)}'`}function mF(n){const e=Hk(n);return e.errors.length?n:`['${e.tokens.map(r=>{if(r.tokenType===qU){const i=sz(r.image.substring(1));return Vr(i)==="center"?"$CENTER":`', api.get('${i}'), '`}return sz(r.image)}).join("")}'].join('')`}function VM(n){return n.filter(e=>e!==void 0).map(Ka)}function qne(n){return Sa(n,"")}function jtt(n,e){const t=[];return n.forEach(r=>{t.push(r,e)}),t.pop(),t}function Vf(n,e,t){return Sa(n,[`api.${e}(`,...jtt(t,", "),")"])}function Htt(n){if(n.type===ir.COMPARE&&n.compare.type===ir.COMPARE_ITEM)switch(n.compare.method){case GS.IS_EQ:return Vf(n,"isEq",[Ka(n.lhs),Ka(n.rhs)]);case GS.IS_NOT_EQ:return Vf(n,"isNotEq",[Ka(n.lhs),Ka(n.rhs)]);case GS.IS_LESS_THAN:return Vf(n,"isLessThan",[Ka(n.lhs),Ka(n.rhs)]);case GS.IS_GREATER_THAN:return Vf(n,"isGreaterThan",[Ka(n.lhs),Ka(n.rhs)]);case GS.IS_LESS_THAN_OR_EQ:return Vf(n,"isLessThanOrEq",[Ka(n.lhs),Ka(n.rhs)]);case GS.IS_GREATER_THAN_OR_EQ:return Vf(n,"isGreaterThanOrEq",[Ka(n.lhs),Ka(n.rhs)])}return Sa(n,"")}function CS(n,e,t){return n.prepend(`api.${e}(`),n.add([", ",Ka(t),")"])}function Vne(n,e,t){return n.prepend(`api.${e}(`),n.add([Ka(t),")"])}function qtt(n,e){if(n.type===ir.OPERATOR_ITEM)switch(n.operator){case uv.PLUS:return CS(e,"opPlus",n.rhs);case uv.MINUS:return CS(e,"opMinus",n.rhs);case uv.POWER:return CS(e,"opPower",n.rhs);case uv.MULTIPLY:return CS(e,"opMultiply",n.rhs);case uv.DIVIDE:return CS(e,"opDivide",n.rhs);case uv.MOD_DIVIDE:return CS(e,"opModDivide",n.rhs);case uv.FLOOR_DIVIDE:return CS(e,"opFloorDivide",n.rhs);case uv.UNI_PLUS:return Vne(e,"opUniPlus",n.rhs);case uv.UNI_MINUS:return Vne(e,"opUniMinus",n.rhs)}return Sa(n,"")}function Vtt(n){if(n.type===ir.OPERATOR){const e=n.lhs?Ka(n.lhs):Sa(n,"");return n.items.forEach(t=>qtt(t,e)),e}return Sa(n,"")}function wN(n,e){return Sa(n,[Vf(n,"jump",[`${e}`]),"; continue;"])}function Cy(n){return Mm.linelookup[n??""]??-1}function az(n,e){Mm.linelookup[n]=e}function mT(n,e,t){for(let r=0;r<n.length;++r){const i=n[r];switch(i.type){case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.ELSE_IF:i.type===e&&(i.done=t);break;case ir.IF_BLOCK:case ir.IF_CHECK:i.type===e&&(i.skip=t);break;case ir.LINE:mT(i.stmts,e,t);break}}}function R0e(n,e,t){for(let r=0;r<n.length;++r){const i=n[r];switch(i.type){case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.ELSE_IF:i.type===e&&az(i.done,t);break;case ir.IF_BLOCK:case ir.IF_CHECK:i.type===e&&az(i.skip,t);break;case ir.LINE:R0e(i.stmts,e,t);break}}}function Ka(n){switch(n.type){case ir.PROGRAM:return Sa(n,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { return 1; }
`,`switch (api.getcase()) {
`,...n.lines.map(Ka).flat(),`default:
`,`  return 0;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${r6}`]);case ir.API:return Sa(n,["  ",Vf(n,n.method,VM(n.words)),`;
`]);case ir.LINE:return Sa(n,[`case ${n.lineindex}:
`,...n.stmts.map(Ka).flat(),`  break;
`]);case ir.MARK:return Sa(n,`  // ${n.comment}
`);case ir.GOTO:{const e=Cy(n.id);return Sa(n,["  ",wN(n,e),`
`])}case ir.COUNT:return Sa(n,`${n.index}`);case ir.LITERAL:switch(n.literal){case MP.NUMBER:return Sa(n,`${n.value}`);case MP.STRING:return Sa(n,TN(n.value));case MP.TEMPLATE:return Sa(n,mF(n.value))}return qne(n);case ir.TEXT:return Sa(n,["  ",Vf(n,"text",[mF(n.value)]),`;
`]);case ir.STAT:if(Mm.isfirststat){Mm.isfirststat=!1;const e=n.value.trim().split(" ").map(TN);return Sa(n,["  ",Vf(n,"stat",e),`;
`])}return Sa(n,`  // skipped ${n.value}
`);case ir.LABEL:{const e=Vr(n.name),t=n.active?"label":"comment";Mm.labels[e]||(Mm.labels[e]=[]);const r=(n.active?1:-1)*n.lineindex;return Mm.labels[e].push(r),Sa(n,`  // ${r} '${e}' ${t}
`)}case ir.HYPERLINK:return Sa(n,["  ",Vf(n,"hyperlink",[mF(n.text),...n.link.split(" ").filter(e=>e.length>0).map(TN)]),`;
`]);case ir.MOVE:{const e=Vf(n,"command",[TN("go"),VM(n.words)].flat());return n.wait?Sa(n,["  if (",e,`) { continue; };
`]):Sa(n,["  ",e,`;
`])}case ir.COMMAND:return Sa(n,["  if (",Vf(n,"command",VM(n.words)),`) { continue; };
`]);case ir.IF:{const e=n.block?.type===ir.IF_BLOCK?n.block:void 0;if(xe(e)){mT([n.check],ir.IF_CHECK,e.skip);const t=Sa(n,Ka(n.check));return e.lines.forEach(r=>t.add(Ka(r))),R0e(e.altlines,ir.ELSE_IF,Cy(e.done)),e.altlines.forEach(r=>t.add(Ka(r))),t}return Sa(n,Ka(n.check))}case ir.IF_CHECK:{const e=Cy(n.skip);return e===-1?Sa(n,["  ",Vf(n,n.method,VM(n.words)),`;
`]):Sa(n,["  if (!",Vf(n,n.method,VM(n.words)),") { ",wN(n,e),` }
`])}case ir.ELSE_IF:case ir.ELSE:{const e=Sa(n,"");return n.lines.forEach(t=>e.add(Ka(t))),e}case ir.WHILE:{const e=Cy(n.loop),t=Cy(n.done),r=Sa(n,"");return mT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Ka(i))}),r}case ir.REPEAT:{const e=Cy(n.loop),t=Cy(n.done),r=Sa(n,"");return mT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Ka(i))}),r}case ir.WAITFOR:{const e=Sa(n,"");return mT(n.lines,ir.IF_CHECK,n.loop),n.lines.forEach(t=>{e.add(Ka(t))}),e}case ir.FOREACH:{const e=Cy(n.loop),t=Cy(n.done),r=Sa(n,"");return mT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Ka(i))}),r}case ir.BREAK:return Sa(n,["  ",wN(n,n.goto),`
`]);case ir.CONTINUE:return Sa(n,["  ",wN(n,n.goto),`
`]);case ir.OR:return Vf(n,"or",n.items.map(Ka));case ir.AND:return Vf(n,"and",n.items.map(Ka));case ir.NOT:return Vf(n,"not",n.items.map(Ka));case ir.COMPARE:return Htt(n);case ir.OPERATOR:return Vtt(n);case ir.EXPR:return Vf(n,"expr",n.words.map(Ka));default:return console.error("<unsupported node>",n.type,n),qne(n)}}function fv(n){if(xe(n))switch(n.type===ir.LINE&&++Mm.lineindex,n.lineindex=Mm.lineindex,n.type){case ir.PROGRAM:n.lines.forEach(fv);break;case ir.LINE:n.stmts.forEach(fv);break;case ir.MARK:az(n.id,n.lineindex);break;case ir.IF:fv(n.check),fv(n.block);break;case ir.IF_BLOCK:n.lines.forEach(fv),n.altlines.forEach(fv);break;case ir.ELSE_IF:n.lines.forEach(fv);break;case ir.ELSE:case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.WAITFOR:n.lines.forEach(fv);break;case ir.MOVE:case ir.COMMAND:case ir.IF_CHECK:n.words.forEach(fv);break}}function A0e(n){Mm.labels={},Mm.internal=1,Mm.lineindex=0,Mm.isfirststat=!0,fv(n)}function Gtt(n){return A0e(n),{...Ka(n).toStringWithSourceMap({file:`${r6}.map`}),...Mm}}function Gne(n){return ui(n)?n.length>0?1:0:n??0}function $tt(n){return`${n}_chip`}function C0e(n=""){return`vm:${n??""}`}function Wtt(n,e,t){const r=$tt(n),i=E1(r);let s;const a=El(Object.entries(t.labels??{}));(!ui(i.lb)||i.lb.length!==a.length)&&(i.lb=a,i.lk="",i.mg=void 0,i.ec=1,i.lc=0,i.ys=0,i.ps=0,i.es=(t.errors?.length??0)!==0?1:0);function o(c,u){Ce.words=u;const f=zet(e,c);return xe(f)?f(l,u):c!=="send"?o("shortsend",[c,...u]):0}const l={halt(){ent(r)},id(){return n},set(c,u){const[f,h]=Het(e,l,c,u);if(f)return h},get(c){const[u,f]=jet(e,l,c);if(u)return f},tick(c){const u=Mn(i.ps)?i.ps:0,f=u%c===0;if(i.ps=u+1,f===!1)return!1;qet(e,l);const h=l.shouldtick();if(h){i.lc=0,i.ys=0,Ce.get=l.get;try{s?.(l)||(i.es=1)}catch(g){xi(St,Ce.elementfocus,"crash",g.message),i.es=1}}return Vet(e,l),h},isended(){return i.es===1},isfirstpulse(){return i.ps===1},shouldtick(){return i.es===0||l.hm()!==0},shouldhalt(){return Mn(i.lc)?++i.lc>Gn.HALT_AT_COUNT:!0},haslabel(c){if(ui(i.lb))for(let u=0;u<i.lb.length;++u){const[f,h]=i.lb[u];if(f===c)return(h.find(p=>Mn(p)&&p>0)??0)>0}return!1},hm(){if(ui(i.mg)&&ui(i.lb)){const[c]=i.mg;if(xe(c))for(let u=0;u<i.lb.length;++u){const[f,h]=i.lb[u];if(f===c)return h.find(g=>Mn(g)&&g>0)??0}}return 0},yield(){i.ys=1},jump(c){i.ec=c},sy(){return!!i.ys||l.shouldhalt()},send(c,u,f,h){St.emit(c,`${C0e(u)}:${f}`,h)},lock(c){i.lk=c},unlock(){i.lk=""},message(c){i.lk&&c.sender!==i.lk||l.haslabel(c.target)&&(i.mg=[c.target,c.data,c.sender,c.player])},zap(c){if(ui(i.lb))for(let u=0;u<i.lb.length;++u){const f=i.lb[u];if(f[0]===c){const h=f[1].findIndex(g=>g>0);if(h>=0&&xe(f[1])){f[1][h]*=-1;break}}}},restore(c){if(ui(i.lb))for(let u=0;u<i.lb.length;++u){const f=i.lb[u];if(f[0]===c)for(let h=0;h<f[1].length;h++)f[1][h]=Math.abs(f[1][h])}},getcase(){i.ec=Mn(i.ec)?i.ec:1;const c=l.hm();if(c&&ui(i.mg)){const[,u,f,h]=i.mg;l.set("senderid",f),xe(u)&&l.set("arg",u),h&&(l.set("player",h),Ce.elementfocus=h),i.mg=void 0,i.ys=0,i.es=0,i.ec=c}return i.ec},nextcase(){const c=Mn(i.ec)?i.ec:1;return i.ec=c+1,i.ec},endofprogram(){l.yield(),i.es=1},stacktrace(c){const u=X8e.parse(c),[f]=u.filter(h=>h.fileName===r6);return{line:f?.lineNumber??0,column:f?.columnNumber??0}},text(c){return o("text",[c])},stat(...c){return o("stat",c)},hyperlink(...c){return o("hyperlink",c)},command(...c){if(c.length===0)return 0;const[u,...f]=c;return o(Vr(jc(u)),f)},if(...c){const[u,f]=ln(c,0,[Pt.ANY]),h=Gne(u);return h&&f<c.length&&l.command(...c.slice(f)),h?1:0},try(...c){const[,u]=ln(c,0,[Pt.DIR]),f=l.command("go",...c);return f&&u<c.length&&l.command(...c.slice(u)),f?1:0},take(...c){const[u,f,h]=ln(c,0,[Pt.NAME,Pt.ANY]),g=Mn(f),p=g?h:1,_=l.get(u),y=g?f:1;if(!Mn(_))return p<c.length&&l.command(...c.slice(p)),1;const v=_-y;return v<0?(p<c.length&&l.command(...c.slice(p)),1):(l.set(u,v),0)},give(...c){const[u,f,h]=ln(c,0,[Pt.NAME,Pt.ANY]),g=Mn(f),p=g?h:1,_=l.get(u),y=g?f:1,v=_===void 0?1:0;return v&&p<c.length&&l.command(...c.slice(p)),l.set(u,vd(_,0)+y),v},duplicate(...c){return l.command("duplicate",...c)},repeatstart(c,...u){const[f,h]=ln(u,0,[Pt.NUMBER]),g=`repeatcount${c}`,p=`repeatwords${c}`;i[g]=f,i[p]=h<u.length?u.slice(h):void 0},repeat(c){const u=`repeatcount${c}`,f=`repeatwords${c}`;if(!Mn(i[u]))return 0;const h=i[u];i[u]=h-1;const g=h>0,p=i[f];return g&&ui(p)&&l.command(...p),g?1:0},foreachstart(c,...u){const[f,h,g,p]=ln(u,0,[Pt.NAME,Pt.NUMBER,Pt.NUMBER,Pt.MAYBE_NUMBER]);let _=Math.min(h,g),y=Math.max(h,g);const v=(p??0)||1;if(v<0){const x=_;_=y,y=x}return l.set(f,_-v),0},foreach(c,...u){const[f,h,g,p,_]=ln(u,0,[Pt.NAME,Pt.NUMBER,Pt.NUMBER,Pt.MAYBE_NUMBER]);let y=Math.min(h,g),v=Math.max(h,g);const x=(p??0)||1;if(x<0){const k=y;y=v,v=k}let E=l.get(f);!Mn(E)||E<y||E>v?E=y:E+=x;const M=E<=v?1:0;return M&&(l.set(f,E),_<u.length&&l.command(...u.slice(_))),M},waitfor(...c){const[u]=ln(c,0,[Pt.ANY]),f=Gne(u);return f||l.yield(),f?1:0},or(...c){let u=0;for(let f=0;f<c.length;){const[h,g]=ln(c,f,[Pt.ANY]);if(u=h,u)break;f=g}return u},and(...c){let u=0;for(let f=0;f<c.length;){const[h,g]=ln(c,f,[Pt.ANY]);if(u=h,!u)break;f=g}return u},not(...c){const[u]=ln(c,0,[Pt.ANY]);return u?0:1},expr(...c){const[u]=ln(c,0,[Pt.ANY]);return u},isEq(c,u){const[f]=ln([c],0,[Pt.ANY]),[h]=ln([u],0,[Pt.ANY]);return typeof f=="object"||typeof h=="object"?i1(f,h)?1:0:f===h?1:0},isNotEq(c,u){return this.isEq(c,u)?0:1},isLessThan(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f<h?1:0},isGreaterThan(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f>h?1:0},isLessThanOrEq(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f<=h?1:0},isGreaterThanOrEq(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f>=h?1:0},opPlus(c,u){const[f]=ln([c],0,[Pt.ANY]),[h]=ln([u],0,[Pt.ANY]);return f+h},opMinus(c,u){const[f]=ln([c],0,[Pt.ANY]),[h]=ln([u],0,[Pt.ANY]);return f-h},opPower(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return Math.pow(f,h)},opMultiply(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f*h},opDivide(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f/h},opModDivide(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return f%h},opFloorDivide(c,u){const[f]=ln([c],0,[Pt.NUMBER]),[h]=ln([u],0,[Pt.NUMBER]);return Math.floor(f/h)},opUniPlus(c){const[u]=ln([c],0,[Pt.NUMBER]);return+u},opUniMinus(c){const[u]=ln([c],0,[Pt.NUMBER]);return-u}};return s=t.code,l}function oz(n){if(!n||n.type===void 0)return;const e=[{start:n.startOffset,end:n.endOffset??0}];return Object.keys(n).forEach(t=>{if(t!=="parent"){const r=n[t];ui(r)?r.forEach(i=>{e.push(oz(i))}):e.push(oz(r))}}),n.range={start:Math.min(...e.filter(t=>t).map(t=>t?.start??0)),end:Math.max(...e.filter(t=>t).map(t=>t?.end??0))},n.range}function M0e(n){const e=Fme(`${n}
`);if(e.errors.length>0)return e;CT.input=e.tokens;const t=CT.program();if(CT.errors.length>0)return{tokens:e.tokens,errors:CT.errors.map(i=>({offset:i.token.startOffset,line:i.token.startLine,column:i.token.startColumn,length:i.token.image.length,message:i.message}))};const[r]=ztt.go(t);return r?(oz(r),{tokens:e.tokens,cst:t,ast:r}):{tokens:e.tokens,cst:t,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}function Ytt(n,e){const t=`compile-${n}`;console.time(t);const r=M0e(e);if(console.timeEnd(t),sQ&&console.info(e,r.errors),r.errors&&r.errors.length>0)return console.info(e,r.tokens,r.errors),r;if(!r.ast)return{...r,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const i=Gtt(r.ast);if(i.code){sQ&&console.info(i.code);try{return{...r,...i,source:i.code,code:new Function("api",i.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new Function("api"," ")}}}return{...r,...i,source:"",code:new Function("api"," ")}}function Xtt(){const n={},e={};function t(i,s){const a=n[s];if(a)return a;const o=Ytt(i,s);return n[s]=o,o}const r={ids(){return Object.keys(e)},isended(i){const s=e[i];return xe(s)?s.isended():!0},halt(i){const s=e[i];return xe(s)&&(s.halt(),delete e[i]),!!s},gc(){const i=r.ids();for(let s=0;s<i.length;++s)r.isended(i[s])&&r.halt(i[s])},arg(i,s){const a=e[i];xe(a)&&a.set("arg",s)},tick(i,s,a,o,l){let c=e[i];if(!xe(e[i])){const u=t(o,l);if(c=e[i]=Wtt(i,s,u),u.errors?.length){const[f]=u.errors,h=(f?.line??2)-1,g=l.replaceAll(`\r
`,"").split(`
`).map((E,M)=>[E,M]),p=g.slice(h-2,h);for(let E=0;E<p.length;++E){const[M,k]=p[E];xi(St,MT(),"build",`$grey${k+1} $grey${M}`)}const[_,y]=g[h]??[];if(Vn(_)&&xe(y)){const E=(f.column??1)-1,M=E+f.length,k=E<_.length?_:`${_}*`,N=k.substring(0,E),I=k.substring(E,M),D=k.substring(M);xi(St,MT(),"build",`$red${y+1} $grey${N}$red${I}$grey${D}`)}const v=g.slice(h+1,h+3);for(let E=0;E<v.length;++E){const[M,k]=v[E];xi(St,MT(),"build",`$grey${k+1} $grey${M}`)}const x=f.message.split(`
`).slice(0,4).join(" ");return xi(St,MT(),"build",x),!1}}return!!c?.tick(a)},once(i,s,a,o){const l=r.tick(i,s,1,a,o);return r.halt(i)&&l},message(i){const{target:s,path:a}=AE(i.target),o=e[s];if(xe(o)){const l={...i,target:a};o.message(l)}}};return r}new an;const iV=Xtt();var x0=(n=>(n.MAIN="main",n.TITLE="title",n.PLAYER="player",n.GADGETSTORE="gadgetstore",n))(x0||{});const J0={session:Sc(),operator:"",software:{main:"",content:""},books:new Map};function MT(){return J0.operator}function By(){return[...J0.books.values()]}function Ktt(){const[n]=J0.books.values();return n}function Vy(n){const e=Vr(n);return J0.books.get(n)??By().find(t=>t.name===e)}function O0e(n,e){xe(Vy(e))&&(J0.software[n]=e)}function Mv(n){return Vy(J0.software[n])}function k0e(n){const e=Hme([]);return Vn(n)&&(e.name=n),I0e(e),Ts(St,J0.operator,`created [book] ${e.name}`),e}function Ztt(n){let e=Vy(n);return xe(e)||(e=Hme([]),e.name=n),I0e(e),Ts(St,J0.operator,`created [book] ${e.name}`),e}function S1(n,e){let t=xe(e)?Ztt(e):Mv(n);return xe(t)||(xe(t)||(t=Ktt()),xe(t)||(t=k0e(e)),xe(t)&&Ts(St,J0.operator,`opened [book] ${t.name} for ${n}`)),O0e(n,t.id),t}function Jtt(n,e,t){return j9(S1(n),t,e)}function k_(n,e){const t=Mv("main"),r=A0(H9(t,n,e));if(xe(r))return r;const i=By();for(let s=0;s<i.length;++s){const a=i[s];if(a.id!==t?.id){const o=A0(H9(a,n,e));if(xe(o))return o}}}function U1(n){if(xe(n?.kinddata))return n.kinddata;if(!Vn(n?.kind)||!n.kind)return;const e=k_(ri.OBJECT,n.kind);if(xe(e))return n.kinddata=Qf(e),n.kinddata;const t=k_(ri.TERRAIN,n.kind);if(xe(t))return n.kinddata=Qf(t),n.kinddata}function ji(n,e){const t=n?.kinddata,r=t?.id??"",i=n?.[e];if(xe(i))return i;const s=t?.[e];if(xe(s))return s;const a=k_(ri.OBJECT,r)??k_(ri.TERRAIN,r),o=JGe(a,e);if(xe(o))return o;switch(e){case"group":return"";case"cycle":return B8e;case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"item":case"pushable":case"breakable":return 0;case"collision":return wr.ISWALK;default:return}}function lz(n,e){const t={x:n?.x??-1,y:n?.y??-1},r={x:e?.x??-1,y:e?.y??-1},i=mv(t,r),s=ji(e,"pushable");return Mn(s)?s!==0:Vn(s)?s.trim().split(" ").map(a=>Ofe(hU(a))).some(a=>a===i):!1}function F0(n,e,t,r){if(!xe(n)||!xe(e))return;const[i,s]=e,a=k_(ri.OBJECT,i);if(xe(a)){const l=Yme(n,t,i,r);if(xe(l))return PO(l,s),U1(l),ji(l,"collision")!==wr.ISGHOST&&(Wme(n,l),G9(n,l)),l}const o=k_(ri.TERRAIN,i);if(xe(o)){const l=l$e(n,t,i);if(xe(l)){PO(l,s),U1(l);const c=_f(t,$n);return G9(n,l,c),l}}}function Qtt(n,e,t){if(!xe(n)||!xe(e))return;const[r,i]=e,s=k_(ri.OBJECT,r);if(xe(s)){const a=Yme(n,t,r);return PO(a,i),a}}function Np(n){const e=k_(ri.BOARD,n);return Qf(e)}function E1(n){const e=S1("main");return NU(e,n)}function $ne(){const n=S1("main");return NU(n,"main")}function ent(n){const e=S1("main");return t$e(e,n)}function I0e(n){return J0.books.set(n.id,n),n.id}function tnt(n){const e=Vy(n);e&&J0.books.delete(e.id)}function nnt(n){const e=Mv("main"),t=RL(e,n,"board"),r=k_(ri.BOARD,t);return Qf(r)}function Hu(n,e,t,r){if(Vn(t.id))if(Vn(e.id))rX(St,n,e.id,t.id,r);else{const i=`${_f({x:e.x??0,y:e.y??0},$n)}`;rX(St,n,i,t.id,r)}}function rnt(n,e,t,r){const i=t.id??"";if(r.x<0){const s=Np(e?.exitwest??"");xe(s)&&AT(n,i,s.id,{x:$n-1,y:r.y})}else if(r.x>=$n){const s=Np(e?.exiteast??"");xe(s)&&AT(n,i,s.id,{x:0,y:r.y})}else if(r.y<0){const s=Np(e?.exitnorth??"");xe(s)&&AT(n,i,s.id,{x:r.x,y:mi-1})}else if(r.y>=mi){const s=Np(e?.exitsouth??"");xe(s)&&AT(n,i,s.id,{x:r.x,y:0})}}function Wne(n,e,t,r){const i=RL(n,r,"enterx"),s=RL(n,r,"entery");Mn(i)&&Mn(s)&&xe(t)&&$9(e,t,{x:i,y:s})}function kg(n,e,t,r,i={}){if(!xe(t?.id))return!1;let s=$9(e,t,r);const a=ji(t,"collision");if(xe(s)&&a!==wr.ISBULLET){const o=R0(t?.id),l=!!ji(s,"item"),c=lz(t,s),u=s.id??"";if(c&&(!o||!l)&&!i[u]){i[u]=!0;const f=mv({x:t.x??0,y:t.y??0},r),h=hu({x:s.x??0,y:s.y??0},f);kg(n,e,s,h)}s=$9(e,t,r)}if(xe(s)){const o=R0(t.id),l=R0(t.party??t.id),c=ji(t,"collision")===wr.ISBULLET,u=t.kind??"";let f="";t.party&&l&&(f=t.party),o&&(f=t.id);const h=R0(s.id),g=R0(s.party??s.id),p=ji(s,"collision")===wr.ISBULLET,_=s.kind??"",y=l===g;let v="";if(s.party&&g&&(v=s.party),h&&(v=s.id??""),o&&_==="edge")rnt(n,e,t,r);else if(o)h?(Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,"bump")):p?(e?.restartonzap&&Wne(n,e,t,f),Hu(y?"":v,s,t,y?"partyshot":"shot"),Hu(f,t,s,"thud")):(Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,"touch"));else if(c)if(h)e?.restartonzap&&Wne(n,e,s,v),Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,y?"partyshot":"shot");else if(p)Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,"thud");else switch(Hu(y?"":v,s,t,"thud"),_){case"object":case"scroll":Hu(y?"":f,t,s,"shot");break;default:Hu(y?"":f,t,s,y?"partyshot":"shot");break}else if(h)Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,"bump");else if(p){switch(u){case"object":case"scroll":Hu(y?"":f,t,s,"shot");break;default:Hu(y?"":f,t,s,y?"partyshot":"shot");break}Hu(y?"":f,t,s,"thud")}else Hu(y?"":v,s,t,"thud"),Hu(y?"":f,t,s,"bump");if(c&&ji(s,"breakable"))if(xe(s?.id)){const x=Lo(e,{x:s.x??-1,y:s.y??-1});xe(x)&&zg(Ce.board,x,Ce.timestamp)}else Ed(e,{x:r.x,y:r.y});return!1}return!0}function snt(n,e,t,r){if(!xe(n)||!xe(e)||!xe(t))return;const i={...Ce};Ce.book=n,Ce.board=e,Ce.element=t,Ce.elementid=t.id??"",Ce.elementisplayer=R0(Ce.elementid);const s=Ce.element.player??J0.operator;Ce.elementfocus=Ce.elementisplayer?Ce.elementid:s;const a=ji(t,"cycle"),o=t.id??"",l=Vr(t.name??t.kinddata?.name??"");if(iV.tick(o,eV.RUNTIME,a,l,r),Mn(t?.tickertime)&&Ce.timestamp-t.tickertime>uU*5&&(t.tickertime=0,t.tickertext=""),Ce.elementisplayer){const c=E1(Ce.elementid);Mn(c.inputcurrent)&&(c.inputcurrent=0)}ub(i).forEach(c=>{Ce[c]=i[c]})}function ant(n){iV.halt(n)}function FL(n,e,t,r){const i=Mv("main");if(!xe(i))return;function s(a){for(let o=0;o<a.length;++o){const l=a[o];if(xe(l.id)){const c=`${C0e(l.id)}:${e}`;St.emit("",c,t)}}}if(b1(n)){for(let a=0;a<r.length;++a){const o=r[a],l=Lo(o,n);xe(l)&&s([l])}return}for(let a=0;a<r.length;++a){const o=r[a];switch(Vr(n)){case"all":case"self":case"others":{s(Object.values(o.objects));break}default:{s(Gme(o,[n]));break}}}}function zL(n){const e=S1("main"),t=DO(e,n);if(!xe(e)||!xe(t)||!xe(Ce.element))return;const r={...Ce},i=`${n}_run`,s=Vr(Ce.element.name??Ce.element.kinddata?.name??""),a=t?.code??"";iV.once(i,eV.RUNTIME,s,a),ub(r).forEach(o=>{Ce[o]=r[o]})}async function N0e(n){const e=new FormData;e.append("url",n);const t=new Request("https://bytes.zed.cafe",{method:"POST",body:e});return await(await fetch(t)).text()}function P0e(){return window.location.href.includes("/join/")}function jL(){return window.location.href.includes("/locked/")}const ont=n=>n;function sV(n,e=ont){const t=Ng.useSyncExternalStore(n.subscribe,Ng.useCallback(()=>e(n.getState()),[n,e]),Ng.useCallback(()=>e(n.getInitialState()),[n,e]));return Ng.useDebugValue(t),t}const Yne=n=>{const e=eU(n),t=r=>sV(e,r);return Object.assign(t,e),t},tS=n=>n?Yne(n):Yne;function Xne(n){const e=it.useRef(null);return t=>{const r=n(t);return(e.current===void 0||r===void 0?e.current===r:i1(e.current,r))?e.current:e.current=r}}const ws=tS(()=>({desync:!1,zsswords:{cli:[],loader:[],runtime:[],flags:[],stats:[],kinds:[],altkinds:[],colors:[],dirs:[],dirmods:[],exprs:[]},gadget:{id:"",board:"",layers:[],tickers:[],scrollname:"",scroll:[],sidebar:[]},slim:[]}));var O0=(n=>(n[n.TOP=0]="TOP",n[n.FULL=1]="FULL",n[n.BOTTOM=2]="BOTTOM",n[n.SPLIT_X=3]="SPLIT_X",n[n.MAX=4]="MAX",n))(O0||{});const oo=tS(n=>({layout:0,inspector:jL(),quickterminal:!1,toast:"",terminal:{open:!0,info:[],logs:[]},editor:{open:!1,book:"",path:[],type:"",title:""},reset(){n({layout:0,inspector:jL(),quickterminal:!1,toast:"",terminal:{open:!0,logs:[]},editor:{open:!1,book:"",path:[],type:"",title:""}})}})),Jo=tS(n=>({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""],reset(){n({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""]})}})),bc=tS(n=>({xscroll:0,yscroll:0,cursor:0,select:void 0,reset(){n({xscroll:0,yscroll:0,cursor:0,select:void 0})}})),Fy=tS(n=>({pts:[],cursor:void 0,select:void 0,reset(){n({pts:[],cursor:void 0,select:void 0})}}));function D0e(n){return n.generateMipmaps=!1,n.minFilter=bf,n.magFilter=bf,n.needsUpdate=!0,n}function _v(n){if(xe(n))return D0e(new Goe(xFe(n)))}const Kk=it.createContext(Tb(1,1,15,1));function Fh(){return it.useContext(Kk)}const L0e=tS(()=>({blink:!1}));setInterval(()=>{L0e.setState(n=>({blink:!n.blink}))},333);function Xg(){return L0e(n=>n.blink)}function U0e(){return eU(n=>{function e(){n(t=>({render:t.render+1}))}return{dither:[],render:0,changed(){queueMicrotask(e)}}})}function lnt(n){n.fill(0)}function gF(n,e,t,r,i,s){if(r<0||r>=e||i<0||i>=t)return-1;n[r+i*e]=s}const B0e=it.createContext(U0e());function cnt(n,e,t){const[r]=it.useState(()=>U0e()),i=n*e,s=r.getState();return s.dither.length!==i&&(s.dither=new Array(i).fill(t),s.render=0),r}function F0e(){return eU(n=>{function e(){n(t=>({render:t.render+1}))}return{width:0,height:0,char:[],color:[],bg:[],render:0,changed(){queueMicrotask(e)}}})}function Zk(n,e,t,r){n.char.fill(e),n.color.fill(t),n.bg.fill(r)}function pu(n,e,t,r,i,s){if(r<0||r>=e||i<0||i>=t)return;const a=r+i*e;ub(s).forEach(o=>{const l=s[o];xe(l)&&(n[o][a]=l)})}const aV=it.createContext(F0e());function hx(n,e,t,r,i){const[s]=it.useState(()=>F0e()),a=n*e,o=s.getState();return o.char.length!==a&&(o.width=n,o.height=e,o.char=new Array(a).fill(t),o.color=new Array(a).fill(r),o.bg=new Array(a).fill(i),o.render=0),s}function z0e(){return it.useContext(aV).getState()}const _F=rx(tR),GM=ix(eR),Gc=tS(n=>({palette:_F,charset:GM,mood:"",viewimage:"",screen:{},reset(){const e=xe(GM)?GB(GM,Jd,Qd):void 0;n({palette:_F,mood:"",viewimage:"",screen:{},palettedata:hw(_F),charset:GM,charsetdata:_v(GM),spritecharset:e,spritecharsetdata:_v(e)})},setmood(e){n(t=>i1(t.mood,e)?t:{...t,mood:e})},setviewimage(e){n(t=>i1(t.viewimage,e)?t:{...t,viewimage:e})},setpalette(e){n(t=>i1(t.palette,e)?t:{...t,palette:e,palettedata:hw(e)})},setcharset(e){n(t=>{if(i1(t.charset,e))return t;const r=xe(e)?GB(e,Jd,Qd):void 0;return{...t,charset:e,charsetdata:_v(e),spritecharset:r,spritecharsetdata:_v(r)}})},setaltcharset(e){n(t=>{if(i1(t.altcharset,e))return t;const r=xe(e)?GB(e,Jd,Qd):void 0;return{...t,altcharset:e,altcharsetdata:_v(e),spritealtcharset:r,spritealtcharsetdata:_v(r)}})},setscreen(e,t){n(r=>i1(r.screen,t)?r:{...r,screen:{...r.screen,[e]:t}})}}));Gc.getState().reset();const km=tS(()=>({active:!0,insetcols:20,insetrows:20,islowrez:!1,islandscape:!0,sidebaropen:!0,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!1,showtouchcontrols:!1,checknumbers:"",wordlist:[],wordlistflag:""}));function ic(n,e,t){t().catch(r=>{console.error(r),xi(n,e,"crash",r?.message)})}async function Mw(n){return xIe(n)}async function XO(n,e){return wIe(n,e)}function unt(n){try{return sessionStorage.getItem(n)??void 0}catch(e){xi(Ri,Ul,`readsession ${n}`,e.message)}}function fnt(n,e){try{xe(e)?sessionStorage.setItem(n,e):sessionStorage.removeItem(n)}catch(t){xi(Ri,Ul,`writesession ${n} <- ${e}`,t.message)}}function j0e(){try{const n=location.hash.slice(1);if(n.length)return n}catch(n){xi(Ri,Ul,"crash",n.message)}return""}async function cz(){const n=j0e();if(n.length){const e=await bnt(n);return xe(e)&&e.length>n.length?e:n}return""}async function H0e(){const n=await dH("cli");AH(Ul,n)}function hnt(){Av(Ri,Ul,"#pages")}function dnt(n,e){const t=n==="error"?"$red":"$blue",r=e.map(s=>`${s}`).join(" ");return r.startsWith("!")?`!${r}`:`$onclear${t}${r}`}const Kne=/\((\d+)\)/;function RN(n){const{terminal:e}=oo.getState(),t=dnt(n.target,n.data),[r=""]=e.logs,i=[...e.logs],s=jee(r).replace(Kne,""),a=jee(t),o=s.indexOf(a);if(a.length&&s.length&&o===0){const l=Kne.exec(r);if(xe(l)){const c=parseFloat(l[1])+1;i.shift(),i.unshift(`(${c})${t}`)}else i.shift(),i.unshift(`(2)${t}`)}else i.unshift(t);oo.setState(l=>({terminal:{...l.terminal,logs:i}}))}function pnt(n){const{layout:e,editor:t}=oo.getState();let i=e+(n?1:-1);if(i<0&&(i+=O0.MAX),i>=O0.MAX&&(i-=O0.MAX),!t.open)switch(i){case O0.SPLIT_X:i=O0.TOP;break}oo.setState({layout:i})}async function q0e(n){if(n.length===0){xi(Ri,Ul,"content","no content found"),await H0e(),Ece(Ri,Ul),$j(Ri,Ul);return}tIe(Ri,Ul,n)}let KO="";window.addEventListener("hashchange",()=>{ic(Ri,Ul,async()=>{const n=j0e();if(KO!==n){KO=n;const e=await cz();await q0e(e)}})});async function V0e(n,e,t){if(n.length>2048){const i=await ynt(n);return V0e(i,e,t)}const r=`#${n}`;if(location.hash!==r){KO=n,location.hash=r;const i=`wrote ${t.length} chars [${t.slice(0,8)}...${t.slice(-8)}]`;e.includes("autosave")||Ts(Ri,Ul,i),document.title=e}}function G0e(n){switch(n){case"crt":return"on";default:return"off"}}async function OP(n){const e=await Mw(`config_${n}`);return e?e&&e!=="off"?"on":"off":G0e(n)}async function mnt(n,e){return Ts(Ri,Ul,`writing config ${n}`),XO(`config_${n}`,()=>e)}async function gnt(){const n=["config_crt","config_lowrez","config_scanlines","config_voice2text"];return(await TIe(n)).map((t,r)=>{const s=n[r].replace("config_","");return t?[s,t&&t!=="off"?"on":"off"]:[s,G0e(s)]})}async function _nt(){return Mw("HISTORYBUFFER")}async function vnt(n){return XO("HISTORYBUFFER",()=>n)}async function ynt(n){let e=await Mw(n);if(e===void 0){for(;e===void 0;){const t=Wj({addAdverb:!0,capitalize:!1,adjectiveCount:2});await Mw(t)===void 0&&(e=t)}await XO(n,()=>e),await XO(e,()=>n)}return e}async function bnt(n){return await Mw(n)}let vF=0;const Zne=10,Ul=unt("PLAYER")??LIe();fnt("PLAYER",Ul);let Jne;function as(){return Ul}const Ri=Y1("register",["ready","second","info","error","log","chat","toast"],function(n){if(Ri.session(n)){switch(n.target){case"ready":case"chat":case"toast":case"second":break;default:if(n.player!==Ul)return;break}switch(n.target){case"ready":{ic(Ri,n.player,async()=>{const e=await _nt();xe(e)&&Jo.setState({buffer:e.filter(t=>t.includes("#broadcast")===!1)}),await Ch(256),Ts(Ri,Ul,`myplayerid ${Ul}`),K3e(Ri,Ul)});break}case"refresh":ic(Ri,n.player,async()=>{km.setState({active:!1}),await Ch(512),oo.getState().reset(),Gc.getState().reset(),bc.getState().reset(),Jo.getState().reset(),Fy.getState().reset(),ws.setState({gadget:{id:"",board:"",layers:[],tickers:[],scrollname:"",scroll:[],sidebar:[]}}),await Ch(512),km.setState({active:!0})});break;case"ackoperator":A3e(Ri,Ul),ic(Ri,n.player,async()=>{const e=await cz();P0e()?E3e(Ri,Ul,e):(eIe(Ri,Ul,jL()),await q0e(e))});break;case"loginready":ic(Ri,n.player,async()=>{const e=await Mw("storage");rIe(Ri,Ul,e??{}),Ece(Ri,Ul)});break;case"loginfail":ic(Ri,n.player,async()=>{await H0e(),hnt(),$j(Ri,Ul)});break;case"acklogin":VD(Ri,Ul);break;case"ackzsswords":{ws.setState({zsswords:n.data});const e=[],t=Object.values(n.data);for(let r=0;r<t.length;++r)e.push(...t[r]);break}case"storage":ic(Ri,n.player,async()=>{xe(n.data)&&await XO("storage",()=>n.data)});break;case"copy":Vn(n.data)&&xe(el())&&el().writeText(n.data).then(()=>Uy(Ri,n.player,"copied!")).catch(e=>console.error(e));break;case"copyjsonfile":if(ui(n.data)&&xe(el())){const[e,t]=n.data,r=new Blob([JSON.stringify({exported:t,data:e},null,2)],{type:"text/plain"});el().write([new ClipboardItem({[r.type]:r})]).then(()=>Uy(Ri,n.player,"copied!")).catch(i=>console.error(i))}break;case"downloadjsonfile":if(ui(n.data)){const[e,t]=n.data;try{const r=new Blob([JSON.stringify({exported:t,data:e},null,2)],{type:"application/json;charset=utf-8"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=t,s.click(),URL.revokeObjectURL(i)}catch(r){console.error(r)}}break;case"dev":ic(Ri,n.player,async function(){jL()?(T_(Ri,n.player,"unlocking terminal"),await Ch(100),location.href=location.href.replace("/locked/#","/#")):(T_(Ri,n.player,"creating locked terminal"),await Ch(100),location.href=location.href.replace("/#","/locked/#"))});break;case"share":ic(Ri,n.player,async function(){const e=await cz(),t=`#${e}`;KO=e,location.hash=t;const r=await N0e(location.href);_9(Ri,n.player,r,r)});break;case"nuke":ic(Ri,n.player,async function(){T_(Ri,n.player,"nuke in"),Tm(Ri,n.player,"3","..."),await Ch(1e3),Tm(Ri,n.player,"2","..."),await Ch(1e3),Tm(Ri,n.player,"1","..."),await Ch(1e3),T_(Ri,n.player,"BYE"),await Ch(100),location.hash="",KO=location.hash,location.reload()});break;case"savemem":ic(Ri,n.player,async function(){if(ui(n.data)){const[e,t]=n.data;Vn(e)&&Vn(t)&&await V0e(t,e,t)}});break;case"forkmem":if(ui(n.data)){const[e]=n.data;Vn(e)&&window.open(location.href.replace("/locked/#","/#").replace(/#.*/,`#${e}`),"_blank")}break;case"itchiopublishmem":ic(Ri,n.player,async()=>{if(ui(n.data)){const[e,t]=n.data;Vn(e)&&Vn(t)&&await tNe(e,t)}});break;case"config":ic(Ri,n.player,async()=>{if(ui(n.data)){const[e,t]=n.data;await mnt(e,t)}});break;case"configshow":ic(Ri,n.player,async()=>{const e=await gnt();T_(Ri,n.player,"config");for(let t=0;t<e.length;++t)Tm(Ri,n.player,e[t][0],e[t][1])});break;case"second":++vF,vF>=Zne&&(vF-=Zne,Tce(Ri,Ul));break;case"inspector":oo.setState(e=>{const t=xe(n.data)?!!n.data:!e.inspector;return Ts(Ri,n.player,`gadget inspector ${t?"$greenon":"$redoff"}`),t&&Ts(Ri,n.player,"mouse click or tap elements to inspect"),{inspector:t}});break;case"findany":ui(n.data)&&Fy.setState({pts:n.data});break;case"log":RN(n);break;case"chat":RN(n);break;case"info":RN(n);break;case"error":RN(n);break;case"toast":if(xe(n.data)){clearTimeout(Jne),oo.setState({toast:n.data});const e=Math.max(n.data.length*150,3e3),t=Math.min(e,14e3);Jne=setTimeout(()=>oo.setState({toast:""}),t)}break;case"terminal:full":oo.setState(e=>({layout:O0.FULL,terminal:{...e.terminal,open:!0}}));break;case"terminal:open":oo.setState(e=>({terminal:{...e.terminal,open:!0}}));break;case"terminal:quickopen":if(n.data&&Vn(n.data)){const e=Jo.getState().buffer;e[0]=n.data,Jo.setState({buffer:e,bufferindex:0,xcursor:n.data.length,ycursor:0,xselect:void 0,yselect:void 0})}oo.setState({quickterminal:!0,layout:O0.TOP});break;case"terminal:close":oo.setState(e=>({quickterminal:!1,terminal:{...e.terminal,open:!1}}));break;case"terminal:toggle":oo.setState(e=>({terminal:{...e.terminal,open:!e.terminal.open}}));break;case"terminal:inclayout":h3e(n.data)&&pnt(n.data);break;case"editor:open":if(ui(n.data)){const[e,t,r,i]=n.data;oo.setState(()=>({editor:{open:!0,player:n.player,book:e,path:t,type:r,title:i}}))}break;case"editor:close":oo.setState(e=>({editor:{...e.editor,open:!1}}));break}}}),$0e="15.1.22",Qne=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),ere=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),uz=(n,e)=>({startTime:e,type:"setValue",value:n}),W0e=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),Y0e=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),OT=n=>n.type==="exponentialRampToValue",HL=n=>n.type==="linearRampToValue",a1=n=>OT(n)||HL(n),oV=n=>n.type==="setValue",Ly=n=>n.type==="setValueCurve",qL=(n,e,t,r)=>{const i=n[e];return i===void 0?r:a1(i)||oV(i)?i.value:Ly(i)?i.values[i.values.length-1]:Y0e(t,qL(n,e-1,i.startTime,r),i)},tre=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:a1(t)?[t.endTime,t.value]:oV(t)?[t.startTime,t.value]:Ly(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,qL(n,e-1,t.startTime,i)],fz=n=>n.type==="cancelAndHold",hz=n=>n.type==="cancelScheduledValues",Xb=n=>fz(n)||hz(n)?n.cancelTime:OT(n)||HL(n)?n.endTime:n.startTime,nre=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,rre=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),Snt=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},Ent=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return Snt(r,i)},AN=n=>n.type==="setTarget";class xnt{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Xb(e);if(fz(e)||hz(e)){const r=this._automationEvents.findIndex(s=>hz(e)&&Ly(s)?s.startTime+s.duration>=t:Xb(s)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),fz(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&a1(i)){if(s!==void 0&&AN(s))throw new Error("The internal list is malformed.");const a=s===void 0?i.insertTime:Ly(s)?s.startTime+s.duration:Xb(s),o=s===void 0?this._defaultValue:Ly(s)?s.values[s.values.length-1]:s.value,l=OT(i)?nre(t,a,o,i):rre(t,a,o,i),c=OT(i)?Qne(l,t,this._currenTime):ere(l,t,this._currenTime);this._automationEvents.push(c)}if(s!==void 0&&AN(s)&&this._automationEvents.push(uz(this.getValue(t),t)),s!==void 0&&Ly(s)&&s.startTime+s.duration>t){const a=t-s.startTime,o=(s.values.length-1)/s.duration,l=Math.max(2,1+Math.ceil(a*o)),c=a/(l-1)*o,u=s.values.slice(0,l);if(c<1)for(let f=1;f<l;f+=1){const h=c*f%1;u[f]=s.values[f-1]*(1-h)+s.values[f]*h}this._automationEvents[this._automationEvents.length-1]=W0e(u,s.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>Xb(a)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Ly(i)&&Xb(i)+i.duration>t)return!1;const s=OT(e)?Qne(e.value,e.endTime,this._currenTime):HL(e)?ere(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(Ly(e)&&t+e.duration>Xb(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>Xb(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];AN(i)&&r.unshift(uz(qL(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>Xb(a)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,s=this._automationEvents[i];if(s!==void 0&&AN(s)&&(r===void 0||!a1(r)||r.insertTime>e))return Y0e(e,qL(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&oV(s)&&(r===void 0||!a1(r)))return s.value;if(s!==void 0&&Ly(s)&&(r===void 0||!a1(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?Ent(e,s):s.values[s.values.length-1];if(s!==void 0&&a1(s)&&(r===void 0||!a1(r)))return s.value;if(r!==void 0&&OT(r)){const[a,o]=tre(this._automationEvents,i,s,r,this._defaultValue);return nre(e,a,o,r)}if(r!==void 0&&HL(r)){const[a,o]=tre(this._automationEvents,i,s,r,this._defaultValue);return rre(e,a,o,r)}return this._defaultValue}}const Tnt=n=>({cancelTime:n,type:"cancelAndHold"}),wnt=n=>({cancelTime:n,type:"cancelScheduledValues"}),Rnt=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Ant=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),Cnt=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),Mnt=()=>new DOMException("","AbortError"),Ont=n=>(e,t,[r,i,s],a)=>{n(e[i],[t,r,s],o=>o[0]===t&&o[1]===r,a)},knt=n=>(e,t,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Int=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Ow=new WeakSet,X0e=new WeakMap,lV=new WeakMap,K0e=new WeakMap,cV=new WeakMap,i6=new WeakMap,Z0e=new WeakMap,dz=new WeakMap,pz=new WeakMap,mz=new WeakMap,J0e={construct(){return J0e}},Nnt=n=>{try{const e=new Proxy(n,J0e);new e}catch{return!1}return!0},ire=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,sre=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(ire);for(;i!==null;){const s=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());t.push(a),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(ire)}return[t.join(";"),r]},are=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},ore=n=>{if(!Nnt(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Pnt=(n,e,t,r,i,s,a,o,l,c,u,f,h)=>{let g=0;return(p,_,y={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(_))return Promise.resolve();const x=c.get(p);if(x!==void 0){const k=x.get(_);if(k!==void 0)return k}const E=s(p),M=E.audioWorklet===void 0?i(_).then(([k,N])=>{const[I,D]=sre(k,N),V=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${D}
})})(window,'_AWGS')`;return t(V)}).then(()=>{const k=h._AWGS.pop();if(k===void 0)throw new SyntaxError;r(E.currentTime,E.sampleRate,()=>k(class{},void 0,(N,I)=>{if(N.trim()==="")throw e();const D=pz.get(E);if(D!==void 0){if(D.has(N))throw e();ore(I),are(I.parameterDescriptors),D.set(N,I)}else ore(I),are(I.parameterDescriptors),pz.set(E,new Map([[N,I]]))},E.sampleRate,void 0,void 0))}):Promise.all([i(_),Promise.resolve(n(f,f))]).then(([[k,N],I])=>{const D=g+1;g=D;const[V,G]=sre(k,N),U=`${V};((AudioWorkletProcessor,registerProcessor)=>{${G}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${D}',class extends AudioWorkletProcessor{process(){return !1}})`,Q=new Blob([U],{type:"application/javascript; charset=utf-8"}),W=URL.createObjectURL(Q);return E.audioWorklet.addModule(W,y).then(()=>{if(o(E))return E;const q=a(E);return q.audioWorklet.addModule(W,y).then(()=>q)}).then(q=>{if(l===null)throw new SyntaxError;try{new l(q,`__sac${D}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(W))});return x===void 0?c.set(p,new Map([[_,M]])):x.set(_,M),M.then(()=>{const k=u.get(p);k===void 0?u.set(p,new Set([_])):k.add(_)}).finally(()=>{const k=c.get(p);k!==void 0&&k.delete(_)}),M}},I_=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},s6=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},Q0e=(n,e,t,r)=>{const i=I_(n,e),s=s6(i,a=>a[0]===t&&a[1]===r);return i.size===0&&n.delete(e),s},Jk=n=>I_(Z0e,n),kw=n=>{if(Ow.has(n))throw new Error("The AudioNode is already stored.");Ow.add(n),Jk(n).forEach(e=>e(!0))},e_e=n=>"port"in n,Qk=n=>{if(!Ow.has(n))throw new Error("The AudioNode is not stored.");Ow.delete(n),Jk(n).forEach(e=>e(!1))},gz=(n,e)=>{!e_e(n)&&e.every(t=>t.size===0)&&Qk(n)},Dnt=(n,e,t,r,i,s,a,o,l,c,u,f,h)=>{const g=new WeakMap;return(p,_,y,v,x)=>{const{activeInputs:E,passiveInputs:M}=s(_),{outputs:k}=s(p),N=o(p),I=D=>{const V=l(_),G=l(p);if(D){const J=Q0e(M,p,y,v);n(E,p,J,!1),!x&&!f(p)&&t(G,V,y,v),h(_)&&kw(_)}else{const J=r(E,p,y,v);e(M,v,J,!1),!x&&!f(p)&&i(G,V,y,v);const B=a(_);if(B===0)u(_)&&gz(_,E);else{const $=g.get(_);$!==void 0&&clearTimeout($),g.set(_,setTimeout(()=>{u(_)&&gz(_,E)},B*1e3))}}};return c(k,[_,y,v],D=>D[0]===_&&D[1]===y&&D[2]===v,!0)?(N.add(I),u(p)?n(E,p,[y,v,I],!0):e(M,v,[p,y,I],!0),!0):!1}},Lnt=n=>(e,t,[r,i,s],a)=>{const o=e.get(r);o===void 0?e.set(r,new Set([[i,t,s]])):n(o,[i,t,s],l=>l[0]===i&&l[1]===t,a)},Unt=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},Bnt=n=>(e,t)=>{n(e).add(t)},Fnt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},znt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...Fnt,...l},f=r(c,u),h=s(c)?e():null;super(o,!1,f,h),this._nativeAnalyserNode=f}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},sp=(n,e)=>n.context===e,jnt=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!sp(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},VL=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},sy=()=>new DOMException("","IndexSizeError"),uV=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?sy():r}})(n.getChannelData)},Hnt={numberOfChannels:1},qnt=(n,e,t,r,i,s,a,o)=>{let l=null;return class t_e{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:f,numberOfChannels:h,sampleRate:g}={...Hnt,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:f,numberOfChannels:h,sampleRate:g}):l.createBuffer(h,f,g);if(p.numberOfChannels===0)throw t();return typeof p.copyFromChannel!="function"?(a(p),uV(p)):e(VL,()=>VL(p))||o(p),n.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===t_e.prototype||n.has(u)}}},wm=-34028234663852886e22,Op=-wm,ib=n=>Ow.has(n),Vnt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Gnt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),h={...Vnt,...u},g=i(f,h),p=a(f),_=p?e():null;super(c,!1,g,_),this._audioBufferSourceNodeRenderer=_,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=g,this._onended=null,this._playbackRate=t(this,p,g.playbackRate,Op,wm)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?o(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const f=this._nativeAudioBufferSourceNode.onended;this._onended=f!==null&&f===u?c:f}get playbackRate(){return this._playbackRate}start(c=0,u=0,f){if(this._nativeAudioBufferSourceNode.start(c,u,f),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=f===void 0?[c,u]:[c,u,f]),this.context.state!=="closed"){kw(this);const h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),ib(this)&&Qk(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},$nt=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null;const l=async(c,u)=>{let f=t(c);const h=sp(f,u);if(!h){const g={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value};f=e(u,g),a!==null&&f.start(...a),o!==null&&f.stop(o)}return s.set(u,f),h?await n(u,c.playbackRate,f.playbackRate):await r(u,c.playbackRate,f.playbackRate),await i(c,u,f),f};return{set start(c){a=c},set stop(c){o=c},render(c,u){const f=s.get(u);return f!==void 0?Promise.resolve(f):l(c,u)}}},Wnt=n=>"playbackRate"in n,Ynt=n=>"frequency"in n&&"gain"in n,Xnt=n=>"offset"in n,Knt=n=>!("frequency"in n)&&"gain"in n,Znt=n=>"detune"in n&&"frequency"in n&&!("gain"in n),Jnt=n=>"pan"in n,Fp=n=>I_(X0e,n),e3=n=>I_(K0e,n),_z=(n,e)=>{const{activeInputs:t}=Fp(n);t.forEach(i=>i.forEach(([s])=>{e.includes(n)||_z(s,[...e,n])}));const r=Wnt(n)?[n.playbackRate]:e_e(n)?Array.from(n.parameters.values()):Ynt(n)?[n.Q,n.detune,n.frequency,n.gain]:Xnt(n)?[n.offset]:Knt(n)?[n.gain]:Znt(n)?[n.detune,n.frequency]:Jnt(n)?[n.pan]:[];for(const i of r){const s=e3(i);s!==void 0&&s.activeInputs.forEach(([a])=>_z(a,e))}ib(n)&&Qk(n)},n_e=n=>{_z(n.destination,[])},Qnt=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),ert=(n,e,t,r,i,s,a,o,l)=>class extends n{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let f;try{f=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?t():p}if(f===null)throw r();if(!Qnt(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&f.sampleRate!==u.sampleRate)throw t();super(f,2);const{latencyHint:h}=u,{sampleRate:g}=f;if(this._baseLatency=typeof f.baseLatency=="number"?f.baseLatency:h==="balanced"?512/g:h==="interactive"||h===void 0?256/g:h==="playback"?1024/g:Math.max(2,Math.min(128,Math.round(h*g/128)))*128/g,this._nativeAudioContext=f,l.name==="webkitAudioContext"?(this._nativeGainNode=f.createGain(),this._nativeOscillatorNode=f.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(f.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,f.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),f.removeEventListener("statechange",p)};f.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),n_e(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,f)=>{const h=()=>{this._nativeAudioContext.removeEventListener("statechange",h),this._nativeAudioContext.state==="running"?u():this.resume().then(u,f)};this._nativeAudioContext.addEventListener("statechange",h)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},trt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),h=a(f),g=i(f,u,h),p=h?e(o):null;super(c,!1,g,p),this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=g}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},nrt=n=>{const e=new WeakMap,t=async(r,i)=>{const s=i.destination;return e.set(i,s),await n(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):t(r,i)}}},rrt=(n,e,t,r,i,s,a,o)=>(l,c)=>{const u=c.listener,f=()=>{const k=new Float32Array(1),N=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=a(c);let D=!1,V=[0,0,-1,0,1,0],G=[0,0,0];const J=()=>{if(D)return;D=!0;const Q=r(c,256,9,0);Q.onaudioprocess=({inputBuffer:W})=>{const q=[s(W,k,0),s(W,k,1),s(W,k,2),s(W,k,3),s(W,k,4),s(W,k,5)];q.some((ae,Z)=>ae!==V[Z])&&(u.setOrientation(...q),V=q);const Y=[s(W,k,6),s(W,k,7),s(W,k,8)];Y.some((ae,Z)=>ae!==G[Z])&&(u.setPosition(...Y),G=Y)},N.connect(Q)},B=Q=>W=>{W!==V[Q]&&(V[Q]=W,u.setOrientation(...V))},$=Q=>W=>{W!==G[Q]&&(G[Q]=W,u.setPosition(...G))},U=(Q,W,q)=>{const Y=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W});Y.connect(N,0,Q),Y.start(),Object.defineProperty(Y.offset,"defaultValue",{get(){return W}});const ae=n({context:l},I,Y.offset,Op,wm);return o(ae,"value",Z=>()=>Z.call(ae),Z=>K=>{try{Z.call(ae,K)}catch(ne){if(ne.code!==9)throw ne}J(),I&&q(K)}),ae.cancelAndHoldAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.cancelAndHoldAtTime),ae.cancelScheduledValues=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.cancelScheduledValues),ae.exponentialRampToValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.exponentialRampToValueAtTime),ae.linearRampToValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.linearRampToValueAtTime),ae.setTargetAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.setTargetAtTime),ae.setValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.setValueAtTime),ae.setValueCurveAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return J(),ne})(ae.setValueCurveAtTime),ae};return{forwardX:U(0,0,B(0)),forwardY:U(1,0,B(1)),forwardZ:U(2,-1,B(2)),positionX:U(6,0,$(0)),positionY:U(7,0,$(1)),positionZ:U(8,0,$(2)),upX:U(3,0,B(3)),upY:U(4,1,B(4)),upZ:U(5,0,B(5))}},{forwardX:h,forwardY:g,forwardZ:p,positionX:_,positionY:y,positionZ:v,upX:x,upY:E,upZ:M}=u.forwardX===void 0?f():u;return{get forwardX(){return h},get forwardY(){return g},get forwardZ(){return p},get positionX(){return _},get positionY(){return y},get positionZ(){return v},get upX(){return x},get upY(){return E},get upZ(){return M}}},GL=n=>"context"in n,t3=n=>GL(n[0]),dx=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},lre=(n,e,[t,r],i)=>{dx(n,[e,t,r],s=>s[0]===e&&s[1]===t,i)},cre=(n,[e,t,r],i)=>{const s=n.get(e);s===void 0?n.set(e,new Set([[t,r]])):dx(s,[t,r],a=>a[0]===t,i)},cR=n=>"inputs"in n,$L=(n,e,t,r)=>{if(cR(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},r_e=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},irt=(n,e,t)=>s6(n,r=>r[0]===e&&r[1]===t),i_e=(n,e)=>{if(!Jk(n).delete(e))throw new Error("Missing the expected event listener.")},s_e=(n,e,t)=>{const r=I_(n,e),i=s6(r,s=>s[0]===t);return r.size===0&&n.delete(e),i},WL=(n,e,t,r)=>{cR(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},lc=n=>I_(lV,n),ZO=n=>I_(cV,n),qE=n=>dz.has(n),kP=n=>!Ow.has(n),ure=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),s=n.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const o=n.createBufferSource();o.buffer=s,o.loop=!0,o.connect(r).connect(n.destination),o.connect(i),o.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?t(!0):t(!1),o.stop(),r.onaudioprocess=null,o.disconnect(r),r.disconnect(n.destination)},o.start()}}),yF=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const s=t.get(i);t.set(i,s===void 0?1:s+1)}t.forEach((r,i)=>e(i,r))},YL=n=>"context"in n,srt=n=>{const e=new Map;n.connect=(t=>(r,i=0,s=0)=>{const a=YL(r)?t(r,i,s):t(r,i),o=e.get(r);return o===void 0?e.set(r,[{input:s,output:i}]):o.every(l=>l.input!==s||l.output!==i)&&o.push({input:s,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(r,i,s)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[a,o]of e){const l=o.filter(c=>c.output!==r);l.length===0?e.delete(a):e.set(a,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const a=e.get(r);if(a!==void 0){const o=a.filter(l=>l.output!==i&&(l.input!==s||s===void 0));o.length===0?e.delete(r):e.set(r,o)}}for(const[a,o]of e)o.forEach(l=>{YL(a)?n.connect(a,l.output,l.input):n.connect(a,l.output)})})(n.disconnect)},art=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=e3(e),{outputs:a}=Fp(n),o=Jk(n),l=c=>{const u=lc(n),f=ZO(e);if(c){const h=s_e(s,n,t);lre(i,n,h,!1),!r&&!qE(n)&&u.connect(f,t)}else{const h=irt(i,n,t);cre(s,h,!1),!r&&!qE(n)&&u.disconnect(f,t)}};return dx(a,[e,t],c=>c[0]===e&&c[1]===t,!0)?(o.add(l),ib(n)?lre(i,n,[t,l],!0):cre(s,[n,t,l],!0),!0):!1},ort=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=Fp(e),a=r_e(i[r],n,t);return a===null?[Q0e(s,n,t,r)[2],!1]:[a[2],!0]},lrt=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=e3(e),s=r_e(r,n,t);return s===null?[s_e(i,n,t)[1],!1]:[s[2],!0]},fV=(n,e,t,r,i)=>{const[s,a]=ort(n,t,r,i);if(s!==null&&(i_e(n,s),a&&!e&&!qE(n)&&WL(lc(n),lc(t),r,i)),ib(t)){const{activeInputs:o}=Fp(t);gz(t,o)}},hV=(n,e,t,r)=>{const[i,s]=lrt(n,t,r);i!==null&&(i_e(n,i),s&&!e&&!qE(n)&&lc(n).disconnect(ZO(t),r))},crt=(n,e)=>{const t=Fp(n),r=[];for(const i of t.outputs)t3(i)?fV(n,e,...i):hV(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},urt=(n,e,t)=>{const r=Fp(n),i=[];for(const s of r.outputs)s[1]===t&&(t3(s)?fV(n,e,...s):hV(n,e,...s),i.push(s[0]),r.outputs.delete(s));return i},frt=(n,e,t,r,i)=>{const s=Fp(n);return Array.from(s.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(i===void 0||a[2]===i)).map(a=>(t3(a)?fV(n,e,...a):hV(n,e,...a),s.outputs.delete(a),a[0]))},hrt=(n,e,t,r,i,s,a,o,l,c,u,f,h,g,p,_)=>class extends c{constructor(v,x,E,M){super(E),this._context=v,this._nativeAudioNode=E;const k=u(v);f(k)&&t(ure,()=>ure(k,_))!==!0&&srt(E),lV.set(this,E),Z0e.set(this,new Set),v.state!=="closed"&&x&&kw(this),n(this,M,E)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,x=0,E=0){if(x<0||x>=this._nativeAudioNode.numberOfOutputs)throw i();const M=u(this._context),k=p(M);if(h(v)||g(v))throw s();if(GL(v)){const D=lc(v);try{const G=$L(this._nativeAudioNode,D,x,E),J=kP(this);(k||J)&&this._nativeAudioNode.disconnect(...G),this.context.state!=="closed"&&!J&&kP(v)&&kw(v)}catch(G){throw G.code===12?s():G}if(e(this,v,x,E,k)){const G=l([this],v);yF(G,r(k))}return v}const N=ZO(v);if(N.name==="playbackRate"&&N.maxValue===1024)throw a();try{this._nativeAudioNode.connect(N,x),(k||kP(this))&&this._nativeAudioNode.disconnect(N,x)}catch(D){throw D.code===12?s():D}if(art(this,v,x,k)){const D=l([this],v);yF(D,r(k))}}disconnect(v,x,E){let M;const k=u(this._context),N=p(k);if(v===void 0)M=crt(this,N);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();M=urt(this,N,v)}else{if(x!==void 0&&(x<0||x>=this.numberOfOutputs)||GL(v)&&E!==void 0&&(E<0||E>=v.numberOfInputs))throw i();if(M=frt(this,N,v,x,E),M.length===0)throw s()}for(const I of M){const D=l([this],I);yF(D,o)}}},drt=(n,e,t,r,i,s,a,o,l,c,u,f,h)=>(g,p,_,y=null,v=null)=>{const x=_.value,E=new xnt(x),M=p?r(E):null,k={get defaultValue(){return x},get maxValue(){return y===null?_.maxValue:y},get minValue(){return v===null?_.minValue:v},get value(){return _.value},set value(N){_.value=N,k.setValueAtTime(N,g.context.currentTime)},cancelAndHoldAtTime(N){if(typeof _.cancelAndHoldAtTime=="function")M===null&&E.flush(g.context.currentTime),E.add(i(N)),_.cancelAndHoldAtTime(N);else{const I=Array.from(E).pop();M===null&&E.flush(g.context.currentTime),E.add(i(N));const D=Array.from(E).pop();_.cancelScheduledValues(N),I!==D&&D!==void 0&&(D.type==="exponentialRampToValue"?_.exponentialRampToValueAtTime(D.value,D.endTime):D.type==="linearRampToValue"?_.linearRampToValueAtTime(D.value,D.endTime):D.type==="setValue"?_.setValueAtTime(D.value,D.startTime):D.type==="setValueCurve"&&_.setValueCurveAtTime(D.values,D.startTime,D.duration))}return k},cancelScheduledValues(N){return M===null&&E.flush(g.context.currentTime),E.add(s(N)),_.cancelScheduledValues(N),k},exponentialRampToValueAtTime(N,I){if(N===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const D=g.context.currentTime;return M===null&&E.flush(D),Array.from(E).length===0&&(E.add(c(x,D)),_.setValueAtTime(x,D)),E.add(a(N,I)),_.exponentialRampToValueAtTime(N,I),k},linearRampToValueAtTime(N,I){const D=g.context.currentTime;return M===null&&E.flush(D),Array.from(E).length===0&&(E.add(c(x,D)),_.setValueAtTime(x,D)),E.add(o(N,I)),_.linearRampToValueAtTime(N,I),k},setTargetAtTime(N,I,D){return M===null&&E.flush(g.context.currentTime),E.add(l(N,I,D)),_.setTargetAtTime(N,I,D),k},setValueAtTime(N,I){return M===null&&E.flush(g.context.currentTime),E.add(c(N,I)),_.setValueAtTime(N,I),k},setValueCurveAtTime(N,I,D){const V=N instanceof Float32Array?N:new Float32Array(N);if(f!==null&&f.name==="webkitAudioContext"){const G=I+D,J=g.context.sampleRate,B=Math.ceil(I*J),$=Math.floor(G*J),U=$-B,Q=new Float32Array(U);for(let q=0;q<U;q+=1){const Y=(V.length-1)/D*((B+q)/J-I),ae=Math.floor(Y),Z=Math.ceil(Y);Q[q]=ae===Z?V[ae]:(1-(Y-ae))*V[ae]+(1-(Z-Y))*V[Z]}M===null&&E.flush(g.context.currentTime),E.add(u(Q,I,D)),_.setValueCurveAtTime(Q,I,D);const W=$/J;W<G&&h(k,Q[Q.length-1],W),h(k,V[V.length-1],G)}else M===null&&E.flush(g.context.currentTime),E.add(u(V,I,D)),_.setValueCurveAtTime(V,I,D);return k}};return t.set(k,_),e.set(k,g),n(k,M),k},prt=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=t;e.setTargetAtTime(i,r,s)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=t;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class a_e{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const mrt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},grt=(n,e,t,r,i,s,a,o,l,c,u,f,h,g)=>class extends e{constructor(_,y,v){var x;const E=o(_),M=l(E),k=u({...mrt,...v});h(k);const N=pz.get(E),I=N?.get(y),D=M||E.state!=="closed"?E:(x=a(E))!==null&&x!==void 0?x:E,V=i(D,M?null:_.baseLatency,c,y,I,k),G=M?r(y,k,I):null;super(_,!0,V,G);const J=[];V.parameters.forEach(($,U)=>{const Q=t(this,M,$);J.push([U,Q])}),this._nativeAudioWorkletNode=V,this._onprocessorerror=null,this._parameters=new a_e(J),M&&n(E,this);const{activeInputs:B}=s(this);f(V,B)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(_){const y=typeof _=="function"?g(this,_):null;this._nativeAudioWorkletNode.onprocessorerror=y;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===y?_:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function XL(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const s=n.getChannelData(r);if(e[t].byteLength===0)e[t]=s.slice(i,i+128);else{const a=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const o_e=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},KL=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let a=0;a<s;a+=1)i.push(new Float32Array(128));t.push(i)}return t},_rt=(n,e)=>{const t=I_(mz,n),r=lc(e);return I_(t,r)},vrt=async(n,e,t,r,i,s,a)=>{const o=e===null?Math.ceil(n.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((y,v)=>y+v,0),u=c===0?null:t.createBuffer(c,o,t.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const f=Fp(n),h=await _rt(t,n),g=KL(r.numberOfInputs,r.channelCount),p=KL(r.numberOfOutputs,i),_=Array.from(n.parameters.keys()).reduce((y,v)=>({...y,[v]:new Float32Array(128)}),{});for(let y=0;y<o;y+=128){if(r.numberOfInputs>0&&e!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let x=0;x<r.channelCount;x+=1)XL(e,g[v],x,x,y);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:v},x)=>{XL(e,_,v,l+x,y)});for(let v=0;v<r.numberOfInputs;v+=1)for(let x=0;x<i[v];x+=1)p[v][x].byteLength===0&&(p[v][x]=new Float32Array(128));try{const v=g.map((E,M)=>f.activeInputs[M].size===0?[]:E),x=a(y/t.sampleRate,t.sampleRate,()=>h.process(v,p,_));if(u!==null)for(let E=0,M=0;E<r.numberOfOutputs;E+=1){for(let k=0;k<i[E];k+=1)o_e(u,p[E],k,M+k,y);M+=i[E]}if(!x)break}catch(v){n.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},yrt=(n,e,t,r,i,s,a,o,l,c,u,f,h,g,p,_)=>(y,v,x)=>{const E=new WeakMap;let M=null;const k=async(N,I)=>{let D=u(N),V=null;const G=sp(D,I),J=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(f===null){const B=J.reduce((W,q)=>W+q,0),$=i(I,{channelCount:Math.max(1,B),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,B)}),U=[];for(let W=0;W<N.numberOfOutputs;W+=1)U.push(r(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:J[W]}));const Q=a(I,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});Q.connect=e.bind(null,U),Q.disconnect=l.bind(null,U),V=[$,U,Q]}else G||(D=new f(I,y));if(E.set(I,V===null?D:V[2]),V!==null){if(M===null){if(x===void 0)throw new Error("Missing the processor constructor.");if(h===null)throw new Error("Missing the native OfflineAudioContext constructor.");const q=N.channelCount*N.numberOfInputs,Y=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length,ae=q+Y;M=vrt(N,ae===0?null:await(async()=>{const K=new h(ae,Math.ceil(N.context.length/128)*128,I.sampleRate),ne=[],le=[];for(let Me=0;Me<v.numberOfInputs;Me+=1)ne.push(a(K,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),le.push(i(K,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ce=await Promise.all(Array.from(N.parameters.values()).map(async Me=>{const qe=s(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Me.value});return await g(K,Me,qe.offset),qe})),de=r(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,q+Y)});for(let Me=0;Me<v.numberOfInputs;Me+=1){ne[Me].connect(le[Me]);for(let qe=0;qe<v.channelCount;qe+=1)le[Me].connect(de,qe,Me*v.channelCount+qe)}for(const[Me,qe]of ce.entries())qe.connect(de,0,q+Me),qe.start(0);return de.connect(K.destination),await Promise.all(ne.map(Me=>p(N,K,Me))),_(K)})(),I,v,J,x,c)}const B=await M,$=t(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[U,Q,W]=V;B!==null&&($.buffer=B,$.start(0)),$.connect(U);for(let q=0,Y=0;q<N.numberOfOutputs;q+=1){const ae=Q[q];for(let Z=0;Z<J[q];Z+=1)U.connect(ae,Y+Z,Z);Y+=J[q]}return W}if(G)for(const[B,$]of N.parameters.entries())await n(I,$,D.parameters.get(B));else for(const[B,$]of N.parameters.entries())await g(I,$,D.parameters.get(B));return await p(N,I,D),D};return{render(N,I){o(I,N);const D=E.get(I);return D!==void 0?Promise.resolve(D):k(N,I)}}},brt=(n,e,t,r,i,s,a,o,l,c,u,f,h,g,p,_,y,v,x,E)=>class extends p{constructor(k,N){super(k,N),this._nativeContext=k,this._audioWorklet=n===void 0?void 0:{addModule:(I,D)=>n(this,I,D)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(k,N,I){return new t({length:N,numberOfChannels:k,sampleRate:I})}createBufferSource(){return new r(this)}createChannelMerger(k=6){return new s(this,{numberOfInputs:k})}createChannelSplitter(k=6){return new a(this,{numberOfOutputs:k})}createConstantSource(){return new o(this)}createConvolver(){return new l(this)}createDelay(k=1){return new u(this,{maxDelayTime:k})}createDynamicsCompressor(){return new f(this)}createGain(){return new h(this)}createIIRFilter(k,N){return new g(this,{feedback:N,feedforward:k})}createOscillator(){return new _(this)}createPanner(){return new y(this)}createPeriodicWave(k,N,I={disableNormalization:!1}){return new v(this,{...I,imag:N,real:k})}createStereoPanner(){return new x(this)}createWaveShaper(){return new E(this)}decodeAudioData(k,N,I){return c(this._nativeContext,k).then(D=>(typeof N=="function"&&N(D),D),D=>{throw typeof I=="function"&&I(D),D})}},Srt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Ert=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),h={...Srt,...u},g=i(f,h),p=a(f),_=p?t():null;super(c,!1,g,_),this._Q=e(this,p,g.Q,Op,wm),this._detune=e(this,p,g.detune,1200*Math.log2(Op),-1200*Math.log2(Op)),this._frequency=e(this,p,g.frequency,c.sampleRate/2,0),this._gain=e(this,p,g.gain,40*Math.log10(Op),wm),this._nativeBiquadFilterNode=g,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,f){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,f)}catch(h){throw h.code===11?r():h}if(c.length!==u.length||u.length!==f.length)throw r()}},xrt=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=sp(c,l);if(!u){const f={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,f)}return s.set(l,c),u?(await n(l,o.Q,c.Q),await n(l,o.detune,c.detune),await n(l,o.frequency,c.frequency),await n(l,o.gain,c.gain)):(await r(l,o.Q,c.Q),await r(l,o.detune,c.detune),await r(l,o.frequency,c.frequency),await r(l,o.gain,c.gain)),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},Trt=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const s=n.get(t);if(s!==void 0)return s;try{const a=r();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(o=>(n.delete(t),e.set(t,o),o))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},wrt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Rrt=(n,e,t,r,i)=>class extends n{constructor(a,o){const l=r(a),c={...wrt,...o},u=t(l,c),f=i(l)?e():null;super(a,!1,u,f)}},Art=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!sp(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},Crt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Mrt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u=s({...Crt,...l}),f=t(c,u),h=i(c)?e():null;super(o,!1,f,h)}},Ort=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!sp(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},krt=n=>(e,t,r)=>n(t,e,r),Irt=n=>(e,t,r=0,i=0)=>{const s=e[r];if(s===void 0)throw n();return YL(t)?s.connect(t,0,i):s.connect(t,0)},Nrt=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},Prt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Drt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Prt,...c},h=r(u,f),g=s(u),p=g?t():null;super(l,!1,h,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=h,this._offset=e(this,g,h.offset,Op,wm),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){kw(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),ib(this)&&Qk(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},Lrt=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null;const l=async(c,u)=>{let f=t(c);const h=sp(f,u);if(!h){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value};f=e(u,g),a!==null&&f.start(a),o!==null&&f.stop(o)}return s.set(u,f),h?await n(u,c.offset,f.offset):await r(u,c.offset,f.offset),await i(c,u,f),f};return{set start(c){a=c},set stop(c){o=c},render(c,u){const f=s.get(u);return f!==void 0?Promise.resolve(f):l(c,u)}}},Urt=n=>e=>(n[0]=e,n[0]),Brt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Frt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u={...Brt,...l},f=t(c,u),g=i(c)?e():null;super(o,!1,f,g),this._isBufferNullified=!1,this._nativeConvolverNode=f,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},zrt=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!sp(o,a)){const c={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=n(a,c)}return r.set(a,o),cR(o)?await t(s,a,o.inputs[0]):await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},jrt=(n,e)=>(t,r,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,r,i)}catch(s){throw s.name==="SyntaxError"?n():s}},Hrt=()=>new DOMException("","DataCloneError"),fre=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},qrt=(n,e,t,r,i,s,a,o,l,c,u)=>(f,h)=>{const g=a(f)?f:s(f);if(i.has(h)){const p=t();return Promise.reject(p)}try{i.add(h)}catch{}return e(l,()=>l(g))?g.decodeAudioData(h).then(p=>(fre(h).catch(()=>{}),e(o,()=>o(p))||u(p),n.add(p),p)):new Promise((p,_)=>{const y=async()=>{try{await fre(h)}catch{}},v=x=>{_(x),y()};try{g.decodeAudioData(h,x=>{typeof x.copyFromChannel!="function"&&(c(x),uV(x)),n.add(x),y().then(()=>p(x))},x=>{v(x===null?r():x)})}catch(x){v(x)}})},Vrt=(n,e,t,r,i,s,a,o)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const f=s(l.context),h=o(f);if(u===c){if(e.delete(l),!h&&a(l)){const g=r(l),{outputs:p}=t(l);for(const _ of p)if(t3(_)){const y=r(_[0]);n(g,y,_[1],_[2])}else{const y=i(_[0]);g.connect(y,_[1])}}}else e.set(l,u-c)},Grt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},$rt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Grt,...c},h=r(u,f),g=s(u),p=g?t(f.maxDelayTime):null;super(l,!1,h,p),this._delayTime=e(this,g,h.delayTime),a(this,f.maxDelayTime)}get delayTime(){return this._delayTime}},Wrt=(n,e,t,r,i)=>s=>{const a=new WeakMap,o=async(l,c)=>{let u=t(l);const f=sp(u,c);if(!f){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(c,h)}return a.set(c,u),f?await n(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=a.get(c);return u!==void 0?Promise.resolve(u):o(l,c)}}},Yrt=n=>(e,t,r,i)=>n(e[i],s=>s[0]===t&&s[1]===r),Xrt=n=>(e,t)=>{n(e).delete(t)},Krt=n=>"delayTime"in n,Zrt=(n,e,t)=>function r(i,s){const a=GL(s)?s:t(n,s);if(Krt(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(l=>r([...i,a],l[0])).reduce((l,c)=>l.concat(c),[])},CN=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},Jrt=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(s=>s.disconnect()):typeof t=="number"?CN(n,e,t).disconnect():YL(t)?r===void 0?e.forEach(s=>s.disconnect(t)):i===void 0?CN(n,e,r).disconnect(t,0):CN(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(s=>s.disconnect(t)):CN(n,e,r).disconnect(t,0),Qrt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},eit=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),h={...Qrt,...u},g=r(f,h),p=a(f),_=p?t():null;super(c,!1,g,_),this._attack=e(this,p,g.attack),this._knee=e(this,p,g.knee),this._nativeDynamicsCompressorNode=g,this._ratio=e(this,p,g.ratio),this._release=e(this,p,g.release),this._threshold=e(this,p,g.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},tit=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=sp(c,l);if(!u){const f={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,f)}return s.set(l,c),u?(await n(l,o.attack,c.attack),await n(l,o.knee,c.knee),await n(l,o.ratio,c.ratio),await n(l,o.release,c.release),await n(l,o.threshold,c.threshold)):(await r(l,o.attack,c.attack),await r(l,o.knee,c.knee),await r(l,o.ratio,c.ratio),await r(l,o.release,c.release),await r(l,o.threshold,c.threshold)),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},nit=()=>new DOMException("","EncodingError"),rit=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const s=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),l=n.onerror,c=()=>{n.onerror=l,URL.revokeObjectURL(o)};n.onerror=(u,f,h,g,p)=>{if(f===o||f===n.location.href&&h===1&&g===1)return c(),r(p),!1;if(l!==null)return l(u,f,h,g,p)},s.onerror=()=>{c(),r(new SyntaxError)},s.onload=()=>{c(),t()},s.src=o,s.type="module",i.appendChild(s)}}),iit=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=n(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(t,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,s===void 0?null:s,i)}},sit=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},ait=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},oit={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},lit=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...oit,...l},f=r(c,u),h=s(c),g=h?t():null;super(o,!1,f,g),this._gain=e(this,h,f.gain,Op,wm)}get gain(){return this._gain}},cit=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=sp(c,l);if(!u){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,f)}return s.set(l,c),u?await n(l,o.gain,c.gain):await r(l,o.gain,c.gain),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},uit=(n,e)=>t=>e(n,t),fit=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},hit=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},dit=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},pit=n=>e=>n.get(e),Dh=()=>new DOMException("","InvalidStateError"),mit=n=>e=>{const t=n.get(e);if(t===void 0)throw Dh();return t},git=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},_it=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},a6=()=>new DOMException("","InvalidAccessError"),vit=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw a6();return e.call(n,t,r,i)})(n.getFrequencyResponse)},yit={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},bit=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u=i(c),f={...yit,...l},h=e(c,u?null:o.baseLatency,f),g=u?t(f.feedback,f.feedforward):null;super(o,!1,h,g),vit(h),this._nativeIIRFilterNode=h,s(this,1)}getFrequencyResponse(o,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(o,l,c)}},l_e=(n,e,t,r,i,s,a,o,l,c,u)=>{const f=c.length;let h=o;for(let g=0;g<f;g+=1){let p=t[0]*c[g];for(let _=1;_<i;_+=1){const y=h-_&l-1;p+=t[_]*s[y],p-=n[_]*a[y]}for(let _=i;_<r;_+=1)p+=t[_]*s[h-_&l-1];for(let _=i;_<e;_+=1)p-=n[_]*a[h-_&l-1];s[h]=c[g],a[h]=p,h=h+1&l-1,u[g]=p}return h},Sit=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),s=r instanceof Float64Array?r:new Float64Array(r),a=i.length,o=s.length,l=Math.min(a,o);if(i[0]!==1){for(let p=0;p<a;p+=1)s[p]/=i[0];for(let p=1;p<o;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),f=new Float32Array(c),h=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),g=n.numberOfChannels;for(let p=0;p<g;p+=1){const _=n.getChannelData(p),y=h.getChannelData(p);u.fill(0),f.fill(0),l_e(i,a,s,o,l,u,f,0,c,_,y)}return h},Eit=(n,e,t,r,i)=>(s,a)=>{const o=new WeakMap;let l=null;const c=async(u,f)=>{let h=null,g=e(u);const p=sp(g,f);if(f.createIIRFilter===void 0?h=n(f,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(g=f.createIIRFilter(a,s)),o.set(f,h===null?g:h),h!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new t(u.context.destination.channelCount,u.context.length,f.sampleRate);l=(async()=>{await r(u,y,y.destination);const v=await i(y);return Sit(v,f,s,a)})()}const _=await l;return h.buffer=_,h.start(0),h}return await r(u,f,g),g};return{render(u,f){const h=o.get(f);return h!==void 0?Promise.resolve(h):c(u,f)}}},xit=(n,e,t,r,i,s)=>a=>(o,l)=>{const c=n.get(o);if(c===void 0){if(!a&&s(o)){const u=r(o),{outputs:f}=t(o);for(const h of f)if(t3(h)){const g=r(h[0]);e(u,g,h[1],h[2])}else{const g=i(h[0]);u.disconnect(g,h[1])}}n.set(o,l)}else n.set(o,c+l)},Tit=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},wit=(n,e)=>t=>n.has(t)||e(t),Rit=(n,e)=>t=>n.has(t)||e(t),Ait=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},Cit=n=>e=>n!==null&&e instanceof n,Mit=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,Oit=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,kit=(n,e)=>t=>n(t)||e(t),Iit=n=>e=>n!==null&&e instanceof n,Nit=n=>n!==null&&n.isSecureContext,Pit=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s),l=e(o,a);if(r(o))throw TypeError();super(s,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Dit={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Lit=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s);if(r(o))throw new TypeError;const l={...Dit,...a},c=e(o,l);super(s,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Uit=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s),l=e(o,a);if(r(o))throw new TypeError;super(s,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Bit=(n,e,t)=>class extends n{constructor(i,s){const a=t(i),o=e(a,s);super(i,!0,o,null)}},Fit=(n,e,t,r,i,s)=>class extends t{constructor(o,l){super(o),this._nativeContext=o,i6.set(this,o),r(o)&&i.set(o,new Set),this._destination=new n(this,l),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const l=typeof o=="function"?s(this,o):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?o:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},JO=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},zit=(n,e)=>(t,r,i)=>{const s=new Set;return t.connect=(a=>(o,l=0,c=0)=>{const u=s.size===0;if(e(o))return a.call(t,o,l,c),n(s,[o,l,c],f=>f[0]===o&&f[1]===l&&f[2]===c,!0),u&&r(),o;a.call(t,o,l),n(s,[o,l],f=>f[0]===o&&f[1]===l,!0),u&&r()})(t.connect),t.disconnect=(a=>(o,l,c)=>{const u=s.size>0;if(o===void 0)a.apply(t),s.clear();else if(typeof o=="number"){a.call(t,o);for(const h of s)h[1]===o&&s.delete(h)}else{e(o)?a.call(t,o,l,c):a.call(t,o,l);for(const h of s)h[0]===o&&(l===void 0||h[1]===l)&&(c===void 0||h[2]===c)&&s.delete(h)}const f=s.size===0;u&&f&&i()})(t.disconnect),t},Tc=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},th=(n,e)=>{Tc(n,e,"channelCount"),Tc(n,e,"channelCountMode"),Tc(n,e,"channelInterpretation")},hre=n=>typeof n.getFloatTimeDomainData=="function",jit=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},Hit=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(th(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Tc(i,r,"fftSize"),Tc(i,r,"maxDecibels"),Tc(i,r,"minDecibels"),Tc(i,r,"smoothingTimeConstant"),n(hre,()=>hre(i))||jit(i),i},qit=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,vu=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},Vit=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,s)=>{if(t)throw Dh();e.call(n,r,i,s),t=!0}})(n.start)},dV=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},pV=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},Git=(n,e,t,r,i,s,a,o,l,c,u)=>(f,h)=>{const g=f.createBufferSource();return th(g,h),vu(g,h,"playbackRate"),Tc(g,h,"buffer"),Tc(g,h,"loop"),Tc(g,h,"loopEnd"),Tc(g,h,"loopStart"),e(t,()=>t(f))||Vit(g),e(r,()=>r(f))||l(g),e(i,()=>i(f))||c(g,f),e(s,()=>s(f))||dV(g),e(a,()=>a(f))||u(g,f),e(o,()=>o(f))||pV(g),n(f,g),g},$it=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,Wit=(n,e)=>(t,r,i)=>{const s=t.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const a=n(t,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>l=>{o.call(a,l);try{s.channelCount=l}catch(c){if(l>s.maxChannelCount)throw c}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>l=>{o.call(a,l),s.channelCountMode=l}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>l=>{o.call(a,l),s.channelInterpretation=l}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},Yit=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,Xit=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},Kit=(n,e,t,r,i)=>(s,a,o,l,c,u)=>{if(o!==null)try{const f=new o(s,l,u),h=new Map;let g=null;if(Object.defineProperties(f,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>g,set:p=>{typeof g=="function"&&f.removeEventListener("processorerror",g),g=typeof p=="function"?p:null,typeof g=="function"&&f.addEventListener("processorerror",g)}}}),f.addEventListener=(p=>(..._)=>{if(_[0]==="processorerror"){const y=typeof _[1]=="function"?_[1]:typeof _[1]=="object"&&_[1]!==null&&typeof _[1].handleEvent=="function"?_[1].handleEvent:null;if(y!==null){const v=h.get(_[1]);v!==void 0?_[1]=v:(_[1]=x=>{x.type==="error"?(Object.defineProperties(x,{type:{value:"processorerror"}}),y(x)):y(new ErrorEvent(_[0],{...x}))},h.set(y,_[1]))}}return p.call(f,"error",_[1],_[2]),p.call(f,..._)})(f.addEventListener),f.removeEventListener=(p=>(..._)=>{if(_[0]==="processorerror"){const y=h.get(_[1]);y!==void 0&&(h.delete(_[1]),_[1]=y)}return p.call(f,"error",_[1],_[2]),p.call(f,_[0],_[1],_[2])})(f.removeEventListener),u.numberOfOutputs!==0){const p=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return f.connect(p).connect(s.destination),i(f,()=>p.disconnect(),()=>p.connect(s.destination))}return f}catch(f){throw f.code===11?r():f}if(c===void 0)throw r();return Xit(u),e(s,a,c,u)},c_e=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),Zit=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),t(s)},i.postMessage(n)}),Jit=async(n,e)=>{const t=await Zit(e);return new n(t)},Qit=(n,e,t,r)=>{let i=mz.get(n);i===void 0&&(i=new WeakMap,mz.set(n,i));const s=Jit(t,r);return i.set(e,s),s},est=(n,e,t,r,i,s,a,o,l,c,u,f,h)=>(g,p,_,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw l();const v=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(v.some(Ue=>Ue<1))throw l();if(v.length!==y.numberOfOutputs)throw e();if(y.channelCountMode!=="explicit")throw l();const x=y.channelCount*y.numberOfInputs,E=v.reduce((Ue,Ge)=>Ue+Ge,0),M=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length;if(x+M>6||E>6)throw l();const k=new MessageChannel,N=[],I=[];for(let Ue=0;Ue<y.numberOfInputs;Ue+=1)N.push(a(g,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),I.push(i(g,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const D=[];if(_.parameterDescriptors!==void 0)for(const{defaultValue:Ue,maxValue:Ge,minValue:ze,name:Be}of _.parameterDescriptors){const me=s(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[Be]!==void 0?y.parameterData[Be]:Ue===void 0?0:Ue});Object.defineProperties(me.offset,{defaultValue:{get:()=>Ue===void 0?0:Ue},maxValue:{get:()=>Ge===void 0?Op:Ge},minValue:{get:()=>ze===void 0?wm:ze}}),D.push(me)}const V=r(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+M)}),G=c_e(p,g.sampleRate),J=o(g,G,x+M,Math.max(1,E)),B=i(g,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),$=[];for(let Ue=0;Ue<y.numberOfOutputs;Ue+=1)$.push(r(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[Ue]}));for(let Ue=0;Ue<y.numberOfInputs;Ue+=1){N[Ue].connect(I[Ue]);for(let Ge=0;Ge<y.channelCount;Ge+=1)I[Ue].connect(V,Ge,Ue*y.channelCount+Ge)}const U=new a_e(_.parameterDescriptors===void 0?[]:_.parameterDescriptors.map(({name:Ue},Ge)=>{const ze=D[Ge];return ze.connect(V,0,x+Ge),ze.start(0),[Ue,ze.offset]}));V.connect(J);let Q=y.channelInterpretation,W=null;const q=y.numberOfOutputs===0?[J]:$,Y={get bufferSize(){return G},get channelCount(){return y.channelCount},set channelCount(Ue){throw t()},get channelCountMode(){return y.channelCountMode},set channelCountMode(Ue){throw t()},get channelInterpretation(){return Q},set channelInterpretation(Ue){for(const Ge of N)Ge.channelInterpretation=Ue;Q=Ue},get context(){return J.context},get inputs(){return N},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return W},set onprocessorerror(Ue){typeof W=="function"&&Y.removeEventListener("processorerror",W),W=typeof Ue=="function"?Ue:null,typeof W=="function"&&Y.addEventListener("processorerror",W)},get parameters(){return U},get port(){return k.port2},addEventListener(...Ue){return J.addEventListener(Ue[0],Ue[1],Ue[2])},connect:n.bind(null,q),disconnect:c.bind(null,q),dispatchEvent(...Ue){return J.dispatchEvent(Ue[0])},removeEventListener(...Ue){return J.removeEventListener(Ue[0],Ue[1],Ue[2])}},ae=new Map;k.port1.addEventListener=(Ue=>(...Ge)=>{if(Ge[0]==="message"){const ze=typeof Ge[1]=="function"?Ge[1]:typeof Ge[1]=="object"&&Ge[1]!==null&&typeof Ge[1].handleEvent=="function"?Ge[1].handleEvent:null;if(ze!==null){const Be=ae.get(Ge[1]);Be!==void 0?Ge[1]=Be:(Ge[1]=me=>{u(g.currentTime,g.sampleRate,()=>ze(me))},ae.set(ze,Ge[1]))}}return Ue.call(k.port1,Ge[0],Ge[1],Ge[2])})(k.port1.addEventListener),k.port1.removeEventListener=(Ue=>(...Ge)=>{if(Ge[0]==="message"){const ze=ae.get(Ge[1]);ze!==void 0&&(ae.delete(Ge[1]),Ge[1]=ze)}return Ue.call(k.port1,Ge[0],Ge[1],Ge[2])})(k.port1.removeEventListener);let Z=null;Object.defineProperty(k.port1,"onmessage",{get:()=>Z,set:Ue=>{typeof Z=="function"&&k.port1.removeEventListener("message",Z),Z=typeof Ue=="function"?Ue:null,typeof Z=="function"&&(k.port1.addEventListener("message",Z),k.port1.start())}}),_.prototype.port=k.port1;let K=null;Qit(g,Y,_,y).then(Ue=>K=Ue);const le=KL(y.numberOfInputs,y.channelCount),ce=KL(y.numberOfOutputs,v),de=_.parameterDescriptors===void 0?[]:_.parameterDescriptors.reduce((Ue,{name:Ge})=>({...Ue,[Ge]:new Float32Array(128)}),{});let Me=!0;const qe=()=>{y.numberOfOutputs>0&&J.disconnect(B);for(let Ue=0,Ge=0;Ue<y.numberOfOutputs;Ue+=1){const ze=$[Ue];for(let Be=0;Be<v[Ue];Be+=1)B.disconnect(ze,Ge+Be,Be);Ge+=v[Ue]}},Ne=new Map;J.onaudioprocess=({inputBuffer:Ue,outputBuffer:Ge})=>{if(K!==null){const ze=f(Y);for(let Be=0;Be<G;Be+=128){for(let me=0;me<y.numberOfInputs;me+=1)for(let Se=0;Se<y.channelCount;Se+=1)XL(Ue,le[me],Se,Se,Be);_.parameterDescriptors!==void 0&&_.parameterDescriptors.forEach(({name:me},Se)=>{XL(Ue,de,me,x+Se,Be)});for(let me=0;me<y.numberOfInputs;me+=1)for(let Se=0;Se<v[me];Se+=1)ce[me][Se].byteLength===0&&(ce[me][Se]=new Float32Array(128));try{const me=le.map((ke,be)=>{if(ze[be].size>0)return Ne.set(be,G/128),ke;const ot=Ne.get(be);return ot===void 0?[]:(ke.every(lt=>lt.every(ct=>ct===0))&&(ot===1?Ne.delete(be):Ne.set(be,ot-1)),ke)});Me=u(g.currentTime+Be/g.sampleRate,g.sampleRate,()=>K.process(me,ce,de));for(let ke=0,be=0;ke<y.numberOfOutputs;ke+=1){for(let Ke=0;Ke<v[ke];Ke+=1)o_e(Ge,ce[ke],Ke,be+Ke,Be);be+=v[ke]}}catch(me){Me=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:me.colno,filename:me.filename,lineno:me.lineno,message:me.message}))}if(!Me){for(let me=0;me<y.numberOfInputs;me+=1){N[me].disconnect(I[me]);for(let Se=0;Se<y.channelCount;Se+=1)I[Be].disconnect(V,Se,me*y.channelCount+Se)}if(_.parameterDescriptors!==void 0){const me=_.parameterDescriptors.length;for(let Se=0;Se<me;Se+=1){const ke=D[Se];ke.disconnect(V,0,x+Se),ke.stop()}}V.disconnect(J),J.onaudioprocess=null,Ae?qe():at();break}}}};let Ae=!1;const Xe=a(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$e=()=>J.connect(Xe).connect(g.destination),at=()=>{J.disconnect(Xe),Xe.disconnect()},pt=()=>{if(Me){at(),y.numberOfOutputs>0&&J.connect(B);for(let Ue=0,Ge=0;Ue<y.numberOfOutputs;Ue+=1){const ze=$[Ue];for(let Be=0;Be<v[Ue];Be+=1)B.connect(ze,Ge+Be,Be);Ge+=v[Ue]}}Ae=!0},oe=()=>{Me&&($e(),qe()),Ae=!1};return $e(),h(Y,pt,oe)},u_e=(n,e)=>{const t=n.createBiquadFilter();return th(t,e),vu(t,e,"Q"),vu(t,e,"detune"),vu(t,e,"frequency"),vu(t,e,"gain"),Tc(t,e,"type"),t},tst=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),th(i,r),i},nst=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Dh()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Dh()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Dh()}})},n3=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return th(t,e),nst(t),t},rst=(n,e,t,r,i)=>(s,a)=>{if(s.createConstantSource===void 0)return t(s,a);const o=s.createConstantSource();return th(o,a),vu(o,a,"offset"),e(r,()=>r(s))||dV(o),e(i,()=>i(s))||pV(o),n(s,o),o},uR=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),ist=(n,e,t,r)=>(i,{offset:s,...a})=>{const o=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t(i,{...a,gain:s}),u=o.getChannelData(0);u[0]=1,u[1]=1,l.buffer=o,l.loop=!0;const f={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},h=()=>l.connect(c),g=()=>l.disconnect(c);return n(i,l),r(uR(f,c),h,g)},sst=(n,e)=>(t,r)=>{const i=t.createConvolver();if(th(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Tc(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>a=>{if(a>2)throw n();return s.call(i,a)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",s=>()=>s.call(i),s=>a=>{if(a==="max")throw n();return s.call(i,a)}),i},f_e=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return th(t,e),vu(t,e,"delayTime"),t},ast=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(th(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return vu(r,t,"attack"),vu(r,t,"knee"),vu(r,t,"ratio"),vu(r,t,"release"),vu(r,t,"threshold"),r},$m=(n,e)=>{const t=n.createGain();return th(t,e),vu(t,e,"gain"),t},ost=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return th(i,r),i};function lst(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function cst(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function dre(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=cst(t,e),t[0]+=n[r];return t}const ust=(n,e,t,r)=>(i,s,{channelCount:a,channelCountMode:o,channelInterpretation:l,feedback:c,feedforward:u})=>{const f=c_e(s,i.sampleRate),h=c instanceof Float64Array?c:new Float64Array(c),g=u instanceof Float64Array?u:new Float64Array(u),p=h.length,_=g.length,y=Math.min(p,_);if(p===0||p>20)throw r();if(h[0]===0)throw e();if(_===0||_>20)throw r();if(g[0]===0)throw e();if(h[0]!==1){for(let D=0;D<_;D+=1)g[D]/=h[0];for(let D=1;D<p;D+=1)h[D]/=h[0]}const v=t(i,f,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=l;const x=32,E=[],M=[],k=[];for(let D=0;D<a;D+=1){E.push(0);const V=new Float32Array(x),G=new Float32Array(x);V.fill(0),G.fill(0),M.push(V),k.push(G)}v.onaudioprocess=D=>{const V=D.inputBuffer,G=D.outputBuffer,J=V.numberOfChannels;for(let B=0;B<J;B+=1){const $=V.getChannelData(B),U=G.getChannelData(B);E[B]=l_e(h,p,g,_,y,M[B],k[B],E[B],x,$,U)}};const N=i.sampleRate/2;return uR({get bufferSize(){return f},get channelCount(){return v.channelCount},set channelCount(D){v.channelCount=D},get channelCountMode(){return v.channelCountMode},set channelCountMode(D){v.channelCountMode=D},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(D){v.channelInterpretation=D},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...D){return v.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return v.dispatchEvent(D[0])},getFrequencyResponse(D,V,G){if(D.length!==V.length||V.length!==G.length)throw n();const J=D.length;for(let B=0;B<J;B+=1){const $=-Math.PI*(D[B]/N),U=[Math.cos($),Math.sin($)],Q=dre(g,U),W=dre(h,U),q=lst(Q,W);V[B]=Math.sqrt(q[0]*q[0]+q[1]*q[1]),G[B]=Math.atan2(q[1],q[0])}},removeEventListener(...D){return v.removeEventListener(D[0],D[1],D[2])}},v)},fst=(n,e)=>n.createMediaElementSource(e.mediaElement),hst=(n,e)=>{const t=n.createMediaStreamDestination();return th(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},dst=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},pst=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return s},mst=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,gst=(n,e,t,r,i,s)=>(a,o)=>{const l=a.createOscillator();return th(l,o),vu(l,o,"detune"),vu(l,o,"frequency"),o.periodicWave!==void 0?l.setPeriodicWave(o.periodicWave):Tc(l,o,"type"),e(t,()=>t(a))||dV(l),e(r,()=>r(a))||s(l,a),e(i,()=>i(a))||pV(l),n(a,l),l},_st=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(th(r,t),vu(r,t,"orientationX"),vu(r,t,"orientationY"),vu(r,t,"orientationZ"),vu(r,t,"positionX"),vu(r,t,"positionY"),vu(r,t,"positionZ"),Tc(r,t,"coneInnerAngle"),Tc(r,t,"coneOuterAngle"),Tc(r,t,"coneOuterGain"),Tc(r,t,"distanceModel"),Tc(r,t,"maxDistance"),Tc(r,t,"panningModel"),Tc(r,t,"refDistance"),Tc(r,t,"rolloffFactor"),r)},vst=(n,e,t,r,i,s,a,o,l,c)=>(u,{coneInnerAngle:f,coneOuterAngle:h,coneOuterGain:g,distanceModel:p,maxDistance:_,orientationX:y,orientationY:v,orientationZ:x,panningModel:E,positionX:M,positionY:k,positionZ:N,refDistance:I,rolloffFactor:D,...V})=>{const G=u.createPanner();if(V.channelCount>2||V.channelCountMode==="max")throw a();th(G,V);const J={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},B=t(u,{...J,channelInterpretation:"speakers",numberOfInputs:6}),$=r(u,{...V,gain:1}),U=r(u,{...J,gain:1}),Q=r(u,{...J,gain:0}),W=r(u,{...J,gain:0}),q=r(u,{...J,gain:0}),Y=r(u,{...J,gain:0}),ae=r(u,{...J,gain:0}),Z=i(u,256,6,1),K=s(u,{...J,curve:new Float32Array([1,1]),oversample:"none"});let ne=[y,v,x],le=[M,k,N];const ce=new Float32Array(1);Z.onaudioprocess=({inputBuffer:Ne})=>{const Ae=[l(Ne,ce,0),l(Ne,ce,1),l(Ne,ce,2)];Ae.some(($e,at)=>$e!==ne[at])&&(G.setOrientation(...Ae),ne=Ae);const Xe=[l(Ne,ce,3),l(Ne,ce,4),l(Ne,ce,5)];Xe.some(($e,at)=>$e!==le[at])&&(G.setPosition(...Xe),le=Xe)},Object.defineProperty(Q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ae.gain,"defaultValue",{get:()=>0});const de={get bufferSize(){},get channelCount(){return G.channelCount},set channelCount(Ne){if(Ne>2)throw a();$.channelCount=Ne,G.channelCount=Ne},get channelCountMode(){return G.channelCountMode},set channelCountMode(Ne){if(Ne==="max")throw a();$.channelCountMode=Ne,G.channelCountMode=Ne},get channelInterpretation(){return G.channelInterpretation},set channelInterpretation(Ne){$.channelInterpretation=Ne,G.channelInterpretation=Ne},get coneInnerAngle(){return G.coneInnerAngle},set coneInnerAngle(Ne){G.coneInnerAngle=Ne},get coneOuterAngle(){return G.coneOuterAngle},set coneOuterAngle(Ne){G.coneOuterAngle=Ne},get coneOuterGain(){return G.coneOuterGain},set coneOuterGain(Ne){if(Ne<0||Ne>1)throw e();G.coneOuterGain=Ne},get context(){return G.context},get distanceModel(){return G.distanceModel},set distanceModel(Ne){G.distanceModel=Ne},get inputs(){return[$]},get maxDistance(){return G.maxDistance},set maxDistance(Ne){if(Ne<0)throw new RangeError;G.maxDistance=Ne},get numberOfInputs(){return G.numberOfInputs},get numberOfOutputs(){return G.numberOfOutputs},get orientationX(){return U.gain},get orientationY(){return Q.gain},get orientationZ(){return W.gain},get panningModel(){return G.panningModel},set panningModel(Ne){G.panningModel=Ne},get positionX(){return q.gain},get positionY(){return Y.gain},get positionZ(){return ae.gain},get refDistance(){return G.refDistance},set refDistance(Ne){if(Ne<0)throw new RangeError;G.refDistance=Ne},get rolloffFactor(){return G.rolloffFactor},set rolloffFactor(Ne){if(Ne<0)throw new RangeError;G.rolloffFactor=Ne},addEventListener(...Ne){return $.addEventListener(Ne[0],Ne[1],Ne[2])},dispatchEvent(...Ne){return $.dispatchEvent(Ne[0])},removeEventListener(...Ne){return $.removeEventListener(Ne[0],Ne[1],Ne[2])}};f!==de.coneInnerAngle&&(de.coneInnerAngle=f),h!==de.coneOuterAngle&&(de.coneOuterAngle=h),g!==de.coneOuterGain&&(de.coneOuterGain=g),p!==de.distanceModel&&(de.distanceModel=p),_!==de.maxDistance&&(de.maxDistance=_),y!==de.orientationX.value&&(de.orientationX.value=y),v!==de.orientationY.value&&(de.orientationY.value=v),x!==de.orientationZ.value&&(de.orientationZ.value=x),E!==de.panningModel&&(de.panningModel=E),M!==de.positionX.value&&(de.positionX.value=M),k!==de.positionY.value&&(de.positionY.value=k),N!==de.positionZ.value&&(de.positionZ.value=N),I!==de.refDistance&&(de.refDistance=I),D!==de.rolloffFactor&&(de.rolloffFactor=D),(ne[0]!==1||ne[1]!==0||ne[2]!==0)&&G.setOrientation(...ne),(le[0]!==0||le[1]!==0||le[2]!==0)&&G.setPosition(...le);const Me=()=>{$.connect(G),n($,K,0,0),K.connect(U).connect(B,0,0),K.connect(Q).connect(B,0,1),K.connect(W).connect(B,0,2),K.connect(q).connect(B,0,3),K.connect(Y).connect(B,0,4),K.connect(ae).connect(B,0,5),B.connect(Z).connect(u.destination)},qe=()=>{$.disconnect(G),o($,K,0,0),K.disconnect(U),U.disconnect(B),K.disconnect(Q),Q.disconnect(B),K.disconnect(W),W.disconnect(B),K.disconnect(q),q.disconnect(B),K.disconnect(Y),Y.disconnect(B),K.disconnect(ae),ae.disconnect(B),B.disconnect(Z),Z.disconnect(u.destination)};return c(uR(de,G),Me,qe)},yst=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),a=i instanceof Float32Array?i:new Float32Array(i),o=e.createPeriodicWave(a,s,{disableNormalization:t});if(Array.from(r).length<2)throw n();return o},r3=(n,e,t,r)=>n.createScriptProcessor(e,t,r),bst=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const s=t.createStereoPanner();return th(s,r),vu(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),s},Sst=(n,e,t,r,i,s)=>{const o=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},f=(p,_,y,v)=>{const x=new Float32Array(16385),E=new Float32Array(16385);for(let V=0;V<16385;V+=1){const G=V/16384*l;x[V]=Math.cos(G),E[V]=Math.sin(G)}const M=t(p,{...c,gain:0}),k=r(p,{...u,curve:x}),N=r(p,{...u,curve:o}),I=t(p,{...c,gain:0}),D=r(p,{...u,curve:E});return{connectGraph(){_.connect(M),_.connect(N.inputs===void 0?N:N.inputs[0]),_.connect(I),N.connect(y),y.connect(k.inputs===void 0?k:k.inputs[0]),y.connect(D.inputs===void 0?D:D.inputs[0]),k.connect(M.gain),D.connect(I.gain),M.connect(v,0,0),I.connect(v,0,1)},disconnectGraph(){_.disconnect(M),_.disconnect(N.inputs===void 0?N:N.inputs[0]),_.disconnect(I),N.disconnect(y),y.disconnect(k.inputs===void 0?k:k.inputs[0]),y.disconnect(D.inputs===void 0?D:D.inputs[0]),k.disconnect(M.gain),D.disconnect(I.gain),M.disconnect(v,0,0),I.disconnect(v,0,1)}}},h=(p,_,y,v)=>{const x=new Float32Array(16385),E=new Float32Array(16385),M=new Float32Array(16385),k=new Float32Array(16385),N=Math.floor(16385/2);for(let q=0;q<16385;q+=1)if(q>N){const Y=(q-N)/(16384-N)*l;x[q]=Math.cos(Y),E[q]=Math.sin(Y),M[q]=0,k[q]=1}else{const Y=q/(16384-N)*l;x[q]=1,E[q]=0,M[q]=Math.cos(Y),k[q]=Math.sin(Y)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),D=t(p,{...c,gain:0}),V=r(p,{...u,curve:x}),G=t(p,{...c,gain:0}),J=r(p,{...u,curve:E}),B=r(p,{...u,curve:o}),$=t(p,{...c,gain:0}),U=r(p,{...u,curve:M}),Q=t(p,{...c,gain:0}),W=r(p,{...u,curve:k});return{connectGraph(){_.connect(I),_.connect(B.inputs===void 0?B:B.inputs[0]),I.connect(D,0),I.connect(G,0),I.connect($,1),I.connect(Q,1),B.connect(y),y.connect(V.inputs===void 0?V:V.inputs[0]),y.connect(J.inputs===void 0?J:J.inputs[0]),y.connect(U.inputs===void 0?U:U.inputs[0]),y.connect(W.inputs===void 0?W:W.inputs[0]),V.connect(D.gain),J.connect(G.gain),U.connect($.gain),W.connect(Q.gain),D.connect(v,0,0),$.connect(v,0,0),G.connect(v,0,1),Q.connect(v,0,1)},disconnectGraph(){_.disconnect(I),_.disconnect(B.inputs===void 0?B:B.inputs[0]),I.disconnect(D,0),I.disconnect(G,0),I.disconnect($,1),I.disconnect(Q,1),B.disconnect(y),y.disconnect(V.inputs===void 0?V:V.inputs[0]),y.disconnect(J.inputs===void 0?J:J.inputs[0]),y.disconnect(U.inputs===void 0?U:U.inputs[0]),y.disconnect(W.inputs===void 0?W:W.inputs[0]),V.disconnect(D.gain),J.disconnect(G.gain),U.disconnect($.gain),W.disconnect(Q.gain),D.disconnect(v,0,0),$.disconnect(v,0,0),G.disconnect(v,0,1),Q.disconnect(v,0,1)}}},g=(p,_,y,v,x)=>{if(_===1)return f(p,y,v,x);if(_===2)return h(p,y,v,x);throw i()};return(p,{channelCount:_,channelCountMode:y,pan:v,...x})=>{if(y==="max")throw i();const E=n(p,{...x,channelCount:1,channelCountMode:y,numberOfInputs:2}),M=t(p,{...x,channelCount:_,channelCountMode:y,gain:1}),k=t(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:N,disconnectGraph:I}=g(p,_,M,k,E);Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"maxValue",{get:()=>1}),Object.defineProperty(k.gain,"minValue",{get:()=>-1});const D={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(B){M.channelCount!==B&&(V&&I(),{connectGraph:N,disconnectGraph:I}=g(p,B,M,k,E),V&&N()),M.channelCount=B},get channelCountMode(){return M.channelCountMode},set channelCountMode(B){if(B==="clamped-max"||B==="max")throw i();M.channelCountMode=B},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(B){M.channelInterpretation=B},get context(){return M.context},get inputs(){return[M]},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get pan(){return k.gain},addEventListener(...B){return M.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return M.dispatchEvent(B[0])},removeEventListener(...B){return M.removeEventListener(B[0],B[1],B[2])}};let V=!1;const G=()=>{N(),V=!0},J=()=>{I(),V=!1};return s(uR(D,E),G,J)}},Est=(n,e,t,r,i,s,a)=>(o,l)=>{const c=o.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return t(o,l);th(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();Tc(c,{curve:u},"curve"),Tc(c,l,"oversample");let f=null,h=!1;return a(c,"curve",_=>()=>_.call(c),_=>y=>(_.call(c,y),h&&(r(y)&&f===null?f=n(o,c):!r(y)&&f!==null&&(f(),f=null)),y)),i(c,()=>{h=!0,r(c.curve)&&(f=n(o,c))},()=>{h=!1,f!==null&&(f(),f=null)})},xst=(n,e,t,r,i)=>(s,{curve:a,oversample:o,...l})=>{const c=s.createWaveShaper(),u=s.createWaveShaper();th(c,l),th(u,l);const f=t(s,{...l,gain:1}),h=t(s,{...l,gain:-1}),g=t(s,{...l,gain:1}),p=t(s,{...l,gain:-1});let _=null,y=!1,v=null;const x={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(k){f.channelCount=k,h.channelCount=k,c.channelCount=k,g.channelCount=k,u.channelCount=k,p.channelCount=k},get channelCountMode(){return c.channelCountMode},set channelCountMode(k){f.channelCountMode=k,h.channelCountMode=k,c.channelCountMode=k,g.channelCountMode=k,u.channelCountMode=k,p.channelCountMode=k},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(k){f.channelInterpretation=k,h.channelInterpretation=k,c.channelInterpretation=k,g.channelInterpretation=k,u.channelInterpretation=k,p.channelInterpretation=k},get context(){return c.context},get curve(){return v},set curve(k){if(k!==null&&k.length<2)throw e();if(k===null)c.curve=k,u.curve=k;else{const N=k.length,I=new Float32Array(N+2-N%2),D=new Float32Array(N+2-N%2);I[0]=k[0],D[0]=-k[N-1];const V=Math.ceil((N+1)/2),G=(N+1)/2-1;for(let J=1;J<V;J+=1){const B=J/V*G,$=Math.floor(B),U=Math.ceil(B);I[J]=$===U?k[$]:(1-(B-$))*k[$]+(1-(U-B))*k[U],D[J]=$===U?-k[N-1-$]:-((1-(B-$))*k[N-1-$])-(1-(U-B))*k[N-1-U]}I[V]=N%2===1?k[V-1]:(k[V-2]+k[V-1])/2,c.curve=I,u.curve=D}v=k,y&&(r(v)&&_===null?_=n(s,f):_!==null&&(_(),_=null))},get inputs(){return[f]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(k){c.oversample=k,u.oversample=k},addEventListener(...k){return f.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return f.dispatchEvent(k[0])},removeEventListener(...k){return f.removeEventListener(k[0],k[1],k[2])}};a!==null&&(x.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==x.oversample&&(x.oversample=o);const E=()=>{f.connect(c).connect(g),f.connect(h).connect(u).connect(p).connect(g),y=!0,r(v)&&(_=n(s,f))},M=()=>{f.disconnect(c),c.disconnect(g),f.disconnect(h),h.disconnect(u),u.disconnect(p),p.disconnect(g),y=!1,_!==null&&(_(),_=null)};return i(uR(x,g),E,M)},Gp=()=>new DOMException("","NotSupportedError"),Tst={numberOfChannels:1},wst=(n,e,t,r,i)=>class extends n{constructor(a,o,l){let c;if(typeof a=="number"&&o!==void 0&&l!==void 0)c={length:o,numberOfChannels:a,sampleRate:l};else if(typeof a=="object")c=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:f,sampleRate:h}={...Tst,...c},g=r(f,u,h);e(JO,()=>JO(g))||g.addEventListener("statechange",(()=>{let p=0;const _=y=>{this._state==="running"&&(p>0?(g.removeEventListener("statechange",_),y.stopImmediatePropagation(),this._waitForThePromiseToSettle(y)):p+=1)};return _})()),super(g,f),this._length=u,this._nativeOfflineAudioContext=g,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,n_e(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},Rst={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Ast=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Rst,...c},h=t(u,f),g=s(u),p=g?r():null,_=l.sampleRate/2;super(l,!1,h,p),this._detune=e(this,g,h.detune,153600,-153600),this._frequency=e(this,g,h.frequency,_,-_),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&f.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=f.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){kw(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),ib(this)&&Qk(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},Cst=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null,l=null;const c=async(u,f)=>{let h=t(u);const g=sp(h,f);if(!g){const p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:a===null?void 0:a,type:h.type};h=e(f,p),o!==null&&h.start(o),l!==null&&h.stop(l)}return s.set(f,h),g?(await n(f,u.detune,h.detune),await n(f,u.frequency,h.frequency)):(await r(f,u.detune,h.detune),await r(f,u.frequency,h.frequency)),await i(u,f,h),h};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){l=u},render(u,f){const h=s.get(f);return h!==void 0?Promise.resolve(h):c(u,f)}}},Mst={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Ost=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Mst,...c},h=t(u,f),g=s(u),p=g?r():null;super(l,!1,h,p),this._nativePannerNode=h,this._orientationX=e(this,g,h.orientationX,Op,wm),this._orientationY=e(this,g,h.orientationY,Op,wm),this._orientationZ=e(this,g,h.orientationZ,Op,wm),this._positionX=e(this,g,h.positionX,Op,wm),this._positionY=e(this,g,h.positionY,Op,wm),this._positionZ=e(this,g,h.positionZ,Op,wm),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},kst=(n,e,t,r,i,s,a,o,l,c)=>()=>{const u=new WeakMap;let f=null;const h=async(g,p)=>{let _=null,y=s(g);const v={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},x={...v,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},E=sp(y,p);if("bufferSize"in y)_=r(p,{...v,gain:1});else if(!E){const M={...x,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=i(p,M)}if(u.set(p,_===null?y:_),_!==null){if(f===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const J=new a(6,g.context.length,p.sampleRate),B=e(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});B.connect(J.destination),f=(async()=>{const $=await Promise.all([g.orientationX,g.orientationY,g.orientationZ,g.positionX,g.positionY,g.positionZ].map(async(U,Q)=>{const W=t(J,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Q===0?1:0});return await o(J,U,W.offset),W}));for(let U=0;U<6;U+=1)$[U].connect(B,0,U),$[U].start(0);return c(J)})()}const M=await f,k=r(p,{...v,gain:1});await l(g,p,k);const N=[];for(let J=0;J<M.numberOfChannels;J+=1)N.push(M.getChannelData(J));let I=[N[0][0],N[1][0],N[2][0]],D=[N[3][0],N[4][0],N[5][0]],V=r(p,{...v,gain:1}),G=i(p,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:D[0],positionY:D[1],positionZ:D[2]});k.connect(V).connect(G.inputs[0]),G.connect(_);for(let J=128;J<M.length;J+=128){const B=[N[0][J],N[1][J],N[2][J]],$=[N[3][J],N[4][J],N[5][J]];if(B.some((U,Q)=>U!==I[Q])||$.some((U,Q)=>U!==D[Q])){I=B,D=$;const U=J/p.sampleRate;V.gain.setValueAtTime(0,U),V=r(p,{...v,gain:0}),G=i(p,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:D[0],positionY:D[1],positionZ:D[2]}),V.gain.setValueAtTime(1,U),k.connect(V).connect(G.inputs[0]),G.connect(_)}}return _}return E?(await n(p,g.orientationX,y.orientationX),await n(p,g.orientationY,y.orientationY),await n(p,g.orientationZ,y.orientationZ),await n(p,g.positionX,y.positionX),await n(p,g.positionY,y.positionY),await n(p,g.positionZ,y.positionZ)):(await o(p,g.orientationX,y.orientationX),await o(p,g.orientationY,y.orientationY),await o(p,g.orientationZ,y.orientationZ),await o(p,g.positionX,y.positionX),await o(p,g.positionY,y.positionY),await o(p,g.positionZ,y.positionZ)),cR(y)?await l(g,p,y.inputs[0]):await l(g,p,y),y};return{render(g,p){const _=u.get(p);return _!==void 0?Promise.resolve(_):h(g,p)}}},Ist={disableNormalization:!1},Nst=(n,e,t,r)=>class h_e{constructor(s,a){const o=e(s),l=r({...Ist,...a}),c=n(o,l);return t.add(c),c}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===h_e.prototype||t.has(s)}},Pst=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),Dst=(n,e,t)=>async(r,i,s)=>{const a=n(r);await Promise.all(a.activeInputs.map((o,l)=>Array.from(o).map(async([c,u])=>{const h=await e(c).render(c,i),g=r.context.destination;!t(c)&&(r!==g||!t(r))&&h.connect(s,u,l)})).reduce((o,l)=>[...o,...l],[]))},Lst=(n,e,t)=>async(r,i,s)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map(async([o,l])=>{const u=await n(o).render(o,i);t(o)||u.connect(s,l)}))},Ust=(n,e,t,r)=>i=>n(JO,()=>JO(i))?Promise.resolve(n(r,r)).then(s=>{if(!s){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=o=>{a.disconnect(),s(o.renderedBuffer)},a.connect(i.destination),i.startRendering()}),Bst=n=>(e,t)=>{n.set(e,t)},Fst=n=>(e,t)=>n.set(e,t),zst=(n,e,t,r,i,s,a,o)=>(l,c)=>t(l).render(l,c).then(()=>Promise.all(Array.from(r(c)).map(u=>t(u).render(u,c)))).then(()=>i(c)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),uV(u)):e(s,()=>s(u))||o(u),n.add(u),u)),jst={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Hst=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...jst,...l},f=t(c,u),h=s(c),g=h?r():null;super(o,!1,f,g),this._pan=e(this,h,f.pan)}get pan(){return this._pan}},qst=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=sp(c,l);if(!u){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,f)}return s.set(l,c),u?await n(l,o.pan,c.pan):await r(l,o.pan,c.pan),cR(c)?await i(o,l,c.inputs[0]):await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},Vst=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},Gst=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let s=!1,a=!1;try{await r.audioWorklet.addModule(i);const o=new n(r,"a",{numberOfOutputs:0}),l=r.createOscillator();o.port.onmessage=()=>s=!0,o.onprocessorerror=()=>a=!0,l.connect(o),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return s&&!a},$st=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},Wst=()=>new DOMException("","UnknownError"),Yst={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Xst=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Yst,...c},h=t(u,f),p=s(u)?r():null;super(l,!0,h,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},Kst=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!sp(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=n(a,c)}return r.set(a,o),cR(o)?await t(s,a,o.inputs[0]):await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},Zst=()=>typeof window>"u"?null:window,Jst=(n,e)=>t=>{t.copyFromChannel=(r,i,s=0)=>{const a=n(s),o=n(i);if(o>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(o),u=r.length;for(let f=a<0?-a:0;f+a<l&&f<u;f+=1)r[f]=c[f+a]},t.copyToChannel=(r,i,s=0)=>{const a=n(s),o=n(i);if(o>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(o),u=r.length;for(let f=a<0?-a:0;f+a<l&&f<u;f+=1)c[f+a]=r[f]}},Qst=n=>e=>{e.copyFromChannel=(t=>(r,i,s=0)=>{const a=n(s),o=n(i);if(a<e.length)return t.call(e,r,o,a)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,s=0)=>{const a=n(s),o=n(i);if(a<e.length)return t.call(e,r,o,a)})(e.copyToChannel)},eat=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},tat=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const o=r.numberOfInputs;for(let l=0;l<o;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},d_e=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),p_e=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},i3=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(s),set:r(a)})},nat=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),rat=n=>({...n,channelCount:n.numberOfOutputs}),iat=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},m_e=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;m_e(n,e,t+1e-7)}},sat=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},aat=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},oat=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},mV=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},g_e=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},gV=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},lat=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},cat=n=>{n.start=(e=>(t=0,r=0,i)=>{const s=n.buffer,a=s===null?r:Math.min(s.duration,r);s!==null&&a>s.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},__e=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),uR(n,t),n.stop=(i=>{let s=!1;return(a=0)=>{if(s)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),s=!0}})(n.stop)},fR=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},uat=Ont(dx),fat=Lnt(dx),hat=Yrt(s6),v_e=new WeakMap,dat=hit(v_e),q_=Trt(new Map,new WeakMap),Wv=Zst(),y_e=Hit(q_,sy),_V=fit(Fp),wd=Dst(Fp,_V,qE),pat=jnt(y_e,lc,wd),Gl=mit(i6),Ab=mst(Wv),nl=Iit(Ab),b_e=new WeakMap,S_e=iit(fR),s3=$it(Wv),vV=Cit(s3),yV=Mit(Wv),E_e=Oit(Wv),QO=Yit(Wv),Wu=hrt(knt(X0e),Dnt(uat,fat,$L,hat,WL,Fp,dat,Jk,lc,dx,ib,qE,kP),q_,xit(dz,WL,Fp,lc,ZO,ib),sy,a6,Gp,Vrt($L,dz,Fp,lc,ZO,Gl,ib,nl),Zrt(b_e,Fp,I_),S_e,Gl,vV,yV,E_e,nl,QO),mat=znt(Wu,pat,sy,y_e,Gl,nl),bV=new WeakSet,pre=qit(Wv),x_e=Urt(new Uint32Array(1)),SV=Jst(x_e,sy),EV=Qst(x_e),T_e=qnt(bV,q_,Gp,pre,Ab,Vst(pre),SV,EV),o6=Unt($m),w_e=Lst(_V,e3,qE),ay=krt(w_e),hR=Git(o6,q_,sat,aat,oat,mV,g_e,gV,cat,eat(i3),__e),oy=Pst(dit(e3),w_e),gat=$nt(ay,hR,lc,oy,wd),V_=drt(Int(K0e),b_e,cV,prt,Tnt,wnt,Rnt,Ant,Cnt,uz,W0e,s3,m_e),_at=Gnt(Wu,gat,V_,Dh,hR,Gl,nl,fR),vat=trt(Wu,nrt,sy,Dh,Wit($m,i3),Gl,nl,wd),yat=xrt(ay,u_e,lc,oy,wd),px=Fst(v_e),bat=Ert(Wu,V_,yat,a6,u_e,Gl,nl,px),nS=zit(dx,yV),Sat=tat(Dh,nS),rS=tst(s3,Sat),Eat=Art(rS,lc,wd),xat=Rrt(Wu,Eat,rS,Gl,nl),Tat=Ort(n3,lc,wd),wat=Mrt(Wu,Tat,n3,Gl,nl,rat),Rat=ist(o6,hR,$m,nS),dR=rst(o6,q_,Rat,mV,gV),Aat=Lrt(ay,dR,lc,oy,wd),Cat=Drt(Wu,V_,Aat,dR,Gl,nl,fR),R_e=sst(Gp,i3),Mat=zrt(R_e,lc,wd),Oat=Frt(Wu,Mat,R_e,Gl,nl,px),kat=Wrt(ay,f_e,lc,oy,wd),Iat=$rt(Wu,V_,kat,f_e,Gl,nl,px),A_e=ast(Gp),Nat=tit(ay,A_e,lc,oy,wd),Pat=eit(Wu,V_,Nat,A_e,Gp,Gl,nl,px),Dat=cit(ay,$m,lc,oy,wd),Lat=lit(Wu,V_,Dat,$m,Gl,nl),Uat=ust(a6,Dh,r3,Gp),l6=Ust(q_,$m,r3,$st($m,Ab)),Bat=Eit(hR,lc,Ab,wd,l6),Fat=ost(Uat),zat=bit(Wu,Fat,Bat,Gl,nl,px),jat=rrt(V_,rS,dR,r3,Gp,d_e,nl,i3),C_e=new WeakMap,Hat=Fit(vat,jat,S_e,nl,C_e,fR),M_e=gst(o6,q_,mV,g_e,gV,__e),qat=Cst(ay,M_e,lc,oy,wd),Vat=Ast(Wu,V_,M_e,qat,Gl,nl,fR),O_e=Nrt(hR),Gat=xst(O_e,Dh,$m,p_e,nS),c6=Est(O_e,Dh,Gat,p_e,nS,s3,i3),$at=vst($L,Dh,rS,$m,r3,c6,Gp,WL,d_e,nS),k_e=_st($at),Wat=kst(ay,rS,dR,$m,k_e,lc,Ab,oy,wd,l6),Yat=Ost(Wu,V_,k_e,Wat,Gl,nl,px),Xat=yst(sy),Kat=Nst(Xat,Gl,new WeakSet,iat),Zat=Sst(rS,n3,$m,c6,Gp,nS),I_e=bst(Zat,Gp),Jat=qst(ay,I_e,lc,oy,wd),Qat=Hst(Wu,V_,I_e,Jat,Gl,nl),eot=Kst(c6,lc,wd),tot=Xst(Wu,Dh,c6,eot,Gl,nl,px),N_e=Nit(Wv),xV=sit(Wv),P_e=new WeakMap,not=git(P_e,Ab),rot=N_e?Pnt(q_,Gp,rit(Wv),xV,ait(Mnt),Gl,not,nl,QO,new WeakMap,new WeakMap,Gst(QO,Ab),Wv):void 0,iot=kit(vV,nl),sot=qrt(bV,q_,Hrt,nit,new WeakSet,Gl,iot,VL,JO,SV,EV),D_e=brt(rot,mat,T_e,_at,bat,xat,wat,Cat,Oat,sot,Iat,Pat,Lat,zat,Hat,Vat,Yat,Kat,Qat,tot),aot=Pit(Wu,fst,Gl,nl),oot=Lit(Wu,hst,Gl,nl),lot=Uit(Wu,dst,Gl,nl),cot=pst(Dh,nl),uot=Bit(Wu,cot,Gl),fot=ert(D_e,Dh,Gp,Wst,aot,oot,lot,uot,s3),TV=_it(C_e),hot=Bnt(TV),L_e=Irt(sy),dot=Xrt(TV),U_e=Jrt(sy),B_e=new WeakMap,pot=uit(B_e,I_),mot=est(L_e,sy,Dh,rS,n3,dR,$m,r3,Gp,U_e,xV,pot,nS),got=Kit(Dh,mot,$m,Gp,nS),_ot=yrt(ay,L_e,hR,rS,n3,dR,$m,dot,U_e,xV,lc,QO,Ab,oy,wd,l6),vot=pit(P_e),yot=Bst(B_e),mre=N_e?grt(hot,Wu,V_,_ot,got,Fp,vot,Gl,nl,QO,nat,yot,lat,fR):void 0,bot=jrt(Gp,Ab),Sot=zst(bV,q_,_V,TV,l6,VL,SV,EV),Eot=wst(D_e,q_,Dh,bot,Sot),xot=Tit(i6,vV),Tot=wit(lV,yV),wot=Rit(cV,E_e),Rot=Ait(i6,nl);function Hg(n){return n===void 0}function Us(n){return n!==void 0}function Aot(n){return typeof n=="function"}function N_(n){return typeof n=="number"}function x1(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function F_e(n){return typeof n=="boolean"}function Lm(n){return Array.isArray(n)}function mb(n){return typeof n=="string"}function MN(n){return mb(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function Ei(n,e){if(!n)throw new Error(e)}function D0(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function z_e(n){!n.isOffline&&n.state!=="running"&&u6('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let j_e=!1,gre=!1;function _re(n){j_e=n}function Cot(n){Hg(n)&&j_e&&!gre&&(gre=!0,u6("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let H_e=console;function Mot(...n){H_e.log(...n)}function u6(...n){H_e.warn(...n)}function Oot(n){return new fot(n)}function kot(n,e,t){return new Eot(n,e,t)}const Mg=typeof self=="object"?self:null,Iot=Mg&&(Mg.hasOwnProperty("AudioContext")||Mg.hasOwnProperty("webkitAudioContext"));function Not(n,e,t){return Ei(Us(mre),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof Mg?.BaseAudioContext?Mg?.AudioWorkletNode:mre)(n,e,t)}var vz=function(n,e){return vz=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},vz(n,e)};function f6(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vz(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ZL=function(){return ZL=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ZL.apply(this,arguments)};function q_e(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function rl(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function V_e(n,e){return function(t,r){e(t,r,n)}}function G_e(n,e,t,r,i,s){function a(v){if(v!==void 0&&typeof v!="function")throw new TypeError("Function expected");return v}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),f,h=!1,g=t.length-1;g>=0;g--){var p={};for(var _ in r)p[_]=_==="access"?{}:r[_];for(var _ in r.access)p.access[_]=r.access[_];p.addInitializer=function(v){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(v||null))};var y=(0,t[g])(o==="accessor"?{get:u.get,set:u.set}:u[l],p);if(o==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(f=a(y.get))&&(u.get=f),(f=a(y.set))&&(u.set=f),(f=a(y.init))&&i.unshift(f)}else(f=a(y))&&(o==="field"?i.unshift(f):u[l]=f)}c&&Object.defineProperty(c,r.name,u),h=!0}function $_e(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function W_e(n){return typeof n=="symbol"?n:"".concat(n)}function Y_e(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function X_e(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Hl(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})}function a3(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var h6=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function K_e(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&h6(e,n,t)}function JL(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mx(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function Z_e(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(mx(arguments[e]));return n}function J_e(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,i++)r[i]=s[a];return r}function ek(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}function Iw(n){return this instanceof Iw?(this.v=n,this):new Iw(n)}function Q_e(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(g){return function(p){return Promise.resolve(p).then(g,f)}}function o(g,p){r[g]&&(i[g]=function(_){return new Promise(function(y,v){s.push([g,_,y,v])>1||l(g,_)})},p&&(i[g]=p(i[g])))}function l(g,p){try{c(r[g](p))}catch(_){h(s[0][3],_)}}function c(g){g.value instanceof Iw?Promise.resolve(g.value.v).then(u,f):h(s[0][2],g)}function u(g){l("next",g)}function f(g){l("throw",g)}function h(g,p){g(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function eve(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,s){e[i]=n[i]?function(a){return(t=!t)?{value:Iw(n[i](a)),done:!1}:s?s(a):a}:s}}function tve(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof JL=="function"?JL(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}function nve(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Pot=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},yz=function(n){return yz=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},yz(n)};function rve(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=yz(n),r=0;r<t.length;r++)t[r]!=="default"&&h6(e,n,t[r]);return Pot(e,n),e}function ive(n){return n&&n.__esModule?n:{default:n}}function sve(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function ave(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function ove(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function lve(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Dot=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function cve(n){function e(s){n.error=n.hasError?new Dot(s,n.error,"An error was suppressed during disposal."):s,n.hasError=!0}var t,r=0;function i(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(i);if(t.dispose){var s=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(s).then(i,function(a){return e(a),i()})}else r|=1}catch(a){e(a)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return i()}function uve(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,i,s,a){return r?e?".jsx":".js":i&&(!s||!a)?t:i+s+"."+a.toLowerCase()+"js"}):n}const Lot={__extends:f6,__assign:ZL,__rest:q_e,__decorate:rl,__param:V_e,__esDecorate:G_e,__runInitializers:$_e,__propKey:W_e,__setFunctionName:Y_e,__metadata:X_e,__awaiter:Hl,__generator:a3,__createBinding:h6,__exportStar:K_e,__values:JL,__read:mx,__spread:Z_e,__spreadArrays:J_e,__spreadArray:ek,__await:Iw,__asyncGenerator:Q_e,__asyncDelegator:eve,__asyncValues:tve,__makeTemplateObject:nve,__importStar:rve,__importDefault:ive,__classPrivateFieldGet:sve,__classPrivateFieldSet:ave,__classPrivateFieldIn:ove,__addDisposableResource:lve,__disposeResources:cve,__rewriteRelativeImportExtension:uve},Uot=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:lve,get __assign(){return ZL},__asyncDelegator:eve,__asyncGenerator:Q_e,__asyncValues:tve,__await:Iw,__awaiter:Hl,__classPrivateFieldGet:sve,__classPrivateFieldIn:ove,__classPrivateFieldSet:ave,__createBinding:h6,__decorate:rl,__disposeResources:cve,__esDecorate:G_e,__exportStar:K_e,__extends:f6,__generator:a3,__importDefault:ive,__importStar:rve,__makeTemplateObject:nve,__metadata:X_e,__param:V_e,__propKey:W_e,__read:mx,__rest:q_e,__rewriteRelativeImportExtension:uve,__runInitializers:$_e,__setFunctionName:Y_e,__spread:Z_e,__spreadArray:ek,__spreadArrays:J_e,__values:JL,default:Lot},Symbol.toStringTag,{value:"Module"}));class Bot{constructor(e,t,r,i){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=r,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function VE(n){return wot(n)}function T1(n){return Tot(n)}function IP(n){return Rot(n)}function gT(n){return xot(n)}function Fot(n){return n instanceof T_e}function zot(n,e){return n==="value"||VE(e)||T1(e)||Fot(e)}function w1(n,...e){if(!e.length)return n;const t=e.shift();if(x1(n)&&x1(t))for(const r in t)zot(r,t[r])?n[r]=t[r]:x1(t[r])?(n[r]||Object.assign(n,{[r]:{}}),w1(n[r],t[r])):Object.assign(n,{[r]:t[r]});return w1(n,...e)}function jot(n,e){return n.length===e.length&&n.every((t,r)=>e[r]===t)}function pr(n,e,t=[],r){const i={},s=Array.from(e);if(x1(s[0])&&r&&!Reflect.has(s[0],r)&&(Object.keys(s[0]).some(o=>Reflect.has(n,o))||(w1(i,{[r]:s[0]}),t.splice(t.indexOf(r),1),s.shift())),s.length===1&&x1(s[0]))w1(i,s[0]);else for(let a=0;a<t.length;a++)Us(s[a])&&(i[t[a]]=s[a]);return w1(n,i)}function Hot(n){return n.constructor.getDefaults()}function Lv(n,e){return Hg(n)?e:n}function Ov(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Cb{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Mg&&this.toString()===Mg.TONE_DEBUG_CLASS)&&Mot(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Cb.version=$0e;const wV=1e-6;function Nw(n,e){return n>e+wV}function bz(n,e){return Nw(n,e)||E_(n,e)}function QL(n,e){return n+wV<e}function E_(n,e){return Math.abs(n-e)<wV}function qot(n,e,t){return Math.max(Math.min(n,t),e)}class z0 extends Cb{constructor(){super(),this.name="Timeline",this._timeline=[];const e=pr(z0.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Ei(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];Ei(bz(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const r=this._search(e,t);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(E_(this._timeline[t].time,e)){for(let r=t;r>=0&&E_(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&bz(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let r=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;r<s;){let a=Math.floor(r+(s-r)/2);const o=this._timeline[a],l=this._timeline[a+1];if(E_(o[t],e)){for(let c=a;c<this._timeline.length;c++){const u=this._timeline[c];if(E_(u[t],e))a=c;else break}return a}else{if(QL(o[t],e)&&Nw(l[t],e))return a;Nw(o[t],e)?s=a:r=a+1}}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const r=this._search(e);return r!==-1&&this._iterate(t,0,r),this}forEachAfter(e,t){const r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let i=this._search(e),s=this._search(t);return i!==-1&&s!==-1?(this._timeline[i].time!==e&&(i+=1),this._timeline[s].time===t&&(s-=1),this._iterate(r,i,s)):i===-1&&this._iterate(r,0,s),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){const r=this._search(e);if(r!==-1&&E_(this._timeline[r].time,e)){let i=r;for(let s=r;s>=0&&E_(this._timeline[s].time,e);s--)i=s;this._iterate(s=>{t(s)},i,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const fve=[];function d6(n){fve.push(n)}function Vot(n){fve.forEach(e=>e(n))}const hve=[];function p6(n){hve.push(n)}function Got(n){hve.forEach(e=>e(n))}class o3 extends Cb{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(i=>{Hg(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t)}),this}once(e,t){const r=(...i)=>{t(...i),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach(i=>{if(Hg(this._events)&&(this._events={}),this._events.hasOwnProperty(i))if(Hg(t))this._events[i]=[];else{const s=this._events[i];for(let a=s.length-1;a>=0;a--)s[a]===t&&s.splice(a,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const r=this._events[e].slice(0);for(let i=0,s=r.length;i<s;i++)r[i].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const r=Object.getOwnPropertyDescriptor(o3.prototype,t);Object.defineProperty(e.prototype,t,r)})}dispose(){return super.dispose(),this._events=void 0,this}}class dve extends o3{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class pR extends dve{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new z0,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const r=pr(pR.getDefaults(),arguments,["context"]);r.context?(this._context=r.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=Oot({latencyHint:r.latencyHint}),this._latencyHint=r.latencyHint),this._ticker=new Bot(this.emit.bind(this,"tick"),r.clockSource,r.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=r.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(Vot(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Ei(gT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Ei(gT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Ei(gT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Ei(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Ei(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Ei(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Ei(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return Not(this.rawContext,e,t)}addAudioWorkletModule(e){return Hl(this,void 0,void 0,function*(){Ei(Us(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return Hl(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return gT(this._context)?this._context.resume():Promise.resolve()}close(){return Hl(this,void 0,void 0,function*(){gT(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&Got(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let s=0;s<r.length;s++)r[s]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,t=>{t.callback(),this._timeouts.remove(t)})}setTimeout(e,t){this._timeoutIds++;const r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const r=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),i()},id:r,time:s+t})};return i(),r}}class $ot extends dve{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return Hl(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Bs(n,e){Lm(e)?e.forEach(t=>Bs(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function l3(n,e){Lm(e)?e.forEach(t=>l3(n,t)):Object.defineProperty(n,e,{writable:!0})}const co=()=>{};class Qo extends Cb{constructor(){super(),this.name="ToneAudioBuffer",this.onload=co;const e=pr(Qo.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,mb(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:co,onload:co,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:oc().sampleRate}set(e){return e instanceof Qo?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Hl(this,void 0,void 0,function*(){const t=Qo.load(e).then(r=>{this.set(r),this.onload(this)});Qo.downloads.push(t);try{yield t}finally{const r=Qo.downloads.indexOf(t);Qo.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Lm(e)&&e[0].length>0,r=t?e.length:1,i=t?e[0].length:e.length,s=oc(),a=s.createBuffer(r,i,s.sampleRate),o=!t&&r===1?[e]:e;for(let l=0;l<r;l++)a.copyToChannel(o[l],l);return this._buffer=a,this}toMono(e){if(N_(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const r=this.numberOfChannels;for(let i=0;i<r;i++){const s=this.toArray(i);for(let a=0;a<s.length;a++)t[a]+=s[a]}t=t.map(i=>i/r),this.fromArray(t)}return this}toArray(e){if(N_(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let r=0;r<this.numberOfChannels;r++)t[r]=this.getChannelData(r);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){Ei(this.loaded,"Buffer is not loaded");const r=Math.floor(e*this.sampleRate),i=Math.floor(t*this.sampleRate);Ei(r<i,"The start time must be less than the end time");const s=i-r,a=oc().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(r,i),o);return new Qo(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Qo().fromArray(e)}static fromUrl(e){return Hl(this,void 0,void 0,function*(){return yield new Qo().load(e)})}static load(e){return Hl(this,void 0,void 0,function*(){const t=Qo.baseUrl===""||Qo.baseUrl.endsWith("/")?Qo.baseUrl:Qo.baseUrl+"/",r=yield fetch(t+e);if(!r.ok)throw new Error(`could not load url: ${e}`);const i=yield r.arrayBuffer();return yield oc().decodeAudioData(i)})}static supportsType(e){const t=e.split("."),r=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return Hl(this,void 0,void 0,function*(){for(yield Promise.resolve();Qo.downloads.length;)yield Qo.downloads[0]})}}Qo.baseUrl="";Qo.downloads=[];class c3 extends pR{constructor(){super({clockSource:"offline",context:IP(arguments[0])?arguments[0]:kot(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:IP(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=IP(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Hl(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const r=Math.floor(this.sampleRate/128);e&&t%r===0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(){return Hl(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Qo(t)})}close(){return Promise.resolve()}}const pve=new $ot;let sE=pve;function oc(){return sE===pve&&Iot&&e4(new pR),sE}function e4(n,e=!1){e&&sE.dispose(),gT(n)?sE=new pR(n):IP(n)?sE=new c3(n):sE=n}function Wot(){return sE.resume()}if(Mg&&!Mg.TONE_SILENCE_LOGGING){const e=` * Tone.js v${$0e} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function mve(n){return Math.pow(10,n/20)}function gve(n){return 20*(Math.log(n)/Math.LN10)}function _ve(n){return Math.pow(2,n/12)}let m6=440;function Yot(){return m6}function Xot(n){m6=n}function aE(n){return Math.round(vve(n))}function vve(n){return 69+12*Math.log2(n/m6)}function yve(n){return m6*Math.pow(2,(n-69)/12)}class RV extends Cb{constructor(e,t,r){super(),this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const r=parseInt(e,10),i=t==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/r)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let i=0;return e&&e!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i+=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(i+=this._beatsToUnits(parseFloat(r)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof RV&&this.fromType(this._val),Hg(this._val))return this._noArg();if(mb(this._val)&&Hg(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(x1(this._val)){let e=0;for(const t in this._val)if(Us(this._val[t])){const r=this._val[t],i=new this.constructor(this.context,t).valueOf()*r;e+=i}return e}if(Us(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return mb(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class L0 extends RV{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new L0(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const r=new this.constructor(this.context,e).valueOf(),i=this.valueOf(),o=Math.round(i/r)*r-i;return i+o*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let s=1;s<9;s++){const a=Math.pow(2,s);t.push(a+"n."),t.push(a+"n"),t.push(a+"t")}t.push("0");let r=t[0],i=new L0(this.context,t[0]).toSeconds();return t.forEach(s=>{const a=new L0(this.context,s).toSeconds();Math.abs(a-e)<Math.abs(i-e)&&(r=s,i=a)}),r}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const r=Math.floor(t/this._getTimeSignature());let i=t%1*4;t=Math.floor(t)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[r,t,i].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return aE(this.toFrequency())}_now(){return this.context.now()}}function Rh(n,e){return new L0(oc(),n,e)}class Im extends L0{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Yot()}static set A4(e){Xot(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Im.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const i=Kot[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?i:Im.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let i=1;return e&&e!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i*=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(i*=this._beatsToUnits(parseFloat(r)/4)),i}}})}transpose(e){return new Im(this.context,this.valueOf()*_ve(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return aE(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/Im.A4);let r=Math.round(12*t)+57;const i=Math.floor(r/12);return i<0&&(r+=-12*i),Zot[r%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return yve(e)}static ftom(e){return aE(e)}}const Kot={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Zot=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function vre(n,e){return new Im(oc(),n,e)}class qT extends L0{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class tp extends Cb{constructor(){super();const e=pr(tp.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:oc()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return Cot(e),new L0(this.context,e).toSeconds()}toFrequency(e){return new Im(this.context,e).toFrequency()}toTicks(e){return new qT(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(r=>{Hg(e[r])&&delete t[r]}),t}get(){const e=Hot(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const r=this[t];Us(r)&&Us(r.value)&&Us(r.setValueAtTime)?e[t]=r.value:r instanceof tp?e[t]=r._getPartialProperties(e[t]):Lm(r)||N_(r)||mb(r)||F_e(r)?e[t]=r:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Us(this[t])&&(this[t]&&Us(this[t].value)&&Us(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof tp?this[t].set(e[t]):this[t]=e[t])}),this}}class u3 extends z0{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,r){return D0(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){const r=this._search(t);for(let i=r;i>=0;i--){const s=this._timeline[i];if(s.state===e)return s}}getNextState(e,t){const r=this._search(t);if(r!==-1)for(let i=r;i<this._timeline.length;i++){const s=this._timeline[i];if(s.state===e)return s}}}class Hi extends tp{constructor(){const e=pr(Hi.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Ei(Us(e.param)&&(VE(e.param)||e.param instanceof Hi),"param must be an AudioParam");!VE(e.param);)e.param=e.param._param;this._swappable=Us(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new z0(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Us(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(tp.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Us(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Us(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Us(this.maxValue)&&Us(this.minValue)&&D0(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?mve(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?gve(e):e}setValueAtTime(e,t){const r=this.toSeconds(t),i=this._fromType(e);return Ei(isFinite(i)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,r),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),i=this._events.get(t);let s=this._initialValue;if(i===null)s=this._initialValue;else if(i.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){const a=this._events.getBefore(i.time);let o;a===null?o=this._initialValue:o=a.value,i.type==="setTargetAtTime"&&(s=this._exponentialApproach(i.time,o,i.value,i.constant,t))}else if(r===null)s=i.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let a=i.value;if(i.type==="setTargetAtTime"){const o=this._events.getBefore(i.time);o===null?a=this._initialValue:a=o.value}r.type==="linearRampToValueAtTime"?s=this._linearInterpolate(i.time,a,r.time,r.value,t):s=this._exponentialInterpolate(i.time,a,r.time,r.value,t)}else s=i.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const r=this._fromType(e),i=this.toSeconds(t);return Ei(isFinite(r)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:i,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(r,i),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=E_(r,0)?this._minOutput:r,this._assertRange(r);const i=this.toSeconds(t);return Ei(isFinite(r)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(r,i),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);const i=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+r*.9),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){const i=this._fromType(e);Ei(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(t);return this._assertRange(i),Ei(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,s,r),this._param.setTargetAtTime(i,s,r),this}setValueCurveAtTime(e,t,r,i=1){r=this.toSeconds(r),t=this.toSeconds(t);const s=this._fromType(e[0])*i;this.setValueAtTime(this._toType(s),t);const a=r/(e.length-1);for(let o=1;o<e.length;o++){const l=this._fromType(e[o])*i;this.linearRampToValueAtTime(this._toType(l),t+o*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return Ei(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));Ei(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);const i=this._events.get(t),s=this._events.getAfter(t);return i&&E_(i.time,t)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),t):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const r=this._events.get(t);if(r&&r.type==="setTargetAtTime"){const i=this._events.getAfter(r.time),s=i?i.time:t+2,a=(s-t)/10;for(let o=t;o<s;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?e.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){Ei(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,i,s){return r+(t-r)*Math.exp(-(s-e)/i)}_linearInterpolate(e,t,r,i,s){return t+(i-t)*((s-e)/(r-e))}_exponentialInterpolate(e,t,r,i,s){return t*Math.pow(i/t,(s-e)/(r-e))}}class xr extends tp{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Us(this.input)?VE(this.input)||this.input instanceof Hi?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Us(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Us(e)&&(e instanceof xr||T1(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Ei(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return P_(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return u6("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return bve(this,e,t,r),this}chain(...e){return GE(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Us(this.input)&&(this.input instanceof xr?this.input.dispose():T1(this.input)&&this.input.disconnect()),Us(this.output)&&(this.output instanceof xr?this.output.dispose():T1(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function GE(...n){const e=n.shift();n.reduce((t,r)=>(t instanceof xr?t.connect(r):T1(t)&&P_(t,r),r),e)}function P_(n,e,t=0,r=0){for(Ei(Us(n),"Cannot connect from undefined node"),Ei(Us(e),"Cannot connect to undefined node"),(e instanceof xr||T1(e))&&Ei(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Ei(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof xr||e instanceof Hi;)Us(e.input)&&(e=e.input);for(;n instanceof xr;)Us(n.output)&&(n=n.output);VE(e)?n.connect(e,t):n.connect(e,t,r)}function bve(n,e,t=0,r=0){if(Us(e))for(;e instanceof xr;)e=e.input;for(;!T1(n);)Us(n.output)&&(n=n.output);VE(e)?n.disconnect(e,t):T1(e)?n.disconnect(e,t,r):n.disconnect()}class qi extends xr{constructor(){const e=pr(qi.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Hi({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Bs(this,"gain")}static getDefaults(){return Object.assign(xr.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Pw extends xr{constructor(e){super(e),this.onended=co,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new qi({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const r=this.toSeconds(t);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(xr.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:co})}_startGain(e,t=1){Ei(this._startTime===-1,"Source cannot be started more than once");const r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Ei(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const r=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==co&&(this.onended(this),this.onended=co,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ei(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=co,this}}class AV extends Pw{constructor(){const e=pr(AV.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),P_(this._source,this._gainNode),this.offset=new Hi({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Pw.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class ha extends xr{constructor(){const e=pr(ha.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new AV({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(xr.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return g6(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,i){return this._param.setValueCurveAtTime(e,t,r,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function g6(n,e,t,r){(e instanceof Hi||VE(e)||e instanceof ha&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof ha&&(e.overridden=!0)),P_(n,e,t,r)}class CV extends Hi{constructor(){const e=pr(CV.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new z0(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Hi.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);const i=this._fromType(e),s=this._events.get(t),a=Math.round(Math.max(1/r,1));for(let o=0;o<=a;o++){const l=r*o+t,c=this._exponentialApproach(s.time,s.value,i,r,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(e,t){const r=this.toSeconds(t);super.setValueAtTime(e,t);const i=this._events.get(r),s=this._events.previousEvent(i),a=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const i=this._events.get(r),s=this._events.previousEvent(i),a=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const r=this._fromType(e),i=this._events.get(t),s=Math.round(Math.max((t-i.time)*10,1)),a=(t-i.time)/s;for(let o=0;o<=s;o++){const l=a*o+i.time,c=this._exponentialInterpolate(i.time,i.value,t,r,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Hg(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const r=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(t));const s=this._events.get(t);return s&&s.time===t&&s.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+i)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){const r=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-r}getTimeOfTick(e){const t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&r.type==="linearRampToValueAtTime"&&t.value!==r.value){const i=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(r.time))-i)/(r.time-t.time),o=Math.sqrt(Math.pow(i,2)-2*a*(t.ticks-e)),l=(-i+o)/a,c=(-i-o)/a;return(l>0?l:c)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const r=this.toSeconds(t),i=this.toSeconds(e),s=this.getTicksAtTime(r);return this.getTicksAtTime(r+i)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class MV extends ha{constructor(){const e=pr(MV.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new CV({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(ha.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class OV extends tp{constructor(){const e=pr(OV.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new u3,this._tickOffset=new z0,this._ticksAtTime=new z0,this._secondsAtTime=new z0,this.frequency=new MV({context:this.context,units:e.units,value:e.frequency}),Bs(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},tp.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),Us(t)&&this.setTicksAtTime(t,r),this._ticksAtTime.cancel(r),this._secondsAtTime.cancel(r)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const r=this._state.get(t);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),r=this._state.getLastState("stopped",t),i=this._ticksAtTime.get(t),s={state:"paused",time:t};this._state.add(s);let a=i||r,o=i?i.ticks:0,l=null;return this._state.forEachBetween(a.time,t+this.sampleTime,c=>{let u=a.time;const f=this._tickOffset.get(c.time);f&&f.time>=a.time&&(o=f.ticks,u=f.time),a.state==="started"&&c.state!=="started"&&(o+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(u),c.time!==s.time&&(l={state:c.state,time:c.time,ticks:o})),a=c}),this._state.remove(s),l&&this._ticksAtTime.add(l),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);const i=this._secondsAtTime.get(e);let s=i||t,a=i?i.seconds:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,l=>{let c=s.time;const u=this._tickOffset.get(l.time);u&&u.time>=s.time&&(a=u.seconds,c=u.time),s.state==="started"&&l.state!=="started"&&(a+=l.time-c,l.time!==r.time&&(o={state:l.state,time:l.time,seconds:a})),s=l}),this._state.remove(r),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const r=this._tickOffset.get(t),i=this._state.get(t),s=Math.max(r.time,i.time),a=this.frequency.getTicksAtTime(s)+e-r.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,r){let i=this._state.get(e);this._state.forEachBetween(e,t,a=>{i&&i.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(i.time,e),a.time-this.sampleTime,r),i=a});let s=null;if(i&&i.state==="started"){const a=Math.max(i.time,e),o=this.frequency.getTicksAtTime(a),l=this.frequency.getTicksAtTime(i.time),c=o-l;let u=Math.ceil(c)-c;u=E_(u,1)?0:u;let f=this.frequency.getTimeOfTick(o+u);for(;f<t;){try{r(f,Math.round(this.getTicksAtTime(f)))}catch(h){s=h;break}f+=this.frequency.getDurationOfTicks(1,f)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class _6 extends tp{constructor(){const e=pr(_6.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=co,this._lastUpdate=0,this._state=new u3("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new OV({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Bs(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(tp.getDefaults(),{callback:co,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){z_e(this.context);const r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const r=this.toSeconds(t),i=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(i+e,r)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,r=>{switch(r.state){case"started":const i=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,i);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,t,(r,i)=>{this.callback(r,i)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}o3.mixin(_6);class Dw extends xr{constructor(){const e=pr(Dw.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new Hi({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),Bs(this,"delayTime")}static getDefaults(){return Object.assign(xr.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Sm extends xr{constructor(){const e=pr(Sm.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new qi({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Bs(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class kV extends xr{constructor(){const e=pr(kV.getDefaults(),arguments);super(e),this.name="Destination",this.input=new Sm({context:this.context}),this.output=new qi({context:this.context}),this.volume=this.input.volume,GE(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),GE(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}d6(n=>{n.destination=new kV({context:n})});p6(n=>{n.destination.dispose()});class Jot extends xr{constructor(){super(...arguments),this.name="Listener",this.positionX=new Hi({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Hi({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Hi({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Hi({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Hi({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Hi({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Hi({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Hi({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Hi({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(xr.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}d6(n=>{n.listener=new Jot({context:n})});p6(n=>{n.listener.dispose()});function Qot(n,e){return Hl(this,arguments,void 0,function*(t,r,i=2,s=oc().sampleRate){const a=oc(),o=new c3(i,r,s);e4(o),yield t(o);const l=o.render();e4(a);const c=yield l;return new Qo(c)})}class IV extends Cb{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=pr(IV.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:co,onload:co,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Ei(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,r=co,i=co){return mb(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Qo(this.baseUrl+t,r,i))):this._buffers.set(e.toString(),new Qo(t,r,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class t4 extends Im{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return aE(super._frequencyToUnits(e))}_ticksToUnits(e){return aE(super._ticksToUnits(e))}_beatsToUnits(e){return aE(super._beatsToUnits(e))}_secondsToUnits(e){return aE(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return yve(this.toMidi())}transpose(e){return new t4(this.context,this.toMidi()+e)}}class Gf extends qT{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class elt extends tp{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new z0,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,t=>{e-t.time<=this.expiration&&t.callback(),this._events.remove(t)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}d6(n=>{n.draw=new elt({context:n})});p6(n=>{n.draw.dispose()});class tlt extends Cb{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Ei(Us(e.time),"Events must have a time property"),Ei(Us(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new nlt(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let r,i=null;if(t>0)if(e.left.right===null)r=e.left,r.right=e.right,i=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,i=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,i=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,i=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const t=e.parent,r=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),t!==null?r?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){const t=e.parent,r=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),t!==null?r?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let r=t[0];for(let i=1;i<t.length;i++)t[i].low>r.low&&(r=t[i]);return r.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(r=>t.push(r)),t.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const r=[];this._root.search(e,r),r.forEach(i=>{i.event&&t(i.event)})}return this}forEachFrom(e,t){if(this._root!==null){const r=[];this._root.searchAfter(e,r),r.forEach(i=>{i.event&&t(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class nlt{constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class rlt extends Cb{constructor(e){super(),this.name="TimelineValue",this._timeline=new z0({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class D_ extends xr{constructor(){super(pr(D_.getDefaults(),arguments,["context"]))}connect(e,t=0,r=0){return g6(this,e,t,r),this}}class iS extends D_{constructor(){const e=pr(iS.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,Lm(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Aot(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(ha.getDefaults(),{length:1024})}setMap(e,t=1024){const r=new Float32Array(t);for(let i=0,s=t;i<s;i++){const a=i/(s-1)*2-1;r[i]=e(a,i)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(r=>r.includes(e));Ei(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class v6 extends D_{constructor(){const e=pr(v6.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new iS({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(D_.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class B1{constructor(e,t){this.id=B1._eventId++,this._remainderTime=0;const r=Object.assign(B1.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=Math.floor(r.time),this._remainderTime=r.time-this.time}static getDefaults(){return{callback:co,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}B1._eventId=0;class NV extends B1{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const r=Object.assign(NV.getDefaults(),t);this.duration=r.duration,this._interval=r.interval,this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},B1.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return QL(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Gf(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){QL(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Gf(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Nw(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class y6 extends tp{constructor(){const e=pr(y6.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new rlt(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new z0,this._repeatedEvents=new tlt,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new _6({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Bs(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(tp.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const r=t%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(r*Math.PI)*this._swingAmount;e+=new Gf(this.context,this._swingTicks*2/3).toSeconds()*i}_re(!0),this._timeline.forEachAtTime(t,r=>r.invoke(e)),_re(!1)}schedule(e,t){const r=new B1(this,{callback:e,time:new qT(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,i=1/0){const s=new NV(this,{callback:e,duration:new L0(this.context,i).toTicks(),interval:new L0(this.context,t).toTicks(),time:new qT(this.context,r).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,t){const r=new B1(this,{callback:e,once:!0,time:new qT(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(t,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Gf(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let r;return Us(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Lm(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new L0(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new L0(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Gf(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Gf(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const r=this._clock.getTicksAtTime(t),i=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t),s=t+i;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),r=this.getTicksAtTime(t),i=e-r%e;return this._clock.nextTickTime(i,t)}}syncSignal(e,t){const r=this.now();let i=this.bpm,s=1/(60/i.getValueAtTime(r)/this.PPQ),a=[];if(e.units==="time"){const l=.015625/s,c=new qi(l),u=new v6(-1),f=new qi(l);i.chain(c,u,f),i=f,s=1/s,a=[c,u,f]}t||(e.getValueAtTime(r)!==0?t=e.getValueAtTime(r)/s:t=0);const o=new qi(t);return i.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const r=this._syncedSignals[t];r.signal===e&&(r.nodes.forEach(i=>i.dispose()),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),l3(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}o3.mixin(y6);d6(n=>{n.transport=new y6({context:n})});p6(n=>{n.transport.dispose()});class Lh extends xr{constructor(e){super(e),this.input=void 0,this._state=new u3("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=co,this._syncedStop=co,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Sm({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Bs(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,onstop:co,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let i=Hg(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")Ei(Nw(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,r);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const s=this._state.get(i);s&&(s.offset=this.toSeconds(Lv(t,0)),s.duration=r?this.toSeconds(r):void 0);const a=this.context.transport.schedule(o=>{this._start(o,t,r)},i);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else z_e(this.context),this._start(i,t,r);return this}stop(e){let t=Hg(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Us(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const r=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(r)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Nw(t,0)){const r=this._state.get(t);if(r&&r.state==="started"&&r.time!==t){const i=t-this.toSeconds(r.time);let s;r.duration&&(s=this.toSeconds(r.duration)-i),this._start(e,this.toSeconds(r.offset)+i,s)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=co,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class f3 extends Pw{constructor(){const e=pr(f3.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,P_(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Hi({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Qo(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Pw.getDefaults(),{url:new Qo,loop:!1,loopEnd:0,loopStart:0,onload:co,onerror:co,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,i=1){Ei(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,i),this.loop?t=Lv(t,this.loopStart):t=Lv(t,0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=o-l;bz(a,o)&&(a=(a-l)%c+l),E_(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,QL(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,a)),Us(r)){let o=this.toSeconds(r);o=Math.max(o,0),this.stop(s+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class $E extends Lh{constructor(){const e=pr($E.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Lh.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(Ei(e in yre,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=yre[this._type];this._source=new f3({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const nT=44100*5,bF=2,My={brown:null,pink:null,white:null},yre={get brown(){if(!My.brown){const n=[];for(let e=0;e<bF;e++){const t=new Float32Array(nT);n[e]=t;let r=0;for(let i=0;i<nT;i++){const s=Math.random()*2-1;t[i]=(r+.02*s)/1.02,r=t[i],t[i]*=3.5}}My.brown=new Qo().fromArray(n)}return My.brown},get pink(){if(!My.pink){const n=[];for(let e=0;e<bF;e++){const t=new Float32Array(nT);n[e]=t;let r,i,s,a,o,l,c;r=i=s=a=o=l=c=0;for(let u=0;u<nT;u++){const f=Math.random()*2-1;r=.99886*r+f*.0555179,i=.99332*i+f*.0750759,s=.969*s+f*.153852,a=.8665*a+f*.3104856,o=.55*o+f*.5329522,l=-.7616*l-f*.016898,t[u]=r+i+s+a+o+l+c+f*.5362,t[u]*=.11,c=f*.115926}}My.pink=new Qo().fromArray(n)}return My.pink},get white(){if(!My.white){const n=[];for(let e=0;e<bF;e++){const t=new Float32Array(nT);n[e]=t;for(let r=0;r<nT;r++)t[r]=Math.random()*2-1}My.white=new Qo().fromArray(n)}return My.white}};function gx(n,e){return Hl(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,r=new c3(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}class PV extends Pw{constructor(){const e=pr(PV.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],P_(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Hi({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Hi({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Bs(this,["frequency","detune"])}static getDefaults(){return Object.assign(Pw.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Hc extends Lh{constructor(){const e=pr(Hc.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new ha({context:this.context,units:"frequency",value:e.frequency}),Bs(this,"frequency"),this.detune=new ha({context:this.context,units:"cents",value:e.detune}),Bs(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Lh.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),r=new PV({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Hc._periodicWaveCache.find(t=>t.phase===this._phase&&jot(t.partials,this._partials));{const e=Hc._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const r=this._getCachedPeriodicWave();if(Us(r)){const{partials:i,wave:s}=r;this._wave=s,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,s]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(i,s);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Hc._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),Hc._periodicWaveCache.length>100&&Hc._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){D0(e,0);let t=this._type;const r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const i=new Float32Array(e);this._partials.forEach((s,a)=>i[a]=s),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,t){let i=2048;const s=new Float32Array(i),a=new Float32Array(i);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,i=o,this._partials.length===0)return[s,a]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(o=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],o=Math.max(o,2),i=o):this._partialCount=0,this._partials=[]}for(let l=1;l<i;++l){const c=2/(l*Math.PI);let u;switch(e){case"sine":u=l<=o?1:0,this._partials[l-1]=u;break;case"square":u=l&1?2*c:0,this._partials[l-1]=u;break;case"sawtooth":u=c*(l&1?1:-1),this._partials[l-1]=u;break;case"triangle":l&1?u=2*(c*c)*(l-1>>1&1?-1:1):u=0,this._partials[l-1]=u;break;case"custom":u=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(s[l]=-u*Math.sin(t*l),a[l]=u*Math.cos(t*l)):(s[l]=0,a[l]=0)}return[s,a]}_inverseFFT(e,t,r){let i=0;const s=e.length;for(let a=0;a<s;a++)i+=e[a]*Math.cos(a*r)+t[a]*Math.sin(a*r);return i}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let r=0;const i=Math.PI*2,s=32;for(let a=0;a<s;a++)r=Math.max(this._inverseFFT(e,t,a/s*i),r);return qot(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Hc._periodicWaveCache=[];class DV extends D_{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new iS({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Yv extends ha{constructor(){const e=pr(Yv.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new qi({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ha.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class b6 extends Lh{constructor(){const e=pr(b6.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new DV({context:this.context}),this._modulationNode=new qi({context:this.context}),this._carrier=new Hc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Hc({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Yv({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Bs(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Hc.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class h3 extends Lh{constructor(){const e=pr(h3.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new qi({context:this.context,gain:0}),this._carrier=new Hc({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new ha({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Hc({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Yv({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Yv({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Bs(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Hc.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class d3 extends Lh{constructor(){const e=pr(d3.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new qi({context:this.context,gain:0}),this._thresh=new iS({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new ha({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Hc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Bs(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Lh.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class S6 extends Lh{constructor(){const e=pr(S6.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new ha({context:this.context,units:"frequency",value:e.frequency}),this.detune=new ha({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Bs(this,["frequency","detune"])}static getDefaults(){return Object.assign(Hc.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,r=e/(this._oscillators.length-1);this._forEach((i,s)=>i.detune.value=t+r*s)}}get count(){return this._oscillators.length}set count(e){if(D0(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const r=new Hc({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):co});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,r)=>t.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class E6 extends Lh{constructor(){const e=pr(E6.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Yv({context:this.context,value:2}),this._pulse=new d3({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Hc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Bs(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Lh.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const bre={am:b6,fat:S6,fm:h3,oscillator:Hc,pulse:d3,pwm:E6};class Lw extends Lh{constructor(){const e=pr(Lw.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new ha({context:this.context,units:"frequency",value:e.frequency}),this.detune=new ha({context:this.context,units:"cents",value:e.detune}),Bs(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Hc.getDefaults(),h3.getDefaults(),b6.getDefaults(),S6.getDefaults(),d3.getDefaults(),E6.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=bre[e],r=this.now();if(this._oscillator){const i=this._oscillator;i.stop(r),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof bre[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&N_(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&N_(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&mb(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Hl(this,arguments,void 0,function*(e=1024){return gx(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class LV extends ha{constructor(){super(pr(LV.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new qi({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,GE(this._constantSource,this._sum)}static getDefaults(){return Object.assign(ha.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Uw extends D_{constructor(){const e=pr(Uw.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new Yv({context:this.context,value:e.max-e.min}),this._add=this.output=new LV({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(D_.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class UV extends D_{constructor(){super(pr(UV.getDefaults(),arguments)),this.name="Zero",this._gain=new qi({context:this.context}),this.output=this._gain,this.input=void 0,P_(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),bve(this.context.getConstant(0),this._gain),this}}class WE extends xr{constructor(){const e=pr(WE.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Hi.prototype._fromType,this._toType=Hi.prototype._toType,this._is=Hi.prototype._is,this._clampValue=Hi.prototype._clampValue,this._oscillator=new Hc(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new qi({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new ha({context:this.context,units:"audioRange",value:0}),this._zeros=new UV({context:this.context}),this._a2g=new DV({context:this.context}),this._scaler=this.output=new Uw({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Bs(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(Hc.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const t=this.min,r=this.max;this._units=e,this.min=t,this.max=r}get state(){return this._oscillator.state}connect(e,t,r){return(e instanceof Hi||e instanceof ha)&&(this.convert=e.convert,this.units=e.units),g6(this,e,t,r),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Sve(n,e=1/0){const t=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(s){D0(s,n,e),t.set(this,s)}})}}function Mb(n,e=1/0){const t=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(s){D0(this.toSeconds(s),n,e),t.set(this,s)}})}}class p3 extends Lh{constructor(){const e=pr(p3.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Qo({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Lh.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:co,onerror:co,playbackRate:1,reverse:!1})}load(e){return Hl(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=co){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){this._loop?t=Lv(t,this._loopStart):t=Lv(t,0);const i=this.toSeconds(t),s=r;r=Lv(r,Math.max(this._buffer.duration-i,0));let a=this.toSeconds(r);a=a/this._playbackRate,e=this.toSeconds(e);const o=new f3({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Hg(s)?o.start(e,i):o.start(e,i,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(t))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){var i;(i=[...this._activeSources].pop())===null||i===void 0||i.stop(e),this._start(e,t,r)}seek(e,t){const r=this.toSeconds(t);if(this._state.getValueAtTime(r)==="started"){const i=this.toSeconds(e);this._stop(r),this._start(r,i)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&D0(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&D0(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}rl([Mb(0)],p3.prototype,"fadeIn",void 0);rl([Mb(0)],p3.prototype,"fadeOut",void 0);class ilt extends D_{constructor(){super(...arguments),this.name="Abs",this._abs=new iS({context:this.context,mapping:e=>Math.abs(e)<.001?0:Math.abs(e)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class slt extends D_{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new iS({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class BV extends Uw{constructor(){const e=pr(BV.getDefaults(),arguments,["min","max","exponent"]);super(e),this.name="ScaleExp",this.input=this._exp=new v6({context:this.context,value:e.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(Uw.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(e){this._exp.value=e}dispose(){return super.dispose(),this._exp.dispose(),this}}class Vg extends xr{constructor(){const e=pr(Vg.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new ha({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(xr.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(mb(e))return e;{let r;for(r in ON)if(ON[r][t]===e)return r;return e}}_setCurve(e,t,r){if(mb(r)&&Reflect.has(ON,r)){const i=ON[r];x1(i)?e!=="_decayCurve"&&(this[e]=i[t]):this[e]=i}else if(Lm(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/i;i=(1-a)/o}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,i,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let l=1;l<o.length;l++)if(o[l-1]<=a&&a<=o[l]){o=this._attackCurve.slice(l),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,i,t)}if(s&&this.sustain<1){const o=t*this.sustain,l=e+i;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,s+l):this._sig.exponentialApproachValueAtTime(o,l,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(Ei(Lm(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return g6(this,e,t,r),this}asArray(){return Hl(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,r=new c3(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),a=s*.1,o=s+a,l=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:r}));return l._sig.toDestination(),l.triggerAttackRelease(t*(i+a)/o,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}rl([Mb(0)],Vg.prototype,"attack",void 0);rl([Mb(0)],Vg.prototype,"decay",void 0);rl([Sve(0,1)],Vg.prototype,"sustain",void 0);rl([Mb(0)],Vg.prototype,"release",void 0);const ON=(()=>{let e,t;const r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/127*(Math.PI/2));const i=[],s=6.4;for(e=0;e<127;e++){t=e/127;const h=Math.sin(t*(Math.PI*2)*s-Math.PI/2)+1;i[e]=h/10+t*.83}i[127]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/127*o)/o;const l=[];for(e=0;e<128;e++)t=e/127,l[e]=.5*(1-Math.cos(Math.PI*t));const c=[];for(e=0;e<128;e++){t=e/127;const h=Math.pow(t,3)*4+.2,g=Math.cos(h*Math.PI*2*t);c[e]=Math.abs(g*(1-t))}function u(h){const g=new Array(h.length);for(let p=0;p<h.length;p++)g[p]=1-h[p];return g}function f(h){return h.slice(0).reverse()}return{bounce:{In:u(c),Out:c},cosine:{In:r,Out:f(r)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:l,Out:u(l)},step:{In:a,Out:u(a)}}})();class Xv extends xr{constructor(){const e=pr(Xv.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new Sm({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Bs(this,"volume")}static getDefaults(){return Object.assign(xr.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const r=this["_original_"+e]=this[e];this[e]=(...i)=>{const s=i[t],a=this.context.transport.schedule(o=>{i[t]=o,r.apply(this,i)},s);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,r,i){const s=this.toSeconds(r),a=this.toSeconds(t);return this.triggerAttack(e,s,i),this.triggerRelease(s+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class L_ extends Xv{constructor(){const e=pr(L_.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Xv.getDefaults(),{detune:0,onsilence:co,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);const i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,r),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const r=this.toSeconds(t),i=e instanceof Im?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,s,r)}else this.frequency.setValueAtTime(i,r);return this}}rl([Mb(0)],L_.prototype,"portamento",void 0);class x6 extends Vg{constructor(){super(pr(x6.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new qi({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Xd extends L_{constructor(){const e=pr(Xd.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new Lw(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new x6(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Bs(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(L_.getDefaults(),{envelope:Object.assign(Ov(Vg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ov(Lw.getDefaults(),[...Object.keys(Lh.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const r=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class n4 extends L_{constructor(){const e=pr(n4.getDefaults(),arguments);super(e),this.name="ModulationSynth",this._carrier=new Xd({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Xd({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new ha({context:this.context,units:"frequency"}),this.detune=new ha({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new Yv({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new qi({context:this.context,gain:0}),Bs(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(L_.getDefaults(),{harmonicity:3,oscillator:Object.assign(Ov(Lw.getDefaults(),[...Object.keys(Lh.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Ov(Vg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Ov(Lw.getDefaults(),[...Object.keys(Lh.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Ov(Vg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Bw extends xr{constructor(){const e=pr(Bw.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Hi({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new Hi({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new Hi({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new Hi({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){Ei(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let a=0;a<e;a++){const l=Math.pow(a/e,2)*19980+20;t[a]=l}const r=new Float32Array(e),i=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(t,r,i),r}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class bd extends xr{constructor(){const e=pr(bd.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new qi({context:this.context}),this.output=new qi({context:this.context}),this._filters=[],this._filters=[],this.Q=new ha({context:this.context,units:"positive",value:e.Q}),this.frequency=new ha({context:this.context,units:"frequency",value:e.frequency}),this.detune=new ha({context:this.context,units:"cents",value:e.detune}),this.gain=new ha({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,Bs(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){Ei(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(r=>r.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const t=N_(e)?e:parseInt(e,10),r=[-12,-24,-48,-96];let i=r.indexOf(t);Ei(i!==-1,`rolloff can only be ${r.join(", ")}`),i+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(i);for(let s=0;s<i;s++){const a=new Bw({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[s]=a}this._internalChannels=this._filters,GE(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const t=new Bw({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),r=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{t.getFrequencyResponse(e).forEach((s,a)=>r[a]*=s)}),t.dispose(),r}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),l3(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class FV extends n4{constructor(){const e=pr(FV.getDefaults(),arguments);super(e),this.name="FMSynth",this.modulationIndex=new Yv({context:this.context,value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(n4.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Sre=[1,1.483,1.932,2.546,2.63,3.897];class zV extends L_{constructor(){const e=pr(zV.getDefaults(),arguments);super(e),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[],this.detune=new ha({context:this.context,units:"cents",value:e.detune}),this.frequency=new ha({context:this.context,units:"frequency"}),this._amplitude=new qi({context:this.context,gain:0}).connect(this.output),this._highpass=new bd({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let t=0;t<Sre.length;t++){const r=new h3({context:this.context,harmonicity:e.harmonicity,modulationIndex:e.modulationIndex,modulationType:"square",onstop:t===0?()=>this.onsilence(this):co,type:"square"});r.connect(this._highpass),this._oscillators[t]=r;const i=new Yv({context:this.context,value:Sre[t]});this._freqMultipliers[t]=i,this.frequency.chain(i,r.frequency),this.detune.connect(r.detune)}this._filterFreqScaler=new Uw({context:this.context,max:7e3,min:this.toFrequency(e.resonance)}),this.envelope=new Vg({attack:e.envelope.attack,attackCurve:"linear",context:this.context,decay:e.envelope.decay,release:e.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=e.octaves,this.octaves=e.octaves}static getDefaults(){return w1(L_.getDefaults(),{envelope:Object.assign(Ov(Vg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(e,t=1){return this.envelope.triggerAttack(e,t),this._oscillators.forEach(r=>r.start(e)),this.envelope.sustain===0&&this._oscillators.forEach(r=>{r.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(e){return this.envelope.triggerRelease(e),this._oscillators.forEach(t=>t.stop(e+this.toSeconds(this.envelope.release))),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(e){this._oscillators.forEach(t=>t.modulationIndex.value=e)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(e){this._oscillators.forEach(t=>t.harmonicity.value=e)}get resonance(){return this._filterFreqScaler.min}set resonance(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}dispose(){return super.dispose(),this._oscillators.forEach(e=>e.dispose()),this._freqMultipliers.forEach(e=>e.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class mR extends Xd{constructor(){const e=pr(mR.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Bs(this,["oscillator","envelope"])}static getDefaults(){return w1(L_.getDefaults(),Xd.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const r=this.toSeconds(t),i=this.toFrequency(e instanceof Im?e.toFrequency():e),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,r),this.oscillator.frequency.exponentialRampToValueAtTime(i,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}rl([Sve(0)],mR.prototype,"octaves",void 0);rl([Mb(0)],mR.prototype,"pitchDecay",void 0);class o1 extends Xv{constructor(){const e=pr(o1.getDefaults(),arguments);super(e),this.name="NoiseSynth",this.noise=new $E(Object.assign({context:this.context},e.noise)),this.envelope=new x6(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Xv.getDefaults(),{envelope:Object.assign(Ov(Vg.getDefaults(),Object.keys(xr.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Ov($E.getDefaults(),Object.keys(Lh.getDefaults())),{type:"white"})})}triggerAttack(e,t=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,t),this.noise.start(e),this.envelope.sustain===0&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,r),this.triggerRelease(t+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Eve=new Set;function jV(n){Eve.add(n)}function xve(n,e){const t=`registerProcessor("${n}", ${e})`;Eve.add(t)}const alt=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;jV(alt);const olt=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;jV(olt);const llt=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;jV(llt);const clt="feedback-comb-filter",ult=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;xve(clt,ult);class HV extends xr{constructor(){const e=pr(HV.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OnePoleFilter",this._frequency=e.frequency,this._type=e.type,this.input=new qi({context:this.context}),this.output=new qi({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(xr.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const e=this._filter,t=this.toFrequency(this._frequency),r=1/(2*Math.PI*t);if(this._type==="lowpass"){const i=1/(r*this.context.sampleRate),s=i-1;this._filter=this.context.createIIRFilter([i,0],[1,s])}else{const i=1/(r*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,i])}this.input.chain(this._filter,this.output),e&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(e),e.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(e){this._frequency=e,this._createFilter()}get type(){return this._type}set type(e){this._type=e,this._createFilter()}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let s=0;s<e;s++){const o=Math.pow(s/e,2)*19980+20;t[s]=o}const r=new Float32Array(e),i=new Float32Array(e);return this._filter.getFrequencyResponse(t,r,i),r}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class qV extends Xv{constructor(){const e=pr(qV.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=i=>this.releaseAll(i),Ei(!N_(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const t=e.voice.getDefaults();this.options=Object.assign(t,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const r=this._voices.indexOf(this._dummyVoice);this._voices.splice(r,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Xv.getDefaults(),{maxPolyphony:32,options:{},voice:Xd})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const t=this._activeVoices.findIndex(r=>r.voice===e);this._activeVoices.splice(t,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Ei(e instanceof L_,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else u6("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,t,r){e.forEach(i=>{const s=new t4(this.context,i).toMidi(),a=this._getNextAvailableVoice();a&&(a.triggerAttack(i,t,r),this._activeVoices.push({midi:s,voice:a,released:!1}),this.log("triggerAttack",i,t))})}_triggerRelease(e,t){e.forEach(r=>{const i=new t4(this.context,r).toMidi(),s=this._activeVoices.find(({midi:a,released:o})=>a===i&&!o);s&&(s.voice.triggerRelease(t),s.released=!0,this.log("triggerRelease",r,t))})}_scheduleEvent(e,t,r,i){Ei(!this.disposed,"Synth was already disposed"),r<=this.now()?e==="attack"?this._triggerAttack(t,r,i):this._triggerRelease(t,r):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,t,r,i)},r-this.now())}triggerAttack(e,t,r){Array.isArray(e)||(e=[e]);const i=this.toSeconds(t);return this._scheduleEvent("attack",e,i,r),this}triggerRelease(e,t){Array.isArray(e)||(e=[e]);const r=this.toSeconds(t);return this._scheduleEvent("release",e,r),this}triggerAttackRelease(e,t,r,i){const s=this.toSeconds(r);if(this.triggerAttack(e,s,i),Lm(t)){Ei(Lm(e),"If the duration is an array, the notes must also be an array"),e=e;for(let a=0;a<e.length;a++){const o=t[Math.min(a,t.length-1)],l=this.toSeconds(o);Ei(l>0,"The duration must be greater than 0"),this.triggerRelease(e[a],s+l)}}else{const a=this.toSeconds(t);Ei(a>0,"The duration must be greater than 0"),this.triggerRelease(e,s+a)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const t=Ov(e,["onsilence","context"]);return this.options=w1(this.options,t),this._voices.forEach(r=>r.set(t)),this._dummyVoice.set(t),this}get(){return this._dummyVoice.get()}releaseAll(e){const t=this.toSeconds(e);return this._activeVoices.forEach(({voice:r})=>{r.triggerRelease(t)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class m3 extends Xv{constructor(){const e=pr(m3.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(r=>{const i=parseInt(r,10);if(Ei(MN(r)||N_(i)&&isFinite(i),`url key is neither a note or midi pitch: ${r}`),MN(r)){const s=new Im(this.context,r).toMidi();t[s]=e.urls[r]}else N_(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new IV({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Xv.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:co,onerror:co,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach(i=>{const s=vve(new Im(this.context,i).toFrequency()),a=Math.round(s),o=s-a,l=this._findClosest(a),c=a-l,u=this._buffers.get(c),f=_ve(l+o),h=new f3({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:f}).connect(this.output);h.start(t,0,u.duration/f,r),Lm(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(h),h.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const g=this._activeSources.get(a),p=g.indexOf(h);p!==-1&&g.splice(p,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=new Im(this.context,r).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const s=this._activeSources.get(i);t=this.toSeconds(t),s.forEach(a=>{a.stop(t)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,i=1){const s=this.toSeconds(r);return this.triggerAttack(e,s,i),Lm(t)?(Ei(Lm(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const l=t[Math.min(o,t.length-1)];this.triggerRelease(a,s+this.toSeconds(l))})):this.triggerRelease(e,s+this.toSeconds(t)),this}add(e,t,r){if(Ei(MN(e)||isFinite(e),`note must be a pitch or midi: ${e}`),MN(e)){const i=new Im(this.context,e).toMidi();this._buffers.add(i,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}rl([Mb(0)],m3.prototype,"attack",void 0);rl([Mb(0)],m3.prototype,"release",void 0);class kT extends tp{constructor(){const e=pr(kT.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new u3("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(tp.getDefaults(),{callback:co,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,t=>{let r;if(t.state==="started"){t.id!==-1&&this.context.transport.clear(t.id);const i=t.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||N_(this._loop)&&this._loop>1){r=1/0,N_(this._loop)&&(r=this._loop*this._getLoopDuration());const s=this._state.getAfter(i);s!==null&&(r=Math.min(r,s.time-i)),r!==1/0&&(r=new Gf(this.context,r));const a=new Gf(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new Gf(this.context,i),r)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Gf(this.context,i))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const t=this.toTicks(e);return this._state.getValueAtTime(t)==="stopped"&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}stop(e){this.cancel(e);const t=this.toTicks(e);if(this._state.getValueAtTime(t)==="started"){this._state.setStateAtTime("stopped",t,{id:-1});const r=this._state.getBefore(t);let i=t;r!==null&&(i=r.time),this._rescheduleEvents(i)}return this}cancel(e){e=Lv(e,-1/0);const t=this.toTicks(e);return this._state.forEachFrom(t,r=>{this.context.transport.clear(r.id)}),this._state.cancel(t),this}_tick(e){const t=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(t)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let r=.02;F_e(this.humanize)||(r=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*r}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new Gf(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new Gf(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,t=this._state.get(e);if(t!==null&&t.state==="started"){const r=this._getLoopDuration();return(e-t.time)%r/r}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class tk extends kT{constructor(){const e=pr(tk.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new u3("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(t=>{Lm(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(kT.getDefaults(),{events:[]})}start(e,t){const r=this.toTicks(e);if(this._state.getValueAtTime(r)!=="started"){t=Lv(t,this._loop?this._loopStart:0),this._loop?t=Lv(t,this._loopStart):t=Lv(t,0);const i=this.toTicks(t);this._state.add({id:-1,offset:i,state:"started",time:r}),this._forEach(s=>{this._startNote(s,r,i)})}return this}_startNote(e,t,r){t-=r,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<r&&(t+=this._getLoopDuration()),e.start(new Gf(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=r&&(e.loop=!1,e.start(new Gf(this.context,t))):e.startOffset>=r&&e.start(new Gf(this.context,t))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(e){const t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach(r=>{r.stop(e)}),this}at(e,t){const r=new qT(this.context,e).toTicks(),i=new Gf(this.context,1).toSeconds(),s=this._events.values();let a=s.next();for(;!a.done;){const o=a.value;if(Math.abs(r-o.startOffset)<i)return Us(t)&&(o.value=t),o;a=s.next()}return Us(t)?(this.add(e,t),this.at(e)):null}add(e,t){e instanceof Object&&Reflect.has(e,"time")&&(t=e,e=t.time);const r=this.toTicks(e);let i;return t instanceof kT?(i=t,i.callback=this._tick.bind(this)):i=new kT({callback:this._tick.bind(this),context:this.context,value:t}),i.startOffset=r,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(e){this._state.forEach(t=>{t.state==="started"?this._startNote(e,t.time,t.offset):e.stop(new Gf(this.context,t.time))})}remove(e,t){return x1(e)&&e.hasOwnProperty("time")&&(t=e,e=t.time),e=this.toTicks(e),this._events.forEach(r=>{r.startOffset===e&&(Hg(t)||Us(t)&&r.value===t)&&(this._events.delete(r),r.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(t=>t.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(t=>{t instanceof tk?t._forEach(e):e(t)}),this}_setAll(e,t){this._forEach(r=>{r[e]=t})}_tick(e,t){this.mute||this.callback(e,t)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(t=>{t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.loop=e,this._testLoopBoundries(t)})}get loopEnd(){return new Gf(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopEnd=e,this._testLoopBoundries(t)})}get loopStart(){return new Gf(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class T6 extends xr{constructor(){const e=pr(T6.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new slt({context:this.context}),this.a=new qi({context:this.context,gain:0}),this.b=new qi({context:this.context,gain:0}),this.output=new qi({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new ha({context:this.context,units:"normalRange",value:e.fade}),Bs(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",P_(this._split,this.a.gain,0),P_(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(xr.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}let Wm=class extends xr{constructor(e){super(e),this.name="Effect",this._dryWet=new T6({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new qi({context:this.context}),this.effectReturn=new qi({context:this.context}),this.input=new qi({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Bs(this,"wet")}static getDefaults(){return Object.assign(xr.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};class VV extends xr{constructor(){const e=pr(VV.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Hi({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Bs(this,"pan")}static getDefaults(){return Object.assign(xr.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class GV extends xr{constructor(){const e=pr(GV.getDefaults(),arguments,["smoothing"]);super(e),this.name="Follower",this._abs=this.input=new ilt({context:this.context}),this._lowpass=this.output=new HV({context:this.context,frequency:1/this.toSeconds(e.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=e.smoothing}static getDefaults(){return Object.assign(xr.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class $V extends Wm{constructor(){const e=pr($V.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);super(e),this.name="AutoWah",this._follower=new GV({context:this.context,smoothing:e.follower}),this._sweepRange=new BV({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this._inputBoost=new qi({context:this.context}),this._bandpass=new bd({context:this.context,rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new bd({context:this.context,type:"peaking"}),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,Bs(this,["gain","Q"])}static getDefaults(){return Object.assign(Wm.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(e){this._follower.smoothing=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}get sensitivity(){return gve(1/this._inputBoost.gain.value)}set sensitivity(e){this._inputBoost.gain.value=1/mve(e)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const flt="bit-crusher",hlt=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;xve(flt,hlt);class w6 extends xr{constructor(){const e=pr(w6.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(xr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class g3 extends xr{constructor(){const e=pr(g3.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(xr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class r4 extends xr{constructor(e){super(e),this.name="StereoEffect",this.input=new qi({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new T6({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new w6({context:this.context,channels:2}),this._merge=new g3({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Bs(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),GE(...e),P_(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),GE(...e),P_(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(xr.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Ere extends r4{constructor(e){super(e),this.feedback=new ha({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new qi({context:this.context}),this._feedbackR=new qi({context:this.context}),this._feedbackSplit=new w6({context:this.context,channels:2}),this._feedbackMerge=new g3({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Bs(this,["feedback"])}static getDefaults(){return Object.assign(r4.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class WV extends Ere{constructor(){const e=pr(WV.getDefaults(),arguments,["frequency","delayTime","depth"]);super(e),this.name="Chorus",this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new WE({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new WE({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Dw({context:this.context}),this._delayNodeR=new Dw({context:this.context}),this.frequency=this._lfoL.frequency,Bs(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(Ere.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}get delayTime(){return this._delayTime*1e3}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class nk extends Wm{constructor(){const e=pr(nk.getDefaults(),arguments,["distortion"]);super(e),this.name="Distortion",this._shaper=new iS({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(Wm.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;const t=e*100,r=Math.PI/180;this._shaper.setMap(i=>Math.abs(i)<.001?0:(3+t)*i*20*r/(Math.PI+t*Math.abs(i)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class xre extends Wm{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new qi({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Bs(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Wm.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class YV extends xre{constructor(){const e=pr(YV.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new Dw({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Bs(this,"delayTime")}static getDefaults(){return Object.assign(xre.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class XV extends r4{constructor(){const e=pr(XV.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new WE({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new WE({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new ha({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),Bs(this,["frequency","Q"])}static getDefaults(){return Object.assign(r4.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,t){const r=[];for(let i=0;i<e;i++){const s=this.context.createBiquadFilter();s.type="allpass",this.Q.connect(s.Q),t.connect(s.frequency),r.push(s)}return r}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class KV extends Wm{constructor(){const e=pr(KV.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=this.toSeconds(e.decay);D0(t,.001),this._decay=t;const r=this.toSeconds(e.preDelay);D0(r,0),this._preDelay=r,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Wm.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),D0(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),D0(e,0),this._preDelay=e,this.generate()}generate(){return Hl(this,void 0,void 0,function*(){const e=this.ready,t=new c3(2,this._decay+this._preDelay,this.context.sampleRate),r=new $E({context:t}),i=new $E({context:t}),s=new g3({context:t});r.connect(s,0,0),i.connect(s,0,1);const a=new qi({context:t}).toDestination();s.connect(a),r.start(0),i.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=t.render();return this.ready=o.then(co),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class R6 extends Wm{constructor(){const e=pr(R6.getDefaults(),arguments,["frequency","depth"]);super(e),this.name="Vibrato",this._delayNode=new Dw({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new WE({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,Bs(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Wm.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class pf extends xr{constructor(){const e=pr(pf.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new qi({context:this.context}),pf._allSolos.has(this.context)||pf._allSolos.set(this.context,new Set),pf._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(xr.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),pf._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){pf._soloed.has(this.context)||pf._soloed.set(this.context,new Set),pf._soloed.get(this.context).add(this)}_removeSolo(){pf._soloed.has(this.context)&&pf._soloed.get(this.context).delete(this)}_isSoloed(){return pf._soloed.has(this.context)&&pf._soloed.get(this.context).has(this)}_noSolos(){return!pf._soloed.has(this.context)||pf._soloed.has(this.context)&&pf._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),pf._allSolos.get(this.context).delete(this),this._removeSolo(),this}}pf._allSolos=new Map;pf._soloed=new Map;class ZV extends xr{constructor(){const e=pr(ZV.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new VV({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Sm({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Bs(this,["pan","volume"])}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Em extends xr{constructor(){const e=pr(Em.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new pf({solo:e.solo,context:this.context}),this._panVol=this.output=new ZV({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Bs(this,["pan","volume"])}static getDefaults(){return Object.assign(xr.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Em.buses.has(e)||Em.buses.set(e,new qi({context:this.context})),Em.buses.get(e)}send(e,t=0){const r=this._getBus(e),i=new qi({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(r),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Em.buses=new Map;class JV extends xr{constructor(){const e=pr(JV.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(e),this.name="MultibandSplit",this.input=new qi({context:this.context}),this.output=void 0,this.low=new bd({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new bd({context:this.context,frequency:0,type:"highpass"}),this.mid=new bd({context:this.context,frequency:0,type:"lowpass"}),this.high=new bd({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new ha({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new ha({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new ha({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Bs(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),l3(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class QV extends xr{constructor(){const e=pr(QV.getDefaults(),arguments,["threshold","ratio"]);super(e),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new Hi({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new Hi({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new Hi({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new Hi({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new Hi({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),Bs(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(xr.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class G2 extends xr{constructor(){const e=pr(G2.getDefaults(),arguments,["low","mid","high"]);super(e),this.name="EQ3",this.output=new qi({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new JV({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new qi({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new qi({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new qi({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Bs(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(xr.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),l3(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}oc().transport;function Sz(){return oc().transport}oc().destination;oc().destination;function dlt(){return oc().destination}oc().listener;oc().draw;function plt(){return oc().draw}oc();function Tve(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function wve(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var Rve=[0,2,4,-1,1,3,5],Ave=Rve.map(n=>Math.floor(n*7/12));function Cve(n){const{step:e,alt:t,oct:r,dir:i=1}=n,s=Rve[e]+7*t;if(r===void 0)return[i*s];const a=r-Ave[e]-4*t;return[i*s,i*a]}var mlt=[3,0,4,1,5,2,6];function glt(n){const[e,t,r]=n,i=mlt[_lt(e)],s=Math.floor((e+1)/7);if(t===void 0)return{step:i,alt:s,dir:r};const a=t+4*s+Ave[i];return{step:i,alt:s,oct:a,dir:r}}function _lt(n){const e=(n+1)%7;return e<0?7+e:e}var Tre=(n,e)=>Array(Math.abs(e)+1).join(n),Ez=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),vlt="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",ylt="(AA|A|P|M|m|d|dd)([-+]?\\d+)",blt=new RegExp("^"+vlt+"|"+ylt+"$");function Slt(n){const e=blt.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var wre={};function i4(n){return typeof n=="string"?wre[n]||(wre[n]=Elt(n)):wve(n)?i4(Tlt(n)):Tve(n)?i4(n.name):Ez}var Rre=[0,2,4,5,7,9,11],Mve="PMMPPMM";function Elt(n){const e=Slt(n);if(e[0]==="")return Ez;const t=+e[0],r=e[1],i=(Math.abs(t)-1)%7,s=Mve[i];if(s==="M"&&r==="P")return Ez;const a=s==="M"?"majorable":"perfectable",o=""+t+r,l=t<0?-1:1,c=t===8||t===-8?t:l*(i+1),u=xlt(a,r),f=Math.floor((Math.abs(t)-1)/7),h=l*(Rre[i]+u+12*f),g=(l*(Rre[i]+u)%12+12)%12,p=Cve({step:i,alt:u,oct:f,dir:l});return{empty:!1,name:o,num:t,q:r,step:i,alt:u,dir:l,type:a,simple:c,semitones:h,chroma:g,coord:p,oct:f}}function xlt(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function Tlt(n){const{step:e,alt:t,oct:r=0,dir:i}=n;if(!i)return"";const s=e+1+7*r,a=s===0?e+1:s,o=i<0?"-":"",l=Mve[e]==="M"?"majorable":"perfectable";return o+a+wlt(l,t)}function wlt(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?Tre("A",e):Tre("d",n==="perfectable"?e:e+1)}var Are=(n,e)=>Array(Math.abs(e)+1).join(n),Ove=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),Cre=new Map,Rlt=n=>"CDEFGAB".charAt(n),Alt=n=>n<0?Are("b",-n):Are("#",n),Clt=n=>n[0]==="b"?-n.length:n.length;function rk(n){const e=JSON.stringify(n),t=Cre.get(e);if(t)return t;const r=typeof n=="string"?Nlt(n):wve(n)?rk(Plt(n)):Tve(n)?rk(n.name):Ove;return Cre.set(e,r),r}var Mlt=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Olt(n){const e=Mlt.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function klt(n){return rk(glt(n))}var Ilt=(n,e)=>(n%e+e)%e,SF=[0,2,4,5,7,9,11];function Nlt(n){const e=Olt(n);if(e[0]===""||e[3]!=="")return Ove;const t=e[0],r=e[1],i=e[2],s=(t.charCodeAt(0)+3)%7,a=Clt(r),o=i.length?+i:void 0,l=Cve({step:s,alt:a,oct:o}),c=t+r+i,u=t+r,f=(SF[s]+a+120)%12,h=o===void 0?Ilt(SF[s]+a,12)-1188:SF[s]+a+12*(o+1),g=h>=0&&h<=127?h:null,p=o===void 0?null:Math.pow(2,(h-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:f,coord:l,freq:p,height:h,letter:t,midi:g,name:c,oct:o,pc:u,step:s}}function Plt(n){const{step:e,alt:t,oct:r}=n,i=Rlt(e);if(!i)return"";const s=i+Alt(t);return r||r===0?s+r:s}function kve(n,e){const t=rk(n),r=Array.isArray(e)?e:i4(e).coord;if(t.empty||!r||r.length<2)return"";const i=t.coord,s=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return klt(s).name}function Ive(n,e){const t=e.length,r=(n%t+t)%t;return e.slice(r,t).concat(e.slice(0,r))}var YE={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Nve=n=>Number(n).toString(2).padStart(12,"0"),Mre=n=>parseInt(n,2),Dlt=/^[01]{12}$/;function Pve(n){return Dlt.test(n)}var Llt=n=>typeof n=="number"&&n>=0&&n<=4095,Ult=n=>n&&Pve(n.chroma),Ore={[YE.chroma]:YE};function Dve(n){const e=Pve(n)?n:Llt(n)?Nve(n):Array.isArray(n)?Hlt(n):Ult(n)?n.chroma:YE.chroma;return Ore[e]=Ore[e]||jlt(e)}var Blt=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function Flt(n){const e=[];for(let t=0;t<12;t++)n.charAt(t)==="1"&&e.push(Blt[t]);return e}function zlt(n){const e=n.split("");return e.map((t,r)=>Ive(r,e).join(""))}function jlt(n){const e=Mre(n),t=zlt(n).map(Mre).filter(s=>s>=2048).sort()[0],r=Nve(t),i=Flt(n);return{empty:!1,name:"",setNum:e,chroma:n,normalized:r,intervals:i}}function Hlt(n){if(n.length===0)return YE.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<n.length;r++)e=rk(n[r]),e.empty&&(e=i4(n[r])),e.empty||(t[e.chroma]=1);return t.join("")}var qlt=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Vlt=qlt;({...YE});var Lve=[],NP={};function Glt(n,e,t){const r=Wlt(n),i={...Dve(n),name:t||"",quality:r,intervals:n,aliases:e};Lve.push(i),i.name&&(NP[i.name]=i),NP[i.setNum]=i,NP[i.chroma]=i,i.aliases.forEach(s=>$lt(i,s))}function $lt(n,e){NP[e]=n}function Wlt(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Vlt.forEach(([n,e,t])=>Glt(n.split(" "),t.split(" "),e));Lve.sort((n,e)=>n.setNum-e.setNum);var Ylt=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],Xlt=Ylt,Klt={...YE,intervals:[],aliases:[]},$2={};function Zlt(n){return $2[n]||Klt}function Jlt(n,e,t=[]){const r={...Dve(n),name:e,intervals:n,aliases:t};return $2[r.name]=r,$2[r.setNum]=r,$2[r.chroma]=r,r.aliases.forEach(i=>Qlt(r,i)),r}function Qlt(n,e){$2[e]=n}Xlt.forEach(([n,e,...t])=>Jlt(n.split(" "),e,t));var ect=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],tct=ect;tct.forEach(([n,e,t])=>void 0);var nct=kve;function rct(n,e){return nct(n,[0,e])}var eG=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],kre={...YE,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},ict=eG.map(sct),xz={};ict.forEach(n=>{xz[n.name]=n,n.aliases.forEach(e=>{xz[e]=n})});function Uve(n){return typeof n=="string"?xz[n.toLowerCase()]||kre:n&&n.name?Uve(n.name):kre}function sct(n){const[e,t,r,i,s,a,o]=n,l=o?[o]:[],c=Number(t).toString(2);return{empty:!1,intervals:Zlt(i).intervals,modeNum:e,chroma:c,normalized:c,name:i,setNum:t,alt:r,triad:s,seventh:a,aliases:l}}function Bve(n){return(e,t)=>{const r=Uve(e);if(r.empty)return[];const i=Ive(r.modeNum,n),s=r.intervals.map(a=>kve(t,a));return i.map((a,o)=>s[o]+a)}}Bve(eG.map(n=>n[4]));Bve(eG.map(n=>n[5]));function act(n,e){const t=new G2(-6,6,10).connect(n),r=new bd(8e3,"highpass",-12);r.connect(t);const i=new o1;i.set({envelope:{attack:.001,decay:.05,sustain:.001,release:.05}}),i.connect(r);function s(Ne,Ae){i.triggerAttackRelease(Ne,Ae)}const a=new G2(-6,3,8).connect(n),o=new bd(6e3,"highpass",-12);o.connect(a);const l=new o1;l.set({envelope:{attack:.001,decay:.2,sustain:.1,release:.3}}),l.connect(o);function c(Ne,Ae){l.triggerAttackRelease(Ne,Ae)}function u(Ne){s("16n",Ne)}function f(Ne){c("8n",Ne)}const h=new bd(350,"bandpass").connect(n),g=new qi().connect(h);g.gain.value=0;const p=new qV().connect(g);p.volume.value=16,p.maxPolyphony=8,p.set({envelope:{attack:.001,decay:.01,sustain:.1,release:.1},oscillator:{type:"square"}});function _(Ne,Ae){const Xe=Rh("64n").toSeconds()+Rh(Ne).toSeconds();g.gain.setValueAtTime(.5,Ae),g.gain.exponentialRampToValueAtTime(.01,Xe+Ae),p.triggerAttackRelease([800,540],Ne,Ae)}const y=new G2(-10,10,-1).connect(n);y.connect(e);const v=new bd(800,"highpass",-12);v.connect(y);const x=new o1;x.set({envelope:{attack:.01,decay:.1,sustain:.1,release:.1}}),x.connect(v);function E(Ne,Ae){x.triggerAttackRelease(Ne,Ae)}const M=new nk().connect(n);M.set({distortion:.666});const k=new Xd;k.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),k.connect(M);const N=new bd;N.set({type:"highpass",frequency:1e4}),N.connect(M);const I=new o1;I.set({envelope:{attack:.01,decay:.1,sustain:0,release:.1}}),I.connect(N);function D(Ne,Ae){const Xe=Rh("512n").toSeconds(),$e=Rh("32n").toSeconds();k.triggerAttackRelease(1e4,Ne,Ae,1),k.frequency.exponentialRampToValueAtTime(300,Ae+Xe),k.frequency.exponentialRampToValueAtTime(100,Ae+$e),I.triggerAttackRelease("8n",Ae,.333),I.volume.setValueAtTime(1,Ae),I.volume.exponentialRampToValueAtTime(0,Ae+Rh("32n").toSeconds())}const V=new bd;V.set({type:"bandpass",frequency:256,Q:.17}),V.connect(n);const G=new Xd;G.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),G.connect(V);const J=new Xd;J.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),J.connect(V);function B(Ne,Ae){G.triggerAttackRelease(2e3,Ne,Ae),G.frequency.exponentialRampToValueAtTime(1e3,Ae+Rh("32n").toSeconds()),J.triggerAttackRelease(999,Ne,Ae),J.frequency.exponentialRampToValueAtTime(888,Ae+Rh("256n").toSeconds())}const $=new nk().connect(n);$.set({distortion:.876});const U=new Xd;U.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),U.connect($);const Q=new bd;Q.set({type:"highpass",frequency:1e4}),Q.connect($);const W=new o1;W.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}}),W.connect(Q);function q(Ne,Ae){const Xe=Rh("512n").toSeconds(),$e=Rh("32n").toSeconds();U.triggerAttackRelease(1e4,Ne,Ae,1),U.frequency.exponentialRampToValueAtTime(150,Ae+Xe),U.frequency.exponentialRampToValueAtTime(100,Ae+$e),W.triggerAttackRelease("8n",Ae,.25),W.volume.setValueAtTime(1,Ae),W.volume.exponentialRampToValueAtTime(0,Ae+Rh("32n").toSeconds())}const Y=new Xd().connect(n);Y.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"sawtooth"}});const ae=new Xd().connect(n);Y.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"triangle"}});const Z=new o1().connect(n);Z.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}});function K(Ne,Ae){const Xe=Rh("256n").toSeconds(),$e=Rh(Ne).toSeconds()-Xe;Y.triggerAttackRelease("C4",$e,Ae,1),Y.frequency.exponentialRampToValueAtTime(vre("C0").toFrequency(),Ae+$e),ae.triggerAttackRelease("C5",$e,Ae,.5),ae.frequency.exponentialRampToValueAtTime(vre("C0").toFrequency(),Ae+$e);const at=Rh("4n").toSeconds();Z.triggerAttackRelease("8n",Ae),Z.volume.setValueAtTime(1,Ae),Z.volume.exponentialRampToValueAtTime(0,Ae+at)}const ne=new bd;ne.set({type:"bandpass",frequency:256,Q:.17}),ne.connect(n);const le=new Xd;le.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),le.connect(ne);const ce=new Xd;ce.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),ce.connect(ne);function de(Ne,Ae){le.triggerAttackRelease(2e3,Ne,Ae),le.frequency.exponentialRampToValueAtTime(100,Ae+Rh("32n").toSeconds()),ce.triggerAttackRelease(699,Ne,Ae),ce.frequency.exponentialRampToValueAtTime(399,Ae+Rh("256n").toSeconds())}const Me=new mR().connect(n);Me.set({octaves:8,volume:8,pitchDecay:.125}),Me.connect(e);function qe(Ne){Me.triggerAttackRelease("C1","8n",Ne)}return{ticktrigger:u,tweettrigger:f,cowbelltrigger:_,claptrigger:E,hisnaretrigger:D,hiwoodblocktrigger:B,lowsnaretrigger:q,lowtomtrigger:K,lowwoodblocktrigger:de,basstrigger:qe}}const oct="data:text/javascript;base64,Ly8gQSBkb3duc2FtcGxpbmcvZGVncmFkaW5nIHByb2Nlc3NpbmcgZWZmZWN0Ci8vIFNhbXBsZSBhbmQgaG9sZHMgdGhlIHNpZ25hbCBiYXNlZCBvbiBhbiBpbmNyZW1lbnRpbmcgY291bnRlcgovLyB3cml0dGVuIGJ5IFRpbW8gSG9vZ2xhbmQsIChjKSAyMDIzLCB3d3cudGltb2hvb2dsYW5kLmNvbQovLwoKY2xhc3MgU3ludGhGQ3J1c2hXb3JrbGV0UHJvY2Vzc29yIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHsKICBzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCkgewogICAgcmV0dXJuIFsKICAgICAgewogICAgICAgIG5hbWU6ICdyYXRlJywKICAgICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgICAgbWluVmFsdWU6IDEsCiAgICAgICAgbWF4VmFsdWU6IDUxMiwKICAgICAgfSwKICAgIF0KICB9CgogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKQogICAgLy8gdGhlIGZyYW1lIGNvdW50ZXIKICAgIHRoaXMuY291bnQgPSAwCiAgICAvLyBzYW1wbGUgYW5kIGhvbGQgdmFyaWFibGUgYXJyYXkKICAgIHRoaXMuc2FoID0gW10KICB9CgogIHByb2Nlc3MoaW5wdXRzLCBvdXRwdXRzLCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCBpbnB1dCA9IGlucHV0c1swXQogICAgY29uc3Qgb3V0cHV0ID0gb3V0cHV0c1swXQoKICAgIC8vIGlmIHRoZXJlIGlzIGFueXRoaW5nIHRvIHByb2Nlc3MKICAgIGlmIChpbnB1dC5sZW5ndGggPiAwKSB7CiAgICAgIC8vIGZvciB0aGUgbGVuZ3RoIG9mIHRoZSBzYW1wbGUgYXJyYXkgKGdlbmVyYWxseSAxMjgpCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXRbMF0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBmb3IgZXZlcnkgY2hhbm5lbAogICAgICAgIGZvciAobGV0IGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgaW5wdXQubGVuZ3RoOyArK2NoYW5uZWwpIHsKICAgICAgICAgIC8vIGlmIGNvdW50ZXIgZXF1YWxzIDAsIHNhbXBsZSBhbmQgaG9sZAogICAgICAgICAgaWYgKHRoaXMuY291bnQgJSBwYXJhbWV0ZXJzLnJhdGUgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5zYWhbY2hhbm5lbF0gPSBpbnB1dFtjaGFubmVsXVtpXQogICAgICAgICAgfQogICAgICAgICAgLy8gb3V0cHV0IHRoZSBjdXJyZW50bHkgaGVsZCBzYW1wbGUKICAgICAgICAgIG91dHB1dFtjaGFubmVsXVtpXSA9IHRoaXMuc2FoW2NoYW5uZWxdCiAgICAgICAgfQogICAgICAgIC8vIGluY3JlbWVudCBzYW1wbGUgY291bnRlcgogICAgICAgIHRoaXMuY291bnQrKwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWUKICB9Cn0KCnJlZ2lzdGVyUHJvY2Vzc29yKCdmY3J1c2hwcm9jZXNzb3InLCBTeW50aEZDcnVzaFdvcmtsZXRQcm9jZXNzb3IpCg==";class tG extends Wm{name="FrequencyCrusher";rate;_audioworkletnode=this.context.createAudioWorkletNode("fcrushprocessor");constructor(){const e=pr(tG.getDefaults(),arguments,["rate"]);super(e),this.rate=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("rate"),value:e.rate,minValue:1,maxValue:512}),this.connectEffect(this._audioworkletnode)}static getDefaults(){return Object.assign(Wm.getDefaults(),{rate:64})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}function lct(){return oc().rawContext.audioWorklet.addModule(oct)}function Cp(n){return 20*Math.log10(n)-35}function cct(){const n=new KV,e=El(n.get()),t=new YV,r=El(t.get()),i=new XV,s=El(i.get()),a=new nk,o=El(a.get()),l=new R6,c=El(l.get()),u=new tG,f=El(u.get()),h=new $V,g=El(h.get());function p(){n.set({...e,wet:1}),t.set({...r,wet:1,delayTime:"8n",maxDelay:"8n",feedback:.666}),i.set({...s,wet:1,frequency:5,octaves:.5,baseFrequency:400}),a.set({...o,wet:1,oversample:"4x"}),l.set({...c,wet:1,depth:0,maxDelay:.5}),u.set({...f,wet:1,rate:32}),h.set({...g,wet:1})}function _(){return{fc:El(u.get()),echo:El(t.get()),reverb:El(n.get()),phaser:El(i.get()),vibrato:El(l.get()),distortion:El(a.get())}}function y(x){u.set(x.fc),t.set(x.echo),n.set(x.reverb),i.set(x.phaser),l.set(x.vibrato),a.set(x.distortion)}function v(){u.dispose(),t.dispose(),n.dispose(),i.dispose(),l.dispose(),a.dispose()}return p(),{fc:u,echo:t,reverb:n,phaser:i,vibrato:l,distortion:a,applyreset:p,getreplay:_,setreplay:y,autowah:h,fcrush:u,distort:a,destroy:v}}function EF(n){const e=oc().isOffline?"offline":"",t=new Em(Cp(0)),r=new Em(Cp(0)),i=new Em(Cp(0)),s=new Em(Cp(0)),a=new Em(Cp(0)),o=new Em(Cp(0)),l=new Em(Cp(0));t.receive(`${e}fc${n}`),r.receive(`${e}echo${n}`),i.receive(`${e}reverb${n}`),s.receive(`${e}phaser${n}`),a.receive(`${e}vibrato${n}`),o.receive(`${e}distortion${n}`),l.receive(`${e}autowah${n}`);const c=new Em;c.send(`${e}fc${n}`),c.send(`${e}echo${n}`),c.send(`${e}reverb${n}`),c.send(`${e}phaser${n}`),c.send(`${e}vibrato${n}`),c.send(`${e}distortion${n}`),c.send(`${e}autowah${n}`);function u(){return{fc:t.volume.value,echo:r.volume.value,reverb:i.volume.value,phaser:s.volume.value,vibrato:a.volume.value,distortion:o.volume.value,autowah:l.volume.value}}function f(g){t.volume.value=g.fc,r.volume.value=g.echo,i.volume.value=g.reverb,s.volume.value=g.phaser,a.volume.value=g.vibrato,o.volume.value=g.distortion,l.volume.value=g.autowah}function h(){t.dispose(),r.dispose(),i.dispose(),s.dispose(),a.dispose(),o.dispose(),l.dispose(),c.dispose()}return{sendtofx:c,fc:t,echo:r,reverb:i,phaser:s,vibrato:a,distortion:o,autowah:l,fcrush:t,distort:o,getreplay:u,setreplay:f,destroy:h}}function uct(n){return new Int8Array(n)}function fct(n){return new Int16Array(n)}function Fve(n){return new Int32Array(n)}function zve(n){return new Float32Array(n)}function hct(n){return new Float64Array(n)}function jve(n){if(n.length==1)return zve(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(jve(n));return t}function Hve(n){if(n.length==1)return Fve(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(Hve(n));return t}function qve(n){if(n.length==1)return fct(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(qve(n));return t}function Vve(n){if(n.length==1)return new Array(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(Vve(n));return t}var Gve={};Gve.fill=function(n,e,t,r){if(arguments.length==2)for(var i=0;i<n.length;i++)n[i]=arguments[1];else for(var i=e;i<t;i++)n[i]=r};var _3={};_3.arraycopy=function(n,e,t,r,i){for(var s=e+i;e<s;)t[r++]=n[e++]};_3.out={};_3.out.println=function(n){console.log(n)};_3.out.printf=function(){console.log.apply(console,arguments)};var A6={};A6.SQRT2=1.4142135623730951;A6.FAST_LOG10=function(n){return Math.log10(n)};A6.FAST_LOG10_X=function(n,e){return Math.log10(n)*e};function gb(n){this.ordinal=n}gb.short_block_allowed=new gb(0);gb.short_block_coupled=new gb(1);gb.short_block_dispensed=new gb(2);gb.short_block_forced=new gb(3);var $ve={};$ve.MAX_VALUE=34028235e31;function Gg(n){this.ordinal=n}Gg.vbr_off=new Gg(0);Gg.vbr_mt=new Gg(1);Gg.vbr_rh=new Gg(2);Gg.vbr_abr=new Gg(3);Gg.vbr_mtrh=new Gg(4);Gg.vbr_default=Gg.vbr_mtrh;var dct=function(n){},Rc={System:_3,VbrMode:Gg,Float:$ve,ShortBlock:gb,Util:A6,Arrays:Gve,new_array_n:Vve,new_byte:uct,new_double:hct,new_float:zve,new_float_n:jve,new_int:Fve,new_int_n:Hve,new_short_n:qve,assert:dct},xF,Ire;function pct(){if(Ire)return xF;Ire=1;var n=Rc,e=n.System,t=n.Util,r=n.Arrays,i=n.new_float,s=ap();function a(){var o=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*t.SQRT2*.5/2384e-9,.017876148*t.SQRT2*.5/2384e-9,.003134727*t.SQRT2*.5/2384e-9,.002457142*t.SQRT2*.5/2384e-9,971317e-9*t.SQRT2*.5/2384e-9,218868e-9*t.SQRT2*.5/2384e-9,101566e-9*t.SQRT2*.5/2384e-9,13828e-9*t.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],l=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],c=l[s.SHORT_TYPE],u=l[s.SHORT_TYPE],f=l[s.SHORT_TYPE],h=l[s.SHORT_TYPE],g=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function p(v,x,E){for(var M=10,k=x+238-14-286,N=-15;N<0;N++){var I,D,V;I=o[M+-10],D=v[k+-224]*I,V=v[x+224]*I,I=o[M+-9],D+=v[k+-160]*I,V+=v[x+160]*I,I=o[M+-8],D+=v[k+-96]*I,V+=v[x+96]*I,I=o[M+-7],D+=v[k+-32]*I,V+=v[x+32]*I,I=o[M+-6],D+=v[k+32]*I,V+=v[x+-32]*I,I=o[M+-5],D+=v[k+96]*I,V+=v[x+-96]*I,I=o[M+-4],D+=v[k+160]*I,V+=v[x+-160]*I,I=o[M+-3],D+=v[k+224]*I,V+=v[x+-224]*I,I=o[M+-2],D+=v[x+-256]*I,V-=v[k+256]*I,I=o[M+-1],D+=v[x+-192]*I,V-=v[k+192]*I,I=o[M+0],D+=v[x+-128]*I,V-=v[k+128]*I,I=o[M+1],D+=v[x+-64]*I,V-=v[k+64]*I,I=o[M+2],D+=v[x+0]*I,V-=v[k+0]*I,I=o[M+3],D+=v[x+64]*I,V-=v[k+-64]*I,I=o[M+4],D+=v[x+128]*I,V-=v[k+-128]*I,I=o[M+5],D+=v[x+192]*I,V-=v[k+-192]*I,D*=o[M+6],I=V-D,E[30+N*2]=V+D,E[31+N*2]=o[M+7]*I,M+=18,x--,k++}{var D,V,G,J;V=v[x+-16]*o[M+-10],D=v[x+-32]*o[M+-2],V+=(v[x+-48]-v[x+16])*o[M+-9],D+=v[x+-96]*o[M+-1],V+=(v[x+-80]+v[x+48])*o[M+-8],D+=v[x+-160]*o[M+0],V+=(v[x+-112]-v[x+80])*o[M+-7],D+=v[x+-224]*o[M+1],V+=(v[x+-144]+v[x+112])*o[M+-6],D-=v[x+32]*o[M+2],V+=(v[x+-176]-v[x+144])*o[M+-5],D-=v[x+96]*o[M+3],V+=(v[x+-208]+v[x+176])*o[M+-4],D-=v[x+160]*o[M+4],V+=(v[x+-240]-v[x+208])*o[M+-3],D-=v[x+224],G=D-V,J=D+V,V=E[14],D=E[15]-V,E[31]=J+V,E[30]=G+D,E[15]=G-D,E[14]=J-V}{var B;B=E[28]-E[0],E[0]+=E[28],E[28]=B*o[M+-36+7],B=E[29]-E[1],E[1]+=E[29],E[29]=B*o[M+-36+7],B=E[26]-E[2],E[2]+=E[26],E[26]=B*o[M+-72+7],B=E[27]-E[3],E[3]+=E[27],E[27]=B*o[M+-72+7],B=E[24]-E[4],E[4]+=E[24],E[24]=B*o[M+-108+7],B=E[25]-E[5],E[5]+=E[25],E[25]=B*o[M+-108+7],B=E[22]-E[6],E[6]+=E[22],E[22]=B*t.SQRT2,B=E[23]-E[7],E[7]+=E[23],E[23]=B*t.SQRT2-E[7],E[7]-=E[6],E[22]-=E[7],E[23]-=E[22],B=E[6],E[6]=E[31]-B,E[31]=E[31]+B,B=E[7],E[7]=E[30]-B,E[30]=E[30]+B,B=E[22],E[22]=E[15]-B,E[15]=E[15]+B,B=E[23],E[23]=E[14]-B,E[14]=E[14]+B,B=E[20]-E[8],E[8]+=E[20],E[20]=B*o[M+-180+7],B=E[21]-E[9],E[9]+=E[21],E[21]=B*o[M+-180+7],B=E[18]-E[10],E[10]+=E[18],E[18]=B*o[M+-216+7],B=E[19]-E[11],E[11]+=E[19],E[19]=B*o[M+-216+7],B=E[16]-E[12],E[12]+=E[16],E[16]=B*o[M+-252+7],B=E[17]-E[13],E[13]+=E[17],E[17]=B*o[M+-252+7],B=-E[20]+E[24],E[20]+=E[24],E[24]=B*o[M+-216+7],B=-E[21]+E[25],E[21]+=E[25],E[25]=B*o[M+-216+7],B=E[4]-E[8],E[4]+=E[8],E[8]=B*o[M+-216+7],B=E[5]-E[9],E[5]+=E[9],E[9]=B*o[M+-216+7],B=E[0]-E[12],E[0]+=E[12],E[12]=B*o[M+-72+7],B=E[1]-E[13],E[1]+=E[13],E[13]=B*o[M+-72+7],B=E[16]-E[28],E[16]+=E[28],E[28]=B*o[M+-72+7],B=-E[17]+E[29],E[17]+=E[29],E[29]=B*o[M+-72+7],B=t.SQRT2*(E[2]-E[10]),E[2]+=E[10],E[10]=B,B=t.SQRT2*(E[3]-E[11]),E[3]+=E[11],E[11]=B,B=t.SQRT2*(-E[18]+E[26]),E[18]+=E[26],E[26]=B-E[18],B=t.SQRT2*(-E[19]+E[27]),E[19]+=E[27],E[27]=B-E[19],B=E[2],E[19]-=E[3],E[3]-=B,E[2]=E[31]-B,E[31]+=B,B=E[3],E[11]-=E[19],E[18]-=B,E[3]=E[30]-B,E[30]+=B,B=E[18],E[27]-=E[11],E[19]-=B,E[18]=E[15]-B,E[15]+=B,B=E[19],E[10]-=B,E[19]=E[14]-B,E[14]+=B,B=E[10],E[11]-=B,E[10]=E[23]-B,E[23]+=B,B=E[11],E[26]-=B,E[11]=E[22]-B,E[22]+=B,B=E[26],E[27]-=B,E[26]=E[7]-B,E[7]+=B,B=E[27],E[27]=E[6]-B,E[6]+=B,B=t.SQRT2*(E[0]-E[4]),E[0]+=E[4],E[4]=B,B=t.SQRT2*(E[1]-E[5]),E[1]+=E[5],E[5]=B,B=t.SQRT2*(E[16]-E[20]),E[16]+=E[20],E[20]=B,B=t.SQRT2*(E[17]-E[21]),E[17]+=E[21],E[21]=B,B=-t.SQRT2*(E[8]-E[12]),E[8]+=E[12],E[12]=B-E[8],B=-t.SQRT2*(E[9]-E[13]),E[9]+=E[13],E[13]=B-E[9],B=-t.SQRT2*(E[25]-E[29]),E[25]+=E[29],E[29]=B-E[25],B=-t.SQRT2*(E[24]+E[28]),E[24]-=E[28],E[28]=B-E[24],B=E[24]-E[16],E[24]=B,B=E[20]-B,E[20]=B,B=E[28]-B,E[28]=B,B=E[25]-E[17],E[25]=B,B=E[21]-B,E[21]=B,B=E[29]-B,E[29]=B,B=E[17]-E[1],E[17]=B,B=E[9]-B,E[9]=B,B=E[25]-B,E[25]=B,B=E[5]-B,E[5]=B,B=E[21]-B,E[21]=B,B=E[13]-B,E[13]=B,B=E[29]-B,E[29]=B,B=E[1]-E[0],E[1]=B,B=E[16]-B,E[16]=B,B=E[17]-B,E[17]=B,B=E[8]-B,E[8]=B,B=E[9]-B,E[9]=B,B=E[24]-B,E[24]=B,B=E[25]-B,E[25]=B,B=E[4]-B,E[4]=B,B=E[5]-B,E[5]=B,B=E[20]-B,E[20]=B,B=E[21]-B,E[21]=B,B=E[12]-B,E[12]=B,B=E[13]-B,E[13]=B,B=E[28]-B,E[28]=B,B=E[29]-B,E[29]=B,B=E[0],E[0]+=E[31],E[31]-=B,B=E[1],E[1]+=E[30],E[30]-=B,B=E[16],E[16]+=E[15],E[15]-=B,B=E[17],E[17]+=E[14],E[14]-=B,B=E[8],E[8]+=E[23],E[23]-=B,B=E[9],E[9]+=E[22],E[22]-=B,B=E[24],E[24]+=E[7],E[7]-=B,B=E[25],E[25]+=E[6],E[6]-=B,B=E[4],E[4]+=E[27],E[27]-=B,B=E[5],E[5]+=E[26],E[26]-=B,B=E[20],E[20]+=E[11],E[11]-=B,B=E[21],E[21]+=E[10],E[10]-=B,B=E[12],E[12]+=E[19],E[19]-=B,B=E[13],E[13]+=E[18],E[18]-=B,B=E[28],E[28]+=E[3],E[3]-=B,B=E[29],E[29]+=E[2],E[2]-=B}}function _(v,x){for(var E=0;E<3;E++){var M,k,N,I,D,V;I=v[x+6]*l[s.SHORT_TYPE][0]-v[x+15],M=v[x+0]*l[s.SHORT_TYPE][2]-v[x+9],k=I+M,N=I-M,I=v[x+15]*l[s.SHORT_TYPE][0]+v[x+6],M=v[x+9]*l[s.SHORT_TYPE][2]+v[x+0],D=I+M,V=-I+M,M=(v[x+3]*l[s.SHORT_TYPE][1]-v[x+12])*2069978111953089e-26,I=(v[x+12]*l[s.SHORT_TYPE][1]+v[x+3])*2069978111953089e-26,v[x+0]=k*190752519173728e-25+M,v[x+15]=-D*190752519173728e-25+I,N=N*.8660254037844387*1907525191737281e-26,D=D*.5*1907525191737281e-26+I,v[x+3]=N-D,v[x+6]=N+D,k=k*.5*1907525191737281e-26-M,V=V*.8660254037844387*1907525191737281e-26,v[x+9]=k+V,v[x+12]=k-V,x++}}function y(v,x,E){var M,k;{var N,I,D,V,G,J,B,$;N=E[17]-E[9],D=E[15]-E[11],V=E[14]-E[12],G=E[0]+E[8],J=E[1]+E[7],B=E[2]+E[6],$=E[3]+E[5],v[x+17]=G+B-$-(J-E[4]),k=(G+B-$)*u[19]+(J-E[4]),M=(N-D-V)*u[18],v[x+5]=M+k,v[x+6]=M-k,I=(E[16]-E[10])*u[18],J=J*u[19]+E[4],M=N*u[12]+I+D*u[13]+V*u[14],k=-G*u[16]+J-B*u[17]+$*u[15],v[x+1]=M+k,v[x+2]=M-k,M=N*u[13]-I-D*u[14]+V*u[12],k=-G*u[17]+J-B*u[15]+$*u[16],v[x+9]=M+k,v[x+10]=M-k,M=N*u[14]-I+D*u[12]-V*u[13],k=G*u[15]-J+B*u[16]-$*u[17],v[x+13]=M+k,v[x+14]=M-k}{var U,Q,W,q,Y,ae,Z,K;U=E[8]-E[0],W=E[6]-E[2],q=E[5]-E[3],Y=E[17]+E[9],ae=E[16]+E[10],Z=E[15]+E[11],K=E[14]+E[12],v[x+0]=Y+Z+K+(ae+E[13]),M=(Y+Z+K)*u[19]-(ae+E[13]),k=(U-W+q)*u[18],v[x+11]=M+k,v[x+12]=M-k,Q=(E[7]-E[1])*u[18],ae=E[13]-ae*u[19],M=Y*u[15]-ae+Z*u[16]+K*u[17],k=U*u[14]+Q+W*u[12]+q*u[13],v[x+3]=M+k,v[x+4]=M-k,M=-Y*u[17]+ae-Z*u[15]-K*u[16],k=U*u[13]+Q-W*u[14]-q*u[12],v[x+7]=M+k,v[x+8]=M-k,M=-Y*u[16]+ae-Z*u[17]-K*u[15],k=U*u[12]-Q+W*u[13]-q*u[14],v[x+15]=M+k,v[x+16]=M-k}}this.mdct_sub48=function(v,x,E){for(var M=x,k=286,N=0;N<v.channels_out;N++){for(var I=0;I<v.mode_gr;I++){for(var D,V=v.l3_side.tt[I][N],G=V.xr,J=0,B=v.sb_sample[N][1-I],$=0,U=0;U<18/2;U++)for(p(M,k,B[$]),p(M,k+32,B[$+1]),$+=2,k+=64,D=1;D<32;D+=2)B[$-1][D]*=-1;for(D=0;D<32;D++,J+=18){var Q=V.block_type,W=v.sb_sample[N][I],q=v.sb_sample[N][1-I];if(V.mixed_block_flag!=0&&D<2&&(Q=0),v.amp_filter[D]<1e-12)r.fill(G,J+0,J+18,0);else{if(v.amp_filter[D]<1)for(var U=0;U<18;U++)q[U][g[D]]*=v.amp_filter[D];if(Q==s.SHORT_TYPE){for(var U=-12/4;U<0;U++){var Y=l[s.SHORT_TYPE][U+3];G[J+U*3+9]=W[9+U][g[D]]*Y-W[8-U][g[D]],G[J+U*3+18]=W[14-U][g[D]]*Y+W[15+U][g[D]],G[J+U*3+10]=W[15+U][g[D]]*Y-W[14-U][g[D]],G[J+U*3+19]=q[2-U][g[D]]*Y+q[3+U][g[D]],G[J+U*3+11]=q[3+U][g[D]]*Y-q[2-U][g[D]],G[J+U*3+20]=q[8-U][g[D]]*Y+q[9+U][g[D]]}_(G,J)}else{for(var ae=i(18),U=-36/4;U<0;U++){var Z,K;Z=l[Q][U+27]*q[U+9][g[D]]+l[Q][U+36]*q[8-U][g[D]],K=l[Q][U+9]*W[U+9][g[D]]-l[Q][U+18]*W[8-U][g[D]],ae[U+9]=Z-K*c[3+U+9],ae[U+18]=Z*c[3+U+9]+K}y(G,J,ae)}}if(Q!=s.SHORT_TYPE&&D!=0)for(var U=7;U>=0;--U){var ne,le;ne=G[J+U]*f[20+U]+G[J+-1-U]*h[28+U],le=G[J+U]*h[28+U]-G[J+-1-U]*f[20+U],G[J+-1-U]=ne,G[J+U]=le}}}if(M=E,k=286,v.mode_gr==1)for(var ce=0;ce<18;ce++)e.arraycopy(v.sb_sample[N][1][ce],0,v.sb_sample[N][0][ce],0,32)}}}return xF=a,xF}var TF,Nre;function Wve(){if(Nre)return TF;Nre=1;var n=ap(),e=Rc,t=e.System,r=e.new_float,i=e.new_float_n;function s(){this.l=r(n.SBMAX_l),this.s=i([n.SBMAX_s,3]);var a=this;this.assign=function(o){t.arraycopy(o.l,0,a.l,0,n.SBMAX_l);for(var l=0;l<n.SBMAX_s;l++)for(var c=0;c<3;c++)a.s[l][c]=o.s[l][c]}}return TF=s,TF}var wF,Pre;function mct(){if(Pre)return wF;Pre=1;var n=Wve();function e(){this.thm=new n,this.en=new n}return wF=e,wF}function U_(n){var e=n;this.ordinal=function(){return e}}U_.STEREO=new U_(0);U_.JOINT_STEREO=new U_(1);U_.DUAL_CHANNEL=new U_(2);U_.MONO=new U_(3);U_.NOT_SET=new U_(4);var v3=U_,RF,Dre;function ap(){if(Dre)return RF;Dre=1;var n=Rc,e=n.System,t=n.VbrMode,r=n.new_array_n,i=n.new_float,s=n.new_float_n,a=n.new_int,o=n.assert;l.ENCDELAY=576,l.POSTDELAY=1152,l.MDCTDELAY=48,l.FFTOFFSET=224+l.MDCTDELAY,l.DECDELAY=528,l.SBLIMIT=32,l.CBANDS=64,l.SBPSY_l=21,l.SBPSY_s=12,l.SBMAX_l=22,l.SBMAX_s=13,l.PSFB21=6,l.PSFB12=6,l.BLKSIZE=1024,l.HBLKSIZE=l.BLKSIZE/2+1,l.BLKSIZE_s=256,l.HBLKSIZE_s=l.BLKSIZE_s/2+1,l.NORM_TYPE=0,l.START_TYPE=1,l.SHORT_TYPE=2,l.STOP_TYPE=3,l.MPG_MD_LR_LR=0,l.MPG_MD_LR_I=1,l.MPG_MD_MS_LR=2,l.MPG_MD_MS_I=3,l.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function l(){var c=pct(),u=mct(),f=v3,h=l.FFTOFFSET,g=l.MPG_MD_MS_LR,p=null;this.psy=null;var _=null,y=null,v=null;this.setModules=function(N,I,D,V){p=N,this.psy=I,_=I,y=V,v=D};var x=new c;function E(N){var I,D;if(N.ATH.useAdjust==0){N.ATH.adjust=1;return}if(D=N.loudness_sq[0][0],I=N.loudness_sq[1][0],N.channels_out==2?(D+=N.loudness_sq[0][1],I+=N.loudness_sq[1][1]):(D+=D,I+=I),N.mode_gr==2&&(D=Math.max(D,I)),D*=.5,D*=N.ATH.aaSensitivityP,D>.03125)N.ATH.adjust>=1?N.ATH.adjust=1:N.ATH.adjust<N.ATH.adjustLimit&&(N.ATH.adjust=N.ATH.adjustLimit),N.ATH.adjustLimit=1;else{var V=31.98*D+625e-6;N.ATH.adjust>=V?(N.ATH.adjust*=V*.075+.925,N.ATH.adjust<V&&(N.ATH.adjust=V)):N.ATH.adjustLimit>=V?N.ATH.adjust=V:N.ATH.adjust<N.ATH.adjustLimit&&(N.ATH.adjust=N.ATH.adjustLimit),N.ATH.adjustLimit=V}}function M(N){var I,D;for(o(0<=N.bitrate_index&&N.bitrate_index<16),o(0<=N.mode_ext&&N.mode_ext<4),N.bitrate_stereoMode_Hist[N.bitrate_index][4]++,N.bitrate_stereoMode_Hist[15][4]++,N.channels_out==2&&(N.bitrate_stereoMode_Hist[N.bitrate_index][N.mode_ext]++,N.bitrate_stereoMode_Hist[15][N.mode_ext]++),I=0;I<N.mode_gr;++I)for(D=0;D<N.channels_out;++D){var V=N.l3_side.tt[I][D].block_type|0;N.l3_side.tt[I][D].mixed_block_flag!=0&&(V=4),N.bitrate_blockType_Hist[N.bitrate_index][V]++,N.bitrate_blockType_Hist[N.bitrate_index][5]++,N.bitrate_blockType_Hist[15][V]++,N.bitrate_blockType_Hist[15][5]++}}function k(N,I){var D=N.internal_flags,V,G;if(D.lame_encode_frame_init==0){var J,B,$=i(2014),U=i(2014);for(D.lame_encode_frame_init=1,J=0,B=0;J<286+576*(1+D.mode_gr);++J)J<576*D.mode_gr?($[J]=0,D.channels_out==2&&(U[J]=0)):($[J]=I[0][B],D.channels_out==2&&(U[J]=I[1][B]),++B);for(G=0;G<D.mode_gr;G++)for(V=0;V<D.channels_out;V++)D.l3_side.tt[G][V].block_type=l.SHORT_TYPE;x.mdct_sub48(D,$,U),o(576>=l.FFTOFFSET),o(D.mf_size>=l.BLKSIZE+N.framesize-l.FFTOFFSET),o(D.mf_size>=512+N.framesize-32)}}this.lame_encode_mp3_frame=function(N,I,D,V,G,J){var B,$=r([2,2]);$[0][0]=new u,$[0][1]=new u,$[1][0]=new u,$[1][1]=new u;var U=r([2,2]);U[0][0]=new u,U[0][1]=new u,U[1][0]=new u,U[1][1]=new u;var Q,W=[null,null],q=N.internal_flags,Y=s([2,4]),ae=[.5,.5],Z=[[0,0],[0,0]],K=[[0,0],[0,0]],ne,le,ce;if(W[0]=I,W[1]=D,q.lame_encode_frame_init==0&&k(N,W),q.padding=0,(q.slot_lag-=q.frac_SpF)<0&&(q.slot_lag+=N.out_samplerate,q.padding=1),q.psymodel!=0){var de,Me=[null,null],qe=0,Ne=a(2);for(ce=0;ce<q.mode_gr;ce++){for(le=0;le<q.channels_out;le++)Me[le]=W[le],qe=576+ce*576-l.FFTOFFSET;if(N.VBR==t.vbr_mtrh||N.VBR==t.vbr_mt?de=_.L3psycho_anal_vbr(N,Me,qe,ce,$,U,Z[ce],K[ce],Y[ce],Ne):de=_.L3psycho_anal_ns(N,Me,qe,ce,$,U,Z[ce],K[ce],Y[ce],Ne),de!=0)return-4;for(N.mode==f.JOINT_STEREO&&(ae[ce]=Y[ce][2]+Y[ce][3],ae[ce]>0&&(ae[ce]=Y[ce][3]/ae[ce])),le=0;le<q.channels_out;le++){var Ae=q.l3_side.tt[ce][le];Ae.block_type=Ne[le],Ae.mixed_block_flag=0}}}else for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)q.l3_side.tt[ce][le].block_type=l.NORM_TYPE,q.l3_side.tt[ce][le].mixed_block_flag=0,K[ce][le]=Z[ce][le]=700;if(E(q),x.mdct_sub48(q,W[0],W[1]),q.mode_ext=l.MPG_MD_LR_LR,N.force_ms)q.mode_ext=l.MPG_MD_MS_LR;else if(N.mode==f.JOINT_STEREO){var Xe=0,$e=0;for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)Xe+=K[ce][le],$e+=Z[ce][le];if(Xe<=1*$e){var at=q.l3_side.tt[0],pt=q.l3_side.tt[q.mode_gr-1];at[0].block_type==at[1].block_type&&pt[0].block_type==pt[1].block_type&&(q.mode_ext=l.MPG_MD_MS_LR)}}if(q.mode_ext==g?(Q=U,ne=K):(Q=$,ne=Z),N.analysis&&q.pinfo!=null)for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)q.pinfo.ms_ratio[ce]=q.ms_ratio[ce],q.pinfo.ms_ener_ratio[ce]=ae[ce],q.pinfo.blocktype[ce][le]=q.l3_side.tt[ce][le].block_type,q.pinfo.pe[ce][le]=ne[ce][le],e.arraycopy(q.l3_side.tt[ce][le].xr,0,q.pinfo.xr[ce][le],0,576),q.mode_ext==g&&(q.pinfo.ers[ce][le]=q.pinfo.ers[ce][le+2],e.arraycopy(q.pinfo.energy[ce][le+2],0,q.pinfo.energy[ce][le],0,q.pinfo.energy[ce][le].length));if(N.VBR==t.vbr_off||N.VBR==t.vbr_abr){var oe,Ue;for(oe=0;oe<18;oe++)q.nsPsy.pefirbuf[oe]=q.nsPsy.pefirbuf[oe+1];for(Ue=0,ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)Ue+=ne[ce][le];for(q.nsPsy.pefirbuf[18]=Ue,Ue=q.nsPsy.pefirbuf[9],oe=0;oe<9;oe++)Ue+=(q.nsPsy.pefirbuf[oe]+q.nsPsy.pefirbuf[18-oe])*l.fircoef[oe];for(Ue=670*5*q.mode_gr*q.channels_out/Ue,ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)ne[ce][le]*=Ue}if(q.iteration_loop.iteration_loop(N,ne,ae,Q),p.format_bitstream(N),B=p.copy_buffer(q,V,G,J,1),N.bWriteVbrTag&&y.addVbrFrame(N),N.analysis&&q.pinfo!=null){for(le=0;le<q.channels_out;le++){var Ge;for(Ge=0;Ge<h;Ge++)q.pinfo.pcmdata[le][Ge]=q.pinfo.pcmdata[le][Ge+N.framesize];for(Ge=h;Ge<1600;Ge++)q.pinfo.pcmdata[le][Ge]=W[le][Ge-h]}v.set_frame_pinfo(N,Q)}return M(q),B}}return RF=l,RF}var Yve=Rc,Lre=Yve.Util,Ure=Yve.new_float,ju=ap();function gct(){var n=Ure(ju.BLKSIZE),e=Ure(ju.BLKSIZE_s/2),t=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(s,a,o){var l=0,c,u,f;o<<=1;var h=a+o;c=4;do{var g,p,_,y,v,x,E;E=c>>1,y=c,v=c<<1,x=v+y,c=v<<1,u=a,f=u+E;do{var M,k,N,I;k=s[u+0]-s[u+y],M=s[u+0]+s[u+y],I=s[u+v]-s[u+x],N=s[u+v]+s[u+x],s[u+v]=M-N,s[u+0]=M+N,s[u+x]=k-I,s[u+y]=k+I,k=s[f+0]-s[f+y],M=s[f+0]+s[f+y],I=Lre.SQRT2*s[f+x],N=Lre.SQRT2*s[f+v],s[f+v]=M-N,s[f+0]=M+N,s[f+x]=k-I,s[f+y]=k+I,f+=c,u+=c}while(u<h);for(p=t[l+0],g=t[l+1],_=1;_<E;_++){var D,V;D=1-2*g*g,V=2*g*p,u=a+_,f=a+y-_;do{var G,J,B,M,k,$,N,U,I,Q;J=V*s[u+y]-D*s[f+y],G=D*s[u+y]+V*s[f+y],k=s[u+0]-G,M=s[u+0]+G,$=s[f+0]-J,B=s[f+0]+J,J=V*s[u+x]-D*s[f+x],G=D*s[u+x]+V*s[f+x],I=s[u+v]-G,N=s[u+v]+G,Q=s[f+v]-J,U=s[f+v]+J,J=g*N-p*Q,G=p*N+g*Q,s[u+v]=M-G,s[u+0]=M+G,s[f+x]=$-J,s[f+y]=$+J,J=p*U-g*I,G=g*U+p*I,s[f+v]=B-G,s[f+0]=B+G,s[u+x]=k-J,s[u+y]=k+J,f+=c,u+=c}while(u<h);D=p,p=D*t[l+0]-g*t[l+1],g=D*t[l+1]+g*t[l+0]}l+=2}while(c<o)}var i=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(s,a,o,l,c){for(var u=0;u<3;u++){var f=ju.BLKSIZE_s/2,h=65535&576/3*(u+1),g=ju.BLKSIZE_s/8-1;do{var p,_,y,v,x,E=i[g<<2]&255;p=e[E]*l[o][c+E+h],x=e[127-E]*l[o][c+E+h+128],_=p-x,p=p+x,y=e[E+64]*l[o][c+E+h+64],x=e[63-E]*l[o][c+E+h+192],v=y-x,y=y+x,f-=4,a[u][f+0]=p+y,a[u][f+2]=p-y,a[u][f+1]=_+v,a[u][f+3]=_-v,p=e[E+1]*l[o][c+E+h+1],x=e[126-E]*l[o][c+E+h+129],_=p-x,p=p+x,y=e[E+65]*l[o][c+E+h+65],x=e[62-E]*l[o][c+E+h+193],v=y-x,y=y+x,a[u][f+ju.BLKSIZE_s/2+0]=p+y,a[u][f+ju.BLKSIZE_s/2+2]=p-y,a[u][f+ju.BLKSIZE_s/2+1]=_+v,a[u][f+ju.BLKSIZE_s/2+3]=_-v}while(--g>=0);r(a[u],f,ju.BLKSIZE_s/2)}},this.fft_long=function(s,a,o,l,c){var u=ju.BLKSIZE/8-1,f=ju.BLKSIZE/2;do{var h,g,p,_,y,v=i[u]&255;h=n[v]*l[o][c+v],y=n[v+512]*l[o][c+v+512],g=h-y,h=h+y,p=n[v+256]*l[o][c+v+256],y=n[v+768]*l[o][c+v+768],_=p-y,p=p+y,f-=4,a[f+0]=h+p,a[f+2]=h-p,a[f+1]=g+_,a[f+3]=g-_,h=n[v+1]*l[o][c+v+1],y=n[v+513]*l[o][c+v+513],g=h-y,h=h+y,p=n[v+257]*l[o][c+v+257],y=n[v+769]*l[o][c+v+769],_=p-y,p=p+y,a[f+ju.BLKSIZE/2+0]=h+p,a[f+ju.BLKSIZE/2+2]=h-p,a[f+ju.BLKSIZE/2+1]=g+_,a[f+ju.BLKSIZE/2+3]=g-_}while(--u>=0);r(a,f,ju.BLKSIZE/2)},this.init_fft=function(s){for(var a=0;a<ju.BLKSIZE;a++)n[a]=.42-.5*Math.cos(2*Math.PI*(a+.5)/ju.BLKSIZE)+.08*Math.cos(4*Math.PI*(a+.5)/ju.BLKSIZE);for(var a=0;a<ju.BLKSIZE_s/2;a++)e[a]=.5*(1-Math.cos(2*Math.PI*(a+.5)/ju.BLKSIZE_s))}}var _ct=gct,Ob=Rc,rT=Ob.VbrMode,Bre=Ob.Float,iT=Ob.ShortBlock,pm=Ob.Util,vct=Ob.Arrays,df=Ob.new_float,g0=Ob.new_float_n,MS=Ob.new_int,zi=Ob.assert,yct=_ct,pn=ap();function bct(){var n=v3,e=new yct,t=2.302585092994046,r=2,i=16,s=2,a=16,o=.34,l=1/(14752*14752)/(pn.BLKSIZE/2),c=.01,u=.8,f=.6,h=.3,g=3.5,p=21,_=.2302585093;function y(se,_e){for(var Ie=0,De=0;De<pn.BLKSIZE/2;++De)Ie+=se[De]*_e.ATH.eql_w[De];return Ie*=l,Ie}function v(se,_e,Ie,De,Oe,we,st,Ve,tt,Ze,nt){var vt=se.internal_flags;if(tt<2)e.fft_long(vt,De[Oe],tt,Ze,nt),e.fft_short(vt,we[st],tt,Ze,nt);else if(tt==2){for(var Je=pn.BLKSIZE-1;Je>=0;--Je){var ht=De[Oe+0][Je],mt=De[Oe+1][Je];De[Oe+0][Je]=(ht+mt)*pm.SQRT2*.5,De[Oe+1][Je]=(ht-mt)*pm.SQRT2*.5}for(var ft=2;ft>=0;--ft)for(var Je=pn.BLKSIZE_s-1;Je>=0;--Je){var ht=we[st+0][ft][Je],mt=we[st+1][ft][Je];we[st+0][ft][Je]=(ht+mt)*pm.SQRT2*.5,we[st+1][ft][Je]=(ht-mt)*pm.SQRT2*.5}}_e[0]=De[Oe+0][0],_e[0]*=_e[0];for(var Je=pn.BLKSIZE/2-1;Je>=0;--Je){var _t=De[Oe+0][pn.BLKSIZE/2-Je],gn=De[Oe+0][pn.BLKSIZE/2+Je];_e[pn.BLKSIZE/2-Je]=(_t*_t+gn*gn)*.5}for(var ft=2;ft>=0;--ft){Ie[ft][0]=we[st+0][ft][0],Ie[ft][0]*=Ie[ft][0];for(var Je=pn.BLKSIZE_s/2-1;Je>=0;--Je){var _t=we[st+0][ft][pn.BLKSIZE_s/2-Je],gn=we[st+0][ft][pn.BLKSIZE_s/2+Je];Ie[ft][pn.BLKSIZE_s/2-Je]=(_t*_t+gn*gn)*.5}}{for(var _n=0,Je=11;Je<pn.HBLKSIZE;Je++)_n+=_e[Je];vt.tot_ener[tt]=_n}if(se.analysis){for(var Je=0;Je<pn.HBLKSIZE;Je++)vt.pinfo.energy[Ve][tt][Je]=vt.pinfo.energy_save[tt][Je],vt.pinfo.energy_save[tt][Je]=_e[Je];vt.pinfo.pe[Ve][tt]=vt.pe[tt]}se.athaa_loudapprox==2&&tt<2&&(vt.loudness_sq[Ve][tt]=vt.loudness_sq_save[tt],vt.loudness_sq_save[tt]=y(_e,vt))}var x=8,E=23,M=15,k,N,I,D=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function V(){k=Math.pow(10,(x+1)/16),N=Math.pow(10,(E+1)/16),I=Math.pow(10,M/10)}var G=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],J=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],B=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function $(se,_e,Ie,De,Oe,we){var st;if(_e>se)if(_e<se*N)st=_e/se;else return se+_e;else{if(se>=_e*N)return se+_e;st=se/_e}if(se+=_e,De+3<=6){if(st>=k)return se;var Ve=0|pm.FAST_LOG10_X(st,16);return se*J[Ve]}var Ve=0|pm.FAST_LOG10_X(st,16);if(_e=Oe.ATH.cb_l[Ie]*Oe.ATH.adjust,se<I*_e){if(se>_e){var tt,Ze;return tt=1,Ve<=13&&(tt=B[Ve]),Ze=pm.FAST_LOG10_X(se/_e,10/15),se*((G[Ve]-tt)*Ze+tt)}return Ve>13?se:se*B[Ve]}return se*G[Ve]}var U=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function Q(se,_e,Ie){var De;if(se<0&&(se=0),_e<0&&(_e=0),se<=0)return _e;if(_e<=0)return se;if(_e>se?De=_e/se:De=se/_e,-2<=Ie&&Ie<=2){if(De>=k)return se+_e;var Oe=0|pm.FAST_LOG10_X(De,16);return(se+_e)*U[Oe]}return De<N?se+_e:(se<_e&&(se=_e),se)}function W(se,_e){var Ie=se.internal_flags;if(Ie.channels_out>1){for(var De=0;De<pn.SBMAX_l;De++){var Oe=Ie.thm[0].l[De],we=Ie.thm[1].l[De];Ie.thm[0].l[De]+=we*_e,Ie.thm[1].l[De]+=Oe*_e}for(var De=0;De<pn.SBMAX_s;De++)for(var st=0;st<3;st++){var Oe=Ie.thm[0].s[De][st],we=Ie.thm[1].s[De][st];Ie.thm[0].s[De][st]+=we*_e,Ie.thm[1].s[De][st]+=Oe*_e}}}function q(se){for(var _e=0;_e<pn.SBMAX_l;_e++)if(!(se.thm[0].l[_e]>1.58*se.thm[1].l[_e]||se.thm[1].l[_e]>1.58*se.thm[0].l[_e])){var Ie=se.mld_l[_e]*se.en[3].l[_e],De=Math.max(se.thm[2].l[_e],Math.min(se.thm[3].l[_e],Ie));Ie=se.mld_l[_e]*se.en[2].l[_e];var Oe=Math.max(se.thm[3].l[_e],Math.min(se.thm[2].l[_e],Ie));se.thm[2].l[_e]=De,se.thm[3].l[_e]=Oe}for(var _e=0;_e<pn.SBMAX_s;_e++)for(var we=0;we<3;we++)if(!(se.thm[0].s[_e][we]>1.58*se.thm[1].s[_e][we]||se.thm[1].s[_e][we]>1.58*se.thm[0].s[_e][we])){var Ie=se.mld_s[_e]*se.en[3].s[_e][we],De=Math.max(se.thm[2].s[_e][we],Math.min(se.thm[3].s[_e][we],Ie));Ie=se.mld_s[_e]*se.en[2].s[_e][we];var Oe=Math.max(se.thm[3].s[_e][we],Math.min(se.thm[2].s[_e][we],Ie));se.thm[2].s[_e][we]=De,se.thm[3].s[_e][we]=Oe}}function Y(se,_e,Ie){var De=_e,Oe=Math.pow(10,Ie);_e*=2,De*=2;for(var we=0;we<pn.SBMAX_l;we++){var st,Ve,tt,Ze;if(Ze=se.ATH.cb_l[se.bm_l[we]]*Oe,st=Math.min(Math.max(se.thm[0].l[we],Ze),Math.max(se.thm[1].l[we],Ze)),Ve=Math.max(se.thm[2].l[we],Ze),tt=Math.max(se.thm[3].l[we],Ze),st*_e<Ve+tt){var nt=st*De/(Ve+tt);Ve*=nt,tt*=nt}se.thm[2].l[we]=Math.min(Ve,se.thm[2].l[we]),se.thm[3].l[we]=Math.min(tt,se.thm[3].l[we])}Oe*=pn.BLKSIZE_s/pn.BLKSIZE;for(var we=0;we<pn.SBMAX_s;we++)for(var vt=0;vt<3;vt++){var st,Ve,tt,Ze;if(Ze=se.ATH.cb_s[se.bm_s[we]]*Oe,st=Math.min(Math.max(se.thm[0].s[we][vt],Ze),Math.max(se.thm[1].s[we][vt],Ze)),Ve=Math.max(se.thm[2].s[we][vt],Ze),tt=Math.max(se.thm[3].s[we][vt],Ze),st*_e<Ve+tt){var nt=st*_e/(Ve+tt);Ve*=nt,tt*=nt}se.thm[2].s[we][vt]=Math.min(se.thm[2].s[we][vt],Ve),se.thm[3].s[we][vt]=Math.min(se.thm[3].s[we][vt],tt)}}function ae(se,_e,Ie,De,Oe){var we,st,Ve=0,tt=0;for(we=st=0;we<pn.SBMAX_s;++st,++we){for(var Ze=se.bo_s[we],nt=se.npart_s,vt=Ze<nt?Ze:nt;st<vt;)zi(_e[st]>=0),zi(Ie[st]>=0),Ve+=_e[st],tt+=Ie[st],st++;if(se.en[De].s[we][Oe]=Ve,se.thm[De].s[we][Oe]=tt,st>=nt){++we;break}zi(_e[st]>=0),zi(Ie[st]>=0);{var Je=se.PSY.bo_s_weight[we],ht=1-Je;Ve=Je*_e[st],tt=Je*Ie[st],se.en[De].s[we][Oe]+=Ve,se.thm[De].s[we][Oe]+=tt,Ve=ht*_e[st],tt=ht*Ie[st]}}for(;we<pn.SBMAX_s;++we)se.en[De].s[we][Oe]=0,se.thm[De].s[we][Oe]=0}function Z(se,_e,Ie,De){var Oe,we,st=0,Ve=0;for(Oe=we=0;Oe<pn.SBMAX_l;++we,++Oe){for(var tt=se.bo_l[Oe],Ze=se.npart_l,nt=tt<Ze?tt:Ze;we<nt;)zi(_e[we]>=0),zi(Ie[we]>=0),st+=_e[we],Ve+=Ie[we],we++;if(se.en[De].l[Oe]=st,se.thm[De].l[Oe]=Ve,we>=Ze){++Oe;break}zi(_e[we]>=0),zi(Ie[we]>=0);{var vt=se.PSY.bo_l_weight[Oe],Je=1-vt;st=vt*_e[we],Ve=vt*Ie[we],se.en[De].l[Oe]+=st,se.thm[De].l[Oe]+=Ve,st=Je*_e[we],Ve=Je*Ie[we]}}for(;Oe<pn.SBMAX_l;++Oe)se.en[De].l[Oe]=0,se.thm[De].l[Oe]=0}function K(se,_e,Ie,De,Oe,we){var st=se.internal_flags,Ve,tt;for(tt=Ve=0;tt<st.npart_s;++tt){for(var Ze=0,nt=st.numlines_s[tt],vt=0;vt<nt;++vt,++Ve){var Je=_e[we][Ve];Ze+=Je}Ie[tt]=Ze}for(zi(tt==st.npart_s),Ve=tt=0;tt<st.npart_s;tt++){var ht=st.s3ind_s[tt][0],mt=st.s3_ss[Ve++]*Ie[ht];for(++ht;ht<=st.s3ind_s[tt][1];)mt+=st.s3_ss[Ve]*Ie[ht],++Ve,++ht;{var ft=s*st.nb_s1[Oe][tt];De[tt]=Math.min(mt,ft)}if(st.blocktype_old[Oe&1]==pn.SHORT_TYPE){var ft=a*st.nb_s2[Oe][tt],_t=De[tt];De[tt]=Math.min(ft,_t)}st.nb_s2[Oe][tt]=st.nb_s1[Oe][tt],st.nb_s1[Oe][tt]=mt,zi(De[tt]>=0)}for(;tt<=pn.CBANDS;++tt)Ie[tt]=0,De[tt]=0}function ne(se,_e,Ie,De){var Oe=se.internal_flags;se.short_blocks==iT.short_block_coupled&&!(_e[0]!=0&&_e[1]!=0)&&(_e[0]=_e[1]=0);for(var we=0;we<Oe.channels_out;we++)De[we]=pn.NORM_TYPE,se.short_blocks==iT.short_block_dispensed&&(_e[we]=1),se.short_blocks==iT.short_block_forced&&(_e[we]=0),_e[we]!=0?(zi(Oe.blocktype_old[we]!=pn.START_TYPE),Oe.blocktype_old[we]==pn.SHORT_TYPE&&(De[we]=pn.STOP_TYPE)):(De[we]=pn.SHORT_TYPE,Oe.blocktype_old[we]==pn.NORM_TYPE&&(Oe.blocktype_old[we]=pn.START_TYPE),Oe.blocktype_old[we]==pn.STOP_TYPE&&(Oe.blocktype_old[we]=pn.SHORT_TYPE)),Ie[we]=Oe.blocktype_old[we],Oe.blocktype_old[we]=De[we]}function le(se,_e,Ie){return Ie>=1?se:Ie<=0?_e:_e>0?Math.pow(se/_e,Ie)*_e:0}var ce=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function de(se,_e){for(var Ie=309.07,De=0;De<pn.SBMAX_s-1;De++)for(var Oe=0;Oe<3;Oe++){var we=se.thm.s[De][Oe];if(we>0){var st=we*_e,Ve=se.en.s[De][Oe];Ve>st&&(Ve>st*1e10?Ie+=ce[De]*(10*t):Ie+=ce[De]*pm.FAST_LOG10(Ve/st))}}return Ie}var Me=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function qe(se,_e){for(var Ie=281.0575,De=0;De<pn.SBMAX_l-1;De++){var Oe=se.thm.l[De];if(Oe>0){var we=Oe*_e,st=se.en.l[De];st>we&&(st>we*1e10?Ie+=Me[De]*(10*t):Ie+=Me[De]*pm.FAST_LOG10(st/we))}}return Ie}function Ne(se,_e,Ie,De,Oe){var we,st;for(we=st=0;we<se.npart_l;++we){var Ve=0,tt=0,Ze;for(Ze=0;Ze<se.numlines_l[we];++Ze,++st){var nt=_e[st];Ve+=nt,tt<nt&&(tt=nt)}Ie[we]=Ve,De[we]=tt,Oe[we]=Ve*se.rnumlines_l[we],zi(se.rnumlines_l[we]>=0),zi(Ie[we]>=0),zi(De[we]>=0),zi(Oe[we]>=0)}}function Ae(se,_e,Ie,De){var Oe=D.length-1,we=0,st=Ie[we]+Ie[we+1];if(st>0){var Ve=_e[we];Ve<_e[we+1]&&(Ve=_e[we+1]),zi(se.numlines_l[we]+se.numlines_l[we+1]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_l[we]+se.numlines_l[we+1]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;for(we=1;we<se.npart_l-1;we++)if(st=Ie[we-1]+Ie[we]+Ie[we+1],st>0){var Ve=_e[we-1];Ve<_e[we]&&(Ve=_e[we]),Ve<_e[we+1]&&(Ve=_e[we+1]),zi(se.numlines_l[we-1]+se.numlines_l[we]+se.numlines_l[we+1]-1>0),st=20*(Ve*3-st)/(st*(se.numlines_l[we-1]+se.numlines_l[we]+se.numlines_l[we+1]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;if(zi(we==se.npart_l-1),st=Ie[we-1]+Ie[we],st>0){var Ve=_e[we-1];Ve<_e[we]&&(Ve=_e[we]),zi(se.numlines_l[we-1]+se.numlines_l[we]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_l[we-1]+se.numlines_l[we]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;zi(we==se.npart_l-1)}var Xe=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(se,_e,Ie,De,Oe,we,st,Ve,tt,Ze){var nt=se.internal_flags,vt=g0([2,pn.BLKSIZE]),Je=g0([2,3,pn.BLKSIZE_s]),ht=df(pn.CBANDS+1),mt=df(pn.CBANDS+1),ft=df(pn.CBANDS+2),_t=MS(2),gn=MS(2),_n,Bt,Yt,Mt,fn,Bn,cn,In,Wn=g0([2,576]),er,os=MS(pn.CBANDS+2),gi=MS(pn.CBANDS+2);for(vct.fill(gi,0),_n=nt.channels_out,se.mode==n.JOINT_STEREO&&(_n=4),se.VBR==rT.vbr_off?er=nt.ResvMax==0?0:nt.ResvSize/nt.ResvMax*.5:se.VBR==rT.vbr_rh||se.VBR==rT.vbr_mtrh||se.VBR==rT.vbr_mt?er=.6:er=1,Bt=0;Bt<nt.channels_out;Bt++){var Ni=_e[Bt],Fs=Ie+576-350-p+192;for(Mt=0;Mt<576;Mt++){var _i,Rs;for(_i=Ni[Fs+Mt+10],Rs=0,fn=0;fn<(p-1)/2-1;fn+=2)_i+=Xe[fn]*(Ni[Fs+Mt+fn]+Ni[Fs+Mt+p-fn]),Rs+=Xe[fn+1]*(Ni[Fs+Mt+fn+1]+Ni[Fs+Mt+p-fn-1]);Wn[Bt][Mt]=_i+Rs}Oe[De][Bt].en.assign(nt.en[Bt]),Oe[De][Bt].thm.assign(nt.thm[Bt]),_n>2&&(we[De][Bt].en.assign(nt.en[Bt+2]),we[De][Bt].thm.assign(nt.thm[Bt+2]))}for(Bt=0;Bt<_n;Bt++){var ra,ls,We=df(12),At=[0,0,0,0],Wt=df(12),Kt=1,Lt,yn=df(pn.CBANDS),zn=df(pn.CBANDS),En=[0,0,0,0],tr=df(pn.HBLKSIZE),Nr=g0([3,pn.HBLKSIZE_s]);for(zi(nt.npart_s<=pn.CBANDS),zi(nt.npart_l<=pn.CBANDS),Mt=0;Mt<3;Mt++)We[Mt]=nt.nsPsy.last_en_subshort[Bt][Mt+6],zi(nt.nsPsy.last_en_subshort[Bt][Mt+4]>0),Wt[Mt]=We[Mt]/nt.nsPsy.last_en_subshort[Bt][Mt+4],At[0]+=We[Mt];if(Bt==2)for(Mt=0;Mt<576;Mt++){var Er,rr;Er=Wn[0][Mt],rr=Wn[1][Mt],Wn[0][Mt]=Er+rr,Wn[1][Mt]=Er-rr}{var Lr=Wn[Bt&1],ii=0;for(Mt=0;Mt<9;Mt++){for(var da=ii+64,Mr=1;ii<da;ii++)Mr<Math.abs(Lr[ii])&&(Mr=Math.abs(Lr[ii]));nt.nsPsy.last_en_subshort[Bt][Mt]=We[Mt+3]=Mr,At[1+Mt/3]+=Mr,Mr>We[Mt+3-2]?(zi(We[Mt+3-2]>0),Mr=Mr/We[Mt+3-2]):We[Mt+3-2]>Mr*10?Mr=We[Mt+3-2]/(Mr*10):Mr=0,Wt[Mt+3]=Mr}}if(se.analysis){var si=Wt[0];for(Mt=1;Mt<12;Mt++)si<Wt[Mt]&&(si=Wt[Mt]);nt.pinfo.ers[De][Bt]=nt.pinfo.ers_save[Bt],nt.pinfo.ers_save[Bt]=si}for(Lt=Bt==3?nt.nsPsy.attackthre_s:nt.nsPsy.attackthre,Mt=0;Mt<12;Mt++)En[Mt/3]==0&&Wt[Mt]>Lt&&(En[Mt/3]=Mt%3+1);for(Mt=1;Mt<4;Mt++){var Tr;At[Mt-1]>At[Mt]?(zi(At[Mt]>0),Tr=At[Mt-1]/At[Mt]):(zi(At[Mt-1]>0),Tr=At[Mt]/At[Mt-1]),Tr<1.7&&(En[Mt]=0,Mt==1&&(En[0]=0))}for(En[0]!=0&&nt.nsPsy.lastAttacks[Bt]!=0&&(En[0]=0),(nt.nsPsy.lastAttacks[Bt]==3||En[0]+En[1]+En[2]+En[3]!=0)&&(Kt=0,En[1]!=0&&En[0]!=0&&(En[1]=0),En[2]!=0&&En[1]!=0&&(En[2]=0),En[3]!=0&&En[2]!=0&&(En[3]=0)),Bt<2?gn[Bt]=Kt:Kt==0&&(gn[0]=gn[1]=0),tt[Bt]=nt.tot_ener[Bt],ls=Je,ra=vt,v(se,tr,Nr,ra,Bt&1,ls,Bt&1,De,Bt,_e,Ie),Ne(nt,tr,ht,yn,zn),Ae(nt,yn,zn,os),In=0;In<3;In++){var Dr,Cn;for(K(se,Nr,mt,ft,Bt,In),ae(nt,mt,ft,Bt,In),cn=0;cn<pn.SBMAX_s;cn++){if(Cn=nt.thm[Bt].s[cn][In],Cn*=u,En[In]>=2||En[In+1]==1){var jr=In!=0?In-1:2,Mr=le(nt.thm[Bt].s[cn][jr],Cn,f*er);Cn=Math.min(Cn,Mr)}if(En[In]==1){var jr=In!=0?In-1:2,Mr=le(nt.thm[Bt].s[cn][jr],Cn,h*er);Cn=Math.min(Cn,Mr)}else if(In!=0&&En[In-1]==3||In==0&&nt.nsPsy.lastAttacks[Bt]==3){var jr=In!=2?In+1:0,Mr=le(nt.thm[Bt].s[cn][jr],Cn,h*er);Cn=Math.min(Cn,Mr)}Dr=We[In*3+3]+We[In*3+4]+We[In*3+5],We[In*3+5]*6<Dr&&(Cn*=.5,We[In*3+4]*6<Dr&&(Cn*=.5)),nt.thm[Bt].s[cn][In]=Cn}}for(nt.nsPsy.lastAttacks[Bt]=En[2],Bn=0,Yt=0;Yt<nt.npart_l;Yt++){for(var Uo=nt.s3ind[Yt][0],cs=ht[Uo]*D[os[Uo]],Bo=nt.s3_ll[Bn++]*cs;++Uo<=nt.s3ind[Yt][1];)cs=ht[Uo]*D[os[Uo]],Bo=$(Bo,nt.s3_ll[Bn++]*cs,Uo,Uo-Yt,nt);Bo*=.158489319246111,nt.blocktype_old[Bt&1]==pn.SHORT_TYPE?ft[Yt]=Bo:ft[Yt]=le(Math.min(Bo,Math.min(r*nt.nb_1[Bt][Yt],i*nt.nb_2[Bt][Yt])),Bo,er),nt.nb_2[Bt][Yt]=nt.nb_1[Bt][Yt],nt.nb_1[Bt][Yt]=Bo}for(;Yt<=pn.CBANDS;++Yt)ht[Yt]=0,ft[Yt]=0;Z(nt,ht,ft,Bt)}if((se.mode==n.STEREO||se.mode==n.JOINT_STEREO)&&se.interChRatio>0&&W(se,se.interChRatio),se.mode==n.JOINT_STEREO){var us;q(nt),us=se.msfix,Math.abs(us)>0&&Y(nt,us,se.ATHlower*nt.ATH.adjust)}for(ne(se,gn,Ze,_t),Bt=0;Bt<_n;Bt++){var Xn,ei=0,ur,zs;Bt>1?(Xn=Ve,ei=-2,ur=pn.NORM_TYPE,(Ze[0]==pn.SHORT_TYPE||Ze[1]==pn.SHORT_TYPE)&&(ur=pn.SHORT_TYPE),zs=we[De][Bt-2]):(Xn=st,ei=0,ur=Ze[Bt],zs=Oe[De][Bt]),ur==pn.SHORT_TYPE?Xn[ei+Bt]=de(zs,nt.masking_lower):Xn[ei+Bt]=qe(zs,nt.masking_lower),se.analysis&&(nt.pinfo.pe[De][Bt]=Xn[ei+Bt])}return 0};function $e(se,_e,Ie,De,Oe,we,st,Ve){var tt=se.internal_flags;if(De<2)e.fft_long(tt,st[Ve],De,_e,Ie);else if(De==2)for(var Ze=pn.BLKSIZE-1;Ze>=0;--Ze){var nt=st[Ve+0][Ze],vt=st[Ve+1][Ze];st[Ve+0][Ze]=(nt+vt)*pm.SQRT2*.5,st[Ve+1][Ze]=(nt-vt)*pm.SQRT2*.5}we[0]=st[Ve+0][0],we[0]*=we[0];for(var Ze=pn.BLKSIZE/2-1;Ze>=0;--Ze){var Je=st[Ve+0][pn.BLKSIZE/2-Ze],ht=st[Ve+0][pn.BLKSIZE/2+Ze];we[pn.BLKSIZE/2-Ze]=(Je*Je+ht*ht)*.5}{for(var mt=0,Ze=11;Ze<pn.HBLKSIZE;Ze++)mt+=we[Ze];tt.tot_ener[De]=mt}if(se.analysis){for(var Ze=0;Ze<pn.HBLKSIZE;Ze++)tt.pinfo.energy[Oe][De][Ze]=tt.pinfo.energy_save[De][Ze],tt.pinfo.energy_save[De][Ze]=we[Ze];tt.pinfo.pe[Oe][De]=tt.pe[De]}}function at(se,_e,Ie,De,Oe,we,st,Ve){var tt=se.internal_flags;if(Oe==0&&De<2&&e.fft_short(tt,st[Ve],De,_e,Ie),De==2)for(var Ze=pn.BLKSIZE_s-1;Ze>=0;--Ze){var nt=st[Ve+0][Oe][Ze],vt=st[Ve+1][Oe][Ze];st[Ve+0][Oe][Ze]=(nt+vt)*pm.SQRT2*.5,st[Ve+1][Oe][Ze]=(nt-vt)*pm.SQRT2*.5}we[Oe][0]=st[Ve+0][Oe][0],we[Oe][0]*=we[Oe][0];for(var Ze=pn.BLKSIZE_s/2-1;Ze>=0;--Ze){var Je=st[Ve+0][Oe][pn.BLKSIZE_s/2-Ze],ht=st[Ve+0][Oe][pn.BLKSIZE_s/2+Ze];we[Oe][pn.BLKSIZE_s/2-Ze]=(Je*Je+ht*ht)*.5}}function pt(se,_e,Ie,De){var Oe=se.internal_flags;se.athaa_loudapprox==2&&Ie<2&&(Oe.loudness_sq[_e][Ie]=Oe.loudness_sq_save[Ie],Oe.loudness_sq_save[Ie]=y(De,Oe))}var oe=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function Ue(se,_e,Ie,De,Oe,we,st,Ve,tt,Ze){for(var nt=g0([2,576]),vt=se.internal_flags,Je=vt.channels_out,ht=se.mode==n.JOINT_STEREO?4:Je,mt=0;mt<Je;mt++){firbuf=_e[mt];for(var ft=Ie+576-350-p+192,_t=0;_t<576;_t++){var gn,_n;gn=firbuf[ft+_t+10],_n=0;for(var Bt=0;Bt<(p-1)/2-1;Bt+=2)gn+=oe[Bt]*(firbuf[ft+_t+Bt]+firbuf[ft+_t+p-Bt]),_n+=oe[Bt+1]*(firbuf[ft+_t+Bt+1]+firbuf[ft+_t+p-Bt-1]);nt[mt][_t]=gn+_n}Oe[De][mt].en.assign(vt.en[mt]),Oe[De][mt].thm.assign(vt.thm[mt]),ht>2&&(we[De][mt].en.assign(vt.en[mt+2]),we[De][mt].thm.assign(vt.thm[mt+2]))}for(var mt=0;mt<ht;mt++){var Yt=df(12),Mt=df(12),fn=[0,0,0,0],Bn=nt[mt&1],cn=0,In=mt==3?vt.nsPsy.attackthre_s:vt.nsPsy.attackthre,Wn=1;if(mt==2)for(var _t=0,Bt=576;Bt>0;++_t,--Bt){var er=nt[0][_t],os=nt[1][_t];nt[0][_t]=er+os,nt[1][_t]=er-os}for(var _t=0;_t<3;_t++)Mt[_t]=vt.nsPsy.last_en_subshort[mt][_t+6],zi(vt.nsPsy.last_en_subshort[mt][_t+4]>0),Yt[_t]=Mt[_t]/vt.nsPsy.last_en_subshort[mt][_t+4],fn[0]+=Mt[_t];for(var _t=0;_t<9;_t++){for(var gi=cn+64,Ni=1;cn<gi;cn++)Ni<Math.abs(Bn[cn])&&(Ni=Math.abs(Bn[cn]));vt.nsPsy.last_en_subshort[mt][_t]=Mt[_t+3]=Ni,fn[1+_t/3]+=Ni,Ni>Mt[_t+3-2]?(zi(Mt[_t+3-2]>0),Ni=Ni/Mt[_t+3-2]):Mt[_t+3-2]>Ni*10?Ni=Mt[_t+3-2]/(Ni*10):Ni=0,Yt[_t+3]=Ni}for(var _t=0;_t<3;++_t){var Fs=Mt[_t*3+3]+Mt[_t*3+4]+Mt[_t*3+5],_i=1;Mt[_t*3+5]*6<Fs&&(_i*=.5,Mt[_t*3+4]*6<Fs&&(_i*=.5)),Ve[mt][_t]=_i}if(se.analysis){for(var Rs=Yt[0],_t=1;_t<12;_t++)Rs<Yt[_t]&&(Rs=Yt[_t]);vt.pinfo.ers[De][mt]=vt.pinfo.ers_save[mt],vt.pinfo.ers_save[mt]=Rs}for(var _t=0;_t<12;_t++)tt[mt][_t/3]==0&&Yt[_t]>In&&(tt[mt][_t/3]=_t%3+1);for(var _t=1;_t<4;_t++){var ra=fn[_t-1],ls=fn[_t],We=Math.max(ra,ls);We<4e4&&ra<1.7*ls&&ls<1.7*ra&&(_t==1&&tt[mt][0]<=tt[mt][_t]&&(tt[mt][0]=0),tt[mt][_t]=0)}tt[mt][0]<=vt.nsPsy.lastAttacks[mt]&&(tt[mt][0]=0),(vt.nsPsy.lastAttacks[mt]==3||tt[mt][0]+tt[mt][1]+tt[mt][2]+tt[mt][3]!=0)&&(Wn=0,tt[mt][1]!=0&&tt[mt][0]!=0&&(tt[mt][1]=0),tt[mt][2]!=0&&tt[mt][1]!=0&&(tt[mt][2]=0),tt[mt][3]!=0&&tt[mt][2]!=0&&(tt[mt][3]=0)),mt<2?Ze[mt]=Wn:Wn==0&&(Ze[0]=Ze[1]=0),st[mt]=vt.tot_ener[mt]}}function Ge(se,_e,Ie){if(Ie==0)for(var De=0;De<se.npart_s;De++)se.nb_s2[_e][De]=se.nb_s1[_e][De],se.nb_s1[_e][De]=0}function ze(se,_e){for(var Ie=0;Ie<se.npart_l;Ie++)se.nb_2[_e][Ie]=se.nb_1[_e][Ie],se.nb_1[_e][Ie]=0}function Be(se,_e,Ie,De){var Oe=D.length-1,we=0,st=Ie[we]+Ie[we+1];if(st>0){var Ve=_e[we];Ve<_e[we+1]&&(Ve=_e[we+1]),zi(se.numlines_s[we]+se.numlines_s[we+1]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_s[we]+se.numlines_s[we+1]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;for(we=1;we<se.npart_s-1;we++)if(st=Ie[we-1]+Ie[we]+Ie[we+1],zi(we+1<se.npart_s),st>0){var Ve=_e[we-1];Ve<_e[we]&&(Ve=_e[we]),Ve<_e[we+1]&&(Ve=_e[we+1]),zi(se.numlines_s[we-1]+se.numlines_s[we]+se.numlines_s[we+1]-1>0),st=20*(Ve*3-st)/(st*(se.numlines_s[we-1]+se.numlines_s[we]+se.numlines_s[we+1]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;if(zi(we==se.npart_s-1),st=Ie[we-1]+Ie[we],st>0){var Ve=_e[we-1];Ve<_e[we]&&(Ve=_e[we]),zi(se.numlines_s[we-1]+se.numlines_s[we]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_s[we-1]+se.numlines_s[we]-1));var tt=0|st;tt>Oe&&(tt=Oe),De[we]=tt}else De[we]=0;zi(we==se.npart_s-1)}function me(se,_e,Ie,De,Oe,we){var st=se.internal_flags,Ve=new float[pn.CBANDS],tt=df(pn.CBANDS),Ze,nt,vt,Je=new int[pn.CBANDS];for(vt=nt=0;vt<st.npart_s;++vt){var ht=0,mt=0,ft=st.numlines_s[vt];for(Ze=0;Ze<ft;++Ze,++nt){var _t=_e[we][nt];ht+=_t,mt<_t&&(mt=_t)}Ie[vt]=ht,Ve[vt]=mt,tt[vt]=ht/ft,zi(tt[vt]>=0)}for(zi(vt==st.npart_s);vt<pn.CBANDS;++vt)Ve[vt]=0,tt[vt]=0;for(Be(st,Ve,tt,Je),nt=vt=0;vt<st.npart_s;vt++){var gn=st.s3ind_s[vt][0],_n=st.s3ind_s[vt][1],Bt,Yt,Mt,fn,Bn;for(Bt=Je[gn],Yt=1,fn=st.s3_ss[nt]*Ie[gn]*D[Je[gn]],++nt,++gn;gn<=_n;)Bt+=Je[gn],Yt+=1,Mt=st.s3_ss[nt]*Ie[gn]*D[Je[gn]],fn=Q(fn,Mt,gn-vt),++nt,++gn;Bt=(1+2*Bt)/(2*Yt),Bn=D[Bt]*.5,fn*=Bn,De[vt]=fn,st.nb_s2[Oe][vt]=st.nb_s1[Oe][vt],st.nb_s1[Oe][vt]=fn,Mt=Ve[vt],Mt*=st.minval_s[vt],Mt*=Bn,De[vt]>Mt&&(De[vt]=Mt),st.masking_lower>1&&(De[vt]*=st.masking_lower),De[vt]>Ie[vt]&&(De[vt]=Ie[vt]),st.masking_lower<1&&(De[vt]*=st.masking_lower),zi(De[vt]>=0)}for(;vt<pn.CBANDS;++vt)Ie[vt]=0,De[vt]=0}function Se(se,_e,Ie,De,Oe){var we=df(pn.CBANDS),st=df(pn.CBANDS),Ve=MS(pn.CBANDS+2),tt;Ne(se,_e,Ie,we,st),Ae(se,we,st,Ve);var Ze=0;for(tt=0;tt<se.npart_l;tt++){var nt,vt,Je,ht,mt=se.s3ind[tt][0],ft=se.s3ind[tt][1],_t=0,gn=0;for(_t=Ve[mt],gn+=1,vt=se.s3_ll[Ze]*Ie[mt]*D[Ve[mt]],++Ze,++mt;mt<=ft;)_t+=Ve[mt],gn+=1,nt=se.s3_ll[Ze]*Ie[mt]*D[Ve[mt]],ht=Q(vt,nt,mt-tt),vt=ht,++Ze,++mt;if(_t=(1+2*_t)/(2*gn),Je=D[_t]*.5,vt*=Je,se.blocktype_old[Oe&1]==pn.SHORT_TYPE){var _n=r*se.nb_1[Oe][tt];_n>0?De[tt]=Math.min(vt,_n):De[tt]=Math.min(vt,Ie[tt]*h)}else{var Bt=i*se.nb_2[Oe][tt],Yt=r*se.nb_1[Oe][tt],_n;Bt<=0&&(Bt=vt),Yt<=0&&(Yt=vt),se.blocktype_old[Oe&1]==pn.NORM_TYPE?_n=Math.min(Yt,Bt):_n=Yt,De[tt]=Math.min(vt,_n)}se.nb_2[Oe][tt]=se.nb_1[Oe][tt],se.nb_1[Oe][tt]=vt,nt=we[tt],nt*=se.minval_l[tt],nt*=Je,De[tt]>nt&&(De[tt]=nt),se.masking_lower>1&&(De[tt]*=se.masking_lower),De[tt]>Ie[tt]&&(De[tt]=Ie[tt]),se.masking_lower<1&&(De[tt]*=se.masking_lower),zi(De[tt]>=0)}for(;tt<pn.CBANDS;++tt)Ie[tt]=0,De[tt]=0}function ke(se,_e){var Ie=se.internal_flags;se.short_blocks==iT.short_block_coupled&&!(_e[0]!=0&&_e[1]!=0)&&(_e[0]=_e[1]=0);for(var De=0;De<Ie.channels_out;De++)se.short_blocks==iT.short_block_dispensed&&(_e[De]=1),se.short_blocks==iT.short_block_forced&&(_e[De]=0)}function be(se,_e,Ie){for(var De=se.internal_flags,Oe=0;Oe<De.channels_out;Oe++){var we=pn.NORM_TYPE;_e[Oe]!=0?(zi(De.blocktype_old[Oe]!=pn.START_TYPE),De.blocktype_old[Oe]==pn.SHORT_TYPE&&(we=pn.STOP_TYPE)):(we=pn.SHORT_TYPE,De.blocktype_old[Oe]==pn.NORM_TYPE&&(De.blocktype_old[Oe]=pn.START_TYPE),De.blocktype_old[Oe]==pn.STOP_TYPE&&(De.blocktype_old[Oe]=pn.SHORT_TYPE)),Ie[Oe]=De.blocktype_old[Oe],De.blocktype_old[Oe]=we}}function Ke(se,_e,Ie,De,Oe,we,st){for(var Ve=we*2,tt=we>0?Math.pow(10,Oe):1,Ze,nt,vt=0;vt<st;++vt){var Je=se[2][vt],ht=se[3][vt],mt=_e[0][vt],ft=_e[1][vt],_t=_e[2][vt],gn=_e[3][vt];if(mt<=1.58*ft&&ft<=1.58*mt){var _n=Ie[vt]*ht,Bt=Ie[vt]*Je;nt=Math.max(_t,Math.min(gn,_n)),Ze=Math.max(gn,Math.min(_t,Bt))}else nt=_t,Ze=gn;if(we>0){var Yt,Mt,fn=De[vt]*tt;if(Yt=Math.min(Math.max(mt,fn),Math.max(ft,fn)),_t=Math.max(nt,fn),gn=Math.max(Ze,fn),Mt=_t+gn,Mt>0&&Yt*Ve<Mt){var Bn=Yt*Ve/Mt;_t*=Bn,gn*=Bn}nt=Math.min(_t,nt),Ze=Math.min(gn,Ze)}nt>Je&&(nt=Je),Ze>ht&&(Ze=ht),_e[2][vt]=nt,_e[3][vt]=Ze}}this.L3psycho_anal_vbr=function(se,_e,Ie,De,Oe,we,st,Ve,tt,Ze){var nt=se.internal_flags,vt,Je,ht=df(pn.HBLKSIZE),mt=g0([3,pn.HBLKSIZE_s]),ft=g0([2,pn.BLKSIZE]),_t=g0([2,3,pn.BLKSIZE_s]),gn=g0([4,pn.CBANDS]),_n=g0([4,pn.CBANDS]),Bt=g0([4,3]),Yt=.6,Mt=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],fn=MS(2),Bn=se.mode==n.JOINT_STEREO?4:nt.channels_out;Ue(se,_e,Ie,De,Oe,we,tt,Bt,Mt,fn),ke(se,fn);{for(var cn=0;cn<Bn;cn++){var In=cn&1;vt=ft,$e(se,_e,Ie,cn,De,ht,vt,In),pt(se,De,cn,ht),fn[In]!=0?Se(nt,ht,gn[cn],_n[cn],cn):ze(nt,cn)}fn[0]+fn[1]==2&&se.mode==n.JOINT_STEREO&&Ke(gn,_n,nt.mld_cb_l,nt.ATH.cb_l,se.ATHlower*nt.ATH.adjust,se.msfix,nt.npart_l);for(var cn=0;cn<Bn;cn++){var In=cn&1;fn[In]!=0&&Z(nt,gn[cn],_n[cn],cn)}}{for(var Wn=0;Wn<3;Wn++){for(var cn=0;cn<Bn;++cn){var In=cn&1;fn[In]!=0?Ge(nt,cn,Wn):(Je=_t,at(se,_e,Ie,cn,Wn,mt,Je,In),me(se,mt,gn[cn],_n[cn],cn,Wn))}fn[0]+fn[1]==0&&se.mode==n.JOINT_STEREO&&Ke(gn,_n,nt.mld_cb_s,nt.ATH.cb_s,se.ATHlower*nt.ATH.adjust,se.msfix,nt.npart_s);for(var cn=0;cn<Bn;++cn){var In=cn&1;fn[In]==0&&ae(nt,gn[cn],_n[cn],cn,Wn)}}for(var cn=0;cn<Bn;cn++){var In=cn&1;if(fn[In]==0)for(var er=0;er<pn.SBMAX_s;er++){for(var os=df(3),Wn=0;Wn<3;Wn++){var gi=nt.thm[cn].s[er][Wn];if(gi*=u,Mt[cn][Wn]>=2||Mt[cn][Wn+1]==1){var Ni=Wn!=0?Wn-1:2,Fs=le(nt.thm[cn].s[er][Ni],gi,f*Yt);gi=Math.min(gi,Fs)}else if(Mt[cn][Wn]==1){var Ni=Wn!=0?Wn-1:2,Fs=le(nt.thm[cn].s[er][Ni],gi,h*Yt);gi=Math.min(gi,Fs)}else if(Wn!=0&&Mt[cn][Wn-1]==3||Wn==0&&nt.nsPsy.lastAttacks[cn]==3){var Ni=Wn!=2?Wn+1:0,Fs=le(nt.thm[cn].s[er][Ni],gi,h*Yt);gi=Math.min(gi,Fs)}gi*=Bt[cn][Wn],os[Wn]=gi}for(var Wn=0;Wn<3;Wn++)nt.thm[cn].s[er][Wn]=os[Wn]}}}for(var cn=0;cn<Bn;cn++)nt.nsPsy.lastAttacks[cn]=Mt[cn][2];be(se,fn,Ze);for(var cn=0;cn<Bn;cn++){var _i,Rs,ra,ls;cn>1?(_i=Ve,Rs=-2,ra=pn.NORM_TYPE,(Ze[0]==pn.SHORT_TYPE||Ze[1]==pn.SHORT_TYPE)&&(ra=pn.SHORT_TYPE),ls=we[De][cn-2]):(_i=st,Rs=0,ra=Ze[cn],ls=Oe[De][cn]),ra==pn.SHORT_TYPE?_i[Rs+cn]=de(ls,nt.masking_lower):_i[Rs+cn]=qe(ls,nt.masking_lower),se.analysis&&(nt.pinfo.pe[De][cn]=_i[Rs+cn])}return 0};function ot(se,_e){var Ie=se,De;return Ie>=0?De=-Ie*27:De=Ie*_e,De<=-72?0:Math.exp(De*_)}function lt(se){var _e=0,Ie=0;{var De=0,Oe,we;for(De=0;ot(De,se)>1e-20;De-=1);for(Oe=De,we=0;Math.abs(we-Oe)>1e-12;)De=(we+Oe)/2,ot(De,se)>0?we=De:Oe=De;_e=Oe}{var De=0,Oe,we;for(De=0;ot(De,se)>1e-20;De+=1);for(Oe=0,we=De;Math.abs(we-Oe)>1e-12;)De=(we+Oe)/2,ot(De,se)>0?Oe=De:we=De;Ie=we}{var st=0,Ve=1e3,tt;for(tt=0;tt<=Ve;++tt){var De=_e+tt*(Ie-_e)/Ve,Ze=ot(De,se);st+=Ze}{var nt=(Ve+1)/(st*(Ie-_e));return nt}}}function ct(se){var _e,Ie,De,Oe;return _e=se,_e>=0?_e*=3:_e*=1.5,_e>=.5&&_e<=2.5?(Oe=_e-.5,Ie=8*(Oe*Oe-2*Oe)):Ie=0,_e+=.474,De=15.811389+7.5*_e-17.5*Math.sqrt(1+_e*_e),De<=-60?0:(_e=Math.exp((Ie+De)*_),_e/=.6609193,_e)}function Vt(se){return se<0&&(se=0),se=se*.001,13*Math.atan(.76*se)+3.5*Math.atan(se*se/(7.5*7.5))}function Ot(se,_e,Ie,De,Oe,we,st,Ve,tt,Ze,nt,vt){var Je=df(pn.CBANDS+1),ht=Ve/(vt>15?2*576:384),mt=MS(pn.HBLKSIZE),ft;Ve/=tt;var _t=0,gn=0;for(ft=0;ft<pn.CBANDS;ft++){var _n,Bt;for(_n=Vt(Ve*_t),Je[ft]=Ve*_t,Bt=_t;Vt(Ve*Bt)-_n<o&&Bt<=tt/2;Bt++);for(se[ft]=Bt-_t,gn=ft+1;_t<Bt;)zi(_t<pn.HBLKSIZE),mt[_t++]=ft;if(_t>tt/2){_t=tt/2,++ft;break}}zi(ft<pn.CBANDS),Je[ft]=Ve*_t;for(var Yt=0;Yt<vt;Yt++){var Mt,fn,Bn,cn,In;Bn=Ze[Yt],cn=Ze[Yt+1],Mt=0|Math.floor(.5+nt*(Bn-.5)),Mt<0&&(Mt=0),fn=0|Math.floor(.5+nt*(cn-.5)),fn>tt/2&&(fn=tt/2),Ie[Yt]=(mt[Mt]+mt[fn])/2,_e[Yt]=mt[fn];var Wn=ht*cn;st[Yt]=(Wn-Je[_e[Yt]])/(Je[_e[Yt]+1]-Je[_e[Yt]]),st[Yt]<0?st[Yt]=0:st[Yt]>1&&(st[Yt]=1),In=Vt(Ve*Ze[Yt]*nt),In=Math.min(In,15.5)/15.5,we[Yt]=Math.pow(10,1.25*(1-Math.cos(Math.PI*In))-2.5)}_t=0;for(var er=0;er<gn;er++){var os=se[er],_n,gi;_n=Vt(Ve*_t),gi=Vt(Ve*(_t+os-1)),De[er]=.5*(_n+gi),_n=Vt(Ve*(_t-.5)),gi=Vt(Ve*(_t+os-.5)),Oe[er]=gi-_n,_t+=os}return gn}function Ut(se,_e,Ie,De,Oe,we){var st=g0([pn.CBANDS,pn.CBANDS]),Ve,tt=0;if(we)for(var Ze=0;Ze<_e;Ze++)for(Ve=0;Ve<_e;Ve++){var nt=ct(Ie[Ze]-Ie[Ve])*De[Ve];st[Ze][Ve]=nt*Oe[Ze]}else for(Ve=0;Ve<_e;Ve++)for(var vt=15+Math.min(21/Ie[Ve],12),Je=lt(vt),Ze=0;Ze<_e;Ze++){var nt=Je*ot(Ie[Ze]-Ie[Ve],vt)*De[Ve];st[Ze][Ve]=nt*Oe[Ze]}for(var Ze=0;Ze<_e;Ze++){for(Ve=0;Ve<_e&&!(st[Ze][Ve]>0);Ve++);for(se[Ze][0]=Ve,Ve=_e-1;Ve>0&&!(st[Ze][Ve]>0);Ve--);se[Ze][1]=Ve,tt+=se[Ze][1]-se[Ze][0]+1}for(var ht=df(tt),mt=0,Ze=0;Ze<_e;Ze++)for(Ve=se[Ze][0];Ve<=se[Ze][1];Ve++)ht[mt++]=st[Ze][Ve];return ht}function je(se){var _e=Vt(se);return _e=Math.min(_e,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*_e))-2.5)}this.psymodel_init=function(se){var _e=se.internal_flags,Ie,De=!0,Oe=13,we=24,st=0,Ve=0,tt=-8.25,Ze=-4.5,nt=df(pn.CBANDS),vt=df(pn.CBANDS),Je=df(pn.CBANDS),ht=se.out_samplerate;switch(se.experimentalZ){default:case 0:De=!0;break;case 1:De=!(se.VBR==rT.vbr_mtrh||se.VBR==rT.vbr_mt);break;case 2:De=!1;break;case 3:Oe=8,st=-1.75,Ve=-.0125,tt=-8.25,Ze=-2.25;break}for(_e.ms_ener_ratio_old=.25,_e.blocktype_old[0]=_e.blocktype_old[1]=pn.NORM_TYPE,Ie=0;Ie<4;++Ie){for(var _t=0;_t<pn.CBANDS;++_t)_e.nb_1[Ie][_t]=1e20,_e.nb_2[Ie][_t]=1e20,_e.nb_s1[Ie][_t]=_e.nb_s2[Ie][_t]=1;for(var mt=0;mt<pn.SBMAX_l;mt++)_e.en[Ie].l[mt]=1e20,_e.thm[Ie].l[mt]=1e20;for(var _t=0;_t<3;++_t){for(var mt=0;mt<pn.SBMAX_s;mt++)_e.en[Ie].s[mt][_t]=1e20,_e.thm[Ie].s[mt][_t]=1e20;_e.nsPsy.lastAttacks[Ie]=0}for(var _t=0;_t<9;_t++)_e.nsPsy.last_en_subshort[Ie][_t]=10}for(_e.loudness_sq_save[0]=_e.loudness_sq_save[1]=0,_e.npart_l=Ot(_e.numlines_l,_e.bo_l,_e.bm_l,nt,vt,_e.mld_l,_e.PSY.bo_l_weight,ht,pn.BLKSIZE,_e.scalefac_band.l,pn.BLKSIZE/(2*576),pn.SBMAX_l),zi(_e.npart_l<pn.CBANDS),Ie=0;Ie<_e.npart_l;Ie++){var ft=st;nt[Ie]>=Oe&&(ft=Ve*(nt[Ie]-Oe)/(we-Oe)+st*(we-nt[Ie])/(we-Oe)),Je[Ie]=Math.pow(10,ft/10),_e.numlines_l[Ie]>0?_e.rnumlines_l[Ie]=1/_e.numlines_l[Ie]:_e.rnumlines_l[Ie]=0}_e.s3_ll=Ut(_e.s3ind,_e.npart_l,nt,vt,Je,De);var _t=0;for(Ie=0;Ie<_e.npart_l;Ie++){var gn;gn=Bre.MAX_VALUE;for(var _n=0;_n<_e.numlines_l[Ie];_n++,_t++){var Bt=ht*_t/(1e3*pn.BLKSIZE),Yt;Yt=this.ATHformula(Bt*1e3,se)-20,Yt=Math.pow(10,.1*Yt),Yt*=_e.numlines_l[Ie],gn>Yt&&(gn=Yt)}_e.ATH.cb_l[Ie]=gn,gn=-20+nt[Ie]*20/10,gn>6&&(gn=100),gn<-15&&(gn=-15),gn-=8,_e.minval_l[Ie]=Math.pow(10,gn/10)*_e.numlines_l[Ie]}for(_e.npart_s=Ot(_e.numlines_s,_e.bo_s,_e.bm_s,nt,vt,_e.mld_s,_e.PSY.bo_s_weight,ht,pn.BLKSIZE_s,_e.scalefac_band.s,pn.BLKSIZE_s/384,pn.SBMAX_s),zi(_e.npart_s<pn.CBANDS),_t=0,Ie=0;Ie<_e.npart_s;Ie++){var gn,ft=tt;nt[Ie]>=Oe&&(ft=Ze*(nt[Ie]-Oe)/(we-Oe)+tt*(we-nt[Ie])/(we-Oe)),Je[Ie]=Math.pow(10,ft/10),gn=Bre.MAX_VALUE;for(var _n=0;_n<_e.numlines_s[Ie];_n++,_t++){var Bt=ht*_t/(1e3*pn.BLKSIZE_s),Yt;Yt=this.ATHformula(Bt*1e3,se)-20,Yt=Math.pow(10,.1*Yt),Yt*=_e.numlines_s[Ie],gn>Yt&&(gn=Yt)}_e.ATH.cb_s[Ie]=gn,gn=-7+nt[Ie]*7/12,nt[Ie]>12&&(gn*=1+Math.log(1+gn)*3.1),nt[Ie]<12&&(gn*=1+Math.log(1-gn)*2.3),gn<-15&&(gn=-15),gn-=8,_e.minval_s[Ie]=Math.pow(10,gn/10)*_e.numlines_s[Ie]}_e.s3_ss=Ut(_e.s3ind_s,_e.npart_s,nt,vt,Je,De),V(),e.init_fft(_e),_e.decay=Math.exp(-1*t/(c*ht/192));{var Mt;Mt=g,se.exp_nspsytune&2&&(Mt=1),Math.abs(se.msfix)>0&&(Mt=se.msfix),se.msfix=Mt;for(var fn=0;fn<_e.npart_l;fn++)_e.s3ind[fn][1]>_e.npart_l-1&&(_e.s3ind[fn][1]=_e.npart_l-1)}var Bn=576*_e.mode_gr/ht;if(_e.ATH.decay=Math.pow(10,-12/10*Bn),_e.ATH.adjust=.01,_e.ATH.adjustLimit=1,zi(_e.bo_l[pn.SBMAX_l-1]<=_e.npart_l),zi(_e.bo_s[pn.SBMAX_s-1]<=_e.npart_s),se.ATHtype!=-1){var Bt,cn=se.out_samplerate/pn.BLKSIZE,In=0;for(Bt=0,Ie=0;Ie<pn.BLKSIZE/2;++Ie)Bt+=cn,_e.ATH.eql_w[Ie]=1/Math.pow(10,this.ATHformula(Bt,se)/10),In+=_e.ATH.eql_w[Ie];for(In=1/In,Ie=pn.BLKSIZE/2;--Ie>=0;)_e.ATH.eql_w[Ie]*=In}{for(var fn=_t=0;fn<_e.npart_s;++fn)for(Ie=0;Ie<_e.numlines_s[fn];++Ie)++_t;for(var fn=_t=0;fn<_e.npart_l;++fn)for(Ie=0;Ie<_e.numlines_l[fn];++Ie)++_t}for(_t=0,Ie=0;Ie<_e.npart_l;Ie++){var Bt=ht*(_t+_e.numlines_l[Ie]/2)/(1*pn.BLKSIZE);_e.mld_cb_l[Ie]=je(Bt),_t+=_e.numlines_l[Ie]}for(;Ie<pn.CBANDS;++Ie)_e.mld_cb_l[Ie]=1;for(_t=0,Ie=0;Ie<_e.npart_s;Ie++){var Bt=ht*(_t+_e.numlines_s[Ie]/2)/(1*pn.BLKSIZE_s);_e.mld_cb_s[Ie]=je(Bt),_t+=_e.numlines_s[Ie]}for(;Ie<pn.CBANDS;++Ie)_e.mld_cb_s[Ie]=1;return 0};function ge(se,_e){se<-.3&&(se=3410),se/=1e3,se=Math.max(.1,se);var Ie=3.64*Math.pow(se,-.8)-6.8*Math.exp(-.6*Math.pow(se-3.4,2))+6*Math.exp(-.15*Math.pow(se-8.7,2))+(.6+.04*_e)*.001*Math.pow(se,4);return Ie}this.ATHformula=function(se,_e){var Ie;switch(_e.ATHtype){case 0:Ie=ge(se,9);break;case 1:Ie=ge(se,-1);break;case 2:Ie=ge(se,0);break;case 3:Ie=ge(se,1)+6;break;case 4:Ie=ge(se,_e.ATHcurve);break;default:Ie=ge(se,0);break}return Ie}}var Sct=bct,Ect=v3;function xct(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Ect.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Tct=xct,wct=ap(),Xve={};Xve.SFBMAX=wct.SBMAX_s*3;var C6=Xve,Kve=Rc,Rct=Kve.new_float,OS=Kve.new_int,AF=C6;function Act(){this.xr=Rct(576),this.l3_enc=OS(576),this.scalefac=OS(AF.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=OS(3),this.subblock_gain=OS(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=OS(AF.SFBMAX),this.window=OS(AF.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=OS(4),this.max_nonzero_coeff=0;var n=this;function e(r){return new Int32Array(r)}function t(r){return new Float32Array(r)}this.assign=function(r){n.xr=t(r.xr),n.l3_enc=e(r.l3_enc),n.scalefac=e(r.scalefac),n.xrpow_max=r.xrpow_max,n.part2_3_length=r.part2_3_length,n.big_values=r.big_values,n.count1=r.count1,n.global_gain=r.global_gain,n.scalefac_compress=r.scalefac_compress,n.block_type=r.block_type,n.mixed_block_flag=r.mixed_block_flag,n.table_select=e(r.table_select),n.subblock_gain=e(r.subblock_gain),n.region0_count=r.region0_count,n.region1_count=r.region1_count,n.preflag=r.preflag,n.scalefac_scale=r.scalefac_scale,n.count1table_select=r.count1table_select,n.part2_length=r.part2_length,n.sfb_lmax=r.sfb_lmax,n.sfb_smin=r.sfb_smin,n.psy_lmax=r.psy_lmax,n.sfbmax=r.sfbmax,n.psymax=r.psymax,n.sfbdivide=r.sfbdivide,n.width=e(r.width),n.window=e(r.window),n.count1bits=r.count1bits,n.sfb_partition_table=r.sfb_partition_table.slice(0),n.slen=e(r.slen),n.max_nonzero_coeff=r.max_nonzero_coeff}}var nG=Act,Cct=Rc,Fre=Cct.new_int,Mct=nG;function Oct(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Fre(4),Fre(4)];for(var n=0;n<2;n++)for(var e=0;e<2;e++)this.tt[n][e]=new Mct}var kct=Oct,Zve=Rc,kN=Zve.System,IN=Zve.new_int,NN=ap();function Ict(n,e,t,r){this.l=IN(1+NN.SBMAX_l),this.s=IN(1+NN.SBMAX_s),this.psfb21=IN(1+NN.PSFB21),this.psfb12=IN(1+NN.PSFB12);var i=this.l,s=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],kN.arraycopy(this.arrL,0,i,0,Math.min(this.arrL.length,this.l.length)),kN.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),kN.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),kN.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Jve=Ict,rG=Rc,CF=rG.new_float,Nct=rG.new_float_n,Pct=rG.new_int,zre=ap();function Dct(){this.last_en_subshort=Nct([4,9]),this.lastAttacks=Pct(4),this.pefirbuf=CF(19),this.longfact=CF(zre.SBMAX_l),this.shortfact=CF(zre.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var Lct=Dct;function Uct(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Bct=Uct,gR=Rc,Fct=gR.new_byte,zct=gR.new_double,_0=gR.new_float,kS=gR.new_float_n,d_=gR.new_int,PN=gR.new_int_n,jct=kct,Hct=Jve,qct=Lct,Vct=Bct,jre=Wve(),du=ap(),Gct=C6;sb.MFSIZE=3*1152+du.ENCDELAY-du.MDCTDELAY;sb.MAX_HEADER_BUF=256;sb.MAX_BITS_PER_CHANNEL=4095;sb.MAX_BITS_PER_GRANULE=7680;sb.BPC=320;function sb(){var n=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=kS([2,sb.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new jct,this.ms_ratio=_0(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=d_(2),this.CurrentStep=d_(2),this.masking_lower=0,this.bv_scf=d_(576),this.pseudohalf=d_(Gct.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*sb.BPC+1),this.itime=zct(2),this.sideinfo_len=0,this.sb_sample=kS([2,2,18,du.SBLIMIT]),this.amp_filter=_0(32);function e(){this.write_timing=0,this.ptr=0,this.buf=Fct(n)}this.header=new Array(sb.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Hct,this.minval_l=_0(du.CBANDS),this.minval_s=_0(du.CBANDS),this.nb_1=kS([4,du.CBANDS]),this.nb_2=kS([4,du.CBANDS]),this.nb_s1=kS([4,du.CBANDS]),this.nb_s2=kS([4,du.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=_0(4),this.loudness_sq=kS([2,2]),this.loudness_sq_save=_0(2),this.mld_l=_0(du.SBMAX_l),this.mld_s=_0(du.SBMAX_s),this.bm_l=d_(du.SBMAX_l),this.bo_l=d_(du.SBMAX_l),this.bm_s=d_(du.SBMAX_s),this.bo_s=d_(du.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=PN([du.CBANDS,2]),this.s3ind_s=PN([du.CBANDS,2]),this.numlines_s=d_(du.CBANDS),this.numlines_l=d_(du.CBANDS),this.rnumlines_l=_0(du.CBANDS),this.mld_cb_l=_0(du.CBANDS),this.mld_cb_s=_0(du.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=_0(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=d_(2),this.nsPsy=new qct,this.VBR_seek_table=new Vct,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=PN([16,5]),this.bitrate_blockType_Hist=PN([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new jre;for(var t=0;t<this.thm.length;t++)this.thm[t]=new jre;for(var t=0;t<this.header.length;t++)this.header[t]=new e}var M6=sb,$ct=Rc,IS=$ct.new_float,NS=ap();function Wct(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=IS(NS.SBMAX_l),this.s=IS(NS.SBMAX_s),this.psfb21=IS(NS.PSFB21),this.psfb12=IS(NS.PSFB12),this.cb_l=IS(NS.CBANDS),this.cb_s=IS(NS.CBANDS),this.eql_w=IS(NS.BLKSIZE/2)}var Yct=Wct,Qve=Rc,mm=Qve.System,Hre=Qve.Arrays;Su.STEPS_per_dB=100;Su.MAX_dB=120;Su.GAIN_NOT_ENOUGH_SAMPLES=-24601;Su.GAIN_ANALYSIS_ERROR=0;Su.GAIN_ANALYSIS_OK=1;Su.INIT_GAIN_ANALYSIS_ERROR=0;Su.INIT_GAIN_ANALYSIS_OK=1;Su.YULE_ORDER=10;Su.MAX_ORDER=Su.YULE_ORDER;Su.MAX_SAMP_FREQ=48e3;Su.RMS_WINDOW_TIME_NUMERATOR=1;Su.RMS_WINDOW_TIME_DENOMINATOR=20;Su.MAX_SAMPLES_PER_WINDOW=Su.MAX_SAMP_FREQ*Su.RMS_WINDOW_TIME_NUMERATOR/Su.RMS_WINDOW_TIME_DENOMINATOR+1;function Su(){var n=64.82,e=.95,t=Su.RMS_WINDOW_TIME_NUMERATOR,r=Su.RMS_WINDOW_TIME_DENOMINATOR,i=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],s=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function a(f,h,g,p,_,y){for(;_--!=0;)g[p]=1e-10+f[h+0]*y[0]-g[p-1]*y[1]+f[h-1]*y[2]-g[p-2]*y[3]+f[h-2]*y[4]-g[p-3]*y[5]+f[h-3]*y[6]-g[p-4]*y[7]+f[h-4]*y[8]-g[p-5]*y[9]+f[h-5]*y[10]-g[p-6]*y[11]+f[h-6]*y[12]-g[p-7]*y[13]+f[h-7]*y[14]-g[p-8]*y[15]+f[h-8]*y[16]-g[p-9]*y[17]+f[h-9]*y[18]-g[p-10]*y[19]+f[h-10]*y[20],++p,++h}function o(f,h,g,p,_,y){for(;_--!=0;)g[p]=f[h+0]*y[0]-g[p-1]*y[1]+f[h-1]*y[2]-g[p-2]*y[3]+f[h-2]*y[4],++p,++h}function l(f,h){for(var g=0;g<MAX_ORDER;g++)f.linprebuf[g]=f.lstepbuf[g]=f.loutbuf[g]=f.rinprebuf[g]=f.rstepbuf[g]=f.routbuf[g]=0;switch(0|h){case 48e3:f.reqindex=0;break;case 44100:f.reqindex=1;break;case 32e3:f.reqindex=2;break;case 24e3:f.reqindex=3;break;case 22050:f.reqindex=4;break;case 16e3:f.reqindex=5;break;case 12e3:f.reqindex=6;break;case 11025:f.reqindex=7;break;case 8e3:f.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return f.sampleWindow=0|(h*t+r-1)/r,f.lsum=0,f.rsum=0,f.totsamp=0,Hre.ill(f.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(f,h){return l(f,h)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(f.linpre=MAX_ORDER,f.rinpre=MAX_ORDER,f.lstep=MAX_ORDER,f.rstep=MAX_ORDER,f.lout=MAX_ORDER,f.rout=MAX_ORDER,Hre.fill(f.B,0),INIT_GAIN_ANALYSIS_OK)};function c(f){return f*f}this.AnalyzeSamples=function(f,h,g,p,_,y,v){var x,E,M,k,N,I,D;if(y==0)return GAIN_ANALYSIS_OK;switch(D=0,N=y,v){case 1:p=h,_=g;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(y<MAX_ORDER?(mm.arraycopy(h,g,f.linprebuf,MAX_ORDER,y),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER,y)):(mm.arraycopy(h,g,f.linprebuf,MAX_ORDER,MAX_ORDER),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER,MAX_ORDER));N>0;){I=N>f.sampleWindow-f.totsamp?f.sampleWindow-f.totsamp:N,D<MAX_ORDER?(x=f.linpre+D,E=f.linprebuf,M=f.rinpre+D,k=f.rinprebuf,I>MAX_ORDER-D&&(I=MAX_ORDER-D)):(x=g+D,E=h,M=_+D,k=p),a(E,x,f.lstepbuf,f.lstep+f.totsamp,I,i[f.reqindex]),a(k,M,f.rstepbuf,f.rstep+f.totsamp,I,i[f.reqindex]),o(f.lstepbuf,f.lstep+f.totsamp,f.loutbuf,f.lout+f.totsamp,I,s[f.reqindex]),o(f.rstepbuf,f.rstep+f.totsamp,f.routbuf,f.rout+f.totsamp,I,s[f.reqindex]),x=f.lout+f.totsamp,E=f.loutbuf,M=f.rout+f.totsamp,k=f.routbuf;for(var V=I%8;V--!=0;)f.lsum+=c(E[x++]),f.rsum+=c(k[M++]);for(V=I/8;V--!=0;)f.lsum+=c(E[x+0])+c(E[x+1])+c(E[x+2])+c(E[x+3])+c(E[x+4])+c(E[x+5])+c(E[x+6])+c(E[x+7]),x+=8,f.rsum+=c(k[M+0])+c(k[M+1])+c(k[M+2])+c(k[M+3])+c(k[M+4])+c(k[M+5])+c(k[M+6])+c(k[M+7]),M+=8;if(N-=I,D+=I,f.totsamp+=I,f.totsamp==f.sampleWindow){var G=Su.STEPS_per_dB*10*Math.log10((f.lsum+f.rsum)/f.totsamp*.5+1e-37),J=G<=0?0:0|G;J>=f.A.length&&(J=f.A.length-1),f.A[J]++,f.lsum=f.rsum=0,mm.arraycopy(f.loutbuf,f.totsamp,f.loutbuf,0,MAX_ORDER),mm.arraycopy(f.routbuf,f.totsamp,f.routbuf,0,MAX_ORDER),mm.arraycopy(f.lstepbuf,f.totsamp,f.lstepbuf,0,MAX_ORDER),mm.arraycopy(f.rstepbuf,f.totsamp,f.rstepbuf,0,MAX_ORDER),f.totsamp=0}if(f.totsamp>f.sampleWindow)return GAIN_ANALYSIS_ERROR}return y<MAX_ORDER?(mm.arraycopy(f.linprebuf,y,f.linprebuf,0,MAX_ORDER-y),mm.arraycopy(f.rinprebuf,y,f.rinprebuf,0,MAX_ORDER-y),mm.arraycopy(h,g,f.linprebuf,MAX_ORDER-y,y),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER-y,y)):(mm.arraycopy(h,g+y-MAX_ORDER,f.linprebuf,0,MAX_ORDER),mm.arraycopy(p,_+y-MAX_ORDER,f.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function u(f,h){var g,p=0;for(g=0;g<h;g++)p+=f[g];if(p==0)return GAIN_NOT_ENOUGH_SAMPLES;var _=0|Math.ceil(p*(1-e));for(g=h;g-- >0&&!((_-=f[g])<=0););return n-g/Su.STEPS_per_dB}this.GetTitleGain=function(f){for(var h=u(f.A,f.A.length),g=0;g<f.A.length;g++)f.B[g]+=f.A[g],f.A[g]=0;for(var g=0;g<MAX_ORDER;g++)f.linprebuf[g]=f.lstepbuf[g]=f.loutbuf[g]=f.rinprebuf[g]=f.rstepbuf[g]=f.routbuf[g]=0;return f.totsamp=0,f.lsum=f.rsum=0,h}}var eye=Su,tye=Rc,sT=tye.new_float,qre=tye.new_int,gm=eye;function Xct(){this.linprebuf=sT(gm.MAX_ORDER*2),this.linpre=0,this.lstepbuf=sT(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.lstep=0,this.loutbuf=sT(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.lout=0,this.rinprebuf=sT(gm.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=sT(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.rstep=0,this.routbuf=sT(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=qre(0|gm.STEPS_per_dB*gm.MAX_dB),this.B=qre(0|gm.STEPS_per_dB*gm.MAX_dB)}var Kct=Xct;function Zct(n){this.bits=n}var nye=Zct,iG=Rc,Vre=iG.new_float,Jct=iG.new_int,Gre=iG.assert,Qct=nye,$re=ap(),eut=C6,tut=M6;function nut(n){var e=n;this.quantize=e,this.iteration_loop=function(t,r,i,s){var a=t.internal_flags,o=Vre(eut.SFBMAX),l=Vre(576),c=Jct(2),u=0,f,h=a.l3_side,g=new Qct(u);this.quantize.rv.ResvFrameBegin(t,g),u=g.bits;for(var p=0;p<a.mode_gr;p++){f=this.quantize.qupvt.on_pe(t,r,c,u,p,p),a.mode_ext==$re.MPG_MD_MS_LR&&(this.quantize.ms_convert(a.l3_side,p),this.quantize.qupvt.reduce_side(c,i[p],u,f));for(var _=0;_<a.channels_out;_++){var y,v,x=h.tt[p][_];x.block_type!=$re.SHORT_TYPE?(y=0,v=a.PSY.mask_adjust-y):(y=0,v=a.PSY.mask_adjust_short-y),a.masking_lower=Math.pow(10,v*.1),this.quantize.init_outer_loop(a,x),this.quantize.init_xrpow(a,x,l)&&(this.quantize.qupvt.calc_xmin(t,s[p][_],x,o),this.quantize.outer_loop(t,x,o,l,_,c[_])),this.quantize.iteration_finish_one(a,p,_),Gre(x.part2_3_length<=tut.MAX_BITS_PER_CHANNEL),Gre(x.part2_3_length<=c[_])}}this.quantize.rv.ResvFrameEnd(a,u)}}var rut=nut;function Ma(n,e,t,r){this.xlen=n,this.linmax=e,this.table=t,this.hlen=r}var On={};On.t1HB=[1,1,1,0];On.t2HB=[1,2,1,3,1,1,3,2,0];On.t3HB=[3,2,1,1,1,1,3,2,0];On.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];On.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];On.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];On.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];On.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];On.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];On.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];On.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];On.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];On.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];On.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];On.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];On.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];On.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];On.t1l=[1,4,3,5];On.t2l=[1,4,7,4,5,7,6,7,8];On.t3l=[2,3,7,4,4,7,6,7,8];On.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];On.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];On.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];On.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];On.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];On.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];On.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];On.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];On.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];On.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];On.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];On.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];On.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];On.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10];On.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8];On.ht=[new Ma(0,0,null,null),new Ma(2,0,On.t1HB,On.t1l),new Ma(3,0,On.t2HB,On.t2l),new Ma(3,0,On.t3HB,On.t3l),new Ma(0,0,null,null),new Ma(4,0,On.t5HB,On.t5l),new Ma(4,0,On.t6HB,On.t6l),new Ma(6,0,On.t7HB,On.t7l),new Ma(6,0,On.t8HB,On.t8l),new Ma(6,0,On.t9HB,On.t9l),new Ma(8,0,On.t10HB,On.t10l),new Ma(8,0,On.t11HB,On.t11l),new Ma(8,0,On.t12HB,On.t12l),new Ma(16,0,On.t13HB,On.t13l),new Ma(0,0,null,On.t16_5l),new Ma(16,0,On.t15HB,On.t15l),new Ma(1,1,On.t16HB,On.t16l),new Ma(2,3,On.t16HB,On.t16l),new Ma(3,7,On.t16HB,On.t16l),new Ma(4,15,On.t16HB,On.t16l),new Ma(6,63,On.t16HB,On.t16l),new Ma(8,255,On.t16HB,On.t16l),new Ma(10,1023,On.t16HB,On.t16l),new Ma(13,8191,On.t16HB,On.t16l),new Ma(4,15,On.t24HB,On.t24l),new Ma(5,31,On.t24HB,On.t24l),new Ma(6,63,On.t24HB,On.t24l),new Ma(7,127,On.t24HB,On.t24l),new Ma(8,255,On.t24HB,On.t24l),new Ma(9,511,On.t24HB,On.t24l),new Ma(11,2047,On.t24HB,On.t24l),new Ma(13,8191,On.t24HB,On.t24l),new Ma(0,0,On.t32HB,On.t32l),new Ma(0,0,On.t33HB,On.t33l)];On.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];On.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];On.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];On.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];On.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];On.scfsi_band=[0,6,11,16,21];var sG=On,MF,Wre;function rye(){if(Wre)return MF;Wre=1;var n=Jve,e=Rc,t=e.VbrMode,r=e.Float,i=e.Util,s=e.new_float,a=e.new_int,o=e.assert,l=ap(),c=nye,u=M6;f.Q_MAX=257,f.Q_MAX2=116,f.LARGE_BITS=1e5,f.IXMAX_VAL=8206;function f(){var h=aG(),g=null,p=null,_=null;this.setModules=function(Q,W,q){g=Q,p=W,_=q};function y(Q){return o(0<=Q+f.Q_MAX2&&Q<f.Q_MAX),D[Q+f.Q_MAX2]}this.IPOW20=function(Q){return o(0<=Q&&Q<f.Q_MAX),V[Q]};var v=2220446049250313e-31,x=f.IXMAX_VAL,E=x+2,M=f.Q_MAX,k=f.Q_MAX2;f.LARGE_BITS;var N=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var I=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=I,this.sfBandIndex=[new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var D=s(M+k+1),V=s(M),G=s(E),J=s(E);this.adj43=J;function B(Q,W){var q=_.ATHformula(W,Q);return q-=N,q=Math.pow(10,q/10+Q.ATHlower),q}function $(Q){for(var W=Q.internal_flags.ATH.l,q=Q.internal_flags.ATH.psfb21,Y=Q.internal_flags.ATH.s,ae=Q.internal_flags.ATH.psfb12,Z=Q.internal_flags,K=Q.out_samplerate,ne=0;ne<l.SBMAX_l;ne++){var le=Z.scalefac_band.l[ne],ce=Z.scalefac_band.l[ne+1];W[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/1152,qe=B(Q,Me);W[ne]=Math.min(W[ne],qe)}}for(var ne=0;ne<l.PSFB21;ne++){var le=Z.scalefac_band.psfb21[ne],ce=Z.scalefac_band.psfb21[ne+1];q[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/1152,qe=B(Q,Me);q[ne]=Math.min(q[ne],qe)}}for(var ne=0;ne<l.SBMAX_s;ne++){var le=Z.scalefac_band.s[ne],ce=Z.scalefac_band.s[ne+1];Y[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/384,qe=B(Q,Me);Y[ne]=Math.min(Y[ne],qe)}Y[ne]*=Z.scalefac_band.s[ne+1]-Z.scalefac_band.s[ne]}for(var ne=0;ne<l.PSFB12;ne++){var le=Z.scalefac_band.psfb12[ne],ce=Z.scalefac_band.psfb12[ne+1];ae[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/384,qe=B(Q,Me);ae[ne]=Math.min(ae[ne],qe)}ae[ne]*=Z.scalefac_band.s[13]-Z.scalefac_band.s[12]}if(Q.noATH){for(var ne=0;ne<l.SBMAX_l;ne++)W[ne]=1e-20;for(var ne=0;ne<l.PSFB21;ne++)q[ne]=1e-20;for(var ne=0;ne<l.SBMAX_s;ne++)Y[ne]=1e-20;for(var ne=0;ne<l.PSFB12;ne++)ae[ne]=1e-20}Z.ATH.floor=10*Math.log10(B(Q,-1))}this.iteration_init=function(Q){var W=Q.internal_flags,q=W.l3_side,Y;if(W.iteration_init_init==0){for(W.iteration_init_init=1,q.main_data_begin=0,$(Q),G[0]=0,Y=1;Y<E;Y++)G[Y]=Math.pow(Y,4/3);for(Y=0;Y<E-1;Y++)J[Y]=Y+1-Math.pow(.5*(G[Y]+G[Y+1]),.75);for(J[Y]=.5,Y=0;Y<M;Y++)V[Y]=Math.pow(2,(Y-210)*-.1875);for(Y=0;Y<=M+k;Y++)D[Y]=Math.pow(2,(Y-210-k)*.25);g.huffman_init(W);{var ae,Z,K,ne;for(Y=Q.exp_nspsytune>>2&63,Y>=32&&(Y-=64),ae=Math.pow(10,Y/4/10),Y=Q.exp_nspsytune>>8&63,Y>=32&&(Y-=64),Z=Math.pow(10,Y/4/10),Y=Q.exp_nspsytune>>14&63,Y>=32&&(Y-=64),K=Math.pow(10,Y/4/10),Y=Q.exp_nspsytune>>20&63,Y>=32&&(Y-=64),ne=K*Math.pow(10,Y/4/10),Y=0;Y<l.SBMAX_l;Y++){var le;Y<=6?le=ae:Y<=13?le=Z:Y<=20?le=K:le=ne,W.nsPsy.longfact[Y]=le}for(Y=0;Y<l.SBMAX_s;Y++){var le;Y<=5?le=ae:Y<=10?le=Z:Y<=11?le=K:le=ne,W.nsPsy.shortfact[Y]=le}}}},this.on_pe=function(Q,W,q,Y,ae,Z){var K=Q.internal_flags,ne=0,le,ce=a(2),de,Me=new c(ne),qe=p.ResvMaxBits(Q,Y,Me,Z);ne=Me.bits;var Ne=ne+qe;for(Ne>u.MAX_BITS_PER_GRANULE&&(Ne=u.MAX_BITS_PER_GRANULE),le=0,de=0;de<K.channels_out;++de)q[de]=Math.min(u.MAX_BITS_PER_CHANNEL,ne/K.channels_out),ce[de]=0|q[de]*W[ae][de]/700-q[de],ce[de]>Y*3/4&&(ce[de]=Y*3/4),ce[de]<0&&(ce[de]=0),ce[de]+q[de]>u.MAX_BITS_PER_CHANNEL&&(ce[de]=Math.max(0,u.MAX_BITS_PER_CHANNEL-q[de])),le+=ce[de];if(le>qe)for(de=0;de<K.channels_out;++de)ce[de]=qe*ce[de]/le;for(de=0;de<K.channels_out;++de)q[de]+=ce[de],qe-=ce[de];for(le=0,de=0;de<K.channels_out;++de)le+=q[de];if(le>u.MAX_BITS_PER_GRANULE){var Ae=0;for(de=0;de<K.channels_out;++de)q[de]*=u.MAX_BITS_PER_GRANULE,q[de]/=le,Ae+=q[de]}return Ne},this.reduce_side=function(Q,W,q,Y){o(Q[0]+Q[1]<=u.MAX_BITS_PER_GRANULE);var ae=.33*(.5-W)/.5;ae<0&&(ae=0),ae>.5&&(ae=.5);var Z=0|ae*.5*(Q[0]+Q[1]);Z>u.MAX_BITS_PER_CHANNEL-Q[0]&&(Z=u.MAX_BITS_PER_CHANNEL-Q[0]),Z<0&&(Z=0),Q[1]>=125&&(Q[1]-Z>125?(Q[0]<q&&(Q[0]+=Z),Q[1]-=Z):(Q[0]+=Q[1]-125,Q[1]=125)),Z=Q[0]+Q[1],Z>Y&&(Q[0]=Y*Q[0]/Z,Q[1]=Y*Q[1]/Z),o(Q[0]<=u.MAX_BITS_PER_CHANNEL),o(Q[1]<=u.MAX_BITS_PER_CHANNEL),o(Q[0]+Q[1]<=u.MAX_BITS_PER_GRANULE)},this.athAdjust=function(Q,W,q){var Y=90.30873362,ae=94.82444863,Z=i.FAST_LOG10_X(W,10),K=Q*Q,ne=0;return Z-=q,K>1e-20&&(ne=1+i.FAST_LOG10_X(K,10/Y)),ne<0&&(ne=0),Z*=ne,Z+=q+Y-ae,Math.pow(10,.1*Z)},this.calc_xmin=function(Q,W,q,Y){var ae=0,Z=Q.internal_flags,K,ne=0,le=0,ce=Z.ATH,de=q.xr,Me=Q.VBR==t.vbr_mtrh?1:0,qe=Z.masking_lower;for((Q.VBR==t.vbr_mtrh||Q.VBR==t.vbr_mt)&&(qe=1),K=0;K<q.psy_lmax;K++){var Ne,Ae,Xe,$e,at,pt;Q.VBR==t.vbr_rh||Q.VBR==t.vbr_mtrh?Ae=athAdjust(ce.adjust,ce.l[K],ce.floor):Ae=ce.adjust*ce.l[K],at=q.width[K],Xe=Ae/at,$e=v,pt=at>>1,Ne=0;do{var oe,Ue;oe=de[ne]*de[ne],Ne+=oe,$e+=oe<Xe?oe:Xe,ne++,Ue=de[ne]*de[ne],Ne+=Ue,$e+=Ue<Xe?Ue:Xe,ne++}while(--pt>0);if(Ne>Ae&&le++,K==l.SBPSY_l){var Ge=Ae*Z.nsPsy.longfact[K];$e<Ge&&($e=Ge)}if(Me!=0&&(Ae=$e),!Q.ATHonly){var ze=W.en.l[K];if(ze>0){var Ge;Ge=Ne*W.thm.l[K]*qe/ze,Me!=0&&(Ge*=Z.nsPsy.longfact[K]),Ae<Ge&&(Ae=Ge)}}Me!=0?Y[ae++]=Ae:Y[ae++]=Ae*Z.nsPsy.longfact[K]}var Be=575;if(q.block_type!=l.SHORT_TYPE)for(var me=576;me--!=0&&h.EQ(de[me],0);)Be=me;q.max_nonzero_coeff=Be;for(var Se=q.sfb_smin;K<q.psymax;Se++,K+=3){var at,ke,be;for(Q.VBR==t.vbr_rh||Q.VBR==t.vbr_mtrh?be=athAdjust(ce.adjust,ce.s[Se],ce.floor):be=ce.adjust*ce.s[Se],at=q.width[K],ke=0;ke<3;ke++){var Ne=0,Ae,Xe,$e,pt=at>>1;Xe=be/at,$e=v;do{var oe,Ue;oe=de[ne]*de[ne],Ne+=oe,$e+=oe<Xe?oe:Xe,ne++,Ue=de[ne]*de[ne],Ne+=Ue,$e+=Ue<Xe?Ue:Xe,ne++}while(--pt>0);if(Ne>be&&le++,Se==l.SBPSY_s){var Ge=be*Z.nsPsy.shortfact[Se];$e<Ge&&($e=Ge)}if(Me!=0?Ae=$e:Ae=be,!Q.ATHonly&&!Q.ATHshort){var ze=W.en.s[Se][ke];if(ze>0){var Ge;Ge=Ne*W.thm.s[Se][ke]*qe/ze,Me!=0&&(Ge*=Z.nsPsy.shortfact[Se]),Ae<Ge&&(Ae=Ge)}}Me!=0?Y[ae++]=Ae:Y[ae++]=Ae*Z.nsPsy.shortfact[Se]}Q.useTemporal&&(Y[ae-3]>Y[ae-3+1]&&(Y[ae-3+1]+=(Y[ae-3]-Y[ae-3+1])*Z.decay),Y[ae-3+1]>Y[ae-3+2]&&(Y[ae-3+2]+=(Y[ae-3+1]-Y[ae-3+2])*Z.decay))}return le};function U(Q){this.s=Q}this.calc_noise_core=function(Q,W,q,Y){var ae=0,Z=W.s,K=Q.l3_enc;if(Z>Q.count1)for(;q--!=0;){var ne;ne=Q.xr[Z],Z++,ae+=ne*ne,ne=Q.xr[Z],Z++,ae+=ne*ne}else if(Z>Q.big_values){var le=s(2);for(le[0]=0,le[1]=Y;q--!=0;){var ne;ne=Math.abs(Q.xr[Z])-le[K[Z]],Z++,ae+=ne*ne,ne=Math.abs(Q.xr[Z])-le[K[Z]],Z++,ae+=ne*ne}}else for(;q--!=0;){var ne;ne=Math.abs(Q.xr[Z])-G[K[Z]]*Y,Z++,ae+=ne*ne,ne=Math.abs(Q.xr[Z])-G[K[Z]]*Y,Z++,ae+=ne*ne}return W.s=Z,ae},this.calc_noise=function(Q,W,q,Y,ae){var Z=0,K=0,ne,le,ce=0,de=0,Me=0,qe=-20,Ne=0,Ae=Q.scalefac,Xe=0;for(Y.over_SSD=0,ne=0;ne<Q.psymax;ne++){var $e=Q.global_gain-(Ae[Xe++]+(Q.preflag!=0?I[ne]:0)<<Q.scalefac_scale+1)-Q.subblock_gain[Q.window[ne]]*8,at=0;if(ae!=null&&ae.step[ne]==$e)at=ae.noise[ne],Ne+=Q.width[ne],q[Z++]=at/W[K++],at=ae.noise_log[ne];else{var pt=y($e);if(le=Q.width[ne]>>1,Ne+Q.width[ne]>Q.max_nonzero_coeff){var oe;oe=Q.max_nonzero_coeff-Ne+1,oe>0?le=oe>>1:le=0}var Ue=new U(Ne);at=this.calc_noise_core(Q,Ue,le,pt),Ne=Ue.s,ae!=null&&(ae.step[ne]=$e,ae.noise[ne]=at),at=q[Z++]=at/W[K++],at=i.FAST_LOG10(Math.max(at,1e-20)),ae!=null&&(ae.noise_log[ne]=at)}if(ae!=null&&(ae.global_gain=Q.global_gain),Me+=at,at>0){var Ge;Ge=Math.max(0|at*10+.5,1),Y.over_SSD+=Ge*Ge,ce++,de+=at}qe=Math.max(qe,at)}return Y.over_count=ce,Y.tot_noise=Me,Y.over_noise=de,Y.max_noise=qe,ce},this.set_pinfo=function(Q,W,q,Y,ae){var Z=Q.internal_flags,K,ne,le,ce,de,Me=W.scalefac_scale==0?.5:1,qe=W.scalefac,Ne=s(L3Side.SFBMAX),Ae=s(L3Side.SFBMAX),Xe=new CalcNoiseResult;calc_xmin(Q,q,W,Ne),calc_noise(W,Ne,Ae,Xe,null);var $e=0;for(ne=W.sfb_lmax,W.block_type!=l.SHORT_TYPE&&W.mixed_block_flag==0&&(ne=22),K=0;K<ne;K++){var at=Z.scalefac_band.l[K],pt=Z.scalefac_band.l[K+1],oe=pt-at;for(ce=0;$e<pt;$e++)ce+=W.xr[$e]*W.xr[$e];ce/=oe,de=1e15,Z.pinfo.en[Y][ae][K]=de*ce,Z.pinfo.xfsf[Y][ae][K]=de*Ne[K]*Ae[K]/oe,q.en.l[K]>0&&!Q.ATHonly?ce=ce/q.en.l[K]:ce=0,Z.pinfo.thr[Y][ae][K]=de*Math.max(ce*q.thm.l[K],Z.ATH.l[K]),Z.pinfo.LAMEsfb[Y][ae][K]=0,W.preflag!=0&&K>=11&&(Z.pinfo.LAMEsfb[Y][ae][K]=-Me*I[K]),K<l.SBPSY_l&&(o(qe[K]>=0),Z.pinfo.LAMEsfb[Y][ae][K]-=Me*qe[K])}if(W.block_type==l.SHORT_TYPE)for(ne=K,K=W.sfb_smin;K<l.SBMAX_s;K++)for(var at=Z.scalefac_band.s[K],pt=Z.scalefac_band.s[K+1],oe=pt-at,Ue=0;Ue<3;Ue++){for(ce=0,le=at;le<pt;le++)ce+=W.xr[$e]*W.xr[$e],$e++;ce=Math.max(ce/oe,1e-20),de=1e15,Z.pinfo.en_s[Y][ae][3*K+Ue]=de*ce,Z.pinfo.xfsf_s[Y][ae][3*K+Ue]=de*Ne[ne]*Ae[ne]/oe,q.en.s[K][Ue]>0?ce=ce/q.en.s[K][Ue]:ce=0,(Q.ATHonly||Q.ATHshort)&&(ce=0),Z.pinfo.thr_s[Y][ae][3*K+Ue]=de*Math.max(ce*q.thm.s[K][Ue],Z.ATH.s[K]),Z.pinfo.LAMEsfb_s[Y][ae][3*K+Ue]=-2*W.subblock_gain[Ue],K<l.SBPSY_s&&(Z.pinfo.LAMEsfb_s[Y][ae][3*K+Ue]-=Me*qe[ne]),ne++}Z.pinfo.LAMEqss[Y][ae]=W.global_gain,Z.pinfo.LAMEmainbits[Y][ae]=W.part2_3_length+W.part2_length,Z.pinfo.LAMEsfbits[Y][ae]=W.part2_length,Z.pinfo.over[Y][ae]=Xe.over_count,Z.pinfo.max_noise[Y][ae]=Xe.max_noise*10,Z.pinfo.over_noise[Y][ae]=Xe.over_noise*10,Z.pinfo.tot_noise[Y][ae]=Xe.tot_noise*10,Z.pinfo.over_SSD[Y][ae]=Xe.over_SSD}}return MF=f,MF}var OF,Yre;function iye(){if(Yre)return OF;Yre=1;var n=Rc,e=n.System,t=n.Arrays,r=n.new_int,i=n.assert,s=ap(),a=sG,o=nG,l=rye();function c(){var u=null;this.qupvt=null,this.setModules=function(Z){this.qupvt=Z,u=Z};function f(Z){this.bits=0|Z}var h=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function g(Z,K,ne,le,ce,de){var Me=.5946/K;for(Z=Z>>1;Z--!=0;)ce[de++]=Me>ne[le++]?0:1,ce[de++]=Me>ne[le++]?0:1}function p(Z,K,ne,le,ce,de){Z=Z>>1;var Me=Z%2;for(Z=Z>>1;Z--!=0;){var qe,Ne,Ae,Xe,$e,at,pt,oe;qe=ne[le++]*K,Ne=ne[le++]*K,$e=0|qe,Ae=ne[le++]*K,at=0|Ne,Xe=ne[le++]*K,pt=0|Ae,qe+=u.adj43[$e],oe=0|Xe,Ne+=u.adj43[at],ce[de++]=0|qe,Ae+=u.adj43[pt],ce[de++]=0|Ne,Xe+=u.adj43[oe],ce[de++]=0|Ae,ce[de++]=0|Xe}if(Me!=0){var qe,Ne,$e,at;qe=ne[le++]*K,Ne=ne[le++]*K,$e=0|qe,at=0|Ne,qe+=u.adj43[$e],Ne+=u.adj43[at],ce[de++]=0|qe,ce[de++]=0|Ne}}function _(Z,K,ne,le,ce){var de,Me,qe=0,Ne,Ae=0,Xe=0,$e=0,at=K,pt=0,oe=at,Ue=0,Ge=Z,ze=0;for(Ne=ce!=null&&le.global_gain==ce.global_gain,le.block_type==s.SHORT_TYPE?Me=38:Me=21,de=0;de<=Me;de++){var Be=-1;if((Ne||le.block_type==s.NORM_TYPE)&&(Be=le.global_gain-(le.scalefac[de]+(le.preflag!=0?u.pretab[de]:0)<<le.scalefac_scale+1)-le.subblock_gain[le.window[de]]*8),i(le.width[de]>=0),Ne&&ce.step[de]==Be)Ae!=0&&(p(Ae,ne,Ge,ze,oe,Ue),Ae=0),Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0);else{var me=le.width[de];if(qe+le.width[de]>le.max_nonzero_coeff){var Se;Se=le.max_nonzero_coeff-qe+1,t.fill(K,le.max_nonzero_coeff,576,0),me=Se,me<0&&(me=0),de=Me+1}if(Ae==0&&Xe==0&&(oe=at,Ue=pt,Ge=Z,ze=$e),ce!=null&&ce.sfb_count1>0&&de>=ce.sfb_count1&&ce.step[de]>0&&Be>=ce.step[de]?(Ae!=0&&(p(Ae,ne,Ge,ze,oe,Ue),Ae=0,oe=at,Ue=pt,Ge=Z,ze=$e),Xe+=me):(Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0,oe=at,Ue=pt,Ge=Z,ze=$e),Ae+=me),me<=0){Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0),Ae!=0&&(p(Ae,ne,Ge,ze,oe,Ue),Ae=0);break}}de<=Me&&(pt+=le.width[de],$e+=le.width[de],qe+=le.width[de])}Ae!=0&&(p(Ae,ne,Ge,ze,oe,Ue),Ae=0),Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0)}function y(Z,K,ne){var le=0,ce=0;do{var de=Z[K++],Me=Z[K++];le<de&&(le=de),ce<Me&&(ce=Me)}while(K<ne);return le<ce&&(le=ce),le}function v(Z,K,ne,le,ce,de){var Me=a.ht[le].xlen*65536+a.ht[ce].xlen,qe=0,Ne;do{var Ae=Z[K++],Xe=Z[K++];Ae!=0&&(Ae>14&&(Ae=15,qe+=Me),Ae*=16),Xe!=0&&(Xe>14&&(Xe=15,qe+=Me),Ae+=Xe),qe+=a.largetbl[Ae]}while(K<ne);return Ne=qe&65535,qe>>=16,qe>Ne&&(qe=Ne,le=ce),de.bits+=qe,le}function x(Z,K,ne,le){var ce=0,de=a.ht[1].hlen;do{var Me=Z[K+0]*2+Z[K+1];K+=2,ce+=de[Me]}while(K<ne);return le.bits+=ce,1}function E(Z,K,ne,le,ce){var de=0,Me,qe=a.ht[le].xlen,Ne;le==2?Ne=a.table23:Ne=a.table56;do{var Ae=Z[K+0]*qe+Z[K+1];K+=2,de+=Ne[Ae]}while(K<ne);return Me=de&65535,de>>=16,de>Me&&(de=Me,le++),ce.bits+=de,le}function M(Z,K,ne,le,ce){var de=0,Me=0,qe=0,Ne=a.ht[le].xlen,Ae=a.ht[le].hlen,Xe=a.ht[le+1].hlen,$e=a.ht[le+2].hlen;do{var at=Z[K+0]*Ne+Z[K+1];K+=2,de+=Ae[at],Me+=Xe[at],qe+=$e[at]}while(K<ne);var pt=le;return de>Me&&(de=Me,pt++),de>qe&&(de=qe,pt=le+2),ce.bits+=de,pt}var k=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function N(Z,K,ne,le){var ce=y(Z,K,ne);switch(ce){case 0:return ce;case 1:return x(Z,K,ne,le);case 2:case 3:return E(Z,K,ne,k[ce-1],le);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return M(Z,K,ne,k[ce-1],le);default:if(ce>l.IXMAX_VAL)return le.bits=l.LARGE_BITS,-1;ce-=15;var de;for(de=24;de<32&&!(a.ht[de].linmax>=ce);de++);var Me;for(Me=de-8;Me<24&&!(a.ht[Me].linmax>=ce);Me++);return v(Z,K,ne,Me,de,le)}}this.noquant_count_bits=function(Z,K,ne){var le=K.l3_enc,ce=Math.min(576,K.max_nonzero_coeff+2>>1<<1);for(ne!=null&&(ne.sfb_count1=0);ce>1&&!(le[ce-1]|le[ce-2]);ce-=2);K.count1=ce;for(var de=0,Me=0;ce>3;ce-=4){var qe;if(((le[ce-1]|le[ce-2]|le[ce-3]|le[ce-4])&2147483647)>1)break;qe=((le[ce-4]*2+le[ce-3])*2+le[ce-2])*2+le[ce-1],de+=a.t32l[qe],Me+=a.t33l[qe]}var Ne=de;if(K.count1table_select=0,de>Me&&(Ne=Me,K.count1table_select=1),K.count1bits=Ne,K.big_values=ce,ce==0)return Ne;if(K.block_type==s.SHORT_TYPE)de=3*Z.scalefac_band.s[3],de>K.big_values&&(de=K.big_values),Me=K.big_values;else if(K.block_type==s.NORM_TYPE){if(de=K.region0_count=Z.bv_scf[ce-2],Me=K.region1_count=Z.bv_scf[ce-1],i(de+Me+2<s.SBPSY_l),Me=Z.scalefac_band.l[de+Me+2],de=Z.scalefac_band.l[de+1],Me<ce){var Ae=new f(Ne);K.table_select[2]=N(le,Me,ce,Ae),Ne=Ae.bits}}else K.region0_count=7,K.region1_count=s.SBMAX_l-1-7-1,de=Z.scalefac_band.l[8],Me=ce,de>Me&&(de=Me);if(de=Math.min(de,ce),Me=Math.min(Me,ce),0<de){var Ae=new f(Ne);K.table_select[0]=N(le,0,de,Ae),Ne=Ae.bits}if(de<Me){var Ae=new f(Ne);K.table_select[1]=N(le,de,Me,Ae),Ne=Ae.bits}if(Z.use_best_huffman==2&&(K.part2_3_length=Ne,best_huffman_divide(Z,K),Ne=K.part2_3_length),ne!=null&&K.block_type==s.NORM_TYPE){for(var Xe=0;Z.scalefac_band.l[Xe]<K.big_values;)Xe++;ne.sfb_count1=Xe}return Ne},this.count_bits=function(Z,K,ne,le){var ce=ne.l3_enc,de=l.IXMAX_VAL/u.IPOW20(ne.global_gain);if(ne.xrpow_max>de)return l.LARGE_BITS;if(_(K,ce,u.IPOW20(ne.global_gain),ne,le),Z.substep_shaping&2)for(var Me=0,qe=ne.global_gain+ne.scalefac_scale,Ne=.634521682242439/u.IPOW20(qe),Ae=0;Ae<ne.sfbmax;Ae++){var Xe=ne.width[Ae];if(Z.pseudohalf[Ae]==0)Me+=Xe;else{var $e;for($e=Me,Me+=Xe;$e<Me;++$e)ce[$e]=K[$e]>=Ne?ce[$e]:0}}return this.noquant_count_bits(Z,ne,le)};function I(Z,K,ne,le,ce,de,Me){for(var qe=K.big_values,Ne=0;Ne<=22;Ne++)le[Ne]=l.LARGE_BITS;for(var Ne=0;Ne<16;Ne++){var Ae=Z.scalefac_band.l[Ne+1];if(Ae>=qe)break;var Xe=0,$e=new f(Xe),at=N(ne,0,Ae,$e);Xe=$e.bits;for(var pt=0;pt<8;pt++){var oe=Z.scalefac_band.l[Ne+pt+2];if(oe>=qe)break;var Ue=Xe;$e=new f(Ue);var Ge=N(ne,Ae,oe,$e);Ue=$e.bits,le[Ne+pt]>Ue&&(le[Ne+pt]=Ue,ce[Ne+pt]=Ne,de[Ne+pt]=at,Me[Ne+pt]=Ge)}}}function D(Z,K,ne,le,ce,de,Me,qe){for(var Ne=K.big_values,Ae=2;Ae<s.SBMAX_l+1;Ae++){var Xe=Z.scalefac_band.l[Ae];if(Xe>=Ne)break;var $e=ce[Ae-2]+K.count1bits;if(ne.part2_3_length<=$e)break;var at=new f($e),pt=N(le,Xe,Ne,at);$e=at.bits,!(ne.part2_3_length<=$e)&&(ne.assign(K),ne.part2_3_length=$e,ne.region0_count=de[Ae-2],ne.region1_count=Ae-2-de[Ae-2],ne.table_select[0]=Me[Ae-2],ne.table_select[1]=qe[Ae-2],ne.table_select[2]=pt)}}this.best_huffman_divide=function(Z,K){var ne=new o,le=K.l3_enc,ce=r(23),de=r(23),Me=r(23),qe=r(23);if(!(K.block_type==s.SHORT_TYPE&&Z.mode_gr==1)){ne.assign(K),K.block_type==s.NORM_TYPE&&(I(Z,K,le,ce,de,Me,qe),D(Z,ne,K,le,ce,de,Me,qe));var Ne=ne.big_values;if(!(Ne==0||(le[Ne-2]|le[Ne-1])>1)&&(Ne=K.count1+2,!(Ne>576))){ne.assign(K),ne.count1=Ne;for(var Ae=0,Xe=0;Ne>ne.big_values;Ne-=4){var $e=((le[Ne-4]*2+le[Ne-3])*2+le[Ne-2])*2+le[Ne-1];Ae+=a.t32l[$e],Xe+=a.t33l[$e]}if(ne.big_values=Ne,ne.count1table_select=0,Ae>Xe&&(Ae=Xe,ne.count1table_select=1),ne.count1bits=Ae,ne.block_type==s.NORM_TYPE)D(Z,ne,K,le,ce,de,Me,qe);else{if(ne.part2_3_length=Ae,Ae=Z.scalefac_band.l[8],Ae>Ne&&(Ae=Ne),Ae>0){var at=new f(ne.part2_3_length);ne.table_select[0]=N(le,0,Ae,at),ne.part2_3_length=at.bits}if(Ne>Ae){var at=new f(ne.part2_3_length);ne.table_select[1]=N(le,Ae,Ne,at),ne.part2_3_length=at.bits}K.part2_3_length>ne.part2_3_length&&K.assign(ne)}}}};var V=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],G=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],J=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],B=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];c.slen1_tab=J,c.slen2_tab=B;function $(Z,K){for(var ne,le=K.tt[1][Z],ce=K.tt[0][Z],de=0;de<a.scfsi_band.length-1;de++){for(ne=a.scfsi_band[de];ne<a.scfsi_band[de+1]&&!(ce.scalefac[ne]!=le.scalefac[ne]&&le.scalefac[ne]>=0);ne++);if(ne==a.scfsi_band[de+1]){for(ne=a.scfsi_band[de];ne<a.scfsi_band[de+1];ne++)le.scalefac[ne]=-1;K.scfsi[Z][de]=1}}var Me=0,qe=0;for(ne=0;ne<11;ne++)le.scalefac[ne]!=-1&&(qe++,Me<le.scalefac[ne]&&(Me=le.scalefac[ne]));for(var Ne=0,Ae=0;ne<s.SBPSY_l;ne++)le.scalefac[ne]!=-1&&(Ae++,Ne<le.scalefac[ne]&&(Ne=le.scalefac[ne]));for(var de=0;de<16;de++)if(Me<V[de]&&Ne<G[de]){var Xe=J[de]*qe+B[de]*Ae;le.part2_length>Xe&&(le.part2_length=Xe,le.scalefac_compress=de)}}this.best_scalefac_store=function(Z,K,ne,le){var ce=le.tt[K][ne],de,Me,qe,Ne,Ae=0;for(qe=0,de=0;de<ce.sfbmax;de++){var Xe=ce.width[de];for(qe+=Xe,Ne=-Xe;Ne<0&&ce.l3_enc[Ne+qe]==0;Ne++);Ne==0&&(ce.scalefac[de]=Ae=-2)}if(ce.scalefac_scale==0&&ce.preflag==0){var $e=0;for(de=0;de<ce.sfbmax;de++)ce.scalefac[de]>0&&($e|=ce.scalefac[de]);if(!($e&1)&&$e!=0){for(de=0;de<ce.sfbmax;de++)ce.scalefac[de]>0&&(ce.scalefac[de]>>=1);ce.scalefac_scale=Ae=1}}if(ce.preflag==0&&ce.block_type!=s.SHORT_TYPE&&Z.mode_gr==2){for(de=11;de<s.SBPSY_l&&!(ce.scalefac[de]<u.pretab[de]&&ce.scalefac[de]!=-2);de++);if(de==s.SBPSY_l){for(de=11;de<s.SBPSY_l;de++)ce.scalefac[de]>0&&(ce.scalefac[de]-=u.pretab[de]);ce.preflag=Ae=1}}for(Me=0;Me<4;Me++)le.scfsi[ne][Me]=0;for(Z.mode_gr==2&&K==1&&le.tt[0][ne].block_type!=s.SHORT_TYPE&&le.tt[1][ne].block_type!=s.SHORT_TYPE&&($(ne,le),Ae=0),de=0;de<ce.sfbmax;de++)ce.scalefac[de]==-2&&(ce.scalefac[de]=0);Ae!=0&&(Z.mode_gr==2?this.scale_bitcount(ce):this.scale_bitcount_lsf(Z,ce))};function U(Z,K){for(var ne=0;ne<K;++ne)if(Z[ne]<0)return!1;return!0}var Q=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],W=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],q=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(Z){var K,ne,le=0,ce=0,de,Me=Z.scalefac;if(i(U(Me,Z.sfbmax)),Z.block_type==s.SHORT_TYPE)de=Q,Z.mixed_block_flag!=0&&(de=W);else if(de=q,Z.preflag==0){for(ne=11;ne<s.SBPSY_l&&!(Me[ne]<u.pretab[ne]);ne++);if(ne==s.SBPSY_l)for(Z.preflag=1,ne=11;ne<s.SBPSY_l;ne++)Me[ne]-=u.pretab[ne]}for(ne=0;ne<Z.sfbdivide;ne++)le<Me[ne]&&(le=Me[ne]);for(;ne<Z.sfbmax;ne++)ce<Me[ne]&&(ce=Me[ne]);for(Z.part2_length=l.LARGE_BITS,K=0;K<16;K++)le<V[K]&&ce<G[K]&&Z.part2_length>de[K]&&(Z.part2_length=de[K],Z.scalefac_compress=K);return Z.part2_length==l.LARGE_BITS};var Y=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(Z,K){var ne,le,ce,de,Me,qe,Ne,Ae,Xe=r(4),$e=K.scalefac;for(K.preflag!=0?ne=2:ne=0,Ne=0;Ne<4;Ne++)Xe[Ne]=0;if(K.block_type==s.SHORT_TYPE){le=1;var at=u.nr_of_sfb_block[ne][le];for(Ae=0,ce=0;ce<4;ce++)for(de=at[ce]/3,Ne=0;Ne<de;Ne++,Ae++)for(Me=0;Me<3;Me++)$e[Ae*3+Me]>Xe[ce]&&(Xe[ce]=$e[Ae*3+Me])}else{le=0;var at=u.nr_of_sfb_block[ne][le];for(Ae=0,ce=0;ce<4;ce++)for(de=at[ce],Ne=0;Ne<de;Ne++,Ae++)$e[Ae]>Xe[ce]&&(Xe[ce]=$e[Ae])}for(qe=!1,ce=0;ce<4;ce++)Xe[ce]>Y[ne][ce]&&(qe=!0);if(!qe){var pt,oe,Ue,Ge;for(K.sfb_partition_table=u.nr_of_sfb_block[ne][le],ce=0;ce<4;ce++)K.slen[ce]=ae[Xe[ce]];switch(pt=K.slen[0],oe=K.slen[1],Ue=K.slen[2],Ge=K.slen[3],ne){case 0:K.scalefac_compress=(pt*5+oe<<4)+(Ue<<2)+Ge;break;case 1:K.scalefac_compress=400+(pt*5+oe<<2)+Ue;break;case 2:K.scalefac_compress=500+pt*3+oe;break;default:e.err.printf(`intensity stereo not implemented yet
`);break}}if(!qe)for(i(K.sfb_partition_table!=null),K.part2_length=0,ce=0;ce<4;ce++)K.part2_length+=K.slen[ce]*K.sfb_partition_table[ce];return qe};var ae=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(Z){for(var K=2;K<=576;K+=2){for(var ne=0,le;Z.scalefac_band.l[++ne]<K;);for(le=h[ne][0];Z.scalefac_band.l[le+1]>K;)le--;for(le<0&&(le=h[ne][0]),Z.bv_scf[K-2]=le,le=h[ne][1];Z.scalefac_band.l[le+Z.bv_scf[K-2]+2]>K;)le--;le<0&&(le=h[ne][1]),Z.bv_scf[K-1]=le}}}return OF=c,OF}var kF,Xre;function aG(){if(Xre)return kF;Xre=1;var n=Rc,e=n.System,t=n.Arrays,r=n.new_byte,i=n.new_float_n,s=n.new_int,a=n.assert,o=iye(),l=sG,c=ap(),u=M6;f.EQ=function(h,g){return Math.abs(h)>Math.abs(g)?Math.abs(h-g)<=Math.abs(h)*1e-6:Math.abs(h-g)<=Math.abs(g)*1e-6},f.NEQ=function(h,g){return!f.EQ(h,g)};function f(){var h=oG(),g=this,p=32773,_=null,y=null,v=null,x=null;this.setModules=function(K,ne,le,ce){_=K,y=ne,v=le,x=ce};var E=null,M=0,k=0,N=0;this.getframebits=function(K){var ne=K.internal_flags,le;ne.bitrate_index!=0?le=l.bitrate_table[K.version][ne.bitrate_index]:le=K.brate;var ce=0|(K.version+1)*72e3*le/K.out_samplerate+ne.padding;return 8*ce};function I(K){e.arraycopy(K.header[K.w_ptr].buf,0,E,k,K.sideinfo_len),k+=K.sideinfo_len,M+=K.sideinfo_len*8,K.w_ptr=K.w_ptr+1&u.MAX_HEADER_BUF-1}function D(K,ne,le){for(;le>0;){var ce;N==0&&(N=8,k++,a(k<h.LAME_MAXMP3BUFFER),a(K.header[K.w_ptr].write_timing>=M),K.header[K.w_ptr].write_timing==M&&I(K),E[k]=0),ce=Math.min(le,N),le-=ce,N-=ce,E[k]|=ne>>le<<N,M+=ce}}function V(K,ne,le){for(;le>0;){var ce;N==0&&(N=8,k++,a(k<h.LAME_MAXMP3BUFFER),E[k]=0),ce=Math.min(le,N),le-=ce,N-=ce,E[k]|=ne>>le<<N,M+=ce}}function G(K,ne){var le=K.internal_flags,ce;if(ne>=8&&(D(le,76,8),ne-=8),ne>=8&&(D(le,65,8),ne-=8),ne>=8&&(D(le,77,8),ne-=8),ne>=8&&(D(le,69,8),ne-=8),ne>=32){var de=v.getLameShortVersion();if(ne>=32)for(ce=0;ce<de.length&&ne>=8;++ce)ne-=8,D(le,de.charAt(ce),8)}for(;ne>=1;ne-=1)D(le,le.ancillary_flag,1),le.ancillary_flag^=K.disable_reservoir?0:1}function J(K,ne,le){for(var ce=K.header[K.h_ptr].ptr;le>0;){var de=Math.min(le,8-(ce&7));le-=de,K.header[K.h_ptr].buf[ce>>3]|=ne>>le<<8-(ce&7)-de,ce+=de}K.header[K.h_ptr].ptr=ce}function B(K,ne){K<<=8;for(var le=0;le<8;le++)K<<=1,ne<<=1,(ne^K)&65536&&(ne^=p);return ne}this.CRC_writeheader=function(K,ne){var le=65535;le=B(ne[2]&255,le),le=B(ne[3]&255,le);for(var ce=6;ce<K.sideinfo_len;ce++)le=B(ne[ce]&255,le);ne[4]=byte(le>>8),ne[5]=byte(le&255)};function $(K,ne){var le=K.internal_flags,ce,de,Me;if(ce=le.l3_side,le.header[le.h_ptr].ptr=0,t.fill(le.header[le.h_ptr].buf,0,le.sideinfo_len,0),K.out_samplerate<16e3?J(le,4094,12):J(le,4095,12),J(le,K.version,1),J(le,1,2),J(le,K.error_protection?0:1,1),J(le,le.bitrate_index,4),J(le,le.samplerate_index,2),J(le,le.padding,1),J(le,K.extension,1),J(le,K.mode.ordinal(),2),J(le,le.mode_ext,2),J(le,K.copyright,1),J(le,K.original,1),J(le,K.emphasis,2),K.error_protection&&J(le,0,16),K.version==1){for(a(ce.main_data_begin>=0),J(le,ce.main_data_begin,9),le.channels_out==2?J(le,ce.private_bits,3):J(le,ce.private_bits,5),Me=0;Me<le.channels_out;Me++){var qe;for(qe=0;qe<4;qe++)J(le,ce.scfsi[Me][qe],1)}for(de=0;de<2;de++)for(Me=0;Me<le.channels_out;Me++){var Ne=ce.tt[de][Me];J(le,Ne.part2_3_length+Ne.part2_length,12),J(le,Ne.big_values/2,9),J(le,Ne.global_gain,8),J(le,Ne.scalefac_compress,4),Ne.block_type!=c.NORM_TYPE?(J(le,1,1),J(le,Ne.block_type,2),J(le,Ne.mixed_block_flag,1),Ne.table_select[0]==14&&(Ne.table_select[0]=16),J(le,Ne.table_select[0],5),Ne.table_select[1]==14&&(Ne.table_select[1]=16),J(le,Ne.table_select[1],5),J(le,Ne.subblock_gain[0],3),J(le,Ne.subblock_gain[1],3),J(le,Ne.subblock_gain[2],3)):(J(le,0,1),Ne.table_select[0]==14&&(Ne.table_select[0]=16),J(le,Ne.table_select[0],5),Ne.table_select[1]==14&&(Ne.table_select[1]=16),J(le,Ne.table_select[1],5),Ne.table_select[2]==14&&(Ne.table_select[2]=16),J(le,Ne.table_select[2],5),a(0<=Ne.region0_count&&Ne.region0_count<16),a(0<=Ne.region1_count&&Ne.region1_count<8),J(le,Ne.region0_count,4),J(le,Ne.region1_count,3)),J(le,Ne.preflag,1),J(le,Ne.scalefac_scale,1),J(le,Ne.count1table_select,1)}}else for(a(ce.main_data_begin>=0),J(le,ce.main_data_begin,8),J(le,ce.private_bits,le.channels_out),de=0,Me=0;Me<le.channels_out;Me++){var Ne=ce.tt[de][Me];J(le,Ne.part2_3_length+Ne.part2_length,12),J(le,Ne.big_values/2,9),J(le,Ne.global_gain,8),J(le,Ne.scalefac_compress,9),Ne.block_type!=c.NORM_TYPE?(J(le,1,1),J(le,Ne.block_type,2),J(le,Ne.mixed_block_flag,1),Ne.table_select[0]==14&&(Ne.table_select[0]=16),J(le,Ne.table_select[0],5),Ne.table_select[1]==14&&(Ne.table_select[1]=16),J(le,Ne.table_select[1],5),J(le,Ne.subblock_gain[0],3),J(le,Ne.subblock_gain[1],3),J(le,Ne.subblock_gain[2],3)):(J(le,0,1),Ne.table_select[0]==14&&(Ne.table_select[0]=16),J(le,Ne.table_select[0],5),Ne.table_select[1]==14&&(Ne.table_select[1]=16),J(le,Ne.table_select[1],5),Ne.table_select[2]==14&&(Ne.table_select[2]=16),J(le,Ne.table_select[2],5),a(0<=Ne.region0_count&&Ne.region0_count<16),a(0<=Ne.region1_count&&Ne.region1_count<8),J(le,Ne.region0_count,4),J(le,Ne.region1_count,3)),J(le,Ne.scalefac_scale,1),J(le,Ne.count1table_select,1)}K.error_protection&&CRC_writeheader(le,le.header[le.h_ptr].buf);{var Ae=le.h_ptr;a(le.header[Ae].ptr==le.sideinfo_len*8),le.h_ptr=Ae+1&u.MAX_HEADER_BUF-1,le.header[le.h_ptr].write_timing=le.header[Ae].write_timing+ne,le.h_ptr==le.w_ptr&&e.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function U(K,ne){var le=l.ht[ne.count1table_select+32],ce,de=0,Me=ne.big_values,qe=ne.big_values;for(a(ne.count1table_select<2),ce=(ne.count1-ne.big_values)/4;ce>0;--ce){var Ne=0,Ae=0,Xe;Xe=ne.l3_enc[Me+0],Xe!=0&&(Ae+=8,ne.xr[qe+0]<0&&Ne++),Xe=ne.l3_enc[Me+1],Xe!=0&&(Ae+=4,Ne*=2,ne.xr[qe+1]<0&&Ne++),Xe=ne.l3_enc[Me+2],Xe!=0&&(Ae+=2,Ne*=2,ne.xr[qe+2]<0&&Ne++),Xe=ne.l3_enc[Me+3],Xe!=0&&(Ae++,Ne*=2,ne.xr[qe+3]<0&&Ne++),Me+=4,qe+=4,D(K,Ne+le.table[Ae],le.hlen[Ae]),de+=le.hlen[Ae]}return de}function Q(K,ne,le,ce,de){var Me=l.ht[ne],qe=0;if(ne==0)return qe;for(var Ne=le;Ne<ce;Ne+=2){var Ae=0,Xe=0,$e=Me.xlen,at=Me.xlen,pt=0,oe=de.l3_enc[Ne],Ue=de.l3_enc[Ne+1];if(oe!=0&&(de.xr[Ne]<0&&pt++,Ae--),ne>15){if(oe>14){var Ge=oe-15;a(Ge<=Me.linmax),pt|=Ge<<1,Xe=$e,oe=15}if(Ue>14){var ze=Ue-15;a(ze<=Me.linmax),pt<<=$e,pt|=ze,Xe+=$e,Ue=15}at=16}Ue!=0&&(pt<<=1,de.xr[Ne+1]<0&&pt++,Ae--),oe=oe*at+Ue,Xe-=Ae,Ae+=Me.hlen[oe],D(K,Me.table[oe],Ae),D(K,pt,Xe),qe+=Ae+Xe}return qe}function W(K,ne){var le=3*K.scalefac_band.s[3];le>ne.big_values&&(le=ne.big_values);var ce=Q(K,ne.table_select[0],0,le,ne);return ce+=Q(K,ne.table_select[1],le,ne.big_values,ne),ce}function q(K,ne){var le,ce,de,Me;le=ne.big_values;var qe=ne.region0_count+1;return a(qe<K.scalefac_band.l.length),de=K.scalefac_band.l[qe],qe+=ne.region1_count+1,a(qe<K.scalefac_band.l.length),Me=K.scalefac_band.l[qe],de>le&&(de=le),Me>le&&(Me=le),ce=Q(K,ne.table_select[0],0,de,ne),ce+=Q(K,ne.table_select[1],de,Me,ne),ce+=Q(K,ne.table_select[2],Me,le,ne),ce}function Y(K){var ne,le,ce,de,Me=0,qe=K.internal_flags,Ne=qe.l3_side;if(K.version==1)for(ne=0;ne<2;ne++)for(le=0;le<qe.channels_out;le++){var Ae=Ne.tt[ne][le],Xe=o.slen1_tab[Ae.scalefac_compress],$e=o.slen2_tab[Ae.scalefac_compress];for(de=0,ce=0;ce<Ae.sfbdivide;ce++)Ae.scalefac[ce]!=-1&&(D(qe,Ae.scalefac[ce],Xe),de+=Xe);for(;ce<Ae.sfbmax;ce++)Ae.scalefac[ce]!=-1&&(D(qe,Ae.scalefac[ce],$e),de+=$e);a(de==Ae.part2_length),Ae.block_type==c.SHORT_TYPE?de+=W(qe,Ae):de+=q(qe,Ae),de+=U(qe,Ae),a(de==Ae.part2_3_length+Ae.part2_length),Me+=de}else for(ne=0,le=0;le<qe.channels_out;le++){var Ae=Ne.tt[ne][le],at,pt,oe=0;if(a(Ae.sfb_partition_table!=null),de=0,ce=0,pt=0,Ae.block_type==c.SHORT_TYPE){for(;pt<4;pt++){var Ue=Ae.sfb_partition_table[pt]/3,Ge=Ae.slen[pt];for(at=0;at<Ue;at++,ce++)D(qe,Math.max(Ae.scalefac[ce*3+0],0),Ge),D(qe,Math.max(Ae.scalefac[ce*3+1],0),Ge),D(qe,Math.max(Ae.scalefac[ce*3+2],0),Ge),oe+=3*Ge}de+=W(qe,Ae)}else{for(;pt<4;pt++){var Ue=Ae.sfb_partition_table[pt],Ge=Ae.slen[pt];for(at=0;at<Ue;at++,ce++)D(qe,Math.max(Ae.scalefac[ce],0),Ge),oe+=Ge}de+=q(qe,Ae)}de+=U(qe,Ae),a(de==Ae.part2_3_length),a(oe==Ae.part2_length),Me+=oe+de}return Me}function ae(){this.total=0}function Z(K,ne){var le=K.internal_flags,ce,de,Me,qe,Ne;return Ne=le.w_ptr,qe=le.h_ptr-1,qe==-1&&(qe=u.MAX_HEADER_BUF-1),ce=le.header[qe].write_timing-M,ne.total=ce,ce>=0&&(de=1+qe-Ne,qe<Ne&&(de=1+qe-Ne+u.MAX_HEADER_BUF),ce-=de*8*le.sideinfo_len),Me=g.getframebits(K),ce+=Me,ne.total+=Me,ne.total%8!=0?ne.total=1+ne.total/8:ne.total=ne.total/8,ne.total+=k+1,ce<0&&e.err.println(`strange error flushing buffer ... 
`),ce}this.flush_bitstream=function(K){var ne=K.internal_flags,le,ce,de=ne.h_ptr-1;if(de==-1&&(de=u.MAX_HEADER_BUF-1),le=ne.l3_side,!((ce=Z(K,new ae))<0)){if(G(K,ce),a(ne.header[de].write_timing+this.getframebits(K)==M),ne.ResvSize=0,le.main_data_begin=0,ne.findReplayGain){var Me=_.GetTitleGain(ne.rgdata);a(NEQ(Me,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),ne.RadioGain=Math.floor(Me*10+.5)|0}ne.findPeakSample&&(ne.noclipGainChange=Math.ceil(Math.log10(ne.PeakSample/32767)*20*10)|0,ne.noclipGainChange>0&&(EQ(K.scale,1)||EQ(K.scale,0))?ne.noclipScale=Math.floor(32767/ne.PeakSample*100)/100:ne.noclipScale=-1)}},this.add_dummy_byte=function(K,ne,le){for(var ce=K.internal_flags,de;le-- >0;)for(V(ce,ne,8),de=0;de<u.MAX_HEADER_BUF;++de)ce.header[de].write_timing+=8},this.format_bitstream=function(K){var ne=K.internal_flags,le;le=ne.l3_side;var ce=this.getframebits(K);G(K,le.resvDrain_pre),$(K,ce);var de=8*ne.sideinfo_len;if(de+=Y(K),G(K,le.resvDrain_post),de+=le.resvDrain_post,le.main_data_begin+=(ce-de)/8,Z(K,new ae)!=ne.ResvSize&&e.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),le.main_data_begin*8!=ne.ResvSize&&(e.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*le.main_data_begin,ne.ResvSize,le.resvDrain_post,le.resvDrain_pre,8*ne.sideinfo_len,de-le.resvDrain_post-8*ne.sideinfo_len,de,de%8,ce),e.err.println("This is a fatal error.  It has several possible causes:"),e.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),e.err.println(" 9%%  Your system is overclocked"),e.err.println(" 1%%  bug in LAME encoding library"),ne.ResvSize=le.main_data_begin*8),M>1e9){var Me;for(Me=0;Me<u.MAX_HEADER_BUF;++Me)ne.header[Me].write_timing-=M;M=0}return 0},this.copy_buffer=function(K,ne,le,ce,de){var Me=k+1;if(Me<=0)return 0;if(ce!=0&&Me>ce)return-1;if(e.arraycopy(E,0,ne,le,Me),k=-1,N=0,de!=0){var qe=s(1);if(qe[0]=K.nMusicCRC,x.updateMusicCRC(qe,ne,le,Me),K.nMusicCRC=qe[0],Me>0&&(K.VBR_seek_table.nBytesWritten+=Me),K.decode_on_the_fly){for(var Ne=i([2,1152]),Ae=Me,Xe=-1,$e;Xe!=0;)if(Xe=y.hip_decode1_unclipped(K.hip,ne,le,Ae,Ne[0],Ne[1]),Ae=0,Xe==-1&&(Xe=0),Xe>0){if(K.findPeakSample){for($e=0;$e<Xe;$e++)Ne[0][$e]>K.PeakSample?K.PeakSample=Ne[0][$e]:-Ne[0][$e]>K.PeakSample&&(K.PeakSample=-Ne[0][$e]);if(K.channels_out>1)for($e=0;$e<Xe;$e++)Ne[1][$e]>K.PeakSample?K.PeakSample=Ne[1][$e]:-Ne[1][$e]>K.PeakSample&&(K.PeakSample=-Ne[1][$e])}if(K.findReplayGain&&_.AnalyzeSamples(K.rgdata,Ne[0],0,Ne[1],0,Xe,K.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return Me},this.init_bit_stream_w=function(K){E=r(h.LAME_MAXMP3BUFFER),K.h_ptr=K.w_ptr=0,K.header[K.h_ptr].write_timing=0,k=-1,N=0,M=0}}return kF=f,kF}var IF,Kre;function oG(){if(Kre)return IF;Kre=1;var n=Rc,e=n.System,t=n.VbrMode,r=n.ShortBlock,i=n.new_float,s=n.new_int_n,a=n.new_short_n,o=n.assert,l=Sct,c=Tct,u=M6,f=Yct,h=Kct,g=rut,p=aG(),_=sG,y=ap();function v(){var x=v3,E=this,M=128*1024;v.V9=410,v.V8=420,v.V7=430,v.V6=440,v.V5=450,v.V4=460,v.V3=470,v.V2=480,v.V1=490,v.V0=500,v.R3MIX=1e3,v.STANDARD=1001,v.EXTREME=1002,v.INSANE=1003,v.STANDARD_FAST=1004,v.EXTREME_FAST=1005,v.MEDIUM=1006,v.MEDIUM_FAST=1007;var k=16384+M;v.LAME_MAXMP3BUFFER=k;var N,I,D,V,G,J=new l,B,$,U;this.enc=new y,this.setModules=function(me,Se,ke,be,Ke,ot,lt,ct,Vt){N=me,I=Se,D=ke,V=be,G=Ke,B=ot,$=ct,U=Vt,this.enc.setModules(I,J,V,B)};function Q(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=i(y.SBMAX_l),this.bo_s_weight=i(y.SBMAX_s)}function W(){this.lowerlimit=0}function q(me,Se){this.lowpass=Se}var Y=4294479419;function ae(me){var Se;return me.class_id=Y,Se=me.internal_flags=new u,me.mode=x.NOT_SET,me.original=1,me.in_samplerate=44100,me.num_channels=2,me.num_samples=-1,me.bWriteVbrTag=!0,me.quality=-1,me.short_blocks=null,Se.subblock_gain=-1,me.lowpassfreq=0,me.highpassfreq=0,me.lowpasswidth=-1,me.highpasswidth=-1,me.VBR=t.vbr_off,me.VBR_q=4,me.ATHcurve=-1,me.VBR_mean_bitrate_kbps=128,me.VBR_min_bitrate_kbps=0,me.VBR_max_bitrate_kbps=0,me.VBR_hard_min=0,Se.VBR_min_bitrate=1,Se.VBR_max_bitrate=13,me.quant_comp=-1,me.quant_comp_short=-1,me.msfix=-1,Se.resample_ratio=1,Se.OldValue[0]=180,Se.OldValue[1]=180,Se.CurrentStep[0]=4,Se.CurrentStep[1]=4,Se.masking_lower=1,Se.nsPsy.attackthre=-1,Se.nsPsy.attackthre_s=-1,me.scale=-1,me.athaa_type=-1,me.ATHtype=-1,me.athaa_loudapprox=-1,me.athaa_sensitivity=0,me.useTemporal=null,me.interChRatio=-1,Se.mf_samples_to_encode=y.ENCDELAY+y.POSTDELAY,me.encoder_padding=0,Se.mf_size=y.ENCDELAY-y.MDCTDELAY,me.findReplayGain=!1,me.decode_on_the_fly=!1,Se.decode_on_the_fly=!1,Se.findReplayGain=!1,Se.findPeakSample=!1,Se.RadioGain=0,Se.AudiophileGain=0,Se.noclipGainChange=0,Se.noclipScale=-1,me.preset=0,me.write_id3tag_automatic=!0,0}this.lame_init=function(){var me=new c;return ae(me),me.lame_allocated_gfp=1,me};function Z(me){return me>1?0:me<=0?1:Math.cos(Math.PI/2*me)}this.nearestBitrateFullIndex=function(me){var Se=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],ke=0,be=0,Ke=0,ot=0;ot=Se[16],Ke=16,be=Se[16],ke=16;for(var lt=0;lt<16;lt++)if(Math.max(me,Se[lt+1])!=me){ot=Se[lt+1],Ke=lt+1,be=Se[lt],ke=lt;break}return ot-me>me-be?ke:Ke};function K(me,Se){var ke=44100;return Se>=48e3?ke=48e3:Se>=44100?ke=44100:Se>=32e3?ke=32e3:Se>=24e3?ke=24e3:Se>=22050?ke=22050:Se>=16e3?ke=16e3:Se>=12e3?ke=12e3:Se>=11025?ke=11025:Se>=8e3&&(ke=8e3),me==-1?ke:(me<=15960&&(ke=44100),me<=15250&&(ke=32e3),me<=11220&&(ke=24e3),me<=9970&&(ke=22050),me<=7230&&(ke=16e3),me<=5420&&(ke=12e3),me<=4510&&(ke=11025),me<=3970&&(ke=8e3),Se<ke?Se>44100?48e3:Se>32e3?44100:Se>24e3?32e3:Se>22050?24e3:Se>16e3?22050:Se>12e3?16e3:Se>11025?12e3:Se>8e3?11025:8e3:ke)}function ne(me,Se){switch(me){case 44100:return Se.version=1,0;case 48e3:return Se.version=1,1;case 32e3:return Se.version=1,2;case 22050:return Se.version=0,0;case 24e3:return Se.version=0,1;case 16e3:return Se.version=0,2;case 11025:return Se.version=0,0;case 12e3:return Se.version=0,1;case 8e3:return Se.version=0,2;default:return Se.version=0,-1}}function le(me,Se,ke){ke<16e3&&(Se=2);for(var be=_.bitrate_table[Se][1],Ke=2;Ke<=14;Ke++)_.bitrate_table[Se][Ke]>0&&Math.abs(_.bitrate_table[Se][Ke]-me)<Math.abs(be-me)&&(be=_.bitrate_table[Se][Ke]);return be}function ce(me,Se,ke){ke<16e3&&(Se=2);for(var be=0;be<=14;be++)if(_.bitrate_table[Se][be]>0&&_.bitrate_table[Se][be]==me)return be;return-1}function de(me,Se){var ke=[new q(8,2e3),new q(16,3700),new q(24,3900),new q(32,5500),new q(40,7e3),new q(48,7500),new q(56,1e4),new q(64,11e3),new q(80,13500),new q(96,15100),new q(112,15600),new q(128,17e3),new q(160,17500),new q(192,18600),new q(224,19400),new q(256,19700),new q(320,20500)],be=E.nearestBitrateFullIndex(Se);me.lowerlimit=ke[be].lowpass}function Me(me){var Se=me.internal_flags,ke=32,be=-1;if(Se.lowpass1>0){for(var Ke=999,ot=0;ot<=31;ot++){var lt=ot/31;lt>=Se.lowpass2&&(ke=Math.min(ke,ot)),Se.lowpass1<lt&&lt<Se.lowpass2&&(Ke=Math.min(Ke,ot))}Ke==999?Se.lowpass1=(ke-.75)/31:Se.lowpass1=(Ke-.75)/31,Se.lowpass2=ke/31}if(Se.highpass2>0&&Se.highpass2<.9*(.75/31)&&(Se.highpass1=0,Se.highpass2=0,e.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),Se.highpass2>0){for(var ct=-1,ot=0;ot<=31;ot++){var lt=ot/31;lt<=Se.highpass1&&(be=Math.max(be,ot)),Se.highpass1<lt&&lt<Se.highpass2&&(ct=Math.max(ct,ot))}Se.highpass1=be/31,ct==-1?Se.highpass2=(be+.75)/31:Se.highpass2=(ct+.75)/31}for(var ot=0;ot<32;ot++){var Vt,Ot,lt=ot/31;Se.highpass2>Se.highpass1?Vt=Z((Se.highpass2-lt)/(Se.highpass2-Se.highpass1+1e-20)):Vt=1,Se.lowpass2>Se.lowpass1?Ot=Z((lt-Se.lowpass1)/(Se.lowpass2-Se.lowpass1+1e-20)):Ot=1,Se.amp_filter[ot]=Vt*Ot}}function qe(me){var Se=me.internal_flags;switch(me.quality){default:case 9:Se.psymodel=0,Se.noise_shaping=0,Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 8:me.quality=7;case 7:Se.psymodel=1,Se.noise_shaping=0,Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 6:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 5:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 4:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 3:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=1,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 2:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=1,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 1:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=2,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 0:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=2,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break}}function Ne(me){var Se=me.internal_flags;me.frameNum=0,me.write_id3tag_automatic&&$.id3tag_write_v2(me),Se.bitrate_stereoMode_Hist=s([16,5]),Se.bitrate_blockType_Hist=s([16,6]),Se.PeakSample=0,me.bWriteVbrTag&&B.InitVbrTag(me)}this.lame_init_params=function(me){var Se=me.internal_flags;if(Se.Class_ID=0,Se.ATH==null&&(Se.ATH=new f),Se.PSY==null&&(Se.PSY=new Q),Se.rgdata==null&&(Se.rgdata=new h),Se.channels_in=me.num_channels,Se.channels_in==1&&(me.mode=x.MONO),Se.channels_out=me.mode==x.MONO?1:2,Se.mode_ext=y.MPG_MD_MS_LR,me.mode==x.MONO&&(me.force_ms=!1),me.VBR==t.vbr_off&&me.VBR_mean_bitrate_kbps!=128&&me.brate==0&&(me.brate=me.VBR_mean_bitrate_kbps),me.VBR==t.vbr_off||me.VBR==t.vbr_mtrh||me.VBR==t.vbr_mt||(me.free_format=!1),me.VBR==t.vbr_off&&me.brate==0&&p.EQ(me.compression_ratio,0)&&(me.compression_ratio=11.025),me.VBR==t.vbr_off&&me.compression_ratio>0&&(me.out_samplerate==0&&(me.out_samplerate=map2MP3Frequency(int(.97*me.in_samplerate))),me.brate=0|me.out_samplerate*16*Se.channels_out/(1e3*me.compression_ratio),Se.samplerate_index=ne(me.out_samplerate,me),me.free_format||(me.brate=le(me.brate,me.version,me.out_samplerate))),me.out_samplerate!=0&&(me.out_samplerate<16e3?(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,8),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,64)):me.out_samplerate<32e3?(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,8),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,160)):(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,32),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,320))),me.lowpassfreq==0){var ke=16e3;switch(me.VBR){case t.vbr_off:{var be=new W;de(be,me.brate),ke=be.lowerlimit;break}case t.vbr_abr:{var be=new W;de(be,me.VBR_mean_bitrate_kbps),ke=be.lowerlimit;break}case t.vbr_rh:{var Ke=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=me.VBR_q&&me.VBR_q<=9){var ot=Ke[me.VBR_q],lt=Ke[me.VBR_q+1],ct=me.VBR_q_frac;ke=linear_int(ot,lt,ct)}else ke=19500;break}default:{var Ke=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=me.VBR_q&&me.VBR_q<=9){var ot=Ke[me.VBR_q],lt=Ke[me.VBR_q+1],ct=me.VBR_q_frac;ke=linear_int(ot,lt,ct)}else ke=19500}}me.mode==x.MONO&&(me.VBR==t.vbr_off||me.VBR==t.vbr_abr)&&(ke*=1.5),me.lowpassfreq=ke|0}if(me.out_samplerate==0&&(2*me.lowpassfreq>me.in_samplerate&&(me.lowpassfreq=me.in_samplerate/2),me.out_samplerate=K(me.lowpassfreq|0,me.in_samplerate)),me.lowpassfreq=Math.min(20500,me.lowpassfreq),me.lowpassfreq=Math.min(me.out_samplerate/2,me.lowpassfreq),me.VBR==t.vbr_off&&(me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.brate)),me.VBR==t.vbr_abr&&(me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.VBR_mean_bitrate_kbps)),me.bWriteVbrTag||(me.findReplayGain=!1,me.decode_on_the_fly=!1,Se.findPeakSample=!1),Se.findReplayGain=me.findReplayGain,Se.decode_on_the_fly=me.decode_on_the_fly,Se.decode_on_the_fly&&(Se.findPeakSample=!0),Se.findReplayGain&&N.InitGainAnalysis(Se.rgdata,me.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return me.internal_flags=null,-6;switch(Se.decode_on_the_fly&&!me.decode_only&&(Se.hip!=null&&U.hip_decode_exit(Se.hip),Se.hip=U.hip_decode_init()),Se.mode_gr=me.out_samplerate<=24e3?1:2,me.framesize=576*Se.mode_gr,me.encoder_delay=y.ENCDELAY,Se.resample_ratio=me.in_samplerate/me.out_samplerate,me.VBR){case t.vbr_mt:case t.vbr_rh:case t.vbr_mtrh:{var Vt=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];me.compression_ratio=Vt[me.VBR_q]}break;case t.vbr_abr:me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.VBR_mean_bitrate_kbps);break;default:me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.brate);break}if(me.mode==x.NOT_SET&&(me.mode=x.JOINT_STEREO),me.highpassfreq>0?(Se.highpass1=2*me.highpassfreq,me.highpasswidth>=0?Se.highpass2=2*(me.highpassfreq+me.highpasswidth):Se.highpass2=2*me.highpassfreq,Se.highpass1/=me.out_samplerate,Se.highpass2/=me.out_samplerate):(Se.highpass1=0,Se.highpass2=0),me.lowpassfreq>0?(Se.lowpass2=2*me.lowpassfreq,me.lowpasswidth>=0?(Se.lowpass1=2*(me.lowpassfreq-me.lowpasswidth),Se.lowpass1<0&&(Se.lowpass1=0)):Se.lowpass1=2*me.lowpassfreq,Se.lowpass1/=me.out_samplerate,Se.lowpass2/=me.out_samplerate):(Se.lowpass1=0,Se.lowpass2=0),Me(me),Se.samplerate_index=ne(me.out_samplerate,me),Se.samplerate_index<0)return me.internal_flags=null,-1;if(me.VBR==t.vbr_off){if(me.free_format)Se.bitrate_index=0;else if(me.brate=le(me.brate,me.version,me.out_samplerate),Se.bitrate_index=ce(me.brate,me.version,me.out_samplerate),Se.bitrate_index<=0)return me.internal_flags=null,-1}else Se.bitrate_index=1;me.analysis&&(me.bWriteVbrTag=!1),Se.pinfo!=null&&(me.bWriteVbrTag=!1),I.init_bit_stream_w(Se);for(var Ot=Se.samplerate_index+3*me.version+6*(me.out_samplerate<16e3?1:0),Ut=0;Ut<y.SBMAX_l+1;Ut++)Se.scalefac_band.l[Ut]=V.sfBandIndex[Ot].l[Ut];for(var Ut=0;Ut<y.PSFB21+1;Ut++){var je=(Se.scalefac_band.l[22]-Se.scalefac_band.l[21])/y.PSFB21,ge=Se.scalefac_band.l[21]+Ut*je;Se.scalefac_band.psfb21[Ut]=ge}Se.scalefac_band.psfb21[y.PSFB21]=576;for(var Ut=0;Ut<y.SBMAX_s+1;Ut++)Se.scalefac_band.s[Ut]=V.sfBandIndex[Ot].s[Ut];for(var Ut=0;Ut<y.PSFB12+1;Ut++){var je=(Se.scalefac_band.s[13]-Se.scalefac_band.s[12])/y.PSFB12,ge=Se.scalefac_band.s[12]+Ut*je;Se.scalefac_band.psfb12[Ut]=ge}Se.scalefac_band.psfb12[y.PSFB12]=192,me.version==1?Se.sideinfo_len=Se.channels_out==1?21:36:Se.sideinfo_len=Se.channels_out==1?13:21,me.error_protection&&(Se.sideinfo_len+=2),Ne(me),Se.Class_ID=Y;{var se;for(se=0;se<19;se++)Se.nsPsy.pefirbuf[se]=700*Se.mode_gr*Se.channels_out;me.ATHtype==-1&&(me.ATHtype=4)}switch(o(me.VBR_q<=9),o(me.VBR_q>=0),me.VBR){case t.vbr_mt:me.VBR=t.vbr_mtrh;case t.vbr_mtrh:{me.useTemporal==null&&(me.useTemporal=!1),D.apply_preset(me,500-me.VBR_q*10,0),me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),me.quality<5&&(me.quality=0),me.quality>5&&(me.quality=5),Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,me.experimentalY?Se.sfb21_extra=!1:Se.sfb21_extra=me.out_samplerate>44e3,Se.iteration_loop=new VBRNewIterationLoop(G);break}case t.vbr_rh:{D.apply_preset(me,500-me.VBR_q*10,0),Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,me.experimentalY?Se.sfb21_extra=!1:Se.sfb21_extra=me.out_samplerate>44e3,me.quality>6&&(me.quality=6),me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),Se.iteration_loop=new VBROldIterationLoop(G);break}default:{var _e;Se.sfb21_extra=!1,me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),_e=me.VBR,_e==t.vbr_off&&(me.VBR_mean_bitrate_kbps=me.brate),D.apply_preset(me,me.VBR_mean_bitrate_kbps,0),me.VBR=_e,Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,_e==t.vbr_off?Se.iteration_loop=new g(G):Se.iteration_loop=new ABRIterationLoop(G);break}}if(o(me.scale>=0),me.VBR!=t.vbr_off){if(Se.VBR_min_bitrate=1,Se.VBR_max_bitrate=14,me.out_samplerate<16e3&&(Se.VBR_max_bitrate=8),me.VBR_min_bitrate_kbps!=0&&(me.VBR_min_bitrate_kbps=le(me.VBR_min_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_min_bitrate=ce(me.VBR_min_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_min_bitrate<0)||me.VBR_max_bitrate_kbps!=0&&(me.VBR_max_bitrate_kbps=le(me.VBR_max_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_max_bitrate=ce(me.VBR_max_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_max_bitrate<0))return-1;me.VBR_min_bitrate_kbps=_.bitrate_table[me.version][Se.VBR_min_bitrate],me.VBR_max_bitrate_kbps=_.bitrate_table[me.version][Se.VBR_max_bitrate],me.VBR_mean_bitrate_kbps=Math.min(_.bitrate_table[me.version][Se.VBR_max_bitrate],me.VBR_mean_bitrate_kbps),me.VBR_mean_bitrate_kbps=Math.max(_.bitrate_table[me.version][Se.VBR_min_bitrate],me.VBR_mean_bitrate_kbps)}return me.tune&&(Se.PSY.mask_adjust+=me.tune_value_a,Se.PSY.mask_adjust_short+=me.tune_value_a),qe(me),o(me.scale>=0),me.athaa_type<0?Se.ATH.useAdjust=3:Se.ATH.useAdjust=me.athaa_type,Se.ATH.aaSensitivityP=Math.pow(10,me.athaa_sensitivity/-10),me.short_blocks==null&&(me.short_blocks=r.short_block_allowed),me.short_blocks==r.short_block_allowed&&(me.mode==x.JOINT_STEREO||me.mode==x.STEREO)&&(me.short_blocks=r.short_block_coupled),me.quant_comp<0&&(me.quant_comp=1),me.quant_comp_short<0&&(me.quant_comp_short=0),me.msfix<0&&(me.msfix=0),me.exp_nspsytune=me.exp_nspsytune|1,me.internal_flags.nsPsy.attackthre<0&&(me.internal_flags.nsPsy.attackthre=l.NSATTACKTHRE),me.internal_flags.nsPsy.attackthre_s<0&&(me.internal_flags.nsPsy.attackthre_s=l.NSATTACKTHRE_S),o(me.scale>=0),me.scale<0&&(me.scale=1),me.ATHtype<0&&(me.ATHtype=4),me.ATHcurve<0&&(me.ATHcurve=4),me.athaa_loudapprox<0&&(me.athaa_loudapprox=2),me.interChRatio<0&&(me.interChRatio=0),me.useTemporal==null&&(me.useTemporal=!0),Se.slot_lag=Se.frac_SpF=0,me.VBR==t.vbr_off&&(Se.slot_lag=Se.frac_SpF=(me.version+1)*72e3*me.brate%me.out_samplerate|0),V.iteration_init(me),J.psymodel_init(me),o(me.scale>=0),0};function Ae(me,Se){(me.in_buffer_0==null||me.in_buffer_nsamples<Se)&&(me.in_buffer_0=i(Se),me.in_buffer_1=i(Se),me.in_buffer_nsamples=Se)}this.lame_encode_flush=function(me,Se,ke,be){var Ke=me.internal_flags,ot=a([2,1152]),lt=0,ct,Vt,Ot,Ut,je=Ke.mf_samples_to_encode-y.POSTDELAY,ge=Xe(me);if(Ke.mf_samples_to_encode<1)return 0;for(ct=0,me.in_samplerate!=me.out_samplerate&&(je+=16*me.out_samplerate/me.in_samplerate),Ot=me.framesize-je%me.framesize,Ot<576&&(Ot+=me.framesize),me.encoder_padding=Ot,Ut=(je+Ot)/me.framesize;Ut>0&&lt>=0;){var se=ge-Ke.mf_size,_e=me.frameNum;se*=me.in_samplerate,se/=me.out_samplerate,se>1152&&(se=1152),se<1&&(se=1),Vt=be-ct,be==0&&(Vt=0),lt=this.lame_encode_buffer(me,ot[0],ot[1],se,Se,ke,Vt),ke+=lt,ct+=lt,Ut-=_e!=me.frameNum?1:0}if(Ke.mf_samples_to_encode=0,lt<0||(Vt=be-ct,be==0&&(Vt=0),I.flush_bitstream(me),lt=I.copy_buffer(Ke,Se,ke,Vt,1),lt<0))return lt;if(ke+=lt,ct+=lt,Vt=be-ct,be==0&&(Vt=0),me.write_id3tag_automatic){if($.id3tag_write_v1(me),lt=I.copy_buffer(Ke,Se,ke,Vt,0),lt<0)return lt;ct+=lt}return ct},this.lame_encode_buffer=function(me,Se,ke,be,Ke,ot,lt){var ct=me.internal_flags,Vt=[null,null];if(ct.Class_ID!=Y)return-3;if(be==0)return 0;Ae(ct,be),Vt[0]=ct.in_buffer_0,Vt[1]=ct.in_buffer_1;for(var Ot=0;Ot<be;Ot++)Vt[0][Ot]=Se[Ot],ct.channels_in>1&&(Vt[1][Ot]=ke[Ot]);return $e(me,Vt[0],Vt[1],be,Ke,ot,lt)};function Xe(me){var Se=y.BLKSIZE+me.framesize-y.FFTOFFSET;return Se=Math.max(Se,512+me.framesize-32),Se}function $e(me,Se,ke,be,Ke,ot,lt){var ct=me.internal_flags,Vt=0,Ot,Ut,je,ge,se,_e=[null,null],Ie=[null,null];if(ct.Class_ID!=Y)return-3;if(be==0)return 0;if(se=I.copy_buffer(ct,Ke,ot,lt,0),se<0)return se;if(ot+=se,Vt+=se,Ie[0]=Se,Ie[1]=ke,p.NEQ(me.scale,0)&&p.NEQ(me.scale,1))for(Ut=0;Ut<be;++Ut)Ie[0][Ut]*=me.scale,ct.channels_out==2&&(Ie[1][Ut]*=me.scale);if(p.NEQ(me.scale_left,0)&&p.NEQ(me.scale_left,1))for(Ut=0;Ut<be;++Ut)Ie[0][Ut]*=me.scale_left;if(p.NEQ(me.scale_right,0)&&p.NEQ(me.scale_right,1))for(Ut=0;Ut<be;++Ut)Ie[1][Ut]*=me.scale_right;if(me.num_channels==2&&ct.channels_out==1)for(Ut=0;Ut<be;++Ut)Ie[0][Ut]=.5*(Ie[0][Ut]+Ie[1][Ut]),Ie[1][Ut]=0;ge=Xe(me),_e[0]=ct.mfbuf[0],_e[1]=ct.mfbuf[1];for(var De=0;be>0;){var Oe=[null,null],we=0,st=0;Oe[0]=Ie[0],Oe[1]=Ie[1];var Ve=new pt;if(Be(me,_e,Oe,De,be,Ve),we=Ve.n_in,st=Ve.n_out,ct.findReplayGain&&!ct.decode_on_the_fly&&N.AnalyzeSamples(ct.rgdata,_e[0],ct.mf_size,_e[1],ct.mf_size,st,ct.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(be-=we,De+=we,ct.channels_out==2,ct.mf_size+=st,o(ct.mf_size<=u.MFSIZE),ct.mf_samples_to_encode<1&&(ct.mf_samples_to_encode=y.ENCDELAY+y.POSTDELAY),ct.mf_samples_to_encode+=st,ct.mf_size>=ge){var tt=lt-Vt;if(lt==0&&(tt=0),Ot=at(me,_e[0],_e[1],Ke,ot,tt),Ot<0)return Ot;for(ot+=Ot,Vt+=Ot,ct.mf_size-=me.framesize,ct.mf_samples_to_encode-=me.framesize,je=0;je<ct.channels_out;je++)for(Ut=0;Ut<ct.mf_size;Ut++)_e[je][Ut]=_e[je][Ut+me.framesize]}}return Vt}function at(me,Se,ke,be,Ke,ot){var lt=E.enc.lame_encode_mp3_frame(me,Se,ke,be,Ke,ot);return me.frameNum++,lt}function pt(){this.n_in=0,this.n_out=0}function oe(){this.num_used=0}function Ue(me,Se){return Se!=0?Ue(Se,me%Se):me}function Ge(me,Se,ke){var be=Math.PI*Se;me/=ke,me<0&&(me=0),me>1&&(me=1);var Ke=me-.5,ot=.42-.5*Math.cos(2*me*Math.PI)+.08*Math.cos(4*me*Math.PI);return Math.abs(Ke)<1e-9?be/Math.PI:ot*Math.sin(ke*be*Ke)/(Math.PI*ke*Ke)}function ze(me,Se,ke,be,Ke,ot,lt,ct,Vt){var Ot=me.internal_flags,Ut,je=0,ge,se=me.out_samplerate/Ue(me.out_samplerate,me.in_samplerate);se>u.BPC&&(se=u.BPC);var _e=Math.abs(Ot.resample_ratio-Math.floor(.5+Ot.resample_ratio))<1e-4?1:0,Ie=1/Ot.resample_ratio;Ie>1&&(Ie=1);var De=31;De%2==0&&--De,De+=_e;var Oe=De+1;if(Ot.fill_buffer_resample_init==0){for(Ot.inbuf_old[0]=i(Oe),Ot.inbuf_old[1]=i(Oe),Ut=0;Ut<=2*se;++Ut)Ot.blackfilt[Ut]=i(Oe);for(Ot.itime[0]=0,Ot.itime[1]=0,je=0;je<=2*se;je++){var we=0,st=(je-se)/(2*se);for(Ut=0;Ut<=De;Ut++)we+=Ot.blackfilt[je][Ut]=Ge(Ut-st,Ie,De);for(Ut=0;Ut<=De;Ut++)Ot.blackfilt[je][Ut]/=we}Ot.fill_buffer_resample_init=1}var Ve=Ot.inbuf_old[Vt];for(ge=0;ge<be;ge++){var tt,Ze;if(tt=ge*Ot.resample_ratio,je=0|Math.floor(tt-Ot.itime[Vt]),De+je-De/2>=lt)break;var st=tt-Ot.itime[Vt]-(je+.5*(De%2));Ze=0|Math.floor(st*2*se+se+.5);var nt=0;for(Ut=0;Ut<=De;++Ut){var vt=0|Ut+je-De/2,Je;Je=vt<0?Ve[Oe+vt]:Ke[ot+vt],nt+=Je*Ot.blackfilt[Ze][Ut]}Se[ke+ge]=nt}if(ct.num_used=Math.min(lt,De+je-De/2),Ot.itime[Vt]+=ct.num_used-ge*Ot.resample_ratio,ct.num_used>=Oe)for(Ut=0;Ut<Oe;Ut++)Ve[Ut]=Ke[ot+ct.num_used+Ut-Oe];else{var ht=Oe-ct.num_used;for(Ut=0;Ut<ht;++Ut)Ve[Ut]=Ve[Ut+ct.num_used];for(je=0;Ut<Oe;++Ut,++je)Ve[Ut]=Ke[ot+je];o(je==ct.num_used)}return ge}function Be(me,Se,ke,be,Ke,ot){var lt=me.internal_flags;if(lt.resample_ratio<.9999||lt.resample_ratio>1.0001)for(var ct=0;ct<lt.channels_out;ct++){var Vt=new oe;ot.n_out=ze(me,Se[ct],lt.mf_size,me.framesize,ke[ct],be,Ke,Vt,ct),ot.n_in=Vt.num_used}else{ot.n_out=Math.min(me.framesize,Ke),ot.n_in=ot.n_out;for(var Ot=0;Ot<ot.n_out;++Ot)Se[0][lt.mf_size+Ot]=ke[0][be+Ot],lt.channels_out==2&&(Se[1][lt.mf_size+Ot]=ke[1][be+Ot])}}}return IF=v,IF}var iut=Rc,ov=iut.VbrMode;function sut(){var n=oG();function e(u,f,h,g,p,_,y,v,x,E,M,k,N,I,D){this.vbr_q=u,this.quant_comp=f,this.quant_comp_s=h,this.expY=g,this.st_lrm=p,this.st_s=_,this.masking_adj=y,this.masking_adj_short=v,this.ath_lower=x,this.ath_curve=E,this.ath_sensitivity=M,this.interch=k,this.safejoint=N,this.sfb21mod=I,this.msfix=D}function t(u,f,h,g,p,_,y,v,x,E,M,k,N,I){this.quant_comp=f,this.quant_comp_s=h,this.safejoint=g,this.nsmsfix=p,this.st_lrm=_,this.st_s=y,this.nsbass=v,this.scale=x,this.masking_adj=E,this.ath_lower=M,this.ath_curve=k,this.interch=N,this.sfscale=I}var r;this.setModules=function(u){r=u};var i=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],s=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function a(u,f,h){var g=u.VBR==ov.vbr_rh?i:s,p=u.VBR_q_frac,_=g[f],y=g[f+1],v=_;_.st_lrm=_.st_lrm+p*(y.st_lrm-_.st_lrm),_.st_s=_.st_s+p*(y.st_s-_.st_s),_.masking_adj=_.masking_adj+p*(y.masking_adj-_.masking_adj),_.masking_adj_short=_.masking_adj_short+p*(y.masking_adj_short-_.masking_adj_short),_.ath_lower=_.ath_lower+p*(y.ath_lower-_.ath_lower),_.ath_curve=_.ath_curve+p*(y.ath_curve-_.ath_curve),_.ath_sensitivity=_.ath_sensitivity+p*(y.ath_sensitivity-_.ath_sensitivity),_.interch=_.interch+p*(y.interch-_.interch),_.msfix=_.msfix+p*(y.msfix-_.msfix),c(u,v.vbr_q),h!=0?u.quant_comp=v.quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=v.quant_comp),h!=0?u.quant_comp_short=v.quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=v.quant_comp_s),v.expY!=0&&(u.experimentalY=v.expY!=0),h!=0?u.internal_flags.nsPsy.attackthre=v.st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=v.st_lrm),h!=0?u.internal_flags.nsPsy.attackthre_s=v.st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=v.st_s),h!=0?u.maskingadjust=v.masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=v.masking_adj),h!=0?u.maskingadjust_short=v.masking_adj_short:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=v.masking_adj_short),h!=0?u.ATHlower=-v.ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-v.ath_lower/10),h!=0?u.ATHcurve=v.ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=v.ath_curve),h!=0?u.athaa_sensitivity=v.ath_sensitivity:Math.abs(u.athaa_sensitivity- -1)>0||(u.athaa_sensitivity=v.ath_sensitivity),v.interch>0&&(h!=0?u.interChRatio=v.interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=v.interch)),v.safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|v.safejoint),v.sfb21mod>0&&(u.exp_nspsytune=u.exp_nspsytune|v.sfb21mod<<20),h!=0?u.msfix=v.msfix:Math.abs(u.msfix- -1)>0||(u.msfix=v.msfix),h==0&&(u.VBR_q=f,u.VBR_q_frac=p)}var o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(u,f,h){var g=f,p=r.nearestBitrateFullIndex(f);if(u.VBR=ov.vbr_abr,u.VBR_mean_bitrate_kbps=g,u.VBR_mean_bitrate_kbps=Math.min(u.VBR_mean_bitrate_kbps,320),u.VBR_mean_bitrate_kbps=Math.max(u.VBR_mean_bitrate_kbps,8),u.brate=u.VBR_mean_bitrate_kbps,u.VBR_mean_bitrate_kbps>320&&(u.disable_reservoir=!0),o[p].safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|2),o[p].sfscale>0&&(u.internal_flags.noise_shaping=2),Math.abs(o[p].nsbass)>0){var _=int(o[p].nsbass*4);_<0&&(_+=64),u.exp_nspsytune=u.exp_nspsytune|_<<2}return h!=0?u.quant_comp=o[p].quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=o[p].quant_comp),h!=0?u.quant_comp_short=o[p].quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=o[p].quant_comp_s),h!=0?u.msfix=o[p].nsmsfix:Math.abs(u.msfix- -1)>0||(u.msfix=o[p].nsmsfix),h!=0?u.internal_flags.nsPsy.attackthre=o[p].st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=o[p].st_lrm),h!=0?u.internal_flags.nsPsy.attackthre_s=o[p].st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=o[p].st_s),h!=0?u.scale=o[p].scale:Math.abs(u.scale- -1)>0||(u.scale=o[p].scale),h!=0?u.maskingadjust=o[p].masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=o[p].masking_adj),o[p].masking_adj>0?h!=0?u.maskingadjust_short=o[p].masking_adj*.9:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=o[p].masking_adj*.9):h!=0?u.maskingadjust_short=o[p].masking_adj*1.1:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=o[p].masking_adj*1.1),h!=0?u.ATHlower=-o[p].ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-o[p].ath_lower/10),h!=0?u.ATHcurve=o[p].ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=o[p].ath_curve),h!=0?u.interChRatio=o[p].interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=o[p].interch),f}this.apply_preset=function(u,f,h){switch(f){case n.R3MIX:{f=n.V3,u.VBR=ov.vbr_mtrh;break}case n.MEDIUM:{f=n.V4,u.VBR=ov.vbr_rh;break}case n.MEDIUM_FAST:{f=n.V4,u.VBR=ov.vbr_mtrh;break}case n.STANDARD:{f=n.V2,u.VBR=ov.vbr_rh;break}case n.STANDARD_FAST:{f=n.V2,u.VBR=ov.vbr_mtrh;break}case n.EXTREME:{f=n.V0,u.VBR=ov.vbr_rh;break}case n.EXTREME_FAST:{f=n.V0,u.VBR=ov.vbr_mtrh;break}case n.INSANE:return f=320,u.preset=f,l(u,f,h),u.VBR=ov.vbr_off,f}switch(u.preset=f,f){case n.V9:return a(u,9,h),f;case n.V8:return a(u,8,h),f;case n.V7:return a(u,7,h),f;case n.V6:return a(u,6,h),f;case n.V5:return a(u,5,h),f;case n.V4:return a(u,4,h),f;case n.V3:return a(u,3,h),f;case n.V2:return a(u,2,h),f;case n.V1:return a(u,1,h),f;case n.V0:return a(u,0,h),f}return 8<=f&&f<=320?l(u,f,h):(u.preset=0,f)};function c(u,f){var h=0;return 0>f&&(h=-1,f=0),9<f&&(h=-1,f=9),u.VBR_q=f,u.VBR_q_frac=0,h}}var aut=sut;function out(){this.setModules=function(n,e){}}var lut=out;function cut(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var uut=cut,sye=Rc,Zre=sye.new_float,fut=sye.new_int;function hut(){this.global_gain=0,this.sfb_count1=0,this.step=fut(39),this.noise=Zre(39),this.noise_log=Zre(39)}var dut=hut,_R=Rc,Kb=_R.System,Jre=_R.VbrMode,NF=_R.Util,aT=_R.Arrays,$M=_R.new_float,WM=_R.assert,put=lut,PF=uut,mut=dut,Oa=ap(),Qre=nG,eie=C6;function gut(){var n;this.rv=null;var e;this.qupvt=null;var t,r=new put,i;this.setModules=function(v,x,E,M){n=v,e=x,this.rv=x,t=E,this.qupvt=E,i=M,r.setModules(t,i)},this.ms_convert=function(v,x){for(var E=0;E<576;++E){var M=v.tt[x][0].xr[E],k=v.tt[x][1].xr[E];v.tt[x][0].xr[E]=(M+k)*(NF.SQRT2*.5),v.tt[x][1].xr[E]=(M-k)*(NF.SQRT2*.5)}};function s(v,x,E,M){M=0;for(var k=0;k<=E;++k){var N=Math.abs(v.xr[k]);M+=N,x[k]=Math.sqrt(N*Math.sqrt(N)),x[k]>v.xrpow_max&&(v.xrpow_max=x[k])}return M}this.init_xrpow=function(v,x,E){var M=0,k=0|x.max_nonzero_coeff;if(x.xrpow_max=0,aT.fill(E,k,576,0),M=s(x,E,k,M),M>1e-20){var N=0;v.substep_shaping&2&&(N=1);for(var I=0;I<x.psymax;I++)v.pseudohalf[I]=N;return!0}return aT.fill(x.l3_enc,0,576,0),!1};function a(v,x){var E=v.ATH,M=x.xr;if(x.block_type!=Oa.SHORT_TYPE)for(var k=!1,N=Oa.PSFB21-1;N>=0&&!k;N--){var I=v.scalefac_band.psfb21[N],D=v.scalefac_band.psfb21[N+1],V=t.athAdjust(E.adjust,E.psfb21[N],E.floor);v.nsPsy.longfact[21]>1e-12&&(V*=v.nsPsy.longfact[21]);for(var G=D-1;G>=I;G--)if(Math.abs(M[G])<V)M[G]=0;else{k=!0;break}}else for(var J=0;J<3;J++)for(var k=!1,N=Oa.PSFB12-1;N>=0&&!k;N--){var I=v.scalefac_band.s[12]*3+(v.scalefac_band.s[13]-v.scalefac_band.s[12])*J+(v.scalefac_band.psfb12[N]-v.scalefac_band.psfb12[0]),D=I+(v.scalefac_band.psfb12[N+1]-v.scalefac_band.psfb12[N]),B=t.athAdjust(E.adjust,E.psfb12[N],E.floor);v.nsPsy.shortfact[12]>1e-12&&(B*=v.nsPsy.shortfact[12]);for(var G=D-1;G>=I;G--)if(Math.abs(M[G])<B)M[G]=0;else{k=!0;break}}}this.init_outer_loop=function(v,x){x.part2_3_length=0,x.big_values=0,x.count1=0,x.global_gain=210,x.scalefac_compress=0,x.table_select[0]=0,x.table_select[1]=0,x.table_select[2]=0,x.subblock_gain[0]=0,x.subblock_gain[1]=0,x.subblock_gain[2]=0,x.subblock_gain[3]=0,x.region0_count=0,x.region1_count=0,x.preflag=0,x.scalefac_scale=0,x.count1table_select=0,x.part2_length=0,x.sfb_lmax=Oa.SBPSY_l,x.sfb_smin=Oa.SBPSY_s,x.psy_lmax=v.sfb21_extra?Oa.SBMAX_l:Oa.SBPSY_l,x.psymax=x.psy_lmax,x.sfbmax=x.sfb_lmax,x.sfbdivide=11;for(var E=0;E<Oa.SBMAX_l;E++)x.width[E]=v.scalefac_band.l[E+1]-v.scalefac_band.l[E],x.window[E]=3;if(x.block_type==Oa.SHORT_TYPE){var M=$M(576);x.sfb_smin=0,x.sfb_lmax=0,x.mixed_block_flag!=0&&(x.sfb_smin=3,x.sfb_lmax=v.mode_gr*2+4),x.psymax=x.sfb_lmax+3*((v.sfb21_extra?Oa.SBMAX_s:Oa.SBPSY_s)-x.sfb_smin),x.sfbmax=x.sfb_lmax+3*(Oa.SBPSY_s-x.sfb_smin),x.sfbdivide=x.sfbmax-18,x.psy_lmax=x.sfb_lmax;var k=v.scalefac_band.l[x.sfb_lmax];Kb.arraycopy(x.xr,0,M,0,576);for(var E=x.sfb_smin;E<Oa.SBMAX_s;E++)for(var N=v.scalefac_band.s[E],I=v.scalefac_band.s[E+1],D=0;D<3;D++)for(var V=N;V<I;V++)x.xr[k++]=M[3*V+D];for(var G=x.sfb_lmax,E=x.sfb_smin;E<Oa.SBMAX_s;E++)x.width[G]=x.width[G+1]=x.width[G+2]=v.scalefac_band.s[E+1]-v.scalefac_band.s[E],x.window[G]=0,x.window[G+1]=1,x.window[G+2]=2,G+=3}x.count1bits=0,x.sfb_partition_table=t.nr_of_sfb_block[0][0],x.slen[0]=0,x.slen[1]=0,x.slen[2]=0,x.slen[3]=0,x.max_nonzero_coeff=575,aT.fill(x.scalefac,0),a(v,x)};function o(v){this.ordinal=v}o.BINSEARCH_NONE=new o(0),o.BINSEARCH_UP=new o(1),o.BINSEARCH_DOWN=new o(2);function l(v,x,E,M,k){var N,I=v.CurrentStep[M],D=!1,V=v.OldValue[M],G=o.BINSEARCH_NONE;for(x.global_gain=V,E-=x.part2_length;;){var J;if(N=i.count_bits(v,k,x,null),I==1||N==E)break;N>E?(G==o.BINSEARCH_DOWN&&(D=!0),D&&(I/=2),G=o.BINSEARCH_UP,J=I):(G==o.BINSEARCH_UP&&(D=!0),D&&(I/=2),G=o.BINSEARCH_DOWN,J=-I),x.global_gain+=J,x.global_gain<0&&(x.global_gain=0,D=!0),x.global_gain>255&&(x.global_gain=255,D=!0)}for(WM(x.global_gain>=0),WM(x.global_gain<256);N>E&&x.global_gain<255;)x.global_gain++,N=i.count_bits(v,k,x,null);return v.CurrentStep[M]=V-x.global_gain>=4?4:2,v.OldValue[M]=x.global_gain,x.part2_3_length=N,N}this.trancate_smallspectrums=function(v,x,E,M){var k=$M(eie.SFBMAX);if(!(!(v.substep_shaping&4)&&x.block_type==Oa.SHORT_TYPE||v.substep_shaping&128)){t.calc_noise(x,E,k,new PF,null);for(var I=0;I<576;I++){var N=0;x.l3_enc[I]!=0&&(N=Math.abs(x.xr[I])),M[I]=N}var I=0,D=8;x.block_type==Oa.SHORT_TYPE&&(D=6);do{var V,G,J,B,$=x.width[D];if(I+=$,!(k[D]>=1)&&(aT.sort(M,I-$,$),!BitStream.EQ(M[I-1],0))){V=(1-k[D])*E[D],G=0,B=0;do{var U;for(J=1;B+J<$&&!BitStream.NEQ(M[B+I-$],M[B+I+J-$]);J++);if(U=M[B+I-$]*M[B+I-$]*J,V<U){B!=0&&(G=M[B+I-$-1]);break}V-=U,B+=J}while(B<$);if(!BitStream.EQ(G,0))do Math.abs(x.xr[I-$])<=G&&(x.l3_enc[I-$]=0);while(--$>0)}}while(++D<x.psymax);x.part2_3_length=i.noquant_count_bits(v,x,null)}};function c(v){for(var x=0;x<v.sfbmax;x++)if(v.scalefac[x]+v.subblock_gain[v.window[x]]==0)return!1;return!0}function u(v){return NF.FAST_LOG10(.368+.632*v*v*v)}function f(v,x){for(var E=1e-37,M=0;M<x.psymax;M++)E+=u(v[M]);return Math.max(1e-20,E)}function h(v,x,E,M,k){var N;switch(v){default:case 9:{x.over_count>0?(N=E.over_SSD<=x.over_SSD,E.over_SSD==x.over_SSD&&(N=E.bits<x.bits)):N=E.max_noise<0&&E.max_noise*10+E.bits<=x.max_noise*10+x.bits;break}case 0:N=E.over_count<x.over_count||E.over_count==x.over_count&&E.over_noise<x.over_noise||E.over_count==x.over_count&&BitStream.EQ(E.over_noise,x.over_noise)&&E.tot_noise<x.tot_noise;break;case 8:E.max_noise=f(k,M);case 1:N=E.max_noise<x.max_noise;break;case 2:N=E.tot_noise<x.tot_noise;break;case 3:N=E.tot_noise<x.tot_noise&&E.max_noise<x.max_noise;break;case 4:N=E.max_noise<=0&&x.max_noise>.2||E.max_noise<=0&&x.max_noise<0&&x.max_noise>E.max_noise-.2&&E.tot_noise<x.tot_noise||E.max_noise<=0&&x.max_noise>0&&x.max_noise>E.max_noise-.2&&E.tot_noise<x.tot_noise+x.over_noise||E.max_noise>0&&x.max_noise>-.05&&x.max_noise>E.max_noise-.1&&E.tot_noise+E.over_noise<x.tot_noise+x.over_noise||E.max_noise>0&&x.max_noise>-.1&&x.max_noise>E.max_noise-.15&&E.tot_noise+E.over_noise+E.over_noise<x.tot_noise+x.over_noise+x.over_noise;break;case 5:N=E.over_noise<x.over_noise||BitStream.EQ(E.over_noise,x.over_noise)&&E.tot_noise<x.tot_noise;break;case 6:N=E.over_noise<x.over_noise||BitStream.EQ(E.over_noise,x.over_noise)&&(E.max_noise<x.max_noise||BitStream.EQ(E.max_noise,x.max_noise)&&E.tot_noise<=x.tot_noise);break;case 7:N=E.over_count<x.over_count||E.over_noise<x.over_noise;break}return x.over_count==0&&(N=N&&E.bits<x.bits),N}function g(v,x,E,M,k){var N=v.internal_flags,I;x.scalefac_scale==0?I=1.2968395546510096:I=1.6817928305074292;for(var D=0,V=0;V<x.sfbmax;V++)D<E[V]&&(D=E[V]);var G=N.noise_shaping_amp;switch(G==3&&(k?G=2:G=1),G){case 2:break;case 1:D>1?D=Math.pow(D,.5):D*=.95;break;case 0:default:D>1?D=1:D*=.95;break}for(var J=0,V=0;V<x.sfbmax;V++){var B=x.width[V],$;if(J+=B,!(E[V]<D)){if(N.substep_shaping&2&&(N.pseudohalf[V]=N.pseudohalf[V]==0?1:0,N.pseudohalf[V]==0&&N.noise_shaping_amp==2))return;for(x.scalefac[V]++,$=-B;$<0;$++)M[J+$]*=I,M[J+$]>x.xrpow_max&&(x.xrpow_max=M[J+$]);if(N.noise_shaping_amp==2)return}}}function p(v,x){for(var E=1.2968395546510096,M=0,k=0;k<v.sfbmax;k++){var N=v.width[k],I=v.scalefac[k];if(v.preflag!=0&&(I+=t.pretab[k]),M+=N,I&1){I++;for(var D=-N;D<0;D++)x[M+D]*=E,x[M+D]>v.xrpow_max&&(v.xrpow_max=x[M+D])}v.scalefac[k]=I>>1}v.preflag=0,v.scalefac_scale=1}function _(v,x,E){var M,k=x.scalefac;for(M=0;M<x.sfb_lmax;M++)if(k[M]>=16)return!0;for(var N=0;N<3;N++){var I=0,D=0;for(M=x.sfb_lmax+N;M<x.sfbdivide;M+=3)I<k[M]&&(I=k[M]);for(;M<x.sfbmax;M+=3)D<k[M]&&(D=k[M]);if(!(I<16&&D<8)){if(x.subblock_gain[N]>=7)return!0;x.subblock_gain[N]++;var V=v.scalefac_band.l[x.sfb_lmax];for(M=x.sfb_lmax+N;M<x.sfbmax;M+=3){var G,J=x.width[M],B=k[M];if(B=B-(4>>x.scalefac_scale),B>=0){k[M]=B,V+=J*3;continue}k[M]=0;{var $=210+(B<<x.scalefac_scale+1);G=t.IPOW20($)}V+=J*(N+1);for(var U=-J;U<0;U++)E[V+U]*=G,E[V+U]>x.xrpow_max&&(x.xrpow_max=E[V+U]);V+=J*(3-N-1)}{var G=t.IPOW20(202);V+=x.width[M]*(N+1);for(var U=-x.width[M];U<0;U++)E[V+U]*=G,E[V+U]>x.xrpow_max&&(x.xrpow_max=E[V+U])}}}return!1}function y(v,x,E,M,k){var N=v.internal_flags;g(v,x,E,M,k);var I=c(x);return I?!1:(N.mode_gr==2?I=i.scale_bitcount(x):I=i.scale_bitcount_lsf(N,x),I?(N.noise_shaping>1&&(aT.fill(N.pseudohalf,0),x.scalefac_scale==0?(p(x,M),I=!1):x.block_type==Oa.SHORT_TYPE&&N.subblock_gain>0&&(I=_(N,x,M)||c(x))),I||(N.mode_gr==2?I=i.scale_bitcount(x):I=i.scale_bitcount_lsf(N,x)),!I):!0)}this.outer_loop=function(v,x,E,M,k,N){var I=v.internal_flags,D=new Qre,V=$M(576),G=$M(eie.SFBMAX),J=new PF,B,$=new mut,U=9999999,Q=!1,W=!1,q=0;if(l(I,x,N,k,M),I.noise_shaping==0)return 100;t.calc_noise(x,E,G,J,$),J.bits=x.part2_3_length,D.assign(x);var Y=0;for(Kb.arraycopy(M,0,V,0,576);!Q;){do{var ae=new PF,Z,K=255;if(I.substep_shaping&2?Z=20:Z=3,I.sfb21_extra&&(G[D.sfbmax]>1||D.block_type==Oa.SHORT_TYPE&&(G[D.sfbmax+1]>1||G[D.sfbmax+2]>1))||!y(v,D,G,M,W))break;D.scalefac_scale!=0&&(K=254);var ne=N-D.part2_length;if(ne<=0)break;for(;(D.part2_3_length=i.count_bits(I,M,D,$))>ne&&D.global_gain<=K;)D.global_gain++;if(D.global_gain>K)break;if(J.over_count==0){for(;(D.part2_3_length=i.count_bits(I,M,D,$))>U&&D.global_gain<=K;)D.global_gain++;if(D.global_gain>K)break}if(t.calc_noise(D,E,G,ae,$),ae.bits=D.part2_3_length,x.block_type!=Oa.SHORT_TYPE?B=v.quant_comp:B=v.quant_comp_short,B=h(B,J,ae,D,G)?1:0,B!=0)U=x.part2_3_length,J=ae,x.assign(D),Y=0,Kb.arraycopy(M,0,V,0,576);else if(I.full_outer_loop==0&&(++Y>Z&&J.over_count==0||I.noise_shaping_amp==3&&W&&Y>30||I.noise_shaping_amp==3&&W&&D.global_gain-q>15))break}while(D.global_gain+D.scalefac_scale<255);I.noise_shaping_amp==3?W?Q=!0:(D.assign(x),Kb.arraycopy(V,0,M,0,576),Y=0,q=D.global_gain,W=!0):Q=!0}return WM(x.global_gain+x.scalefac_scale<=255),v.VBR==Jre.vbr_rh||v.VBR==Jre.vbr_mtrh?Kb.arraycopy(V,0,M,0,576):I.substep_shaping&1&&trancate_smallspectrums(I,x,E,M),J.over_count},this.iteration_finish_one=function(v,x,E){var M=v.l3_side,k=M.tt[x][E];i.best_scalefac_store(v,x,E,M),v.use_best_huffman==1&&i.best_huffman_divide(v,k),e.ResvAdjust(v,k)},this.VBR_encode_granule=function(v,x,E,M,k,N,I){var D=v.internal_flags,V=new Qre,G=$M(576),J=I,B=I+1,$=(I+N)/2,U,Q,W=0,q=D.sfb21_extra;WM(J<=LameInternalFlags.MAX_BITS_PER_CHANNEL),aT.fill(V.l3_enc,0);do $>J-42?D.sfb21_extra=!1:D.sfb21_extra=q,Q=outer_loop(v,x,E,M,k,$),Q<=0?(W=1,B=x.part2_3_length,V.assign(x),Kb.arraycopy(M,0,G,0,576),I=B-32,U=I-N,$=(I+N)/2):(N=$+32,U=I-N,$=(I+N)/2,W!=0&&(W=2,x.assign(V),Kb.arraycopy(G,0,M,0,576)));while(U>12);D.sfb21_extra=q,W==2&&Kb.arraycopy(V.l3_enc,0,x.l3_enc,0,576),WM(x.part2_3_length<=J)},this.get_framebits=function(v,x){var E=v.internal_flags;E.bitrate_index=E.VBR_min_bitrate;var M=n.getframebits(v);E.bitrate_index=1,M=n.getframebits(v);for(var k=1;k<=E.VBR_max_bitrate;k++){E.bitrate_index=k;var N=new MeanBits(M);x[k]=e.ResvFrameBegin(v,N),M=N.bits}},this.VBR_old_prepare=function(v,x,E,M,k,N,I,D,V){var G=v.internal_flags,J,B=0,$=1,U=0;G.bitrate_index=G.VBR_max_bitrate;var Q=e.ResvFrameBegin(v,new MeanBits(0))/G.mode_gr;get_framebits(v,N);for(var W=0;W<G.mode_gr;W++){var q=t.on_pe(v,x,D[W],Q,W,0);G.mode_ext==Oa.MPG_MD_MS_LR&&(ms_convert(G.l3_side,W),t.reduce_side(D[W],E[W],Q,q));for(var Y=0;Y<G.channels_out;++Y){var ae=G.l3_side.tt[W][Y];ae.block_type!=Oa.SHORT_TYPE?(B=1.28/(1+Math.exp(3.5-x[W][Y]/300))-.05,J=G.PSY.mask_adjust-B):(B=2.56/(1+Math.exp(3.5-x[W][Y]/300))-.14,J=G.PSY.mask_adjust_short-B),G.masking_lower=Math.pow(10,J*.1),init_outer_loop(G,ae),V[W][Y]=t.calc_xmin(v,M[W][Y],ae,k[W][Y]),V[W][Y]!=0&&($=0),I[W][Y]=126,U+=D[W][Y]}}for(var W=0;W<G.mode_gr;W++)for(var Y=0;Y<G.channels_out;Y++)U>N[G.VBR_max_bitrate]&&(D[W][Y]*=N[G.VBR_max_bitrate],D[W][Y]/=U),I[W][Y]>D[W][Y]&&(I[W][Y]=D[W][Y]);return $},this.bitpressure_strategy=function(v,x,E,M){for(var k=0;k<v.mode_gr;k++)for(var N=0;N<v.channels_out;N++){for(var I=v.l3_side.tt[k][N],D=x[k][N],V=0,G=0;G<I.psy_lmax;G++)D[V++]*=1+.029*G*G/Oa.SBMAX_l/Oa.SBMAX_l;if(I.block_type==Oa.SHORT_TYPE)for(var G=I.sfb_smin;G<Oa.SBMAX_s;G++)D[V++]*=1+.029*G*G/Oa.SBMAX_s/Oa.SBMAX_s,D[V++]*=1+.029*G*G/Oa.SBMAX_s/Oa.SBMAX_s,D[V++]*=1+.029*G*G/Oa.SBMAX_s/Oa.SBMAX_s;M[k][N]=0|Math.max(E[k][N],.9*M[k][N])}},this.VBR_new_prepare=function(v,x,E,M,k,N){var I=v.internal_flags,D=1,V=0,G=0,J;if(v.free_format){I.bitrate_index=0;var B=new MeanBits(V);J=e.ResvFrameBegin(v,B),V=B.bits,k[0]=J}else{I.bitrate_index=I.VBR_max_bitrate;var B=new MeanBits(V);e.ResvFrameBegin(v,B),V=B.bits,get_framebits(v,k),J=k[I.VBR_max_bitrate]}for(var $=0;$<I.mode_gr;$++){t.on_pe(v,x,N[$],V,$,0),I.mode_ext==Oa.MPG_MD_MS_LR&&ms_convert(I.l3_side,$);for(var U=0;U<I.channels_out;++U){var Q=I.l3_side.tt[$][U];I.masking_lower=Math.pow(10,I.PSY.mask_adjust*.1),init_outer_loop(I,Q),t.calc_xmin(v,E[$][U],Q,M[$][U])!=0&&(D=0),G+=N[$][U]}}for(var $=0;$<I.mode_gr;$++)for(var U=0;U<I.channels_out;U++)G>J&&(N[$][U]*=J,N[$][U]/=G);return D},this.calc_target_bits=function(v,x,E,M,k,N){var I=v.internal_flags,D=I.l3_side,V,G,J,B,$=0;I.bitrate_index=I.VBR_max_bitrate;var U=new MeanBits($);for(N[0]=e.ResvFrameBegin(v,U),$=U.bits,I.bitrate_index=1,$=n.getframebits(v)-I.sideinfo_len*8,k[0]=$/(I.mode_gr*I.channels_out),$=v.VBR_mean_bitrate_kbps*v.framesize*1e3,I.substep_shaping&1&&($*=1.09),$/=v.out_samplerate,$-=I.sideinfo_len*8,$/=I.mode_gr*I.channels_out,V=.93+.07*(11-v.compression_ratio)/(11-5.5),V<.9&&(V=.9),V>1&&(V=1),G=0;G<I.mode_gr;G++){var Q=0;for(J=0;J<I.channels_out;J++){if(M[G][J]=int(V*$),x[G][J]>700){var W=int((x[G][J]-700)/1.4),q=D.tt[G][J];M[G][J]=int(V*$),q.block_type==Oa.SHORT_TYPE&&W<$/2&&(W=$/2),W>$*3/2?W=$*3/2:W<0&&(W=0),M[G][J]+=W}M[G][J]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[G][J]=LameInternalFlags.MAX_BITS_PER_CHANNEL),Q+=M[G][J]}if(Q>LameInternalFlags.MAX_BITS_PER_GRANULE)for(J=0;J<I.channels_out;++J)M[G][J]*=LameInternalFlags.MAX_BITS_PER_GRANULE,M[G][J]/=Q}if(I.mode_ext==Oa.MPG_MD_MS_LR)for(G=0;G<I.mode_gr;G++)t.reduce_side(M[G],E[G],$*I.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(B=0,G=0;G<I.mode_gr;G++)for(J=0;J<I.channels_out;J++)M[G][J]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[G][J]=LameInternalFlags.MAX_BITS_PER_CHANNEL),B+=M[G][J];if(B>N[0])for(G=0;G<I.mode_gr;G++)for(J=0;J<I.channels_out;J++)M[G][J]*=N[0],M[G][J]/=B}}var _ut=gut,vut=Rc,tie=vut.assert;function yut(){var n;this.setModules=function(e){n=e},this.ResvFrameBegin=function(e,t){var r=e.internal_flags,i,s=r.l3_side,a=n.getframebits(e);t.bits=(a-r.sideinfo_len*8)/r.mode_gr;var o=8*256*r.mode_gr-8;e.brate>320?i=8*int(e.brate*1e3/(e.out_samplerate/1152)/8+.5):(i=8*1440,e.strict_ISO&&(i=8*int(32e4/(e.out_samplerate/1152)/8+.5))),r.ResvMax=i-a,r.ResvMax>o&&(r.ResvMax=o),(r.ResvMax<0||e.disable_reservoir)&&(r.ResvMax=0);var l=t.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return l>i&&(l=i),tie(r.ResvMax%8==0),tie(r.ResvMax>=0),s.resvDrain_pre=0,r.pinfo!=null&&(r.pinfo.mean_bits=t.bits/2,r.pinfo.resvsize=r.ResvSize),l},this.ResvMaxBits=function(e,t,r,i){var s=e.internal_flags,a,o=s.ResvSize,l=s.ResvMax;i!=0&&(o+=t),s.substep_shaping&1&&(l*=.9),r.bits=t,o*10>l*9?(a=o-l*9/10,r.bits+=a,s.substep_shaping|=128):(a=0,s.substep_shaping&=127,!e.disable_reservoir&&!(s.substep_shaping&1)&&(r.bits-=.1*t));var c=o<s.ResvMax*6/10?o:s.ResvMax*6/10;return c-=a,c<0&&(c=0),c},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var r,i=e.l3_side;e.ResvSize+=t*e.mode_gr;var s=0;i.resvDrain_post=0,i.resvDrain_pre=0,(r=e.ResvSize%8)!=0&&(s+=r),r=e.ResvSize-s-e.ResvMax,r>0&&(s+=r);{var a=Math.min(i.main_data_begin*8,s)/8;i.resvDrain_pre+=8*a,s-=8*a,e.ResvSize-=8*a,i.main_data_begin-=a}i.resvDrain_post+=s,e.ResvSize-=s}}var but=yut;function Sut(){var n="http://www.mp3dev.org/",e=3,t=98,r=4,i=0,s=93;this.getLameVersion=function(){return e+"."+t+"."+r},this.getLameShortVersion=function(){return e+"."+t+"."+r},this.getLameVeryShortVersion=function(){return"LAME"+e+"."+t+"r"},this.getPsyVersion=function(){return i+"."+s},this.getLameUrl=function(){return n},this.getLameOsBitness=function(){return"32bits"}}var Eut=Sut,vR=Rc,xut=vR.System,DF=vR.VbrMode,nie=vR.ShortBlock,Tut=vR.Arrays,DN=vR.new_byte,wut=vR.assert;ik.NUMTOCENTRIES=100;ik.MAXFRAMESIZE=2880;function ik(){var n,e,t;this.setModules=function($,U,Q){n=$,e=U,t=Q};var r=1,i=2,s=4,a=8,o=ik.NUMTOCENTRIES,l=ik.MAXFRAMESIZE,c=o+4+4+4+4+4,u=c+9+1+1+8+1+1+3+1+1+2+4+2+2,f=128,h=64,g=32,p=null,_="Xing",y="Info",v=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function x($,U){if($.nVbrNumFrames++,$.sum+=U,$.seen++,!($.seen<$.want)&&($.pos<$.size&&($.bag[$.pos]=$.sum,$.pos++,$.seen=0),$.pos==$.size)){for(var Q=1;Q<$.size;Q+=2)$.bag[Q/2]=$.bag[Q];$.want*=2,$.pos/=2}}function E($,U){if(!($.pos<=0))for(var Q=1;Q<o;++Q){var W=Q/o,q,Y,ae=0|Math.floor(W*$.pos);ae>$.pos-1&&(ae=$.pos-1),q=$.bag[ae],Y=$.sum;var Z=0|256*q/Y;Z>255&&(Z=255),U[Q]=255&Z}}this.addVbrFrame=function($){var U=$.internal_flags,Q=Tables.bitrate_table[$.version][U.bitrate_index];wut(U.VBR_seek_table.bag!=null),x(U.VBR_seek_table,Q)};function M($,U){var Q=$[U+0]&255;return Q<<=8,Q|=$[U+1]&255,Q<<=8,Q|=$[U+2]&255,Q<<=8,Q|=$[U+3]&255,Q}function k($,U,Q){$[U+0]=255&(Q>>24&255),$[U+1]=255&(Q>>16&255),$[U+2]=255&(Q>>8&255),$[U+3]=255&(Q&255)}function N($,U,Q){$[U+0]=255&(Q>>8&255),$[U+1]=255&(Q&255)}function I($,U){return new String($,U,_.length(),p).equals(_)||new String($,U,y.length(),p).equals(y)}function D($,U,Q){return 255&($<<U|Q&~(-1<<U))}function V($,U){var Q=$.internal_flags;U[0]=D(U[0],8,255),U[1]=D(U[1],3,7),U[1]=D(U[1],1,$.out_samplerate<16e3?0:1),U[1]=D(U[1],1,$.version),U[1]=D(U[1],2,1),U[1]=D(U[1],1,$.error_protection?0:1),U[2]=D(U[2],4,Q.bitrate_index),U[2]=D(U[2],2,Q.samplerate_index),U[2]=D(U[2],1,0),U[2]=D(U[2],1,$.extension),U[3]=D(U[3],2,$.mode.ordinal()),U[3]=D(U[3],2,Q.mode_ext),U[3]=D(U[3],1,$.copyright),U[3]=D(U[3],1,$.original),U[3]=D(U[3],2,$.emphasis),U[0]=255;var W=255&(U[1]&241),q;$.version==1?q=f:$.out_samplerate<16e3?q=g:q=h,$.VBR==DF.vbr_off&&(q=$.brate);var Y;$.free_format?Y=0:Y=255&16*n.BitrateIndex(q,$.version,$.out_samplerate),$.version==1?(U[1]=255&(W|10),W=255&(U[2]&13),U[2]=255&(Y|W)):(U[1]=255&(W|2),W=255&(U[2]&13),U[2]=255&(Y|W))}this.getVbrTag=function($){var U=new VBRTagData,Q=0;U.flags=0;var W=$[Q+1]>>3&1,q=$[Q+2]>>2&3,Y=$[Q+3]>>6&3,ae=$[Q+2]>>4&15;if(ae=Tables.bitrate_table[W][ae],$[Q+1]>>4==14?U.samprate=Tables.samplerate_table[2][q]:U.samprate=Tables.samplerate_table[W][q],W!=0?Y!=3?Q+=36:Q+=21:Y!=3?Q+=21:Q+=13,!I($,Q))return null;Q+=4,U.hId=W;var Z=U.flags=M($,Q);if(Q+=4,Z&r&&(U.frames=M($,Q),Q+=4),Z&i&&(U.bytes=M($,Q),Q+=4),Z&s){if(U.toc!=null)for(var K=0;K<o;K++)U.toc[K]=$[Q+K];Q+=o}U.vbrScale=-1,Z&a&&(U.vbrScale=M($,Q),Q+=4),U.headersize=(W+1)*72e3*ae/U.samprate,Q+=21;var ne=$[Q+0]<<4;ne+=$[Q+1]>>4;var le=($[Q+1]&15)<<8;return le+=$[Q+2]&255,(ne<0||ne>3e3)&&(ne=-1),(le<0||le>3e3)&&(le=-1),U.encDelay=ne,U.encPadding=le,U},this.InitVbrTag=function($){var U=$.internal_flags,Q;$.version==1?Q=f:$.out_samplerate<16e3?Q=g:Q=h,$.VBR==DF.vbr_off&&(Q=$.brate);var W=($.version+1)*72e3*Q/$.out_samplerate,q=U.sideinfo_len+u;if(U.VBR_seek_table.TotalFrameSize=W,W<q||W>l){$.bWriteVbrTag=!1;return}U.VBR_seek_table.nVbrNumFrames=0,U.VBR_seek_table.nBytesWritten=0,U.VBR_seek_table.sum=0,U.VBR_seek_table.seen=0,U.VBR_seek_table.want=1,U.VBR_seek_table.pos=0,U.VBR_seek_table.bag==null&&(U.VBR_seek_table.bag=new int[400],U.VBR_seek_table.size=400);var Y=DN(l);V($,Y);for(var ae=U.VBR_seek_table.TotalFrameSize,Z=0;Z<ae;++Z)e.add_dummy_byte($,Y[Z]&255,1)};function G($,U){var Q=U^$;return U=U>>8^v[Q&255],U}this.updateMusicCRC=function($,U,Q,W){for(var q=0;q<W;++q)$[0]=G(U[Q+q],$[0])};function J($,U,Q,W,q){var Y=$.internal_flags,ae=0,Z=$.encoder_delay,K=$.encoder_padding,ne=100-10*$.VBR_q-$.quality,le=t.getLameVeryShortVersion(),ce,de=0,Me,qe=[1,5,3,2,4,0,3],Ne=0|($.lowpassfreq/100+.5>255?255:$.lowpassfreq/100+.5),Ae=0,Xe=0,$e=0,at=$.internal_flags.noise_shaping,pt=0,oe=0,Ue=0,Ge=0,ze=0,Be=($.exp_nspsytune&1)!=0,me=($.exp_nspsytune&2)!=0,Se=!1,ke=!1,be=$.internal_flags.nogap_total,Ke=$.internal_flags.nogap_current,ot=$.ATHtype,lt=0,ct;switch($.VBR){case vbr_abr:ct=$.VBR_mean_bitrate_kbps;break;case vbr_off:ct=$.brate;break;default:ct=$.VBR_min_bitrate_kbps}switch($.VBR.ordinal()<qe.length?ce=qe[$.VBR.ordinal()]:ce=0,Me=16*de+ce,Y.findReplayGain&&(Y.RadioGain>510&&(Y.RadioGain=510),Y.RadioGain<-510&&(Y.RadioGain=-510),Xe=8192,Xe|=3072,Y.RadioGain>=0?Xe|=Y.RadioGain:(Xe|=512,Xe|=-Y.RadioGain)),Y.findPeakSample&&(Ae=Math.abs(0|Y.PeakSample/32767*Math.pow(2,23)+.5)),be!=-1&&(Ke>0&&(ke=!0),Ke<be-1&&(Se=!0)),lt=ot+((Be?1:0)<<4)+((me?1:0)<<5)+((Se?1:0)<<6)+((ke?1:0)<<7),ne<0&&(ne=0),$.mode){case MONO:pt=0;break;case STEREO:pt=1;break;case DUAL_CHANNEL:pt=2;break;case JOINT_STEREO:$.force_ms?pt=4:pt=3;break;case NOT_SET:default:pt=7;break}$.in_samplerate<=32e3?Ue=0:$.in_samplerate==48e3?Ue=2:$.in_samplerate>48e3?Ue=3:Ue=1,($.short_blocks==nie.short_block_forced||$.short_blocks==nie.short_block_dispensed||$.lowpassfreq==-1&&$.highpassfreq==-1||$.scale_left<$.scale_right||$.scale_left>$.scale_right||$.disable_reservoir&&$.brate<320||$.noATH||$.ATHonly||ot==0||$.in_samplerate<=32e3)&&(oe=1),Ge=at+(pt<<2)+(oe<<5)+(Ue<<6),ze=Y.nMusicCRC,k(Q,W+ae,ne),ae+=4;for(var Vt=0;Vt<9;Vt++)Q[W+ae+Vt]=255&le.charAt(Vt);ae+=9,Q[W+ae]=255&Me,ae++,Q[W+ae]=255&Ne,ae++,k(Q,W+ae,Ae),ae+=4,N(Q,W+ae,Xe),ae+=2,N(Q,W+ae,$e),ae+=2,Q[W+ae]=255&lt,ae++,ct>=255?Q[W+ae]=255:Q[W+ae]=255&ct,ae++,Q[W+ae]=255&Z>>4,Q[W+ae+1]=255&(Z<<4)+(K>>8),Q[W+ae+2]=255&K,ae+=3,Q[W+ae]=255&Ge,ae++,Q[W+ae++]=0,N(Q,W+ae,$.preset),ae+=2,k(Q,W+ae,U),ae+=4,N(Q,W+ae,ze),ae+=2;for(var Ot=0;Ot<ae;Ot++)q=G(Q[W+Ot],q);return N(Q,W+ae,q),ae+=2,ae}function B($){$.seek(0);var U=DN(10);$.readFully(U);var Q;return new String(U,"ISO-8859-1").startsWith("ID3")?Q=0:Q=((U[6]&127)<<21|(U[7]&127)<<14|(U[8]&127)<<7|U[9]&127)+U.length,Q}this.getLameTagFrame=function($,U){var Q=$.internal_flags;if(!$.bWriteVbrTag||Q.Class_ID!=Lame.LAME_ID||Q.VBR_seek_table.pos<=0)return 0;if(U.length<Q.VBR_seek_table.TotalFrameSize)return Q.VBR_seek_table.TotalFrameSize;Tut.fill(U,0,Q.VBR_seek_table.TotalFrameSize,0),V($,U);var W=DN(o);if($.free_format)for(var q=1;q<o;++q)W[q]=255&255*q/100;else E(Q.VBR_seek_table,W);var Y=Q.sideinfo_len;$.error_protection&&(Y-=2),$.VBR==DF.vbr_off?(U[Y++]=255&y.charAt(0),U[Y++]=255&y.charAt(1),U[Y++]=255&y.charAt(2),U[Y++]=255&y.charAt(3)):(U[Y++]=255&_.charAt(0),U[Y++]=255&_.charAt(1),U[Y++]=255&_.charAt(2),U[Y++]=255&_.charAt(3)),k(U,Y,r+i+s+a),Y+=4,k(U,Y,Q.VBR_seek_table.nVbrNumFrames),Y+=4;var ae=Q.VBR_seek_table.nBytesWritten+Q.VBR_seek_table.TotalFrameSize;k(U,Y,0|ae),Y+=4,xut.arraycopy(W,0,U,Y,W.length),Y+=W.length,$.error_protection&&e.CRC_writeheader(Q,U);for(var Z=0,q=0;q<Y;q++)Z=G(U[q],Z);return Y+=J($,ae,U,Y,Z),Q.VBR_seek_table.TotalFrameSize},this.putVbrTag=function($,U){var Q=$.internal_flags;if(Q.VBR_seek_table.pos<=0||(U.seek(U.length()),U.length()==0))return-1;var W=B(U);U.seek(W);var q=DN(l),Y=getLameTagFrame($,q);return Y>q.length?-1:(Y<1||U.write(q,0,Y),0)}}var Rut=ik,aye=Rc,rie=aye.new_byte,Aut=aye.assert,Cut=oG(),Mut=aut,Out=eye,kut=rye(),Iut=_ut,Nut=iye(),Put=but,Dut=v3,Lut=aG();ap();var Uut=Eut,But=Rut;function Fut(){this.setModules=function(n,e){}}function zut(){this.setModules=function(n,e,t){}}function jut(){}function Hut(){this.setModules=function(n,e){}}function qut(n,e,t){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),n=1,e=44100,t=128);var r=new Cut,i=new Fut,s=new Out,a=new Lut,o=new Mut,l=new kut,c=new Iut,u=new But,f=new Uut,h=new Hut,g=new Put,p=new Nut,_=new zut,y=new jut;r.setModules(s,a,o,l,c,u,f,h,y),a.setModules(s,y,f,u),h.setModules(a,f),o.setModules(r),c.setModules(a,g,l,p),l.setModules(p,g,r.enc.psy),g.setModules(a),p.setModules(l),u.setModules(r,a,f),i.setModules(_,y),_.setModules(f,h,o);var v=r.lame_init();v.num_channels=n,v.in_samplerate=e,v.brate=t,v.mode=Dut.STEREO,v.quality=3,v.bWriteVbrTag=!1,v.disable_reservoir=!0,v.write_id3tag_automatic=!1,r.lame_init_params(v);var x=1152,E=0|1.25*x+7200,M=rie(E);this.encodeBuffer=function(k,N){n==1&&(N=k),Aut(k.length==N.length),k.length>x&&(x=k.length,E=0|1.25*x+7200,M=rie(E));var I=r.lame_encode_buffer(v,k,N,k.length,M,0,E);return new Int8Array(M.subarray(0,I))},this.flush=function(){var k=r.lame_encode_flush(v,M,0,E);return new Int8Array(M.subarray(0,k))}}function vv(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function O6(n){return n.charCodeAt(0)<<24|n.charCodeAt(1)<<16|n.charCodeAt(2)<<8|n.charCodeAt(3)}vv.RIFF=O6("RIFF");vv.WAVE=O6("WAVE");vv.fmt_=O6("fmt ");vv.data=O6("data");vv.readHeader=function(n){var e=new vv,t=n.getUint32(0,!1);if(vv.RIFF==t&&(n.getUint32(4,!0),vv.WAVE==n.getUint32(8,!1)&&vv.fmt_==n.getUint32(12,!1))){var r=n.getUint32(16,!0),i=20;switch(r){case 16:case 18:e.channels=n.getUint16(i+2,!0),e.sampleRate=n.getUint32(i+4,!0);break;default:throw"extended fmt chunk not implemented"}i+=r;for(var s=vv.data,a=0;s!=t&&(t=n.getUint32(i,!1),a=n.getUint32(i+4,!0),s!=t);)i+=a+8;return e.dataLen=a,e.dataOffset=i+8,e}};var Vut=qut;async function Gut(n){const e=as(),t=n.getChannelData(0),r=n.sampleRate,i=new Vut(1,r,128),s=1152,a=[];for(let l=0;l<t.length;l+=s){a.length%64===0&&ts(St,e,`encoding chunk (${l}/${t.length})`);const c=new Int16Array(s);for(let f=0;f<s;f++)l+f<t.length&&(c[f]=t[l+f]<0?t[l+f]*32768:t[l+f]*32767);const u=i.encodeBuffer(c);u.length>0&&a.push(u),a.length%16===0&&await Ch(10)}const o=i.flush();return o.length>0&&a.push(o),ts(St,e,`total chunks ${a.length+1}`),await Ch(100),new Uint8Array(a.reduce((l,c)=>{const u=new Uint8Array(l.length+c.length);return u.set(l,0),u.set(c,l.length),u},new Uint8Array(0)))}const iie=4,$ut={a:1,b:2,c:3,d:4,e:5,f:6,g:7,x:8,A:1,B:2,C:3,D:4,E:5,F:6,G:7,X:8,"#":9,"!":10,y:13,t:14,s:15,i:16,q:17,h:18,w:19,Y:13,T:14,S:15,I:16,Q:17,H:18,W:19,3:20,".":21,"+":11,"-":12,0:22,1:23,2:24,p:25,4:26,5:27,6:29,7:28,8:30,9:31},oye="64n";function Wut(n){return Rh({[oye]:n}).toNotation()}function Yut(n){return Rh({[oye]:n}).toSeconds()}function Xut(n,e,t,r=!0){let i=e,s=4,a=2,o="",l="";const c=[];function u(){l="",o="",i+=Yut(a)}function f(){const h=Wut(a);l===null?(c.push([i,[n,h,l]]),u()):Mn(l)?(c.push([i,[n,h,l]]),u()):l.startsWith("#")?(c.push([i,[n,h,l]]),u()):l!==""&&(c.push([i,[n,h,`${l}${o}${s}`]]),u())}if(Vn(t))l=t;else for(let h=0;h<t.length;++h){switch(t[h]){case 9:case 10:break;default:f();break}switch(t[h]){case 1:l="A";break;case 2:l="B";break;case 3:l="C";break;case 4:l="D";break;case 5:l="E";break;case 6:l="F";break;case 7:l="G";break;case 8:l=null;break;case 9:o+="#";break;case 10:o+="b";break;case 11:s<8&&++s;break;case 12:s>0&&--s;break;case 13:a=1;break;case 14:a=2;break;case 15:a=4;break;case 16:a=8;break;case 17:a=16;break;case 18:a=32;break;case 19:a=64;break;case 20:a=Math.round(a/3);break;case 21:a=Math.round(a*3/2);break;case 22:l=0;break;case 23:l=1;break;case 24:l=2;break;case 25:l=3;break;case 26:l=4;break;case 27:l=5;break;case 29:l=6;break;case 28:l=7;break;case 30:l=8;break;case 31:l=9;break}}return f(),r&&c.push([i,[n,"8n",-1]]),c}function sie(n){const e=[],t=n.split(";");for(let r=0;r<t.length;++r){const i=[],s=t[r];if(s.startsWith("#"))e.push(s);else{for(let a=0;a<s.length;++a){const o=$ut[s[a]];xe(o)&&i.push(o)}e.push(i)}}return e}const Kut="/assets/sidechainworklet-ByNOiUo8.js";class lG extends Wm{name="SidechainCompressor";threshold;ratio;attack;release;mix;makeupGain;sidechain=new qi;_audioworkletnode=this.context.createAudioWorkletNode("sidechaincompressorprocessor",{numberOfInputs:2,outputChannelCount:[2]});constructor(){const e=pr(lG.getDefaults(),arguments,["threshold","ratio","attack","release","mix","makeupGain"]);super(e),this.threshold=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("threshold"),value:e.threshold,minValue:-128,maxValue:0}),this.ratio=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("ratio"),value:e.ratio,minValue:1,maxValue:128}),this.attack=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("attack"),value:e.attack,minValue:1e-4,maxValue:128}),this.release=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("release"),value:e.release,minValue:1e-4,maxValue:128}),this.mix=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("mix"),value:e.mix,minValue:0,maxValue:1}),this.makeupGain=new Hi({context:this.context,param:this._audioworkletnode.parameters.get("makeupGain"),value:e.makeupGain,minValue:-128,maxValue:60}),this.connectEffect(this._audioworkletnode),this.sidechain.connect(this._audioworkletnode,0,1)}static getDefaults(){return Object.assign(Wm.getDefaults(),{threshold:-28,ratio:4,attack:.005,release:.005,mix:1,makeupGain:0})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}function Zut(){return oc().rawContext.audioWorklet.addModule(Kut)}var Do=(n=>(n[n.SYNTH=0]="SYNTH",n[n.RETRO_NOISE=1]="RETRO_NOISE",n[n.BUZZ_NOISE=2]="BUZZ_NOISE",n[n.CLANG_NOISE=3]="CLANG_NOISE",n[n.METALLIC_NOISE=4]="METALLIC_NOISE",n[n.BELLS=5]="BELLS",n[n.DOOT=6]="DOOT",n))(Do||{});const aie=131072;function Jut(n){const e=oc().createBuffer(1,aie,oc().sampleRate);let t=1;const r=e.getChannelData(0);for(let i=0;i<aie;i++){n===4?r[i]=(t&1)*4*(Math.random()*14+1)-8:r[i]=(t&1)*2-1;let s=t>>1;if((t+s&1)==1)switch(n){default:case 1:s+=16384;break;case 3:s+=32768;break;case 2:s+=40;break;case 4:s+=60;break}t=s}return e}function Oy(n){let e,t;function r(){switch(e?.type){case 0:{e.synth.set({...t,envelope:{...t.envelope,attack:.01,decay:.01,sustain:.5,release:.01},oscillator:{...t.oscillator,type:"square"}});break}case 1:{e.synth.set({...t,attack:.01,decay:.01,sustain:.5,release:.01});break}case 5:{e.synth.set({...t,harmonicity:1.5,modulationIndex:30,oscillator:{type:"sine"},modulation:{type:"square"},envelope:{attack:.01,decay:3,sustain:.3,release:6},modulationEnvelope:{attack:.5,decay:1,sustain:.2,release:4}});break}case 6:{e.synth.set({...t});break}}}function i(){return{type:e?.type,synth:e?.synth.get()}}function s(o){e?.synth.set(o.synth)}function a(){e?.synth.dispose()}switch(n){case 0:return e={type:n,synth:new Xd},t=El(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 1:case 2:case 3:case 4:return e={type:n,synth:new m3({volume:-44,urls:{C4:Jut(n)}}),filter1:new Bw({type:"lowshelf",gain:-32,frequency:440}),filter2:new Bw({type:"highshelf",gain:32,frequency:440})},t=El(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 5:return e={type:5,synth:new FV,sparkle:new zV({volume:-16,envelope:{attack:.001,decay:1.4,release:.321},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5})},t=El(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 6:return e={type:n,synth:new mR},t=El(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a}}}async function lye(){await lct(),await Zut()}function cye(){const n=dlt(),e=new Sm;e.connect(n);let t;oc().isOffline||(t=oc().createMediaStreamDestination(),e.connect(t));const r=new qi(10),i=new R6({maxDelay:.005,frequency:1.5,depth:.2,type:"sine",wet:.6}),s=new WV({frequency:.6,delayTime:7,depth:.7,type:"sine",spread:128,wet:.5}),a=new $E({type:"pink",volume:-42}),o=new Sm,l=new DV,c=new Hc(Math.PI*.25,"sine");c.chain(l,o.volume),c.start(),a.start(),a.chain(o,s),i.chain(s,e);const u=new QV({threshold:-24,ratio:4,attack:.003,release:.25,knee:30});r.chain(u,i);const f=new lG({threshold:-42,ratio:4,attack:.005,release:.005,mix:.777,makeupGain:24});f.connect(r);const h=new Sm(-12),g=new Sm(-32),p=new Sm(Cp(20));p.connect(f);const _=new Sm(Cp(100));_.connect(r);const y=new Sm;y.connect(r),y.connect(h);const v=new Sm;v.connect(r),v.connect(h),h.connect(f.sidechain),g.connect(f.sidechain);const x=[Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH),Oy(Do.SYNTH)],E=cct(),M=[EF(1),EF(2),EF(3)];for(let $e=0;$e<M.length;++$e){const at=M[$e];at.fc.connect(E.fc),at.echo.connect(E.echo),at.reverb.connect(E.reverb),at.phaser.connect(E.phaser),at.vibrato.connect(E.vibrato),at.distortion.connect(E.distortion),at.autowah.connect(E.autowah);const oe=$e<2?p:y;E.fc.connect(oe),E.echo.connect(oe),E.reverb.connect(oe),E.phaser.connect(oe),E.vibrato.connect(oe),E.distortion.connect(oe),E.autowah.connect(oe)}function k($e){return $e<4?Math.floor($e/2):2}function N($e){const at=k($e),oe=$e<4?p:y;switch(x[$e]?.source.type){case Do.RETRO_NOISE:case Do.BUZZ_NOISE:case Do.CLANG_NOISE:case Do.METALLIC_NOISE:break;default:x[$e]?.source.synth.connect(oe),x[$e]?.source.synth.connect(M[at].sendtofx);break}switch(x[$e]?.source.type){case Do.RETRO_NOISE:case Do.BUZZ_NOISE:case Do.CLANG_NOISE:case Do.METALLIC_NOISE:x[$e]?.source.synth.chain(x[$e]?.source.filter1,x[$e]?.source.filter2,oe),x[$e]?.source.synth.chain(x[$e]?.source.filter1,x[$e]?.source.filter2,M[at].sendtofx);break;case Do.BELLS:{x[$e]?.source.sparkle.connect(oe),x[$e]?.source.sparkle.connect(M[at].sendtofx);break}}}for(let $e=0;$e<x.length;++$e)N($e);function I($e,at){x[$e]?.source.type!==at&&(x[$e]?.source.synth.dispose(),x[$e]=Oy(at),N($e))}const D=act(_,g);let V=new tk(W),G=0,J=0,B=[];function $($e,at,pt){$e.forEach((oe,Ue)=>{I(Ue,oe.type),x[Ue].setreplay(oe)}),E.setreplay(at),pt.forEach((oe,Ue)=>{M[Ue].setreplay(oe)})}function U(){B=[],G=0,J=0}function Q($e){if(B.length){const at=as(),pt=B.map(be=>{const[Ke]=be;return Ke}),oe=Math.min(...pt),Ue=Math.max(...pt),Ge=Math.ceil(Ue-oe+5),ze=[];for(let be=0;be<B.length;++be){const[Ke,ot]=B[be];ze.push([Ke-oe+.1,ot])}const Be=x.map(be=>be.getreplay()),me=E.getreplay(),Se=M.map(be=>be.getreplay());let ke;Qot(async({transport:be})=>{ts(St,at,"create synth"),await lye(),ke=cye(),ts(St,at,"synth waiting for setup"),await Ch(2e3),ke.setplayvolume(40),ke.applyreplay(Be,me,Se),ke.synthreplay(ze,Ue),ts(St,at,"rendering audio"),be.start(0)},Ge).then(be=>(ts(St,at,"rendering complete, exporting mp3"),Gut(be))).then(be=>{const Ke=document.createElement("a");Ke.href=URL.createObjectURL(new Blob([be],{type:"audio/mp3"})),Ke.download=`${$e||Ice()}.mp3`,ts(St,at,`saving file ${Ke.download}`),Ke.click(),ke?.destroy()}).catch(be=>{xi(St,at,"synthrecord",be)})}U()}function W($e,at){if(at===null)return;if(J>0){const ze=Math.round($e/J*100);ze!==G&&(G=ze,ts(St,as(),`${ze}%`))}else B.push([$e,at]);const[pt,oe,Ue]=at,Ge=k(pt);if(Vn(Ue)&&xe(x[pt])&&xe(M[Ge]))if(Ue.startsWith("#"))plt().schedule(()=>dIe(St,"",Ue.slice(1)),$e);else{switch(x[pt].source.type){case Do.BELLS:x[pt].source.synth.detune.value=Og(-3,3),x[pt].source.sparkle.triggerAttackRelease(rct(Ue,2),oe,$e);break}x[pt].source.synth.triggerAttackRelease(Ue,oe,$e);const ze=x[pt].source.synth.toSeconds(oe),Be="128n",me=x[pt].source.synth.toSeconds(Be);E.vibrato.depth.rampTo(1,"2n",$e),E.vibrato.depth.rampTo(0,Be,$e+ze-me),E.vibrato.frequency.rampTo(5,"4n",$e),E.vibrato.frequency.rampTo(1,Be,$e+ze-me)}if(Mn(Ue))switch(Ue){case 0:D.ticktrigger($e);break;case 1:D.tweettrigger($e);break;case 2:D.cowbelltrigger(oe,$e);break;case 3:D.claptrigger(oe,$e);break;case 4:D.hisnaretrigger(oe,$e);break;case 5:D.hiwoodblocktrigger(oe,$e);break;case 6:D.lowsnaretrigger(oe,$e);break;case 7:D.lowtomtrigger(oe,$e);break;case 8:D.lowwoodblocktrigger(oe,$e);break;case 9:D.basstrigger($e);break;case-1:--Z,Z===0&&(V.clear(),ae=-1);break}}function q($e,at,pt,oe=!0){let Ue=at;const Ge=Xut($e,at,pt,oe),ze=Ge[Ge.length-1];xe(ze)&&(Ue=Math.max(Ue,ze[0]));for(let Be=0;Be<Ge.length;++Be){const[me,Se]=Ge[Be];V.add(me,Se)}return Ue}function Y($e,at){G=0,J=at;for(let pt=0;pt<$e.length;++pt){const[oe,Ue]=$e[pt];V.add(oe,Ue)}}let ae=-1,Z=0,K=iie;function ne($e){const at=sie($e);ae===-1&&(ae=Sz().now()),Z+=at.length;const pt=ae;for(let oe=0;oe<at.length&&oe<x.length;++oe){const Ue=q(oe,pt,at[oe]);ae=Math.max(ae,Ue)}}function le($e,at){const pt=sie($e),oe=Rh(at||"+0.05").toSeconds();for(let Ue=0;Ue<pt.length;++Ue)q(K++,oe,pt[Ue],!1),K>=x.length&&(K=iie)}function ce(){V.clear(),ae=-1,Z=0}function de($e){ce(),Sz().bpm.setValueAtTime($e,0),V=new tk(W),V.start(0)}function Me($e){e.volume.value=Cp($e*.25)}function qe($e){y.volume.value=Cp($e)}function Ne($e){new p3($e).connect(v).start(0)}function Ae($e){v.volume.value=$e}Ae(25),Me(80),qe(100),V.start(0);function Xe(){x.forEach($e=>$e.destroy()),M.forEach($e=>$e.destroy()),E.destroy(),e.dispose()}return{destroy:Xe,broadcastdestination:t,addplay:ne,addbgplay:le,stopplay:ce,applyreplay:$,synthrecord:Q,synthflush:U,synthreplay:Y,addttsaudiobuffer:Ne,setbpm:de,setplayvolume:Me,setbgplayvolume:qe,setttsvolume:Ae,SOURCE:x,FX:M,FXCHAIN:E,changesource:I}}const Qut=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]+/,eft=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]*/;function tft(n,e){if(Vn(n)){const t=Vr(n);if(Qut.test(t))return ui(e);switch(t){case"pwm":case"pulse":case"retro":case"buzz":case"clang":case"metallic":case"bells":case"doot":return!0;default:return eft.test(t)}}return!1}function nft(n,e,t,r,i){if(!xe(e))return;const s=e.SOURCE[t];if(!xe(s)){xi(St,n,"synth",`unknown voice ${t}`);return}switch(r){case"reset":case"restart":s.applyreset();return;case"vol":case"volume":Mn(i)&&(s.source.synth.volume.value=i);return;case"port":case"portamento":if(Mn(i))switch(s.source.type){case Do.SYNTH:s.source.synth.portamento=i;break;case Do.RETRO_NOISE:xi(St,n,"synth","portamento for retro synth not supported");break}return;case"env":case"envelope":if(ui(i)){const[a,o,l,c]=i;s.source.synth.set({envelope:{attack:a,decay:o,sustain:l,release:c}})}return;default:if(Vn(r)){if(tft(r,i)){switch(r){case"retro":e.changesource(t,Do.RETRO_NOISE);break;case"buzz":e.changesource(t,Do.BUZZ_NOISE);break;case"clang":e.changesource(t,Do.CLANG_NOISE);break;case"metallic":e.changesource(t,Do.METALLIC_NOISE);break;case"bells":e.changesource(t,Do.BELLS);break;case"doot":e.changesource(t,Do.DOOT);break;default:e.changesource(t,Do.SYNTH),s.source.synth.set({oscillator:{type:r}}),ui(i)&&s.source.synth.set({oscillator:{type:r,partials:i,partialCount:i.length}}),Mn(i)&&s.source.synth.set({oscillator:{type:r,partials:[i],partialCount:1}});break}return}switch(s.source.type){case Do.SYNTH:{switch(s.source.synth.get().oscillator.type){case"pwm":switch(r){case"modfreq":case"modulationfrequency":Mn(i)&&s.source.synth.set({oscillator:{modulationFrequency:i}});return}break;case"pulse":switch(r){case"width":Mn(i)&&s.source.synth.set({oscillator:{width:i}});return}break;case"custom":case"sine":case"square":case"triangle":case"sawtooth":switch(r){case"phase":Mn(i)&&s.source.synth.set({oscillator:{phase:i}});return}break;case"amcustom":case"amsine":case"amsquare":case"amtriangle":case"amsawtooth":switch(r){case"harmonicity":Mn(i)&&s.source.synth.set({oscillator:{harmonicity:i}});return;case"modtype":case"modulationtype":Vn(i)&&s.source.synth.set({oscillator:{modulationType:i}});return;case"modenv":case"modulationenvelope":if(ui(i)){const[o,l,c,u]=i;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:l,sustain:c,release:u}}});return}break}break;case"fmcustom":case"fmsine":case"fmsquare":case"fmtriangle":case"fmsawtooth":switch(r){case"harmonicity":if(Mn(i)){s.source.synth.set({oscillator:{harmonicity:i}});return}break;case"modindex":if(Mn(i)){s.source.synth.set({oscillator:{modulationIndex:i}});return}break;case"modtype":if(Vn(i)){s.source.synth.set({oscillator:{modulationType:i}});return}break;case"modenv":if(ui(i)){const[o,l,c,u]=i;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:l,sustain:c,release:u}}});return}break}break;case"fatcustom":case"fatsine":case"fatsquare":case"fattriangle":case"fatsawtooth":switch(r){case"count":if(Mn(i)){s.source.synth.set({oscillator:{count:i}});return}break;case"phase":if(Mn(i)){s.source.synth.set({oscillator:{phase:i}});return}break;case"spread":if(Mn(i)){s.source.synth.set({oscillator:{spread:i}});return}break}break}return}}xi(St,n,"synth",`unknown config ${r}`)}break}}function rft(n,e,t,r,i){if(!xe(e))return;if(t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.autowah;switch(r){case"basefrequency":if(Mn(i)){s.set({baseFrequency:i});return}break;case"octaves":if(Mn(i)){s.set({octaves:i});return}break;case"sensitivity":if(Mn(i)){s.set({sensitivity:i});return}break;case"gain":if(Mn(i)){s.set({gain:i});return}break;case"follower":if(Mn(i)){s.set({follower:i});return}break}xi(St,n,"synth",`unknown autowah config ${r} with ${i}`)}function ift(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.distortion;switch(r){case"distortion":if(Mn(i)){s.set({distortion:i});return}break;case"oversample":if(Vn(i)){s.set({oversample:i});return}break}xi(St,n,"kind",`unknown distortion ${r} or ${i}`)}function sft(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.echo;switch(r){case"delaytime":if(Mn(i)){s.set({delayTime:i});return}break;case"feedback":if(Mn(i)){s.set({feedback:i});return}break}xi(St,n,"kind",`unknown echo ${r} or ${i}`)}function aft(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.fcrush;switch(r){case"rate":if(Mn(i)){s.set({rate:i});return}break}xi(St,n,"kind",`unknown fcrush ${r} or ${i}`)}function oft(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.phaser;switch(r){case"frequency":if(Mn(i)){s.set({frequency:i});return}break;case"octaves":if(Mn(i)){s.set({octaves:i});return}break;case"basefrequency":s.set({baseFrequency:i});return}xi(St,n,"kind",`unknown phaser ${r} or ${i}`)}function lft(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.reverb;switch(r){case"decay":if(Mn(i)){s.set({decay:i});return}break;case"predelay":if(Mn(i)){s.set({preDelay:i});return}break}xi(St,n,"kind",`unknown reverb ${r} or ${i}`)}function cft(n,e,t,r,i){if(!xe(e))return;if(t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.vibrato;switch(r){case"maxdelay":if(Mn(i)){s.set({maxDelay:i});return}break}xi(St,n,"synth",`unknown vibrato config ${r} with ${i}`)}function uft(n,e,t,r,i,s){if(!xe(e))return;if(t<0||t>=e.FX.length){xi(St,n,"synth",`index ${t} out of bounds`);return}const a=e.FX[t][r];if(xe(a)){switch(i){case"on":switch(r){case"vibrato":a.volume.value=Cp(80);break;default:a.volume.value=Cp(20);break}break;case"off":a.volume.value=Cp(0);break;default:if(Mn(i))a.volume.value=Cp(i);else switch(r){case"fc":case"fcrush":aft(n,e,t,i,s);break;case"echo":sft(n,e,t,i,s);break;case"phaser":oft(n,e,t,i,s);break;case"reverb":lft(n,e,t,i,s);break;case"distort":case"distortion":ift(n,e,t,i,s);break;case"vibrato":cft(n,e,t,i,s);break;case"autowah":rft(n,e,t,i,s);break}break}return}xi(St,n,"synth",`unknown fx ${r}`)}let LF=Promise,uye=n=>{let e=0,t=0,r,i,s,a,o=()=>{e--,--t?l():a=s?.()},l=()=>{if(r&&e<n){e++;let c=r;r=r.a,c.p().then(u=>(c.b(u),o()),u=>(c.c(u),o()))}};return{add(c){let u={p:c},f=new LF((h,g)=>{u.b=h,u.c=g});return r?i=i.a=u:i=r=u,t++,l(),f},done:()=>t?a||(a=new LF(c=>s=c)):LF.resolve(),clear(){r=i=null,t=e},active:()=>e,size:()=>t}};const PP={"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-KatjaNeural","de-DE-KillianNeural"],"en-US":["en-US-AriaNeural","en-US-AnaNeural","en-US-ChristopherNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"ko-KR":["ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-YunJheNeural","zh-TW-HsiaoYuNeural"]},DP={"ar-SA-HamedNeural":"حامد","ar-SA-ZariyahNeural":"زارية","de-DE-AmalaNeural":"Amala","de-DE-BerndNeural":"Bernd","de-DE-ChristophNeural":"Christoph","de-DE-ConradNeural":"Conrad","de-DE-ElkeNeural":"Elke","de-DE-GiselaNeural":"Gisela","de-DE-KasperNeural":"Kasper","de-DE-KatjaNeural":"Katja","de-DE-KillianNeural":"Killian","de-DE-KlarissaNeural":"Klarissa","de-DE-KlausNeural":"Klaus","de-DE-LouisaNeural":"Louisa","de-DE-MajaNeural":"Maja","de-DE-RalfNeural":"Ralf","de-DE-TanjaNeural":"Tanja","en-US-AIGenerate1Neural":"AIGenerate1","en-US-AIGenerate2Neural":"AIGenerate2","en-US-AmberNeural":"Amber","en-US-AnaNeural":"Ana","en-US-AndrewNeural":"Andrew","en-US-AriaNeural":"Aria","en-US-AshleyNeural":"Ashley","en-US-BlueNeural":"Blue","en-US-BrandonNeural":"Brandon","en-US-BrianNeural":"Brian","en-US-ChristopherNeural":"Christopher","en-US-CoraNeural":"Cora","en-US-DavisNeural":"Davis","en-US-ElizabethNeural":"Elizabeth","en-US-EmmaNeural":"Emma","en-US-EricNeural":"Eric","en-US-GuyNeural":"Guy","en-US-JacobNeural":"Jacob","en-US-JaneNeural":"Jane","en-US-JasonNeural":"Jason","en-US-JennyMultilingualNeural":"Jenny Multilingual","en-US-JennyMultilingualV2Neural":"Jenny Multilingual V2","en-US-JennyNeural":"Jenny","en-US-MichelleNeural":"Michelle","en-US-MonicaNeural":"Monica","en-US-NancyNeural":"Nancy","en-US-RogerNeural":"Roger","en-US-RyanMultilingualNeural":"Ryan Multilingual","en-US-SaraNeural":"Sara","en-US-SteffanNeural":"Steffan","en-US-TonyNeural":"Tony","es-ES-AbrilNeural":"Abril","es-ES-AlvaroNeural":"Álvaro","es-ES-ArnauNeural":"Arnau","es-ES-DarioNeural":"Dario","es-ES-EliasNeural":"Elias","es-ES-ElviraNeural":"Elvira","es-ES-EstrellaNeural":"Estrella","es-ES-IreneNeural":"Irene","es-ES-LaiaNeural":"Laia","es-ES-LiaNeural":"Lia","es-ES-NilNeural":"Nil","es-ES-SaulNeural":"Saul","es-ES-TeoNeural":"Teo","es-ES-TrianaNeural":"Triana","es-ES-VeraNeural":"Vera","fr-FR-AlainNeural":"Alain","fr-FR-BrigitteNeural":"Brigitte","fr-FR-CelesteNeural":"Celeste","fr-FR-ClaudeNeural":"Claude","fr-FR-CoralieNeural":"Coralie","fr-FR-DeniseNeural":"Denise","fr-FR-EloiseNeural":"Eloise","fr-FR-HenriNeural":"Henri","fr-FR-JacquelineNeural":"Jacqueline","fr-FR-JeromeNeural":"Jerome","fr-FR-JosephineNeural":"Josephine","fr-FR-MauriceNeural":"Maurice","fr-FR-YvesNeural":"Yves","fr-FR-YvetteNeural":"Yvette","ja-JP-AoiNeural":"碧衣","ja-JP-DaichiNeural":"大智","ja-JP-KeitaNeural":"圭太","ja-JP-MayuNeural":"真夕","ja-JP-NanamiNeural":"七海","ja-JP-NaokiNeural":"直紀","ja-JP-ShioriNeural":"志織","ko-KR-BongJinNeural":"봉진","ko-KR-GookMinNeural":"국민","ko-KR-InJoonNeural":"인준","ko-KR-JiMinNeural":"지민","ko-KR-SeoHyeonNeural":"서현","ko-KR-SoonBokNeural":"순복","ko-KR-SunHiNeural":"선히","ko-KR-YuJinNeural":"유진","pt-BR-AntonioNeural":"Antônio","pt-BR-BrendaNeural":"Brenda","pt-BR-DonatoNeural":"Donato","pt-BR-ElzaNeural":"Elza","pt-BR-FabioNeural":"Fabio","pt-BR-FranciscaNeural":"Francisca","pt-BR-GiovannaNeural":"Giovanna","pt-BR-HumbertoNeural":"Humberto","pt-BR-JulioNeural":"Julio","pt-BR-LeilaNeural":"Leila","pt-BR-LeticiaNeural":"Leticia","pt-BR-ManuelaNeural":"Manuela","pt-BR-NicolauNeural":"Nicolau","pt-BR-ValerioNeural":"Valerio","pt-BR-YaraNeural":"Yara","ru-RU-DariyaNeural":"Дария","ru-RU-DmitryNeural":"Дмитрий","ru-RU-SvetlanaNeural":"Светлана","wuu-CN-XiaotongNeural":"晓彤","wuu-CN-YunzheNeural":"云哲","yue-CN-XiaoMinNeural":"晓敏","yue-CN-YunSongNeural":"云松","zh-CN-XiaochenNeural":"晓辰","zh-CN-XiaohanNeural":"晓涵","zh-CN-XiaomengNeural":"晓梦","zh-CN-XiaomoNeural":"晓墨","zh-CN-XiaoqiuNeural":"晓秋","zh-CN-XiaorouNeural":"晓柔","zh-CN-XiaoruiNeural":"晓睿","zh-CN-XiaoshuangNeural":"晓双","zh-CN-XiaoxiaoNeural":"晓晓","zh-CN-XiaoxuanNeural":"晓萱","zh-CN-XiaoyanNeural":"晓颜","zh-CN-XiaoyiNeural":"晓伊","zh-CN-XiaoyouNeural":"晓悠","zh-CN-XiaozhenNeural":"晓甄","zh-CN-YunfengNeural":"云枫","zh-CN-YunhaoNeural":"云皓","zh-CN-YunjianNeural":"云健","zh-CN-YunjieNeural":"云杰","zh-CN-YunxiNeural":"云希","zh-CN-YunxiaNeural":"云夏","zh-CN-YunyangNeural":"云扬","zh-CN-YunyeNeural":"云野","zh-CN-YunzeNeural":"云泽","zh-CN-guangxi-YunqiNeural":"云奇","zh-CN-henan-YundengNeural":"云登","zh-CN-liaoning-XiaobeiNeural":"晓北","zh-CN-liaoning-YunbiaoNeural":"云彪","zh-CN-shaanxi-XiaoniNeural":"晓妮","zh-CN-shandong-YunxiangNeural":"云翔","zh-CN-sichuan-YunxiNeural":"云希","zh-TW-HsiaoChenNeural":"曉臻","zh-TW-HsiaoYuNeural":"曉雨","zh-TW-YunJheNeural":"雲哲"};function s4(n){"@babel/helpers - typeof";return s4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s4(n)}function Tz(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Tz=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var h="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var k=Object.getPrototypeOf,N=k&&k(k(Q([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&s4(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=h;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=J(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===h)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function J(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,J(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function Q(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(s4(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=Q,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:Q(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function oie(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function fft(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){oie(s,r,i,a,o,"next",l)}function o(l){oie(s,r,i,a,o,"throw",l)}a(void 0)})}}var hft=(function(){var n=fft(Tz().mark(function e(t){var r;return Tz().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r=new AudioContext,s.next=3,r.decodeAudioData(t);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},e)}));return function(t){return n.apply(this,arguments)}})();const dft={"ar-SA":"العربية","de-DE":"Deutsch","en-US":"English","es-ES":"Español","fr-FR":"Français","ja-JP":"日本語","ko-KR":"한국어","pt-BR":"Português","ru-RU":"Русский","zh-CN":"简体中文","zh-TW":"繁體中文"};function pft(n,e){return vft(n)||_ft(n,e)||gft(n,e)||mft()}function mft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gft(n,e){if(n){if(typeof n=="string")return lie(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lie(n,e)}}function lie(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function _ft(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function vft(n){if(Array.isArray(n))return n}var yft=function(){return Object.entries(dft).map(function(e){var t=pft(e,2),r=t[0],i=t[1];return{label:i,value:r}})};const bft="modulepreload",Sft=function(n){return"/"+n},cie={},Eft=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let c=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};var a=c;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=c(t.map(u=>{if(u=Sft(u),u in cie)return;cie[u]=!0;const f=u.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":bft,f||(g.as="script"),g.crossOrigin="",g.href=u,l&&g.setAttribute("nonce",l),document.head.appendChild(g),f)return new Promise((p,_)=>{g.addEventListener("load",p),g.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},fye="%[a-f0-9]{2}",uie=new RegExp("("+fye+")|([^%]+?)","gi"),fie=new RegExp("("+fye+")+","gi");function wz(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;const t=n.slice(0,e),r=n.slice(e);return Array.prototype.concat.call([],wz(t),wz(r))}function xft(n){try{return decodeURIComponent(n)}catch{let e=n.match(uie)||[];for(let t=1;t<e.length;t++)n=wz(e,t).join(""),e=n.match(uie)||[];return n}}function Tft(n){const e={"%FE%FF":"��","%FF%FE":"��"};let t=fie.exec(n);for(;t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{const i=xft(t[0]);i!==t[0]&&(e[t[0]]=i)}t=fie.exec(n)}e["%C2"]="�";const r=Object.keys(e);for(const i of r)n=n.replace(new RegExp(i,"g"),e[i]);return n}function wft(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return decodeURIComponent(n)}catch{return Tft(n)}}function Rft(n,e){const t={};if(Array.isArray(e))for(const r of e){const i=Object.getOwnPropertyDescriptor(n,r);i?.enumerable&&Object.defineProperty(t,r,i)}else for(const r of Reflect.ownKeys(n)){const i=Object.getOwnPropertyDescriptor(n,r);if(i.enumerable){const s=n[r];e(r,s,n)&&Object.defineProperty(t,r,i)}}return t}function hye(n,e){if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(n===""||e==="")return[];const t=n.indexOf(e);return t===-1?[]:[n.slice(0,t),n.slice(t+e.length)]}const Aft=n=>n==null,Cft=n=>encodeURIComponent(n).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Rz=Symbol("encodeFragmentIdentifier");function Mft(n){switch(n.arrayFormat){case"index":return e=>(t,r)=>{const i=t.length;return r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[mf(e,n),"[",i,"]"].join("")]:[...t,[mf(e,n),"[",mf(i,n),"]=",mf(r,n)].join("")]};case"bracket":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[mf(e,n),"[]"].join("")]:[...t,[mf(e,n),"[]=",mf(r,n)].join("")];case"colon-list-separator":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[mf(e,n),":list="].join("")]:[...t,[mf(e,n),":list=",mf(r,n)].join("")];case"comma":case"separator":case"bracket-separator":{const e=n.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(r,i)=>i===void 0||n.skipNull&&i===null||n.skipEmptyString&&i===""?r:(i=i===null?"":i,r.length===0?[[mf(t,n),e,mf(i,n)].join("")]:[[r,mf(i,n)].join(n.arrayFormatSeparator)])}default:return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,mf(e,n)]:[...t,[mf(e,n),"=",mf(r,n)].join("")]}}function Oft(n){let e;switch(n.arrayFormat){case"index":return(t,r,i)=>{if(e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),!e){i[t]=r;return}i[t]===void 0&&(i[t]={}),i[t][e[1]]=r};case"bracket":return(t,r,i)=>{if(e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[...i[t],r]};case"colon-list-separator":return(t,r,i)=>{if(e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[...i[t],r]};case"comma":case"separator":return(t,r,i)=>{const s=typeof r=="string"&&r.includes(n.arrayFormatSeparator),a=typeof r=="string"&&!s&&zy(r,n).includes(n.arrayFormatSeparator);r=a?zy(r,n):r;const o=s||a?r.split(n.arrayFormatSeparator).map(l=>zy(l,n)):r===null?r:zy(r,n);i[t]=o};case"bracket-separator":return(t,r,i)=>{const s=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!s){i[t]=r&&zy(r,n);return}const a=r===null?[]:zy(r,n).split(n.arrayFormatSeparator);if(i[t]===void 0){i[t]=a;return}i[t]=[...i[t],...a]};default:return(t,r,i)=>{if(i[t]===void 0){i[t]=r;return}i[t]=[...[i[t]].flat(),r]}}}function dye(n){if(typeof n!="string"||n.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function mf(n,e){return e.encode?e.strict?Cft(n):encodeURIComponent(n):n}function zy(n,e){return e.decode?wft(n):n}function pye(n){return Array.isArray(n)?n.sort():typeof n=="object"?pye(Object.keys(n)).sort((e,t)=>Number(e)-Number(t)).map(e=>n[e]):n}function mye(n){const e=n.indexOf("#");return e!==-1&&(n=n.slice(0,e)),n}function kft(n){let e="";const t=n.indexOf("#");return t!==-1&&(e=n.slice(t)),e}function hie(n,e,t){return t==="string"&&typeof n=="string"?n:typeof t=="function"&&typeof n=="string"?t(n):t==="boolean"&&n===null?!0:t==="boolean"&&n!==null&&(n.toLowerCase()==="true"||n.toLowerCase()==="false")?n.toLowerCase()==="true":t==="boolean"&&n!==null&&(n.toLowerCase()==="1"||n.toLowerCase()==="0")?n.toLowerCase()==="1":t==="string[]"&&e.arrayFormat!=="none"&&typeof n=="string"?[n]:t==="number[]"&&e.arrayFormat!=="none"&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?[Number(n)]:t==="number"&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?Number(n):e.parseBooleans&&n!==null&&(n.toLowerCase()==="true"||n.toLowerCase()==="false")?n.toLowerCase()==="true":e.parseNumbers&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?Number(n):n}function cG(n){n=mye(n);const e=n.indexOf("?");return e===-1?"":n.slice(e+1)}function uG(n,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},dye(e.arrayFormatSeparator);const t=Oft(e),r=Object.create(null);if(typeof n!="string"||(n=n.trim().replace(/^[?#&]/,""),!n))return r;for(const i of n.split("&")){if(i==="")continue;const s=e.decode?i.replaceAll("+"," "):i;let[a,o]=hye(s,"=");a===void 0&&(a=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:zy(o,e),t(zy(a,e),o,r)}for(const[i,s]of Object.entries(r))if(typeof s=="object"&&s!==null&&e.types[i]!=="string")for(const[a,o]of Object.entries(s)){const l=e.types[i]?e.types[i].replace("[]",""):void 0;s[a]=hie(o,e,l)}else typeof s=="object"&&s!==null&&e.types[i]==="string"?r[i]=Object.values(s).join(e.arrayFormatSeparator):r[i]=hie(s,e,e.types[i]);return e.sort===!1?r:(e.sort===!0?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((i,s)=>{const a=r[s];return i[s]=a&&typeof a=="object"&&!Array.isArray(a)?pye(a):a,i},Object.create(null))}function gye(n,e){if(!n)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},dye(e.arrayFormatSeparator);const t=a=>e.skipNull&&Aft(n[a])||e.skipEmptyString&&n[a]==="",r=Mft(e),i={};for(const[a,o]of Object.entries(n))t(a)||(i[a]=o);const s=Object.keys(i);return e.sort!==!1&&s.sort(e.sort),s.map(a=>{const o=n[a];return o===void 0?"":o===null?mf(a,e):Array.isArray(o)?o.length===0&&e.arrayFormat==="bracket-separator"?mf(a,e)+"[]":o.reduce(r(a),[]).join("&"):mf(a,e)+"="+mf(o,e)}).filter(a=>a.length>0).join("&")}function _ye(n,e){e={decode:!0,...e};let[t,r]=hye(n,"#");return t===void 0&&(t=n),{url:t?.split("?")?.[0]??"",query:uG(cG(n),e),...e&&e.parseFragmentIdentifier&&r?{fragmentIdentifier:zy(r,e)}:{}}}function vye(n,e){e={encode:!0,strict:!0,[Rz]:!0,...e};const t=mye(n.url).split("?")[0]||"",r=cG(n.url),i={...uG(r,{sort:!1,...e}),...n.query};let s=gye(i,e);s&&=`?${s}`;let a=kft(n.url);if(typeof n.fragmentIdentifier=="string"){const o=new URL(t);o.hash=n.fragmentIdentifier,a=e[Rz]?o.hash:`#${n.fragmentIdentifier}`}return`${t}${s}${a}`}function yye(n,e,t){t={parseFragmentIdentifier:!0,[Rz]:!1,...t};const{url:r,query:i,fragmentIdentifier:s}=_ye(n,t);return vye({url:r,query:Rft(i,e),fragmentIdentifier:s},t)}function Ift(n,e,t){const r=Array.isArray(e)?i=>!e.includes(i):(i,s)=>!e(i,s);return yye(n,r,t)}const Nft=Object.freeze(Object.defineProperty({__proto__:null,exclude:Ift,extract:cG,parse:uG,parseUrl:_ye,pick:yye,stringify:gye,stringifyUrl:vye},Symbol.toStringTag,{value:"Module"})),gd=[];for(let n=0;n<256;++n)gd.push((n+256).toString(16).slice(1));function Pft(n,e=0){return(gd[n[e+0]]+gd[n[e+1]]+gd[n[e+2]]+gd[n[e+3]]+"-"+gd[n[e+4]]+gd[n[e+5]]+"-"+gd[n[e+6]]+gd[n[e+7]]+"-"+gd[n[e+8]]+gd[n[e+9]]+"-"+gd[n[e+10]]+gd[n[e+11]]+gd[n[e+12]]+gd[n[e+13]]+gd[n[e+14]]+gd[n[e+15]]).toLowerCase()}let UF;const Dft=new Uint8Array(16);function Lft(){if(!UF){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");UF=crypto.getRandomValues.bind(crypto)}return UF(Dft)}const Uft=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),die={randomUUID:Uft};function Bft(n,e,t){if(die.randomUUID&&!n)return die.randomUUID();n=n||{};const r=n.random??n.rng?.()??Lft();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Pft(r)}var Fft=function(e,t){var r=t.voice;return'<voice name="'.concat(r,'">').concat(e,"</voice>")},zft=function(e,t){var r=t.style;return r?'<mstts:express-as style="'.concat(r,'">').concat(e,"</mstts:express-as>"):e},jft=function(e,t){var r=t.pitch,i=t.rate;return!r&&!i?e:'<prosody pitch="'.concat(Math.floor((r||1)*100),'%" rate="').concat(Math.floor((i||1)*100),'%">').concat(e,"</prosody>")},Hft=function(e){return'<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US">'.concat(e,"</speak>")},qft=function(e,t){var r=jft(e,t);return r=zft(r,t),r=Fft(r,t),r=Hft(r),r};function Vft(n,e){return Yft(n)||Wft(n,e)||$ft(n,e)||Gft()}function Gft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ft(n,e){if(n){if(typeof n=="string")return pie(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return pie(n,e)}}function pie(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Wft(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Yft(n){if(Array.isArray(n))return n}var mie=function(e,t){for(var r=[],i=0,s=Object.entries(e);i<s.length;i++){var a=Vft(s[i],2),o=a[0],l=a[1];r.push("".concat(o,":").concat(l))}return r.push("",t),r.join(`\r
`)};function Xft(n,e){return Jft(n)||Zft(n,e)||bye(n,e)||Kft()}function Kft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zft(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Jft(n){if(Array.isArray(n))return n}function Qft(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=bye(n))||e){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return s=c.done,c},e:function(c){a=!0,o=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(a)throw o}}}}function bye(n,e){if(n){if(typeof n=="string")return gie(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gie(n,e)}}function gie(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var eht=function(e){var t={},r=Qft(e.slice(0,e.indexOf(`\r
\r
`)).split(`\r
`)),i;try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s.split(":",2),o=Xft(a,2),l=o[0],c=o[1];t[l]=c}}catch(u){r.e(u)}finally{r.f()}return{data:e.slice(e.indexOf(`\r
\r
`)+4),headers:t}};function a4(n){"@babel/helpers - typeof";return a4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a4(n)}function oE(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */oE=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var h="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var k=Object.getPrototypeOf,N=k&&k(k(Q([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&a4(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=h;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=J(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===h)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function J(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,J(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function Q(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(a4(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=Q,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:Q(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function _ie(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function Az(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){_ie(s,r,i,a,o,"next",l)}function o(l){_ie(s,r,i,a,o,"throw",l)}a(void 0)})}}var tht="wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1",Sye="6A5AA1D4EAFF4E9FB37E23D68491D6F4",nht="1-132.0.2957.140",rht=BigInt("11644473600"),iht=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),sht=function(e){var t=new Date().toString(),r={"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":t},i={"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":e,"X-Timestamp":t};return{configHeader:r,contentHeader:i}};function aht(){return Cz.apply(this,arguments)}function Cz(){return Cz=Az(oE().mark(function n(){var e,t,r,i,s;return oE().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=BigInt(Math.floor(Date.now()/1e3+Number(rht)))*BigInt("10000000"),t=e-e%BigInt("3000000000"),r=t+Sye,o.next=5,Eft(()=>import("./getSHA256-q1aNYYJS.js"),[]);case 5:return i=o.sent,s=i.hash(r),o.abrupt("return",s.toUpperCase());case 8:case"end":return o.stop()}},n)})),Cz.apply(this,arguments)}var Eye=(function(){var n=Az(oE().mark(function e(t){var r,i,s,a,o,l,c,u,f,h,g,p,_,y=arguments;return oE().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(r=t.payload,i=y.length>1&&y[1]!==void 0?y[1]:{},s=i.proxyUrl,a=i.token,o=r.input,l=r.options,c=Bft().replaceAll("-",""),x.t0=Nft,x.t1=c,!a){x.next=10;break}x.t2=a,x.next=13;break;case 10:return x.next=12,aht();case 12:x.t2=x.sent;case 13:return x.t3=x.t2,x.t4=a||nht,x.t5=a||Sye,x.t6={ConnectionId:x.t1,"Sec-MS-GEC":x.t3,"Sec-MS-GEC-Version":x.t4,TrustedClientToken:x.t5},x.t7=s||tht,x.t8={query:x.t6,url:x.t7},u=x.t0.stringifyUrl.call(x.t0,x.t8),f=sht(c),h=f.configHeader,g=f.contentHeader,p=mie(h,iht),_=mie(g,qft(o,l)),x.abrupt("return",new Promise(function(E,M){var k=new WebSocket(u);k.binaryType="arraybuffer";var N=function(){k.send(p),k.send(_)},I=new ArrayBuffer(0),D=(function(){var G=Az(oE().mark(function J(B){var $,U,Q,W,q,Y,ae,Z;return oE().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(typeof B.data!="string"){ne.next=13;break}$=eht(B.data),U=$.headers,ne.t0=U.Path,ne.next=ne.t0==="turn.end"?5:11;break;case 5:if(k.close(),I.byteLength){ne.next=8;break}return ne.abrupt("return");case 8:return Q=new Response(I),E(Q),ne.abrupt("break",11);case 11:ne.next=14;break;case 13:B.data instanceof ArrayBuffer&&(W=new DataView(B.data),q=W.getInt16(0),B.data.byteLength>q+2&&(Y=B.data.slice(2+q),ae=new ArrayBuffer(I.byteLength+Y.byteLength),Z=new Uint8Array(ae),Z.set(new Uint8Array(I),0),Z.set(new Uint8Array(Y),I.byteLength),I=ae));case 14:case"end":return ne.stop()}},J)}));return function(B){return G.apply(this,arguments)}})(),V=function(){M(new Error("WebSocket error occurred.")),k.close()};k.addEventListener("open",N),k.addEventListener("message",D),k.addEventListener("error",V)}));case 24:case"end":return x.stop()}},e)}));return function(t){return n.apply(this,arguments)}})(),oht=function(e){var t=e&&PP[e]?PP[e]||[]:Pm(Object.values(PP));return t.map(function(r){return{label:DP?.[r]||r,value:r}})};function XE(n){"@babel/helpers - typeof";return XE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XE(n)}function $S(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$S=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var h="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var k=Object.getPrototypeOf,N=k&&k(k(Q([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&XE(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=h;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=J(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===h)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function J(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,J(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function Q(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(XE(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=Q,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:Q(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function vie(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function BF(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){vie(s,r,i,a,o,"next",l)}function o(l){vie(s,r,i,a,o,"throw",l)}a(void 0)})}}function lht(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function cht(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,xye(r.key),r)}}function uht(n,e,t){return e&&cht(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function yv(n,e,t){return e=xye(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xye(n){var e=fht(n,"string");return XE(e)=="symbol"?e:String(e)}function fht(n,e){if(XE(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(XE(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var y3=(function(){function n(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.serviceUrl,i=t.locale,s=t.headers;lht(this,n),yv(this,"locale",void 0),yv(this,"serviceUrl",void 0),yv(this,"headers",void 0),yv(this,"fetch",(function(){var a=BF($S().mark(function o(l){var c;return $S().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,e.serviceUrl?fetch(e.serviceUrl,{body:JSON.stringify(l),headers:e.headers,method:"POST"}):Eye({payload:l});case 2:return c=f.sent,f.abrupt("return",c);case 4:case"end":return f.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),yv(this,"create",(function(){var a=BF($S().mark(function o(l){return $S().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",e.fetch(l));case 1:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),yv(this,"createAudio",(function(){var a=BF($S().mark(function o(l){var c,u;return $S().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,e.create(l);case 2:return c=h.sent,h.next=5,c.arrayBuffer();case 5:return u=h.sent,h.abrupt("return",hft(u));case 7:case"end":return h.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),this.locale=i,this.serviceUrl=r,this.headers=s}return uht(n,[{key:"voiceOptions",get:function(){return oht(this.locale)}}]),n})();yv(y3,"localeOptions",yft());yv(y3,"voiceList",PP);yv(y3,"voiceName",DP);yv(y3,"createRequest",Eye);let FF;async function Tye(n,e){return new Promise(t=>{xe(FF)||(FF=new y3({locale:"en-US"}));const r=setTimeout(()=>t(void 0),5e3);FF.createAudio({input:e,options:{voice:n}}).then(i=>{clearTimeout(r),t(i)})})}async function hht(n,e,t){if(!xe(n)||t.trim()==="")return;const r=await Tye(e,t);xe(r)&&n.addttsaudiobuffer(r)}const dht=uye(1);async function pht(n,e){if(!xe(n))return;n.addttsaudiobuffer(e);const t=Math.max(1e3,Math.round(e.duration*1e3));await Ch(t)}const mht=uye(1);async function ght(n,e,t){const r=await Tye(e,t);dht.add(async()=>{xe(r)&&await pht(n,r)})}function _ht(n,e,t){mht.add(async()=>{await ght(n,e,t)})}const vht=Date.now(),Rg={get value(){return(Date.now()-vht)/1e3%1e6}},yht=120;let wye=0;function Rye(n){wye=yht/n}const bht=136;Rye(bht);const b3={get value(){return wye}};function S3(n){const e=n.clone();return e.uniforms.time=Rg,e.uniforms.interval=b3,e}let LN=!1,LP=!1;function E3(){LP||LN||(LN=!0,e4(new pR({latencyHint:"playback"}),!0),Wot().then(()=>{if(!LP){try{const n=navigator;xe(n.audioSession)&&(n.audioSession.type="playback")}catch{}return lye().then(()=>{LN=!1,LP=!0,N3e(XS,as())})}}).catch(n=>{LN=!1,xi(XS,as(),"audio",n.toString())}))}let _d;function Sht(){return _d?.broadcastdestination}const XS=Y1("synth",[],n=>{if(!XS.session(n)||(LP&&!xe(_d)&&(_d=cye(),Sz().start()),!xe(_d)))return;const e=as();switch(n.target){case"audioenabled":if(n.player!==e)return;break}const t=ws.getState().gadget.board;switch(n.target){case"audioenabled":Ts(XS,n.player,"audio is enabled!"),ic(XS,n.player,async()=>{await Ch(2e3),U0(XS,n.player,void 0,"text","audioenabled","")});break;case"bpm":if(Mn(n.data)){const r=Math.round(n.data);_d.setbpm(r),Rye(r)}break;case"playvolume":Mn(n.data)&&_d.setplayvolume(n.data);break;case"bgplayvolume":Mn(n.data)&&_d.setbgplayvolume(n.data);break;case"ttsvolume":Mn(n.data)&&_d.setttsvolume(n.data);break;case"play":if(ui(n.data)){const[r,i]=n.data;if(r&&r!==t)return;i.trim()===""?_d.stopplay():_d.addplay(i)}break;case"bgplay":if(ui(n.data)){const[r,i,s]=n.data;if(r&&r!==t)return;_d.addbgplay(i,s)}break;case"voice":if(ui(n.data)){const[r,i,s]=n.data;nft(n.player,_d,r,i,s)}break;case"voicefx":if(ui(n.data)){const[r,i,s,a]=n.data;uft(n.player,_d,r,i,s,a)}break;case"record":Vn(n.data)&&_d.synthrecord(n.data);break;case"flush":_d.synthflush();break;case"tts":ic(XS,n.player,async()=>{if(ui(n.data)){const[r,i]=n.data;await hht(_d,r,i)}});break;case"ttsqueue":if(ui(n.data)){const[r,i]=n.data;_ht(_d,r,i)}break}});function KE(){return KE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},KE.apply(null,arguments)}var Eht=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return r/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*i)/t)},xht=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function j0(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:xht,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,l="velocity_"+e;if(n.__damp===void 0&&(n.__damp={}),n.__damp[l]===void 0&&(n.__damp[l]=0),Math.abs(n[e]-t)<=o)return n[e]=t,!1;r=Math.max(1e-4,r);var c=2/r,u=a(c*i),f=n[e]-t,h=t,g=s*r;f=Math.min(Math.max(f,-g),g),t=n[e]-f;var p=(n.__damp[l]+c*f)*i;n.__damp[l]=(n.__damp[l]-c*p)*u;var _=t+(f+p)*u;return h-n[e]>0==_>h&&(_=h,n.__damp[l]=(_-h)/i),n[e]=_,!0}function zF(n,e,t,r,i,s,a,o){return j0(n,e,n[e]+Hke(n[e],t),r,i,s,a,o)}var oT=new ut,yie,bie,Sie;function F1(n,e,t,r,i,s,a){return typeof e=="number"?oT.setScalar(e):Array.isArray(e)?oT.set(e[0],e[1],e[2]):oT.copy(e),yie=j0(n,"x",oT.x,t,r,i,s,a),bie=j0(n,"y",oT.y,t,r,i,s,a),Sie=j0(n,"z",oT.z,t,r,i,s,a),yie||bie||Sie}var YM=new Bm,Eie,xie,Tie;function Mz(n,e,t,r,i,s,a){return Array.isArray(e)?YM.set(e[0],e[1],e[2],e[3]):YM.copy(e),Eie=zF(n,"x",YM.x,t,r,i,s,a),xie=zF(n,"y",YM.y,t,r,i,s,a),Tie=zF(n,"z",YM.z,t,r,i,s,a),Eie||xie||Tie}const wie=n=>Symbol.iterator in n,Rie=n=>"entries"in n,Aie=(n,e)=>{const t=n instanceof Map?n:new Map(n.entries()),r=e instanceof Map?e:new Map(e.entries());if(t.size!==r.size)return!1;for(const[i,s]of t)if(!Object.is(s,r.get(i)))return!1;return!0},Tht=(n,e)=>{const t=n[Symbol.iterator](),r=e[Symbol.iterator]();let i=t.next(),s=r.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=t.next(),s=r.next()}return!!i.done&&!!s.done};function wht(n,e){return Object.is(n,e)?!0:typeof n!="object"||n===null||typeof e!="object"||e===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(e)?!1:wie(n)&&wie(e)?Rie(n)&&Rie(e)?Aie(n,e):Tht(n,e):Aie({entries:()=>Object.entries(n)},{entries:()=>Object.entries(e)})}function Uh(n){const e=Ng.useRef(void 0);return t=>{const r=n(t);return wht(e.current,r)?e.current:e.current=r}}function Aye(n,e,t){const r=Nm(g=>g.size),i=Nm(g=>g.viewport),s=typeof n=="number"?n:r.width*i.dpr,a=typeof e=="number"?e:r.height*i.dpr,o=(typeof n=="number"?t:n)||{},{samples:l=0,depth:c,...u}=o,f=c??o.depthBuffer,h=it.useMemo(()=>{const g=new Sf(s,a,{minFilter:sc,magFilter:sc,type:vb,...u});return f&&(g.depthTexture=new Ww(s,a,Pp)),g.samples=l,g},[]);return it.useLayoutEffect(()=>{h.setSize(s,a),l&&(h.samples=l)},[l,h,s,a]),it.useEffect(()=>()=>h.dispose(),[]),h}const Rht=n=>typeof n=="function",Aht=it.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,children:r,makeDefault:i,...s},a)=>{const o=Nm(({set:y})=>y),l=Nm(({camera:y})=>y),c=Nm(({size:y})=>y),u=it.useRef(null);it.useImperativeHandle(a,()=>u.current,[]);const f=it.useRef(null),h=Aye(e);it.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[c,s]),it.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),it.useLayoutEffect(()=>{if(i){const y=l;return o(()=>({camera:u.current})),()=>o(()=>({camera:y}))}},[u,i,o]);let g=0,p=null;const _=Rht(r);return Wg(y=>{_&&(t===1/0||g<t)&&(f.current.visible=!1,y.gl.setRenderTarget(h),p=y.scene.background,n&&(y.scene.background=n),y.gl.render(y.scene,u.current),y.scene.background=p,y.gl.setRenderTarget(null),f.current.visible=!0,g++)}),it.createElement(it.Fragment,null,it.createElement("orthographicCamera",KE({left:c.width/-2,right:c.width/2,top:c.height/2,bottom:c.height/-2,ref:u},s),!_&&r),it.createElement("group",{ref:f},_&&r(h.texture)))});var UP={exports:{}},Cht=UP.exports,Cie;function Mht(){return Cie||(Cie=1,(function(n,e){(function(t,r){n.exports=r()})(Cht,function(){var t=function(){function r(g){return a.appendChild(g.dom),g}function i(g){for(var p=0;p<a.children.length;p++)a.children[p].style.display=p===g?"block":"none";s=g}var s=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(g){g.preventDefault(),i(++s%a.children.length)},!1);var o=(performance||Date).now(),l=o,c=0,u=r(new t.Panel("FPS","#0ff","#002")),f=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=r(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:a,addPanel:r,showPanel:i,begin:function(){o=(performance||Date).now()},end:function(){c++;var g=(performance||Date).now();if(f.update(g-o,200),g>l+1e3&&(u.update(1e3*c/(g-l),100),l=g,c=0,h)){var p=performance.memory;h.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return g},update:function(){o=this.end()},domElement:a,setMode:i}};return t.Panel=function(r,i,s){var a=1/0,o=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,f=48*c,h=3*c,g=2*c,p=3*c,_=15*c,y=74*c,v=30*c,x=document.createElement("canvas");x.width=u,x.height=f,x.style.cssText="width:80px;height:48px";var E=x.getContext("2d");return E.font="bold "+9*c+"px Helvetica,Arial,sans-serif",E.textBaseline="top",E.fillStyle=s,E.fillRect(0,0,u,f),E.fillStyle=i,E.fillText(r,h,g),E.fillRect(p,_,y,v),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(p,_,y,v),{dom:x,update:function(M,k){a=Math.min(a,M),o=Math.max(o,M),E.fillStyle=s,E.globalAlpha=1,E.fillRect(0,0,u,_),E.fillStyle=i,E.fillText(l(M)+" "+r+" ("+l(a)+"-"+l(o)+")",h,g),E.drawImage(x,p+c,_,y-c,v,p,_,y-c,v),E.fillRect(p+y-c,_,c,v),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(p+y-c,_,c,l((1-M/k)*v))}}},t})})(UP)),UP.exports}var Oht=Mht();const kht=Bh(Oht);function jF(n,e,t,r){return new(t||(t=Promise))((function(i,s){function a(c){try{l(r.next(c))}catch(u){s(u)}}function o(c){try{l(r.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?i(c.value):(u=c.value,u instanceof t?u:new t((function(f){f(u)}))).then(a,o)}l((r=r.apply(n,[])).next())}))}const Iht=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function Mie(n){return n=n.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const Cye=typeof window>"u",hv=(()=>{if(Cye)return;const{userAgent:n,platform:e,maxTouchPoints:t}=window.navigator,r=/(iphone|ipod|ipad)/i.test(n),i=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:i,isMobile:/android/i.test(n)||r||i,isSafari12:/Version\/12.+Safari/.test(n),isFirefox:/Firefox/.test(n)}})();function Nht(n,e,t){if(!t)return[e];const r=(function(c){const u=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,f=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,h=c.createShader(35633),g=c.createShader(35632),p=c.createProgram();if(!(g&&h&&p))return;c.shaderSource(h,u),c.shaderSource(g,f),c.compileShader(h),c.compileShader(g),c.attachShader(p,h),c.attachShader(p,g),c.linkProgram(p),c.detachShader(p,h),c.detachShader(p,g),c.deleteShader(h),c.deleteShader(g),c.useProgram(p);const _=c.createBuffer();c.bindBuffer(34962,_),c.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const y=c.getAttribLocation(p,"aPosition");c.vertexAttribPointer(y,3,5126,!1,0,0),c.enableVertexAttribArray(y),c.clearColor(1,1,1,1),c.clear(16384),c.viewport(0,0,1,1),c.drawArrays(4,0,3);const v=new Uint8Array(4);return c.readPixels(0,0,1,1,6408,5121,v),c.deleteProgram(p),c.deleteBuffer(_),v.join("")})(n),i="801621810",s="8016218135",a="80162181161",o=hv?.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",i,15],["a12x",i,15],["a12z",i,15],["a14",i,15],["a15",i,15],["m1",i,15],["m2",i,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",i,15],["a12",i,15],["a13",i,15],["a14",i,15],["a15",i,15],["a16",i,15],["a17",i,15]];let l;return r==="80162181255"?l=o.filter((([,,c])=>c>=14)):(l=o.filter((([,c])=>c===r)),l.length||(l=o)),l.map((([c])=>`apple ${c} gpu`))}class Oie extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const HF=[],kie=[];function Pht(n,e){if(n===e)return 0;const t=n;n.length>e.length&&(n=e,e=t);let r=n.length,i=e.length;for(;r>0&&n.charCodeAt(~-r)===e.charCodeAt(~-i);)r--,i--;let s,a=0;for(;a<r&&n.charCodeAt(a)===e.charCodeAt(a);)a++;if(r-=a,i-=a,r===0)return i;let o,l,c=0,u=0,f=0;for(;u<r;)kie[u]=n.charCodeAt(a+u),HF[u]=++u;for(;f<i;)for(s=e.charCodeAt(a+f),o=f++,c=f,u=0;u<r;u++)l=s===kie[u]?o:o+1,o=HF[u],c=HF[u]=o>c?l>c?c+1:l:l>o?o+1:l;return c}function Dht(n){return n!=null}const Lht=({mobileTiers:n=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:r,failIfMajorPerformanceCaveat:i=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>jF(void 0,void 0,void 0,(function*(){const a={};if(Cye)return{tier:0,type:"SSR"};const{isIpad:o=!!hv?.isIpad,isMobile:l=!!hv?.isMobile,screenSize:c=window.screen,loadBenchmarks:u=(k=>jF(void 0,void 0,void 0,(function*(){const N=yield fetch(`${s}/${k}`).then((I=>I.json()));if(parseInt(N.shift().split(".")[0],10)<4)throw new Oie("Detect GPU benchmark data is out of date. Please update to version 4x");return N})))}=t;let{renderer:f}=t;const h=(k,N,I,D,V)=>({device:V,fps:D,gpu:I,isMobile:l,tier:k,type:N});let g,p="";if(f)f=Mie(f),g=[f];else{const k=r||(function(I,D=!1){const V={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:D,powerPreference:"high-performance",stencil:!1};I&&delete V.powerPreference;const G=window.document.createElement("canvas"),J=G.getContext("webgl",V)||G.getContext("experimental-webgl",V);return J??void 0})(hv?.isSafari12,i);if(!k)return h(0,"WEBGL_UNSUPPORTED");const N=hv?.isFirefox?null:k.getExtension("WEBGL_debug_renderer_info");if(f=N?k.getParameter(N.UNMASKED_RENDERER_WEBGL):k.getParameter(k.RENDERER),!f)return h(1,"FALLBACK");p=f,f=Mie(f),g=(function(I,D,V){return D==="apple gpu"?Nht(I,D,V):[D]})(k,f,l)}const _=(yield Promise.all(g.map((function(k){var N;return jF(this,void 0,void 0,(function*(){const I=(le=>{const ce=l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const de of ce)if(le.includes(de))return de})(k);if(!I)return;const D=`${l?"m":"d"}-${I}${o?"-ipad":""}.json`,V=a[D]=(N=a[D])!==null&&N!==void 0?N:u(D);let G;try{G=yield V}catch(le){if(le instanceof Oie)throw le;return}const J=(function(le){var ce;const de=(le=le.replace(/\([^)]+\)/,"")).match(/\d+/)||le.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(ce=de?.join("").replace(/\W|amd/g,""))!==null&&ce!==void 0?ce:""})(k);let B=G.filter((([,le])=>le===J));B.length||(B=G.filter((([le])=>le.includes(k))));const $=B.length;if($===0)return;const U=k.split(/[.,()\[\]/\s]/g).sort().filter(((le,ce,de)=>ce===0||le!==de[ce-1])).join(" ");let Q,[W,,,,q]=$>1?B.map((le=>[le,Pht(U,le[2])])).sort((([,le],[,ce])=>le-ce))[0][0]:B[0],Y=Number.MAX_VALUE;const{devicePixelRatio:ae}=window,Z=c.width*ae*c.height*ae;for(const le of q){const[ce,de]=le,Me=ce*de,qe=Math.abs(Z-Me);qe<Y&&(Y=qe,Q=le)}if(!Q)return;const[,,K,ne]=Q;return[Y,K,W,ne]}))})))).filter(Dht).sort((([k=Number.MAX_VALUE,N],[I=Number.MAX_VALUE,D])=>k===I?N-D:k-I));if(!_.length){const k=Iht.find((N=>f.includes(N)));return k?h(0,"BLOCKLISTED",k):h(1,"FALLBACK",`${f} (${p})`)}const[,y,v,x]=_[0];if(y===-1)return h(0,"BLOCKLISTED",v,y,x);const E=l?n:e;let M=0;for(let k=0;k<E.length;k++)y>=E[k]&&(M=k);return h(M,"BENCHMARK",v,y,x)})),Uht=n=>Gle(()=>Lht(n),["useDetectGPU"]),Iie=(n,e)=>{n.updateRanges[0]=e};function Bht(n){return typeof n=="function"}const Nie=new Qr,Pie=new Qr,UN=[],XM=new bu;class Fht extends eE{constructor(){super(),this.color=new cr("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,t){const r=this.instance.current;if(!r||!r.geometry||!r.material)return;XM.geometry=r.geometry;const i=r.matrixWorld,s=r.userData.instances.indexOf(this.instanceKey);if(!(s===-1||s>r.count)){r.getMatrixAt(s,Nie),Pie.multiplyMatrices(i,Nie),XM.matrixWorld=Pie,r.material instanceof nh?XM.material.side=r.material.side:XM.material.side=r.material[0].side,XM.raycast(e,UN);for(let a=0,o=UN.length;a<o;a++){const l=UN[a];l.instanceId=s,l.object=this,t.push(l)}UN.length=0}}}const Mye=it.createContext(null),Die=new Qr,Lie=new Qr,zht=new Qr,Uie=new ut,Bie=new zp,Fie=new ut,jht=n=>n.isInstancedBufferAttribute,Gy=it.forwardRef(({context:n,children:e,...t},r)=>{it.useMemo(()=>jj({PositionMesh:Fht}),[]);const i=it.useRef(null);it.useImperativeHandle(r,()=>i.current,[]);const{subscribe:s,getParent:a}=it.useContext(n||Mye);return it.useLayoutEffect(()=>s(i),[]),it.createElement("positionMesh",KE({instance:a(),instanceKey:i,ref:i},t),e)}),h1=it.forwardRef(({context:n,children:e,range:t,limit:r=1e3,frames:i=1/0,...s},a)=>{const[{localContext:o,instance:l}]=it.useState(()=>{const x=it.createContext(null);return{localContext:x,instance:it.forwardRef((E,M)=>it.createElement(Gy,KE({context:x},E,{ref:M})))}}),c=it.useRef(null);it.useImperativeHandle(a,()=>c.current,[]);const[u,f]=it.useState([]),[[h,g]]=it.useState(()=>{const x=new Float32Array(r*16);for(let E=0;E<r;E++)zht.identity().toArray(x,E*16);return[x,new Float32Array([...new Array(r*3)].map(()=>1))]});it.useEffect(()=>{c.current.instanceMatrix.needsUpdate=!0});let p=0,_=0;const y=it.useRef([]);it.useLayoutEffect(()=>{y.current=Object.entries(c.current.geometry.attributes).filter(([x,E])=>jht(E))}),Wg(()=>{if(i===1/0||p<i){c.current.updateMatrix(),c.current.updateMatrixWorld(),Die.copy(c.current.matrixWorld).invert(),_=Math.min(r,t!==void 0?t:r,u.length),c.current.count=_,Iie(c.current.instanceMatrix,{start:0,count:_*16}),Iie(c.current.instanceColor,{start:0,count:_*3});for(let x=0;x<u.length;x++){const E=u[x].current;E.matrixWorld.decompose(Uie,Bie,Fie),Lie.compose(Uie,Bie,Fie).premultiply(Die),Lie.toArray(h,x*16),c.current.instanceMatrix.needsUpdate=!0,E.color.toArray(g,x*3),c.current.instanceColor.needsUpdate=!0}p++}});const v=it.useMemo(()=>({getParent:()=>c,subscribe:x=>(f(E=>[...E,x]),()=>f(E=>E.filter(M=>M.current!==x.current)))}),[]);return it.createElement("instancedMesh",KE({userData:{instances:u,limit:r,frames:i},matrixAutoUpdate:!1,ref:c,args:[null,null,0],raycast:()=>null},s),it.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[h,16],usage:M7}),it.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[g,3],usage:M7}),Bht(e)?it.createElement(o.Provider,{value:v},e(l)):n?it.createElement(n.Provider,{value:v},e):it.createElement(Mye.Provider,{value:v},e))});function Hht(n,e){const t=n+"Geometry";return it.forwardRef(({args:r,children:i,...s},a)=>{const o=it.useRef(null);return it.useImperativeHandle(a,()=>o.current),it.useLayoutEffect(()=>void e?.(o.current)),it.createElement("mesh",KE({ref:o},s),it.createElement(t,{attach:"geometry",args:r}),i)})}const qht=Hht("plane");/**
 * postprocessing v6.37.7 build Mon Aug 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rüschen
 * @license Zlib
 */var qF=1/1e3,Vht=1e3,Ght=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*qF}get fixedDelta(){return this._fixedDelta*qF}set fixedDelta(n){this._fixedDelta=n*Vht}get elapsed(){return this._elapsed*qF}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},$ht=(()=>{const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new ns;return t.setAttribute("position",new Ds(n,3)),t.setAttribute("uv",new Ds(e,2)),t})(),Xm=class Oz{static get fullscreenGeometry(){return $ht}constructor(e="Pass",t=new ew,r=new _k){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new bu(Oz.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ew),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=q1){}render(e,t,r,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Sf||t instanceof nh||t instanceof wc||t instanceof Oz)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Wht=class extends Xm{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,r,i){const s=n.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Yht=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,x3="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Oye=class extends Vl{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new jn(null),opacity:new jn(1)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Yht,vertexShader:x3})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},kye=class extends Xm{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new Oye,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new Sf(1,1,{minFilter:sc,magFilter:sc,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,r,i){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==ql?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":n!==null&&n.outputColorSpace===na&&(this.renderTarget.texture.colorSpace=na))}},zie=new cr,Iye=class extends Xm{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,r,i){const s=this.overrideClearColor,a=this.overrideClearAlpha,o=n.getClearAlpha(),l=s!==null,c=a>=0;l?(n.getClearColor(zie),n.setClearColor(s,c?a:o)):c&&n.setClearAlpha(a),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),l?n.setClearColor(zie,o):c&&n.setClearAlpha(o)}},Xht=class extends Xm{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new Iye(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,r,i){const s=n.getContext(),a=n.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,f=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(f),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(n,null):(c.render(n,e),c.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(o,l)):(n.setRenderTarget(e),n.render(o,l),n.setRenderTarget(t),n.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Nye=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,r,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new kye,this.depthTexture=null,this.passes=[],this.timer=new Ght,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new an),r=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===ql&&e.outputColorSpace===na&&(this.inputBuffer.texture.colorSpace=na,this.outputBuffer.texture.colorSpace=na,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const s of this.passes)s.initialize(e,r,i)}}replaceRenderer(e,t=!0){const r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){const e=this.depthTexture=new Ww;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=EE,e.type=SE):e.type=zv,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i){const s=this.renderer,a=s===null?new an:s.getDrawingBufferSize(new an),o={minFilter:sc,magFilter:sc,stencilBuffer:t,depthBuffer:e,type:r},l=new Sf(a.width,a.height,o);return i>0&&(l.ignoreDepthForMultisampleCopy=!1,l.samples=i),r===ql&&s!==null&&s.outputColorSpace===na&&(l.texture.colorSpace=na),l.texture.name="EffectComposer.Buffer",l.texture.generateMipmaps=!1,l}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const r=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new an),a=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(s.width,s.height),e.initialize(i,a,o),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){const a=(l,c)=>l||c.needsDepthTexture;t.reduce(a,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,r=this.copyPass;let i=this.inputBuffer,s=this.outputBuffer,a=!1,o,l,c;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const u of this.passes)u.enabled&&(u.render(t,i,s,e,a),u.needsSwap&&(a&&(r.renderToScreen=u.renderToScreen,o=t.getContext(),l=t.state.buffers.stencil,l.setFunc(o.NOTEQUAL,1,4294967295),r.render(t,i,s,e,a),l.setFunc(o.EQUAL,1,4294967295)),c=i,i=s,s=c),u instanceof Xht?a=!0:u instanceof Wht&&(a=!1))}setSize(e,t,r){const i=this.renderer,s=i.getSize(new an);(e===void 0||t===void 0)&&(e=s.width,t=s.height),(s.width!==e||s.height!==t)&&i.setSize(e,t,r);const a=i.getDrawingBufferSize(new an);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);for(const o of this.passes)o.setSize(a.width,a.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Xm.fullscreenGeometry.dispose()}},Um={NONE:0,DEPTH:1,CONVOLUTION:2},Za={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Kht=class{constructor(){this.shaderParts=new Map([[Za.FRAGMENT_HEAD,null],[Za.FRAGMENT_MAIN_UV,null],[Za.FRAGMENT_MAIN_IMAGE,null],[Za.VERTEX_HEAD,null],[Za.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Um.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=jv}},VF=!1,jie=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case $f:t=this.materialsFlatShadedDoubleSide;break;case Yf:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case $f:t=this.materialsDoubleSide;break;case Yf:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof Vl))return n.clone();const e=n.uniforms,t=new Map;for(const i in e){const s=e[i].value;s.isRenderTargetTexture&&(e[i].value=null,t.set(i,s))}const r=n.clone();for(const i of t)e[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=Fv;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=Yf,r}),this.materialsDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=$f,r}),this.materialsFlatShaded=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=Yf,r}),this.materialsFlatShadedDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=$f,r})}}render(n,e,t){const r=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,VF){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=i}n.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return VF}static set workaroundEnabled(n){VF=n}},Zb=-1,Dg=class extends $g{constructor(n,e=Zb,t=Zb,r=1){super(),this.resizable=n,this.baseSize=new an(1,1),this.preferredSize=new an(e,t),this.target=this.preferredSize,this.s=r,this.effectiveSize=new an,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,r=this.scale;e.width!==Zb?t.width=e.width:e.height!==Zb?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*r),e.height!==Zb?t.height=e.height:e.width!==Zb?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*r)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar(Zb),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Zb}},xs={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Zht="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",Jht="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",Qht="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",edt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",tdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",ndt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",rdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",idt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",sdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",adt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",odt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",ldt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",cdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",udt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",fdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",hdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",ddt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",pdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",mdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",gdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",_dt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",vdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",ydt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",bdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",Sdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",Edt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",xdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",Tdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",wdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",Rdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Adt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",Cdt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",Mdt=new Map([[xs.ADD,Zht],[xs.ALPHA,Jht],[xs.AVERAGE,Qht],[xs.COLOR,edt],[xs.COLOR_BURN,tdt],[xs.COLOR_DODGE,ndt],[xs.DARKEN,rdt],[xs.DIFFERENCE,idt],[xs.DIVIDE,sdt],[xs.DST,null],[xs.EXCLUSION,adt],[xs.HARD_LIGHT,odt],[xs.HARD_MIX,ldt],[xs.HUE,cdt],[xs.INVERT,udt],[xs.INVERT_RGB,fdt],[xs.LIGHTEN,hdt],[xs.LINEAR_BURN,ddt],[xs.LINEAR_DODGE,pdt],[xs.LINEAR_LIGHT,mdt],[xs.LUMINOSITY,gdt],[xs.MULTIPLY,_dt],[xs.NEGATION,vdt],[xs.NORMAL,ydt],[xs.OVERLAY,bdt],[xs.PIN_LIGHT,Sdt],[xs.REFLECT,Edt],[xs.SATURATION,xdt],[xs.SCREEN,Tdt],[xs.SOFT_LIGHT,wdt],[xs.SRC,Rdt],[xs.SUBTRACT,Adt],[xs.VIVID_LIGHT,Cdt]]),Odt=class extends $g{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new jn(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return Mdt.get(this.blendFunction)}},B_=class extends $g{constructor(n,e,{attributes:t=Um.NONE,blendFunction:r=xs.NORMAL,defines:i=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=n,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=o,this.defines=i,this.uniforms=s,this.extensions=a,this.blendMode=new Odt(r),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=jv,this._outputColorSpace=x_}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(n){this._inputColorSpace=n,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n,this.setChanged()}set mainScene(n){}set mainCamera(n){}getName(){return this.name}setRenderer(n){this.renderer=n}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(n){this.attributes=n,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(n){this.fragmentShader=n,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(n){this.vertexShader=n,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(n,e=q1){}update(n,e,t){}setSize(n,e){}initialize(n,e,t){}dispose(){for(const n of Object.keys(this)){const e=this[n];(e instanceof Sf||e instanceof nh||e instanceof wc||e instanceof Xm)&&this[n].dispose()}}},T3={MEDIUM:2,LARGE:3,VERY_LARGE:4},kdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Idt="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Ndt=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Pdt=class extends Vl{constructor(n=new Ta){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new jn(null),texelSize:new jn(new Ta),scale:new jn(1),kernel:new jn(0)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:kdt,vertexShader:Idt}),this.setTexelSize(n.x,n.y),this.kernelSize=T3.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return Ndt[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,r=1/e;this.uniforms.texelSize.value.set(t,r,t*.5,r*.5)}},Pye=class extends Xm{constructor({kernelSize:n=T3.MEDIUM,resolutionScale:e=.5,width:t=Dg.AUTO_SIZE,height:r=Dg.AUTO_SIZE,resolutionX:i=t,resolutionY:s=r}={}){super("KawaseBlurPass"),this.renderTargetA=new Sf(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new Dg(this,i,s,e);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new Pdt,this._blurMaterial.kernelSize=n,this.copyMaterial=new Oye}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,r,i){const s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,u=c.kernelSequence;let f=e;this.fullscreenMaterial=c;for(let h=0,g=u.length;h<g;++h){const p=(h&1)===0?o:l;c.kernel=u[h],c.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,a),f=p}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=f.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(s,a)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==ql?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):n!==null&&n.outputColorSpace===na&&(this.renderTargetA.texture.colorSpace=na,this.renderTargetB.texture.colorSpace=na))}static get AUTO_SIZE(){return Dg.AUTO_SIZE}},Ddt=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Ldt=class extends Vl{constructor(n=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Hw.replace(/\D+/g,"")},uniforms:{inputBuffer:new jn(null),threshold:new jn(0),smoothing:new jn(1),range:new jn(null)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ddt,vertexShader:x3}),this.colorOutput=n,this.luminanceRange=e}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get threshold(){return this.uniforms.threshold.value}set threshold(n){this.smoothing>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=n}getThreshold(){return this.threshold}setThreshold(n){this.threshold=n}get smoothing(){return this.uniforms.smoothing.value}set smoothing(n){this.threshold>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=n}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(n){this.smoothing=n}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(n){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(n){n?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(n){return this.colorOutput}setColorOutputEnabled(n){this.colorOutput=n}get useRange(){return this.luminanceRange!==null}set useRange(n){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(n){n!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=n,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(n){this.luminanceRange=n}},Udt=class extends Xm{constructor({renderTarget:n,luminanceRange:e,colorOutput:t,resolutionScale:r=1,width:i=Dg.AUTO_SIZE,height:s=Dg.AUTO_SIZE,resolutionX:a=i,resolutionY:o=s}={}){super("LuminancePass"),this.fullscreenMaterial=new Ldt(t,e),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new Dg(this,a,o,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(n,e,t,r,i){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}initialize(n,e,t){t!==void 0&&t!==ql&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Bdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Fdt="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",zdt=class extends Vl{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new jn(null),texelSize:new jn(new an)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Bdt,vertexShader:Fdt})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},jdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Hdt="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",qdt=class extends Vl{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new jn(null),supportBuffer:new jn(null),texelSize:new jn(new an),radius:new jn(.85)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:jdt,vertexShader:Hdt})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}set supportBuffer(n){this.uniforms.supportBuffer.value=n}get radius(){return this.uniforms.radius.value}set radius(n){this.uniforms.radius.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Vdt=class extends Xm{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new zdt,this.upsamplingMaterial=new qdt,this.resolution=new an}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(n){if(this.levels!==n){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<n;++t){const r=e.clone();r.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(r)}this.upsamplingMipmaps.push(e);for(let t=1,r=n-1;t<r;++t){const i=e.clone();i.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(n){this.upsamplingMaterial.radius=n}render(n,e,t,r,i){const{scene:s,camera:a}=this,{downsamplingMaterial:o,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:u}=this;let f=e;this.fullscreenMaterial=o;for(let h=0,g=c.length;h<g;++h){const p=c[h];o.setSize(f.width,f.height),o.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,a),f=p}this.fullscreenMaterial=l;for(let h=u.length-1;h>=0;--h){const g=u[h];l.setSize(f.width,f.height),l.inputBuffer=f.texture,l.supportBuffer=c[h].texture,n.setRenderTarget(g),n.render(s,a),f=g}}setSize(n,e){const t=this.resolution;t.set(n,e);let r=t.width,i=t.height;for(let s=0,a=this.downsamplingMipmaps.length;s<a;++s)r=Math.round(r*.5),i=Math.round(i*.5),this.downsamplingMipmaps[s].setSize(r,i),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(r,i)}initialize(n,e,t){if(t!==void 0){const r=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of r)i.texture.type=t;if(t!==ql)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(n!==null&&n.outputColorSpace===na)for(const i of r)i.texture.colorSpace=na}}dispose(){super.dispose();for(const n of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))n.dispose()}},Gdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,$dt=class extends B_{constructor({blendFunction:n=xs.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:r=!0,intensity:i=1,radius:s=.85,levels:a=8,kernelSize:o=T3.LARGE,resolutionScale:l=.5,width:c=Dg.AUTO_SIZE,height:u=Dg.AUTO_SIZE,resolutionX:f=c,resolutionY:h=u}={}){super("BloomEffect",Gdt,{blendFunction:n,uniforms:new Map([["map",new jn(null)],["intensity",new jn(i)]])}),this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Pye({kernelSize:o}),this.luminancePass=new Udt({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new Vdt,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const g=this.resolution=new Dg(this,f,h,l);g.addEventListener("change",p=>this.setSize(g.baseWidth,g.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(n){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(n){this.uniforms.get("intensity").value=n}getIntensity(){return this.intensity}setIntensity(n){this.intensity=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}update(n,e,t){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(n,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,i.renderTarget):this.blurPass.render(n,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,e):this.blurPass.render(n,e,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(n,e),this.mipmapBlurPass.setSize(n,e)}initialize(n,e,t){this.blurPass.initialize(n,e,t),this.luminancePass.initialize(n,e,t),this.mipmapBlurPass.initialize(n,e,t),t!==void 0&&(this.renderTarget.texture.type=t,n!==null&&n.outputColorSpace===na&&(this.renderTarget.texture.colorSpace=na))}},IT={RED:0,GREEN:1,BLUE:2,ALPHA:3},fG={DISCARD:0,MULTIPLY_RGB_SET_ALPHA:2,MULTIPLY_RGB:3},Wdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 cocNearFar=texture2D(cocBuffer,vUv).rg*scale;float coc=cocNearFar.x;
#else
float coc=texture2D(cocBuffer,vUv).g*scale;
#endif
if(coc==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(cocNearFar.x,cocNearFar.y);
#else
vec2 step=texelSize*coc;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,BN=class extends Vl{constructor(n=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:n?"2":"1"},uniforms:{inputBuffer:new jn(null),cocBuffer:new jn(null),texelSize:new jn(new an),kernel64:new jn(null),kernel16:new jn(null),scale:new jn(1)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Wdt,vertexShader:x3}),e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set cocBuffer(n){this.uniforms.cocBuffer.value=n}setCoCBuffer(n){this.uniforms.cocBuffer.value=n}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(n){return this.scale}setScale(n){this.scale=n}generateKernel(){const n=2.39996323,e=new Float64Array(128),t=new Float64Array(32);let r=0,i=0;for(let s=0,a=Math.sqrt(80);s<80;++s){const o=s*n,l=Math.sqrt(s)/a,c=l*Math.cos(o),u=l*Math.sin(o);s%5===0?(t[i++]=c,t[i++]=u):(e[r++]=c,e[r++]=u)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}};function Hie(n,e,t){return n*(e-t)-e}function kz(n,e,t){return Math.min(Math.max((n+e)/(e-t),0),1)}var Ydt=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#ifdef LOG_DEPTH
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#endif
return depth;}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,Xdt=class extends Vl{constructor(n){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new jn(null),focusDistance:new jn(0),focusRange:new jn(0),cameraNear:new jn(.3),cameraFar:new jn(1e3)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ydt,vertexShader:x3}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(n)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=q1){this.depthBuffer=n,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(n){this.uniforms.focusDistance.value=n}get worldFocusDistance(){return-Hie(this.focusDistance,this.near,this.far)}set worldFocusDistance(n){this.focusDistance=kz(-n,this.near,this.far)}getFocusDistance(n){this.uniforms.focusDistance.value=n}setFocusDistance(n){this.uniforms.focusDistance.value=n}get focalLength(){return this.focusRange}set focalLength(n){this.focusRange=n}get focusRange(){return this.uniforms.focusRange.value}set focusRange(n){this.uniforms.focusRange.value=n}get worldFocusRange(){return-Hie(this.focusRange,this.near,this.far)}set worldFocusRange(n){this.focusRange=kz(-n,this.near,this.far)}getFocalLength(n){return this.focusRange}setFocalLength(n){this.focusRange=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof yf?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},Kdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 3
vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=vec4(mask*texel.rgb,texel.a);
#elif MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Zdt=class extends Vl{constructor(n=null){super({name:"MaskMaterial",uniforms:{maskTexture:new jn(n),inputBuffer:new jn(null),strength:new jn(1)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Kdt,vertexShader:x3}),this.colorChannel=IT.RED,this.maskFunction=fG.DISCARD}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set maskTexture(n){this.uniforms.maskTexture.value=n,delete this.defines.MASK_PRECISION_HIGH,n.type!==ql&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(n){this.maskTexture=n}set colorChannel(n){this.defines.COLOR_CHANNEL=n.toFixed(0),this.needsUpdate=!0}setColorChannel(n){this.colorChannel=n}set maskFunction(n){this.defines.MASK_FUNCTION=n.toFixed(0),this.needsUpdate=!0}setMaskFunction(n){this.maskFunction=n}get inverted(){return this.defines.INVERTED!==void 0}set inverted(n){this.inverted&&!n?delete this.defines.INVERTED:n&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(n){this.inverted=n}get strength(){return this.uniforms.strength.value}set strength(n){this.uniforms.strength.value=n}getStrength(){return this.strength}setStrength(n){this.strength=n}},lT=class extends Xm{constructor(n,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=n,this.input=e}setInput(n){this.input=n}render(n,e,t,r,i){const s=this.fullscreenMaterial.uniforms;e!==null&&s!==void 0&&s[this.input]!==void 0&&(s[this.input].value=e.texture),n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}initialize(n,e,t){t!==void 0&&t!==ql&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Jdt=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform lowp sampler2D farCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);
#if MASK_FUNCTION == 1
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,colorFar.a);cocNearFar.x=min(cocNearFar.x*scale,1.0);
#else
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,texture2D(farCoCBuffer,uv).g);cocNearFar=min(cocNearFar*scale,1.0);
#endif
vec4 result=inputColor*(1.0-cocNearFar.y)+colorFar;result=mix(result,colorNear,cocNearFar.x);outputColor=result;}`,Qdt=class extends B_{constructor(n,{blendFunction:e,worldFocusDistance:t,worldFocusRange:r,focusDistance:i=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,resolutionScale:l=1,width:c=Dg.AUTO_SIZE,height:u=Dg.AUTO_SIZE,resolutionX:f=c,resolutionY:h=u}={}){super("DepthOfFieldEffect",Jdt,{blendFunction:e,attributes:Um.DEPTH,uniforms:new Map([["nearColorBuffer",new jn(null)],["farColorBuffer",new jn(null)],["nearCoCBuffer",new jn(null)],["farCoCBuffer",new jn(null)],["scale",new jn(1)]])}),this.camera=n,this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.uniforms.get("farCoCBuffer").value=this.renderTargetCoC.texture,this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new lT(new Xdt(n));const g=this.cocMaterial;g.focusDistance=i,g.focusRange=a,t!==void 0&&(g.worldFocusDistance=t),r!==void 0&&(g.worldFocusRange=r),this.blurPass=new Pye({resolutionScale:l,resolutionX:f,resolutionY:h,kernelSize:T3.MEDIUM}),this.maskPass=new lT(new Zdt(this.renderTargetCoC.texture));const p=this.maskPass.fullscreenMaterial;p.colorChannel=IT.GREEN,this.maskFunction=fG.MULTIPLY_RGB,this.bokehNearBasePass=new lT(new BN(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new lT(new BN(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new lT(new BN(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new lT(new BN(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const _=this.resolution=new Dg(this,f,h,l);_.addEventListener("change",y=>this.setSize(_.baseWidth,_.baseHeight)),this.bokehScale=o}set mainCamera(n){this.camera=n,this.cocMaterial.copyCameraSettings(n)}get cocTexture(){return this.renderTargetCoC.texture}get maskFunction(){return this.maskPass.fullscreenMaterial.maskFunction}set maskFunction(n){this.maskFunction!==n&&(this.defines.set("MASK_FUNCTION",n.toFixed(0)),this.maskPass.fullscreenMaterial.maskFunction=n,this.setChanged())}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.cocMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(n){this.bokehNearBasePass.fullscreenMaterial.scale=n,this.bokehNearFillPass.fullscreenMaterial.scale=n,this.bokehFarBasePass.fullscreenMaterial.scale=n,this.bokehFarFillPass.fullscreenMaterial.scale=n,this.maskPass.fullscreenMaterial.strength=n,this.uniforms.get("scale").value=n}getBokehScale(){return this.bokehScale}setBokehScale(n){this.bokehScale=n}getTarget(){return this.target}setTarget(n){this.target=n}calculateFocusDistance(n){const e=this.camera,t=e.position.distanceTo(n);return kz(-t,e.near,e.far)}setDepthTexture(n,e=q1){this.cocMaterial.depthBuffer=n,this.cocMaterial.depthPacking=e}update(n,e,t){const r=this.renderTarget,i=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){const o=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=o}this.cocPass.render(n,null,i),this.blurPass.render(n,i,s),this.maskPass.render(n,e,a),this.bokehFarBasePass.render(n,a,r),this.bokehFarFillPass.render(n,r,this.renderTargetFar),this.bokehNearBasePass.render(n,e,r),this.bokehNearFillPass.render(n,r,this.renderTargetNear)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.cocPass.setSize(n,e),this.blurPass.setSize(n,e),this.maskPass.setSize(n,e),this.renderTargetFar.setSize(n,e),this.renderTargetCoC.setSize(n,e),this.renderTargetMasked.setSize(n,e),this.renderTarget.setSize(r,i),this.renderTargetNear.setSize(r,i),this.renderTargetCoCBlurred.setSize(r,i),this.bokehNearBasePass.fullscreenMaterial.setSize(n,e),this.bokehNearFillPass.fullscreenMaterial.setSize(n,e),this.bokehFarBasePass.fullscreenMaterial.setSize(n,e),this.bokehFarFillPass.fullscreenMaterial.setSize(n,e)}initialize(n,e,t){this.cocPass.initialize(n,e,t),this.maskPass.initialize(n,e,t),this.bokehNearBasePass.initialize(n,e,t),this.bokehNearFillPass.initialize(n,e,t),this.bokehFarBasePass.initialize(n,e,t),this.bokehFarFillPass.initialize(n,e,t),this.blurPass.initialize(n,e,ql),n.capabilities.logarithmicDepthBuffer&&(this.cocPass.fullscreenMaterial.defines.LOG_DEPTH="1"),t!==void 0&&(this.renderTarget.texture.type=t,this.renderTargetNear.texture.type=t,this.renderTargetFar.texture.type=t,this.renderTargetMasked.texture.type=t,n!==null&&n.outputColorSpace===na&&(this.renderTarget.texture.colorSpace=na,this.renderTargetNear.texture.colorSpace=na,this.renderTargetFar.texture.colorSpace=na,this.renderTargetMasked.texture.colorSpace=na))}},d1={DISABLED:0,SPORADIC:1,CONSTANT_MILD:2,CONSTANT_WILD:3};function ept(n,e,t){const r=new Map([[Vw,1],[C4,2],[Xf,4]]);let i;if(r.has(e)||console.error("Invalid noise texture format"),t===ql){i=new Uint8Array(n*r.get(e));for(let s=0,a=i.length;s<a;++s)i[s]=Math.random()*255+.5}else{i=new Float32Array(n*r.get(e));for(let s=0,a=i.length;s<a;++s)i[s]=Math.random()}return i}var qie=class extends Bg{constructor(n,e,t=Vw,r=ql){super(ept(n*e,t,r),n,e,t,r),this.needsUpdate=!0}},tpt="uniform lowp sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seeds;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seeds.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seeds.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}vec2 normal=texture2D(perturbationMap,uv*random*random).rg;uv+=normal*seeds*(random*0.2);}}",FN="Glitch.Generated";function _m(n,e){return n+Math.random()*(e-n)}var npt=class extends B_{constructor({chromaticAberrationOffset:n=null,delay:e=new an(1.5,3.5),duration:t=new an(.6,1),strength:r=new an(.3,1),columns:i=.05,ratio:s=.85,perturbationMap:a=null,dtSize:o=64}={}){if(super("GlitchEffect",tpt,{uniforms:new Map([["perturbationMap",new jn(null)],["columns",new jn(i)],["active",new jn(!1)],["random",new jn(1)],["seeds",new jn(new an)],["distortion",new jn(new an)]])}),a===null){const l=new qie(o,o,Xf);l.name=FN,this.perturbationMap=l}else this.perturbationMap=a;this.time=0,this.distortion=this.uniforms.get("distortion").value,this.delay=e,this.duration=t,this.breakPoint=new an(_m(this.delay.x,this.delay.y),_m(this.duration.x,this.duration.y)),this.strength=r,this.mode=d1.SPORADIC,this.ratio=s,this.chromaticAberrationOffset=n}get seeds(){return this.uniforms.get("seeds").value}get active(){return this.uniforms.get("active").value}isActive(){return this.active}get minDelay(){return this.delay.x}set minDelay(n){this.delay.x=n}getMinDelay(){return this.delay.x}setMinDelay(n){this.delay.x=n}get maxDelay(){return this.delay.y}set maxDelay(n){this.delay.y=n}getMaxDelay(){return this.delay.y}setMaxDelay(n){this.delay.y=n}get minDuration(){return this.duration.x}set minDuration(n){this.duration.x=n}getMinDuration(){return this.duration.x}setMinDuration(n){this.duration.x=n}get maxDuration(){return this.duration.y}set maxDuration(n){this.duration.y=n}getMaxDuration(){return this.duration.y}setMaxDuration(n){this.duration.y=n}get minStrength(){return this.strength.x}set minStrength(n){this.strength.x=n}getMinStrength(){return this.strength.x}setMinStrength(n){this.strength.x=n}get maxStrength(){return this.strength.y}set maxStrength(n){this.strength.y=n}getMaxStrength(){return this.strength.y}setMaxStrength(n){this.strength.y=n}getMode(){return this.mode}setMode(n){this.mode=n}getGlitchRatio(){return 1-this.ratio}setGlitchRatio(n){this.ratio=Math.min(Math.max(1-n,0),1)}get columns(){return this.uniforms.get("columns").value}set columns(n){this.uniforms.get("columns").value=n}getGlitchColumns(){return this.columns}setGlitchColumns(n){this.columns=n}getChromaticAberrationOffset(){return this.chromaticAberrationOffset}setChromaticAberrationOffset(n){this.chromaticAberrationOffset=n}get perturbationMap(){return this.uniforms.get("perturbationMap").value}set perturbationMap(n){const e=this.perturbationMap;e!==null&&e.name===FN&&e.dispose(),n.minFilter=n.magFilter=bf,n.wrapS=n.wrapT=YT,n.generateMipmaps=!1,this.uniforms.get("perturbationMap").value=n}getPerturbationMap(){return this.perturbationMap}setPerturbationMap(n){this.perturbationMap=n}generatePerturbationMap(n=64){const e=new qie(n,n,Xf);return e.name=FN,e}update(n,e,t){const r=this.mode,i=this.breakPoint,s=this.chromaticAberrationOffset,a=this.strength;let o=this.time,l=!1,c=0,u=0,f;r!==d1.DISABLED&&(r===d1.SPORADIC&&(o+=t,f=o>i.x,o>=i.x+i.y&&(i.set(_m(this.delay.x,this.delay.y),_m(this.duration.x,this.duration.y)),o=0)),c=Math.random(),this.uniforms.get("random").value=c,f&&c>this.ratio||r===d1.CONSTANT_WILD?(l=!0,c*=a.y*.03,u=_m(-Math.PI,Math.PI),this.seeds.set(_m(-a.y,a.y),_m(-a.y,a.y)),this.distortion.set(_m(0,1),_m(0,1))):(f||r===d1.CONSTANT_MILD)&&(l=!0,c*=a.x*.03,u=_m(-Math.PI,Math.PI),this.seeds.set(_m(-a.x,a.x),_m(-a.x,a.x)),this.distortion.set(_m(0,1),_m(0,1))),this.time=o),s!==null&&(l?s.set(Math.cos(u),Math.sin(u)).multiplyScalar(c):s.set(0,0)),this.uniforms.get("active").value=l}dispose(){const n=this.perturbationMap;n!==null&&n.name===FN&&n.dispose()}},Dye=class extends Xm{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new Iye,this.overrideMaterialManager=t===null?null:new jie(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new jie(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,r,i){const s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=n.shadowMap.autoUpdate,f=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,s,a):n.render(s,a),a.layers.mask=l,s.background=c,n.shadowMap.autoUpdate=u}},_T={DEFAULT:0,ESKIL:1},rpt=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,ipt=class extends B_{constructor({blendFunction:n=xs.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",rpt,{blendFunction:n}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(n){this.premultiply!==n&&(n?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(n){this.premultiply=n}},spt=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,apt=class extends B_{constructor({blendFunction:n,eskil:e=!1,technique:t=e?_T.ESKIL:_T.DEFAULT,offset:r=.5,darkness:i=.5}={}){super("VignetteEffect",spt,{blendFunction:n,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new jn(r)],["darkness",new jn(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(n){this.technique!==n&&(this.defines.set("VIGNETTE_TECHNIQUE",n.toFixed(0)),this.setChanged())}get eskil(){return this.technique===_T.ESKIL}set eskil(n){this.technique=n?_T.ESKIL:_T.DEFAULT}getTechnique(){return this.technique}setTechnique(n){this.technique=n}get offset(){return this.uniforms.get("offset").value}set offset(n){this.uniforms.get("offset").value=n}getOffset(){return this.offset}setOffset(n){this.offset=n}get darkness(){return this.uniforms.get("darkness").value}set darkness(n){this.uniforms.get("darkness").value=n}getDarkness(){return this.darkness}setDarkness(n){this.darkness=n}},opt=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,lpt="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",cpt=class extends Vl{constructor(n,e,t,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Hw.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new jn(null),depthBuffer:new jn(null),resolution:new jn(new an),texelSize:new jn(new an),cameraNear:new jn(.3),cameraFar:new jn(1e3),aspect:new jn(1),time:new jn(0)},blending:Ih,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(r)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=q1){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=opt.replace(Za.FRAGMENT_HEAD,n.get(Za.FRAGMENT_HEAD)||"").replace(Za.FRAGMENT_MAIN_UV,n.get(Za.FRAGMENT_MAIN_UV)||"").replace(Za.FRAGMENT_MAIN_IMAGE,n.get(Za.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=lpt.replace(Za.VERTEX_HEAD,n.get(Za.VERTEX_HEAD)||"").replace(Za.VERTEX_MAIN_SUPPORT,n.get(Za.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof yf?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return Za}};function Vie(n,e,t){for(const r of e){const i="$1"+n+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(s,i))}}function upt(n,e,t){let r=e.getFragmentShader(),i=e.getVertexShader();const s=r!==void 0&&/mainImage/.test(r),a=r!==void 0&&/mainUv/.test(r);if(t.attributes|=e.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&Um.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let c=l.get(Za.FRAGMENT_HEAD)||"",u=l.get(Za.FRAGMENT_MAIN_UV)||"",f=l.get(Za.FRAGMENT_MAIN_IMAGE)||"",h=l.get(Za.VERTEX_HEAD)||"",g=l.get(Za.VERTEX_MAIN_SUPPORT)||"";const p=new Set,_=new Set;if(a&&(u+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const x=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);g+=`	${n}MainSupport(`,g+=x?`vUv);
`:`);
`;for(const E of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const M of E[1].split(/\s*,\s*/))t.varyings.add(M),p.add(M),_.add(M);for(const E of i.matchAll(o))_.add(E[1])}for(const x of r.matchAll(o))_.add(x[1]);for(const x of e.defines.keys())_.add(x.replace(/\([\w\s,]*\)/g,""));for(const x of e.uniforms.keys())_.add(x);_.delete("while"),_.delete("for"),_.delete("if"),e.uniforms.forEach((x,E)=>t.uniforms.set(n+E.charAt(0).toUpperCase()+E.slice(1),x)),e.defines.forEach((x,E)=>t.defines.set(n+E.charAt(0).toUpperCase()+E.slice(1),x));const y=new Map([["fragment",r],["vertex",i]]);Vie(n,_,t.defines),Vie(n,_,y),r=y.get("fragment"),i=y.get("vertex");const v=e.blendMode;if(t.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===na?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==x_?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const x=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${n}MainImage(color0, UV, `,(t.attributes&Um.DEPTH)!==0&&x.test(r)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const E=n+"BlendOpacity";t.uniforms.set(E,v.opacity),f+=`color0 = blend${v.blendFunction}(color0, color1, ${E});

	`,c+=`uniform float ${E};

`}if(c+=r+`
`,i!==null&&(h+=i+`
`),l.set(Za.FRAGMENT_HEAD,c),l.set(Za.FRAGMENT_MAIN_UV,u),l.set(Za.FRAGMENT_MAIN_IMAGE,f),l.set(Za.VERTEX_HEAD,h),l.set(Za.VERTEX_MAIN_SUPPORT,g),e.extensions!==null)for(const x of e.extensions)t.extensions.add(x)}}var Lye=class extends Xm{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new cpt(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new Kht;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===xs.DST)n.attributes|=a.getAttributes()&Um.DEPTH;else{if((n.attributes&a.getAttributes()&Um.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${a.name})`);upt("e"+e++,a,n)}let t=n.shaderParts.get(Za.FRAGMENT_HEAD),r=n.shaderParts.get(Za.FRAGMENT_MAIN_IMAGE),i=n.shaderParts.get(Za.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of n.blendModes.values())t+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;(n.attributes&Um.DEPTH)!==0?(n.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===na&&(r+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(Za.FRAGMENT_HEAD,t),n.shaderParts.set(Za.FRAGMENT_MAIN_IMAGE,r),n.shaderParts.set(Za.FRAGMENT_MAIN_UV,i);for(const[a,o]of n.shaderParts)o!==null&&n.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=q1){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,r,i){for(const s of this.effects)s.update(n,e,r);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const r of this.effects)r.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==ql&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}};function W2(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}new an;new an;function Uye(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var v0=function n(e,t,r){var i=this;Uye(this,n),W2(this,"dot2",function(s,a){return i.x*s+i.y*a}),W2(this,"dot3",function(s,a,o){return i.x*s+i.y*a+i.z*o}),this.x=e,this.y=t,this.z=r},fpt=[new v0(1,1,0),new v0(-1,1,0),new v0(1,-1,0),new v0(-1,-1,0),new v0(1,0,1),new v0(-1,0,1),new v0(1,0,-1),new v0(-1,0,-1),new v0(0,1,1),new v0(0,-1,1),new v0(0,1,-1),new v0(0,-1,-1)],Gie=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],$ie=new Array(512),Wie=new Array(512),hpt=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var r;t&1?r=Gie[t]^e&255:r=Gie[t]^e>>8&255,$ie[t]=$ie[t+256]=r,Wie[t]=Wie[t+256]=fpt[r%12]}};hpt(0);function dpt(n){if(typeof n=="number")n=Math.abs(n);else if(typeof n=="string"){var e=n;n=0;for(var t=0;t<e.length;t++)n=(n+(t+1)*(e.charCodeAt(t)%96))%2147483647}return n===0&&(n=311),n}function Yie(n){var e=dpt(n);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var ppt=function n(e){var t=this;Uye(this,n),W2(this,"seed",0),W2(this,"init",function(r){t.seed=r,t.value=Yie(r)}),W2(this,"value",Yie(this.seed)),this.init(e)};new ppt(Math.random());const hG=it.createContext(null);let mpt=0;const Xie=new WeakMap,w3=(n,e)=>function({blendFunction:t=e?.blendFunction,opacity:r=e?.opacity,...i}){let s=Xie.get(n);if(!s){const l=`@react-three/postprocessing/${n.name}-${mpt++}`;jj({[l]:n}),Xie.set(n,s=l)}const a=Nm(l=>l.camera),o=Ng.useMemo(()=>[...e?.args??[],...i.args??[{...e,...i}]],[JSON.stringify(i)]);return Le.jsx(s,{camera:a,"blendMode-blendFunction":t,"blendMode-opacity-value":r,...i,args:o})},zN=(n,e)=>{const t=n[e];return Ng.useMemo(()=>typeof t=="number"?new an(t,t):t?new an(...t):new an,[t])},dG=it.forwardRef(function({blendFunction:n,worldFocusDistance:e,worldFocusRange:t,focusDistance:r,focusRange:i,focalLength:s,bokehScale:a,resolutionScale:o,resolutionX:l,resolutionY:c,width:u,height:f,target:h,depthTexture:g,...p},_){const{camera:y}=it.useContext(hG),v=h!=null,x=it.useMemo(()=>{const E=new Qdt(y,{blendFunction:n,worldFocusDistance:e,worldFocusRange:t,focusDistance:r,focusRange:i,focalLength:s,bokehScale:a,resolutionScale:o,resolutionX:l,resolutionY:c,width:u,height:f});v&&(E.target=new ut),g&&E.setDepthTexture(g.texture,g.packing);const M=E.maskPass;return M.maskFunction=fG.MULTIPLY_RGB_SET_ALPHA,E},[y,n,e,t,r,i,s,a,o,l,c,u,f,v,g]);return it.useEffect(()=>()=>{x.dispose()},[x]),Le.jsx("primitive",{...p,ref:_,object:x,target:h})}),gpt=w3($dt,{blendFunction:0}),_pt=it.forwardRef(function({active:n=!0,...e},t){const r=Nm(c=>c.invalidate),i=zN(e,"delay"),s=zN(e,"duration"),a=zN(e,"strength"),o=zN(e,"chromaticAberrationOffset"),l=it.useMemo(()=>new npt({...e,delay:i,duration:s,strength:a,chromaticAberrationOffset:o}),[i,s,e,a,o]);return it.useLayoutEffect(()=>{l.mode=n?e.mode||d1.SPORADIC:d1.DISABLED,r()},[n,l,r,e.mode]),it.useEffect(()=>()=>{l.dispose?.()},[l]),Le.jsx("primitive",{ref:t,object:l,dispose:null})}),vpt=w3(ipt,{blendFunction:5}),ypt=w3(apt);var W0=typeof window<"u"?window:{screen:{},navigator:{}},Fw=(W0.matchMedia||(function(){return{matches:!1}})).bind(W0),bpt={get passive(){return!0}},Bye=function(){};W0.addEventListener&&W0.addEventListener("p",Bye,bpt);W0.removeEventListener&&W0.removeEventListener("p",Bye,!1);var pG="ontouchstart"in W0,Spt="TouchEvent"in W0,Ept=pG||Spt&&Fw("(any-pointer: coarse)").matches,Kie=(W0.navigator.maxTouchPoints||0)>0||Ept,Fye=W0.navigator.userAgent||"",xpt=Fw("(pointer: coarse)").matches&&/iPad|Macintosh/.test(Fye)&&Math.min(W0.screen.width||0,W0.screen.height||0)>=768,zye=(Fw("(pointer: coarse)").matches||!Fw("(pointer: fine)").matches&&pG)&&!/Windows.*Firefox/.test(Fye),Tpt=Fw("(any-pointer: fine)").matches||Fw("(any-hover: hover)").matches||xpt||!pG,Iz=Kie&&(Tpt||!zye)?"hybrid":Kie?"touchOnly":"mouseOnly",wpt=Iz==="mouseOnly"?"mouse":Iz==="touchOnly"||zye?"touch":"mouse";const Rpt=`  
vec3 halftone(vec3 texcolor, vec2 st, float frequency) {
  float n = 0.1 * snoise(st * 200.0); // Fractal noise
  n += 0.05 * snoise(st * 400.0);
  n += 0.025 * snoise(st * 800.0);

  // Perform a rough RGB-to-CMYK conversion
  vec4 cmyk;
  // CMY = 1-RGB
  cmyk.xyz = 1.0 - texcolor;
  // Black generation: K = min(C,M,Y)
  cmyk.w = min(cmyk.x, min(cmyk.y, cmyk.z)); 
  // Grey component replacement: subtract K from CMY
  cmyk.xyz -= cmyk.w; 

  // K based modifier
  float flex = pow(cmyk.w, 3.11);

  // Distance to nearest point in a grid of
  // (frequency x frequency) points over the unit square
  
  float t = 0.1 + 0.1 * n + 0.11 * flex + 0.1 * cmyk.y;

  // K component: 45 degrees screen angle
  vec2 Kst = frequency * mat2(0.707, -0.707, 0.707, 0.707) * st;
  vec2 Kuv = 2.0 * fract(Kst) - 1.0; 
  float k = aastep(0.0, sqrt(cmyk.w) + t - length(Kuv) + n);
  
  // C component: 15 degrees screen angle
  vec2 Cst = frequency*mat2(0.966, -0.259, 0.259, 0.966) * st;
  vec2 Cuv = 2.0 * fract(Cst) - 1.0;
  float c = aastep(0.0, sqrt(cmyk.x) + t - length(Cuv) + n);
  
  // M component: -15 degrees screen angle
  vec2 Mst = frequency * mat2(0.966, 0.259, -0.259, 0.966) * st;
  vec2 Muv = 2.0 * fract(Mst) - 1.0;
  float m = aastep(0.0, sqrt(cmyk.y) + t - length(Muv) + n);

  // Y component: 0 degrees screen angle
  vec2 Yst = frequency * st; // 0 deg 
  vec2 Yuv = 2.0 * fract(Yst) - 1.0;
  float y = aastep(0.0, sqrt(cmyk.z) + t - length(Yuv) + n);

  // CMY screen in RGB
  vec3 black = vec3(n + 0.01);
  vec3 rgbscreen = 1.0 - vec3(c,m,y) + n;
  
  // Blend in K for final color
  vec3 factor = mix(rgbscreen, black, 1.1 * k + 0.3 * n);

  // Blend with og color
  return mix(factor, texcolor, 0.777);
}

vec3 halftone(vec3 texcolor, vec2 st) {
  return halftone(texcolor, st, 412.321);
}
`,Apt=`
float blendLighten(float base, float blend) {
	return max(blend,base);
}

vec3 blendLighten(vec3 base, vec3 blend) {
	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));
}

vec3 blendLighten(vec3 base, vec3 blend, float opacity) {
	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));
}

float blendDarken(float base, float blend) {
	return min(blend,base);
}

vec3 blendDarken(vec3 base, vec3 blend) {
	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));
}

vec3 blendDarken(vec3 base, vec3 blend, float opacity) {
	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));
}
`,Cpt=`
float aastep(float threshold, float value) {
  float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;
  return smoothstep(threshold-afwidth, threshold+afwidth, value);
}
`,R3=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`,Mpt=`
#ifdef ASPECT_CORRECTION
	uniform float scale;
#else
	uniform mat3 uvTransform;
#endif

varying vec2 vUv2;

void mainSupport(const in vec2 uv) {
	#ifdef ASPECT_CORRECTION
		vUv2 = uv * vec2(aspect, 1.0) * scale;
	#else
		vUv2 = (uvTransform * vec3(uv, 1.0)).xy;
	#endif
}
`,Opt=`
uniform float viewheight;
uniform sampler2D splat;

${Apt}
${Cpt}
${R3}
${Rpt}

float rectdistance(vec2 uv) {
  vec2 tl = vec2(-1.0);
  vec2 br = vec2(1.0);
  vec2 d = max(tl - uv, uv - br);
  return abs(length(max(vec2(0.0), d)) + min(0.0, max(d.x, d.y)));
}

vec2 bendy(const in vec2 xn, float dn, float sn) {
  // config
  float distortion = 0.0173 + dn; // 0.0173, 0.511
  float scale = 0.991 + sn; // 1.0, 0.7
  // calc
  vec3 xDistorted = vec3((1.0 + vec2(distortion, distortion) * dot(xn, xn)) * xn, 1.0);
  mat3 kk = mat3(
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0)
  );
  return (kk * xDistorted).xy * scale;
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
	#ifdef UV_TRANSFORM
		vec4 bright = texture2D(splat, vUv2);
		vec4 dark = texture2D(splat, 1.0 - vUv2);
	#else
		vec4 bright = texture2D(splat, uv);
		vec4 dark = texture2D(splat, 1.0 - uv);
	#endif
  
  float n = 0.1 * snoise(uv.st * 200.0); // Fractal noise
  n += 0.05 * snoise(uv.st * 400.0);
  n += 0.025 * snoise(uv.st * 800.0);

  vec2 xn = 2.0 * (uv.st - 0.5);
  float fz = 0.005;
  vec2 edge = bendy(xn, fz * n, -fz * n);
  vec2 bent = edge.xy * 0.5 + 0.5;

  float edgetime = time * 0.3;
  float edgetime2 = time * 2.0;
  vec2 edgewiggle = vec2(cos(edgetime) * 0.1, sin(edgetime) * 0.096);
  vec2 edgewiggle2 = vec2(cos(edgetime2) * 0.005, sin(edgetime2) * 0.005);
  vec2 edgeshine = vec2(edge.x * 5.0 + 3.5, edge.y - 0.3) + edgewiggle + edgewiggle2;
  vec2 edgeshine2 = vec2(edge.x, edge.y * 2.0 - 0.5) + edgewiggle + edgewiggle2;
  vec2 edgeshine3 = vec2(edge.x * 3.0 - 2.1, edge.y + 0.3) + edgewiggle + edgewiggle2;
  
  float dx = rectdistance(xn);
  float bx = rectdistance(edge);
  float ex = rectdistance(edgeshine);
  float ex2 = rectdistance(edgeshine2);
  float ex3 = rectdistance(edgeshine3);

  // apply shape
  float doot = max(abs(edge.x), abs(edge.y));
  if (doot < 1.0) {
    // display
    outputColor = texture2D(inputBuffer, bent);

    // apply scratches
    outputColor.rgb = blendLighten(outputColor.rgb, bright.rgb, 0.079);
    outputColor.rgb = blendDarken(outputColor.rgb, dark.rgb, 0.0666);

    // apply halftones
    outputColor.rgb = halftone(outputColor.rgb, uv.st);
  
  } else if (doot > 1.004) {
    // display shell
    // rbgb 205 205 193
    vec3 matte = vec3(205.0 / 255.0, 205.0 / 255.0, 193.0 / 255.0);
    vec3 dkmatte = mix(matte, vec3(0.0), 0.5);
    float mx = pow(1.0 - bx, 16.0) + n;
    outputColor = vec4(mix(matte, dkmatte, mx), inputColor.a);

  } else {
    // border
    outputColor = vec4(mix(vec3(0.0), outputColor.rgb, 0.5), inputColor.a);
  }

  // apply reflection shine
  if (doot < 0.98) {
    float vvv = 0.34;
    if (edge.x > -0.9 && edge.x < -0.5 && edge.y > -0.5) {
      float sh = clamp(0.0, vvv, ex + n * 0.333);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(bx * 3.0)) * (6.0 + sin(edgetime));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
    if (edge.y > -0.3 && edge.y < 0.7) {
      float sh = clamp(0.0, vvv, ex2 + n * 0.15);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(dx * 3.0)) * (4.0 + cos(edgetime * 1.5));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
    if (edge.x > 0.4 && edge.y < 0.8) {
      float sh = clamp(0.0, vvv, ex3 + n * 0.25);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(bx * 2.0)) * (3.0 + sin(-edgetime));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
  }

  // apply inner shade
  if (doot >= 0.5 && doot < 1.0) {
    float sh = clamp(0.0, 1.0, 1.0 - bx - 0.7);
    vec3 shade = mix(outputColor.rgb, vec3(0.0), pow(sh, 4.0));
    outputColor = vec4(shade, inputColor.a);
  }

  // apply outer shade
  if (doot >= 0.97) {
    float sh = clamp(0.0, 1.0, bx * 24.0);
    vec3 dkout = mix(vec3(0.0), outputColor.rgb, 0.81);
    vec3 shade = mix(dkout, outputColor.rgb, sh);
    outputColor = vec4(shade, inputColor.a);
  }
}
`;class kpt extends B_{constructor({splat:e,viewheight:t}={}){super("CRTShapeEffect",Opt,{blendFunction:xs.NORMAL,attributes:Um.CONVOLUTION,defines:new Map([["TEXEL","texel"],["TEXTURE_PRECISION_HIGH","1"]]),uniforms:new Map([["splat",new jn(e)],["viewheight",new jn(t??128)]])})}get splat(){return this.uniforms.get("splat")?.value}set splat(e){const{splat:t,uniforms:r,defines:i}=this,s=r.get("splat"),a=r.get("uvTransform");t!==e&&s&&a&&(s.value=e,a.value=e.matrix,i.delete("TEXTURE_PRECISION_HIGH"),e!==null&&(e.matrixAutoUpdate?(i.set("UV_TRANSFORM","1"),this.setVertexShader(Mpt)):(i.delete("UV_TRANSFORM"),this.setVertexShader(null)),e.type!==ql&&i.set("TEXTURE_PRECISION_HIGH","1"),(t===null||t?.type!==e.type)&&this.setChanged()))}getTexture(){return this.splat}setTexture(e){this.splat=e}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(e){this.aspectCorrection!==e&&(e?this.defines.set("ASPECT_CORRECTION","1"):this.defines.delete("ASPECT_CORRECTION"),this.setChanged())}get uvTransform(){return!!this.splat?.matrixAutoUpdate}set uvTransform(e){const t=this.splat;xe(t)&&(t.matrixAutoUpdate=e)}setTextureSwizzleRGBA(e,t=e,r=e,i=e){const s="rgba";let a="";(e!==IT.RED||t!==IT.GREEN||r!==IT.BLUE||i!==IT.ALPHA)&&(a=[".",s[e],s[t],s[r],s[i]].join("")),this.defines.set("TEXEL","texel"+a),this.setChanged()}update(){this.splat?.matrixAutoUpdate&&this.splat.updateMatrix()}}const Ipt=w3(kpt);function mG(n){const e=new Set;function t(s){d3e(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),mO.invoke(s))}const r=Y1("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),n(s))});function i(){mO.disconnect(r)}return{forward:t,disconnect:i}}function Npt(n){switch(n.target){case"tick":case"tock":case"ready":return!0}return!1}function Ppt(n){switch(n.target){case"log":case"info":case"error":case"tick":case"tock":case"ready":case"chat":case"toast":case"second":return!0;default:{const e=AE(n.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}function Dpt(n){switch(n.target){case"tick":case"tock":case"second":return!0}return!1}function jye(n){const e=AE(n.target);switch(e.target){case"vm":case"modem":case"gadgetserver":return!0}switch(e.path){case"sync":case"desync":case"joinack":return!0}return!1}function Lpt(n){return new Worker("/assets/simspace-BosSAflc.js",{name:n?.name})}function Upt(n){return new Worker("/assets/stubspace-MWP3_jzt.js",{name:n?.name})}let ky,Nz;function Bpt(n=!1){if(xe(ky))return;p3e(St),ky=n?new Upt:new Lpt;const{forward:e,disconnect:t}=mG(i=>{xe(ky)&&jye(i)&&ky.postMessage(i)});function r(i){return e(i.data)}ky.addEventListener("message",r),Nz=()=>{t(),xe(ky)&&(ky.removeEventListener("message",r),ky.terminate()),ky=void 0}}function Fpt(){Nz?.(),Nz=void 0}function Hye(n,e,t,r){const i=e*t*4;for(let s=0,a=0;s<i;++a)n.image.data[s]=r[a]*255,s+=4;return n.needsUpdate=!0,n}function qye(n,e){const t=new Uint8Array(4*n*e);return new Bg(t,n,e)}const zpt=new Vl({transparent:!1,side:$f,uniforms:{color:{value:new cr(0,0,0)},data:{value:null}},vertexShader:`
      varying vec2 vUv;
    
      void main() {
        vec4 mvPosition = vec4(position, 1.0);
        #ifdef USE_INSTANCING
        	mvPosition = instanceMatrix * mvPosition;
        #endif        
        mvPosition = modelViewMatrix * mvPosition;
        gl_Position = projectionMatrix * mvPosition;
        
        vUv = uv;
      }
    `,fragmentShader:`
      uniform vec3 color;
      uniform sampler2D data;
  
      varying vec2 vUv;

      // adapted from https://www.shadertoy.com/view/Mlt3z8
      float bayerDither2x2( vec2 v ) {
        return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
      }

      float bayerDither4x4( vec2 v ) {
        vec2 P1 = mod( v, 2.0 );
        vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
        return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
      }

      void main() {
        float alpha = texture2D(data, vUv).r;
        if (alpha < 1.0) {
          vec2 ditherCoord = floor( mod( gl_FragCoord.xy, 4.0 ) );
          if ( bayerDither4x4( ditherCoord ) / 16.0 >= alpha ) {
            discard;
          }
        }

        gl_FragColor.rgba = vec4(color.xyz, 1.0);
      }
    `});function Vye(){return S3(zpt)}const Mp=[0,1,0],xv=[1,1,0],Cg=[1,0,0],Tv=[0,0,0],jpt=new Float32Array([...Mp,...Cg,...xv,...Mp,...Tv,...Cg]),Gye=new Float32Array([...Mp.slice(0,2),...Cg.slice(0,2),...xv.slice(0,2),...Mp.slice(0,2),...Tv.slice(0,2),...Cg.slice(0,2)]);function Hpt(n,e,t,r,i,s){const a=e*t*4;for(let o=0,l=0;o<a;++l){const c=r[l]??0;n.image.data[o++]=c%P0,n.image.data[o++]=Math.floor(c/P0),n.image.data[o++]=i[l]??16,n.image.data[o++]=s[l]??16}return n.needsUpdate=!0,n}function qpt(n,e){const t=new Uint8Array(4*n*e),r=new Bg(t,n,e,mk,ql);return r.internalFormat="RGBA8UI",r}function gG(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:jpt.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s}}),uv:Gye}}const Zie=[0,1,1],GF=[1,1,1],jN=[1,0,1],$F=[0,0,1],Vpt=new Float32Array([...Mp,...GF,...xv,...Mp,...Zie,...GF,...Tv,...jN,...Cg,...Tv,...$F,...jN,...xv,...jN,...Cg,...xv,...GF,...jN,...Mp,...$F,...Tv,...Mp,...Zie,...$F]),Gpt=new Float32Array([...Mp.slice(0,2),...Cg.slice(0,2),...xv.slice(0,2),...Mp.slice(0,2),...Tv.slice(0,2),...Cg.slice(0,2),...Mp.slice(0,2),...Cg.slice(0,2),...xv.slice(0,2),...Mp.slice(0,2),...Tv.slice(0,2),...Cg.slice(0,2),...xv.slice(0,2),...Tv.slice(0,2),...Mp.slice(0,2),...xv.slice(0,2),...Cg.slice(0,2),...Tv.slice(0,2),...Mp.slice(0,2),...Cg.slice(0,2),...xv.slice(0,2),...Mp.slice(0,2),...Tv.slice(0,2),...Cg.slice(0,2)]);function $pt(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:Vpt.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s*r}}),uv:Gpt}}const Jie=[0,0,0],Wpt=[1,0,0],Qie=[1,0,1],Ypt=[0,0,1],Xpt=new Float32Array([...Jie,...Qie,...Wpt,...Jie,...Ypt,...Qie]);function Kpt(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:Xpt.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s*r}}),uv:Gye}}const Zpt=hw(rx(tR)),ese=_v(ix(eR)),Jpt=new Vl({transparent:!1,side:$f,uniforms:{time:Rg,interval:b3,palette:new jn(Zpt),map:new jn(ese),alt:new jn(ese),data:new jn(null),size:new jn(new an),step:new jn(new an),flip:new jn(!0)},vertexShader:`
    varying vec2 vUv;
    void main() {
      vec4 mvPosition = vec4(position, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;
      vUv = uv;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform usampler2D data;
    uniform vec3 palette[16];
    uniform vec2 size;
    uniform vec2 step;
    uniform bool flip;
    varying vec2 vUv;

    ${R3}

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vUv * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      uvec4 tiledata = texture(data, vUv);
      int colori = int(tiledata.z);
      int bgi = int(tiledata.w);

      vec2 charPosition = mod(vUv, size) / size;
      vec2 uv = vec2(charPosition.x * step.x, charPosition.y * step.y);
      
      vec3 color;
      if (colori > 31) {
        vec3 bg = palette[bgi];
        color = palette[colori - 33];
        float cycle = mod(time * 2.5, interval * 2.0) / interval;
        color = mix(bg, color, cyclefromtime());
      } else {
        color = palette[colori % 16];
      }

      uv.x += step.x * float(tiledata.x);
      uv.y += step.y * float(tiledata.y);
      if (flip) {
        uv.y = 1.0 - uv.y;
      }

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${bn.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function Qpt(){return S3(Jpt)}function ab({width:n,height:e,alphas:t}){const[r]=it.useState(()=>Vye());it.useEffect(()=>{r.uniforms.data.value=qye(n,e)},[r.uniforms.data,n,e]),it.useEffect(()=>{Hye(r.uniforms.data.value,n,e,t)},[r,r.uniforms.data.value,n,e,t]);const{position:i,uv:s}=it.useMemo(()=>gG(n,e),[n,e]);return Le.jsxs("mesh",{children:[Le.jsx("primitive",{object:r,attach:"material"}),Le.jsxs("bufferGeometry",{children:[Le.jsx("bufferAttribute",{attach:"attributes-position",args:[i,3]}),Le.jsx("bufferAttribute",{attach:"attributes-uv",args:[s,2]})]})]})}function emt({width:n,height:e,alpha:t}){const r=it.useMemo(()=>new Array(n*e).fill(t),[n,e,t]);return Le.jsx(ab,{width:n,height:e,alphas:r})}const KM=new Nle,PS=new an;function _G({width:n,height:e,top:t,left:r,right:i,bottom:s,scale:a=.125,alpha:o=.25}){const l=it.useMemo(()=>{const c=new Array(n*e);KM.min.x=r,KM.min.y=t,KM.max.x=i,KM.max.y=s,PS.x=0,PS.y=0;for(let u=0;u<c.length;++u)c[u]=Aoe.smootherstep(1-KM.distanceToPoint(PS)*a,0,1)*o,++PS.x,PS.x>=n&&(PS.x=0,++PS.y);return c},[n,e,t,r,i,s,a,o]);return Le.jsx(ab,{width:n,height:e,alphas:l})}function tse(){}const tmt=Ng.forwardRef(function({args:e,children:t,...r},i){const s=Ng.useRef(null);return Ng.useImperativeHandle(i,()=>s.current),Le.jsxs("mesh",{ref:s,...r,children:[Le.jsx("planeGeometry",{attach:"geometry",args:e}),t]})}),Uv=Ng.forwardRef(function({blocking:e=!1,cursor:t="default",x:r=0,y:i=0,z:s=0,width:a=1,height:o=1,opacity:l=1,visible:c=!0,color:u="white",...f},h){const g=a*.5,p=o*.5,_=[(r+g)*Gn.DRAW_CHAR_WIDTH(),(i+p)*Gn.DRAW_CHAR_HEIGHT(),s];return Le.jsx(tmt,{ref:h,args:[a*Gn.DRAW_CHAR_WIDTH(),o*Gn.DRAW_CHAR_HEIGHT()],userData:{blocking:e,cursor:t},onClick:e?tse:void 0,onPointerMove:e?tse:void 0,position:_,...f,children:Le.jsx("meshBasicMaterial",{color:u,opacity:l,visible:c,transparent:l!==1})})});function Bv({width:n,height:e,char:t,color:r,bg:i,fliptexture:s=!0}){const a=Gc(p=>p.palettedata),o=Gc(p=>p.charsetdata),l=Gc(p=>p.altcharsetdata),[c]=it.useState(()=>Qpt()),{width:u=0,height:f=0}=o?.image??{};it.useEffect(()=>{n===0||e===0||(c.uniforms.data.value=qpt(n,e))},[c.uniforms.data,n,e]),it.useEffect(()=>{n===0||e===0||Hpt(c.uniforms.data.value,n,e,t,r,i)},[c.uniforms.data.value,n,e,t,r,i]),it.useEffect(()=>{n===0||e===0||!o||(c.uniforms.map.value=o,c.uniforms.alt.value=l??o,c.uniforms.palette.value=a,c.uniforms.size.value.x=1/n,c.uniforms.size.value.y=1/e,c.uniforms.step.value.x=1/Math.round(u/Jd),c.uniforms.step.value.y=1/Math.round(f/Qd),c.uniforms.flip.value=s,c.needsUpdate=!0)},[a,o,l,c,n,e,u,f,s]);const{position:h,uv:g}=it.useMemo(()=>gG(n,e),[n,e]);return Le.jsxs("mesh",{children:[Le.jsxs("bufferGeometry",{children:[Le.jsx("bufferAttribute",{attach:"attributes-position",args:[h,3]}),Le.jsx("bufferAttribute",{attach:"attributes-uv",args:[g,2]})]}),Le.jsx("primitive",{object:c,attach:"material"})]})}function _x({store:n,children:e}){return Le.jsx(aV.Provider,{value:n,children:e})}function vx({width:n,height:e}){const t=it.useContext(aV),[r,i,s]=sV(t,Uh(a=>[a.char,a.color,a.bg,a.render]));return n>0&&e>0&&Le.jsx(Bv,{char:r.slice(),color:i.slice(),bg:s.slice(),width:n,height:e})}const z1=navigator.userAgent.includes("Mac"),nmt=navigator.userAgent.includes("Linux"),y0=z1?"cmd":"ctrl";function A3({x:n,y:e,width:t,height:r,debug:i,...s}){const a=Gn.DRAW_CHAR_WIDTH(),o=Gn.DRAW_CHAR_HEIGHT();return Le.jsx(qht,{...s,args:[t*a,r*o],position:[(n??0)*a+t*a*.5,(e??0)*o+r*o*.5,0],children:Le.jsx("meshBasicMaterial",{transparent:!0,opacity:i?.7:0,color:"red"})})}const nse=z1?"Meta":"Ctrl";function HN({x:n,y:e,letters:t,digit:r,usealt:i,usectrl:s}){const a=Fh(),{keyboardshift:o,keyboardctrl:l,keyboardalt:c}=km();if(a.x=n,a.y=e,fi("$219$219$219$219$219",a,!1),a.x=n,a.y=e+1,fi("$219$178$178$178$219",a,!1),a.x=n,a.y=e+2,fi("$219$219$219$219$219",a,!1),t&&(a.x=n+(t.startsWith("$")?2:Math.round(2.5-t.length*.5)),a.y=e,fi(o?t.toUpperCase():t.toLowerCase(),a,!1)),r.trim().length===1){a.x=n+2,a.y=e+2;const u=r==="$"?"$$":r;fi(o?u.toUpperCase():u.toLowerCase(),a,!1)}return Le.jsx(A3,{x:n,y:e,width:5,height:3,onPointerDown:()=>{let u="";c&&i&&(u+="{Alt>}"),l&&s&&(u+=`{${nse}>}`),o&&(u+="{Shift>}"),u+=r.length===1?r.replace("[","[[").replace("{","{{"):r,c&&i&&(u+="{/Alt}"),l&&s&&(u+=`{/${nse}}`),o&&(u+="{/Shift}"),y_.keyboard(u).catch(bm)}})}function Iy({x:n,y:e,letters:t,onToggle:r}){const i=Fh();return i.x=n,i.y=e,fi("$178$178$178$178$178",i,!1),i.x=n,i.y=e+1,fi("$178$177$177$177$178",i,!1),i.x=n,i.y=e+2,fi("$178$178$178$178$178",i,!1),t&&(i.x=n+Math.round(2.5-t.length*.5),i.y=e,fi(t,i,!1)),Le.jsx(A3,{x:n,y:e,width:5,height:3,onPointerDown:()=>{r()}})}function rmt({width:n}){const e=Fh(),{keyboardalt:t,keyboardctrl:r,keyboardshift:i}=km(),s=n-18,a=n-12,o=n-6,l=Math.round(n*.5)-3,c=o,u=12;e.x=c,e.y=u,fi("$178$178$178$178$178",e,!1),e.x=c,e.y=u+1,fi("$178$177$177$177$178",e,!1),e.x=c,e.y=u+2,fi("$178$178$178$178$178",e,!1);const f="shoot";e.x=c+Math.round(2.5-f.length*.5),e.y=u,fi(f,e,!1);function h(){y_.keyboard("{/Shift}").catch(bm)}return Le.jsxs(Le.Fragment,{children:[Le.jsx(Iy,{x:1,y:0,letters:r?"CTRL":"ctrl",onToggle:()=>{km.setState({keyboardctrl:!r})}}),Le.jsx(Iy,{x:7,y:1,letters:t?"ALT":"alt",onToggle:()=>{km.setState({keyboardalt:!t})}}),Le.jsx(Iy,{x:13,y:0,letters:i?"SHIFT":"shift",onToggle:()=>{km.setState({keyboardshift:!i})}}),Le.jsx(Iy,{x:s,y:0,letters:"menu",onToggle:()=>{y_.keyboard("[Tab]").catch(bm)}}),Le.jsx(Iy,{x:a,y:1,letters:"okay",onToggle:()=>{y_.keyboard("[Enter]").catch(bm)}}),Le.jsx(Iy,{x:o,y:0,letters:"cancel",onToggle:()=>{y_.keyboard("[Escape]").catch(bm)}}),Le.jsx(Iy,{x:1,y:12,letters:"?",onToggle:()=>{y_.keyboard("{Shift>}?{/Shift}").catch(bm)}}),Le.jsx(Iy,{x:7,y:13,letters:"#",onToggle:()=>{y_.keyboard("3").catch(bm)}}),Le.jsx(Iy,{x:13,y:12,letters:"c",onToggle:()=>{y_.keyboard("c").catch(bm)}}),Le.jsx(HN,{x:l,y:0,letters:"$24",digit:"[ArrowUp]",usealt:!0}),Le.jsx(HN,{x:l,y:13,letters:"$25",digit:"[ArrowDown]",usealt:!0}),Le.jsx(HN,{x:n-6,y:6,letters:"$26",digit:"[ArrowRight]",usealt:!0,usectrl:!0}),Le.jsx(HN,{x:0,y:6,letters:"$27",digit:"[ArrowLeft]",usealt:!0,usectrl:!0}),Le.jsx(A3,{x:o,y:12,width:5,height:3,onPointerDown:()=>{y_.keyboard("{Shift>}").catch(bm)},onPointerUp:h,onPointerLeave:h,onPointerCancel:h})]})}var BP={exports:{}},imt=BP.exports,rse;function smt(){return rse||(rse=1,(function(n,e){(function(t,r){n.exports=r()})(imt,(()=>(()=>{var t={944:function(a){var o;o=()=>(()=>{var l={d:(v,x)=>{for(var E in x)l.o(x,E)&&!l.o(v,E)&&Object.defineProperty(v,E,{enumerable:!0,get:x[E]})},o:(v,x)=>Object.prototype.hasOwnProperty.call(v,x)},c={};function u(v){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},u(v)}function f(v,x){var E=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!E){if(Array.isArray(v)||(E=g(v))||x){E&&(v=E);var M=0,k=function(){};return{s:k,n:function(){return M>=v.length?{done:!0}:{done:!1,value:v[M++]}},e:function(V){throw V},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var N,I=!0,D=!1;return{s:function(){E=E.call(v)},n:function(){var V=E.next();return I=V.done,V},e:function(V){D=!0,N=V},f:function(){try{I||E.return==null||E.return()}finally{if(D)throw N}}}}function h(v,x){return(function(E){if(Array.isArray(E))return E})(v)||(function(E,M){var k=E==null?null:typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(k!=null){var N,I,D,V,G=[],J=!0,B=!1;try{if(D=(k=k.call(E)).next,M!==0)for(;!(J=(N=D.call(k)).done)&&(G.push(N.value),G.length!==M);J=!0);}catch($){B=!0,I=$}finally{try{if(!J&&k.return!=null&&(V=k.return(),Object(V)!==V))return}finally{if(B)throw I}}return G}})(v,x)||g(v,x)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function g(v,x){if(v){if(typeof v=="string")return p(v,x);var E=Object.prototype.toString.call(v).slice(8,-1);return E==="Object"&&v.constructor&&(E=v.constructor.name),E==="Map"||E==="Set"?Array.from(v):E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E)?p(v,x):void 0}}function p(v,x){(x==null||x>v.length)&&(x=v.length);for(var E=0,M=new Array(x);E<x;E++)M[E]=v[E];return M}function _(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")}l.d(c,{default:()=>y});var y=(function(){function v(){var M=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];_(this,v),this.strict=M,this.defaults=new Map,this.validators=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var x,E;return x=v,(E=[{key:"allowExtra",value:function(){return this.strict=!1,this}},{key:"setDefaults",value:function(M){var k=this;return Object.entries(M).forEach((function(N){var I=h(N,2),D=I[0],V=I[1];return k.defaults.set(D,V)})),this}},{key:"setValidators",value:function(M){var k=this;return Object.entries(M).forEach((function(N){var I=h(N,2),D=I[0],V=I[1];return k.validators.set(D,V)})),this}},{key:"setTypes",value:function(M){var k=this;return Object.entries(M).forEach((function(N){var I=h(N,2),D=I[0],V=I[1];return k.types.set(D,V)})),this}},{key:"setOptional",value:function(M){var k=this;return M.forEach((function(N){return k.optional.add(N)})),this}},{key:"setRequired",value:function(M){var k=this;return M.forEach((function(N){return k.required.add(N)})),this}},{key:"resolve",value:function(M){return this.validate(Object.assign(this.getDefaults(),M))}},{key:"getDefaults",value:function(){var M,k={},N=f(this.defaults);try{for(N.s();!(M=N.n()).done;){var I=h(M.value,2),D=I[0],V=I[1];k[D]=V}}catch(G){N.e(G)}finally{N.f()}return k}},{key:"validate",value:function(M){for(var k in M)this.validators.has(k)&&(M[k]=this.validators.get(k)(M[k]));for(var N in M){if(!this.optionExists(N))throw new Error('Unkown option "'.concat(N,'".'));this.checkType(N,M[N])}var I,D=f(this.required.values());try{for(D.s();!(I=D.n()).done;){var V=I.value;if(M[V]===void 0)throw new Error('Option "'.concat(V,'" is required.'))}}catch(G){D.e(G)}finally{D.f()}return M}},{key:"checkType",value:function(M,k){if(this.types.has(M)){var N=this.types.get(M),I=u(k);if(I!==N)throw new Error('Wrong value for option "'.concat(M,'": expected type "').concat(N,'", got "').concat(I,'".'))}}},{key:"optionExists",value:function(M){return!this.strict||this.defaults.has(M)||this.validators.has(M)||this.optional.has(M)||this.required.has(M)||this.types.has(M)}}])&&(function(M,k){for(var N=0;N<k.length;N++){var I=k[N];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(M,(D=(function(V,G){if(u(V)!=="object"||V===null)return V;var J=V[Symbol.toPrimitive];if(J!==void 0){var B=J.call(V,"string");if(u(B)!=="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(V)})(I.key),u(D)==="symbol"?D:String(D)),I)}var D})(x.prototype,E),Object.defineProperty(x,"prototype",{writable:!1}),v})();return c.default})(),a.exports=o()},162:function(a){a.exports=(()=>{var o={d:(u,f)=>{for(var h in f)o.o(f,h)&&!o.o(u,h)&&Object.defineProperty(u,h,{enumerable:!0,get:f[h]})},o:(u,f)=>Object.prototype.hasOwnProperty.call(u,f)},l={};o.d(l,{default:()=>c});var c=(function(){function u(){(function(h,g){if(!(h instanceof g))throw new TypeError("Cannot call a class as a function")})(this,u),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var f;return(f=[{key:"emit",value:function(h,g){if(Object.prototype.hasOwnProperty.call(this._events,h))for(var p=this._events[h],_={type:h,detail:g},y=p.length,v=0;v<y;v++)this.handle(p[v],_)}},{key:"handle",value:function(h,g){h(g)}},{key:"addEventListener",value:function(h,g){Object.prototype.hasOwnProperty.call(this._events,h)||(this._events[h]=[]),this._events[h].indexOf(g)<0&&this._events[h].push(g)}},{key:"removeEventListener",value:function(h,g){if(Object.prototype.hasOwnProperty.call(this._events,h)){var p=this._events[h],_=p.indexOf(g);_>=0&&p.splice(_,1),p.length===0&&delete this._events[h]}}}])&&(function(h,g){for(var p=0;p<g.length;p++){var _=g[p];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(h,_.key,_)}})(u.prototype,f),u})();return l.default})()}},r={};function i(a){var o=r[a];if(o!==void 0)return o.exports;var l=r[a]={exports:{}};return t[a].call(l.exports,l,l.exports,i),l.exports}i.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return i.d(o,{a:o}),o},i.d=(a,o)=>{for(var l in o)i.o(o,l)&&!i.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})},i.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),i.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var s={};return(()=>{i.r(s),i.d(s,{GamepadHandler:()=>M,GamepadListener:()=>q});var a=i(162),o=i.n(a),l=i(944),c=i.n(l);function u(Y){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},u(Y)}function f(Y,ae){if(!(Y instanceof ae))throw new TypeError("Cannot call a class as a function")}function h(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,y(K.key),K)}}function g(Y,ae){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,K){return Z.__proto__=K,Z},g(Y,ae)}function p(Y,ae){if(ae&&(u(ae)==="object"||typeof ae=="function"))return ae;if(ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(Z){if(Z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z})(Y)}function _(Y){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ae){return ae.__proto__||Object.getPrototypeOf(ae)},_(Y)}function y(Y){var ae=(function(Z,K){if(u(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(u(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return u(ae)==="symbol"?ae:String(ae)}var v,x,E,M=(function(Y){(function(Me,qe){if(typeof qe!="function"&&qe!==null)throw new TypeError("Super expression must either be null or a function");Me.prototype=Object.create(qe&&qe.prototype,{constructor:{value:Me,writable:!0,configurable:!0}}),Object.defineProperty(Me,"prototype",{writable:!1}),qe&&g(Me,qe)})(de,Y);var ae,Z,K,ne,le,ce=(ne=de,le=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Me,qe=_(ne);if(le){var Ne=_(this).constructor;Me=Reflect.construct(qe,arguments,Ne)}else Me=qe.apply(this,arguments);return p(this,Me)});function de(Me,qe){var Ne,Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return f(this,de),(Ne=ce.call(this)).index=Me,Ne.gamepad=qe,Ne.options=Ne.constructor.resolveOptions(Ae),Ne.axes=new Array(qe.axes.length).fill(null),Ne.buttons=new Array(qe.buttons.length).fill(null),Ne.initAxes(),Ne.initButtons(),Ne}return ae=de,K=[{key:"resolveOptions",value:function(Me){var qe,Ne,Ae,Xe,$e=Me.axis,at=Me.button;return{axis:this.optionResolver.resolve((qe=(Ne=$e??at)!==null&&Ne!==void 0?Ne:Me)!==null&&qe!==void 0?qe:{}),button:this.optionResolver.resolve((Ae=(Xe=at??$e)!==null&&Xe!==void 0?Xe:Me)!==null&&Ae!==void 0?Ae:{})}}}],(Z=[{key:"initAxes",value:function(){for(var Me=this.axes.length,qe=0;qe<Me;qe++)this.axes[qe]=this.resolveAxisValue(qe)}},{key:"initButtons",value:function(){for(var Me=this.buttons.length,qe=0;qe<Me;qe++)this.buttons[qe]=this.resolveButtonValue(qe)}},{key:"update",value:function(Me){this.gamepad=Me,this.updateAxis(),this.updateButtons()}},{key:"updateAxis",value:function(){for(var Me=this.axes.length,qe=0;qe<Me;qe++)this.setAxisValue(qe,this.resolveAxisValue(qe))}},{key:"updateButtons",value:function(){for(var Me=this.buttons.length,qe=0;qe<Me;qe++)this.setButtonValue(qe,this.resolveButtonValue(qe))}},{key:"setAxisValue",value:function(Me,qe){this.axes[Me]!==qe&&(this.axes[Me]=qe,this.emit("axis",{gamepad:this.gamepad,index:this.index,axis:Me,value:qe}))}},{key:"setButtonValue",value:function(Me,qe){this.buttons[Me]!==qe&&(this.buttons[Me]=qe,this.emit("button",{gamepad:this.gamepad,index:this.index,button:Me,pressed:this.gamepad.buttons[Me].pressed,value:qe}))}},{key:"resolveAxisValue",value:function(Me){var qe=this.options.axis,Ne=qe.deadZone,Ae=qe.analog,Xe=qe.precision,$e=this.gamepad.axes[Me];return Ne&&$e<Ne&&$e>-Ne?0:Ae?Xe?Math.round($e*Xe)/Xe:$e:$e>0?1:$e<0?-1:0}},{key:"resolveButtonValue",value:function(Me){var qe=this.options.button,Ne=qe.deadZone,Ae=qe.analog,Xe=qe.precision,$e=this.gamepad.buttons[Me].value;return Ne>0&&$e<Ne&&$e>-Ne?0:Ae?Xe?Math.round($e*Xe)/Xe:$e:$e===0?0:1}}])&&h(ae.prototype,Z),K&&h(ae,K),Object.defineProperty(ae,"prototype",{writable:!1}),de})(o());function k(Y){return k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},k(Y)}function N(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,I(K.key),K)}}function I(Y){var ae=(function(Z,K){if(k(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(k(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return k(ae)==="symbol"?ae:String(ae)}v=M,x="optionResolver",E=new(c())().setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"}).setValidators({deadZone:function(Y){return Math.max(Math.min(Y,1),0)},precision:function(Y){return Y>0?Math.pow(10,Y):0}}),(x=y(x))in v?Object.defineProperty(v,x,{value:E,enumerable:!0,configurable:!0,writable:!0}):v[x]=E;var D=(function(){function Y(K){(function(ne,le){if(!(ne instanceof le))throw new TypeError("Cannot call a class as a function")})(this,Y),this.callback=K,this.frame=null,this.update=this.update.bind(this)}var ae,Z;return ae=Y,(Z=[{key:"setCallback",value:function(K){this.callback=K}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&N(ae.prototype,Z),Object.defineProperty(ae,"prototype",{writable:!1}),Y})();function V(Y){return V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},V(Y)}function G(Y,ae){if(!(Y instanceof ae))throw new TypeError("Cannot call a class as a function")}function J(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,B(K.key),K)}}function B(Y){var ae=(function(Z,K){if(V(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(V(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return V(ae)==="symbol"?ae:String(ae)}function $(Y,ae){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,K){return Z.__proto__=K,Z},$(Y,ae)}function U(Y,ae){if(ae&&(V(ae)==="object"||typeof ae=="function"))return ae;if(ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(Y)}function Q(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function W(Y){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ae){return ae.__proto__||Object.getPrototypeOf(ae)},W(Y)}var q=(function(Y){(function(de,Me){if(typeof Me!="function"&&Me!==null)throw new TypeError("Super expression must either be null or a function");de.prototype=Object.create(Me&&Me.prototype,{constructor:{value:de,writable:!0,configurable:!0}}),Object.defineProperty(de,"prototype",{writable:!1}),Me&&$(de,Me)})(ce,Y);var ae,Z,K,ne,le=(K=ce,ne=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var de,Me=W(K);if(ne){var qe=W(this).constructor;de=Reflect.construct(Me,arguments,qe)}else de=Me.apply(this,arguments);return U(this,de)});function ce(){var de,Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(G(this,ce),de=le.call(this),typeof navigator.getGamepads!="function")throw new Error("This browser does not support gamepad API.");return de.options=Me,de.onAxis=de.onAxis.bind(Q(de)),de.update=de.update.bind(Q(de)),de.start=de.start.bind(Q(de)),de.stop=de.stop.bind(Q(de)),de.discover=de.discover.bind(Q(de)),de.onButton=de.onButton.bind(Q(de)),de.handlers=new Array(4).fill(null),de.loop=new D(de.update),window.addEventListener("error",de.stop),de}return ae=ce,(Z=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var de=navigator.getGamepads();this.discover(de[0],0),this.discover(de[1],1),this.discover(de[2],2),this.discover(de[3],3)}},{key:"discover",value:function(de,Me){de?(this.handlers[Me]===null&&this.registerHandler(Me,de),this.handlers[Me].update(de)):this.handlers[Me]&&this.removeGamepad(Me)}},{key:"registerHandler",value:function(de,Me){var qe=new M(de,Me,this.options);this.handlers[de]=qe,qe.addEventListener("axis",this.onAxis),qe.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:de,gamepad:Me}),this.emit("gamepad:".concat(de,":connected"),{index:de,gamepad:Me})}},{key:"removeGamepad",value:function(de){var Me=this.handlers[de];Me.removeEventListener("axis",this.onAxis),Me.removeEventListener("button",this.onButton),this.handlers[de]=null,this.emit("gamepad:disconnected",{index:de}),this.emit("gamepad:".concat(de,":disconnected"),{index:de})}},{key:"onAxis",value:function(de){var Me=de.detail.index;this.emit("gamepad:axis",de.detail),this.emit("gamepad:".concat(Me,":axis"),de.detail),this.emit("gamepad:".concat(Me,":axis:").concat(de.detail.axis),de.detail)}},{key:"onButton",value:function(de){var Me=de.detail.index;this.emit("gamepad:button",de.detail),this.emit("gamepad:".concat(Me,":button"),de.detail),this.emit("gamepad:".concat(Me,":button:").concat(de.detail.button),de.detail)}}])&&J(ae.prototype,Z),Object.defineProperty(ae,"prototype",{writable:!1}),ce})(o())})(),s})()))})(BP)),BP.exports}var amt=smt(),p_={},ise;function omt(){if(ise)return p_;ise=1,Object.defineProperty(p_,"__esModule",{value:!0});for(var n=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),e={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},t={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:n?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},r={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=1;i<20;i++)r["f"+i]=111+i;function s(h,g,p){g&&!("byKey"in g)&&(p=g,g=null),Array.isArray(h)||(h=[h]);var _=h.map(function(x){return l(x,g)}),y=function(E){return _.some(function(M){return c(M,E)})},v=p==null?y:y(p);return v}function a(h,g){return s(h,g)}function o(h,g){return s(h,{byKey:!0},g)}function l(h,g){var p=g&&g.byKey,_={};h=h.replace("++","+add");var y=h.split("+"),v=y.length;for(var x in e)_[e[x]]=!1;var E=!0,M=!1,k=void 0;try{for(var N=y[Symbol.iterator](),I;!(E=(I=N.next()).done);E=!0){var D=I.value,V=D.endsWith("?")&&D.length>1;V&&(D=D.slice(0,-1));var G=f(D),J=e[G];if(D.length>1&&!J&&!t[D]&&!r[G])throw new TypeError('Unknown modifier: "'+D+'"');(v===1||!J)&&(p?_.key=G:_.which=u(D)),J&&(_[J]=V?null:!0)}}catch(B){M=!0,k=B}finally{try{!E&&N.return&&N.return()}finally{if(M)throw k}}return _}function c(h,g){for(var p in h){var _=h[p],y=void 0;if(_!=null&&(p==="key"&&g.key!=null?y=g.key.toLowerCase():p==="which"?y=_===91&&g.which===93?91:g.which:y=g[p],!(y==null&&_===!1)&&y!==_))return!1}return!0}function u(h){h=f(h);var g=r[h]||h.toUpperCase().charCodeAt(0);return g}function f(h){return h=h.toLowerCase(),h=t[h]||h,h}return p_.default=s,p_.isHotkey=s,p_.isCodeHotkey=a,p_.isKeyHotkey=o,p_.parseHotkey=l,p_.compareHotkey=c,p_.toKeyCode=u,p_.toKeyName=f,p_}var lmt=omt();const sse=Bh(lmt);function $ye(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}const vE={};function vG(n){return`${as()}local${n}`}const cmt=1e3,vT={};let WF=0,ase=performance.now();const zw=uU*10,ose=[Tn.MOVE_UP,Tn.MOVE_DOWN,Tn.MOVE_LEFT,Tn.MOVE_RIGHT,Tn.OK_BUTTON,Tn.CANCEL_BUTTON,Tn.MENU_BUTTON];function Wye(){const n=performance.now(),e=n-ase,t=ub(vE);for(let r=0;r<t.length;++r){const i=parseFloat(t[r]);if(vT[i]=vT[i]??0,vT[i]+=e,vT[i]>=zw){vT[i]-=zw;const s=vE[i],a={alt:!!s[Tn.ALT],ctrl:!!s[Tn.CTRL],shift:!!s[Tn.SHIFT]};for(let o=0;o<ose.length;++o){const l=ose[o];s[l]&&Xye(i,l,a)}}}if(++WF,ase=n,setTimeout(Wye,10),WF>cmt){WF=0;const r=ub(vE);for(let i=1;i<r.length;++i){const s=parseFloat(r[i]);Tce(St,vG(s))}}}Wye();function yG(n){return vE[n]=vE[n]??{[Tn.NONE]:!1,[Tn.ALT]:!1,[Tn.CTRL]:!1,[Tn.SHIFT]:!1,[Tn.MOVE_UP]:!1,[Tn.MOVE_DOWN]:!1,[Tn.MOVE_LEFT]:!1,[Tn.MOVE_RIGHT]:!1,[Tn.OK_BUTTON]:!1,[Tn.CANCEL_BUTTON]:!1,[Tn.MENU_BUTTON]:!1},vE[n]}function zl(n,e){const t=yG(n);t[e]||(vT[n]=zw*-2,Xye(n,e,{alt:t[Tn.ALT],ctrl:t[Tn.CTRL],shift:t[Tn.SHIFT]})),t[e]=!0}function Ba(n,e){const t=yG(n);t[e]=!1}const bv={root:$ye(),ignorehotkeys:!1},Yye=it.createContext(bv.root);function C3(n){return{alt:n.altKey,ctrl:z1?n.metaKey:n.ctrlKey,shift:n.shiftKey}}function Xye(n,e,t){if(n===0)bv.root.emit(Tn[e],t);else{let r=0;const i=vG(n);t.alt&&(r|=CH),t.ctrl&&(r|=MH),t.shift&&(r|=OH),wce(St,i,e,r)}}window.addEventListener("wheel",n=>{n.preventDefault()},{passive:!1});window.addEventListener("keydown",n=>{const e=Vr(n.key),t=C3(n),r=as();switch(e){case"s":case"r":case"j":case"o":case"f":case"z":case"y":case"e":case"k":case"a":case"p":case"h":case"[":case"]":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"delete":case"backspace":(t.alt||t.ctrl||t.shift)&&n.preventDefault();break;case"tab":case"arrowleft":case"arrowright":case"arrowup":case"arrowdown":case"/":n.preventDefault();break}switch(t.alt?zl(0,Tn.ALT):Ba(0,Tn.ALT),t.ctrl?zl(0,Tn.CTRL):Ba(0,Tn.CTRL),t.shift?zl(0,Tn.SHIFT):Ba(0,Tn.SHIFT),e){case"arrowleft":zl(0,Tn.MOVE_LEFT);break;case"arrowright":zl(0,Tn.MOVE_RIGHT);break;case"arrowup":zl(0,Tn.MOVE_UP);break;case"arrowdown":zl(0,Tn.MOVE_DOWN);break;case"enter":zl(0,Tn.OK_BUTTON);break;case"esc":case"escape":zl(0,Tn.CANCEL_BUTTON);break;case"tab":zl(0,Tn.MENU_BUTTON);break;case"r":t.ctrl&&V3e(St,r);break;case"s":t.ctrl&&Av(St,r,"#save");break;case"j":t.ctrl&&Av(St,r,t.shift?"#jointab hush":"#jointab");break;case"o":t.ctrl&&Av(St,r,t.shift?"#joincode hush":"#joincode");break;case"l":break;case"f":t.ctrl&&Av(St,r,"#fork");break;case"k":t.ctrl&&oIe(St,r)}bv.root.emit("keydown",n)},{capture:!0});window.addEventListener("keyup",n=>{const e=Vr(n.key),t=C3(n);switch(t.alt?zl(0,Tn.ALT):Ba(0,Tn.ALT),t.ctrl?zl(0,Tn.CTRL):Ba(0,Tn.CTRL),t.shift?zl(0,Tn.SHIFT):Ba(0,Tn.SHIFT),e){case"meta":Ba(0,Tn.MOVE_LEFT),Ba(0,Tn.MOVE_RIGHT),Ba(0,Tn.MOVE_UP),Ba(0,Tn.MOVE_DOWN);break;case"arrowleft":Ba(0,Tn.MOVE_LEFT);break;case"arrowright":Ba(0,Tn.MOVE_RIGHT);break;case"arrowup":Ba(0,Tn.MOVE_UP);break;case"arrowdown":Ba(0,Tn.MOVE_DOWN);break;case"enter":Ba(0,Tn.OK_BUTTON);break;case"esc":case"escape":Ba(0,Tn.CANCEL_BUTTON);break;case"tab":Ba(0,Tn.MENU_BUTTON);break}},{capture:!0});Y1("userinput",[],n=>{switch(n.target){case"up":Mn(n.data)&&Ba(0,n.data);break;case"down":Mn(n.data)&&zl(0,n.data);break}});const Kye=0,Zye=1,Jye=2,Qye=3,umt=4,fmt=5,hmt=6,dmt=7,pmt=9,mmt=12,gmt=13,_mt=14,vmt=15,YF={[Qye]:Tn.MOVE_UP,[Kye]:Tn.MOVE_DOWN,[Jye]:Tn.MOVE_LEFT,[Zye]:Tn.MOVE_RIGHT,[umt]:Tn.OK_BUTTON,[fmt]:Tn.CANCEL_BUTTON,[hmt]:Tn.SHIFT,[dmt]:Tn.SHIFT,[pmt]:Tn.MENU_BUTTON,[mmt]:Tn.MOVE_UP,[gmt]:Tn.MOVE_DOWN,[_mt]:Tn.MOVE_LEFT,[vmt]:Tn.MOVE_RIGHT},XF={};function ymt(n){return XF[n]=XF[n]??{},XF[n]}function bmt(n,e,t){const r=ymt(n),i=rE(r[0]??0,r[1]??0),s=rE(r[2]??0,r[3]??0);r[e]=t;const a=rE(r[0]??0,r[1]??0),o=rE(r[2]??0,r[3]??0);if(i!==a)switch(Ba(n,Tn.MOVE_LEFT),Ba(n,Tn.MOVE_RIGHT),Ba(n,Tn.MOVE_UP),Ba(n,Tn.MOVE_DOWN),a){case Hn.NORTH:zl(n,Tn.MOVE_UP);break;case Hn.SOUTH:zl(n,Tn.MOVE_DOWN);break;case Hn.WEST:zl(n,Tn.MOVE_LEFT);break;case Hn.EAST:zl(n,Tn.MOVE_RIGHT);break}if(s!==o)switch(o===Hn.IDLE?Ba(n,Tn.SHIFT):zl(n,Tn.SHIFT),Ba(n,Tn.MOVE_LEFT),Ba(n,Tn.MOVE_RIGHT),Ba(n,Tn.MOVE_UP),Ba(n,Tn.MOVE_DOWN),o){case Hn.NORTH:zl(n,Tn.MOVE_UP);break;case Hn.SOUTH:zl(n,Tn.MOVE_DOWN);break;case Hn.WEST:zl(n,Tn.MOVE_LEFT);break;case Hn.EAST:zl(n,Tn.MOVE_RIGHT);break}}const M3=new amt.GamepadListener({analog:!1,deadZone:.3});M3.on("gamepad:connected",n=>{const e=as();Ts(St,e,`connected ${n.detail.gamepad.id}`),yG(n.detail.index),n.detail.index>0&&iIe(St,vG(n.detail.index))});M3.on("gamepad:disconnected",n=>{const e=as();Ts(St,e,`disconnected gamepad ${n.detail.index}`),delete vE[n.detail.index]});M3.on("gamepad:axis",n=>{bmt(n.detail.index,n.detail.axis,n.detail.value)});M3.on("gamepad:button",n=>{const e=n.detail.index;switch(n.detail.button){case Jye:case Zye:case Qye:case Kye:Ba(e,Tn.MOVE_UP),Ba(e,Tn.MOVE_DOWN),Ba(e,Tn.MOVE_LEFT),Ba(e,Tn.MOVE_RIGHT),n.detail.value?(zl(n.detail.index,Tn.SHIFT),zl(n.detail.index,YF[n.detail.button])):Ba(n.detail.index,Tn.SHIFT);break;default:n.detail.value?zl(n.detail.index,YF[n.detail.button]):Ba(n.detail.index,YF[n.detail.button]);break}});M3.start();const lse="keyup";function VT({hotkey:n,althotkey:e,children:t}){return it.useEffect(()=>{const r=sse(n,{byKey:!0}),i=xe(e)?sse(e,{byKey:!0}):void 0;function s(a){bv.ignorehotkeys===!1&&(r(a)||i?.(a))&&t()}return document.addEventListener(lse,s,!1),()=>document.removeEventListener(lse,s,!1)},[n,e,t]),null}function $c(n){const e=it.useContext(Yye);return it.useEffect(()=>{const t=Object.entries(n);return t.forEach(([r,i])=>e.on(r,i)),()=>{t.forEach(([r,i])=>e.off(r,i))}},[e,n]),null}function sS({blockhotkeys:n,children:e}){const[t]=it.useState(()=>$ye());return it.useEffect(()=>{const r=bv.root,i=bv.ignorehotkeys;return bv.root=t,bv.ignorehotkeys=!!n,()=>{bv.root=r,bv.ignorehotkeys=i}},[t,n]),Le.jsx(Yye.Provider,{value:t,children:e})}function Smt(n){const{keyboardshift:e,keyboardctrl:t,keyboardalt:r}=km.getState();let i="";switch(r&&(i+="{Alt>}"),t&&(i+="{Ctrl>}"),e&&(i+="{Shift>}"),n){case 0:i+="[ArrowLeft]";break;case 45:i+="[ArrowLeft][ArrowUp]";break;case 90:i+="[ArrowUp]";break;case 135:i+="[ArrowRight][ArrowUp]";break;case 180:i+="[ArrowRight]";break;case 225:i+="[ArrowRight][ArrowDown]";break;case 270:i+="[ArrowDown]";break;case 315:i+="[ArrowLeft][ArrowDown]";break;case 360:i+="[ArrowLeft]";break}r&&(i+="{/Alt}"),t&&(i+="{/Ctrl}"),e&&(i+="{/Shift}"),y_.keyboard(i).catch(bm)}const Emt=zw/1e3,ZM=new an,o4=new ut;function KF(n,e){const t=Gn.DRAW_CHAR_WIDTH(),r=Gn.DRAW_CHAR_HEIGHT(),i=o4.x+t*.5,s=o4.y+r*.5;return{cx:Math.floor(n*.5)+Math.floor(i/t),cy:Math.floor(e*.5)+Math.floor(s/r)}}const cse=4;function xmt({width:n,height:e,onUp:t,onDrawStick:r}){const[i]=it.useState({startx:-1,starty:-1,tipx:-1,tipy:-1,pointerid:-1,presscount:0,inputacc:zw});function s(a){i.pointerid===a.pointerId&&(--i.presscount,i.startx=-1,i.starty=-1,i.tipx=-1,i.tipy=-1,i.pointerid=-1,t())}return Wg((a,o)=>{if(i.inputacc+=o,i.inputacc>=Emt&&i.presscount>0){i.inputacc=0;const{cx:l,cy:c}=KF(n,e);if(ZM.set(i.startx-l,i.starty-c),i.tipx!==-1||ZM.length()>cse){const u=pce(Vke(ZM.angle()),45);Smt(u)}}}),Le.jsx(A3,{width:n,height:e,onPointerDown:a=>{if(++i.presscount,i.startx===-1){a.intersections[0].object.worldToLocal(o4.copy(a.intersections[0].point));const{cx:o,cy:l}=KF(n,e);i.startx=o,i.starty=l,i.tipx=-1,i.tipy=-1,i.pointerid=a.pointerId,i.inputacc=zw}},onPointerMove:a=>{if(a.pointerId===i.pointerid&&a.intersections[0]){a.intersections[0].object.worldToLocal(o4.copy(a.intersections[0].point));const{cx:o,cy:l}=KF(n,e);ZM.set(i.startx-o,i.starty-l),ZM.length()>cse*.25&&(i.tipx=o,i.tipy=l,r(i.startx,i.starty,i.tipx,i.tipy))}},onPointerUp:s,onPointerLeave:s,onPointerCancel:s})}const JM=new an,Tmt=177,wmt=bn.WHITE,Rmt=bn.DKPURPLE;function Amt({width:n,height:e,onReset:t}){const r=Fh();Zk(r,Tmt,wmt,Rmt);const i=Math.floor(n*.333),s=Math.round(n*.666);for(let a=0;a<e;++a)for(let o=i;o<=s;++o)pu(r,n,e,o,a,{char:176});return Le.jsxs(Le.Fragment,{children:[Le.jsx(A3,{x:0,y:-3,width:n,height:3,onPointerDown:()=>{km.setState(a=>({...a,sidebaropen:!a.sidebaropen}))}}),Le.jsx(rmt,{width:n}),Le.jsx(xmt,{width:n,height:e,onUp:t,onDrawStick:(a,o,l,c)=>{for(let u=0;u<5;++u)r.x=a-3,r.y=o-2+u,fi("$dkblue$177$177$177$177$177$177$177",r,!1);JM.x=l-a,JM.y=c-o,JM.normalize().multiplyScalar(4);for(let u=0;u<3;++u)r.x=a+Math.round(JM.x)-1,r.y=o+Math.round(JM.y)-1+u,fi("$blue$219$219$219",r,!1)}})]})}function Cmt({width:n,height:e}){const[t,r]=it.useState(0),i=kb(),s=177,a=bn.WHITE,o=bn.DKPURPLE,l=hx(n,e,s,a,o),c={...Tb(n,e,a,o),...l.getState()};return i.cols<10||i.rows<10?null:Le.jsxs(_x,{store:l,children:[Le.jsx(Kk.Provider,{value:c,children:Le.jsx(Amt,{width:n,height:e,onReset:()=>{Zk(c,s,a,o),r(Math.random())}},t)}),Le.jsx(vx,{width:n,height:e})]})}const ebe=it.createContext({cols:1,rows:1,marginx:1,marginy:1});function kb(){return it.useContext(ebe)}function Mmt({children:n}){const{viewport:e}=Nm(),{width:t,height:r}=e.getCurrentViewport(),{islandscape:i,showtouchcontrols:s}=km(),a=t/Gn.DRAW_CHAR_WIDTH();let o=Math.floor(a);const l=r/Gn.DRAW_CHAR_HEIGHT();let c=Math.floor(l);const u=(t-o*Gn.DRAW_CHAR_WIDTH())*.5,f=(r-c*Gn.DRAW_CHAR_HEIGHT())*.5;let h=0,g=0;const p=Math.round(a);let _=Math.round(l);return s&&(i?(h=5*Gn.DRAW_CHAR_WIDTH(),o-=10):(c=Math.floor(l)-16,_-=c,g=c*Gn.DRAW_CHAR_HEIGHT())),it.useEffect(()=>{km.setState(y=>({...y,insetcols:p,insetrows:_}))},[p,_]),Le.jsx(ebe.Provider,{value:{cols:o,rows:c,marginx:u,marginy:f},children:o>=10&&c>=10&&Le.jsx("group",{"scale-x":-1,"rotation-z":Math.PI,children:Le.jsxs("group",{position:[t*-.5+u,r*-.5+f,0],children:[Le.jsx("group",{position:[h,0,0],children:n}),s&&Le.jsx("group",{position:[0,g,1],children:Le.jsx(Cmt,{width:p,height:_},p*_)})]})})})}const aS=it.createContext({sendmessage(){},sendclose(){},didclose(){}}),use={input:{color:"$white",active:"$yellow"}};function Km(n){return n?use.input.active:use.input.color}function bG(n,e){return`vm:${n}:${e}`}function w2(n,e,t=0,r=""){return`${n.substring(0,e)}${r}${n.substring(e+t)}`}function Zm(n,e,t){xe(e)&&(t.x=n?1:0,t.y=e,t.disablewrap=!0)}const n1=32,tbe=8,Pz=new ut;function Omt(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(Pz.x/n),r=Math.floor(Pz.y/e);return{x:n1*.5+t,y:tbe*.5+r}}function kmt({sidebar:n,chip:e,row:t,label:r,args:i,context:s}){Zm(n,t,s);const[a]=[Bp(i[0],"")],o=K1(e,a),c=Yk(o)??0,u=Xg(),[f,h]=it.useState(!1);it.useLayoutEffect(()=>{h(!0)},[]);const g=`${c}`.padStart(3,"0"),p=r.trim(),_=s.x-1,y=s.y+2,v=[`$green${p} ${g}
$white`];for(let V=0;V<256;++V)if(V%n1===0&&v.push(`
`),V===c){const G=u?"$green$onwhite":"$white$ongreen";v.push(`${G}$${V}$white$ondkblue`)}else v.push(`$${V}`);const x=v.join("");fi(x,s,!0);const E=it.useContext(aS),M=it.useCallback(()=>{c>=n1&&Ip(o,c-n1)},[o,c]),k=it.useCallback(()=>{c>0&&Ip(o,c-1)},[o,c]),N=it.useCallback(()=>{c<255&&Ip(o,c+1)},[o,c]),I=it.useCallback(()=>{c<=255-n1&&Ip(o,c+n1)},[o,c]),D=it.useCallback(()=>{E.sendclose()},[E]);return Le.jsx("group",{position:[_*Gn.DRAW_CHAR_WIDTH(),y*Gn.DRAW_CHAR_HEIGHT(),1],children:f&&Le.jsxs(sS,{blockhotkeys:!0,children:[Le.jsx(Uv,{blocking:!0,visible:!1,width:n1,height:tbe,onClick:V=>{V.intersections[0].object.worldToLocal(Pz.copy(V.intersections[0].point));const G=_f(Omt(),n1);G>=0&&G<=255&&(Ip(o,G),E.sendclose())}}),Le.jsx($c,{MOVE_LEFT:k,MOVE_UP:M,MOVE_RIGHT:N,MOVE_DOWN:I,OK_BUTTON:D,CANCEL_BUTTON:D})]})})}const yT=8,nbe=2,Dz=new ut;function Imt(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(Dz.x/n),r=Math.floor(Dz.y/e);return{x:yT*.5+t,y:nbe*.5+r}}function Nmt(n){switch(n){case"dkyellow":return", brown";case"ltgray":return", ltgrey, gray, grey";case"dkgray":return", dkgrey, ltblack";case"ondkyellow":return", onbrown";case"onltgray":return", onltgrey, ongray, ongrey";case"ondkgray":return", ondkgrey, onltblack";case"bldkyellow":return", blbrown";case"blltgray":return", blltgrey, blgray, blgrey";case"bldkgray":return", bldkgrey, blltblack"}return""}const Pmt=[...uw(0,15),...uw(33,48)],Dmt=[...uw(0,15),32];function fse({sidebar:n,chip:e,row:t,label:r,args:i,context:s,isbg:a=!1}){Zm(n,t,s);const[o]=[Bp(i[0],"")],l=K1(e,o),u=Yk(l)??0,f=Xg(),[h,g]=it.useState(!1);it.useLayoutEffect(()=>{g(!0)},[]);const p=a?Dmt:Pmt,_=p.indexOf(u),y=`${u}`.padStart(2,"0"),v=r.trim(),x=(bn[u]||bn[bn.BLACK]).toLowerCase(),E=Nmt(x).padEnd(32," "),M=s.x-1,k=s.y+2,N=[`$green${v} ${y} ${x}${E}
$white`];for(let U=0;U<p.length;++U){U%yT===0&&N.push(`
`);const Q=p[U],W=(bn[Q]||bn[bn.BLACK]).toLowerCase();if(Q===u)if(f){const q=U%16<8?"white":"black";N.push(Q>32?"$onwhite$219":`$${q}$219`)}else N.push(`$onblack$${W}$219`);else N.push(`$onblack$${W}$219`)}N.push("$white"),fi(N.join(""),s,!0);const I=it.useContext(aS),D=it.useCallback(U=>{const Q=p[Li(U,0,p.length-1)];Ip(l,Q)},[p,l]),V=it.useCallback(()=>{D(_-yT)},[D,_]),G=it.useCallback(()=>{D(_-1)},[D,_]),J=it.useCallback(()=>{D(_+1)},[D,_]),B=it.useCallback(()=>{D(_+yT)},[D,_]),$=it.useCallback(()=>{I.sendclose()},[I]);return Le.jsx("group",{position:[M*Gn.DRAW_CHAR_WIDTH(),k*Gn.DRAW_CHAR_HEIGHT(),1],children:h&&Le.jsxs(sS,{blockhotkeys:!0,children:[Le.jsx(Uv,{blocking:!0,visible:!1,width:yT,height:nbe,onClick:U=>{U.intersections[0].object.worldToLocal(Dz.copy(U.intersections[0].point));const Q=Imt(),W=_f(Q,yT);W>=0&&W<=16&&(Ip(l,W),I.sendclose())}}),Le.jsx($c,{MOVE_LEFT:G,MOVE_UP:V,MOVE_RIGHT:J,MOVE_DOWN:B,OK_BUTTON:$,CANCEL_BUTTON:$})]})})}function Lmt({sidebar:n,item:e,row:t,context:r}){Zm(n,t,r);const i=Z0(r),s=kq(e);if(xe(s)){const a=i.width-3,l=Q1(s,a,3)?.measuredwidth??1,c=Li(Math.floor(a*.5-l*.5),0,a);fi(`${" ".repeat(c)}$WHITE${s}${xe(t)?`
`:""}`,r,!0)}else fi(`${e}${xe(t)?`
`:""}`,r,!0);return null}function Umt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const a=it.useContext(aS),o=it.useCallback(()=>{if(xe(el())){const c=[Bp(i[0],""),i[1]],[,...u]=c,f=u.join(" ");el().writeText(f).then(()=>{yce(St,as(),`copied! ${f}`),a.sendclose()}).catch(h=>console.error(h))}},[i,a]),l=Km(!!t);return Zm(n,e,s),fi(`  $purple$16 $yellowCOPYIT ${l}${r}`,s,!0),t&&Le.jsx($c,{OK_BUTTON:o})}function Bmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const[o,l,c,u]=[Bp(s[0],""),Bp(s[1],""),Bp(s[2],""),Bp(s[3],"")],f=c||` ${l.toUpperCase()} `,h=Km(r),g=a.x-.25,p=a.y-.25,_=`${a.iseven?"$black$onltgray":"$black$ondkcyan"}${f}${h}$onclear ${i}${xe(t)?`
`:""}`;fi(_,a,!0);const y=it.useContext(aS),v=it.useCallback(()=>{y.sendmessage(bG(e,o),[]),u||y.sendclose()},[e,y,o,u]);return Le.jsxs("group",{position:[g*Gn.DRAW_CHAR_WIDTH(),p*Gn.DRAW_CHAR_HEIGHT(),1],children:[Le.jsx(Uv,{visible:!1,width:f.length+.5,height:1.5,blocking:!0,onClick:v}),r&&Le.jsx($c,{OK_BUTTON:v}),l&&Le.jsx(VT,{hotkey:l,children:v})]})}function Fmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const o=s.map(g=>Bp(g,"")),[l,...c]=o,u=Km(r);fi(`  $purple$16 ${u}${i}
`,a,!0);const f=it.useContext(aS),h=it.useCallback(()=>{f.sendmessage(bG(e,l),c),f.sendclose()},[f,e,l,c]);return r&&Le.jsx($c,{OK_BUTTON:h})}const qN=-111111;function zmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const[o,l,c]=[Bp(s[0],""),vd(s[1],qN),vd(s[2],qN)];let u,f;l===qN?(u=0,f=31):c===qN?(u=0,f=l):(u=l,f=c);const h=K1(e,o),g=Yk(h),p=g??0,_=Xg(),[y,v]=it.useState(""),[x,E]=it.useState(0),[M,k]=it.useState(!1);let N=`${p}`;const I=i.trim(),D=Km(r);M&&(N=_?w2(y,x,1,"$219+"):y),a.writefullwidth=32,fi(` # ${D}${I} $green${N}`,a,!1),a.writefullwidth=void 0;const V=it.useCallback(B=>{const $=B.alt?10:1;Ip(h,Math.min(f,p+$))},[f,p,h]),G=it.useCallback(B=>{const $=B.alt?10:1;Ip(h,Math.max(u,p-$))},[u,p,h]),J=it.useCallback(()=>{k(B=>{const $=!B;if($){const U=`${g}`;v(U),E(U.length)}else{const U=parseFloat(y),Q=isNaN(U)?0:U;Ip(o,Math.min(f,Math.max(u,Q)))}return $})},[f,u,y,o,g]);return g!==void 0&&Le.jsxs(Le.Fragment,{children:[r&&!M&&Le.jsx($c,{MOVE_LEFT:G,MOVE_RIGHT:V,OK_BUTTON:J}),M&&Le.jsxs(sS,{blockhotkeys:!0,children:[Le.jsx(VT,{hotkey:"ctrl+c",children:()=>{console.info("copy")}}),Le.jsx(VT,{hotkey:"ctrl+v",children:()=>{console.info("paste")}}),Le.jsx(VT,{hotkey:"ctrl+a",children:()=>{console.info("select all")}}),Le.jsx($c,{MOVE_LEFT:()=>{E(B=>Math.max(0,B-1))},MOVE_RIGHT:()=>{E(B=>Math.min(y.length,B+1))},CANCEL_BUTTON:J,OK_BUTTON:J,keydown:B=>{switch(Vr(B.key)){case"delete":y.length>0&&v($=>w2($,x,1));break;case"backspace":x>0&&(v($=>w2($,x-1,1)),E($=>Math.max(0,$-1)));break}B.key.length===1&&y.length<a.width*.5&&(v($=>w2($,x,0,B.key)),E($=>$+1))}})]})]})}function jmt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const a=it.useCallback(()=>{const[,l,...c]=i,u=c.join(" "),f=as();switch(l){case"wiki":ic(St,f,async()=>{const h=await dH(u);AH(f,h)});break;case"inline":window.location.href=u;break;default:window.open(`${l} ${u}`.trim(),"_blank");break}},[i]),o=Km(!!t);return Zm(n,e,s),fi(`  $purple$16 $yellowOPENIT ${o}${r}`,s,!0),t&&Le.jsx($c,{OK_BUTTON:a})}function Hmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const[o,l,c]=[Bp(s[0],""),Bp(s[1],""),Bp(s[2],"")];let u,f;l===""?(u="L ",f=" H"):c===""?(u="L ",f=` ${l}`):(u=`${l} `,f=` ${c}`);const h=0,g=8,p=K1(e,o),y=Yk(p)??0,v=Xg(),x=i.trim(),E=Km(r);fi(`$red $29 ${E}${x} `,a,!1);const k=w2("----:----",y,1,`$green${r?v?"$26":"$27":"$4"}${E}`).replaceAll("-","$7").replaceAll(":","$9");fi(`${E}${u}${k}${f} $green${y+1}`,a,!1);const N=it.useCallback(D=>{const V=D.alt?10:1;Ip(p,Math.min(g,y+V))},[g,y,p]),I=it.useCallback(D=>{const V=D.alt?10:1;Ip(p,Math.max(h,y-V))},[h,y,p]);return Le.jsx(Le.Fragment,{children:r&&Le.jsx($c,{MOVE_LEFT:I,MOVE_RIGHT:N})})}function qmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const[o,...l]=[Bp(s[0],""),...s.slice(1)],c=[],u=[];for(let k=0;k<l.length;k+=2)c.push(l[k]),u.push(l[k+1]);const f=K1(e,o),g=`${Yk(f)??0}`;let p=u.indexOf(g);p<0&&(p=0);const _=Xg(),y=i.trim(),v=Km(r);fi(`$dkred ? ${v}${y} `,a,!1);const x=r?_?"$26":"$27":"/";fi(`${p+1}$green${x}${v}${u.length}`,a,!1),a.writefullwidth=32,fi(` $green${c[p]}`,a,!1),a.writefullwidth=void 0;const E=it.useCallback(()=>{const k=Math.min(0,p-1),N=parseFloat(u[k]);Number.isInteger(N)&&Ip(f,N)},[p,f]),M=it.useCallback(()=>{const k=Math.max(u.length-1,p+1),N=parseFloat(u[k]);Number.isInteger(N)&&Ip(f,N)},[p,f]);return Le.jsx(Le.Fragment,{children:r&&Le.jsx($c,{MOVE_LEFT:E,MOVE_RIGHT:M})})}function Vmt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Zm(n,t,a);const o=Bp(s[0],""),l=K1(e,o),c=Qge(l),u=c?.toJSON()??"",f=Xg(),[h,g]=it.useState(0),[p,_]=it.useState(!1),[y,v]=it.useState(void 0),x=`${u} `,E=i.trim(),M=Km(r);fi(`$green $20 ${M}${E} $green`,a,!1);const k=a.x,I=a.y*a.width;a.writefullwidth=32,fi(`${x}`,a,!1),a.writefullwidth=void 0;const D=xe(y),V=a.width-k-2,G=D?Math.min(y,h):h;let J=D?Math.max(y,h):h;D&&(J!==G&&J===h&&--J,Sw(k+G+I,k+J+I,15,8,a)),p&&f&&$U(k+h+I,"Û",a);function B(){xe(c)&&(g(G),v(void 0),c.delete(G,J-G+1))}return Le.jsxs(Le.Fragment,{children:[r&&Le.jsx($c,{OK_BUTTON:()=>{c&&(_(!0),g(c.length),v(void 0))}}),p&&Le.jsx(sS,{blockhotkeys:!0,children:Le.jsx($c,{MOVE_LEFT:$=>{$.shift?xe(y)||v(Li(h-1,0,u.length)):v(void 0),g(U=>Li(U-1,0,u.length))},MOVE_RIGHT:$=>{$.shift?xe(y)||v(h):v(void 0),g(U=>Li(U+1,0,u.length))},CANCEL_BUTTON:()=>{_(!1),g(u.length),v(void 0)},OK_BUTTON:()=>_(!1),keydown:$=>{if(!c)return;const{key:U}=$,Q=Vr(U),W={alt:$.altKey,ctrl:z1?$.metaKey:$.ctrlKey,shift:$.shiftKey},q=c.toJSON();switch(Q){case"delete":D?B():q.length>0&&c.delete(h,1);break;case"backspace":D?B():h>0&&(c.delete(h-1,1),g(Y=>Math.max(0,Y-1)));break;default:if(W.ctrl)switch(Q){case"a":v(0),g(q.length);break;case"c":xe(el())&&el().writeText(c.toJSON()).catch(Y=>console.error(Y));break;case"v":xe(el())&&el().readText().then(Y=>{D&&B(),c.insert(h,Y),g(h+Y.length)}).catch(Y=>console.error(Y));break;case"x":xe(el())&&el().writeText(c.toJSON()).then(()=>B()).catch(Y=>console.error(Y));break}else W.alt||$.key.length===1&&q.length<V&&(c.insert(h,$.key),g(Y=>Y+1));break}}})})]})}function Gmt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const{setviewimage:a}=Gc(),o=it.useCallback(()=>{const[,...c]=i,u=c.join(" ");a(u)},[a,i]),l=Km(!!t);return Zm(n,e,s),fi(`  $purple$16 $cyanVIEWIT ${l}${r}`,s,!0),t&&Le.jsx($c,{OK_BUTTON:o})}function $mt({chip:n,row:e,active:t,label:r,args:i,context:s}){Zm(!1,e,s);const[a]=[Bp(i[0],"")],o="z",l=` ${o.toUpperCase()} `,c=Km(t),u=s.x-.25,f=s.y-.25;fi(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${l}${c}$onclear ${r}${xe(e)?`
`:""}`,s,!0);const h=it.useContext(aS),g=it.useCallback(()=>{h.sendmessage(bG(n,a),[])},[h,n,a]);return Le.jsxs("group",{position:[u*Gn.DRAW_CHAR_WIDTH(),f*Gn.DRAW_CHAR_HEIGHT(),1],children:[Le.jsx(Uv,{visible:!1,width:l.length+.5,height:1.5,blocking:!0,onClick:g}),t&&Le.jsx($c,{OK_BUTTON:g}),Le.jsx(VT,{hotkey:o,children:g})]})}function Wmt({sidebar:n,row:e,item:t,active:r}){const i=as(),s=Fh();if(Zm(n,e,s),s.iseven=s.y%2===0,typeof t=="string")return Le.jsx(Lmt,{sidebar:n,player:i,item:t,row:e,context:s});if(ui(t)){const[a,o,l,c,...u]=t;if(typeof a!="string"||typeof o!="string"||typeof l!="string")return null;const f={sidebar:n,player:i,chip:a,row:e,active:r,label:o,args:[l,...u],context:s},h=Vn(c)?c:"";switch(Vr(h)){default:case"hyperlink":return Le.jsx(Fmt,{...f});case"hk":case"hotkey":return Le.jsx(Bmt,{...f});case"rn":case"range":return Le.jsx(Hmt,{...f});case"sl":case"select":return Le.jsx(qmt,{...f});case"nm":case"number":return Le.jsx(zmt,{...f});case"tx":case"text":return Le.jsx(Vmt,{...f});case"copyit":return Le.jsx(Umt,{...f});case"openit":return Le.jsx(jmt,{...f});case"viewit":return Le.jsx(Gmt,{...f});case"zssedit":return Le.jsx($mt,{...f});case"charedit":return Le.jsx(kmt,{...f});case"coloredit":return Le.jsx(fse,{...f});case"bgedit":return Le.jsx(fse,{isbg:!0,...f})}}return null}function rbe({inline:n=!1,xmargin:e=1,ymargin:t=1,selected:r=-1,width:i,height:s,color:a,bg:o,text:l}){const c=hx(i,s,0,a,o),u=c.getState(),f={...Tb(i,s,a,o,t,e,i-e,s-t),...c.getState(),x:e,y:t};return Zk(u,0,a,o),Le.jsxs(_x,{store:c,children:[Le.jsx(vx,{width:i,height:s}),Le.jsx(Kk.Provider,{value:f,children:l.map((h,g)=>Le.jsx(Wmt,{row:n?void 0:g,item:h,active:g===r,sidebar:e!==0},g))})]})}const Ymt=n=>{const e="nativeEvent"in n?n.nativeEvent:n;return{deltaX:e.deltaX||0,deltaY:e.deltaY||0,deltaZ:e.deltaZ||0,timeStamp:e.timeStamp}},Xmt=n=>[n.deltaX,n.deltaY,n.deltaZ],VN=n=>{const e=Xmt(n).map(Math.abs);return Math.max(...e)};var l1;(function(n){n.ALL_OTHER_CHECKS_FAILED="ALL_OTHER_CHECKS_FAILED",n.NO_PREVIOUS_EVENT_TO_COMPARE="NO_PREVIOUS_EVENT_TO_COMPARE",n.PAST_TIMESTAMP_EVENT="PAST_TIMESTAMP_EVENT",n.ENOUGH_TIME_PASSED="ENOUGH_TIME_PASSED",n.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN="NON_DECREASING_DELTAS_OF_KNOWN_HUMAN",n.DELTA_MODULE_HAS_BEEN_INCREASING="DELTA_MODULE_HAS_BEEN_INCREASING"})(l1||(l1={}));class Kmt{sensitivity;delay;increasingDeltasThreshold;previousEvents;constructor({sensitivity:e=2,delay:t=100,increasingDeltasThreshold:r=3}={}){this.sensitivity=Math.max(1,e),this.delay=Math.max(1,t),this.increasingDeltasThreshold=Math.max(2,r),this.previousEvents=[]}check(e){if(!(("nativeEvent"in e?e.nativeEvent:e)instanceof Event))throw new Error(`"${e}" is not a valid event`);const r=Ymt(e);if(VN(r)<this.sensitivity)return!1;const{isHuman:i}=this.isHuman(r);return i?this.previousEvents=[r]:r.timeStamp>(this.previousEvents.at(-1)?.timeStamp||0)&&this.previousEvents.push(r),i}isHuman(e){const t=this.previousEvents.at(-1);if(!t)return{isHuman:!0,reason:l1.NO_PREVIOUS_EVENT_TO_COMPARE};if(e.timeStamp<t.timeStamp)return{isHuman:!1,reason:l1.PAST_TIMESTAMP_EVENT};if(e.timeStamp>t.timeStamp+this.delay)return{isHuman:!0,reason:l1.ENOUGH_TIME_PASSED};const s=VN(e),a=VN(t);if(s>=a){if(this.previousEvents.length===1)return{isHuman:!0,reason:l1.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN};if(this.increasingDeltasThreshold<=2||this.previousEvents.length>=this.increasingDeltasThreshold&&this.previousEvents.slice(-this.increasingDeltasThreshold).map(VN).every((u,f,h)=>f===0||u>h[f-1]))return{isHuman:!0,reason:l1.DELTA_MODULE_HAS_BEEN_INCREASING}}return{isHuman:!1,reason:l1.ALL_OTHER_CHECKS_FAILED}}}const Zmt=new Kmt({sensitivity:z1?7:2}),hse=4,Jmt=.75;function Qmt(n){const e=Li(n,-hse,hse);return Math.round(e*Jmt)}function SG({debug:n=!1,disabled:e=!1,blocking:t=!0,cursor:r="pointer",x:i=0,y:s=0,width:a=30,height:o=10,children:l,onScroll:c,...u}){return Le.jsxs("group",{...u,children:[Le.jsx(Uv,{blocking:t,cursor:r,visible:n,x:i,y:s,width:a,height:o,onWheel:f=>{e||!Zmt.check(f)||c?.(Qmt(f.deltaY))}}),l]})}const egt=2,tgt=14,ibe=tgt*egt;function ngt(n){return pce(n,ibe*.5)}function rgt(n,e,t,r,i=1.235){function s(o){return Eht(o,r)}j0(n.userData,e,t,i,r,ibe*12,s),n.position[e]=ngt(n.userData[e]);const a=t-n.position.y;return Math.abs(a)<.1}function igt({name:n,width:e,height:t,context:r}){const i=z0e();for(let l=1;l<e-1;++l)l>2&&l<e-1&&pu(i,e,t,l,1,{char:205,color:15}),pu(i,e,t,l,t-1,{char:205,color:15});pu(i,e,t,e-2,0,{char:196,color:15}),pu(i,e,t,1,0,{char:205,color:15}),pu(i,e,t,2,0,{char:187,color:15}),pu(i,e,t,2,1,{char:200,color:15});for(let l=1;l<t-1;++l)pu(i,e,t,0,l,{char:179,color:15}),pu(i,e,t,e-1,l,{char:179,color:15});for(let l=2;l<t-1;++l)pu(i,e,t,1,l,{char:0,color:15}),pu(i,e,t,e-2,l,{char:0,color:15});pu(i,e,t,0,0,{char:213,color:15}),pu(i,e,t,e-1,0,{char:191,color:15}),pu(i,e,t,e-1,1,{char:181,color:15}),pu(i,e,t,0,t-1,{char:212,color:15}),pu(i,e,t,e-1,t-1,{char:190,color:15});const s=` ${n} `,o=Q1(s,e,t)?.x??s.length;return r.x=Math.round(e*.5),r.x-=Math.round(o*.5),r.y++,fi(s,r,!0),null}function sgt({store:n,children:e}){return Le.jsx(B0e.Provider,{value:n,children:e})}function agt({width:n,height:e}){const t=it.useContext(B0e),[r]=sV(t,Uh(i=>[i.dither,i.render]));return n>0&&e>0&&Le.jsx(ab,{alphas:r.slice(),width:n,height:e})}function dse({x:n,y:e,color:t,on:r=232,off:i=7,alt:s}){const a=Xg(),o=z0e(),l=it.useRef(0),c=xe(s)?l.current%2===0?r:s:r;return pu(o,o.width,o.height,n,e,{char:a?c:i,color:t}),o.changed(),a&&++l.current,null}function ogt({row:n,width:e,height:t,panelwidth:r,panelheight:i,children:s}){const a=cnt(r,i,0),o=[.001,.05,.1,.2],l=.4,{dither:c}=a.getState();lnt(c);for(let u=0;u<r;++u){gF(c,r,i,u,n,l);for(let f=0;f<o.length;++f){const h=o.length-f;gF(c,r,i,u,n-h,o[f]),gF(c,r,i,u,n+h,o[f])}}return Le.jsxs(Le.Fragment,{children:[Le.jsx(vx,{width:e,height:t}),Le.jsxs("group",{position:[2*Gn.DRAW_CHAR_WIDTH(),2*Gn.DRAW_CHAR_HEIGHT(),0],children:[Le.jsx(sgt,{store:a,children:Le.jsx(agt,{width:r,height:i})}),s,Le.jsx(dse,{x:1,y:1}),Le.jsx(dse,{x:1,y:2+n,on:26,alt:27,off:45,color:12})]})]})}function EG({line:n,color:e,margin:t,y:r,leftedge:i,rightedge:s,context:a}){const o=Xg(),c=`$${(bn[e]??"").toLowerCase()} ${n.replaceAll(`
`,"").trim()} --=--`,f=Q1(c,1e4,1)?.measuredwidth??1,[h,g]=it.useState(0);it.useEffect(()=>{g(p=>o?p:(p-1)%f)},[o,f]),a.disablewrap=!0,a.active.leftedge=t,a.active.rightedge=s-t;for(let p=i+t+h;p<=s;p+=f)a.x=p,a.y=r,fi(c,a,!1);return a.active.leftedge=0,a.active.rightedge=s,a.disablewrap=!1,null}function lgt({width:n,height:e,color:t,bg:r,text:i,shouldclose:s}){const{viewport:a}=Nm(),o=n-3,l=e-3,c=hx(n,e,0,t,r),u=it.useContext(aS),f=i.length-1,h=ws(D=>D.gadget.scrollname??""),g={...Tb(n,e,t,r,0,0,n,e),...c.getState()},[p,_]=it.useState(()=>{const D=i.findIndex(V=>ui(V));return D>=0&&D<=8?D:0});let y=p-Math.floor(l*.5);y=Math.min(i.length-l,y),y=Math.max(0,y);const v=i.slice(y,y+l),x=p-y,E=it.useRef(null),M=it.useCallback(()=>{s&&u.didclose()},[s,u]),k=it.useCallback(D=>{const V=D.ctrl?f:D.alt?10:1;_(G=>Math.max(0,G-V))},[_,f]),N=it.useCallback(D=>{const V=D.ctrl?f:D.alt?10:1;_(G=>Math.min(f,G+V))},[_,f]),I=it.useCallback(D=>{_(V=>Li(Math.round(V+D),0,f))},[_,f]);return it.useEffect(()=>{if(E.current&&!s){const D=a.height;E.current.position.y=D,E.current.userData.y=D,E.current.userData.vy=0}},[s]),Wg(it.useCallback((D,V)=>{if(xe(E.current)){const G=s?e*2*-Gn.DRAW_CHAR_HEIGHT():0;rgt(E.current,"y",G,V)&&M()}},[s,M,e])),Le.jsxs("group",{ref:E,"position-y":1e6,children:[Le.jsx(SG,{blocking:!0,x:0,y:0,width:n,height:e,onScroll:D=>I(D*.5)}),Le.jsxs(sS,{children:[Le.jsx($c,{MOVE_UP:k,MOVE_DOWN:N,CANCEL_BUTTON:u.sendclose}),Le.jsxs(_x,{store:c,children:[Le.jsx(igt,{name:h,width:n,height:e,context:g}),Le.jsx(EG,{margin:3,color:bn.BLUE,y:0,leftedge:0,rightedge:n,line:`
   up/down$white.SCROLL UP/DOWN   $blue
esc/cancel$white.CLOSE SCROLL   $blue
alt+up/down$white.JUMP 10 LINES   $blue
`,context:g}),Le.jsx(ogt,{row:x,width:n,height:e,panelwidth:o,panelheight:l,children:Le.jsx(rbe,{width:o,height:l,xmargin:0,ymargin:0,color:t,bg:bn.ONCLEAR,text:v,selected:x})})]})]})]})}function cgt(){const n=Fy(Uh(r=>r.pts)),e=hx($n,mi,0,bn.BLBLACK,bn.ONCLEAR),t=e.getState();Zk(t,0,bn.BLBLACK,bn.ONCLEAR);for(let r=0;r<n.length;++r){const i=n[r];pu(t,$n,mi,i.x,i.y,{char:177})}return Le.jsx("group",{"position-z":100,children:Le.jsx(_x,{store:e,children:Le.jsx(vx,{width:$n,height:mi})})})}const l4=new ut;function pse(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(l4.x/n),r=Math.floor((l4.y+e*.5)/e);return{x:t,y:mi*.5+r}}function ugt(){const n=oo(u=>u.inspector),[e,t]=Fy(Uh(u=>[u.cursor,u.select])),r=pw(e??0,$n),i=pw(t??e??0,$n),s={x:Math.min(r.x,i.x),y:Math.min(r.y,i.y)},a={x:Math.max(r.x,i.x),y:Math.max(r.y,i.y)},o=a.x-s.x+1,l=a.y-s.y+1;function c(){Mn(Fy.getState().cursor)&&lIe(St,as(),s,a),Fy.setState(()=>({cursor:void 0,select:void 0}))}return Le.jsxs(Le.Fragment,{children:[n&&Le.jsx(Uv,{visible:!0,opacity:0,color:"black",x:0,y:0,z:-1,width:$n,height:mi,cursor:"pointer",onPointerDown:u=>{u.intersections[0].object.worldToLocal(l4.copy(u.intersections[0].point));const f=pse();Fy.setState(()=>({cursor:_f(f,$n)}))},onPointerMove:u=>{if(xe(Fy.getState().cursor)){u.intersections[0].object.worldToLocal(l4.copy(u.intersections[0].point));const f=pse();Fy.setState(()=>({select:_f(f,$n)}))}},onPointerUp:c,onPointerOut:c,onPointerCancel:c}),xe(e)&&Le.jsxs(Le.Fragment,{children:[Le.jsx(Uv,{x:s.x+.25,y:s.y+.25,z:100,width:o-.5,height:l-.5,color:"black",opacity:.3}),Le.jsx(Uv,{x:s.x,y:s.y,z:101,width:o,height:l,color:"white",opacity:.25})]})]})}function fgt(){return oo(e=>e.inspector)&&Le.jsxs(Le.Fragment,{children:[Le.jsx(ugt,{}),Le.jsx(cgt,{})]})}const hgt=uU,dgt=hw(rx(tR)),mse=_v(ix(eR)),pgt=new Vl({transparent:!1,side:$f,uniforms:{time:Rg,interval:b3,smoothrate:new jn(hgt),palette:new jn(dgt),map:new jn(mse),alt:new jn(mse),dpr:new jn(1),screenwidth:new jn(1),screenheight:new jn(1),pointSize:{value:new an(1,1)},rows:new jn(1),step:new jn(new an),size:new jn(new an),pixel:new jn(new an),flip:new jn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float screenwidth;
    uniform float screenheight;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    ${R3}

    float PI = radians(180.0);

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vCharData.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      int sourceColori = int(lastColor.x);
      int destColori = int(charData.z);

      vec3 sourceColor;
      if (sourceColori > 32) {
        sourceColor = palette[sourceColori - 33];
      } else {
        sourceColor = palette[sourceColori % 16];
      }

      vec3 destColor;
      if (destColori > 32) {
        destColor = palette[destColori - 33];
      } else {
        destColor = palette[destColori % 16];
      }

      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      if (destColori > 31) {
        vColor = mix(vBg.rgb, vColor, cyclefromtime());
      }

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x -= 1.0;

      // model space
      vec4 mvPosition = vec4(animPosition, 0.0, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif
      mvPosition = modelViewMatrix * mvPosition;
  
      // transform to screenspace 
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      float fov = 2.0 * atan(1.0 / projectionMatrix[1][1]) * 180.0 / PI;
      float heightOfNearPlane = screenheight / (2.0 * tan(0.5 * fov * PI / 180.0));
      gl_PointSize = (heightOfNearPlane * pointSize.y) / gl_Position.w;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 size;
    uniform vec2 pixel;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }
      
      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }

      vec2 idx = vec2(px, py) * size * pixel;
      vec2 lookup = vec2(vCharData.x, rows - vCharData.y) * step * pixel;
      vec2 uv = lookup + idx + vec2(1.0, 1.0) * pixel;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function mgt(){return S3(pgt)}const ggt=uU,_gt=hw(rx(tR)),gse=_v(ix(eR)),vgt=new Vl({transparent:!1,side:$f,uniforms:{time:Rg,interval:b3,smoothrate:new jn(ggt),palette:new jn(_gt),map:new jn(gse),alt:new jn(gse),dpr:new jn(1),screenwidth:new jn(1),screenheight:new jn(1),pointSize:new jn(new an),rows:new jn(1),step:new jn(new an),size:new jn(new an),pixel:new jn(new an),flip:new jn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    ${R3}

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = palette[int(index)];
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vCharData.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      int sourceColori = int(lastColor.x);
      int destColori = int(charData.z);

      vec3 sourceColor;
      if (sourceColori > 32) {
        sourceColor = palette[sourceColori - 33];
      } else {
        sourceColor = palette[sourceColori % 16];
      }

      vec3 destColor;
      if (destColori > 32) {
        destColor = palette[destColori - 33];
      } else {
        destColor = palette[destColori % 16];
      }

      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      if (destColori > 31) {
        vColor = mix(vBg.rgb, vColor, cyclefromtime());
      }

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x -= 1.0;

      vec4 mvPosition = vec4(animPosition, 0.0, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      gl_PointSize = pointSize.y * modelViewMatrix[0][0] * dpr;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 size;
    uniform vec2 pixel;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }
      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }

      vec2 idx = vec2(px, py) * size * pixel;
      vec2 lookup = vec2(vCharData.x, rows - vCharData.y) * step * pixel;
      vec2 uv = lookup + idx + vec2(1.0, 1.0) * pixel;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function ygt(){return S3(vgt)}const _se=2048;function bgt({sprites:n}){const e=it.useRef(null),t=it.useRef([]);return it.useMemo(()=>{t.current.length===0&&(t.current=Array.from({length:_se},()=>({id:"",x:0,y:0,char:0,color:0,bg:0,stat:0})));const r={};for(let a=0;a<n.length;++a)r[n[a].id]=n[a];const i=new Set(t.current.map(a=>a.id));let s=0;for(let a=0;a<_se;++a)if(t.current[a].id){const o=r[t.current[a].id];xe(o)?t.current[a]={...o}:t.current[a].id=""}else if(s<n.length){for(;i.has(n[s]?.id)===!0;)++s;s<n.length&&(t.current[a]={...n[s++]})}},[n]),it.useEffect(()=>{const{current:r}=e,{current:i}=t;if(!r||!i)return;let s=r.getAttribute("visible"),a=r.getAttribute("lastVisible"),o=r.getAttribute("position"),l=r.getAttribute("charData"),c=r.getAttribute("lastPosition"),u=r.getAttribute("lastColor"),f=r.getAttribute("lastBg"),h=r.getAttribute("animShake"),g=r.getAttribute("animBounce");if(!s||s.count!==i.length){s=new Ds(new Float32Array(i.length),1),a=new Ds(new Float32Array(i.length),1),o=new Ds(new Float32Array(i.length*3),3),l=new Ds(new Float32Array(i.length*4),4),c=new Ds(new Float32Array(i.length*3),3),u=new Ds(new Float32Array(i.length*2),2),f=new Ds(new Float32Array(i.length*2),2),h=new Ds(new Float32Array(i.length*2),2),g=new Ds(new Float32Array(i.length*2),2);for(let p=0;p<i.length;++p){const _=i[p],y=_.id?1:0;s.setX(p,y),a.setX(p,y),o.setXY(p,_.x,_.y),l.setXYZW(p,_.char%P0,Math.floor(_.char/P0),_.color,_.bg),c.setXYZ(p,_.x,_.y,Rg.value),u.setXY(p,_.color,Rg.value),f.setXY(p,_.bg,Rg.value),h.setXY(p,0,Rg.value-1e6),g.setXY(p,0,Rg.value-1e6)}r.setAttribute("visible",s),r.setAttribute("lastVisible",a),r.setAttribute("position",o),r.setAttribute("charData",l),r.setAttribute("lastPosition",c),r.setAttribute("lastColor",u),r.setAttribute("lastBg",f),r.setAttribute("animShake",h),r.setAttribute("animBounce",g)}else for(let p=0;p<i.length;++p){const _=i[p],y=o.getX(p),v=o.getY(p),x=l.getX(p),E=l.getY(p),M=l.getZ(p),k=l.getW(p);a.setX(p,s.getX(p)),a.needsUpdate=!0,s.setX(p,_.id?1:0),s.needsUpdate=!0;const N=a.getX(p)===0&&s.getX(p)===1;(N||y!==_.x||v!==_.y)&&(c.setXYZ(p,N?_.x:y,N?_.y:v,Rg.value),c.needsUpdate=!0,o.setXY(p,_.x,_.y),o.needsUpdate=!0),(N||M!==_.color)&&(u.setXY(p,N?_.color:M,Rg.value),u.needsUpdate=!0,l.setZ(p,_.color),l.needsUpdate=!0),(N||k!==_.bg)&&(f.setXY(p,N?_.bg:k,Rg.value),f.needsUpdate=!0,l.setW(p,_.bg),l.needsUpdate=!0);const I=_.char%P0,D=Math.floor(_.char/P0);(x!==I||E!==D)&&(l.setXY(p,I,D),l.needsUpdate=!0)}r.computeBoundingBox(),r.computeBoundingSphere()},[n]),Le.jsx("bufferGeometry",{ref:e})}function sk({sprites:n,scale:e=1,fliptexture:t=!0,withbillboards:r=!1}){const{viewport:i}=Nm(),s=Gc(f=>f.palettedata),a=Gc(f=>f.spritecharsetdata),o=Gc(f=>f.spritealtcharsetdata),l=it.useMemo(()=>r?mgt():ygt(),[r]),{width:c=0,height:u=0}=a?.image??{};return it.useEffect(()=>{if(!a)return;const f=Jd+2,h=Qd+2,g=Math.round(u/h);l.uniforms.palette.value=s,l.uniforms.map.value=a,l.uniforms.alt.value=o??a,l.uniforms.dpr.value=e,l.uniforms.screenwidth.value=i.width,l.uniforms.screenheight.value=i.height,l.uniforms.rows.value=g-1,l.uniforms.step.value.x=f,l.uniforms.step.value.y=h,l.uniforms.size.value.x=Jd,l.uniforms.size.value.y=Qd,l.uniforms.pixel.value.x=1/c,l.uniforms.pixel.value.y=1/u,l.uniforms.pointSize.value.x=Gn.DRAW_CHAR_WIDTH(),l.uniforms.pointSize.value.y=Gn.DRAW_CHAR_HEIGHT(),l.uniforms.flip.value=t,l.needsUpdate=!0},[s,a,o,l,c,u,t,i.width,i.height,e]),Le.jsxs("points",{frustumCulled:!1,children:[Le.jsx(bgt,{sprites:n}),Le.jsx("primitive",{object:l,attach:"material"})]})}function ob({id:n,z:e,from:t}){const r=ws(Uh(i=>i.gadget[t]?.find(s=>s.id===n)));switch(r?.type){default:case lo.BLANK:case lo.MEDIA:return null;case lo.TILES:return Le.jsx("group",{position:[0,0,e],children:Le.jsx(Bv,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case lo.SPRITES:return Le.jsx("group",{position:[0,0,e],children:Le.jsx(sk,{sprites:[...r.sprites],fliptexture:!1})},r.id);case lo.DITHER:return Le.jsx("group",{position:[0,0,e],children:Le.jsx(ab,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function k6({id:n,from:e}){const t=Gc(),r=ws(Uh(s=>s.gadget[e]?.find(a=>a.id===n))),i=r?.type===lo.MEDIA?r:void 0;return it.useEffect(()=>{switch(i?.mime){case"image/palette":ui(i.media)&&t.setpalette(VB(fw,mfe,i.media));break;case"image/charset":ui(i.media)&&t.setcharset(VB(P0*Jd,y9*Qd,i.media));break;case"image/altcharset":ui(i.media)&&t.setaltcharset(VB(P0*Jd,y9*Qd,i.media));break;case"text/mood":Vn(i.media)&&t.setmood(i.media);break;case"text/players":Vn(i.media);break}},[t,i]),null}const vse=n=>(n.getAttributes()&Um.CONVOLUTION)===Um.CONVOLUTION,Sgt=it.memo(it.forwardRef(({children:n,camera:e,width:t,height:r},i)=>{const{gl:s,scene:a}=Nm(),[o]=it.useMemo(()=>{const u=new Nye(s,{depthBuffer:!0,stencilBuffer:!1,multisampling:0,frameBufferType:vb});return u.autoRenderToScreen=!1,u.addPass(new Dye(a,e)),[u]},[e,s,a]);Wg((u,f)=>{o.setSize(t,r),o.render(f)},1);const l=it.useRef(null);it.useLayoutEffect(()=>{const u=[],f=l.current.__r3f;if(f&&o){const h=f.children;for(let g=0;g<h.length;g++){const p=h[g].object;if(p instanceof B_){const _=[p];if(!vse(p)){let v=null;for(;(v=h[g+1]?.object)instanceof B_&&!vse(v);)_.push(v),g++}const y=new Lye(e,..._);u.push(y)}else p instanceof Xm&&u.push(p)}for(const g of u)o?.addPass(g)}return()=>{for(const h of u)o?.removePass(h)}},[o,n,e]);const c=it.useMemo(()=>({composer:o,normalPass:null,downSamplingPass:null,resolutionScale:void 0,camera:e,scene:a}),[o,e,a]);return it.useImperativeHandle(i,()=>o,[o]),Le.jsx(hG.Provider,{value:c,children:Le.jsx("group",{ref:l,children:n})})})),Egt=it.forwardRef(function({children:e,fbo:t,...r},i){const[s]=it.useState(()=>new ew);return it.useImperativeHandle(i,()=>t,[t]),Le.jsxs(Le.Fragment,{children:[gke(Le.jsxs(Le.Fragment,{children:[e,Le.jsx("group",{onPointerOver:()=>null})]}),s),Le.jsx("primitive",{object:t.texture,...r})]})});function xgt({fbo:n,effects:e}){const{mood:t}=Gc(),[r]=it.useState(()=>new kye(n,!0));return it.useEffect(()=>()=>{r.dispose()},[r]),Le.jsxs(Le.Fragment,{children:[t.includes("dark")&&Le.jsxs(it.Fragment,{children:[Le.jsx(_pt,{delay:[10,120],duration:[.1,3],strength:[0,1],mode:d1.SPORADIC,active:!0,ratio:.5}),Le.jsx(vpt,{opacity:.5,premultiply:!0,blendFunction:xs.DARKEN})]},"mood"),t.includes("bright")&&Le.jsx(it.Fragment,{children:Le.jsx(gpt,{intensity:.111,mipmapBlur:!1,luminanceThreshold:.5,luminanceSmoothing:.001,kernelSize:T3.VERY_LARGE})},"mood"),e,Le.jsx("primitive",{object:r,dispose:null})]})}function I6({camera:n,viewwidth:e,viewheight:t,effects:r,children:i}){const{mood:s}=Gc(),{viewport:a}=Nm(),o=Aye(e*a.dpr,t*a.dpr,{samples:0,stencilBuffer:!1,depthBuffer:!0,generateMipmaps:!1}),l=e*.5,c=t*.5;return Le.jsx(Le.Fragment,{children:Le.jsxs("mesh",{position:[l,c,0],children:[Le.jsx("planeGeometry",{args:[e,t]}),Le.jsx("meshBasicMaterial",{transparent:!0,children:Le.jsxs(Egt,{attach:"map",fbo:o,children:[i,Le.jsx(Sgt,{camera:n,width:e,height:t,children:Le.jsx(xgt,{fbo:o,effects:r})},s)]})})]})})}function Tgt({width:n,height:e}){const t=kb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),[,u]=it.useState(!1);it.useLayoutEffect(()=>{u(!0)},[]),Wg((k,N)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current)return;const I=Qw(ws.getState().gadget.layers??[]);xe(s.current.userData.focusx)||(s.current.userData={focusx:I.focusx,focusy:I.focusy,tfocusx:I.focusx,tfocusy:I.focusy,facing:I.facing},o.current.scale.setScalar(I.viewscale));const D=Gn.DRAW_CHAR_WIDTH(),V=Gn.DRAW_CHAR_HEIGHT(),G=$n*D,J=mi*V,B=.25;F1(o.current.scale,I.viewscale,B,N);const $=o.current.scale.x,U=s.current.userData.focusx+.5,Q=s.current.userData.focusy+.5,W=U*D*$+G*-.5,q=Q*V*$+J*-.5;F1(a.current.position,[-W,-q,0],.05,N),r>G*$?s.current.userData.tfocusx=$n*.5:s.current.userData.tfocusx=I.focusx,i>J*$?s.current.userData.tfocusy=mi*.5:s.current.userData.tfocusy=I.focusy,j0(s.current.userData,"focusx",s.current.userData.tfocusx,B),j0(s.current.userData,"focusy",s.current.userData.tfocusy,B),l.current.position.x=r*.5-G*.5+a.current.position.x,l.current.position.y=i*.5-J*.5+a.current.position.y,c.current.scale.setScalar($),s.current.position.x=k.size.width*.5,s.current.position.y=k.size.height*.5,s.current.updateProjectionMatrix()}),ws(k=>k.gadget.over?.length??0),ws(k=>k.gadget.under?.length??0),ws(k=>k.gadget.layers?.length??0);const{over:f=[],under:h=[],layers:g=[]}=ws.getState().gadget,p=h.length===0,_=Gn.DRAW_CHAR_WIDTH(),y=Gn.DRAW_CHAR_HEIGHT(),v=$n*_,x=mi*y,E=v*-.5+t.marginx,M=x*-.5-t.marginy;return Le.jsxs(Le.Fragment,{children:[g.map(k=>Le.jsx(k6,{id:k.id,from:"layers"},`media${k.id}`)),Le.jsx("group",{ref:l,children:Le.jsx("group",{ref:c,children:Le.jsx(fgt,{})})}),Le.jsx("orthographicCamera",{ref:s,left:r*-.5,right:r*.5,top:i*-.5,bottom:i*.5,near:1,far:2e3,position:[0,0,1e3]}),s.current&&Le.jsx(I6,{camera:s.current,viewwidth:r,viewheight:i,effects:Le.jsx(Le.Fragment,{}),children:Le.jsx("group",{position:[E,M,0],children:Le.jsx("group",{ref:a,children:Le.jsxs("group",{ref:o,children:[p&&Le.jsx(Uv,{color:"black",width:$n,height:mi}),h.map((k,N)=>Le.jsx(ob,{from:"under",id:k.id,z:N*2},k.id)),g.map((k,N)=>Le.jsx(ob,{from:"layers",id:k.id,z:h.length+N*2},k.id)),f.map((k,N)=>Le.jsx(ob,{from:"over",id:k.id,z:h.length+g.length+N*2},k.id))]})})})})]})}const wgt=hw(rx(tR)),yse=_v(ix(eR)),Rgt=new Vl({transparent:!1,side:$f,uniforms:{time:Rg,interval:b3,palette:new jn(wgt),map:new jn(yse),alt:new jn(yse),cols:new jn(1),rows:new jn(1),step:new jn(new an)},vertexShader:`
    uniform float time;
    uniform float interval;

    varying vec2 vUv;
    varying vec3 vColor;

    void main() {
      vUv = uv;
      vColor.xyz = instanceColor.xyz;
      
      vec4 mvPosition = vec4(position, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform vec3 palette[16];
    uniform vec2 step;
    uniform float cols;
    uniform float rows;

    varying vec2 vUv;
    varying vec3 vColor;

    ${R3}

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(gl_FragCoord.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }
      
    void main() {
      // r = char, g = color, b = bg
      int tc = int(cols);
      int ti = int(vColor.r);
      float tx = float(ti % tc);
      float ty = rows - floor(vColor.r / cols);

      int colori = int(vColor.g);
      int bgi = int(vColor.b);

      vec3 color;
      if (colori > 31) {
        vec3 bg = palette[bgi];
        color = palette[colori - 33];
        float cycle = mod(time * 2.5, interval * 2.0) / interval;
        color = mix(bg, color, cyclefromtime());
      } else {
        color = palette[colori % 16];
      }

      vec3 bg = palette[bgi];

      vec2 uv = vUv * step + vec2(tx * step.x, ty * step.y);
      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${bn.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function xG(){return S3(Rgt)}function TG(){const[n]=it.useState(()=>Vye());it.useEffect(()=>{n.uniforms.data.value=qye(1,1)},[n.uniforms.data]),it.useEffect(()=>{Hye(n.uniforms.data.value,1,1,[.5])},[n,n.uniforms.data.value]);const{position:e,uv:t}=it.useMemo(()=>gG(1,1),[]);return Le.jsxs(Le.Fragment,{children:[Le.jsxs("bufferGeometry",{children:[Le.jsx("bufferAttribute",{attach:"attributes-position",args:[e,3]}),Le.jsx("bufferAttribute",{attach:"attributes-uv",args:[t,2]})]}),Le.jsx("primitive",{object:n,attach:"material"})]})}function Agt(){const n=Gc(l=>l.palettedata),e=Gc(l=>l.charsetdata),t=Gc(l=>l.altcharsetdata),[r]=it.useState(()=>xG()),{width:i=0,height:s=0}=e?.image??{};it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(i/Jd),c=Math.round(s/Qd);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,i,s]);const{position:a,uv:o}=it.useMemo(()=>$pt(1,1),[]);return Le.jsxs(Le.Fragment,{children:[Le.jsxs("bufferGeometry",{children:[Le.jsx("bufferAttribute",{attach:"attributes-position",args:[a,3]}),Le.jsx("bufferAttribute",{attach:"attributes-uv",args:[o,2]})]}),Le.jsx("primitive",{object:r,attach:"material"})]})}function bse(){const n=Gc(l=>l.palettedata),e=Gc(l=>l.charsetdata),t=Gc(l=>l.altcharsetdata),[r]=it.useState(()=>xG()),{width:i=0,height:s=0}=e?.image??{};it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(i/Jd),c=Math.round(s/Qd);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,i,s]);const{position:a,uv:o}=it.useMemo(()=>Kpt(1,1),[]);return Le.jsxs(Le.Fragment,{children:[Le.jsxs("bufferGeometry",{children:[Le.jsx("bufferAttribute",{attach:"attributes-position",args:[a,3]}),Le.jsx("bufferAttribute",{attach:"attributes-uv",args:[o,2]})]}),Le.jsx("primitive",{object:r,attach:"material"})]})}function sbe(){const n=Gc(l=>l.palettedata),e=Gc(l=>l.charsetdata),t=Gc(l=>l.altcharsetdata),[r]=it.useState(()=>xG()),i=Gn.DRAW_CHAR_WIDTH(),s=Gn.DRAW_CHAR_HEIGHT(),{width:a=0,height:o=0}=e?.image??{};return it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(a/Jd),c=Math.round(o/Qd);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,a,o]),Le.jsxs(Le.Fragment,{children:[Le.jsx("boxGeometry",{args:[i,s,s]}),Le.jsx("primitive",{object:r,attach:"material"})]})}function wG(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case wr.ISSWIM:case wr.ISSOLID:return 0}return i}),color:e.map((i,s)=>{switch(r[s]){case wr.ISSWIM:case wr.ISSOLID:return bn.ONCLEAR}return i}),bg:t.map((i,s)=>{switch(r[s]){case wr.ISSWIM:case wr.ISSOLID:return bn.ONCLEAR}return i})}}function abe(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case wr.ISSOLID:return i}return 0}),color:e.map((i,s)=>{switch(r[s]){case wr.ISSOLID:return i}return 0}),bg:t.map((i,s)=>{switch(r[s]){case wr.ISSOLID:return i}return bn.ONCLEAR})}}function RG(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case wr.ISSWIM:return i}return 176}),color:e.map((i,s)=>{switch(r[s]){case wr.ISSWIM:return i}return bn.DKGRAY}),bg:t.map((i,s)=>{switch(r[s]){case wr.ISSWIM:return i}return bn.BLACK})}}function Cgt({id:n,z:e,from:t}){const r=as(),i=it.useRef(null),s=it.useRef(null),a=it.useRef(null);Wg(()=>{xe(i.current)&&(i.current.computeBoundingBox(),i.current.computeBoundingSphere()),xe(s.current)&&(s.current.computeBoundingBox(),s.current.computeBoundingSphere()),xe(a.current)&&(a.current.computeBoundingBox(),a.current.computeBoundingSphere())});const o=ws(Uh(f=>f.gadget[t]?.find(h=>h.id===n))),l=Gn.DRAW_CHAR_WIDTH(),c=Gn.DRAW_CHAR_HEIGHT(),u=Qw(ws.getState().gadget.layers??[]);switch(o?.type){default:case lo.BLANK:case lo.MEDIA:return null;case lo.TILES:{const f=wG(o.char,o.color,o.bg,o.stats),h=RG(o.char,o.color,o.bg,o.stats);return Le.jsx(Le.Fragment,{children:Le.jsxs("group",{position:[0,0,e],children:[Le.jsx(Bv,{width:o.width,height:o.height,char:f.char,color:f.color,bg:f.bg}),Le.jsx("group",{"position-z":c*-.5,children:Le.jsx(Bv,{width:o.width,height:o.height,char:h.char,color:h.color,bg:h.bg})}),Le.jsxs(h1,{ref:s,limit:w_,children:[Le.jsx(sbe,{}),o.stats.map((g,p)=>{const _=pw(p,$n);switch(g){case wr.ISSOLID:return Le.jsx(Gy,{position:[(_.x+.5)*l,(_.y+.5)*c,c*.5],scale:[.9,.9,.9],color:[177,bn.DKGRAY,bn.BLACK]},p)}return null}).filter(g=>g)]}),Le.jsxs(h1,{ref:i,limit:w_,children:[Le.jsx(Agt,{}),o.stats.map((g,p)=>{const _=pw(p,$n);switch(g){case wr.ISSOLID:return Le.jsx(Gy,{position:[_.x*l,_.y*c,0],color:[o.char[p],o.color[p],o.bg[p]]},p)}return null}).filter(g=>g)]})]},o.id)})}case lo.SPRITES:{const f=.5714285714285714,h=o.sprites.filter(p=>p.stat!==wr.ISSWIM),g=o.sprites.filter(p=>p.stat===wr.ISSWIM);return Le.jsxs("group",{position:[0,0,e],children:[Le.jsxs(h1,{ref:i,limit:w_,children:[Le.jsx(TG,{}),o.sprites.map((p,_)=>Le.jsx(Gy,{scale:[1,f,1],position:[p.x*l,(p.y-f+.5+.25)*c,c*-.5+.5]},_))]}),Le.jsxs(h1,{ref:s,limit:w_,children:[Le.jsx(bse,{}),h.filter(p=>p.pid!==r).map((p,_)=>Le.jsx(Gy,{rotation:[0,0,u.facing],position:[(p.x+1)*l,(p.y-f+.5+.25)*c,c*-.5],color:[p.char,p.color,p.bg]},_))]}),Le.jsxs(h1,{ref:a,limit:w_,children:[Le.jsx(bse,{}),g.filter(p=>p.pid!==r).map((p,_)=>Le.jsx(Gy,{position:[p.x*l,p.y*c,c*-.5],color:[p.char,p.color,p.bg]},_))]})]},o.id)}case lo.DITHER:return Le.jsx("group",{position:[0,0,e],children:Le.jsx(ab,{width:o.width,height:o.height,alphas:[...o.alphas]})},o.id)}}function Mgt(n){switch(n.type){case lo.TILES:return 0;case lo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case lo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.5}return 0}function Ogt(n){switch(n){case tl.NEAR:return .1;default:case tl.MID:return .2;case tl.FAR:return .3}}function kgt(n){switch(n){case tl.NEAR:return 64;default:case tl.MID:return 16;case tl.FAR:return 0}}function Igt(n){switch(n){case tl.NEAR:return 25;default:case tl.MID:return 45;case tl.FAR:return 90}}function Ngt({width:n,height:e}){const t=kb(),r=Gn.DRAW_CHAR_WIDTH(),i=Gn.DRAW_CHAR_HEIGHT(),s=n*r,a=e*i,o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),f=it.useRef(null),[,h]=it.useState(!1);it.useLayoutEffect(()=>{h(!0)},[]),Wg((x,E)=>{if(!o.current||!l.current||!c.current||!u.current||!f.current)return;const M=Qw(ws.getState().gadget.layers??[]),k=Gn.DRAW_CHAR_WIDTH(),N=Gn.DRAW_CHAR_HEIGHT(),I=$n*k,D=mi*N,V=n*k,G=e*N;xe(u.current.userData.focusx)||(u.current.userData={focusx:M.focusx}),l.current.position.x=0,l.current.position.y=G-D;const J=Li(V/I,1,10);c.current.position.x=V-I*J,c.current.position.y=0,c.current.scale.setScalar(J);const B=.05;let $=M.focusx-.5,U=M.focusy+.5;$*=-k,U*=-N,Mz(o.current.rotation,[0,Math.PI+M.facing,0],B,E),Mz(u.current.rotation,[Ogt(M.viewscale),0,0],B,E),F1(o.current.position,[x.size.width*.5-$,x.size.height*.5-N*.25+1,U],B,E),F1(u.current.position,[0,0,kgt(M.viewscale)],B,E),f.current.bokehScale=5,f.current.cocMaterial.worldFocusRange=1200,f.current.cocMaterial.worldFocusDistance=100,j0(u.current,"fov",Igt(M.viewscale),B,E),u.current.updateProjectionMatrix()}),ws(x=>x.gadget.over?.length??0),ws(x=>x.gadget.under?.length??0),ws(x=>x.gadget.layers?.length??0);const{over:g=[],under:p=[],layers:_=[]}=ws.getState().gadget,y=p.length*2+2,v=y+2;return Le.jsxs(Le.Fragment,{children:[_.map(x=>Le.jsx(k6,{id:x.id,from:"layers"},`media${x.id}`)),Le.jsx("group",{ref:o,children:Le.jsx("perspectiveCamera",{ref:u,near:1,far:3e3,aspect:-s/a})}),Le.jsx("group",{ref:c,children:p.map((x,E)=>Le.jsx(ob,{from:"under",id:x.id,z:E*2},x.id))}),Le.jsx("group",{"position-z":y,children:u.current&&Le.jsx(I6,{camera:u.current,viewwidth:s,viewheight:a,effects:Le.jsx(Le.Fragment,{children:Le.jsx(dG,{ref:f})}),children:Le.jsx("group",{position:[-t.marginx,-t.marginy,-512],children:Le.jsx("group",{rotation:[Math.PI*-.5,0,0],position:[0,i*-.75,0],children:_.map(x=>Le.jsx(Cgt,{id:x.id,from:"layers",z:Mgt(x)},x.id))})})})}),Le.jsx("group",{ref:l,"position-z":v,children:g.map((x,E)=>Le.jsx(ob,{from:"over",id:x.id,z:E*2},x.id))})]})}function Pgt({id:n,z:e,from:t}){const r=it.useRef(null);Wg(()=>{xe(r.current)&&(r.current.computeBoundingBox(),r.current.computeBoundingSphere())});const i=ws(Uh(o=>o.gadget[t]?.find(l=>l.id===n))),s=Gn.DRAW_CHAR_WIDTH(),a=Gn.DRAW_CHAR_HEIGHT();switch(i?.type){default:case lo.BLANK:case lo.MEDIA:return null;case lo.TILES:{const o=wG(i.char,i.color,i.bg,i.stats),l=abe(i.char,i.color,i.bg,i.stats),c=RG(i.char,i.color,i.bg,i.stats);return Le.jsx(Le.Fragment,{children:Le.jsxs("group",{position:[0,0,e],children:[Le.jsx(Bv,{width:i.width,height:i.height,char:o.char,color:o.color,bg:o.bg}),Le.jsx("group",{"position-z":a*-.5,children:Le.jsx(Bv,{width:i.width,height:i.height,char:c.char,color:c.color,bg:c.bg})}),Le.jsxs(h1,{ref:r,limit:w_,children:[Le.jsx(sbe,{}),i.stats.map((u,f)=>{const h=pw(f,$n);switch(u){case wr.ISSOLID:return Le.jsx(Gy,{position:[(h.x+.5)*s,(h.y+.5)*a,a*.5],color:[177,bn.DKGRAY,bn.BLACK]},f)}return null}).filter(u=>u)]}),Le.jsx("group",{"position-z":a+1,children:Le.jsx(Bv,{width:i.width,height:i.height,char:l.char,color:l.color,bg:l.bg})})]},i.id)})}case lo.SPRITES:{const o=.5714285714285714,l=i.sprites.filter(u=>u.stat!==wr.ISSWIM),c=i.sprites.filter(u=>u.stat===wr.ISSWIM);return Le.jsxs("group",{position:[0,0,e],children:[Le.jsxs(h1,{ref:r,limit:w_,children:[Le.jsx(TG,{}),i.sprites.map((u,f)=>Le.jsx(Gy,{scale:[1,o,1],position:[u.x*s,(u.y+.25)*a,a*-.75+.5]},f))]}),Le.jsx(sk,{sprites:[...l],scale:1.5,fliptexture:!1}),Le.jsx("group",{"position-z":a*-.5,children:Le.jsx(sk,{sprites:[...c],scale:1.5,fliptexture:!1})})]},i.id)}case lo.DITHER:return Le.jsx("group",{position:[0,0,e],children:Le.jsx(ab,{width:i.width,height:i.height,alphas:[...i.alphas]})},i.id)}}function Dgt(n){switch(n.type){case lo.TILES:return 0;case lo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case lo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.75}return 0}function Lgt(n){switch(n){case tl.NEAR:return 6;default:case tl.MID:return 3;case tl.FAR:return 1.2}}function Ugt({width:n,height:e}){const t=kb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),[,f]=it.useState(!1);it.useLayoutEffect(()=>{f(!0)},[]),Wg((v,x)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current||!u.current)return;const E=Qw(ws.getState().gadget.layers??[]),M=Gn.DRAW_CHAR_WIDTH(),k=Gn.DRAW_CHAR_HEIGHT(),N=n*Gn.DRAW_CHAR_WIDTH(),I=e*Gn.DRAW_CHAR_HEIGHT();xe(l.current.userData.focusx)||(s.current.scale.setScalar(E.viewscale),l.current.userData={focusx:E.focusx,focusy:E.focusy,focuslx:E.focusx,focusly:E.focusy,focusvx:0,focusvy:0,facing:E.facing,focusz:0}),a.current.position.x=0,a.current.position.y=I-k;const D=Li(N/M,1,10);o.current.position.x=N-M*D,o.current.position.y=0,o.current.scale.setScalar(D);const V=.125,G=l.current.userData.focusx+.5,J=l.current.userData.focusy+.5,B=G*M,$=J*k;switch(F1(s.current.scale,Lgt(E.viewscale),V,x),F1(l.current.position,[-B,-$,0],V,x),j0(l.current.userData,"focusx",E.focusx,V),j0(l.current.userData,"focusy",E.focusy,V),c.current.position.x=v.size.width*.5,c.current.position.y=v.size.height*.5,c.current.updateProjectionMatrix(),E.viewscale){case tl.NEAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=1e3;break;default:case tl.MID:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1e3,u.current.cocMaterial.worldFocusDistance=1e3;break;case tl.FAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1500,u.current.cocMaterial.worldFocusDistance=1e3;break}}),ws(v=>v.gadget.over?.length??0),ws(v=>v.gadget.under?.length??0),ws(v=>v.gadget.layers?.length??0);const{over:h=[],under:g=[],layers:p=[]}=ws.getState().gadget,_=g.length*2+2,y=_+2;return Le.jsxs(Le.Fragment,{children:[Le.jsxs("group",{"position-z":_,children:[p.map(v=>Le.jsx(k6,{id:v.id,from:"layers"},`media${v.id}`)),Le.jsx("orthographicCamera",{ref:c,left:r*-.5,right:r*.5,top:i*-.5,bottom:i*.5,near:1,far:2e3,position:[0,0,1e3]}),c.current&&Le.jsx(I6,{camera:c.current,viewwidth:r,viewheight:i,effects:Le.jsx(Le.Fragment,{children:Le.jsx(dG,{ref:u})}),children:Le.jsx("group",{position:[t.marginx,t.marginy,-500],children:Le.jsx("group",{rotation:[Math.PI*.25,0,Math.PI*-.25],children:Le.jsx("group",{ref:s,children:Le.jsx("group",{ref:l,children:p.map(v=>Le.jsx(Pgt,{id:v.id,from:"layers",z:Dgt(v)},v.id))})})})})})]}),Le.jsx("group",{ref:o,children:g.map((v,x)=>Le.jsx(ob,{from:"under",id:v.id,z:x*2},v.id))}),Le.jsx("group",{ref:a,"position-z":y,children:h.map((v,x)=>Le.jsx(ob,{from:"over",id:v.id,z:x*2},v.id))})]})}function Bgt({id:n,z:e,from:t}){const r=it.useRef(null);Wg(()=>{xe(r.current)&&(r.current.computeBoundingBox(),r.current.computeBoundingSphere())});const i=ws(Uh(o=>o.gadget[t]?.find(l=>l.id===n))),s=Gn.DRAW_CHAR_WIDTH(),a=Gn.DRAW_CHAR_HEIGHT();switch(i?.type){default:case lo.BLANK:case lo.MEDIA:return null;case lo.TILES:{const o=wG(i.char,i.color,i.bg,i.stats),l=abe(i.char,i.color,i.bg,i.stats),c=RG(i.char,i.color,i.bg,i.stats);return Le.jsxs("group",{position:[0,0,e],children:[Le.jsx(Bv,{width:i.width,height:i.height,char:o.char,color:o.color,bg:o.bg}),Le.jsx("group",{"position-z":a*-.25,children:Le.jsx(Bv,{width:i.width,height:i.height,char:c.char,color:c.color,bg:c.bg})}),Le.jsx("group",{"position-z":a*.25,children:Le.jsx(Bv,{width:i.width,height:i.height,char:l.char,color:l.color,bg:l.bg})})]},i.id)}case lo.SPRITES:{const o=.5714285714285714,l=i.sprites.filter(u=>u.stat!==wr.ISSWIM),c=i.sprites.filter(u=>u.stat===wr.ISSWIM);return Le.jsxs("group",{position:[0,0,e],children:[Le.jsxs(h1,{ref:r,limit:w_,children:[Le.jsx(TG,{}),i.sprites.map((u,f)=>Le.jsx(Gy,{scale:[1,o,1],position:[u.x*s,(u.y+.5)*a,a*-.5+.5]},f))]}),Le.jsx(sk,{sprites:[...l],withbillboards:!0,fliptexture:!1}),Le.jsx("group",{"position-z":a*-.5,children:Le.jsx(sk,{sprites:[...c],withbillboards:!0,fliptexture:!1})})]},i.id)}case lo.DITHER:{const o=new Array((i.width+2)*(i.height+2)).fill(0);for(let c=1;c<$n-1;++c){const u=i.alphas[_f({x:1+c,y:0},$n)],f=i.alphas[_f({x:1+c,y:mi-1},$n)];o[_f({x:1+c,y:0},$n+2)]=u,o[_f({x:1+c,y:mi},$n+2)]=f}for(let c=1;c<mi-1;++c){const u=i.alphas[_f({x:0,y:1+c},$n)],f=i.alphas[_f({x:$n-1,y:1+c},$n)];o[_f({x:0,y:1+c},$n+2)]=u,o[_f({x:$n,y:1+c},$n+2)]=f}const l=Gn.DRAW_CHAR_HEIGHT();return Le.jsxs(Le.Fragment,{children:[Le.jsx("group",{position:[0,0,e],children:Le.jsx(ab,{width:i.width,height:i.height,alphas:[...i.alphas]})},`under${i.id}`),Le.jsx("group",{position:[0,0,e+l],children:Le.jsx(ab,{width:i.width,height:i.height,alphas:[...i.alphas]})},`mid${i.id}`),Le.jsx("group",{position:[0,0,e+l],children:Le.jsx(ab,{width:i.width+2,height:i.height+2,alphas:o})},`over${i.id}`)]})}}}function Fgt(n){switch(n.type){case lo.TILES:return 0;case lo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case lo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.5}return 0}function zgt(n,e){switch(n){case tl.NEAR:return e*.11;default:case tl.MID:return e*.082;case tl.FAR:return e*.04}}function jgt(n){switch(n){case tl.NEAR:return 160;default:case tl.MID:return 320;case tl.FAR:return 768}}function Hgt(n){switch(n){case tl.NEAR:return .888;default:case tl.MID:return .777;case tl.FAR:return .444}}function qgt({width:n,height:e}){const t=kb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),[,f]=it.useState(!1);it.useLayoutEffect(()=>{f(!0)},[]),Wg((I,D)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current||!u.current)return;const V=Qw(ws.getState().gadget.layers??[]),G=Gn.DRAW_CHAR_WIDTH(),J=Gn.DRAW_CHAR_HEIGHT(),B=$n*G,$=mi*J;xe(l.current.userData.focusx)||(l.current.userData={focusx:V.focusx,focusy:V.focusy}),a.current.position.x=0,a.current.position.y=i-J;const U=Li(r/G,1,10);o.current.position.x=r-G*U,o.current.position.y=0,o.current.scale.setScalar(U);const Q=.125;let W=l.current.userData.focusx+.5,q=l.current.userData.focusy+.5;switch(W*=-Gn.DRAW_CHAR_WIDTH(),q*=-Gn.DRAW_CHAR_HEIGHT(),W+=B*.5,q+=$*.5,F1(c.current.position,[I.size.width*.5,I.size.height*.5+zgt(V.viewscale,i),jgt(V.viewscale)],Q,D),Mz(s.current.rotation,[Hgt(V.viewscale),0,0],Q,D),F1(l.current.position,[W,q,0],Q,D),j0(l.current.userData,"focusx",V.focusx,Q),j0(l.current.userData,"focusy",V.focusy,Q),c.current.rotation.z=Math.PI,c.current.updateProjectionMatrix(),V.viewscale){case tl.NEAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=500;break;default:case tl.MID:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=600;break;case tl.FAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1e3,u.current.cocMaterial.worldFocusDistance=1100;break}}),ws(I=>I.gadget.over?.length??0),ws(I=>I.gadget.under?.length??0),ws(I=>I.gadget.layers?.length??0);const{over:h=[],under:g=[],layers:p=[]}=ws.getState().gadget,_=Gn.DRAW_CHAR_WIDTH(),y=Gn.DRAW_CHAR_HEIGHT(),v=$n*_,x=mi*y,E=v*-.5+t.marginx,M=x*-.5+-t.marginy,k=g.length*2+2,N=k+2;return Le.jsxs(Le.Fragment,{children:[p.map(I=>Le.jsx(k6,{id:I.id,from:"layers"},`media${I.id}`)),Le.jsx("perspectiveCamera",{ref:c,near:1,far:2e3,aspect:-r/i}),Le.jsx("group",{"position-z":k,children:c.current&&Le.jsx(I6,{camera:c.current,viewwidth:r,viewheight:i,effects:Le.jsx(Le.Fragment,{children:Le.jsx(dG,{ref:u})}),children:Le.jsx("group",{position:[E,M,-1e3],children:Le.jsx("group",{ref:s,children:Le.jsx("group",{ref:l,children:p.map(I=>Le.jsx(Bgt,{id:I.id,from:"layers",z:Fgt(I)},I.id))})})})})}),Le.jsx("group",{ref:o,children:g.map((I,D)=>Le.jsx(ob,{from:"under",id:I.id,z:D*2},I.id))}),Le.jsx("group",{ref:a,"position-z":N,children:h.map((I,D)=>Le.jsx(ob,{from:"over",id:I.id,z:D*2},I.id))})]})}function Vgt({width:n,height:e}){const t=hx(n,e,0,bn.WHITE,bn.ONCLEAR),r=ws(s=>s.gadget.tickers),i=it.useMemo(()=>({...Tb(n,e,bn.WHITE,bn.BLACK),...t.getState()}),[n,e,t]);if(xe(r)){i.x=0,i.y=2,i.disablewrap=!0;const s=t.getState();Zk(s,0,bn.WHITE,bn.ONCLEAR);for(let a=0;a<r.length;++a){const o=r[a];fi(o,i,!1),i.x=0,i.y++}}return Le.jsx(_x,{store:t,children:Le.jsx(vx,{width:n,height:e})})}function DS(n,e,t){let r=0;t.alt&&(r|=CH),t.ctrl&&(r|=MH),t.shift&&(r|=OH),R0(n)&&wce(St,n,e,r)}function Ggt({width:n,height:e}){const t=as();ws(s=>s.gadget.id),ws(s=>s.gadget.layers?.length??0);const r=ws(s=>Qw(s.gadget.layers??[]).graphics),i=1.2;return Le.jsxs(Le.Fragment,{children:[Le.jsx($c,{MOVE_LEFT:s=>DS(t,Tn.MOVE_LEFT,s),MOVE_RIGHT:s=>DS(t,Tn.MOVE_RIGHT,s),MOVE_UP:s=>DS(t,Tn.MOVE_UP,s),MOVE_DOWN:s=>DS(t,Tn.MOVE_DOWN,s),OK_BUTTON:s=>DS(t,Tn.OK_BUTTON,s),CANCEL_BUTTON:s=>DS(t,Tn.CANCEL_BUTTON,s),MENU_BUTTON:s=>DS(t,Tn.MENU_BUTTON,s),keydown:s=>{const a=Vr(s.key),o=C3(s),l=as();switch(a){case"c":nX(St,l,"");break;case"#":case"3":nX(St,l,"#");break;case"p":o.ctrl&&Ace(St,l);break;case"a":o.ctrl&&cIe(St,l);break}}}),r==="flat"&&Le.jsx(Tgt,{width:n,height:e}),r==="mode7"&&Le.jsx(qgt,{width:n,height:e}),r==="iso"&&Le.jsx(Ugt,{width:n,height:e}),r==="fpv"&&Le.jsx(Ngt,{width:n,height:e}),Le.jsx("group",{"position-z":512,scale:[i,i,i],children:Le.jsx(Vgt,{width:Math.floor(n/i),height:Math.floor(e/i)})})]})}function Sse({rect:n,islandscape:e=!0,sidebaropen:t=!0,shouldclose:r=!1}){switch(n.type){case 0:return Le.jsx("group",{"position-z":512,children:Le.jsx(rbe,{width:n.width,height:n.height,color:14,bg:1,text:n.text,xmargin:e?1:t?3:10,ymargin:e&&!t?6:0})});case 1:return Le.jsx(lgt,{width:n.width,height:n.height,color:14,bg:1,text:n.text,shouldclose:r});case 2:return Le.jsx(Ggt,{width:n.width,height:n.height})}return null}const cT=20;function $gt(){const n=kb(),{islandscape:e,sidebaropen:t,insetrows:r,showtouchcontrols:i}=km(),s=ws(Xne(p=>p.gadget.scroll??[])),a=s.length===0,[o,l]=it.useState(!1),c=ws(Xne(p=>p.gadget.sidebar??[]));if(n.cols<10||n.rows<10)return null;const u={name:"main",type:2,x:0,y:0,text:[],width:n.cols,height:n.rows},f=[];if(c.length)if(i)if(e){const p=t?cT+5:cT,_=t?cT:4,y={name:"sidebar",type:0,x:u.x+u.width-_,y:u.y,width:p,height:u.height,text:c};u.width-=_,f.push(y)}else{const p=t?r-7:r,_=t?p:4,y={name:"sidebar",type:0,x:0,y:u.y+u.height-_,width:u.width,height:p,text:c};u.height-=_,f.push(y)}else{const p={name:"sidebar",type:0,x:u.x+u.width-cT,y:u.y,width:cT,height:u.height,text:c};u.width-=cT,f.push(p)}const h={name:"scroll",type:1,x:0,y:0,width:Li(50,24,u.width-2),height:Li(18,8,u.height-8),text:s};h.x=u.x+Math.floor((u.width-h.width)*.5),h.y=u.y+Math.floor((u.height-h.height)*.5),!a&&!o&&l(!0),f.unshift(u);const g=as();return Le.jsxs(aS.Provider,{value:{sendmessage(p,_){St.emit(g,p,_)},sendclose(){C3e(St,g)},didclose(){l(!1)}},children:[Le.jsx("group",{position:[-Gn.DRAW_CHAR_WIDTH(),-Gn.DRAW_CHAR_HEIGHT(),-524],children:Le.jsx(Uv,{visible:!0,color:new cr(.076,.076,0),width:n.cols+2,height:n.rows+2})}),Le.jsx("group",{position:[0,0,-512],children:f.map(p=>Le.jsx("group",{position:[p.x*Gn.DRAW_CHAR_WIDTH(),p.y*Gn.DRAW_CHAR_HEIGHT(),0],children:Le.jsx(Sse,{islandscape:!i||e,sidebaropen:!i||t,rect:p})},p.name))}),o&&Le.jsxs(Ng.Fragment,{children:[Le.jsx("group",{position:[0,0,800],children:Le.jsx(emt,{width:n.cols,height:n.rows,alpha:.14})}),Le.jsx("group",{position:[h.x*Gn.DRAW_CHAR_WIDTH(),h.y*Gn.DRAW_CHAR_HEIGHT(),900],children:Le.jsx(Sse,{rect:h,shouldclose:a})})]},"scroll")]})}const Wgt=250,Ygt=249,c4=bn.BLUE,Xgt=bn.WHITE,Kgt=bn.DKGRAY,AG=bn.BLACK;function yR(n){return n?bn.ONCLEAR:bn.DKBLUE}function Zgt(n){return Math.round(n*.333)}function Jgt(n){return Math.round(n*.5)}const obe=it.createContext({sendmessage(){}});function R1(n,e,t,r){const i=Z0(r);r.iseven=r.y%2===0,r.active.bg=n?AG:r.reset.bg,r.active.leftedge=i.left,r.active.rightedge=i.right,r.active.topedge=i.top,r.active.bottomedge=i.bottom,r.x=r.active.leftedge+e,r.y=r.active.topedge+t}function KS(n,e,t,r,i,s,a,o){const l=Z0(i);i.iseven=i.y%2===0,i.active.color=bn.WHITE,i.active.bg=i.reset.bg,i.active.leftedge=l.left+s,i.active.rightedge=l.right-s,i.active.topedge=l.top+a,i.active.bottomedge=l.bottom-o,i.x=i.active.leftedge+t,i.y=i.active.topedge+r}function Qgt(n){let e=0;return n.split(/\r?\n/).map(r=>{const i=e,s=`${r}
`;return e+=s.length,{start:i,code:s,end:i+r.length}})}function e0t(n){return n.reduce((e,t)=>{const r=t.code.length;return r>e?r:e},0)}function t0t(n,e){for(let t=0;t<e.length;++t)if(n<=e[t].end)return t;return 0}function CG({bump:n}){const e=Fh(),t=Z0(e),{quickterminal:r}=oo(),i=yR(r);if(n&&t.top++,r){for(let s=t.top;s<=t.bottom;++s)for(let a=t.left;a<=t.right;++a)pu(e,e.width,e.height,a,s,{char:0,color:c4,bg:i});return null}for(let s=t.top;s<=t.bottom;++s)for(let a=t.left;a<=t.right;++a){let o=0;(a+s)%2===0&&(o=Math.abs(Math.round(Math.cos(a*s*.01)))?Wgt:Ygt),pu(e,e.width,e.height,a,s,{char:o,color:c4,bg:i})}return null}const ZF=bn.WHITE,Y2=bn.GREEN,qu=bn.YELLOW,n0t=bn.CYAN,Ag=bn.DKGREEN,Ese=bn.DKCYAN,r0t=bn.GREEN,FP=bn.DKPURPLE,lbe=bn.WHITE,i0t=bn.LTGRAY,s0t=bn.DKGRAY,xse=bn.DKRED,a0t=bn.DKRED,JF=bn.DKYELLOW,o0t={[MO.tokenTypeIdx??0]:ZF,[nde.tokenTypeIdx??0]:ZF,[rde.tokenTypeIdx??0]:ZF,[LE.tokenTypeIdx??0]:FP,[qy.tokenTypeIdx??0]:qu,[OO.tokenTypeIdx??0]:Y2,[kO.tokenTypeIdx??0]:n0t,[yw.tokenTypeIdx??0]:a0t,[IO.tokenTypeIdx??0]:qu,[cq.tokenTypeIdx??0]:qu,[Eu.tokenTypeIdx??0]:Y2,[q2.tokenTypeIdx??0]:Y2,[yL.tokenTypeIdx??0]:lbe,[uq.tokenTypeIdx??0]:qu,[fq.tokenTypeIdx??0]:qu,[hq.tokenTypeIdx??0]:qu,[dq.tokenTypeIdx??0]:qu,[pq.tokenTypeIdx??0]:qu,[mq.tokenTypeIdx??0]:qu,[bL.tokenTypeIdx??0]:JF,[SL.tokenTypeIdx??0]:JF,[EL.tokenTypeIdx??0]:JF,[xL.tokenTypeIdx??0]:qu,[TL.tokenTypeIdx??0]:qu,[gq.tokenTypeIdx??0]:qu,[_q.tokenTypeIdx??0]:qu,[dE.tokenTypeIdx??0]:qu,[vq.tokenTypeIdx??0]:qu,[yq.tokenTypeIdx??0]:qu,[NO.tokenTypeIdx??0]:qu,[bq.tokenTypeIdx??0]:qu,[Sq.tokenTypeIdx??0]:qu,[Eq.tokenTypeIdx??0]:r0t,[pE.tokenTypeIdx??0]:Ag,[mE.tokenTypeIdx??0]:Ese,[wL.tokenTypeIdx??0]:Ese,[gE.tokenTypeIdx??0]:Ag,[xq.tokenTypeIdx??0]:Ag,[Tq.tokenTypeIdx??0]:Ag,[wq.tokenTypeIdx??0]:Ag,[Rq.tokenTypeIdx??0]:Ag,[Aq.tokenTypeIdx??0]:Ag,[Cq.tokenTypeIdx??0]:Ag};bn.DKPURPLE;const l0t=bn.DKYELLOW,c0t=bn.DKPURPLE,u0t=bn.CYAN,f0t=bn.DKCYAN,h0t=bn.RED,d0t=bn.WHITE,p0t=bn.LTGRAY,m0t=bn.YELLOW,cbe=new Map;function m_(n,e){cbe.set(n,e)}function Tse(n){const e=[];let t=0;for(let r=0;r<n.length;++r){switch(n[r]){case";":t=0;break;case" ":break;default:t===0&&(t=1);break;case"#":t===0&&(t=2);break}switch(t){case 0:e.push(bn.LTGRAY);break;case 1:e.push(v0t(n[r]));break;case 2:e.push(bn.CYAN);break}}return e.push(bn.BLUE),e}function g0t(n){if(n.startsWith("play ")){const e=new Array(5).fill(Ag);return e.push(...Tse(n.slice(5))),e}else if(n.startsWith("bgplay ")){const e=new Array(7).fill(Ag);return e.push(...Tse(n.slice(7))),e}return cbe.get(n)??bn.GREEN}const yx=bn.GREEN,_0t=bn.DKGREEN,ly=bn.PURPLE,bx=bn.DKCYAN,ube=bn.CYAN,fbe=bn.YELLOW,hbe=bn.DKYELLOW,dbe=new Map;function Qa(n,e){dbe.set(n,e)}function v0t(n){return dbe.get(n)??bn.GREEN}function y0t(){const n=Fh(),e=Z0(n),[t,r,i]=oo(Uh(v=>[v.quickterminal,v.editor.type,v.editor.title])),s=bn.WHITE,a=yR(t);for(let v=e.top;v<e.bottom;++v)pu(n,n.width,n.height,e.left,v,{char:179,color:s,bg:a}),pu(n,n.width,n.height,e.right,v,{char:179,color:s,bg:a});KS(!1,!1,0,0,n,0,0,0),fi("$213$205$187",n,!0),KS(!1,!1,n.width-3,0,n,0,0,0),fi("$196$196$191",n,!0);const o="$205".repeat(e.width-2);KS(!1,!1,0,e.height-1,n,0,0,0),fi(`$212${o}$190`,n,!0);const l=Xg(),c="$205".repeat(e.width-4);KS(!1,!1,0,1,n,0,0,0),fi(`$179$${l?"7":"232"}$200${c}$181`,n,!0);const f=` ${`$blue[${r}] `}$green${i}$white `,g=Q1(f,e.width,e.height)?.measuredwidth??1,p=e.width-2,_=2+Math.round(p*.5)-Math.round(g*.5);KS(!1,!1,_,1,n,0,0,0),fi(f,n,!0);const y=z1?`shift+${y0}+z`:`${y0}+y`;return Le.jsx(EG,{margin:3,color:bn.BLUE,y:e.top,leftedge:0,rightedge:e.width-1,line:`
    esc/cancel$white.CLOSE   $blue
    tab$white.CHANGE LAYOUT   $blue
    hold shift$white.SELECT TEXT   $blue
    alt+up/down$white.JUMP 10 LINES   $blue
    alt+left/right$white.JUMP 10 COLS   $blue
    ${y0}+up/down$white.JUMP TOP/BOTTOM   $blue
    ${y0}+left/right$white.JUMP TO START/END OF LINE   $blue
    ${y0}+a$white.SELECT ALL   $blue
    ${y0}+c$white.COPY   $blue
    ${y0}+x$white.CUT   $blue
    ${y0}+v$white.PASTE   $blue
    ${y0}+z$white.UNDO   $blue
    ${y}$white.REDO   $blue
    ${y0}+p$white.TEST SELECTED CODE   $blue
    ${y0}+k$white.OPEN REFSCROLL   $blue
    ${y0}+e$white.COPY CODEPAGE TO CLIPBOARD AS JSON   $blue
    `,context:n})}function b0t({xcursor:n,ycursor:e,xoffset:t,yoffset:r,rows:i,codepage:s}){const a=Xg(),o=Fh(),l=bc(),c=as(),u=it.useRef(void 0),f=Z0(o),h=oo(q=>q.editor.path),g=xe(s)?s.toJSON():"",p=i.length-1,_=n+1-t,y=e+2-r;if(xe(s)){const q=u.current?.x!==_||u.current?.y!==y;if(a||q){const Y=f.left+_,ae=f.top+y;if(ae>f.top+1&&ae<f.bottom&&Y>f.left&&Y<f.right){const Z=Y+ae*o.width;$U(Z,"Ý",o),Sw(Z,Z,bn.WHITE,bn.DKBLUE,o)}}}u.current={x:_,y};const v=i[p].end,x=i[e];let E=l.cursor,M=l.cursor,k=!1;xe(l.select)&&(k=!0,E=Math.min(l.cursor,l.select),M=Math.max(l.cursor,l.select),l.cursor!==l.select&&--M);const N=M-E+1,I=k?g.substring(E,M+1):"";function D(q){q?xe(l.select)||bc.setState({select:l.cursor}):bc.setState({select:void 0})}const V=it.useCallback(function(q,Y,ae){Y>0&&s?.delete(q,Y),xe(ae)&&s?.insert(q,ae),bc.setState({cursor:q+(ae??"").length,select:void 0})},[s]),G=it.useCallback(function(q,Y,ae){Y>0&&s?.delete(q,Y),xe(ae)&&s?.insert(q,ae),bc.setState({cursor:q+(ae??"").length})},[s]);function J(){if(k){const q=I.split(`
`);for(let Y=0;Y<q.length;++Y){const ae=q[Y],Z=ae.trim();Z.startsWith("'")?q[Y]=ae.replace(/' ?/,""):Z&&(q[Y]=`' ${ae}`)}V(E,N,q.join(`
`))}}function B(q=!0){if(k){const Y=I.split(`
`);for(let ae=0;ae<Y.length;++ae){const Z=Y[ae];q?Y[ae].startsWith(" ")&&(Y[ae]=Z.substring(1)):Y[ae]=` ${Z}`}G(E,N,Y.join(`
`))}}function $(){k&&(bc.setState({cursor:E}),V(E,N))}function U(){bc.setState({cursor:v,select:void 0})}const Q=it.useCallback(function(q){const Y=Math.round(e+q);if(Y<0)bc.setState({cursor:0});else if(Y>p)bc.setState({cursor:v});else{const ae=i[Y];bc.setState({cursor:ae.start+Math.min(n,ae.code.length-1)})}},[v,i,p,n,e]),W=it.useMemo(()=>s?new dYe(s):void 0,[s]);return it.useEffect(()=>{function q(ae){ae.stackItem.meta.set("cursor",l.cursor)}function Y(ae){if(ae.stackItem.meta.has("cursor")){const Z=ae.stackItem.meta.get("cursor");bc.setState({cursor:Z})}}return W?.on("stack-item-added",q),W?.on("stack-item-popped",Y),()=>{W?.off("stack-item-added",q),W?.off("stack-item-popped",Y)}},[W,l.cursor]),Le.jsxs(Le.Fragment,{children:[Le.jsx(SG,{blocking:!0,x:f.left,y:f.top,width:f.width,height:f.height,onScroll:q=>Q(q*.75)}),Le.jsx($c,{keydown:q=>{if(!xe(s))return;const{key:Y}=q,ae=Vr(Y),Z=C3(q);switch(ae){case"arrowleft":if(D(Z.shift),Z.ctrl)bc.setState({cursor:x.start});else{const K=l.cursor-(Z.alt?10:1);bc.setState({cursor:Li(K,0,v)})}break;case"arrowright":if(D(Z.shift),Z.ctrl)bc.setState({cursor:x.end});else{const K=l.cursor+(Z.alt?10:1);bc.setState({cursor:Li(K,0,v)})}break;case"arrowup":D(Z.shift),Z.ctrl?bc.setState({cursor:0}):Q(Z.alt?-10:-1);break;case"arrowdown":D(Z.shift),Z.ctrl?bc.setState({cursor:v}):Q(Z.alt?10:1);break;case"enter":xe(s)&&(s.insert(l.cursor,`
`),bc.setState({cursor:l.cursor+1}));break;case"esc":case"escape":Z.shift||Z.alt||Z.ctrl?VD(St,c):X3e(St,c);break;case"tab":Sce(St,c,!Z.shift);break;case"delete":k?$():V(l.cursor,1);break;case"backspace":k?$():g.length>0&&V(Math.max(l.cursor-1,0),1);break;default:if(Z.ctrl)switch(ae){case"e":sIe(St,c,h);break;case"z":z1&&Z.shift?W?.redo():W?.undo();break;case"y":z1||W?.redo();break;case"a":bc.setState({cursor:v,select:0});break;case"c":xe(el())?el().writeText(I).catch(K=>xi(St,c,"clipboard",K)):U();break;case"v":xe(el())?el().readText().then(K=>{const ne=K.replaceAll("\r","");k?V(E,N,ne):V(l.cursor,0,ne)}).catch(K=>xi(St,c,"clipboard",K)):U();break;case"x":xe(el())&&k?el().writeText(I).then(()=>$()).catch(K=>xi(St,c,"clipboard",K)):U();break;case"p":k?(Av(St,c,I),Ts(St,c,`running $WHITE${I.substring(0,16)}...$BLUE`)):(Av(St,c,x.code),Ts(St,c,`running $WHITE${x.code.substring(0,16)}...$BLUE`));break;case"'":J();break}else if(!Z.alt){if(q.key.length===1)if(k)q.key==="'"?J():q.key===" "?B(q.shiftKey):V(E,N,q.key);else{const K=l.cursor+q.key.length;s.insert(l.cursor,q.key),bc.setState({cursor:K})}}break}}})]})}function wse(n){const[e]=n.substring(1).split(";");return e.split(" ")}let zP;function g_(n){const e=XQe(s0e(n));Object.keys(e).length&&(zP=e)}function S0t({ycursor:n,xoffset:e,yoffset:t,rows:r,codepage:i}){const s=Xg(),a=Fh(),o=bc(),{quickterminal:l}=oo(),c=it.useMemo(()=>{if(r.length){const y=r[r.length-1];return[...r,{code:"",start:y.end+1,end:y.end+1}]}return[]},[r]);if(!xe(i)){const y=(s?"|":"-").repeat(3);return KS(!1,!1,0,0,a,1,2,1),fi(` ${y} LOADING ${y}`,a,!0),null}const u=a.width-2,f=Z0(a);f.right=u-1;let h=o.cursor,g=o.cursor,p=!1;xe(o.select)&&(p=!0,h=Math.min(o.cursor,o.select),g=Math.max(o.cursor,o.select),o.cursor!==o.select&&--g);const _=f.left+1-4;KS(!1,!1,-e,-t,a,1,2,1);for(let y=0;y<c.length;++y){if(a.y<=f.top+1){++a.y;continue}const v=c[y],x=c[y-1],E=y===n,M=y-1===n,k=v.code.replaceAll(`
`,""),N=_-e;a.x=N,a.iseven=a.y%2===0,a.active.bg=E?AG:yR(l),a.disablewrap=!0,a.active.rightedge=u;const[I]=v.errors??[],D=`${y+1}`.padStart(3," ");Y9(`${y<r.length?D:"   "} ${k} `,a,!1);const V=1+a.y*a.width;m0(V,f.right,-e-3,-e,i0t,a.active.bg,a);let G=-1;const J=Li(o.cursor-v.start,1,v.end-v.start);if(xe(v.tokens))for(let B=0;B<v.tokens.length;++B){const $=v.tokens[B];E&&J>=($.startColumn??1)&&J<=($.endColumn??1)&&(G=B);const U=($.startColumn??1)-1-e,Q=($.endColumn??1)-1-e,W=o0t[$.tokenTypeIdx];if(xe(W))switch(W){case FP:{const q=wse($.image);switch(F9("",q,!!$.payload).type){case hr.BOARD:case hr.LOADER:case hr.OBJECT:case hr.TERRAIN:case hr.CHARSET:case hr.PALETTE:{m0(V,f.right,U,Q,FP,a.active.bg,a);break}case hr.CONST:case hr.RANGE:case hr.SELECT:case hr.NUMBER:case hr.TEXT:case hr.HOTKEY:case hr.COPYIT:case hr.OPENIT:case hr.ZSSEDIT:case hr.CHAREDIT:case hr.COLOREDIT:{const[ae]=q;m0(V,f.right,U,U+ae.length,FP,a.active.bg,a),q.length>1&&m0(V,f.right,U+ae.length+1,Q,lbe,a.active.bg,a);break}default:m0(V,f.right,U,Q,bn.DKRED,a.active.bg,a);break}break}case qu:{m0(V,f.right,U,U,W,a.active.bg,a),U!==Q&&m0(V,f.right,U+1,Q,Y2,a.active.bg,a);break}case Y2:{const q=g0t($.image);if(ui(q))for(let Y=0;Y<q.length;++Y)m0(V,f.right,U+Y,Q+Y,q[Y],a.active.bg,a);else m0(V,f.right,U,Q,q,a.active.bg,a);break}default:m0(V,f.right,U,Q,W,a.active.bg,a);break}}if(p&&v.start<=g&&v.end>=h){const B=Math.max(v.start,h)-v.start-e,$=Math.min(v.end,g)-v.start-e,U=f.width-3,Q=Math.max(0,B),W=Math.min(U,$);Q<=U&&W>=_&&m0(V,f.right,Q,W,Xgt,Kgt,a)}if(E&&xe(v.tokens)){let B;if(xe(v.asts)){for(let $=0;$<(v.asts?.length??0);++$)v.asts[$].type===ir.IF&&(B=v.asts[$]);xe(B)||(B=v.asts.find($=>J<=($.endColumn??0)))}zP=void 0;for(let $=G;$>=0;--$){const U=v.tokens[$-1],Q=v.tokens[$],W=v.tokens[$+1];switch(Q.tokenTypeIdx){case qy.tokenTypeIdx:case mE.tokenTypeIdx:case pE.tokenTypeIdx:case gE.tokenTypeIdx:case LE.tokenTypeIdx:case yw.tokenTypeIdx:case kO.tokenTypeIdx:case IO.tokenTypeIdx:case NO.tokenTypeIdx:case dE.tokenTypeIdx:case OO.tokenTypeIdx:if(Q.tokenTypeIdx===dE.tokenTypeIdx&&(!xe(B)||Q.startColumn!==B.startColumn))continue;break;default:continue}switch(Q.tokenTypeIdx){case qy.tokenTypeIdx:{g_(`editor:command:${W.image}`);break}case mE.tokenTypeIdx:{g_("editor:command:do");break}case pE.tokenTypeIdx:{g_(U.tokenTypeIdx===gE.tokenTypeIdx?"editor:command:elseif":"editor:command:if");break}case gE.tokenTypeIdx:{g_(W.tokenTypeIdx===pE.tokenTypeIdx?"editor:command:elseif":"editor:command:else");break}case LE.tokenTypeIdx:{const q=wse(Q.image),Y=F9("",q,!!Q.payload);g_(`editor:stat:${s1(Y.type)}`);break}case yw.tokenTypeIdx:{g_("editor:label");break}case kO.tokenTypeIdx:{g_("editor:comment");break}case IO.tokenTypeIdx:{g_("editor:hyperlink");break}case NO.tokenTypeIdx:{g_("editor:shorttry");break}case dE.tokenTypeIdx:{g_("editor:shortgo");break}case OO.tokenTypeIdx:{g_("editor:text");break}}break}Vn(zP?.desc)&&fi(zP.desc,a,!1)}if(M&&xe(x.errors)){a.x=N;const[B]=x.errors,$=`${B.message}`.replaceAll(`
`," ");Y9($,a,!1),m0(V,f.right,0,$.length-1,bn.WHITE,xse,a)}else if(xe(I)){const B=3+(I.column??1),$=I.length??1;Hee(V,f.right,0,2,xse,a),Hee(V,f.right,B,B+$-1,s0t,a)}if(++a.y,a.y>=f.bottom)break}return a.disablewrap=!1,a.active.rightedge=a.width,null}function QF(n){switch(n){case"stat":case"text":case"hyperlink":return!1;default:return!0}}Qa("a",yx);Qa("b",yx);Qa("c",yx);Qa("d",yx);Qa("e",yx);Qa("f",yx);Qa("g",yx);Qa("x",_0t);Qa("#",hbe);Qa("!",hbe);Qa("y",bx);Qa("t",bx);Qa("s",bx);Qa("i",bx);Qa("q",bx);Qa("h",bx);Qa("w",bx);Qa("3",ube);Qa(".",ube);Qa("+",fbe);Qa("-",fbe);Qa("0",ly);Qa("1",ly);Qa("2",ly);Qa("p",ly);Qa("4",ly);Qa("5",ly);Qa("6",ly);Qa("7",ly);Qa("8",ly);Qa("9",ly);Qa(";",qu);function Rse(){const n=as(),[e]=oo(Uh(J=>[J.editor])),[t,r,i,s,a,o,l,c,u,f,h]=ws(Uh(J=>[J.zsswords.cli,J.zsswords.loader,J.zsswords.runtime,J.zsswords.flags,J.zsswords.stats,J.zsswords.kinds,J.zsswords.altkinds,J.zsswords.colors,J.zsswords.dirs,J.zsswords.dirmods,J.zsswords.exprs]));it.useEffect(()=>{t.filter(QF).forEach(J=>m_(J,Ag)),r.filter(QF).forEach(J=>m_(J,Ag)),i.filter(QF).forEach(J=>m_(J,Ag)),s.forEach(J=>m_(J,l0t)),a.forEach(J=>m_(J,c0t)),o.forEach(J=>m_(J,u0t)),l.forEach(J=>m_(J,f0t)),c.forEach(J=>m_(J,h0t)),u.forEach(J=>m_(J,d0t)),f.forEach(J=>m_(J,p0t)),h.forEach(J=>m_(J,m0t))},[t,r,i,s,a,o,l,c,u,f,h]);const g=Fh(),p=bc(),_=Qge(Rce(e.book,e.path)),y=Z0(g);it.useEffect(()=>(uIe(St,n,e.book,e.path),()=>{fIe(St,n,e.book,e.path)}),[e.book,e.path,n]);const v=xe(_)?_.toJSON():"",x=Qgt(v),E=t0t(p.cursor,x),M=p.cursor-x[E].start,k=e0t(x),N=M0e(v);if(xe(N.tokens)){let J=!0;for(let B=0;B<N.tokens.length;++B){const $=N.tokens[B];$.tokenTypeIdx===LE.tokenTypeIdx&&($.payload=J,J=!1);const U=x[($.startLine??1)-1];xe(U)&&(U.tokens=U.tokens??[],U.tokens.push($))}}if(N?.ast?.type===ir.PROGRAM){A0e(N.ast);const J=[];for(let B=1;B<N.ast.lines.length;++B)J.push(N.ast.lines[B]);for(;J.length;){const B=J.pop();if(Mn(B?.type)){switch(B.type){case ir.LINE:case ir.IF:if(Mn(B.startLine)){const U=x[B.startLine-1];U.asts=U.asts??[],U.asts.unshift(B)}break}const $=ub(B);for(let U=0;U<$.length;++U){const Q=$[U],W=B[Q];ui(W)?J.push(...W):typeof W=="object"&&J.push(W)}}}}if(xe(N.errors))for(let J=0;J<N.errors.length;++J){const B=N.errors[J],$=x[(B.line??1)-1];xe($)&&($.errors=$.errors??[],$.errors.push(B))}const I={rows:x,xcursor:M,ycursor:E,codepage:_,xoffset:-4+p.xscroll,yoffset:p.yscroll},D=32,V=(Math.round(k/D)+1)*D,G=x.length;return it.useEffect(()=>{setTimeout(()=>{bc.setState(J=>{let B=J.xscroll;const $=M-B,U=y.width-3;let Q=Math.round(Li(Math.abs($)*.5,1,D));Q<8&&(Q=1),$>U-8&&(B+=Q),$<8&&(B-=Q);let W=J.yscroll;const q=E-W,Y=y.height-4,ae=Math.round(Y*.5);let Z=Math.round(Li(Math.abs(q)*.25,1,ae));return Z<8&&(Z=1),q>Y-4&&(W+=Z),q<4&&(W-=Z),{xscroll:Math.round(Li(B,0,V)),yscroll:Math.round(Li(W,0,G))}})},16)},[M,V,p.xscroll,E,G,p.yscroll,y.width,y.height]),Le.jsxs(Le.Fragment,{children:[Le.jsx(CG,{bump:!0}),Le.jsx(y0t,{}),Le.jsx(S0t,{...I}),Le.jsx(b0t,{...I})]})}function E0t(n,e,t,r){const i=n.slice(0,e),s=n.slice(e+t);return`${i}${r??""}${s}`}function x0t(n){const[e,t]=n.split(":"),r=xe(t);return[r?e:"self",r?t:n]}const T0t=self.SpeechRecognition??self.webkitSpeechRecognition??self.mozSpeechRecognition??self.msSpeechRecognition??self.oSpeechRecognition;class w0t{recognition;constructor(e,t,r,i=navigator.language){if(!("webkitSpeechRecognition"in window))throw new Error("This browser doesn't support speech recognition. Try Google Chrome.");this.recognition=new T0t,this.recognition.interimResults=!!r,this.recognition.lang=i;let s="";this.recognition.onresult=a=>{let o="";for(let l=a.resultIndex;l<a.results.length;l+=1){const c=a.results[l][0].transcript;a.results[l].isFinal?(s+=c,e(s),s=""):this.recognition.interimResults&&(o+=c,r(o))}},this.recognition.onend=()=>{t()}}startListening(){this.recognition.start()}stopListening(){this.recognition.stop()}}function R0t({quickterminal:n,voice2text:e,tapeycursor:t,logrowtotalheight:r}){const i=Xg(),s=Fh(),a=Jo(),o=as(),l=Z0(s),c=a.buffer[a.bufferindex];let u=a.xcursor,f=a.xcursor,h=!1;xe(a.xselect)&&xe(a.yselect)&&(h=!0,u=Math.min(a.xcursor,a.xselect),f=Math.max(a.xcursor,a.xselect),a.xcursor!==a.xselect&&--f);const g=f-u+1,p=a.ycursor===0,_=h?c.substring(u,f+1):c,y=it.useCallback(function(G,J,B){a.bufferindex>0&&Jo.setState({bufferindex:0}),a.buffer[0]=E0t(c,G,J,B),Jo.setState({buffer:a.buffer,xselect:void 0,xcursor:G+(B??"").length})},[c,a.buffer,a.bufferindex]),v=it.useCallback(function(G){a.bufferindex>0&&Jo.setState({bufferindex:0}),a.buffer[0]=G,Jo.setState({buffer:a.buffer,xselect:void 0,xcursor:G.length})},[a.buffer,a.bufferindex]);function x(G){const J=a.buffer.length-1,B=Li(G,0,J);Jo.setState({bufferindex:B,xcursor:a.buffer[B].length,ycursor:0,xselect:void 0,yselect:void 0})}function E(G){G?xe(a.xselect)||Jo.setState({xselect:a.xcursor,yselect:a.ycursor}):Jo.setState({xselect:void 0,yselect:void 0})}function M(){xe(a.xselect)&&(Jo.setState({xcursor:u,xselect:void 0,yselect:void 0}),y(u,g))}function k(){Jo.setState({scroll:0,xcursor:c.length,ycursor:0,xselect:void 0,yselect:void 0})}if(s.reset.bg=yR(n),!n){R1(!1,0,0,s);const G="main:0.67.11 - if lost try #help";s.x=1,fi(`$dkcyan${G}`,s,!0)}const N="$196",D="$205".repeat(l.width-6);R1(!1,0,l.height-2,s),s.active.color=bn.WHITE,fi(`  ${N}${D}${N}  `,s,!0);const V=c.padEnd(l.width," ");if(R1(!1,0,l.height-1,s),s.active.color=bn.WHITE,Y9(V,s,!0),xe(a.xselect)&&xe(a.yselect)&&a.xcursor!==a.xselect){const G=Math.min(a.xcursor,a.xselect),J=Math.min(a.ycursor,a.yselect),B=Math.max(a.xcursor,a.xselect)-1,$=Math.max(a.ycursor,a.yselect);for(let U=J;U<=$;++U){const Q=G+(l.bottom-U)*l.width,W=B+(l.bottom-U)*l.width;Sw(Q,W,15,8,s)}}if(i){const G=l.left+a.xcursor,J=l.top+t;if(J>=l.top&&J<=l.bottom&&G>=l.left&&G<=l.right){const B=G+J*s.width;$U(B,"Ý",s),Sw(B,B,bn.WHITE,s.reset.bg,s)}}return it.useEffect(()=>{let G;if(!e||!n)return;const{buffer:J,bufferindex:B}=Jo.getState(),$=J[B];if($.includes("#"))return;function U(q){v(`${$}${q}`),setTimeout(()=>{y_.keyboard("[Enter]").catch(bm)},512)}function Q(){}function W(q){v(`${$}${q}`)}try{G=new w0t(U,Q,W),G?.startListening()}catch(q){console.error(q.message)}return()=>{G?.stopListening(),G=void 0}},[e,n,v]),Le.jsxs(Le.Fragment,{children:[Le.jsx(SG,{blocking:!0,x:l.left,y:l.top,width:l.width,height:l.height,onScroll:G=>{E(!1),Jo.setState({ycursor:Li(Math.round(a.ycursor-G),0,r)})}}),Le.jsx($c,{keydown:G=>{const{key:J}=G,B=Vr(J),$=C3(G);switch(B){case"arrowleft":E($.shift),$.ctrl?Jo.setState({xcursor:0}):Jo.setState({xcursor:Li(a.xcursor-($.alt?10:1),0,l.right)});break;case"arrowright":E($.shift),$.ctrl?Jo.setState({xcursor:p?c.length:l.right}):Jo.setState({xcursor:Li(a.xcursor+($.alt?10:1),0,l.right)});break;case"arrowup":$.ctrl?x(a.bufferindex+1):(E($.shift),Jo.setState({ycursor:Li(Math.round(a.ycursor+($.alt?10:1)),0,r)}));break;case"arrowdown":$.ctrl?x(a.bufferindex-1):(E($.shift),Jo.setState({ycursor:Li(Math.round(a.ycursor-($.alt?10:1)),0,r)}));break;case"enter":{const U=h?_:c;if(U.length)if(p){const Q=["",U,...a.buffer.slice(1).filter(W=>W!==U)].filter(W=>W.includes("#broadcast")===!1);vnt(Q).catch(W=>xi(St,o,"terminalinput",W.message)),Jo.setState({xcursor:0,bufferindex:0,xselect:void 0,yselect:void 0,buffer:Q}),Av(St,o,U),n&&VD(St,o)}else k();break}case"esc":case"escape":VD(St,o);break;case"tab":Sce(St,o,!$.shift);break;case"delete":p?h?M():c.length>0&&y(a.xcursor,1):k();break;case"backspace":p?h?M():a.xcursor>0&&y(a.xcursor-1,1):k();break;default:if($.ctrl)switch(B){case"e":Av(St,o,"#export");break;case"p":Ace(St,o);break;case"a":Jo.setState({xselect:0,yselect:0,xcursor:c.length,ycursor:0});break;case"c":p&&xe(el())?el().writeText(_).catch(U=>console.error(U)):k();break;case"v":p&&xe(el())?el().readText().then(U=>{try{const W=JSON.parse(U);if(Vn(W.exported)&&xe(W.data)){U0(St,o,void 0,"json",`file:${W.exported}`,JSON.stringify(W));return}}catch(W){console.error(W)}const Q=U.replaceAll("\r","");h?y(u,g,Q):y(a.xcursor,0,Q)}).catch(U=>console.error(U)):k();break;case"x":p&&xe(el())?el().writeText(_).then(()=>M()).catch(U=>console.error(U)):k();break}else $.alt||G.key.length===1&&(p&&a.xcursor<=c.length?h?(y(u,g,G.key),Jo.setState({xselect:void 0})):y(a.xcursor,0,G.key):k());break}}})]})}function A0t({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useCallback(()=>{setTimeout(()=>{if(xe(el())){const[,...l]=r,c=l.join(" ");el().writeText(c).then(()=>Uy(St,as(),"copied!")).catch(u=>console.error(u))}},100)},[r]),o=Km(!!n);return R1(!!n,0,i,s),fi(`${e} $purple$16 $yellowCOPYIT ${o}${t}`,s,!0),n&&Le.jsx($c,{OK_BUTTON:a})}function C0t({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useContext(obe),o=it.useCallback(()=>{const[c,...u]=r;setTimeout(()=>{a.sendmessage(c,u)},100)},[r,a]),l=Km(!!n);return R1(!!n,0,i,s),fi(`${e} $purple$16 ${l}${t}`,s,!0),n&&Le.jsx($c,{OK_BUTTON:o})}function M0t({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useCallback(()=>{const[,l,...c]=r,u=c.join(" ");setTimeout(()=>{const f=as();switch(l){case"wiki":ic(St,f,async()=>{const h=await dH(u);AH(f,h)});break;case"inline":window.location.href=u;break;default:window.open(`${l} ${u}`.trim(),"_blank");break}},100)},[r]),o=Km(!!n);return R1(!!n,0,i,s),fi(`${e} $purple$16 $yellowOPENIT ${o}${t}`,s,!0),n&&Le.jsx($c,{OK_BUTTON:a})}function O0t({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),{setviewimage:a}=Gc(),o=it.useCallback(()=>{const[,...c]=r,u=c.join(" ");setTimeout(()=>a(u),100)},[a,r]),l=Km(!!n);return R1(!!n,0,i,s),fi(`${e} $purple$16 $CYANVIEWIT ${l}${t}`,s,!0),n&&Le.jsx($c,{OK_BUTTON:o})}function pbe({active:n,text:e,y:t}){const r=Fh(),{quickterminal:i}=oo(),s=Z0(r),a=e.startsWith("!");R1(!!n,0,t,r),r.reset.bg=n?AG:yR(i),r.active.bottomedge=s.bottom;const o=kq(e);if(xe(o)){const l=s.width-3,u=Q1(o,l,3)?.measuredwidth??1,f=Li(Math.floor(l*.5-u*.5),0,l);fi(`${" ".repeat(f)}$WHITE${o}`,r,!0)}else fi(a?"":e,r,!0);if(a){const[l,...c]=e.slice(1).split("!"),u=`${c.join("!")}`;let f="PRESS ME";const h=[],g=Hk(u,!0);for(let v=0;v<g.tokens.length;v++){const x=g.tokens[v];switch(x.tokenType){case GU:f=x.image.slice(1);break;default:h.push(x.image);break}}const[p,..._]=h,y={active:n,prefix:l,label:f,words:_,y:t};switch(Vr(p)){case"copyit":return Le.jsx(A0t,{...y,words:h});case"openit":return Le.jsx(M0t,{...y,words:h});case"viewit":return Le.jsx(O0t,{...y,words:h});default:case"hyperlink":return Le.jsx(C0t,{...y,words:h});case"hk":case"hotkey":return null;case"rn":case"range":return null;case"sl":case"select":return null;case"nm":case"number":return null;case"tx":case"text":return null;case"zssedit":return null;case"charedit":return null;case"coloredit":return null}}return null}function k0t({active:n,text:e,y:t}){return Xg(),Le.jsx(pbe,{active:n,text:e,y:t})}function I0t(n,e,t){return n.startsWith("!")?1:Q1(n,e,t)?.y??1}function N0t(){const[n]=oo(Uh(f=>[f.editor.open])),e=oo(Uh(f=>f.terminal.logs)),t=Fh(),r=Jo(),i=Z0(t),s=t.width-1,a=e.map(f=>I0t(f,s,i.height)),o=i.bottom-i.top-(n?0:2);let l=o+1;const c=a.map(f=>(l-=f,l)),u=i.bottom-r.ycursor+r.scroll;return Le.jsx(Le.Fragment,{children:Le.jsx(Kk.Provider,{value:t,children:e.map((f,h)=>{const g=c[h]+r.scroll,p=a[h],_=g+p;return _<0||g<0||g>o?null:!n&&u>=g&&u<_?Le.jsx(k0t,{active:!0,text:f,y:g},h):Le.jsx(pbe,{text:f,y:g},h)})})})}function P0t(n,e,t){return n.startsWith("!")?1:Q1(n,e,t)?.y??1}function Ase(){const n=as(),{quickterminal:e}=oo(),[t]=oo(Uh(_=>[_.editor.open])),r=oo(Uh(_=>_.terminal.logs)),[i,s]=it.useState(!1);it.useLayoutEffect(()=>{ic(St,as(),async()=>{await OP("voice2text")==="on"&&s(!0)})},[]);const a=Fh(),o=Jo(),l=Z0(a),c=Zgt(a.width),u=a.width-c-1,f=r.map(_=>P0t(_,u,l.height)),h=l.bottom-l.top-(t?0:2);let g=0;f.forEach(_=>{g+=_}),++g;const p=l.bottom-o.ycursor+o.scroll;return it.useEffect(()=>{setTimeout(()=>{Jo.setState(_=>{const y=l.bottom-o.ycursor+o.scroll;let v=_.scroll;return y<5&&v++,y>l.bottom-10&&v--,v=Math.round(Li(v,0,g-h)),{scroll:v}})},16)},[h,l.bottom,g,o.scroll,o.ycursor]),Le.jsxs(Le.Fragment,{children:[Le.jsx(CG,{}),Le.jsxs(obe.Provider,{value:{sendmessage(_,y){const[v,x]=x0t(_);if(v==="self"){const E=`#${x} ${y.join(" ")}`;Av(St,n,E)}else St.emit(n,`${v}:${x}`,y)}},children:[Le.jsx(N0t,{}),!t&&Le.jsx(R0t,{quickterminal:e,voice2text:i,tapeycursor:p,logrowtotalheight:g})]})]})}function D0t(n,e,t,r,i){return{...i,x:n,y:e,reset:{...El(i.reset),topedge:e,leftedge:n,rightedge:t,bottomedge:r},active:{...El(i.active),topedge:e,leftedge:n,rightedge:t,bottomedge:r}}}function GN({quickterminal:n,top:e,width:t,height:r,children:i}){const s=yR(n),a=hx(t,r,0,c4,s),o=it.useMemo(()=>D0t(0,0,t-1,r-1,{...Tb(t,r,c4,s),...a.getState()}),[s,t,r,a]);return Le.jsxs(_x,{store:a,children:[Le.jsxs(Kk.Provider,{value:o,children:[Le.jsx(CG,{}),i]}),Le.jsx("group",{position:[0,e*Gn.DRAW_CHAR_HEIGHT(),0],children:Le.jsx(vx,{width:t,height:r})})]})}function L0t({quickterminal:n,top:e,width:t,height:r}){const[i,s]=oo(Uh(a=>[a.layout,a.editor.open]));if(s)switch(i){case O0.SPLIT_X:return Le.jsxs(it.Fragment,{children:[Le.jsx(GN,{quickterminal:n,top:e,width:Math.round(t*1.5),height:r,children:Le.jsx(Ase,{})}),Le.jsx(GN,{quickterminal:n,top:e,width:Jgt(t),height:r,children:Le.jsx(Rse,{})})]},"layout");default:return Le.jsx(GN,{quickterminal:n,top:e,width:t,height:r,children:Le.jsx(Rse,{})},"layout")}return Le.jsx(GN,{quickterminal:n,top:e,width:Math.round(t*1.5),height:r,children:Le.jsx(Ase,{})},"layout")}function U0t(){const n=kb(),[e,t,r,i]=oo(Uh(c=>[c.layout,c.quickterminal,c.terminal.open,c.editor.open]));let s=0,a=n.rows;switch(e){case O0.TOP:a=Math.floor(n.rows*.5);break;case O0.BOTTOM:a=Math.ceil(n.rows*.5),s=n.rows-a;break;default:case O0.FULL:break}if(n.cols<10||n.rows<10)return null;const o=as(),l=t||r||i;return Le.jsxs(Le.Fragment,{children:[l&&Le.jsx(_G,{width:n.cols,height:n.rows,top:s,left:0,right:n.cols-1,bottom:s+a-1,alpha:t?.666:.333}),l?Le.jsx(sS,{blockhotkeys:!0,children:Le.jsx(L0t,{quickterminal:t,top:s,width:n.cols,height:a})}):Le.jsx(VT,{hotkey:"Shift+?",althotkey:"/",children:()=>W3e(St,o)})]})}const B0t=`
// CRT Emulation
// by Mattias

vec3 sample_(sampler2D tex, vec2 tc) {
	vec3 s = pow(texture2D(tex, tc).rgb, vec3(2.0));
	return s;
}

vec3 blur(sampler2D tex, vec2 tc, float offs) {
	vec4 xoffs = offs * vec4(-2.0, -1.0, 1.0, 2.0) * texelSize.x * 0.01;
	vec4 yoffs = offs * vec4(-2.0, -1.0, 1.0, 2.0) * texelSize.y * 0.001;
	
	vec3 color = vec3(0.0, 0.0, 0.0);
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.x)) * 0.00366;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.x)) * 0.01465;
	color += sample_(tex, tc + vec2(    0.0, yoffs.x)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.x)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.x)) * 0.00366;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.y)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.y)) * 0.05861;
	color += sample_(tex, tc + vec2(    0.0, yoffs.y)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.y)) * 0.05861;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.y)) * 0.01465;
	
	color += sample_(tex, tc + vec2(xoffs.x, 0.0)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.y, 0.0)) * 0.09524;
	color += sample_(tex, tc + vec2(    0.0, 0.0)) * 0.15018;
	color += sample_(tex, tc + vec2(xoffs.z, 0.0)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.w, 0.0)) * 0.02564;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.z)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.z)) * 0.05861;
	color += sample_(tex, tc + vec2(    0.0, yoffs.z)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.z)) * 0.05861;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.z)) * 0.01465;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.w)) * 0.00366;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.w)) * 0.01465;
	color += sample_(tex, tc + vec2(    0.0, yoffs.w)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.w)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.w)) * 0.00366;

	return color;
}

float rand(vec2 co) {
  float a = 12.9898;
  float b = 78.233;
  float c = 43758.5453;
  float dt = dot(co.xy, vec2(a, b));
  float sn = mod(dt, 3.14);
  return fract(sin(sn) * c);
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
  vec3 col;  
  col.r = 1.0 * blur(inputBuffer, vec2(uv.x + 0.0009, uv.y + 0.0009), 1.2).x + 0.005;
  col.g = 1.0 * blur(inputBuffer, vec2(uv.x + 0.000, uv.y - 0.0015), 1.2).y + 0.005;
  col.b = 1.0 * blur(inputBuffer, vec2(uv.x - 0.0015, uv.y + 0.000), 1.2).z + 0.005;  

  col.r += 0.2 * blur(inputBuffer, vec2(uv.x + 0.0009, uv.y + 0.0009), 2.25).x - 0.005;
  col.g += 0.2 * blur(inputBuffer, vec2(uv.x + 0.000, uv.y - 0.0015), 1.75).y - 0.005;
  col.b += 0.2 * blur(inputBuffer, vec2(uv.x - 0.0015, uv.y + 0.000), 1.25).z - 0.005;
  
  float ghs = 0.05;
	float gphase = 0.371 * sin(time * 0.1);
	col.r += ghs * (1.0 - 0.299) * blur(inputBuffer, gphase * vec2(0.01, -0.027) + vec2(uv.x + 0.001, uv.y + 0.001), 7.0).x;
  col.g += ghs * (1.0 - 0.587) * blur(inputBuffer, gphase * vec2(-0.022, -0.02) + vec2(uv.x + 0.000, uv.y - 0.002), 5.0).y;
  col.b += ghs * (1.0 - 0.114) * blur(inputBuffer, gphase * vec2(-0.02, -0.0) + vec2(uv.x - 0.002, uv.y + 0.000), 3.0).z;

  col = clamp(col * 0.4 + 0.6 * col * 1.0, 0.0, 1.0);
	col = mix(col, col * col * col * col * col * col, 0.5) * 3.8;

	float scans = clamp(0.35 + 0.15 * sin(3.5 * (time * 0.125) + uv.y * resolution.y * 1.5), 0.0, 1.0);
	float s = pow(scans, 0.999);
	col = col * vec3(s);

  col *= 1.0 + 0.0015 * sin(500.0 * time);
  col *= 1.0 - 0.15 * vec3(clamp((mod(uv.x * texelSize.x, 2.0) - 1.0) * 2.0, 0.0, 1.0));
	
  col *= vec3(1.0) - 0.25 * vec3(
   rand(uv + 0.0001 * time), 
   rand(uv + 0.0001 * time + 0.3), 
   rand(uv + 0.0001 * time + 0.5));
	col = pow(col, vec3(0.45));

  outputColor = vec4(col.rgb, 1.0);
}
`;class F0t extends B_{constructor(){super("ScanlinesEffect",B0t,{blendFunction:xs.NORMAL,attributes:Um.CONVOLUTION,defines:new Map([]),uniforms:new Map([])})}update(){}}const z0t=w3(F0t),Cse=n=>(n.getAttributes()&Um.CONVOLUTION)===Um.CONVOLUTION,j0t=it.memo(it.forwardRef(({children:n,width:e,height:t},r)=>{const{gl:i,scene:s,camera:a}=Nm(),[o]=it.useMemo(()=>{const u=new Nye(i,{depthBuffer:!0,stencilBuffer:!1,multisampling:0,frameBufferType:vb});return u.addPass(new Dye(s,a)),[u]},[a,i,s]);Wg((u,f)=>{const h=i.autoClear;i.autoClear=!0,o.setSize(e,t),o.render(f),i.autoClear=h},2);const l=it.useRef(null);it.useLayoutEffect(()=>{const u=[],f=l.current.__r3f;if(f&&o){const h=f.children;for(let g=0;g<h.length;g++){const p=h[g].object;if(p instanceof B_){const _=[p];if(!Cse(p)){let v=null;for(;(v=h[g+1]?.object)instanceof B_&&!Cse(v);)_.push(v),g++}const y=new Lye(a,..._);u.push(y)}else p instanceof Xm&&u.push(p)}for(const g of u)o?.addPass(g)}return()=>{for(const h of u)o?.removePass(h)}},[o,n,a]);const c=it.useMemo(()=>({composer:o,normalPass:null,downSamplingPass:null,resolutionScale:void 0,camera:a,scene:s}),[o,a,s]);return it.useImperativeHandle(r,()=>o,[o]),Le.jsx(hG.Provider,{value:c,children:Le.jsx("group",{ref:l,children:n})})}));function H0t({context:n}){return Le.jsx("group",{position:[0,0,999],children:Le.jsx(vx,{width:n.width,height:n.height})})}function q0t(){const{toast:n}=oo(),e=kb(),t=hx(e.cols,1,0,bn.GREEN,bn.ONCLEAR),r={...Tb(e.cols,1,bn.GREEN,bn.ONCLEAR,0,0,e.cols-1,1),...t.getState()};if(e.cols<10||e.rows<10)return null;const i=e.cols-1;return Le.jsx(_x,{store:t,children:n&&Le.jsxs(Le.Fragment,{children:[Le.jsx(EG,{margin:1,color:bn.YELLOW,y:0,leftedge:0,rightedge:i,line:n,context:r}),Le.jsx("group",{position:[0,0,998],children:Le.jsx(_G,{alpha:.4,width:e.cols,height:10,top:0,left:0,right:i,bottom:0})}),Le.jsx(H0t,{context:r})]})})}function V0t({url:n,drawwidth:e,drawheight:t}){const r=zj(vle,n);it.useEffect(()=>{r.flipY=!0,D0e(r)},[r]);const{width:i=1,height:s=1}=r?.image??{},a=Math.min(e/i,t/s),o=i*a,l=s*a;return Le.jsxs("mesh",{children:[Le.jsx("planeGeometry",{args:[o,l]}),Le.jsx("meshBasicMaterial",{map:r})]})}function G0t(){const n=kb(),{viewimage:e,setviewimage:t}=Gc();if(n.cols<10||n.rows<10)return null;const r=n.cols-1,i=n.rows-1,s=(n.cols-4)*Gn.DRAW_CHAR_WIDTH(),a=(n.rows-2)*Gn.DRAW_CHAR_HEIGHT(),o=n.cols*Gn.DRAW_CHAR_WIDTH()*.5,l=n.rows*Gn.DRAW_CHAR_HEIGHT()*.5;return e&&Le.jsxs(sS,{children:[Le.jsx($c,{CANCEL_BUTTON:()=>t("")}),Le.jsxs("group",{position:[0,0,998],children:[Le.jsx(_G,{alpha:.4,width:n.cols,height:n.rows,top:0,left:0,right:r,bottom:i}),Le.jsx("group",{position:[o,l,1],"scale-x":-1,"rotation-z":Math.PI,children:Le.jsx(it.Suspense,{fallback:null,children:Le.jsx(V0t,{url:e,drawwidth:s,drawheight:a})})})]})]})}var QM={},e2={},t2={},Mse;function $0t(){if(Mse)return t2;Mse=1,Object.defineProperty(t2,"__esModule",{value:!0}),t2.Slice=void 0;let n=class{constructor(t,r,i,s){this.uint8=t,this.view=r,this.start=i,this.end=s}subarray(){return this.uint8.subarray(this.start,this.end)}};return t2.Slice=n,t2}var Ose;function W0t(){if(Ose)return e2;Ose=1,Object.defineProperty(e2,"__esModule",{value:!0}),e2.Writer=void 0;const n=$0t(),e=new Uint8Array([]),t=new DataView(e.buffer),r=typeof Bl=="function",i=r?Bl.prototype.utf8Write:null,s=r?Bl.from:null,a=typeof TextEncoder<"u"?new TextEncoder:null;let o=class{constructor(c=64*1024){this.allocSize=c,this.view=t,this.x0=0,this.x=0,this.uint8=new Uint8Array(c),this.size=c,this.view=new DataView(this.uint8.buffer)}grow(c){const u=this.x0,f=this.x,h=this.uint8,g=new Uint8Array(c),p=new DataView(g.buffer),_=h.subarray(u,f);g.set(_,0),this.x=f-u,this.x0=0,this.uint8=g,this.size=c,this.view=p}ensureCapacity(c){const u=this.size,f=u-this.x;if(f<c){const h=u-this.x0,g=c-f,p=h+g;this.grow(p<=this.allocSize?this.allocSize:p*2)}}move(c){this.ensureCapacity(c),this.x+=c}reset(){this.x0=this.x}newBuffer(c){const u=this.uint8=new Uint8Array(c);this.size=c,this.view=new DataView(u.buffer),this.x=this.x0=0}flush(){const c=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,c}flushSlice(){const c=new n.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,c}u8(c){this.ensureCapacity(1),this.uint8[this.x++]=c}u16(c){this.ensureCapacity(2),this.view.setUint16(this.x,c),this.x+=2}u32(c){this.ensureCapacity(4),this.view.setUint32(this.x,c),this.x+=4}i32(c){this.ensureCapacity(4),this.view.setInt32(this.x,c),this.x+=4}u64(c){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(c)),this.x+=8}f64(c){this.ensureCapacity(8),this.view.setFloat64(this.x,c),this.x+=8}u8u16(c,u){this.ensureCapacity(3);let f=this.x;this.uint8[f++]=c,this.uint8[f++]=u>>>8,this.uint8[f++]=u&255,this.x=f}u8u32(c,u){this.ensureCapacity(5);let f=this.x;this.uint8[f++]=c,this.view.setUint32(f,u),this.x=f+4}u8u64(c,u){this.ensureCapacity(9);let f=this.x;this.uint8[f++]=c,this.view.setBigUint64(f,BigInt(u)),this.x=f+8}u8f32(c,u){this.ensureCapacity(5);let f=this.x;this.uint8[f++]=c,this.view.setFloat32(f,u),this.x=f+4}u8f64(c,u){this.ensureCapacity(9);let f=this.x;this.uint8[f++]=c,this.view.setFloat64(f,u),this.x=f+8}buf(c,u){this.ensureCapacity(u);const f=this.x;this.uint8.set(c,f),this.x=f+u}utf8(c){const u=c.length*4;if(u<168)return this.utf8Native(c);if(i){const f=i.call(this.uint8,c,this.x,u);return this.x+=f,f}else if(s){const f=this.uint8,h=f.byteOffset+this.x,p=s(f.buffer).subarray(h,h+u).write(c,0,u,"utf8");return this.x+=p,p}else if(u>1024&&a){const f=a.encodeInto(c,this.uint8.subarray(this.x,this.x+u)).written;return this.x+=f,f}return this.utf8Native(c)}utf8Native(c){const u=c.length,f=this.uint8;let h=this.x,g=0;for(;g<u;){let _=c.charCodeAt(g++);if((_&4294967168)===0){f[h++]=_;continue}else if((_&4294965248)===0)f[h++]=_>>6&31|192;else{if(_>=55296&&_<=56319&&g<u){const y=c.charCodeAt(g);(y&64512)===56320&&(g++,_=((_&1023)<<10)+(y&1023)+65536)}(_&4294901760)===0?(f[h++]=_>>12&15|224,f[h++]=_>>6&63|128):(f[h++]=_>>18&7|240,f[h++]=_>>12&63|128,f[h++]=_>>6&63|128)}f[h++]=_&63|128}const p=h-this.x;return this.x=h,p}ascii(c){const u=c.length;this.ensureCapacity(u);const f=this.uint8;let h=this.x,g=0;for(;g<u;)f[h++]=c.charCodeAt(g++);this.x=h}};return e2.Writer=o,e2}var kse;function Y0t(){if(kse)return QM;kse=1,Object.defineProperty(QM,"__esModule",{value:!0}),QM.MsgPackEncoderFast=void 0;const n=W0t();let e=class{constructor(r=new n.Writer){this.writer=r}encode(r){return this.writer.reset(),this.writeAny(r),this.writer.flush()}encodeAny(r){this.writeAny(r)}writeAny(r){switch(r){case null:return this.writer.u8(192);case!1:return this.writer.u8(194);case!0:return this.writer.u8(195)}if(r instanceof Array)return this.writeArr(r);switch(typeof r){case"number":return this.writeNumber(r);case"string":return this.writeStr(r);case"object":return this.writeObj(r)}}encodeFloat64(r){this.writeFloat(r)}writeNull(){return this.writer.u8(192)}writeFloat(r){this.writer.u8f64(203,r)}u32(r){const i=this.writer;this.writer.ensureCapacity(5);const s=i.uint8;r<=127?s[i.x++]=r:r<=65535?(s[i.x++]=205,i.view.setUint16(i.x,r),i.x+=2):r<=4294967295?(s[i.x++]=206,i.view.setUint32(i.x,r),i.x+=4):this.writeFloat(r)}n32(r){const i=this.writer;this.writer.ensureCapacity(5);const s=i.uint8;r>=-32?s[i.x++]=256+r:r>=-32768?(s[i.x++]=209,i.view.setInt16(i.x,r),i.x+=2):r>=-2147483648?(s[i.x++]=210,i.view.setInt32(i.x,r),i.x+=4):this.writeFloat(r)}encodeNumber(r){this.writeNumber(r)}writeNumber(r){if(r>>>0===r)return this.u32(r);if(r>>0===r)return this.n32(r);this.writeFloat(r)}writeInteger(r){if(r>=0){if(r<=4294967295)return this.u32(r);if(r>-2147483648)return this.n32(r)}this.writeFloat(r)}writeUInteger(r){if(r<=4294967295)return this.u32(r);this.writeFloat(r)}encodeNull(){this.writer.u8(192)}encodeTrue(){this.writer.u8(195)}encodeFalse(){this.writer.u8(194)}encodeBoolean(r){this.writeBoolean(r)}writeBoolean(r){r?this.writer.u8(195):this.writer.u8(194)}encodeStringHeader(r){this.writeStrHdr(r)}writeStrHdr(r){r<=31?this.writer.u8(160|r):r<=255?this.writer.u16(55552+r):r<=65535?this.writer.u8u16(218,r):this.writer.u8u32(219,r)}encodeString(r){this.writeStr(r)}writeStr(r){const i=this.writer,a=r.length*4;i.ensureCapacity(5+a);const o=i.uint8;let l=i.x;a<=31?i.x++:a<=255?(o[i.x++]=217,l=i.x,i.x++):a<=65535?(o[i.x++]=218,l=i.x,i.x+=2):(o[i.x++]=219,l=i.x,i.x+=4);const c=this.writer.utf8(r);a<=31?o[l]=160|c:a<=255?o[l]=c:a<=65535?i.view.setUint16(l,c):i.view.setUint32(l,c)}encodeAsciiString(r){this.writeAsciiStr(r)}writeAsciiStr(r){this.writeStrHdr(r.length),this.writer.ascii(r)}encodeArrayHeader(r){this.writeArrHdr(r)}encodeArray(r){this.writeArr(r)}writeArrHdr(r){r<=15?this.writer.u8(144|r):r<=65535?this.writer.u8u16(220,r):r<=4294967295&&this.writer.u8u32(221,r)}writeArr(r){const i=r.length;i<=15?this.writer.u8(144|i):i<=65535?this.writer.u8u16(220,i):i<=4294967295&&this.writer.u8u32(221,i);for(let s=0;s<i;s++)this.writeAny(r[s])}encodeObjectHeader(r){this.writeObjHdr(r)}encodeObject(r){this.writeObj(r)}writeObjHdr(r){r<=15?this.writer.u8(128|r):r<=65535?this.writer.u8u16(222,r):r<=4294967295&&this.writer.u8u32(223,r)}writeObj(r){const i=Object.keys(r),s=i.length;this.writeObjHdr(s);for(let a=0;a<s;a++){const o=i[a];this.writeStr(o),this.writeAny(r[o])}}encodeExtHeader(r,i){switch(i){case 1:this.writer.u16(54272|r);break;case 2:this.writer.u16(54528|r);break;case 4:this.writer.u16(54784|r);break;case 8:this.writer.u16(55040|r);break;case 16:this.writer.u16(55296|r);break;default:i<=255?(this.writer.u16(50944|i),this.writer.u8(r)):i<=65535?(this.writer.u8u16(200,i),this.writer.u8(r)):i<=4294967295&&(this.writer.u8u32(201,i),this.writer.u8(r))}}encodeExt(r){const{tag:i,val:s}=r,a=s.length;this.encodeExtHeader(i,a),this.writer.buf(s,a)}encodeBinaryHeader(r){this.writeBinHdr(r)}encodeBinary(r){this.writeBin(r)}writeBinHdr(r){r<=255?this.writer.u16(50176|r):r<=65535?this.writer.u8u16(197,r):r<=4294967295&&this.writer.u8u32(198,r)}writeBin(r){const i=r.length;this.writeBinHdr(i),this.writer.buf(r,i)}};return QM.MsgPackEncoderFast=e,QM}Y0t();var Kn;(function(n){n[n.add=0]="add",n[n.remove=1]="remove",n[n.replace=2]="replace",n[n.copy=3]="copy",n[n.move=4]="move",n[n.test=5]="test",n[n.str_ins=6]="str_ins",n[n.str_del=7]="str_del",n[n.flip=8]="flip",n[n.inc=9]="inc",n[n.split=10]="split",n[n.merge=11]="merge",n[n.extend=12]="extend",n[n.contains=30]="contains",n[n.defined=31]="defined",n[n.ends=32]="ends",n[n.in=33]="in",n[n.less=34]="less",n[n.matches=35]="matches",n[n.more=36]="more",n[n.starts=37]="starts",n[n.undefined=38]="undefined",n[n.test_type=39]="test_type",n[n.test_string=40]="test_string",n[n.test_string_len=41]="test_string_len",n[n.type=42]="type",n[n.and=43]="and",n[n.not=44]="not",n[n.or=45]="or"})(Kn||(Kn={}));class Kg{path;from;constructor(e){this.path=e}}var e7={};const Sx=Pae(Uot);var t7={},Ise;function X0t(){return Ise||(Ise=1,Object.defineProperty(t7,"__esModule",{value:!0})),t7}var n7={},Nse;function mbe(){return Nse||(Nse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isInteger=n.isRoot=n.toPath=void 0,n.unescapeComponent=s,n.escapeComponent=a,n.parseJsonPointer=o,n.formatJsonPointer=l,n.isChild=u,n.isPathEqual=f,n.parent=g,n.isValidIndex=p;const e=/~1/g,t=/~0/g,r=/~/g,i=/\//g;function s(y){return y.indexOf("~")===-1?y:y.replace(e,"/").replace(t,"~")}function a(y){return y.indexOf("/")===-1&&y.indexOf("~")===-1?y:y.replace(r,"~0").replace(i,"~1")}function o(y){return y?y.slice(1).split("/").map(s):[]}function l(y){return(0,n.isRoot)(y)?"":"/"+y.map(v=>a(String(v))).join("/")}const c=y=>typeof y=="string"?o(y):y;n.toPath=c;function u(y,v){if(y.length>=v.length)return!1;for(let x=0;x<y.length;x++)if(y[x]!==v[x])return!1;return!0}function f(y,v){if(y.length!==v.length)return!1;for(let x=0;x<y.length;x++)if(y[x]!==v[x])return!1;return!0}const h=y=>!y.length;n.isRoot=h;function g(y){if(y.length<1)throw new Error("NO_PARENT");return y.slice(0,y.length-1)}function p(y){if(typeof y=="number")return!0;const v=Number.parseInt(y,10);return String(v)===y&&v>=0}const _=y=>{const v=y.length;let x=0,E;for(;x<v;){if(E=y.charCodeAt(x),E>=48&&E<=57){x++;continue}return!1}return!0};n.isInteger=_})(n7)),n7}var r7={},Pse;function K0t(){return Pse||(Pse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.validatePath=n.validateJsonPointer=void 0;const e=i=>{if(typeof i=="string"){if(i){if(i[0]!=="/")throw new Error("POINTER_INVALID");if(i.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,n.validatePath)(i)};n.validateJsonPointer=e;const{isArray:t}=Array,r=i=>{if(!t(i))throw new Error("Invalid path.");if(i.length>256)throw new Error("Path too long.");for(const s of i)switch(typeof s){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};n.validatePath=r})(r7)),r7}var n2={},r2={},Dse;function MG(){if(Dse)return r2;Dse=1,Object.defineProperty(r2,"__esModule",{value:!0}),r2.hasOwnProperty=void 0;const n=Object.prototype.hasOwnProperty;function e(t,r){return n.call(t,r)}return r2.hasOwnProperty=e,r2}var Lse;function Z0t(){if(Lse)return n2;Lse=1,Object.defineProperty(n2,"__esModule",{value:!0}),n2.get=void 0;const n=MG(),e=(t,r)=>{const i=r.length;let s;if(!i)return t;for(let a=0;a<i;a++)if(s=r[a],t instanceof Array){if(typeof s!="number"){if(s==="-")return;const o=~~s;if(""+o!==s)return;s=o}t=t[s]}else if(typeof t=="object"){if(!t||!(0,n.hasOwnProperty)(t,s))return;t=t[s]}else return;return t};return n2.get=e,n2}var __={},Use;function J0t(){if(Use)return __;Use=1,Object.defineProperty(__,"__esModule",{value:!0}),__.isObjectReference=__.isArrayEnd=__.isArrayReference=__.find=void 0;const n=MG(),{isArray:e}=Array,t=(a,o)=>{const l=o.length;if(!l)return{val:a};let c,u;for(let h=0;h<l;h++)if(c=a,u=o[h],e(c)){const g=c.length;if(u==="-")u=g;else if(typeof u=="string"){const p=~~u;if(""+p!==u)throw new Error("INVALID_INDEX");if(u=p,u<0)throw new Error("INVALID_INDEX")}a=c[u]}else if(typeof c=="object"&&c)a=(0,n.hasOwnProperty)(c,u)?c[u]:void 0;else throw new Error("NOT_FOUND");return{val:a,obj:c,key:u}};__.find=t;const r=a=>e(a.obj)&&typeof a.key=="number";__.isArrayReference=r;const i=a=>a.obj.length===a.key;__.isArrayEnd=i;const s=a=>typeof a.obj=="object"&&typeof a.key=="string";return __.isObjectReference=s,__}var i7={},i2={},Bse;function Q0t(){if(Bse)return i2;Bse=1,Object.defineProperty(i2,"__esModule",{value:!0}),i2.findByPointer=void 0;const n=MG(),e=mbe(),{isArray:t}=Array,r=(i,s)=>{if(!i)return{val:s};let a,o,l=0,c=1;for(;l>-1;)if(l=i.indexOf("/",c),o=l>-1?i.substring(c,l):i.substring(c),c=l+1,a=s,t(a)){const u=a.length;if(o==="-")o=u;else{const f=~~o;if(""+f!==o)throw new Error("INVALID_INDEX");if(o=f,o<0)throw"INVALID_INDEX"}s=a[o]}else if(typeof a=="object"&&a)o=(0,e.unescapeComponent)(o),s=(0,n.hasOwnProperty)(a,o)?a[o]:void 0;else throw"NOT_FOUND";return{val:s,obj:a,key:o}};return i2.findByPointer=r,i2}var Fse;function e_t(){return Fse||(Fse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Sx.__exportStar(Q0t(),n)})(i7)),i7}var zse;function t_t(){return zse||(zse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Sx;e.__exportStar(X0t(),n),e.__exportStar(mbe(),n),e.__exportStar(K0t(),n),e.__exportStar(Z0t(),n),e.__exportStar(J0t(),n),e.__exportStar(e_t(),n)})(e7)),e7}var Rr=t_t(),s7={},jse;function n_t(){return jse||(jse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0;const{isArray:e}=Array,t=Object.keys,r=i=>{if(!i)return i;if(e(i)){const s=[],a=i.length;for(let o=0;o<a;o++)s.push((0,n.clone)(i[o]));return s}else if(typeof i=="object"){const s=t(i),a=s.length,o={};for(let l=0;l<a;l++){const c=s[l];o[c]=(0,n.clone)(i[c])}return o}return i};n.clone=r})(s7)),s7}var OG=n_t();class kG extends Kg{value;constructor(e,t){super(e),this.value=t}op(){return"add"}code(){return Kn.add}apply(e){const{val:t,key:r,obj:i}=Rr.find(e,this.path),s=OG.clone(this.value);if(!i)e=s;else if(typeof r=="string")i[r]=s;else{const a=i.length;if(r<a)i.splice(r,0,s);else{if(r>a)throw new Error("INVALID_INDEX");i.push(s)}}return{doc:e,old:t}}toJson(e){return{op:"add",path:Rr.formatJsonPointer(this.path),value:this.value}}toCompact(e,t){return[t?"add":Kn.add,this.path,this.value]}}class gbe extends Kg{oldValue;constructor(e,t){super(e),this.oldValue=t}op(){return"remove"}code(){return Kn.remove}apply(e){const t=Rr.find(e,this.path);if(t.val===void 0)throw new Error("NOT_FOUND");return Rr.isObjectReference(t)?delete t.obj[t.key]:Rr.isArrayReference(t)?t.val!==void 0&&t.obj.splice(t.key,1):e=null,{doc:e,old:t.val}}toJson(e){const t={op:"remove",path:Rr.formatJsonPointer(this.path)};return this.oldValue!==void 0&&(t.oldValue=this.oldValue),t}toCompact(e,t){const r=t?"remove":Kn.remove;return this.oldValue===void 0?[r,this.path]:[r,this.path,this.oldValue]}}class r_t extends Kg{value;oldValue;constructor(e,t,r){super(e),this.value=t,this.oldValue=r}op(){return"replace"}code(){return Kn.replace}apply(e){const t=Rr.find(e,this.path);if(t.val===void 0)throw new Error("NOT_FOUND");const r=OG.clone(this.value);return Rr.isObjectReference(t)||Rr.isArrayReference(t)?t.obj[t.key]=r:e=r,{doc:e,old:t.val}}toJson(e){const t={op:"replace",path:Rr.formatJsonPointer(this.path),value:this.value};return this.oldValue!==void 0&&(t.oldValue=this.oldValue),t}toCompact(e,t){const r=t?"replace":Kn.replace;return this.oldValue===void 0?[r,this.path,this.value]:[r,this.path,this.value,this.oldValue]}}class i_t extends Kg{from;constructor(e,t){super(e),this.from=t}op(){return"move"}code(){return Kn.move}apply(e){const t=new gbe(Rr.toPath(this.from),void 0).apply(e);return new kG(this.path,t.old).apply(t.doc)}toJson(e){return{op:"move",path:Rr.formatJsonPointer(this.path),from:Rr.formatJsonPointer(this.from)}}toCompact(e,t){return[t?"move":Kn.move,this.path,this.from]}}class s_t extends Kg{from;constructor(e,t){super(e),this.from=t}op(){return"copy"}code(){return Kn.copy}apply(e){const{val:t}=Rr.find(e,this.from);if(t===void 0)throw new Error("NOT_FOUND");return new kG(this.path,OG.clone(t)).apply(e)}toJson(e){return{op:"copy",path:Rr.formatJsonPointer(this.path),from:Rr.formatJsonPointer(this.from)}}toCompact(e,t){return[t?"copy":Kn.copy,this.path,this.from]}}class $p extends Kg{apply(e){if(!this.test(e))throw new Error("TEST");return{doc:e}}}var a7={},o7={},Hse;function a_t(){return Hse||(Hse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.deepEqual=void 0;const e=Array.isArray,t=Object.prototype,r=(i,s)=>{if(i===s)return!0;let a=0,o=0;if(e(i)){if(!e(s)||(a=i.length,a!==s.length))return!1;for(o=a;o--!==0;)if(!(0,n.deepEqual)(i[o],s[o]))return!1;return!0}if(i&&s&&typeof i=="object"&&typeof s=="object"){e:{if(i.__proto__===t)break e;if(i instanceof Uint8Array){if(!(s instanceof Uint8Array))return!1;const c=i.length;if(c!==s.length)return!1;for(let u=0;u<c;u++)if(i[u]!==s[u])return!1;return!0}}const l=Object.keys(i);if(a=l.length,a!==Object.keys(s).length||e(s))return!1;for(o=a;o--!==0;){const c=l[o];if(!(0,n.deepEqual)(i[c],s[c]))return!1}return!0}return!1};n.deepEqual=r})(o7)),o7}var qse;function o_t(){return qse||(qse=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Sx.__exportStar(a_t(),n)})(a7)),a7}var _be=o_t();class l_t extends $p{value;not;constructor(e,t,r){super(e),this.value=t,this.not=r}op(){return"test"}code(){return Kn.test}test(e){const{val:t}=Rr.find(e,this.path);if(t===void 0)return!!this.not;const r=_be.deepEqual(t,this.value);return this.not?!r:r}toJson(e){const t={op:"test",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value};return this.not&&(t.not=this.not),t}toCompact(e,t){const r=e?this.path.slice(e.path.length):this.path,i=t?"test":Kn.test;return this.not?[i,r,this.value,1]:[i,r,this.value]}}class c_t extends Kg{op(){return"flip"}code(){return Kn.flip}apply(e){const t=Rr.find(e,this.path);return t.obj?t.obj[t.key]=!t.val:e=!t.val,{doc:e,old:t.val}}toJson(e){return{op:"flip",path:Rr.formatJsonPointer(this.path)}}toCompact(e,t){return[t?"flip":Kn.flip,this.path]}}class u_t extends Kg{inc;constructor(e,t){super(e),this.inc=t}op(){return"inc"}code(){return Kn.inc}apply(e){const t=Rr.find(e,this.path),r=this.inc+Number(t.val);return t.obj?t.obj[t.key]=r:e=r,{doc:e,old:t.val}}toJson(e){return{op:"inc",path:Rr.formatJsonPointer(this.path),inc:this.inc}}toCompact(e,t){return[t?"inc":Kn.inc,this.path,this.inc]}}class f_t extends Kg{pos;str;constructor(e,t,r){super(e),this.pos=t,this.str=r}op(){return"str_ins"}code(){return Kn.str_ins}apply(e){const{val:t,key:r,obj:i}=Rr.find(e,this.path);if(typeof t!="string"){if(t!==void 0)throw new Error("NOT_A_STRING");if(this.pos!==0)throw new Error("POS")}const s=typeof t=="string"?t:"",a=Math.min(this.pos,s.length),o=s.slice(0,a),l=s.slice(a),c=o+this.str+l;return i?i[r]=c:e=c,{doc:e,old:t}}toJson(e){return{op:"str_ins",path:Rr.formatJsonPointer(this.path),pos:this.pos,str:this.str}}toCompact(e,t){return[t?"str_ins":Kn.str_ins,this.path,this.pos,this.str]}}class Vse extends Kg{pos;str;len;constructor(e,t,r,i){super(e),this.pos=t,this.str=r,this.len=i}op(){return"str_del"}code(){return Kn.str_del}deleteLength(){return typeof this.str=="string"?this.str.length:this.len}apply(e){const{val:t,key:r,obj:i}=Rr.find(e,this.path);if(typeof t!="string")throw new Error("NOT_A_STRING");const s=t.length,a=Math.min(this.pos,t.length),o=Math.min(a,s),l=this.str!==void 0?this.str.length:this.len,c=Math.min(a+l,s),u=t.slice(0,o),f=t.substr(c),h=u+f;return i?i[r]=h:e=h,{doc:e,old:t}}toJson(e){return typeof this.str=="string"?{op:"str_del",path:Rr.formatJsonPointer(this.path),pos:this.pos,str:this.str}:{op:"str_del",path:Rr.formatJsonPointer(this.path),pos:this.pos,len:this.len}}toCompact(e,t){const r=t?"str_del":Kn.str_del;return typeof this.str=="string"?[r,this.path,this.pos,this.str]:[r,this.path,this.pos,0,this.len]}}const{isArray:h_t}=Array,Lz=n=>!!n&&typeof n=="object"&&typeof n.text=="string",Uz=n=>!!n&&typeof n=="object"&&h_t(n.children),d_t=(n,e)=>{const t=new RegExp(n,e?"i":void 0);return r=>t.test(r)};class p_t extends Kg{pos;props;constructor(e,t,r){super(e),this.pos=t,this.props=r}op(){return"split"}code(){return Kn.split}apply(e){const t=Rr.find(e,this.path);if(t.val===void 0)throw new Error("NOT_FOUND");const r=this.split(t.val);return Rr.isObjectReference(t)?t.obj[t.key]=r:Rr.isArrayReference(t)?(t.obj[t.key]=r[0],t.obj.splice(t.key+1,0,r[1])):e=r,{doc:e,old:t.val}}split(e){if(typeof e=="string"){const{pos:t,props:r}=this,i=e.slice(0,t),s=e.slice(t);return r?[{...r,text:i},{...r,text:s}]:[i,s]}else if(Lz(e)){const{pos:t,props:r}=this,i=e.text.slice(0,t),s=e.text.slice(t);return[{...e,...r,text:i},{...e,...r,text:s}]}else if(Uz(e)){const{pos:t,props:r}=this,i=e.children.slice(0,t),s=e.children.slice(t);return[{...e,...r,children:i},{...e,...r,children:s}]}else if(typeof e=="number"){const{pos:t}=this;return[t,e-t]}else return[e,e]}toJson(e){const t={op:"split",path:Rr.formatJsonPointer(this.path),pos:this.pos};return this.props&&(t.props=this.props),t}toCompact(e,t){const r=t?"split":Kn.split;return this.props?[r,this.path,this.pos,this.props]:[r,this.path,this.pos]}}class m_t extends Kg{pos;props;constructor(e,t,r){super(e),this.pos=t,this.props=r}op(){return"merge"}code(){return Kn.merge}apply(e){const t=Rr.find(e,this.path);if(!Rr.isArrayReference(t))throw new Error("INVALID_TARGET");if(t.key<=0)throw new Error("INVALID_KEY");const r=t.obj[t.key-1],i=t.obj[t.key],s=this.merge(r,i);return t.obj[t.key-1]=s,t.obj.splice(t.key,1),{doc:e,old:[r,i]}}merge(e,t){return typeof e=="string"&&typeof t=="string"||typeof e=="number"&&typeof t=="number"?e+t:Lz(e)&&Lz(t)?{...e,...t,text:e.text+t.text}:Uz(e)&&Uz(t)?{...e,...t,children:[...e.children,...t.children]}:[e,t]}toJson(e){const t={op:"merge",path:Rr.formatJsonPointer(this.path),pos:this.pos};return this.props&&(t.props=this.props),t}toCompact(e,t){const r=t?"merge":Kn.merge;return this.props?[r,this.path,this.pos,this.props]:[r,this.path,this.pos]}}const{isArray:g_t}=Array;class __t extends Kg{props;deleteNull;constructor(e,t,r){super(e),this.props=t,this.deleteNull=r}op(){return"extend"}code(){return Kn.extend}apply(e){const t=Rr.find(e,this.path);return Rr.isArrayReference(t)?t.val!==void 0&&(t.obj[t.key]=this.extend(t.val)):Rr.isObjectReference(t)?t.obj[t.key]=this.extend(t.val):e=this.extend(e),{doc:e}}extend(e){if(g_t(e)||typeof e!="object"||!e)return e;for(const[t,r]of Object.entries(this.props)){if(t==="__proto__")throw new Error("NO_PROTO");if(r===null&&this.deleteNull){delete e[t];continue}e[t]=r}return e}toJson(e){const t={op:"extend",path:Rr.formatJsonPointer(this.path),props:this.props};return this.deleteNull&&(t.deleteNull=this.deleteNull),t}toCompact(e,t){const r=t?"extend":Kn.extend;return this.deleteNull?[r,this.path,this.props,1]:[r,this.path,this.props]}}class v_t extends $p{op(){return"defined"}code(){return Kn.defined}test(e){const{val:t}=Rr.find(e,this.path);return t!==void 0}toJson(e){return{op:"defined",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path)}}toCompact(e,t){return[t?"defined":Kn.defined,e?this.path.slice(e.path.length):this.path]}}class y_t extends $p{op(){return"undefined"}code(){return Kn.undefined}test(e){try{const{val:t}=Rr.find(e,this.path);return t===void 0}catch(t){if(t.message==="NOT_FOUND")return!0;throw t}}toJson(e){return{op:"undefined",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path)}}toCompact(e,t){return[t?"undefined":Kn.undefined,e?this.path.slice(e.path.length):this.path]}}const{isArray:b_t}=Array;class S_t extends $p{type;constructor(e,t){super(e),this.type=t}op(){return"test_type"}code(){return Kn.test_type}test(e){const{val:t}=Rr.find(e,this.path);return t===null?this.type.indexOf("null")>-1:b_t(t)?this.type.indexOf("array")>-1:this.type.indexOf(typeof t)>-1||typeof t=="number"&&t===Math.round(t)&&this.type.indexOf("integer")>-1}toJson(e){return{op:"test_type",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),type:this.type}}toCompact(e,t){return[t?"test_type":Kn.test_type,e?this.path.slice(e.path.length):this.path,this.type]}}class E_t extends $p{pos;str;not;constructor(e,t,r,i){super(e),this.pos=t,this.str=r,this.not=i}op(){return"test_string"}code(){return Kn.test_string}test(e){const{val:t}=Rr.find(e,this.path);if(typeof t!="string")return!1;const r=t.length,i=Math.min(this.pos,r),s=Math.min(this.pos+this.str.length,r),a=t.substring(i,s)===this.str;return this.not?!a:a}toJson(e){const t={op:"test_string",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),pos:this.pos,str:this.str};return this.not&&(t.not=this.not),t}toCompact(e,t){const r=t?"test_string":Kn.test_string,i=e?this.path.slice(e.path.length):this.path;return this.not?[r,i,this.pos,this.str,1]:[r,i,this.pos,this.str]}}class x_t extends $p{len;not;constructor(e,t,r){super(e),this.len=t,this.not=r}op(){return"test_string_len"}code(){return Kn.test_string_len}test(e){const{val:t}=Rr.find(e,this.path);if(typeof t!="string")return!1;const i=t.length>=this.len;return this.not?!i:i}toJson(e){const t={op:"test_string_len",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),len:this.len};return this.not&&(t.not=this.not),t}toCompact(e,t){const r=t?"test_string_len":Kn.test_string_len,i=e?this.path.slice(e.path.length):this.path;return this.not?[r,i,this.len,1]:[r,i,this.len]}}class T_t extends $p{value;ignore_case;constructor(e,t,r){super(e),this.value=t,this.ignore_case=r}op(){return"contains"}code(){return Kn.contains}test(e){const{val:t}=Rr.find(e,this.path);if(typeof t!="string")return!1;const r=this.ignore_case?t.toLowerCase():t,i=this.ignore_case?this.value.toLowerCase():this.value;return r.indexOf(i)>-1}toJson(e){const t={op:"contains",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value};return this.ignore_case&&(t.ignore_case=this.ignore_case),t}toCompact(e,t){const r=t?"contains":Kn.contains;return this.ignore_case?[r,e?this.path.slice(e.path.length):this.path,this.value,1]:[r,e?this.path.slice(e.path.length):this.path,this.value]}}class w_t extends $p{value;ignore_case;constructor(e,t,r){super(e),this.value=t,this.ignore_case=r}op(){return"ends"}code(){return Kn.ends}test(e){const{val:t}=Rr.find(e,this.path);if(typeof t!="string")return!1;const r=this.ignore_case?t.toLowerCase():t,i=this.ignore_case?this.value.toLowerCase():this.value;return r.endsWith(i)}toJson(e){const t={op:"ends",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value};return this.ignore_case&&(t.ignore_case=this.ignore_case),t}toCompact(e,t){const r=t?"ends":Kn.ends;return this.ignore_case?[r,e?this.path.slice(e.path.length):this.path,this.value,1]:[r,e?this.path.slice(e.path.length):this.path,this.value]}}class R_t extends $p{value;ignore_case;constructor(e,t,r){super(e),this.value=t,this.ignore_case=r}op(){return"starts"}code(){return Kn.starts}test(e){const{val:t}=Rr.find(e,this.path);if(typeof t!="string")return!1;const r=this.ignore_case?t.toLowerCase():t,i=this.ignore_case?this.value.toLowerCase():this.value;return r.startsWith(i)}toJson(e){const t={op:"starts",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value};return this.ignore_case&&(t.ignore_case=this.ignore_case),t}toCompact(e,t){const r=t?"starts":Kn.starts;return this.ignore_case?[r,e?this.path.slice(e.path.length):this.path,this.value,1]:[r,e?this.path.slice(e.path.length):this.path,this.value]}}class A_t extends $p{value;constructor(e,t){super(e),this.value=t}op(){return"in"}code(){return Kn.in}test(e){const{val:t}=Rr.find(e,this.path);for(const r of this.value)if(_be.deepEqual(t,r))return!0;return!1}toJson(e){return{op:"in",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value}}toCompact(e,t){return[t?"in":Kn.in,e?this.path.slice(e.path.length):this.path,this.value]}}class C_t extends $p{value;constructor(e,t){super(e),this.value=t}op(){return"less"}code(){return Kn.less}test(e){const{val:t}=Rr.find(e,this.path);return typeof t!="number"?!1:t<this.value}toJson(e){return{op:"less",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value}}toCompact(e,t){return[t?"less":Kn.less,e?this.path.slice(e.path.length):this.path,this.value]}}class M_t extends $p{value;constructor(e,t){super(e),this.value=t}op(){return"more"}code(){return Kn.more}test(e){const{val:t}=Rr.find(e,this.path);return typeof t!="number"?!1:t>this.value}toJson(e){return{op:"more",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value}}toCompact(e,t){return[t?"more":Kn.more,e?this.path.slice(e.path.length):this.path,this.value]}}class IG extends $p{ops;constructor(e,t){super(e),this.ops=t}}class O_t extends IG{ops;constructor(e,t){super(e,t),this.ops=t}op(){return"and"}code(){return Kn.and}test(e){for(const t of this.ops)if(!t.test(e))return!1;return!0}toJson(e){return{op:"and",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),apply:this.ops.map(r=>r.toJson(this))}}toCompact(e,t){return[t?"and":Kn.and,e?this.path.slice(e.path.length):this.path,this.ops.map(i=>i.toCompact(this,t))]}}class k_t extends IG{ops;constructor(e,t){super(e,t),this.ops=t}op(){return"or"}code(){return Kn.or}test(e){for(const t of this.ops)if(t.test(e))return!0;return!1}toJson(e){return{op:"or",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),apply:this.ops.map(r=>r.toJson(this))}}toCompact(e,t){return[t?"or":Kn.or,e?this.path.slice(e.path.length):this.path,this.ops.map(i=>i.toCompact(this,t))]}}class I_t extends IG{ops;constructor(e,t){super(e,t),this.ops=t}op(){return"not"}code(){return Kn.not}test(e){for(const t of this.ops)if(t.test(e))return!1;return!0}toJson(e){return{op:"not",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),apply:this.ops.map(r=>r.toJson(this))}}toCompact(e,t){return[t?"not":Kn.not,e?this.path.slice(e.path.length):this.path,this.ops.map(i=>i.toCompact(this,t))]}}class N_t extends $p{value;ignore_case;matcher;constructor(e,t,r,i){super(e),this.value=t,this.ignore_case=r,this.matcher=i(t,r)}op(){return"matches"}code(){return Kn.matches}test(e){const{val:t}=Rr.find(e,this.path);return typeof t!="string"?!1:this.matcher(t)}toJson(e){const t={op:"matches",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value};return this.ignore_case&&(t.ignore_case=this.ignore_case),t}toCompact(e,t){const r=t?"matches":Kn.matches;return this.ignore_case?[r,e?this.path.slice(e.path.length):this.path,this.value,1]:[r,e?this.path.slice(e.path.length):this.path,this.value]}}const{isArray:P_t}=Array;class D_t extends $p{value;constructor(e,t){super(e),this.value=t}op(){return"type"}code(){return Kn.type}test(e){const{val:t}=Rr.find(e,this.path);return t===null?this.value==="null":P_t(t)?this.value==="array":typeof t===this.value||typeof t=="number"&&t===Math.round(t)&&this.value==="integer"}toJson(e){return{op:"type",path:Rr.formatJsonPointer(e?this.path.slice(e.path.length):this.path),value:this.value}}toCompact(e,t){return[t?"type":Kn.type,e?this.path.slice(e.path.length):this.path,this.value]}}var s2={},a2={},Gse;function L_t(){if(Gse)return a2;Gse=1,Object.defineProperty(a2,"__esModule",{value:!0}),a2.JsonPackExtension=void 0;let n=class{constructor(t,r){this.tag=t,this.val=r}};return a2.JsonPackExtension=n,a2}var o2={},l2={},$N={},LS={},$se;function U_t(){if($se)return LS;$se=1,Object.defineProperty(LS,"__esModule",{value:!0}),LS.decodeAsciiMax15=LS.decodeAscii=void 0;const n=String.fromCharCode,e=(r,i,s)=>{const a=[];for(let o=0;o<s;o++){const l=r[i++];if(l&128)return;a.push(l)}return n.apply(String,a)};LS.decodeAscii=e;const t=(r,i,s)=>{if(s<4)if(s<2){if(s===0)return"";{const a=r[i++];if((a&128)>1){i-=1;return}return n(a)}}else{const a=r[i++],o=r[i++];if((a&128)>0||(o&128)>0){i-=2;return}if(s<3)return n(a,o);const l=r[i++];if((l&128)>0){i-=3;return}return n(a,o,l)}else{const a=r[i++],o=r[i++],l=r[i++],c=r[i++];if((a&128)>0||(o&128)>0||(l&128)>0||(c&128)>0){i-=4;return}if(s<6){if(s===4)return n(a,o,l,c);{const u=r[i++];if((u&128)>0){i-=5;return}return n(a,o,l,c,u)}}else if(s<8){const u=r[i++],f=r[i++];if((u&128)>0||(f&128)>0){i-=6;return}if(s<7)return n(a,o,l,c,u,f);const h=r[i++];if((h&128)>0){i-=7;return}return n(a,o,l,c,u,f,h)}else{const u=r[i++],f=r[i++],h=r[i++],g=r[i++];if((u&128)>0||(f&128)>0||(h&128)>0||(g&128)>0){i-=8;return}if(s<10){if(s===8)return n(a,o,l,c,u,f,h,g);{const p=r[i++];if((p&128)>0){i-=9;return}return n(a,o,l,c,u,f,h,g,p)}}else if(s<12){const p=r[i++],_=r[i++];if((p&128)>0||(_&128)>0){i-=10;return}if(s<11)return n(a,o,l,c,u,f,h,g,p,_);const y=r[i++];if((y&128)>0){i-=11;return}return n(a,o,l,c,u,f,h,g,p,_,y)}else{const p=r[i++],_=r[i++],y=r[i++],v=r[i++];if((p&128)>0||(_&128)>0||(y&128)>0||(v&128)>0){i-=12;return}if(s<14){if(s===12)return n(a,o,l,c,u,f,h,g,p,_,y,v);{const x=r[i++];if((x&128)>0){i-=13;return}return n(a,o,l,c,u,f,h,g,p,_,y,v,x)}}else{const x=r[i++],E=r[i++];if((x&128)>0||(E&128)>0){i-=14;return}if(s<15)return n(a,o,l,c,u,f,h,g,p,_,y,v,x,E);const M=r[i++];if((M&128)>0){i-=15;return}return n(a,o,l,c,u,f,h,g,p,_,y,v,x,E,M)}}}}};return LS.decodeAsciiMax15=t,LS}var WN={},Wse;function B_t(){if(Wse)return WN;Wse=1,Object.defineProperty(WN,"__esModule",{value:!0});const n=String.fromCharCode;return WN.default=(e,t,r)=>{let i=t;const s=i+r,a=[];for(;i<s;){let o=e[i++];if((o&128)!==0){const l=e[i++]&63;if((o&224)===192)o=(o&31)<<6|l;else{const c=e[i++]&63;if((o&240)===224)o=(o&31)<<12|l<<6|c;else if((o&248)===240){const u=e[i++]&63;let f=(o&7)<<18|l<<12|c<<6|u;if(f>65535){f-=65536;const h=f>>>10&1023|55296;o=56320|f&1023,a.push(h)}else o=f}}}a.push(o)}return n.apply(String,a)},WN}var Yse;function F_t(){if(Yse)return $N;Yse=1,Object.defineProperty($N,"__esModule",{value:!0});const n=Sx,e=U_t(),t=n.__importDefault(B_t()),r=typeof Bl<"u",i=r?Bl.prototype.utf8Slice:null,s=r?Bl.from:null,a=(u,f,h)=>(0,e.decodeAsciiMax15)(u,f,h)??(0,t.default)(u,f,h),o=(u,f,h)=>(0,e.decodeAscii)(u,f,h)??(0,t.default)(u,f,h),l=i?(u,f,h)=>i.call(u,f,f+h):s?(u,f,h)=>s(u).subarray(f,f+h).toString("utf8"):t.default,c=(u,f,h)=>h<16?a(u,f,h):h<32?o(u,f,h):l(u,f,h);return $N.default=c,$N}var Xse;function z_t(){if(Xse)return l2;Xse=1,Object.defineProperty(l2,"__esModule",{value:!0}),l2.decodeUtf8=void 0;const e=Sx.__importDefault(F_t());return l2.decodeUtf8=e.default,l2}var Kse;function j_t(){if(Kse)return o2;Kse=1,Object.defineProperty(o2,"__esModule",{value:!0}),o2.Reader=void 0;const n=z_t();let e=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(r){this.x=0,this.uint8=r,this.view=new DataView(r.buffer,r.byteOffset,r.length)}peek(){return this.view.getUint8(this.x)}peak(){return this.peek()}skip(r){this.x+=r}buf(r){const i=this.x+r,s=this.uint8.subarray(this.x,i);return this.x=i,s}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let r=this.x;const i=(this.uint8[r++]<<8)+this.uint8[r++];return this.x=r,i}i16(){const r=this.view.getInt16(this.x);return this.x+=2,r}u32(){const r=this.view.getUint32(this.x);return this.x+=4,r}i32(){const r=this.view.getInt32(this.x);return this.x+=4,r}u64(){const r=this.view.getBigUint64(this.x);return this.x+=8,r}i64(){const r=this.view.getBigInt64(this.x);return this.x+=8,r}f32(){const r=this.x;return this.x+=4,this.view.getFloat32(r)}f64(){const r=this.x;return this.x+=8,this.view.getFloat64(r)}utf8(r){const i=this.x;return this.x+=r,(0,n.decodeUtf8)(this.uint8,i,r)}ascii(r){const i=this.uint8;let s="";const a=this.x+r;for(let o=this.x;o<a;o++)s+=String.fromCharCode(i[o]);return this.x=a,s}};return o2.Reader=e,o2}var YN={},c2={},XN={},Zse;function H_t(){if(Zse)return XN;Zse=1,Object.defineProperty(XN,"__esModule",{value:!0});const n=String.fromCharCode;return XN.default=(e,t,r)=>{let i=t;const s=i+r;let a="";for(;i<s;){const o=e[i++];if((o&128)===0){a+=n(o);continue}const l=e[i++]&63;if((o&224)===192){a+=n((o&31)<<6|l);continue}const c=e[i++]&63;if((o&240)===224){a+=n((o&31)<<12|l<<6|c);continue}if((o&248)===240){const u=e[i++]&63;let f=(o&7)<<18|l<<12|c<<6|u;if(f>65535){f-=65536;const h=f>>>10&1023|55296;f=56320|f&1023,a+=n(h,f)}else a+=n(f)}else a+=n(o)}return a},XN}var Jse;function q_t(){if(Jse)return c2;Jse=1,Object.defineProperty(c2,"__esModule",{value:!0}),c2.CachedUtf8Decoder=void 0;const e=Sx.__importDefault(H_t());let t=1+Math.round(Math.random()*((-1>>>0)-1));function r(a,o){return t^=t<<13,t^=t>>>17,t^=t<<5,(t>>>0)%(o-a+1)+a}class i{constructor(o,l){this.bytes=o,this.value=l}}let s=class{constructor(){this.caches=[];for(let o=0;o<31;o++)this.caches.push([])}get(o,l,c){const u=this.caches[c-1],f=u.length;e:for(let h=0;h<f;h++){const g=u[h],p=g.bytes;for(let _=0;_<c;_++)if(p[_]!==o[l+_])continue e;return g.value}return null}store(o,l){const c=this.caches[o.length-1],u=new i(o,l);c.length>=16?c[r(0,15)]=u:c.push(u)}decode(o,l,c){if(!c)return"";const u=this.get(o,l,c);if(u!==null)return u;const f=(0,e.default)(o,l,c),h=Uint8Array.prototype.slice.call(o,l,l+c);return this.store(h,f),f}};return c2.CachedUtf8Decoder=s,c2}var Qse;function V_t(){if(Qse)return YN;Qse=1,Object.defineProperty(YN,"__esModule",{value:!0});const n=q_t();return YN.default=new n.CachedUtf8Decoder,YN}var eae;function G_t(){if(eae)return s2;eae=1,Object.defineProperty(s2,"__esModule",{value:!0}),s2.MsgPackDecoderFast=void 0;const n=Sx,e=L_t(),t=j_t(),r=n.__importDefault(V_t());let i=class{constructor(a=new t.Reader,o=r.default){this.reader=a,this.keyDecoder=o}decode(a){return this.reader.reset(a),this.readAny()}read(a){return this.reader.reset(a),this.readAny()}val(){return this.readAny()}readAny(){const a=this.reader,o=a.u8();if(o>=224)return o-256;if(o<=191)return o<144?o<=127?o:this.obj(o&15):o<160?this.arr(o&15):a.utf8(o&31);if(o<=208)return o<=200?o<=196?o<=194?o===194?!1:o===192?null:void 0:o===196?a.buf(a.u8()):!0:o<=198?o===198?a.buf(a.u32()):a.buf(a.u16()):o===200?this.ext(a.u16()):this.ext(a.u8()):o<=204?o<=202?o===202?a.f32():this.ext(a.u32()):o===204?a.u8():a.f64():o<=206?o===206?a.u32():a.u16():o===208?a.i8():a.u32()*4294967296+a.u32();if(o<=216)return o<=212?o<=210?o===210?a.i32():a.i16():o===212?this.ext(1):a.i32()*4294967296+a.u32():o<=214?o===214?this.ext(4):this.ext(2):o===216?this.ext(16):this.ext(8);switch(o){case 217:return a.utf8(a.u8());case 218:return a.utf8(a.u16());case 219:return a.utf8(a.u32());case 220:return this.arr(a.u16());case 221:return this.arr(a.u32());case 222:return this.obj(a.u16());case 223:return this.obj(a.u32())}}str(){const a=this.reader,o=a.u8();if(o>>5===5)return a.utf8(o&31);switch(o){case 217:return a.utf8(a.u8());case 218:return a.utf8(a.u16());case 219:return a.utf8(a.u32())}}obj(a){const o={};for(let l=0;l<a;l++){const c=this.key();if(c==="__proto__")throw 6;o[c]=this.readAny()}return o}key(){const a=this.reader,o=a.view.getUint8(a.x);if(o>=160&&o<=191){const l=o&31,c=this.keyDecoder.decode(a.uint8,a.x+1,l);return a.x+=1+l,c}else if(o===217){const l=a.view.getUint8(a.x+1);if(l<32){const c=this.keyDecoder.decode(a.uint8,a.x+2,l);return a.x+=2+l,c}}switch(a.x++,o){case 217:return a.utf8(a.u8());case 218:return a.utf8(a.u16());case 219:return a.utf8(a.u32());default:return""}}arr(a){const o=[];for(let l=0;l<a;l++)o.push(this.readAny());return o}ext(a){const o=this.reader,l=o.u8(),c=o.x+a,u=o.uint8.subarray(o.x,c);return o.x=c,new e.JsonPackExtension(l,u)}back(a){this.reader.x-=a}};return s2.MsgPackDecoderFast=i,s2}var $_t=G_t();class W_t extends $_t.MsgPackDecoderFast{options;constructor(e){super(),this.options=e}decode(e){return this.reader.reset(e),this.decodePatch()}decodePatch(){const e=this.decodeArrayHeader(),t=[];for(let r=0;r<e;r++)t.push(this.decodeOp(void 0));return t}decodeOp(e){const t=this.decodeArrayHeader();switch(this.reader.u8()){case Kn.add:{const i=this.decodeArray(),s=this.val();return new kG(i,s)}case Kn.and:{const i=this.decodePath(e),s=this.decodeArrayHeader(),a=[],o=new O_t(i,a);for(let l=0;l<s;l++)a.push(this.decodeOp(o));return o}case Kn.contains:{const i=this.decodePath(e),s=this.decodeString(),a=t>3;return new T_t(i,s,a)}case Kn.copy:{const i=this.decodeArray(),s=this.decodeArray();return new s_t(i,s)}case Kn.defined:{const i=this.decodePath(e);return new v_t(i)}case Kn.ends:{const i=this.decodePath(e),s=this.decodeString(),a=t>3;return new w_t(i,s,a)}case Kn.extend:{const i=this.decodeArray(),s=this.decodeObject(),a=t>3;return new __t(i,s,a)}case Kn.flip:{const i=this.decodeArray();return new c_t(i)}case Kn.in:{const i=this.decodePath(e),s=this.decodeArray();return new A_t(i,s)}case Kn.inc:{const i=this.decodePath(e),s=this.val();return new u_t(i,s)}case Kn.less:{const i=this.decodePath(e),s=this.val();return new C_t(i,s)}case Kn.matches:{const i=this.decodePath(e),s=this.decodeString(),a=t>3;return new N_t(i,s,a,this.options.createMatcher||d_t)}case Kn.merge:{const i=t>3,s=this.decodeArray(),a=this.val(),o=i?this.decodeObject():null;return new m_t(s,a,o)}case Kn.more:{const i=this.decodePath(e),s=this.val();return new M_t(i,s)}case Kn.move:{const i=this.decodeArray(),s=this.decodeArray();return new i_t(i,s)}case Kn.not:{const i=this.decodePath(e),s=this.decodeArrayHeader(),a=[],o=new I_t(i,a);for(let l=0;l<s;l++)a.push(this.decodeOp(o));return o}case Kn.or:{const i=this.decodePath(e),s=this.decodeArrayHeader(),a=[],o=new k_t(i,a);for(let l=0;l<s;l++)a.push(this.decodeOp(o));return o}case Kn.remove:{const i=this.decodeArray(),a=t>2?this.val():void 0;return new gbe(i,a)}case Kn.replace:{const i=this.decodeArray(),s=this.val(),o=t>3?this.val():void 0;return new r_t(i,s,o)}case Kn.split:{const i=this.decodeArray(),s=this.val(),o=t>3?this.decodeObject():null;return new p_t(i,s,o)}case Kn.starts:{const i=t>3,s=this.decodePath(e),a=this.decodeString();return new R_t(s,a,i)}case Kn.str_del:{const i=t<5,s=this.decodeArray(),a=this.val();if(i){const o=this.decodeString();return new Vse(s,a,o,void 0)}else{this.reader.u8();const o=this.val();return new Vse(s,a,void 0,o)}}case Kn.str_ins:{const i=this.decodeArray(),s=this.val(),a=this.decodeString();return new f_t(i,s,a)}case Kn.test:{const i=t>3,s=this.decodePath(e),a=this.val();return new l_t(s,a,i)}case Kn.test_string:{const i=t>4,s=this.decodePath(e),a=this.val(),o=this.decodeString();return new E_t(s,a,o,i)}case Kn.test_string_len:{const i=t>3,s=this.decodePath(e),a=this.val();return new x_t(s,a,i)}case Kn.test_type:{const i=this.decodePath(e),s=this.decodeArray();return new S_t(i,s)}case Kn.type:{const i=this.decodePath(e),s=this.decodeString();return new D_t(i,s)}case Kn.undefined:{const i=this.decodePath(e);return new y_t(i)}}throw new Error("OP_UNKNOWN")}decodePath(e){const t=this.decodeArray();return e?[...e.path,...t]:t}decodeObject(){const e=this.reader,t=e.u8();return t<=191?this.obj(t&15):t===222?this.obj(e.u16()):this.obj(e.u32())}decodeArray(){const e=this.reader,t=e.u8();return t<159?this.arr(t&15):t===220?this.arr(e.u16()):this.arr(e.u32())}decodeArrayHeader(){const e=this.reader,t=e.u8();return t<159?t&15:t===220?e.u16():e.u32()}decodeString(){const e=this.reader,t=e.u8();return t<=191?e.utf8(t&31):t===217?e.utf8(e.u8()):t===218?e.utf8(e.u16()):e.utf8(e.u32())}}function Y_t(n){const e=[],t=n.length;for(let r=0;r<t;r++)e.push(n[r].toJson());return e}var vbe=(n=>(n[n.id=0]="id",n[n.x=1]="x",n[n.y=2]="y",n[n.char=3]="char",n[n.color=4]="color",n[n.bg=5]="bg",n[n.stat=6]="stat",n[n.pid=7]="pid",n))(vbe||{});function X_t(n){return PH(n,vbe)}var ybe=(n=>(n[n.id=0]="id",n[n.type=1]="type",n[n.tag=2]="tag",n[n.width=3]="width",n[n.height=4]="height",n[n.char=5]="char",n[n.color=6]="color",n[n.bg=7]="bg",n[n.stats=8]="stats",n[n.sprites=9]="sprites",n[n.alphas=10]="alphas",n[n.mime=11]="mime",n[n.media=12]="media",n[n.focusx=13]="focusx",n[n.focusy=14]="focusy",n[n.focusid=15]="focusid",n[n.viewscale=16]="viewscale",n[n.graphics=17]="graphics",n[n.facing=18]="facing",n))(ybe||{});function K_t(n){return PH(n,ybe,{sprites:e=>e.map(X_t)})}var bbe=(n=>(n[n.id=0]="id",n[n.board=1]="board",n[n.over=2]="over",n[n.under=3]="under",n[n.layers=4]="layers",n[n.tickers=5]="tickers",n[n.scrollname=6]="scrollname",n[n.scroll=7]="scroll",n[n.sidebar=8]="sidebar",n))(bbe||{});function tae(n){return PH(n,bbe,{layers:e=>e.map(K_t)})}const Z_t=new W_t({}),nae=Y1("gadgetclient",[],n=>{if(!nae.session(n)||n.player!==as())return;const{desync:e}=ws.getState();switch(n.target){case"paint":{const t=tae(n.data);ws.setState({desync:!1,gadget:t,slim:n.data});break}case"patch":e||ws.setState(t=>{let r;try{const i=Z_t.decode(n.data),s=Y_t(i),a=nU(El(t.slim),s,!0,!0),o=tae(a.newDocument);return{...t,gadget:o,slim:a.newDocument}}catch(i){r=i}return xe(r)?(nae.reply(n,"desync"),{...t,desync:!0}):t});break}}),NG=Object.prototype.toString.call(typeof Tl<"u"?Tl:0)==="[object process]";var Jb,ni;(function(n){n[n.CRITICAL=0]="CRITICAL",n[n.ERROR=1]="ERROR",n[n.WARNING=2]="WARNING",n[n.INFO=3]="INFO",n[n.DEBUG=4]="DEBUG",n[n.TRACE=7]="TRACE"})(ni||(ni={}));function PG(n){if(typeof n=="number"){if(Object.prototype.hasOwnProperty.call(ni,n))return n;var e=Object.keys(ni).map(function(r){return parseInt(r,10)}).filter(function(r){return!isNaN(r)&&r<n});return e.length?Math.max.apply(Math,e):ni.WARNING}var t=n.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(ni,t))throw new Error("Unknown log level string: ".concat(n));return ni[t]}var J_t=NG?console.log.bind(console):console.debug.bind(console),Sbe=(Jb={},Jb[ni.CRITICAL]=console.error.bind(console),Jb[ni.ERROR]=console.error.bind(console),Jb[ni.WARNING]=console.warn.bind(console),Jb[ni.INFO]=console.info.bind(console),Jb[ni.DEBUG]=J_t.bind(console),Jb[ni.TRACE]=console.trace.bind(console),Jb);function oS(n){return function(e,t){Object.defineProperty(e,t,{get:function(){},set:function(r){Object.defineProperty(this,t,{value:r,writable:!0,enumerable:n})},enumerable:n})}}function Bz(n){return Hl(this,void 0,Promise,function(){return a3(this,function(e){switch(e.label){case 0:return typeof n!="function"?[3,2]:[4,n()];case 1:return[2,e.sent()];case 2:return[2,n]}})})}function Q_t(n){return typeof n=="function"?n():n}function Ebe(n){var e,t,r;return a3(this,function(i){switch(i.label){case 0:e=0,t=1,i.label=1;case 1:return e<n?[4,e]:[3,3];case 2:return i.sent(),r=mx([t,e+t],2),e=r[0],t=r[1],[3,1];case 3:return[4,n];case 4:return i.sent(),[3,3];case 5:return[2]}})}function KN(n,e){return Object.assign.apply(Object,ek([{}],mx(n.map(e)),!1))}function Fz(n,e){Object.entries(n).forEach(function(t){var r=mx(t,2),i=r[0],s=r[1];return e(s,i)})}function xbe(n){return n==null}function ak(n,e){return xbe(n)?null:e(n)}function Tbe(n,e){return xbe(n)?void 0:e(n)}function evt(n){return Hl(this,void 0,Promise,function(){return a3(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t){return setTimeout(t,n)})];case 1:return e.sent(),[2]}})})}function zz(){var n,e,t=new Promise(function(r,i){n=r,e=i});return{promise:t,resolve:n,reject:e}}function tvt(n,e,t){if(typeof n=="number"&&(n=n.toString()),e=e-n.length,e<=0)return n;t===void 0&&(t=" ");var r="";do(e&1)===1&&(r+=t),e>>=1,e&&(t+=t);while(e);return r+n}function yE(n,e,t){var r=n.split(e);return r.length<=t?r:ek(ek([],mx(r.slice(0,t-1)),!1),[r.slice(t-1).join(e)],!1)}var nvt={},l7,c7,u4=typeof Tl>"u"?[]:(c7=(l7=nvt.LOGGING)===null||l7===void 0?void 0:l7.split(";").map(function(n){var e=n.split("=",2),t=e[0],r=e[1];return r?[t==="default"?void 0:t.split(":"),PG(r)]:null}).filter(function(n){return!!n}).sort(function(n,e){var t,r,i=n[0],s=e[0];return((t=s?.length)!==null&&t!==void 0?t:0)-((r=i?.length)!==null&&r!==void 0?r:0)}))!==null&&c7!==void 0?c7:[],u7=u4.findIndex(function(n){var e=n[0];return!e}),wbe=void 0;u7!==-1&&(wbe=u4[u7][1],u4.splice(u7));function rvt(n,e){return e.length<=n.length&&e.every(function(t,r){return t===n[r]})}function Rbe(n){for(var e=n.split(":"),t=0,r=u4;t<r.length;t++){var i=r[t],s=i[0],a=i[1];if(rvt(e,s))return a}return wbe}var Abe=(function(){function n(e){var t=e.name,r=e.minLevel,i=e.emoji,s=i===void 0?!1:i,a=e.colors,o=e.timestamps,l=o===void 0?NG:o,c,u;this._name=t,this._minLevel=(u=(c=Tbe(r,function(f){return PG(f)}))!==null&&c!==void 0?c:Rbe(t))!==null&&u!==void 0?u:ni.WARNING,this._emoji=s,this._colors=a,this._timestamps=l}return n.prototype.crit=function(e){this.log(ni.CRITICAL,e)},n.prototype.error=function(e){this.log(ni.ERROR,e)},n.prototype.warn=function(e){this.log(ni.WARNING,e)},n.prototype.info=function(e){this.log(ni.INFO,e)},n.prototype.debug=function(e){this.log(ni.DEBUG,e)},n.prototype.trace=function(e){this.log(ni.TRACE,e)},n})(),ivt=(function(n){f6(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){if(!(t>this._minLevel)){var i=Sbe[t],s="[".concat(this._name,"] ").concat(r);this._timestamps&&(s="[".concat(new Date().toISOString(),"] ").concat(r)),i(s)}},e})(Abe),svt=(function(){function n(e){var t=e.name,r=e.minLevel,i=e.custom,s;this._minLevel=(s=Tbe(r,function(a){return PG(a)}))!==null&&s!==void 0?s:Rbe(t),this._override=typeof i=="function"?{log:i}:i}return n.prototype.log=function(e,t){this._shouldLog(e)&&this._override.log(e,t)},n.prototype.crit=function(e){this._override.crit?this._shouldLog(ni.CRITICAL)&&this._override.crit(e):this.log(ni.CRITICAL,e)},n.prototype.error=function(e){this._override.error?this._shouldLog(ni.ERROR)&&this._override.error(e):this.log(ni.ERROR,e)},n.prototype.warn=function(e){this._override.warn?this._shouldLog(ni.WARNING)&&this._override.warn(e):this.log(ni.WARNING,e)},n.prototype.info=function(e){this._override.info?this._shouldLog(ni.INFO)&&this._override.info(e):this.log(ni.INFO,e)},n.prototype.debug=function(e){this._override.debug?this._shouldLog(ni.DEBUG)&&this._override.debug(e):this.log(ni.DEBUG,e)},n.prototype.trace=function(e){this._override.trace?this._shouldLog(ni.TRACE)&&this._override.trace(e):this.log(ni.TRACE,e)},n.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},n})(),Qb,e1,t1,avt=(Qb={},Qb[ni.CRITICAL]="🛑",Qb[ni.ERROR]="❌",Qb[ni.WARNING]="⚠️ ",Qb[ni.INFO]="ℹ️ ",Qb[ni.DEBUG]="🐞",Qb[ni.TRACE]="🐾",Qb),ovt={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},lvt={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function N6(n,e,t){return function(r){return"\x1B[".concat(n,"m").concat(t?t(r):r,"\x1B[").concat(e,"m")}}function wv(n){return N6(ovt[n],39)}function u2(n,e){return N6(lvt[n],49,e)}var cvt=(e1={},e1[ni.CRITICAL]=wv("red"),e1[ni.ERROR]=wv("redBright"),e1[ni.WARNING]=wv("yellow"),e1[ni.INFO]=wv("blue"),e1[ni.DEBUG]=wv("magenta"),e1[ni.TRACE]=N6(0,0),e1),rae=(t1={},t1[ni.CRITICAL]=u2("bgRed",wv("white")),t1[ni.ERROR]=u2("bgRedBright",wv("white")),t1[ni.WARNING]=u2("bgYellow",wv("black")),t1[ni.INFO]=u2("bgBlue",wv("white")),t1[ni.DEBUG]=u2("bgMagenta",wv("black")),t1[ni.TRACE]=N6(7,27),t1),uvt=(function(n){f6(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){var i,s,a;if(!(t>this._minLevel)){var o=Sbe[t],l="";if(this._timestamps&&(l+="[".concat(new Date().toISOString(),"] ")),this._emoji){var c=avt[t];l+="".concat(c," ")}var u=(a=(i=this._colors)!==null&&i!==void 0?i:(s=Tl.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&a!==void 0?a:!0;u?l+="".concat(rae[t](this._name)," ").concat(rae[t](ni[t])," ").concat(cvt[t](r)):l+="[".concat(this._name,":").concat(ni[t].toLowerCase(),"] ").concat(r),o(l)}},e})(Abe);function P6(n){return n.custom?new svt(n):NG?new uvt(n):new ivt(n)}let Cbe=class extends Error{constructor(...e){var t;super(...e),Object.setPrototypeOf(this,new.target.prototype),(t=Error.captureStackTrace)===null||t===void 0||t.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}};class f4 extends Cbe{}class Mbe extends Cbe{}class fvt{constructor({logger:e,bucketSize:t,timeFrame:r,doRequest:i,getPartitionKey:s}){this._partitionedQueue=new Map,this._usedFromBucket=new Map,this._counterTimers=new Set,this._paused=!1,this._destroyed=!1,this._logger=P6({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=t,this._timeFrame=r,this._callback=i,this._partitionKeyCallback=s}async request(e,t){return await new Promise((r,i)=>{var s,a;if(this._destroyed){i(new f4("Rate limiter was destroyed"));return}const o={req:e,resolve:r,reject:i,limitReachedBehavior:(s=t?.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"},l=this._partitionKeyCallback(e),c=(a=this._usedFromBucket.get(l))!==null&&a!==void 0?a:0;if(c>=this._bucketSize||this._paused)switch(o.limitReachedBehavior){case"enqueue":{const u=this._getPartitionedQueue(l);u.push(o),c+u.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} for ${l?`partition ${l}`:"default partition"} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${u.length}`):this._logger.info(`Enqueueing request for ${l?`partition ${l}`:"default partition"} because the rate limiter is paused; queue size is ${u.length}`);break}case"null":{o.resolve(null),this._paused?this._logger.info(`Returning null for request for ${l?`partition ${l}`:"default partition"} because the rate limiter is paused`):this._logger.warn(`Rate limit of ${this._bucketSize} for ${l?`partition ${l}`:"default partition"} was reached, dropping request and returning null`);break}case"throw":{o.reject(new Mbe(`Request dropped because ${this._paused?"the rate limiter is paused":`the rate limit for ${l?`partition ${l}`:"default partition"} was reached`}`));break}default:throw new Error("this should never happen")}else this._runRequest(o,l)})}clear(){this._partitionedQueue.clear()}pause(){this._paused=!0}resume(){this._paused=!1;for(const e of this._partitionedQueue.keys())this._runNextRequest(e)}destroy(){this._paused=!1,this._destroyed=!0,this._counterTimers.forEach(e=>{clearTimeout(e)});for(const e of this._partitionedQueue.values())for(const t of e)t.reject(new f4("Rate limiter was destroyed"));this._partitionedQueue.clear()}_getPartitionedQueue(e){if(this._partitionedQueue.has(e))return this._partitionedQueue.get(e);const t=[];return this._partitionedQueue.set(e,t),t}async _runRequest(e,t){var r;const i=this._getPartitionedQueue(t);this._logger.debug(`doing a request for ${t?`partition ${t}`:"default partition"}, new queue length is ${i.length}`),this._usedFromBucket.set(t,((r=this._usedFromBucket.get(t))!==null&&r!==void 0?r:0)+1);const{req:s,resolve:a,reject:o}=e;try{a(await this._callback(s))}catch(l){o(l)}finally{const l=setTimeout(()=>{this._counterTimers.delete(l);const c=this._usedFromBucket.get(t)-1;this._usedFromBucket.set(t,c),i.length&&c<this._bucketSize&&this._runNextRequest(t)},this._timeFrame);this._counterTimers.add(l)}}_runNextRequest(e){if(this._paused)return;const r=this._getPartitionedQueue(e).shift();r&&this._runRequest(r,e)}}class jz{constructor({logger:e,bucketSize:t,timeFrame:r,doRequest:i}){this._queue=[],this._usedFromBucket=0,this._counterTimers=new Set,this._paused=!1,this._destroyed=!1,this._logger=P6({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=t,this._timeFrame=r,this._callback=i}async request(e,t){return await new Promise((r,i)=>{var s;if(this._destroyed){i(new f4("Rate limiter was destroyed"));return}const a={req:e,resolve:r,reject:i,limitReachedBehavior:(s=t?.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"};if(this._usedFromBucket>=this._bucketSize||this._paused)switch(a.limitReachedBehavior){case"enqueue":{this._queue.push(a),this._usedFromBucket+this._queue.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${this._queue.length}`):this._logger.info(`Enqueueing request because the rate limiter is paused; queue size is ${this._queue.length}`);break}case"null":{a.resolve(null),this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`),this._paused?this._logger.info("Returning null for request because the rate limiter is paused"):this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`);break}case"throw":{a.reject(new Mbe(`Request dropped because ${this._paused?"the rate limiter is paused":"the rate limit was reached"}`));break}default:throw new Error("this should never happen")}else this._runRequest(a)})}clear(){this._queue=[]}pause(){this._paused=!0}resume(){this._paused=!1,this._runNextRequest()}destroy(){this._paused=!1,this._destroyed=!0,this._counterTimers.forEach(e=>{clearTimeout(e)});for(const e of this._queue)e.reject(new f4("Rate limiter was destroyed"));this._queue=[]}async _runRequest(e){this._logger.debug(`doing a request, new queue length is ${this._queue.length}`),this._usedFromBucket+=1;const{req:t,resolve:r,reject:i}=e;try{r(await this._callback(t))}catch(s){i(s)}finally{const s=setTimeout(()=>{this._counterTimers.delete(s),this._usedFromBucket-=1,this._queue.length&&this._usedFromBucket<this._bucketSize&&this._runNextRequest()},this._timeFrame);this._counterTimers.add(s)}}_runNextRequest(){if(this._paused)return;const e=this._queue.shift();e&&this._runRequest(e)}}class hvt extends jz{constructor(e,t){super({...t,async doRequest(r,i){return await e.request(r,i)}})}}class dvt{constructor(e,t,r,i=!1){this.owner=e,this.event=t,this.listener=r,this._internal=i}unbind(){this.owner.removeListener(this)}}class O3{constructor(){this._eventListeners=new Map,this._internalEventListeners=new Map}on(e,t){return this._addListener(!1,e,t)}addListener(e,t){return this._addListener(!1,e,t)}removeListener(e,t){this._removeListener(!1,e,t)}registerEvent(){const e=t=>this.addListener(e,t);return e}emit(e,...t){if(this._eventListeners.has(e))for(const r of this._eventListeners.get(e))r(...t);if(this._internalEventListeners.has(e))for(const r of this._internalEventListeners.get(e))r(...t)}registerInternalEvent(){const e=t=>this.addInternalListener(e,t);return e}addInternalListener(e,t){return this._addListener(!0,e,t)}removeInternalListener(e,t){this._removeListener(!0,e,t)}_addListener(e,t,r){const i=e?this._eventListeners:this._internalEventListeners;return i.has(t)?i.get(t).push(r):i.set(t,[r]),new dvt(this,t,r,e)}_removeListener(e,t,r){const i=e?this._eventListeners:this._internalEventListeners;if(!t)i.clear();else if(typeof t=="object"){const s=t;this._removeListener(s._internal,s.event,s.listener)}else{const s=t;if(i.has(s))if(r){const a=i.get(s);let o=0;for(;(o=a.indexOf(r))!==-1;)a.splice(o,1)}else i.delete(s)}}}const pvt=6e4;function mvt(n){return ak(n.expiresIn,e=>n.obtainmentTimestamp+e*1e3-pvt)}function jP(n){var e;return(e=ak(mvt(n),t=>Date.now()>t))!==null&&e!==void 0?e:!1}var R2={exports:{}},gvt=R2.exports,iae;function _vt(){return iae||(iae=1,(function(n,e){var t=typeof self<"u"?self:gvt,r=(function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s})();(function(s){(function(a){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function l(U){return U&&DataView.prototype.isPrototypeOf(U)}if(o.arrayBuffer)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(U){return U&&c.indexOf(Object.prototype.toString.call(U))>-1};function f(U){if(typeof U!="string"&&(U=String(U)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(U))throw new TypeError("Invalid character in header field name");return U.toLowerCase()}function h(U){return typeof U!="string"&&(U=String(U)),U}function g(U){var Q={next:function(){var W=U.shift();return{done:W===void 0,value:W}}};return o.iterable&&(Q[Symbol.iterator]=function(){return Q}),Q}function p(U){this.map={},U instanceof p?U.forEach(function(Q,W){this.append(W,Q)},this):Array.isArray(U)?U.forEach(function(Q){this.append(Q[0],Q[1])},this):U&&Object.getOwnPropertyNames(U).forEach(function(Q){this.append(Q,U[Q])},this)}p.prototype.append=function(U,Q){U=f(U),Q=h(Q);var W=this.map[U];this.map[U]=W?W+", "+Q:Q},p.prototype.delete=function(U){delete this.map[f(U)]},p.prototype.get=function(U){return U=f(U),this.has(U)?this.map[U]:null},p.prototype.has=function(U){return this.map.hasOwnProperty(f(U))},p.prototype.set=function(U,Q){this.map[f(U)]=h(Q)},p.prototype.forEach=function(U,Q){for(var W in this.map)this.map.hasOwnProperty(W)&&U.call(Q,this.map[W],W,this)},p.prototype.keys=function(){var U=[];return this.forEach(function(Q,W){U.push(W)}),g(U)},p.prototype.values=function(){var U=[];return this.forEach(function(Q){U.push(Q)}),g(U)},p.prototype.entries=function(){var U=[];return this.forEach(function(Q,W){U.push([W,Q])}),g(U)},o.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function _(U){if(U.bodyUsed)return Promise.reject(new TypeError("Already read"));U.bodyUsed=!0}function y(U){return new Promise(function(Q,W){U.onload=function(){Q(U.result)},U.onerror=function(){W(U.error)}})}function v(U){var Q=new FileReader,W=y(Q);return Q.readAsArrayBuffer(U),W}function x(U){var Q=new FileReader,W=y(Q);return Q.readAsText(U),W}function E(U){for(var Q=new Uint8Array(U),W=new Array(Q.length),q=0;q<Q.length;q++)W[q]=String.fromCharCode(Q[q]);return W.join("")}function M(U){if(U.slice)return U.slice(0);var Q=new Uint8Array(U.byteLength);return Q.set(new Uint8Array(U)),Q.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(U){this._bodyInit=U,U?typeof U=="string"?this._bodyText=U:o.blob&&Blob.prototype.isPrototypeOf(U)?this._bodyBlob=U:o.formData&&FormData.prototype.isPrototypeOf(U)?this._bodyFormData=U:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(U)?this._bodyText=U.toString():o.arrayBuffer&&o.blob&&l(U)?(this._bodyArrayBuffer=M(U.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(U)||u(U))?this._bodyArrayBuffer=M(U):this._bodyText=U=Object.prototype.toString.call(U):this._bodyText="",this.headers.get("content-type")||(typeof U=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(U)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var U=_(this);if(U)return U;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var U=_(this);if(U)return U;if(this._bodyBlob)return x(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(E(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(U){var Q=U.toUpperCase();return N.indexOf(Q)>-1?Q:U}function D(U,Q){Q=Q||{};var W=Q.body;if(U instanceof D){if(U.bodyUsed)throw new TypeError("Already read");this.url=U.url,this.credentials=U.credentials,Q.headers||(this.headers=new p(U.headers)),this.method=U.method,this.mode=U.mode,this.signal=U.signal,!W&&U._bodyInit!=null&&(W=U._bodyInit,U.bodyUsed=!0)}else this.url=String(U);if(this.credentials=Q.credentials||this.credentials||"same-origin",(Q.headers||!this.headers)&&(this.headers=new p(Q.headers)),this.method=I(Q.method||this.method||"GET"),this.mode=Q.mode||this.mode||null,this.signal=Q.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&W)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(W)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function V(U){var Q=new FormData;return U.trim().split("&").forEach(function(W){if(W){var q=W.split("="),Y=q.shift().replace(/\+/g," "),ae=q.join("=").replace(/\+/g," ");Q.append(decodeURIComponent(Y),decodeURIComponent(ae))}}),Q}function G(U){var Q=new p,W=U.replace(/\r?\n[\t ]+/g," ");return W.split(/\r?\n/).forEach(function(q){var Y=q.split(":"),ae=Y.shift().trim();if(ae){var Z=Y.join(":").trim();Q.append(ae,Z)}}),Q}k.call(D.prototype);function J(U,Q){Q||(Q={}),this.type="default",this.status=Q.status===void 0?200:Q.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Q?Q.statusText:"OK",this.headers=new p(Q.headers),this.url=Q.url||"",this._initBody(U)}k.call(J.prototype),J.prototype.clone=function(){return new J(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},J.error=function(){var U=new J(null,{status:0,statusText:""});return U.type="error",U};var B=[301,302,303,307,308];J.redirect=function(U,Q){if(B.indexOf(Q)===-1)throw new RangeError("Invalid status code");return new J(null,{status:Q,headers:{location:U}})},a.DOMException=s.DOMException;try{new a.DOMException}catch{a.DOMException=function(Q,W){this.message=Q,this.name=W;var q=Error(Q);this.stack=q.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function $(U,Q){return new Promise(function(W,q){var Y=new D(U,Q);if(Y.signal&&Y.signal.aborted)return q(new a.DOMException("Aborted","AbortError"));var ae=new XMLHttpRequest;function Z(){ae.abort()}ae.onload=function(){var K={status:ae.status,statusText:ae.statusText,headers:G(ae.getAllResponseHeaders()||"")};K.url="responseURL"in ae?ae.responseURL:K.headers.get("X-Request-URL");var ne="response"in ae?ae.response:ae.responseText;W(new J(ne,K))},ae.onerror=function(){q(new TypeError("Network request failed"))},ae.ontimeout=function(){q(new TypeError("Network request failed"))},ae.onabort=function(){q(new a.DOMException("Aborted","AbortError"))},ae.open(Y.method,Y.url,!0),Y.credentials==="include"?ae.withCredentials=!0:Y.credentials==="omit"&&(ae.withCredentials=!1),"responseType"in ae&&o.blob&&(ae.responseType="blob"),Y.headers.forEach(function(K,ne){ae.setRequestHeader(ne,K)}),Y.signal&&(Y.signal.addEventListener("abort",Z),ae.onreadystatechange=function(){ae.readyState===4&&Y.signal.removeEventListener("abort",Z)}),ae.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return $.polyfill=!0,s.fetch||(s.fetch=$,s.Headers=p,s.Request=D,s.Response=J),a.Headers=p,a.Request=D,a.Response=J,a.fetch=$,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,n.exports=e})(R2,R2.exports)),R2.exports}var Obe=_vt();const vvt=Bh(Obe);var f7,sae;function DG(){if(sae)return f7;sae=1;var n=Object.prototype.hasOwnProperty,e=Array.isArray,t=(function(){for(var g=[],p=0;p<256;++p)g.push("%"+((p<16?"0":"")+p.toString(16)).toUpperCase());return g})(),r=function(p){for(;p.length>1;){var _=p.pop(),y=_.obj[_.prop];if(e(y)){for(var v=[],x=0;x<y.length;++x)typeof y[x]<"u"&&v.push(y[x]);_.obj[_.prop]=v}}},i=function(p,_){for(var y=_&&_.plainObjects?Object.create(null):{},v=0;v<p.length;++v)typeof p[v]<"u"&&(y[v]=p[v]);return y},s=function g(p,_,y){if(!_)return p;if(typeof _!="object"){if(e(p))p.push(_);else if(p&&typeof p=="object")(y&&(y.plainObjects||y.allowPrototypes)||!n.call(Object.prototype,_))&&(p[_]=!0);else return[p,_];return p}if(!p||typeof p!="object")return[p].concat(_);var v=p;return e(p)&&!e(_)&&(v=i(p,y)),e(p)&&e(_)?(_.forEach(function(x,E){if(n.call(p,E)){var M=p[E];M&&typeof M=="object"&&x&&typeof x=="object"?p[E]=g(M,x,y):p.push(x)}else p[E]=x}),p):Object.keys(_).reduce(function(x,E){var M=_[E];return n.call(x,E)?x[E]=g(x[E],M,y):x[E]=M,x},v)},a=function(p,_){return Object.keys(_).reduce(function(y,v){return y[v]=_[v],y},p)},o=function(g,p,_){var y=g.replace(/\+/g," ");if(_==="iso-8859-1")return y.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(y)}catch{return y}},l=function(p,_,y){if(p.length===0)return p;var v=p;if(typeof p=="symbol"?v=Symbol.prototype.toString.call(p):typeof p!="string"&&(v=String(p)),y==="iso-8859-1")return escape(v).replace(/%u[0-9a-f]{4}/gi,function(k){return"%26%23"+parseInt(k.slice(2),16)+"%3B"});for(var x="",E=0;E<v.length;++E){var M=v.charCodeAt(E);if(M===45||M===46||M===95||M===126||M>=48&&M<=57||M>=65&&M<=90||M>=97&&M<=122){x+=v.charAt(E);continue}if(M<128){x=x+t[M];continue}if(M<2048){x=x+(t[192|M>>6]+t[128|M&63]);continue}if(M<55296||M>=57344){x=x+(t[224|M>>12]+t[128|M>>6&63]+t[128|M&63]);continue}E+=1,M=65536+((M&1023)<<10|v.charCodeAt(E)&1023),x+=t[240|M>>18]+t[128|M>>12&63]+t[128|M>>6&63]+t[128|M&63]}return x},c=function(p){for(var _=[{obj:{o:p},prop:"o"}],y=[],v=0;v<_.length;++v)for(var x=_[v],E=x.obj[x.prop],M=Object.keys(E),k=0;k<M.length;++k){var N=M[k],I=E[N];typeof I=="object"&&I!==null&&y.indexOf(I)===-1&&(_.push({obj:E,prop:N}),y.push(I))}return r(_),p},u=function(p){return Object.prototype.toString.call(p)==="[object RegExp]"},f=function(p){return!p||typeof p!="object"?!1:!!(p.constructor&&p.constructor.isBuffer&&p.constructor.isBuffer(p))},h=function(p,_){return[].concat(p,_)};return f7={arrayToObject:i,assign:a,combine:h,compact:c,decode:o,encode:l,isBuffer:f,isRegExp:u,merge:s},f7}var h7,aae;function kbe(){if(aae)return h7;aae=1;var n=String.prototype.replace,e=/%20/g,t=DG(),r={RFC1738:"RFC1738",RFC3986:"RFC3986"};return h7=t.assign({default:r.RFC3986,formatters:{RFC1738:function(i){return n.call(i,e,"+")},RFC3986:function(i){return String(i)}}},r),h7}var d7,oae;function yvt(){if(oae)return d7;oae=1;var n=DG(),e=kbe(),t=Object.prototype.hasOwnProperty,r={brackets:function(p){return p+"[]"},comma:"comma",indices:function(p,_){return p+"["+_+"]"},repeat:function(p){return p}},i=Array.isArray,s=Array.prototype.push,a=function(g,p){s.apply(g,i(p)?p:[p])},o=Date.prototype.toISOString,l=e.default,c={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,format:l,formatter:e.formatters[l],indices:!1,serializeDate:function(p){return o.call(p)},skipNulls:!1,strictNullHandling:!1},u=function(p){return typeof p=="string"||typeof p=="number"||typeof p=="boolean"||typeof p=="symbol"||typeof p=="bigint"},f=function g(p,_,y,v,x,E,M,k,N,I,D,V,G){var J=p;if(typeof M=="function"?J=M(_,J):J instanceof Date?J=I(J):y==="comma"&&i(J)&&(J=J.join(",")),J===null){if(v)return E&&!V?E(_,c.encoder,G,"key"):_;J=""}if(u(J)||n.isBuffer(J)){if(E){var B=V?_:E(_,c.encoder,G,"key");return[D(B)+"="+D(E(J,c.encoder,G,"value"))]}return[D(_)+"="+D(String(J))]}var $=[];if(typeof J>"u")return $;var U;if(i(M))U=M;else{var Q=Object.keys(J);U=k?Q.sort(k):Q}for(var W=0;W<U.length;++W){var q=U[W];x&&J[q]===null||(i(J)?a($,g(J[q],typeof y=="function"?y(_,q):_,y,v,x,E,M,k,N,I,D,V,G)):a($,g(J[q],_+(N?"."+q:"["+q+"]"),y,v,x,E,M,k,N,I,D,V,G)))}return $},h=function(p){if(!p)return c;if(p.encoder!==null&&p.encoder!==void 0&&typeof p.encoder!="function")throw new TypeError("Encoder has to be a function.");var _=p.charset||c.charset;if(typeof p.charset<"u"&&p.charset!=="utf-8"&&p.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var y=e.default;if(typeof p.format<"u"){if(!t.call(e.formatters,p.format))throw new TypeError("Unknown format option provided.");y=p.format}var v=e.formatters[y],x=c.filter;return(typeof p.filter=="function"||i(p.filter))&&(x=p.filter),{addQueryPrefix:typeof p.addQueryPrefix=="boolean"?p.addQueryPrefix:c.addQueryPrefix,allowDots:typeof p.allowDots>"u"?c.allowDots:!!p.allowDots,charset:_,charsetSentinel:typeof p.charsetSentinel=="boolean"?p.charsetSentinel:c.charsetSentinel,delimiter:typeof p.delimiter>"u"?c.delimiter:p.delimiter,encode:typeof p.encode=="boolean"?p.encode:c.encode,encoder:typeof p.encoder=="function"?p.encoder:c.encoder,encodeValuesOnly:typeof p.encodeValuesOnly=="boolean"?p.encodeValuesOnly:c.encodeValuesOnly,filter:x,formatter:v,serializeDate:typeof p.serializeDate=="function"?p.serializeDate:c.serializeDate,skipNulls:typeof p.skipNulls=="boolean"?p.skipNulls:c.skipNulls,sort:typeof p.sort=="function"?p.sort:null,strictNullHandling:typeof p.strictNullHandling=="boolean"?p.strictNullHandling:c.strictNullHandling}};return d7=function(g,p){var _=g,y=h(p),v,x;typeof y.filter=="function"?(x=y.filter,_=x("",_)):i(y.filter)&&(x=y.filter,v=x);var E=[];if(typeof _!="object"||_===null)return"";var M;p&&p.arrayFormat in r?M=p.arrayFormat:p&&"indices"in p?M=p.indices?"indices":"repeat":M="indices";var k=r[M];v||(v=Object.keys(_)),y.sort&&v.sort(y.sort);for(var N=0;N<v.length;++N){var I=v[N];y.skipNulls&&_[I]===null||a(E,f(_[I],I,k,y.strictNullHandling,y.skipNulls,y.encode?y.encoder:null,y.filter,y.sort,y.allowDots,y.serializeDate,y.formatter,y.encodeValuesOnly,y.charset))}var D=E.join(y.delimiter),V=y.addQueryPrefix===!0?"?":"";return y.charsetSentinel&&(y.charset==="iso-8859-1"?V+="utf8=%26%2310003%3B&":V+="utf8=%E2%9C%93&"),D.length>0?V+D:""},d7}var bvt=yvt();const Ibe=Bh(bvt);var p7,lae;function Svt(){if(lae)return p7;lae=1;var n=DG(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},i=function(g){return g.replace(/&#(\d+);/g,function(p,_){return String.fromCharCode(parseInt(_,10))})},s=function(g,p){return g&&typeof g=="string"&&p.comma&&g.indexOf(",")>-1?g.split(","):g},a=function(p,_){if(t(p)){for(var y=[],v=0;v<p.length;v+=1)y.push(_(p[v]));return y}return _(p)},o="utf8=%26%2310003%3B",l="utf8=%E2%9C%93",c=function(p,_){var y={},v=_.ignoreQueryPrefix?p.replace(/^\?/,""):p,x=_.parameterLimit===1/0?void 0:_.parameterLimit,E=v.split(_.delimiter,x),M=-1,k,N=_.charset;if(_.charsetSentinel)for(k=0;k<E.length;++k)E[k].indexOf("utf8=")===0&&(E[k]===l?N="utf-8":E[k]===o&&(N="iso-8859-1"),M=k,k=E.length);for(k=0;k<E.length;++k)if(k!==M){var I=E[k],D=I.indexOf("]="),V=D===-1?I.indexOf("="):D+1,G,J;V===-1?(G=_.decoder(I,r.decoder,N,"key"),J=_.strictNullHandling?null:""):(G=_.decoder(I.slice(0,V),r.decoder,N,"key"),J=a(s(I.slice(V+1),_),function(B){return _.decoder(B,r.decoder,N,"value")})),J&&_.interpretNumericEntities&&N==="iso-8859-1"&&(J=i(J)),I.indexOf("[]=")>-1&&(J=t(J)?[J]:J),e.call(y,G)?y[G]=n.combine(y[G],J):y[G]=J}return y},u=function(g,p,_,y){for(var v=y?p:s(p,_),x=g.length-1;x>=0;--x){var E,M=g[x];if(M==="[]"&&_.parseArrays)E=[].concat(v);else{E=_.plainObjects?Object.create(null):{};var k=M.charAt(0)==="["&&M.charAt(M.length-1)==="]"?M.slice(1,-1):M,N=parseInt(k,10);!_.parseArrays&&k===""?E={0:v}:!isNaN(N)&&M!==k&&String(N)===k&&N>=0&&_.parseArrays&&N<=_.arrayLimit?(E=[],E[N]=v):E[k]=v}v=E}return v},f=function(p,_,y,v){if(p){var x=y.allowDots?p.replace(/\.([^.[]+)/g,"[$1]"):p,E=/(\[[^[\]]*])/,M=/(\[[^[\]]*])/g,k=y.depth>0&&E.exec(x),N=k?x.slice(0,k.index):x,I=[];if(N){if(!y.plainObjects&&e.call(Object.prototype,N)&&!y.allowPrototypes)return;I.push(N)}for(var D=0;y.depth>0&&(k=M.exec(x))!==null&&D<y.depth;){if(D+=1,!y.plainObjects&&e.call(Object.prototype,k[1].slice(1,-1))&&!y.allowPrototypes)return;I.push(k[1])}return k&&I.push("["+x.slice(k.index)+"]"),u(I,_,y,v)}},h=function(p){if(!p)return r;if(p.decoder!==null&&p.decoder!==void 0&&typeof p.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof p.charset<"u"&&p.charset!=="utf-8"&&p.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var _=typeof p.charset>"u"?r.charset:p.charset;return{allowDots:typeof p.allowDots>"u"?r.allowDots:!!p.allowDots,allowPrototypes:typeof p.allowPrototypes=="boolean"?p.allowPrototypes:r.allowPrototypes,arrayLimit:typeof p.arrayLimit=="number"?p.arrayLimit:r.arrayLimit,charset:_,charsetSentinel:typeof p.charsetSentinel=="boolean"?p.charsetSentinel:r.charsetSentinel,comma:typeof p.comma=="boolean"?p.comma:r.comma,decoder:typeof p.decoder=="function"?p.decoder:r.decoder,delimiter:typeof p.delimiter=="string"||n.isRegExp(p.delimiter)?p.delimiter:r.delimiter,depth:typeof p.depth=="number"||p.depth===!1?+p.depth:r.depth,ignoreQueryPrefix:p.ignoreQueryPrefix===!0,interpretNumericEntities:typeof p.interpretNumericEntities=="boolean"?p.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof p.parameterLimit=="number"?p.parameterLimit:r.parameterLimit,parseArrays:p.parseArrays!==!1,plainObjects:typeof p.plainObjects=="boolean"?p.plainObjects:r.plainObjects,strictNullHandling:typeof p.strictNullHandling=="boolean"?p.strictNullHandling:r.strictNullHandling}};return p7=function(g,p){var _=h(p);if(g===""||g===null||typeof g>"u")return _.plainObjects?Object.create(null):{};for(var y=typeof g=="string"?c(g,_):g,v=_.plainObjects?Object.create(null):{},x=Object.keys(y),E=0;E<x.length;++E){var M=x[E],k=f(M,y[M],_,typeof g=="string");v=n.merge(v,k,_)}return n.compact(v)},p7}Svt();kbe();const bT=Symbol("twurpleRawData");class Evt{constructor(e){this[bT]=e}}class Ex extends Error{constructor(e,t){var r;super(e,t),Object.setPrototypeOf(this,new.target.prototype),(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}function k3(n,e,t){return r=>{const i=t?function(){return`[${e}#${this[t]} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`};Object.defineProperty(r.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:i,enumerable:!1})}}class cae extends Ex{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function Ny(n){return typeof n=="string"?n:typeof n=="number"?n.toString(10):n.id}class Nbe extends Ex{constructor(e,t,r,i,s,a){super(`Encountered HTTP status code ${e}: ${t}

URL: ${r}
Method: ${i}
Body:
${!a&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=r,this._method=i,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function xvt(n,e){var t;if(!n.ok){const r=n.headers.get("Content-Type")==="application/json",i=r?JSON.stringify(await n.json(),null,2):await n.text(),s=Ibe(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),a=`${e.url}${s}`;throw new Nbe(n.status,n.statusText,a,(t=e.method)!==null&&t!==void 0?t:"GET",i,r)}}async function Tvt(n){if(n.status===204)return;const e=await n.text();if(e)return JSON.parse(e)}function wvt(n,e,t){switch(e){case"helix":return`https://api.twitch.tv/helix/${n.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${n.replace(/^\//,"")}`;case"custom":return n;default:return n}}async function Rvt(n,e,t,r,i={},s){var a,o;const l=(a=n.type)!==null&&a!==void 0?a:"helix",c=wvt(n.url,l),u=Ibe(n.query,{arrayFormat:"repeat",addQueryPrefix:!0}),f=new Obe.Headers({Accept:"application/json"});let h;n.jsonBody&&(h=JSON.stringify(n.jsonBody),f.append("Content-Type","application/json")),e&&l!=="auth"&&f.append("Client-ID",e),t&&f.append("Authorization",`${l==="helix"?"Bearer":"OAuth"} ${t}`);const g={...i,method:(o=n.method)!==null&&o!==void 0?o:"GET",headers:f,body:h};return await vvt(`${c}${u}`,g)}async function D6(n,e,t,r,i={}){const s=await Rvt(n,e,t,r,i);return await xvt(s,n),await Tvt(s)}class GT extends Ex{constructor(e){super("Invalid token supplied",e)}}class HP extends Ex{}function Avt(n,e,t,r){return{grant_type:"authorization_code",client_id:n,client_secret:e,code:t,redirect_uri:r}}function Cvt(n,e){return{grant_type:"client_credentials",client_id:n,client_secret:e}}function Mvt(n,e,t){return{grant_type:"refresh_token",client_id:n,client_secret:e,refresh_token:t}}let Hz=class extends Evt{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[bT].client_id}get userId(){var e;return(e=this[bT].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[bT].login)!==null&&e!==void 0?e:null}get scopes(){return this[bT].scopes}get expiryDate(){return ak(this[bT].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};Hz=rl([k3("auth","TokenInfo","clientId")],Hz);function LG(n){var e,t;return{accessToken:n.access_token,refreshToken:n.refresh_token||null,scope:(e=n.scope)!==null&&e!==void 0?e:[],expiresIn:(t=n.expires_in)!==null&&t!==void 0?t:null,obtainmentTimestamp:Date.now()}}async function Ovt(n,e,t,r){return LG(await D6({type:"auth",url:"token",method:"POST",query:Avt(n,e,t,r)}))}async function kvt(n,e){return LG(await D6({type:"auth",url:"token",method:"POST",query:Cvt(n,e)}))}async function uae(n,e,t){return LG(await D6({type:"auth",url:"token",method:"POST",query:Mvt(n,e,t)}))}async function ok(n,e){try{const t=await D6({type:"auth",url:"validate"},e,n);return new Hz(t)}catch(t){throw t instanceof Nbe&&t.statusCode===401?new GT({cause:t}):t}}const Ivt=new Map([["channel_commercial",["channel:edit:commercial"]],["channel_editor",["channel:manage:broadcast"]],["channel_read",["channel:read:stream_key"]],["channel_subscriptions",["channel:read:subscriptions"]],["user_blocks_read",["user:read:blocked_users"]],["user_blocks_edit",["user:manage:blocked_users"]],["user_follows_edit",["user:edit:follows"]],["user_read",["user:read:email"]],["user_subscriptions",["user:read:subscriptions"]],["user:edit:broadcast",["channel:manage:broadcast","channel:manage:extensions"]]]);function Nvt(n,e){if(e?.length){const t=new Set(n.flatMap(r=>{var i;return[r,...(i=Ivt.get(r))!==null&&i!==void 0?i:[]]}));if(e.every(r=>!t.has(r))){const r=e.join(", ");throw new Error(`This token does not have any of the requested scopes (${r}) and can not be upgraded.
If you need dynamically upgrading scopes, please implement the AuthProvider interface accordingly:

	https://twurple.js.org/reference/auth/interfaces/AuthProvider.html`)}}}function qP(n,e){for(const t of e)Nvt(n,t)}async function Pvt(n,e,t,r,i){if(i?.length||!t){const s=await ok(e,n);if(!s.userId)throw new Error("Trying to use an app access token as a user access token");const a=r??s.scopes;return i&&qP(a,i.filter(o=>!!o)),[a,s.userId]}return[r,t]}class fae{constructor(e){this._newTokenScopeSets=[],this._newTokenPromise=null,this._queuedScopeSets=[],this._queueExecutor=null,this._queuePromise=null,this._executor=e}async fetch(...e){var t;const r=e.filter(o=>!!o);if(this._newTokenPromise){if(!r.length)return await this._newTokenPromise;if(this._queueExecutor?this._queuedScopeSets.push(...r):this._queuedScopeSets=[...r],!this._queuePromise){const{promise:o,resolve:l,reject:c}=zz();this._queuePromise=o,this._queueExecutor=async()=>{var u;if(this._queuePromise){this._newTokenScopeSets=this._queuedScopeSets,this._queuedScopeSets=[],this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{l(await this._executor(this._newTokenScopeSets))}catch(f){c(f)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(u=this._queueExecutor)===null||u===void 0||u.call(this)}}}}return await this._queuePromise}this._newTokenScopeSets=[...r];const{promise:i,resolve:s,reject:a}=zz();this._newTokenPromise=i;try{s(await this._executor(this._newTokenScopeSets))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(t=this._queueExecutor)===null||t===void 0||t.call(this)}return await i}}class hae extends Ex{constructor(e){super(`The user context for the user ${e} has been disabled.
This happened because the access token became invalid (e.g. by expiry) and refreshing it failed (e.g. because the account's password was changed).

Use .addUser(), .addUserForToken() or .addUserForCode() for the same user context to re-enable the user with a new, valid token.`),this.userId=e}}class Dvt extends Ex{constructor(e){super(`User ${e} was removed while trying to fetch a token.

Make sure you're not executing any actions when you want to remove a user.`),this.userId=e}}class Lvt extends Ex{constructor(e){super(`Unknown intent: ${e}`),this.intent=e}}let j1=class extends O3{constructor(e){var t;super(),this._userAccessTokens=new Map,this._userTokenFetchers=new Map,this._intentToUserId=new Map,this._userIdToIntents=new Map,this._cachedRefreshFailures=new Set,this.onRefresh=this.registerEvent(),this.onRefreshFailure=this.registerEvent(),this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._redirectUri=e.redirectUri,this._appImpliedScopes=(t=e.appImpliedScopes)!==null&&t!==void 0?t:[],this._appTokenFetcher=new fae(async r=>await this._fetchAppToken(r))}addUser(e,t,r){const i=Ny(e);if(!t.refreshToken)throw new Error(`Trying to add user ${i} without refresh token`);this._cachedRefreshFailures.delete(i),this._userAccessTokens.set(i,{...t,userId:i}),this._userTokenFetchers.has(i)||this._userTokenFetchers.set(i,new fae(async s=>await this._fetchUserToken(i,s))),r&&this.addIntentsToUser(e,r)}async addUserForToken(e,t){let r=null;if(e.accessToken&&!jP(e))try{const o=await ok(e.accessToken);r=[e,o]}catch(o){if(!(o instanceof GT))throw o}if(!r){if(!e.refreshToken)throw new GT;const o=await uae(this._clientId,this._clientSecret,e.refreshToken),l=await ok(o.accessToken);this.emit(this.onRefresh,l.userId,o),r=[o,l]}const[i,s]=r;if(!s.userId)throw new HP("Could not determine a user ID for your token; you might be trying to disguise an app token as a user token.");const a=i.scope?i:{...i,scope:s.scopes};return this.addUser(s.userId,a,t),s.userId}async addUserForCode(e,t){if(!this._redirectUri)throw new Error("This method requires you to pass a `redirectUri` as a configuration property");const r=await Ovt(this._clientId,this._clientSecret,e,this._redirectUri);return await this.addUserForToken(r,t)}hasUser(e){return this._userTokenFetchers.has(Ny(e))}removeUser(e){const t=Ny(e);if(this._userIdToIntents.has(t)){const r=this._userIdToIntents.get(t);for(const i of r)this._intentToUserId.delete(i);this._userIdToIntents.delete(t)}this._userAccessTokens.delete(t),this._userTokenFetchers.delete(t),this._cachedRefreshFailures.delete(t)}addIntentsToUser(e,t){const r=Ny(e);if(!this._userAccessTokens.has(r))throw new Error("Trying to add intents to a user that was not added to this provider");for(const i of t)this._intentToUserId.has(i)&&this._userIdToIntents.get(this._intentToUserId.get(i)).delete(i),this._intentToUserId.set(i,r),this._userIdToIntents.has(r)?this._userIdToIntents.get(r).add(i):this._userIdToIntents.set(r,new Set([i]))}getIntentsForUser(e){const t=Ny(e);return this._userIdToIntents.has(t)?Array.from(this._userIdToIntents.get(t)):[]}removeIntents(e){var t;for(const r of e)if(this._intentToUserId.has(r)){const i=this._intentToUserId.get(r);(t=this._userIdToIntents.get(i))===null||t===void 0||t.delete(r),this._intentToUserId.delete(r)}}async refreshAccessTokenForUser(e){const t=Ny(e);if(this._cachedRefreshFailures.has(t))throw new hae(t);const r=this._userAccessTokens.get(t);if(!r)throw new Error("Trying to refresh token for user that was not added to the provider");const i=await this._refreshUserTokenWithCallback(t,r.refreshToken);return this._checkIntermediateUserRemoval(t),this._userAccessTokens.set(t,{...i,userId:t}),this.emit(this.onRefresh,t,i),{...i,userId:t}}async refreshAccessTokenForIntent(e){if(!this._intentToUserId.has(e))throw new Lvt(e);const t=this._intentToUserId.get(e);return await this.refreshAccessTokenForUser(t)}get clientId(){return this._clientId}getCurrentScopesForUser(e){var t;const r=this._userAccessTokens.get(Ny(e));if(!r)throw new Error("Trying to get scopes for user that was not added to the provider");return(t=r.scope)!==null&&t!==void 0?t:[]}async getAccessTokenForUser(e,...t){const r=Ny(e),i=this._userTokenFetchers.get(r);if(!i)return null;if(this._cachedRefreshFailures.has(r))throw new hae(r);return qP(this.getCurrentScopesForUser(r),t.filter(Boolean)),await i.fetch(...t)}async getAccessTokenForIntent(e,...t){if(!this._intentToUserId.has(e))return null;const r=this._intentToUserId.get(e),i=await this.getAccessTokenForUser(r,...t);if(!i)throw new cae(`Found intent ${e} corresponding to user ID ${r} but no token was found`);return{...i,userId:r}}async getAnyAccessToken(e){if(e){const t=Ny(e);if(this._userAccessTokens.has(t)){const r=await this.getAccessTokenForUser(t);if(!r)throw new cae(`Token for user ID ${t} exists but nothing was returned by getAccessTokenForUser`);return{...r,userId:t}}}return await this.getAppAccessToken()}async getAppAccessToken(e=!1){return e&&(this._appAccessToken=void 0),await this._appTokenFetcher.fetch(...this._appImpliedScopes.map(t=>[t]))}_checkIntermediateUserRemoval(e){if(!this._userTokenFetchers.has(e))throw this._cachedRefreshFailures.delete(e),new Dvt(e)}async _fetchUserToken(e,t){const r=this._userAccessTokens.get(e);if(!r)throw new Error("Trying to get token for user that was not added to the provider");if(r.accessToken&&!jP(r))try{if(r.scope)return qP(r.scope,t),r;const[s=[]]=await Pvt(this._clientId,r.accessToken,e,r.scope,t),a={...r,scope:s};return this._checkIntermediateUserRemoval(e),this._userAccessTokens.set(e,a),a}catch(s){if(!(s instanceof GT))throw s}this._checkIntermediateUserRemoval(e);const i=await this.refreshAccessTokenForUser(e);return qP(i.scope,t),i}async _refreshUserTokenWithCallback(e,t){try{return await uae(this.clientId,this._clientSecret,t)}catch(r){throw this._cachedRefreshFailures.add(e),this.emit(this.onRefreshFailure,e,r),r}}async _fetchAppToken(e){if(e.length>0)for(const t of e)if(this._appImpliedScopes.length){if(t.every(r=>!this._appImpliedScopes.includes(r)))throw new Error(`One of the scopes ${t.join(", ")} requested but only the scope ${this._appImpliedScopes.join(", ")} is implied`)}else throw new Error(`One of the scopes ${t.join(", ")} requested but the client credentials flow does not support scopes`);return!this._appAccessToken||jP(this._appAccessToken)?await this._refreshAppToken():this._appAccessToken}async _refreshAppToken(){return this._appAccessToken=await kvt(this._clientId,this._clientSecret)}};rl([oS(!1)],j1.prototype,"_clientSecret",void 0);rl([oS(!1)],j1.prototype,"_userAccessTokens",void 0);rl([oS(!1)],j1.prototype,"_userTokenFetchers",void 0);rl([oS(!1)],j1.prototype,"_appAccessToken",void 0);rl([oS(!1)],j1.prototype,"_appTokenFetcher",void 0);j1=rl([k3("auth","RefreshingAuthProvider","clientId")],j1);class Uvt extends O3{constructor({lineBased:e,logger:t,additionalOptions:r}={}){super(),this._currentLine="",this._connecting=!1,this._connected=!1,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._lineBased=e??!1,this._logger=t,this._additionalOptions=r}get isConnecting(){return this._connecting}get isConnected(){return this._connected}sendLine(e){this._connected&&(e=e.replace(/[\0\r\n]/g,""),this.sendRaw(`${e}\r
`))}assumeExternalDisconnect(){var e;(e=this._logger)===null||e===void 0||e.trace("AbstractConnection assumeExternalDisconnect"),this._connected=!1,this._connecting=!1,this.clearSocket(),this.emit(this.onDisconnect,!1)}receiveRaw(e){var t,r;if(!this._lineBased){this.emit(this.onReceive,e);return}const i=e.split(`\r
`);if(this._currentLine+=(t=i.shift())!==null&&t!==void 0?t:"",i.length){this.emit(this.onReceive,this._currentLine),this._currentLine=(r=i.pop())!==null&&r!==void 0?r:"";for(const s of i)this.emit(this.onReceive,s)}}}class Bvt{constructor(){throw new Error("DirectConnection is not implemented in a browser environment")}}class Fvt extends O3{constructor(e,t,r={}){var i;super(),this._type=e,this._target=t,this._config=r,this._retryLimit=1/0,this._initialRetryLimit=3,this._connecting=!1,this._connectionRetryCount=0,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._retryLimit=(i=r.retryLimit)!==null&&i!==void 0?i:1/0,this._logger=r.logger}get isConnected(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnected)!==null&&t!==void 0?t:!1}get isConnecting(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnecting)!==null&&t!==void 0?t:this._connecting}get hasSocket(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.hasSocket)!==null&&t!==void 0?t:!1}sendLine(e){var t;(t=this._currentConnection)===null||t===void 0||t.sendLine(e)}connect(){if(this._currentConnection||this._connecting)throw new Error("Connection already present");this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(!0)}disconnect(){var e;if((e=this._logger)===null||e===void 0||e.trace(`PersistentConnection disconnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`),this._connecting=!1,this._currentConnection){const t=this._currentConnection;this._currentConnection=void 0,t.disconnect()}}assumeExternalDisconnect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("PersistentConnection assumeExternalDisconnect"),(t=this._currentConnection)===null||t===void 0||t.assumeExternalDisconnect()}reconnect(){this._reconnect(!0)}acknowledgeSuccessfulReconnect(){this._previousConnection&&(this._previousConnection.disconnect(),this._previousConnection=void 0)}_startTryingToConnect(e=!1){this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(e)}_tryConnect(e=!1){var t,r;(t=this._logger)===null||t===void 0||t.trace(`PersistentConnection tryConnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`);const i=e?this._initialRetryLimit:this._retryLimit;(r=this._retryTimerGenerator)!==null&&r!==void 0||(this._retryTimerGenerator=Ebe(120));const s=this._currentConnection=new this._type(Q_t(this._target),this._config);s.onReceive(a=>this.emit(this.onReceive,a)),s.onConnect(()=>{this.emit(this.onConnect),this._connecting=!1,this._retryTimerGenerator=void 0}),s.onDisconnect((a,o)=>{var l,c,u;if(this.emit(this.onDisconnect,a,o),a)this.emit(this.onEnd,!0),this._connecting=!1,this._retryTimerGenerator=void 0,s.disconnect(),this._currentConnection===s&&(this._currentConnection=void 0),this._previousConnection===s&&(this._previousConnection=void 0);else if(this._connecting){if((l=this._logger)===null||l===void 0||l.debug(`Connection error caught: ${(c=o?.message)!==null&&c!==void 0?c:"unknown error"}`),this._connectionRetryCount>=i)return;this._connectionRetryCount++;const f=this._retryTimerGenerator.next().value;f!==0&&((u=this._logger)===null||u===void 0||u.info(`Retrying in ${f} seconds`)),setTimeout(()=>{var h;this._connecting&&((h=this._logger)===null||h===void 0||h.info(e?"Retrying connection":"Trying to reconnect"),this._tryConnect())},f*1e3)}else this._reconnect()}),s.connect()}_reconnect(e=!1){e&&this._config.overlapManualReconnect?(this._previousConnection=this._currentConnection,this._currentConnection=void 0):this.disconnect(),this._startTryingToConnect(e)}}var ST=null;typeof WebSocket<"u"?ST=WebSocket:typeof MozWebSocket<"u"?ST=MozWebSocket:typeof Jy<"u"?ST=Jy.WebSocket||Jy.MozWebSocket:typeof window<"u"?ST=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ST=self.WebSocket||self.MozWebSocket);class zvt extends Uvt{constructor(e,t){if(super(t),this._socket=null,this._closingOnDemand=!1,e.hostName&&e.port)this._url=`ws${e.secure?"s":""}://${e.hostName}:${e.port}`;else if(e.url)this._url=e.url;else throw new Error("WebSocketConnection requires either hostName & port or url to be set")}get hasSocket(){return!!this._socket}sendRaw(e){var t;(t=this._socket)===null||t===void 0||t.send(e)}connect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection connect"),this._connecting=!0,this._socket=new ST(this._url,(t=this._additionalOptions)===null||t===void 0?void 0:t.wsOptions),this._socket.onopen=()=>{var r;(r=this._logger)===null||r===void 0||r.trace("WebSocketConnection onOpen"),this._connected=!0,this._connecting=!1,this._closingOnDemand=!1,this.emit(this.onConnect)},this._socket.onmessage=({data:r})=>{this.receiveRaw(r.toString())},this._socket.onerror=r=>{var i;(i=this._logger)===null||i===void 0||i.trace(`WebSocketConnection onError message:${r.message}`)},this._socket.onclose=r=>{var i;const s=this._connected,a=this._connecting;if((i=this._logger)===null||i===void 0||i.trace(`WebSocketConnection onClose wasConnected:${s.toString()} wasConnecting:${a.toString()} closingOnDemand:${this._closingOnDemand.toString()} wasClean:${r.wasClean.toString()}`),this._connected=!1,this._connecting=!1,this._closingOnDemand)this._closingOnDemand=!1,this.emit(this.onDisconnect,!0),this.emit(this.onEnd,!0);else{const o=new Error(`[${r.code}] ${r.reason}`);this.emit(this.onDisconnect,!1,o),this.emit(this.onEnd,!1,o)}this.clearSocket()}}disconnect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection disconnect"),this._closingOnDemand=!0,(t=this._socket)===null||t===void 0||t.close()}clearSocket(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onerror=null,this._socket.onclose=null,this._socket=null)}}function X2(n){var e,t,r;if(Array.isArray(n)){for(t=Array(e=n.length);e--;)t[e]=(r=n[e])&&typeof r=="object"?X2(r):r;return t}if(Object.prototype.toString.call(n)==="[object Object]"){t={};for(e in n)e==="__proto__"?Object.defineProperty(t,e,{value:X2(n[e]),configurable:!0,enumerable:!0,writable:!0}):t[e]=(r=n[e])&&typeof r=="object"?X2(r):r;return t}return n}const jvt={name:"away-notify"};class h4 extends Error{constructor(e,t,r){super(`command "${e}" expected ${t} or more parameters, got ${r}`),this._command=e,this._expectedParams=t,this._actualParams=r,Object.setPrototypeOf(this,h4.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h4)}get command(){return this._command}get expectedParams(){return this._expectedParams}get actualParams(){return this._actualParams}}class d4 extends Error{constructor(e,t,r,i){var s;super(`required parameter "${t}" did not validate against ${(s=r.type)!==null&&s!==void 0?s:"regex"} validation: "${i}"`),this._command=e,this._paramName=t,this._paramSpec=r,this._givenValue=i,Object.setPrototypeOf(this,d4.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d4)}get command(){return this._command}get paramName(){return this._paramName}get paramSpec(){return this._paramSpec}get givenValue(){return this._givenValue}}const $T={channelTypes:"#&",supportedUserModes:"iwso",supportedChannelModes:{prefix:"ov",list:"b",alwaysWithParam:"ovk",paramWhenSet:"l",noParam:"imnpst"},prefixes:[{modeChar:"v",prefix:"+"},{modeChar:"o",prefix:"@"}]};var m7={exports:{}},dae;function Hvt(){return dae||(dae=1,(function(n){n.exports=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},n.exports.default=n.exports})(m7)),m7.exports}var qvt=Hvt();const Vvt=Bh(qvt);function qz(n,e="#&"){return new RegExp(`^[${Vvt(e)}][^ \b\0
\r,]+$`).test(n)}const pae={0:"\0",n:`
`,r:"\r","":""};function mae(n){if(!n.startsWith("")||(n=n.substring(1),n.endsWith("")&&(n=n.slice(0,-1)),!n))return!1;n=n.replace(/\x10(.)/,(r,i)=>i in pae?pae[i]:"");let[e,t=""]=yE(n," ",2);return e=e?e.toUpperCase():"",{command:e,params:t}}const Gvt={"\\":"\\",";":":","\n":"n","\r":"r"," ":"s"};function $vt(n){return n.replace(/[\\;\n\r ]/g,e=>`\\${Gvt[e]}`)}function Wvt(n){let e=`${n.nick}`;return n.user&&(e+=`!${n.user}`),n.host&&(e+=`@${n.host}`),e}function Yvt(n,e,t,r,i=$T,s=!1){const a=new n(n.COMMAND,void 0,{serverProperties:i}),o={};if(a._paramSpec&&Fz(a._paramSpec,(l,c)=>{if(!(s&&l.noServer)&&!(!s&&l.noClient)){if(c in e){const u=e[c];if(u!==void 0){if(n.checkParam(u,l,i))o[c]={value:u,trailing:!!l.trailing};else if(!l.optional)throw new Error(`required parameter "${c}" did not suit requirements: "${u}"`)}}if(!(c in o)&&!l.optional)throw new Error(`required parameter "${c}" not found in command "${n.COMMAND}"`)}}),a._parsedParams=o,a._paramSpec)for(const l of Object.keys(a._paramSpec))Object.defineProperty(a,l,{get(){var c,u;return(u=(c=this._parsedParams)===null||c===void 0?void 0:c[l])===null||u===void 0?void 0:u.value}});return a._initPrefixAndTags(t,r),a}class An{static checkParam(e,t,r=$T){return!(t.type==="channel"&&!qz(e,r.channelTypes)||t.type==="channelList"&&!e.split(",").every(s=>qz(s,r.channelTypes))||t.match&&!t.match.test(e))}constructor(e,{params:t,tags:r,prefix:i,rawLine:s}={},{serverProperties:a=$T,isServer:o=!1,shouldParseParams:l=!0}={},c){this._params=[],this._serverProperties=$T,this._paramSpec=c,this._command=e,this._params=t,this._tags=r??new Map,this._prefix=i,this._serverProperties=a,this._raw=s,l&&this.parseParams(o)}getMinParamCount(e=!1){return this._paramSpec?Object.values(this._paramSpec).filter(t=>t.noServer&&e||t.noClient&&!e?!1:!t.optional).length:0}get paramCount(){var e,t;return(t=(e=this._params)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}prefixToString(){return this._prefix?Wvt(this._prefix):""}tagsToString(){return[...this._tags.entries()].map(([e,t])=>t?`${e}=${$vt(t)}`:e).join(";")}toString(e=!1,t=!1){const i=[t?this._buildCommandFromRawParams():this._buildCommandFromNamedParams()];if(e){const a=this.prefixToString();a&&i.unshift(`:${a}`)}const s=this.tagsToString();return s&&i.unshift(`@${s}`),i.join(" ")}_initPrefixAndTags(e,t){this._prefix=e,t&&(this._tags=t)}parseParams(e=!1){if(this._params){let t=this.getMinParamCount(e);if(t>this._params.length)throw new h4(this._command,t,this._params.length);const r=this._paramSpec;if(!r)return;let i=0;const s={};for(const[a,o]of Object.entries(r)){if(o.noServer&&e||o.noClient&&!e)continue;if(this._params.length-i<=t){if(o.optional)continue;if(this._params.length-i!==t)throw new Error("not enough parameters left for required parameters parsing (this is a library bug)")}let l=this._params[i];if(!l){if(o.optional)break;throw new Error("unexpected parameter underflow")}if(o.rest){const c=[];for(;this._params[i]&&!this._params[i].trailing;)c.push(this._params[i].value),++i;if(!c.length){if(o.optional)continue;throw new Error(`no parameters left for required rest parameter "${a}"`)}l={value:c.join(" "),trailing:!1}}if(An.checkParam(l.value,o))s[a]={...l},o.optional||--t,o.rest||++i;else if(!o.optional)throw new d4(this._command,a,o,l.value);if(o.trailing)break}if(this._parsedParams=s,this._paramSpec)for(const a of Object.keys(this._paramSpec))Object.defineProperty(this,a,{get(){var o,l;return(l=(o=this._parsedParams)===null||o===void 0?void 0:o[a])===null||l===void 0?void 0:l.value}})}}get rawParamValues(){var e,t;return(t=(e=this._params)===null||e===void 0?void 0:e.map(r=>r.value))!==null&&t!==void 0?t:[]}get prefix(){return this._prefix}get command(){return this._command}get tags(){return this._tags}get rawLine(){return this._raw}isResponseTo(e){return!1}endsResponseTo(e){return!1}_acceptsInReplyCollection(e){return e.isResponseTo(this)}_buildCommandFromNamedParams(){const e=this._paramSpec?Object.keys(this._paramSpec):[];return[this._command,...e.map(t=>{var r;const i=(r=this._parsedParams)===null||r===void 0?void 0:r[t];if(i)return(i.trailing?":":"")+i.value}).filter(t=>t!==void 0)].join(" ")}_buildCommandFromRawParams(){var e,t;return[this._command,...(t=(e=this._params)===null||e===void 0?void 0:e.map(r=>`${r.trailing?":":""}${r.value}`))!==null&&t!==void 0?t:[]].join(" ")}}An.COMMAND="";An.SUPPORTS_CAPTURE=!1;class Pbe extends An{constructor(e,t,r){super(e,t,r,{reference:{},type:{optional:!0},additionalParams:{optional:!0}})}}Pbe.COMMAND="BATCH";const Xvt={name:"batch",messageTypes:[Pbe],usesTags:!0},Kvt={name:"cap-notify"};class Dbe extends An{constructor(e,t,r){super(e,t,r,{newUser:{},newHost:{}})}}Dbe.COMMAND="CHGHOST";const Zvt={name:"chghost",messageTypes:[Dbe]},Jvt={name:"invite-notify"};class Lbe extends An{}Lbe.COMMAND="ACK";const Qvt={name:"labeled-response",messageTypes:[Lbe],usesTags:!0},eyt={name:"message-tags",usesTags:!0},tyt={name:"multi-prefix"},nyt=Object.freeze(Object.defineProperty({__proto__:null,AwayNotify:jvt,Batch:Xvt,CapNotify:Kvt,ChgHost:Zvt,InviteNotify:Jvt,LabeledResponse:Qvt,MessageTags:eyt,MultiPrefix:tyt},Symbol.toStringTag,{value:"Module"}));class ryt{constructor(e,t,...r){this._client=e,this._originalMessage=t,this._messages=[],this._endEventHandlers=new Map,this._types=new Set(r)}untilEvent(e){this._cleanEndEventHandler(e);const t=this._client.on(e,()=>this.end());this._endEventHandlers.set(e,t)}async promise(){return this._promise||(this._promise=new Promise(e=>{this._promiseResolve=e})),await this._promise}collect(e){return this._originalMessage._acceptsInReplyCollection(e)?(this._messages.push(e),e.endsResponseTo(this._originalMessage)&&this.end(),!0):!1}end(){this._client.stopCollect(this),this._cleanEndEventHandlers(),this._promiseResolve&&this._promiseResolve(this._messages)}_cleanEndEventHandlers(){this._endEventHandlers.forEach(e=>{this._client.removeListener(e)}),this._endEventHandlers.clear()}_cleanEndEventHandler(e){this._endEventHandlers.has(e)&&(this._client.removeListener(this._endEventHandlers.get(e)),this._endEventHandlers.delete(e))}}class UG extends An{constructor(e,t,r){super(e,t,r,{password:{}})}}UG.COMMAND="PASS";class K2 extends An{constructor(e,t,r){super(e,t,r,{nick:{}})}}K2.COMMAND="NICK";class BG extends An{constructor(e,t,r){super(e,t,r,{user:{},mode:{},unused:{},realName:{trailing:!0}})}}BG.COMMAND="USER";class Ube extends An{constructor(e,t,r){super(e,t,r,{name:{},password:{}})}}Ube.COMMAND="OPER";class FG extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0,optional:!0}})}}FG.COMMAND="QUIT";class Bbe extends An{constructor(e,t,r){super(e,t,r,{server:{},reason:{trailing:!0}})}}Bbe.COMMAND="SQUIT";class lk extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},key:{optional:!0}})}}lk.COMMAND="JOIN";class ck extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},reason:{trailing:!0,optional:!0}})}}ck.COMMAND="PART";class p4 extends Error{constructor(e){super(`Unknown channel mode character ${e}`),this._char=e,Object.setPrototypeOf(this,p4.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,p4)}get char(){return this._char}}class Fbe extends An{constructor(e,t,r){super(e,t,r,{target:{},modes:{rest:!0,optional:!0}})}get isChannel(){return qz(this.target,this._serverProperties.channelTypes)}separate(){const e=[],t=this.modes;if(!t)throw new Error("can't separate a channel mode request, just set actions");const r=t.split(" "),i=r.shift();let s="add";for(const a of i){let o=s;switch(a){case"+":{s="add";break}case"-":{s="remove";break}default:{let l=!1,c=!0;if(this.isChannel){if(this._serverProperties.supportedChannelModes.alwaysWithParam.includes(a)||this._serverProperties.supportedChannelModes.prefix.includes(a))l=!0;else if(this._serverProperties.supportedChannelModes.paramWhenSet.includes(a))s==="add"&&(l=!0);else if(this._serverProperties.supportedChannelModes.list.includes(a))r.length?l=!0:o="getList";else if(!this._serverProperties.supportedChannelModes.noParam.includes(a))throw new p4(a)}else c=this._serverProperties.supportedUserModes.includes(a);if(l&&!r.length)continue;e.push({prefix:this._prefix,action:o,letter:a,param:l?r.shift():void 0,known:c})}}}return e}}Fbe.COMMAND="MODE";class zbe extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},newTopic:{optional:!0,trailing:!0}})}}zbe.COMMAND="TOPIC";class I3 extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channelList",optional:!0}})}}I3.COMMAND="NAMES";I3.SUPPORTS_CAPTURE=!0;class jbe extends An{constructor(e,t,r){super(e,t,r,{channel:{optional:!0},server:{optional:!0}})}}jbe.COMMAND="LIST";class Hbe extends An{constructor(e,t,r){super(e,t,r,{target:{},channel:{type:"channel"}})}}Hbe.COMMAND="INVITE";class qbe extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},target:{},reason:{trailing:!0,optional:!0}})}}qbe.COMMAND="KICK";class Vbe extends An{constructor(e,t,r){super(e,t,r,{server:{optional:!0}})}}Vbe.COMMAND="TIME";class uk extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}}uk.COMMAND="PRIVMSG";class L6 extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}}L6.COMMAND="NOTICE";class U6 extends An{constructor(e,t,r){super(e,t,r,{mask:{},flags:{optional:!0},extendedMask:{optional:!0,trailing:!0}})}}U6.COMMAND="WHO";class Gbe extends An{constructor(e,t,r){super(e,t,r,{server:{optional:!0},nickMask:{}})}}Gbe.COMMAND="WHOIS";class $be extends An{constructor(e,t,r){super(e,t,r,{nick:{},count:{optional:!0},server:{optional:!0}})}}$be.COMMAND="WHOWAS";class Wbe extends An{constructor(e,t,r){super(e,t,r,{target:{},reason:{trailing:!0,optional:!0}})}}Wbe.COMMAND="KILL";class m4 extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}m4.COMMAND="PING";class g4 extends An{constructor(e,t,r){super(e,t,r,{server:{noClient:!0},text:{trailing:!0}})}}g4.COMMAND="PONG";class Ybe extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}Ybe.COMMAND="ERROR";class Xbe extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0,optional:!0}})}}Xbe.COMMAND="AWAY";class Kbe extends An{}Kbe.COMMAND="REHASH";class Zbe extends An{}Zbe.COMMAND="RESTART";class Jbe extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}Jbe.COMMAND="WALLOPS";class Qbe extends An{constructor(e,t,r){super(e,t,r,{nicks:{rest:!0}})}}Qbe.COMMAND="USERHOST";class e1e extends An{constructor(e,t,r){super(e,t,r,{nicks:{rest:!0}})}}e1e.COMMAND="ISON";class w0 extends An{constructor(e,t,r){super(e,t,r,{target:{match:/^(?:[a-z_\-\[\]\\^{}|`][a-z0-9_\-\[\]\\^{}|`]+|\*)$/i,optional:!0,noClient:!0},subCommand:{match:/^(?:LS|LIST|REQ|ACK|NAK|END|NEW|DEL)$/i},version:{match:/^\d+$/,optional:!0},continued:{match:/^\*$/,optional:!0},capabilities:{trailing:!0,optional:!0}})}isResponseTo(e){if(!(e instanceof w0))return!1;switch(this.subCommand){case"ACK":case"NAK":return e.subCommand==="REQ"&&e.capabilities===this.capabilities.trim();case"LS":case"LIST":return e.subCommand===this.subCommand;default:return!1}}endsResponseTo(e){if(!(e instanceof w0))return!1;switch(this.subCommand){case"LS":case"LIST":return!this.continued;default:return!0}}}w0.COMMAND="CAP";w0.SUPPORTS_CAPTURE=!0;class t1e extends An{constructor(e,t,r){super(e,t,r,{target:{}})}}t1e.COMMAND="TAGMSG";const n1e=Object.freeze(Object.defineProperty({__proto__:null,Away:Xbe,CapabilityNegotiation:w0,ChannelInvite:Hbe,ChannelJoin:lk,ChannelKick:qbe,ChannelList:jbe,ChannelPart:ck,ClientQuit:FG,ErrorMessage:Ybe,IsOnQuery:e1e,Kill:Wbe,Mode:Fbe,Names:I3,NickChange:K2,Notice:L6,OperLogin:Ube,Password:UG,Ping:m4,Pong:g4,PrivateMessage:uk,Rehash:Kbe,Restart:Zbe,ServerQuit:Bbe,TagMessage:t1e,Time:Vbe,Topic:zbe,UserHostQuery:Qbe,UserRegistration:BG,Wallops:Jbe,WhoIsQuery:Gbe,WhoQuery:U6,WhoWasQuery:$be},Symbol.toStringTag,{value:"Module"}));class zG extends An{constructor(e,t,r){super(e,t,r,{me:{},welcomeText:{trailing:!0}})}}zG.COMMAND="001";class r1e extends An{constructor(e,t,r){super(e,t,r,{me:{},yourHost:{trailing:!0}})}}r1e.COMMAND="002";class i1e extends An{constructor(e,t,r){super(e,t,r,{me:{},createdText:{trailing:!0}})}}i1e.COMMAND="003";class jG extends An{constructor(e,t,r){super(e,t,r,{me:{},serverName:{},version:{},userModes:{},channelModes:{},channelModesWithParam:{optional:!0}})}}jG.COMMAND="004";class HG extends An{constructor(e,t,r){super(e,t,r,{me:{},supports:{rest:!0},suffix:{trailing:!0}})}}HG.COMMAND="005";class s1e extends An{constructor(e,t,r){super(e,t,r,{me:{},modes:{}})}}s1e.COMMAND="221";class a1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},text:{trailing:!0}})}}a1e.COMMAND="301";class o1e extends An{constructor(e,t,r){super(e,t,r,{me:{},hosts:{trailing:!0}})}}o1e.COMMAND="302";class l1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}l1e.COMMAND="305";class c1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}c1e.COMMAND="306";class u1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},username:{},host:{},_unused:{},realname:{trailing:!0}})}}u1e.COMMAND="311";class f1e extends An{constructor(e,t,r){super(e,t,r,{me:{},query:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof U6}endsResponseTo(){return!0}}f1e.COMMAND="315";class h1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nickMask:{},suffix:{trailing:!0}})}}h1e.COMMAND="318";class d1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channels:{trailing:!0}})}}d1e.COMMAND="319";class p1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},memberCount:{},topic:{trailing:!0}})}}p1e.COMMAND="322";class m1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}m1e.COMMAND="323";class g1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},modes:{rest:!0}})}}g1e.COMMAND="324";class _1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}_1e.COMMAND="331";class v1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},topic:{trailing:!0}})}}v1e.COMMAND="332";class y1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},who:{},ts:{}})}}y1e.COMMAND="333";class b1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"}})}}b1e.COMMAND="341";class S1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}S1e.COMMAND="348";class E1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}E1e.COMMAND="349";class x1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},user:{},host:{},server:{},nick:{},flags:{},hopsAndRealName:{trailing:!0}})}get isAway(){return this.flags.includes("G")}get isOper(){return this.flags.includes("*")}get isBot(){return this.flags.includes("B")}isResponseTo(e){return e instanceof U6}}x1e.COMMAND="352";class T1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channelType:{},channel:{type:"channel"},names:{trailing:!0}})}isResponseTo(e){return e instanceof I3}}T1e.COMMAND="353";class w1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof I3}endsResponseTo(){return!0}}w1e.COMMAND="366";class R1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}R1e.COMMAND="367";class A1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}A1e.COMMAND="368";class C1e extends An{constructor(e,t,r){super(e,t,r,{me:{},line:{trailing:!0}})}}C1e.COMMAND="372";class M1e extends An{constructor(e,t,r){super(e,t,r,{me:{},line:{trailing:!0}})}}M1e.COMMAND="375";class qG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}qG.COMMAND="376";class O1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}O1e.COMMAND="381";class k1e extends An{constructor(e,t,r){super(e,t,r,{me:{},server:{optional:!0},timestamp:{trailing:!0}})}}k1e.COMMAND="391";class I1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}}I1e.COMMAND="401";class N1e extends An{constructor(e,t,r){super(e,t,r,{me:{},server:{},suffix:{trailing:!0}})}}N1e.COMMAND="402";class P1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}P1e.COMMAND="403";class D1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}D1e.COMMAND="404";class L1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}L1e.COMMAND="405";class U1e extends An{constructor(e,t,r){super(e,t,r,{me:{},subCommand:{},suffix:{trailing:!0}})}}U1e.COMMAND="410";class B1e extends An{constructor(e,t,r){super(e,t,r,{me:{},originalCommand:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command===this.originalCommand}endsResponseTo(){return!0}}B1e.COMMAND="421";class VG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}VG.COMMAND="422";class F1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}F1e.COMMAND="431";class z1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}z1e.COMMAND="432";class j1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}j1e.COMMAND="433";class H1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}H1e.COMMAND="436";class q1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}q1e.COMMAND="441";class V1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}V1e.COMMAND="442";class G1e extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}G1e.COMMAND="443";class $1e extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}$1e.COMMAND="451";class W1e extends An{constructor(e,t,r){super(e,t,r,{me:{},originalCommand:{},suffix:{trailing:!0}})}}W1e.COMMAND="461";class GG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}GG.COMMAND="462";class Y1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Y1e.COMMAND="471";class X1e extends An{constructor(e,t,r){super(e,t,r,{me:{},char:{},suffix:{trailing:!0}})}}X1e.COMMAND="472";class K1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}K1e.COMMAND="473";class Z1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Z1e.COMMAND="474";class J1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}J1e.COMMAND="475";class Q1e extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}Q1e.COMMAND="479";class eSe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}eSe.COMMAND="481";class tSe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}tSe.COMMAND="482";class nSe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}nSe.COMMAND="491";class rSe extends An{constructor(e,t,r){super(e,t,r,{me:{},modeChar:{optional:!0,match:/^\w$/},suffix:{trailing:!0}})}}rSe.COMMAND="501";class iSe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}iSe.COMMAND="502";const sSe=Object.freeze(Object.defineProperty({__proto__:null,Error401NoSuchNick:I1e,Error402NoSuchServer:N1e,Error403NoSuchChannel:P1e,Error404CanNotSendToChan:D1e,Error405TooManyChannels:L1e,Error410InvalidCapCmd:U1e,Error421UnknownCommand:B1e,Error422NoMotd:VG,Error431NoNickNameGiven:F1e,Error432ErroneusNickname:z1e,Error433NickNameInUse:j1e,Error436NickCollision:H1e,Error441UserNotInChannel:q1e,Error442NotOnChannel:V1e,Error443UserOnChannel:G1e,Error451NotRegistered:$1e,Error461NeedMoreParams:W1e,Error462AlreadyRegistered:GG,Error471ChannelIsFull:Y1e,Error472UnknownMode:X1e,Error473InviteOnlyChan:K1e,Error474BannedFromChan:Z1e,Error475BadChannelKey:J1e,Error479BadChanName:Q1e,Error481NoPrivileges:eSe,Error482ChanOpPrivsNeeded:tSe,Error491NoOperHost:nSe,Error501UmodeUnknownFlag:rSe,Error502UsersDontMatch:iSe,Reply001Welcome:zG,Reply002YourHost:r1e,Reply003Created:i1e,Reply004ServerInfo:jG,Reply005Isupport:HG,Reply221UmodeIs:s1e,Reply301Away:a1e,Reply302UserHost:o1e,Reply305UnAway:l1e,Reply306NowAway:c1e,Reply311WhoisUser:u1e,Reply315EndOfWho:f1e,Reply318EndOfWhois:h1e,Reply319WhoisChannels:d1e,Reply322List:p1e,Reply323ListEnd:m1e,Reply324ChannelModeIs:g1e,Reply331NoTopic:_1e,Reply332Topic:v1e,Reply333TopicWhoTime:y1e,Reply341Inviting:b1e,Reply348ExceptList:S1e,Reply349EndOfExceptList:E1e,Reply352WhoReply:x1e,Reply353NamesReply:T1e,Reply366EndOfNames:w1e,Reply367BanList:R1e,Reply368EndOfBanList:A1e,Reply372Motd:C1e,Reply375MotdStart:M1e,Reply376EndOfMotd:qG,Reply381YoureOper:O1e,Reply391Time:k1e},Symbol.toStringTag,{value:"Module"})),iyt=new Map([...Object.values(n1e),...Object.values(sSe)].map(n=>[n.COMMAND,n]));function syt(n){const[e,t]=yE(n,"!",2);if(t){const[r,i]=yE(t,"@",2);return i?{nick:e,user:r,host:i}:{nick:e,host:r}}return{nick:e}}const gae={":":";",n:`
`,r:"\r",s:" "};function ayt(n){const e=new Map,t=n.split(";");for(const r of t){const[i,s]=yE(r,"=",2);i!==""&&e.set(i,s?s.replace(/\\(.?)/g,(a,o)=>Object.prototype.hasOwnProperty.call(gae,o)?gae[o]:o):"")}return e}function oyt(n,e=$T,t=iyt,r=!1,i=[],s=!0){const a=n.split(" ");let o,l;const c=[];let u,f;for(;a.length;){if([o]=a,o.startsWith("@")&&!u&&!l&&!f)u=ayt(o.slice(1));else if(o.startsWith(":"))if(!f&&!l)o.length>1&&(f=syt(o.slice(1)));else{c.push({value:a.join(" ").slice(1),trailing:!0});break}else l?c.push({value:o,trailing:!1}):l=o.toUpperCase();a.shift()}if(u||(u=new Map),!l)throw new Error(`line without command received: ${n}`);s&&(s=!i.includes(l));let h=An;return t.has(l)&&(h=t.get(l)),new h(l,{params:c,tags:u,prefix:f,rawLine:n},{serverProperties:e,isServer:r,shouldParseParams:s})}class aSe extends O3{constructor(e){super(),this._registered=!1,this._supportsCapabilities=!0,this._events=new Map,this._registeredMessageTypes=new Map,this.onConnect=this.registerEvent(),this.onRegister=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onPrivmsg=this.registerEvent(),this.onAction=this.registerEvent(),this.onNotice=this.registerEvent(),this.onNickChange=this.registerEvent(),this.onCtcp=this.registerEvent(),this.onCtcpReply=this.registerEvent(),this.onPasswordError=this.registerEvent(),this.onAnyMessage=this.registerEvent(),this._serverProperties=X2($T),this._supportedFeatures={},this._collectors=[],this._clientCapabilities=new Map,this._serverCapabilities=new Map,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._hasRegisteredBefore=!1,this._channelsFromLastRegister=new Set,this._initialConnectionSetupDone=!1;const{connection:t,credentials:r,channels:i,channelTypes:s,webSocket:a,logger:o={}}=e;this._options=e;const{pingOnInactivity:l=60,pingTimeout:c=10}=t;this._pingOnInactivity=l,this._pingTimeout=c,this._currentNick=r.nick,this._logger=P6({name:"ircv3",emoji:!0,...o}),this.registerCoreMessageTypes();const{hostName:u,secure:f,reconnect:h=!0}=t,g={hostName:u,port:this.port,secure:f},p={lineBased:!0,logger:this._logger,additionalOptions:e.connectionOptions},_=a?zvt:Bvt;h?this._connection=new Fvt(_,g,p):this._connection=new _(p,this._logger,e.connectionOptions);for(const y of Object.values(nyt))this.addCapability(y);this.addInternalListener(this.onRegister,async()=>{const y=this._hasRegisteredBefore,v=this._channelsFromLastRegister;this._hasRegisteredBefore=!0,this._channelsFromLastRegister=new Set;const x=y&&this._options.rejoinChannelsOnReconnect?v:await Bz(i);if(x)for(const E of x)this.join(E)}),this.onTypedMessage(w0,async({subCommand:y,capabilities:v})=>{const x=v.split(" ");switch(y.toUpperCase()){case"NEW":{this._logger.debug(`Server registered new capabilities: ${x.join(", ")}`);const E=KN(x,k=>{if(!k)return{};const[N,I]=yE(k,"=",2);return{[N]:{name:N,param:I||!0}}});for(const[k,N]of Object.entries(E))this._serverCapabilities.set(k,N);const M=Object.keys(E);await this._negotiateCapabilities(Array.from(this._clientCapabilities.entries()).filter(([k])=>M.includes(k)).map(([,k])=>k));break}case"DEL":{this._logger.debug(`Server removed capabilities: ${x.join(", ")}`);for(const E of x)this._serverCapabilities.delete(E),this._negotiatedCapabilities.delete(E)}}}),this.onTypedMessage(m4,({text:y})=>{this.sendMessage(g4,{text:y})}),this.onTypedMessage(zG,({me:y})=>this._handleReceivedClientNick(y)),this.onTypedMessage(jG,({userModes:y})=>{y&&(this._serverProperties.supportedUserModes=y)}),this.onTypedMessage(HG,({supports:y})=>{const v=KN(y.split(" "),x=>{const[E,M]=yE(x,"=",2);return{[E]:M||!0}});this._supportedFeatures={...this._supportedFeatures,...v}}),this.onTypedMessage(qG,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(VG,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(GG,({me:y})=>{this._registered||(this._logger.warn("We thought we're not registered yet, but we actually are"),this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(uk,y=>{var v;const{target:x,text:E}=y,M=mae(E),k=(v=y.prefix)===null||v===void 0?void 0:v.nick;M?M.command==="ACTION"?this.emit(this.onAction,x,k,M.params,y):this.emit(this.onCtcp,x,k,M.command,M.params,y):this.emit(this.onPrivmsg,x,k,E,y)}),this.onTypedMessage(K2,y=>{var v;const{nick:x}=y,E=(v=y.prefix)===null||v===void 0?void 0:v.nick;E===this._currentNick&&(this._currentNick=x),this.emit(this.onNickChange,E,x,y)}),this.onTypedMessage(L6,y=>{var v;const{target:x,text:E}=y,M=mae(E),k=(v=y.prefix)===null||v===void 0?void 0:v.nick;M&&this.emit(this.onCtcpReply,x,k,M.command,M.params,y),this.emit(this.onNotice,x,k,E,y)}),this._options.manuallyAcknowledgeJoins||this.onTypedMessage(lk,({channel:y,prefix:v})=>{v?.nick===this._currentNick&&this.acknowledgeJoin(y)}),this.onTypedMessage(ck,y=>{var v;((v=y.prefix)===null||v===void 0?void 0:v.nick)===this._currentNick&&(this._currentChannels.delete(y.channel),this._channelsFromLastRegister.delete(y.channel))}),this.addInternalListener(this.onRegister,()=>this._startPingCheckTimer()),this._desiredNick=r.nick,this._userName=r.userName,this._realName=r.realName,s&&(this._serverProperties.channelTypes=s)}receiveLine(e){var t;this._logger.debug(`Received message: ${e}`);let r;try{r=oyt(e,this._serverProperties,this._registeredMessageTypes,!0,this._options.nonConformingCommands)}catch(i){this._logger.error(`Error parsing message: ${i.message}`),this._logger.trace((t=i.stack)!==null&&t!==void 0?t:"No stack available");return}this._logger.trace(`Parsed message: ${JSON.stringify(r)}`),this._startPingCheckTimer(),this.emit(this.onAnyMessage,r),this._handleEvents(r)}get serverProperties(){return X2(this._serverProperties)}get port(){const{webSocket:e,connection:{port:t,secure:r}}=this._options;return t||(e?r?443:80:r?6697:6667)}pingCheck(){const e=Date.now(),t=e.toString(),r=this.onTypedMessage(g4,i=>{const{text:s}=i;s===t&&(this._logger.debug(`Current ping: ${Date.now()-e}ms`),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),this.removeMessageListener(r))});this._pingTimeoutTimer=setTimeout(()=>{this.removeMessageListener(r),this._options.connection.reconnect===!1?this._logger.error(`Disconnecting because the last ping took over ${this._pingTimeout} seconds`):this._logger.warn(`Reconnecting because the last ping took over ${this._pingTimeout} seconds`),this._connection.assumeExternalDisconnect()},this._pingTimeout*1e3),this.sendMessage(m4,{text:t})}reconnect(e){this.quit(e),this.connect()}registerMessageType(e){e.COMMAND!==""&&(this._logger.trace(`Registering message type ${e.COMMAND}`),this._registeredMessageTypes.set(e.COMMAND.toUpperCase(),e))}knowsCommand(e){return this._registeredMessageTypes.has(e.toUpperCase())}getCommandClass(e){return this._registeredMessageTypes.get(e.toUpperCase())}acknowledgeJoin(e){this._currentChannels.add(e),this._channelsFromLastRegister.add(e)}connect(){this._supportsCapabilities=!1,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._currentNick=this._desiredNick,this._setupConnection(),this._logger.info(`Connecting to ${this._options.connection.hostName}:${this.port}`),this._connection.connect()}addCapability(e){if(this._clientCapabilities.set(e.name,e),e.messageTypes)for(const t of Object.values(e.messageTypes))this.registerMessageType(t)}async registerCapability(e){return this.addCapability(e),this._serverCapabilities.has(e.name)?await this._negotiateCapabilities([e]):[]}send(e){this.sendRaw(e.toString())}sendRaw(e){this._connection.isConnected&&(this._logger.debug(`Sending message: ${e}`),this._connection.sendLine(e))}onNamedMessage(e,t,r){this._events.has(e)||this._events.set(e,new Map);const i=this._events.get(e);if(!r)do r=`${e}:${tvt(Math.random()*1e4,4,"0")}`;while(i.has(r));return i.set(r,t),r}onTypedMessage(e,t,r){return this.onNamedMessage(e.COMMAND,t,r)}removeMessageListener(e){const[t]=e.split(":");this._events.has(t)&&this._events.get(t).delete(e)}createMessage(e,t,r){const i=r?new Map(Object.entries(r)):void 0;return Yvt(e,t,void 0,i,this.serverProperties)}sendMessage(e,t,r){this.send(this.createMessage(e,t,r))}async sendMessageAndCaptureReply(e,t){if(!e.SUPPORTS_CAPTURE)throw new Error(`The command "${e.COMMAND}" does not support reply capture`);const r=this.createMessage(e,t),i=this.collect(r).promise();return this.send(r),await i}get isConnected(){return this._connection.isConnected}get isConnecting(){return this._connection.isConnecting}get isRegistered(){return this._registered}get currentNick(){return this._currentNick}get currentChannels(){return Array.from(this._currentChannels)}collect(e,...t){const r=new ryt(this,e,...t);return this._collectors.push(r),r}stopCollect(e){this._collectors.splice(this._collectors.findIndex(t=>t===e),1)}join(e,t){this.sendMessage(lk,{channel:e,key:t})}part(e){this.sendMessage(ck,{channel:e})}quit(e){this.sendMessage(FG,{text:e}),this.quitAbruptly()}quitAbruptly(){this._registered=!1,this._connection.disconnect()}say(e,t,r={}){this.sendMessage(uk,{target:e,text:t},r)}sendCtcp(e,t,r){this.say(e,`${t.toUpperCase()} ${r}`)}action(e,t){this.sendCtcp(e,"ACTION",t)}changeNick(e){this._currentNick!==e&&(this._desiredNick=e,this.isRegistered&&this.sendMessage(K2,{nick:e}))}registerCoreMessageTypes(){Fz(n1e,e=>{this.registerMessageType(e)}),Fz(sSe,e=>{this.registerMessageType(e)})}async _negotiateCapabilityBatch(e){return await Promise.all(e.filter(t=>t.length).map(async t=>await this._negotiateCapabilities(t)))}async _negotiateCapabilities(e){const t=KN(e,a=>({[a.name]:a})),i=(await this.sendMessageAndCaptureReply(w0,{subCommand:"REQ",capabilities:e.map(a=>a.name).join(" ")})).shift();if(!i)throw new Error("capability negotiation failed unexpectedly without any reply");if(!(i instanceof w0))throw new Error(`capability negotiation failed unexpectedly with "${i.command}" command`);const s=i.capabilities.split(" ").filter(a=>a);if(i.subCommand==="ACK"){this._logger.debug(`Successfully negotiated capabilities: ${s.join(", ")}`);const a=s.map(o=>t[o]);for(const o of a){const l=this._clientCapabilities.get(o.name);l.param=o.param,this._negotiatedCapabilities.set(l.name,l)}return a}return this._logger.warn(`Failed to negotiate capabilities: ${s.join(", ")}`),new Error("capabilities failed to negotiate")}_setupConnection(){this._initialConnectionSetupDone||(this._connection.onConnect(async()=>{var e,t;this._logger.info(`Connection to server ${this._options.connection.hostName}:${this.port} established`),this.emit(this.onConnect),this._logger.debug("Determining connection password");try{const[r]=await Promise.all([Bz(this._options.credentials.password),this.sendMessageAndCaptureReply(w0,{subCommand:"LS",version:"302"}).then(async i=>{if(!i.length||!(i[0]instanceof w0))return this._logger.debug("Server does not support capabilities"),[];this._supportsCapabilities=!0;const s=i.map(o=>KN(o.capabilities.split(" "),l=>{if(!l)return{};const[c,u]=yE(l,"=",2);return{[c]:{name:c,param:u||!0}}}));this._serverCapabilities=new Map(Object.entries(Object.assign({},...s))),this._logger.debug(`Capabilities supported by server: ${Array.from(this._serverCapabilities.keys()).join(", ")}`);const a=s.map(o=>{const l=Object.keys(o);return Array.from(this._clientCapabilities.entries()).filter(([c])=>l.includes(c)).map(([,c])=>c)});return await this._negotiateCapabilityBatch(a)}).then(()=>{this.sendMessage(w0,{subCommand:"END"})})]);r&&this.sendMessage(UG,{password:r}),this.sendMessage(K2,{nick:this._desiredNick}),this.sendMessage(BG,{user:(e=this._userName)!==null&&e!==void 0?e:this._desiredNick,mode:"8",unused:"*",realName:(t=this._realName)!==null&&t!==void 0?t:this._desiredNick})}catch(r){this.emit(this.onPasswordError,r),this.quit()}}),this._initialConnectionSetupDone=!0,this._connection.onReceive(e=>{this.receiveLine(e)}),this._connection.onDisconnect((e,t)=>{var r;if(this._registered=!1,this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),e)this._logger.info("Disconnected");else{const i=(r=this._options.connection.reconnect)!==null&&r!==void 0?r:!0,s=t?`Disconnected unexpectedly: ${t.message}`:"Disconnected unexpectedly";i?this._logger.warn(`${s}; trying to reconnect`):this._logger.error(s)}this.emit(this.onDisconnect,e,t)}),this._connection.onEnd(e=>{e||this._logger.warn("No further retries will be made")}))}_handleReceivedClientNick(e){this._currentNick!==e&&(this._currentNick!==""&&this._logger.warn(`Mismatching nicks: passed ${this._currentNick}, but you're actually ${e}`),this._currentNick=e)}_handleEvents(e){this._collectors.some(r=>r.collect(e));const t=this._events.get(e.constructor.COMMAND);if(t)for(const r of t.values())r(e)}_startPingCheckTimer(){this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._connection.isConnected?this._pingCheckTimer=setTimeout(()=>this.pingCheck(),this._pingOnInactivity*1e3):this._pingCheckTimer=void 0}}rl([oS(!1)],aSe.prototype,"_options",void 0);class $G extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},user:{trailing:!0,optional:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get channelId(){return this._tags.get("room-id")}get targetUserId(){var e;return(e=this._tags.get("target-user-id"))!==null&&e!==void 0?e:null}}$G.COMMAND="CLEARCHAT";class oSe extends An{}oSe.COMMAND="RECONNECT";class WG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"}})}}WG.COMMAND="ROOMSTATE";function lyt(n){switch(typeof n){case"undefined":return"";case"object":{if(n===null)return"";if("cacheKey"in n)return n.cacheKey;const e=JSON.stringify(n);if(e!=="{}")return e}default:return n.toString()}}function lSe(n,e,t){return[n,...e.map(lyt)].join("/")+(t?"/":"")}const Py=Symbol("cache");function cyt(n){var e,t;return t=class extends n{constructor(){super(...arguments),this[e]=new Map}getFromCache(r){if(this._cleanCache(),this[Py].has(r)){const i=this[Py].get(r);if(i)return i.value}}setCache(r,i,s){this[Py].set(r,{value:i,expires:Date.now()+s*1e3})}removeFromCache(r,i){const s=this._getInternalCacheKey(r,i);i?this[Py].forEach((a,o)=>{o.startsWith(s)&&this[Py].delete(o)}):this[Py].delete(s)}_cleanCache(){const r=Date.now();this[Py].forEach((i,s)=>{i.expires<r&&this[Py].delete(s)})}_getInternalCacheKey(r,i){if(typeof r=="string"){let s=r;return s.endsWith("/")||(s+="/"),s}else{const s=r.shift();return lSe(s,r,i)}}},e=Py,t}function cSe(n=1/0){return function(e,t,r){if(r.get){const i=r.get;r.get=function(){const s=lSe(t,[]),a=this.getFromCache(s);if(a)return a;const o=i.call(this);return this.setCache(s,o,n),o}}return r}}var VP;let H1=VP=class{constructor(e,t){this._userName=e.toLowerCase(),this._userData=t?new Map(t):new Map}static _parseBadgesLike(e){return e?new Map(e.split(",").map(t=>{const r=t.indexOf("/");return r===-1?[t,""]:[t.slice(0,r),t.slice(r+1)]})):new Map}get userName(){return this._userName}get displayName(){var e;return(e=this._userData.get("display-name"))!==null&&e!==void 0?e:this._userName}get color(){return this._userData.get("color")}get badges(){const e=this._userData.get("badges");return VP._parseBadgesLike(e)}get badgeInfo(){const e=this._userData.get("badge-info");return VP._parseBadgesLike(e)}get userId(){return this._userData.get("user-id")}get userType(){return this._userData.get("user-type")}get isBroadcaster(){return this.badges.has("broadcaster")}get isSubscriber(){return this.badges.has("subscriber")||this.isFounder}get isFounder(){return this.badges.has("founder")}get isMod(){return this.badges.has("moderator")}get isVip(){const e=this._userData.get("vip");return e!=null&&e!=="0"}get isArtist(){return this.badges.has("artist-badge")}};rl([oS(!1)],H1.prototype,"_userData",void 0);rl([cSe()],H1.prototype,"badges",null);rl([cSe()],H1.prototype,"badgeInfo",null);H1=VP=rl([cyt,k3("chat","ChatUser","userId")],H1);function YG(n){return n?new Map(n.split("/").map(e=>{const[t,r]=e.split(":",2);return r?[t,r.split(",")]:null}).filter(e=>e!==null)):new Map}class XG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},text:{trailing:!0,optional:!0}})}get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new H1(this._tags.get("login"),this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get emoteOffsets(){return YG(this._tags.get("emotes"))}}XG.COMMAND="USERNOTICE";class uSe extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"}})}}uSe.COMMAND="USERSTATE";class KG extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}get userInfo(){return new H1(this._prefix.nick,this._tags)}get emoteOffsets(){return YG(this._tags.get("emotes"))}}KG.COMMAND="WHISPER";const uyt={name:"twitch.tv/commands",messageTypes:[$G,oSe,WG,XG,uSe,KG]},fyt={name:"twitch.tv/membership"};class ZG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},text:{trailing:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userName(){return this._tags.get("login")}get channelId(){return this._tags.get("room-id")}get targetMessageId(){return this._tags.get("target-msg-id")}}ZG.COMMAND="CLEARMSG";class fSe extends An{}fSe.COMMAND="GLOBALUSERSTATE";const hyt={name:"twitch.tv/tags",messageTypes:[fSe,ZG]},dyt=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN"];let _4=class extends uk{get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new H1(this._prefix.nick,this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get isCheer(){return this._tags.has("bits")}get isRedemption(){return!!this._tags.get("custom-reward-id")}get rewardId(){return this._tags.get("custom-reward-id")||null}get isFirst(){return this._tags.get("first-msg")==="1"}get isReturningChatter(){return this._tags.get("returning-chatter")==="1"}get isHighlight(){return this._tags.get("msg-id")==="highlighted-message"}get isReply(){return this._tags.has("reply-parent-msg-id")}get parentMessageId(){var e;return(e=this._tags.get("reply-parent-msg-id"))!==null&&e!==void 0?e:null}get parentMessageText(){var e;return(e=this._tags.get("reply-parent-msg-body"))!==null&&e!==void 0?e:null}get parentMessageUserId(){var e;return(e=this._tags.get("reply-parent-user-id"))!==null&&e!==void 0?e:null}get parentMessageUserName(){var e;return(e=this._tags.get("reply-parent-user-login"))!==null&&e!==void 0?e:null}get parentMessageUserDisplayName(){var e;return(e=this._tags.get("reply-parent-display-name"))!==null&&e!==void 0?e:null}get threadMessageId(){var e;return(e=this._tags.get("reply-thread-parent-msg-id"))!==null&&e!==void 0?e:null}get threadMessageUserId(){var e;return(e=this._tags.get("reply-thread-parent-user-id"))!==null&&e!==void 0?e:null}get bits(){var e;return Number((e=this._tags.get("bits"))!==null&&e!==void 0?e:0)}get emoteOffsets(){return YG(this._tags.get("emotes"))}get isHypeChat(){return this._tags.has("pinned-chat-paid-amount")}get hypeChatAmount(){return ak(this._tags.get("pinned-chat-paid-amount"),Number)}get hypeChatDecimalPlaces(){return ak(this._tags.get("pinned-chat-paid-exponent"),Number)}get hypeChatLocalizedAmount(){const e=this.hypeChatAmount;return e?e/10**this.hypeChatDecimalPlaces:null}get hypeChatCurrency(){var e;return(e=this._tags.get("pinned-chat-paid-currency"))!==null&&e!==void 0?e:null}get hypeChatLevel(){const e=this._tags.get("pinned-chat-paid-level");return e?dyt.indexOf(e)+1:null}get hypeChatIsSystemMessage(){const e=this._tags.get("pinned-chat-paid-is-system-message");return e?!!Number(e):null}};_4=rl([k3("chat","ChatMessage","id")],_4);function pyt(n){return n instanceof _4?n.tags.get("id"):n}function _ae(n,e){if(n.length<=e)return[n];n=n.trim();const t=[];let r=0,i=e;for(;r<n.length;){let s=n.lastIndexOf(" ",i);(s===-1||s<=r||n.length-r+1<=e)&&(s=r+e);const a=n.slice(r,s).trim();a.length&&t.push(a),r=s+(n[s]===" "?1:0),i=r+e}return t}const myt=/^[a-z0-9][a-z0-9_]{0,24}$/;function Hf(n){const e=n.replace(/^#/,"").toLowerCase();if(!myt.test(e))throw new Error(`"${e}" is not a valid user or channel name. It must be at most 25 characters long, can only include letters, numbers and underscores, and can not start with an underscore.`);return e}function ZN(n){return`#${Hf(n)}`}var Vz;let v4=Vz=class extends O3{constructor(e={}){var t,r,i,s,a,o,l;if(e.authProvider&&!e.authProvider.getAccessTokenForIntent)throw new HP("You can not connect to chat using an AuthProvider that does not support intents.\nTo get an anonymous, read-only connection, please don't pass an `AuthProvider` at all.\nTo get a read-write connection, please provide an auth provider that provides user access tokens via intents, such as `RefreshingAuthProvider`.");super(),this._authVerified=!1,this._authRetryCount=0,this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onTimeout=this.registerEvent(),this.onBan=this.registerEvent(),this.onBitsBadgeUpgrade=this.registerEvent(),this.onChatClear=this.registerEvent(),this.onEmoteOnly=this.registerEvent(),this.onFollowersOnly=this.registerEvent(),this.onJoin=this.registerEvent(),this.onJoinFailure=this.registerEvent(),this.onPart=this.registerEvent(),this.onMessageRemove=this.registerEvent(),this.onUniqueChat=this.registerEvent(),this.onRaid=this.registerEvent(),this.onRaidCancel=this.registerEvent(),this.onRitual=this.registerEvent(),this.onSlow=this.registerEvent(),this.onSubsOnly=this.registerEvent(),this.onSub=this.registerEvent(),this.onResub=this.registerEvent(),this.onSubGift=this.registerEvent(),this.onCommunitySub=this.registerEvent(),this.onSubExtend=this.registerEvent(),this.onRewardGift=this.registerEvent(),this.onPrimePaidUpgrade=this.registerEvent(),this.onGiftPaidUpgrade=this.registerEvent(),this.onPrimeCommunityGift=this.registerEvent(),this.onStandardPayForward=this.registerEvent(),this.onCommunityPayForward=this.registerEvent(),this.onAnnouncement=this.registerEvent(),this.onWhisper=this.registerEvent(),this.onNoPermission=this.registerEvent(),this.onMessageRatelimit=this.registerEvent(),this.onAuthenticationSuccess=this.registerEvent(),this.onAuthenticationFailure=this.registerEvent(),this.onTokenFetchFailure=this.registerEvent(),this.onMessageFailed=this.registerEvent(),this.onMessage=this.registerEvent(),this.onAction=this.registerEvent(),this._onJoinResult=this.registerInternalEvent(),this._ircClient=new aSe({connection:{hostName:(t=e.hostName)!==null&&t!==void 0?t:!((r=e.webSocket)!==null&&r!==void 0)||r?"irc-ws.chat.twitch.tv":"irc.chat.twitch.tv",secure:(i=e.ssl)!==null&&i!==void 0?i:!0},credentials:{nick:"",password:async()=>await this._getAuthToken()},webSocket:(s=e.webSocket)!==null&&s!==void 0?s:!0,connectionOptions:e.connectionOptions,logger:{name:"twurple:chat:irc",...e.logger},nonConformingCommands:["004"],manuallyAcknowledgeJoins:!0,rejoinChannelsOnReconnect:e.rejoinChannelsOnReconnect}),this._ircClient.onDisconnect((c,u)=>{var f,h,g,p;(f=this._messageRateLimiter)===null||f===void 0||f.clear(),(h=this._messageRateLimiter)===null||h===void 0||h.pause(),(g=this._joinRateLimiter)===null||g===void 0||g.clear(),(p=this._joinRateLimiter)===null||p===void 0||p.pause(),this.emit(this.onDisconnect,c,u)}),this._ircClient.registerMessageType(_4),this._chatLogger=P6({name:"twurple:chat:twitch",...e.logger}),this._authProvider=e.authProvider,this._useLegacyScopes=!!e.legacyScopes,this._readOnly=!!e.readOnly,this._authIntents=[...(a=e.authIntents)!==null&&a!==void 0?a:[],"chat"],this._isAlwaysMod=(o=e.isAlwaysMod)!==null&&o!==void 0?o:!1,this._botLevel=(l=e.botLevel)!==null&&l!==void 0?l:"none",this._ircClient.addCapability(hyt),this._ircClient.addCapability(uyt),e.requestMembershipEvents&&this._ircClient.addCapability(fyt),this._ircClient.onConnect(()=>{this.emit(this.onConnect)}),this._ircClient.onRegister(async()=>{var c,u;(c=this._messageRateLimiter)===null||c===void 0||c.resume(),(u=this._joinRateLimiter)===null||u===void 0||u.resume(),this._authVerified=!0,this._authRetryTimer=void 0,this._authRetryCount=0,this.emit(this.onAuthenticationSuccess);const f=await Bz(e.channels);f&&await Promise.all(f.map(async h=>{var g;try{await this.join(h)}catch(p){this._chatLogger.warn(`Failed to join configured channel ${h}; original message: ${(g=p?.message)!==null&&g!==void 0?g:p}`)}}))}),this._ircClient.onPasswordError(c=>{this._chatLogger.error(`Error fetching a token for connecting to the server: ${c.message}`),this.emit(this.onTokenFetchFailure,c)}),this._ircClient.onPrivmsg((c,u,f,h)=>{u!=="jtv"&&this.emit(this.onMessage,Hf(c),u,f,h)}),this._ircClient.onAction((c,u,f,h)=>{this.emit(this.onAction,Hf(c),u,f,h)}),this.addInternalListener(this._onJoinResult,(c,u,f)=>{f?this.emit(this.onJoinFailure,Hf(c),f):this._ircClient.acknowledgeJoin(c)}),this._ircClient.onTypedMessage($G,c=>{const{channel:u,user:f,tags:h}=c,g=Hf(u);if(f){const p=h.get("ban-duration");p===void 0?this.emit(this.onBan,g,f,c):this.emit(this.onTimeout,g,f,Number(p),c)}else this.emit(this.onChatClear,g,c)}),this._ircClient.onTypedMessage(ZG,c=>{const{channel:u,targetMessageId:f}=c;this.emit(this.onMessageRemove,Hf(u),f,c)}),this._ircClient.onTypedMessage(lk,({prefix:c,channel:u})=>{this.emit(this.onJoin,Hf(u),c.nick)}),this._ircClient.onTypedMessage(ck,({prefix:c,channel:u})=>{this.emit(this.onPart,Hf(u),c.nick)}),this._ircClient.onTypedMessage(WG,({channel:c,tags:u})=>{let f=!1;if(u.has("subs-only")&&u.has("slow")&&(this.emit(this._onJoinResult,c,u),f=!0),!f){const h=Hf(c);if(u.has("slow")){const g=Number(u.get("slow"));g?this.emit(this.onSlow,h,!0,g):this.emit(this.onSlow,h,!1)}if(u.has("followers-only")){const g=Number(u.get("followers-only"));g===-1?this.emit(this.onFollowersOnly,h,!1):this.emit(this.onFollowersOnly,h,!0,g)}}}),this._ircClient.onTypedMessage(XG,c=>{const{channel:u,text:f,tags:h}=c,g=h.get("msg-id"),p=Hf(u);switch(g){case"sub":case"resub":{const _=g==="sub"?this.onSub:this.onResub,y=h.get("msg-param-sub-plan"),v=h.get("msg-param-streak-months"),x={userId:h.get("user-id"),displayName:h.get("display-name"),plan:y,planName:h.get("msg-param-sub-plan-name"),isPrime:y==="Prime",months:Number(h.get("msg-param-cumulative-months")),streak:v?Number(v):void 0,message:f};if(h.get("msg-param-was-gifted")==="true"){const M=h.get("msg-param-anon-gift")==="true",k=Number(h.get("msg-param-gift-months")),N=Number(h.get("msg-param-gift-month-being-redeemed"));M?x.originalGiftInfo={anonymous:!0,duration:k,redeemedMonth:N}:x.originalGiftInfo={anonymous:!1,duration:k,redeemedMonth:N,userId:h.get("msg-param-gifter-id"),userName:h.get("msg-param-gifter-login"),userDisplayName:h.get("msg-param-gifter-name")}}this.emit(_,p,h.get("login"),x,c);break}case"subgift":{const _=h.get("msg-param-sub-plan"),y=h.get("login"),v=y==="ananonymousgifter",x={userId:h.get("msg-param-recipient-id"),displayName:h.get("msg-param-recipient-display-name"),gifter:v?void 0:y,gifterUserId:v?void 0:h.get("user-id"),gifterDisplayName:v?void 0:h.get("display-name"),gifterGiftCount:v?void 0:Number(h.get("msg-param-sender-count")),giftDuration:Number(h.get("msg-param-gift-months")),plan:_,planName:h.get("msg-param-sub-plan-name"),isPrime:_==="Prime",months:Number(h.get("msg-param-months"))};this.emit(this.onSubGift,p,h.get("msg-param-recipient-user-name"),x,c);break}case"submysterygift":{const _=h.get("login"),y=_==="ananonymousgifter",v={gifter:y?void 0:_,gifterUserId:y?void 0:h.get("user-id"),gifterDisplayName:y?void 0:h.get("display-name"),gifterGiftCount:y?void 0:Number(h.get("msg-param-sender-count")),count:Number(h.get("msg-param-mass-gift-count")),plan:h.get("msg-param-sub-plan")};this.emit(this.onCommunitySub,p,h.get("login"),v,c);break}case"primepaidupgrade":{const _={userId:h.get("user-id"),displayName:h.get("display-name"),plan:h.get("msg-param-sub-plan")};this.emit(this.onPrimePaidUpgrade,p,h.get("login"),_,c);break}case"giftpaidupgrade":{const _={userId:h.get("user-id"),displayName:h.get("display-name"),gifter:h.get("msg-param-sender-login"),gifterDisplayName:h.get("msg-param-sender-name")};this.emit(this.onGiftPaidUpgrade,p,h.get("login"),_,c);break}case"standardpayforward":{const _=h.get("msg-param-prior-gifter-anonymous")==="true",y={userId:h.get("user-id"),displayName:h.get("display-name"),originalGifterUserId:_?void 0:h.get("msg-param-prior-gifter-id"),originalGifterDisplayName:_?void 0:h.get("msg-param-prior-gifter-display-name"),recipientUserId:h.get("msg-param-recipient-id"),recipientDisplayName:h.get("msg-param-recipient-display-name")};this.emit(this.onStandardPayForward,p,h.get("login"),y,c);break}case"communitypayforward":{const _=h.get("msg-param-prior-gifter-anonymous")==="true",y={userId:h.get("user-id"),displayName:h.get("display-name"),originalGifterUserId:_?void 0:h.get("msg-param-prior-gifter-id"),originalGifterDisplayName:_?void 0:h.get("msg-param-prior-gifter-display-name")};this.emit(this.onCommunityPayForward,p,h.get("login"),y,c);break}case"primecommunitygiftreceived":{const _={name:h.get("msg-param-gift-name"),gifter:h.get("login"),gifterDisplayName:h.get("display-name")};this.emit(this.onPrimeCommunityGift,p,h.get("msg-param-recipient"),_,c);break}case"raid":{const _={displayName:h.get("msg-param-displayName"),viewerCount:Number(h.get("msg-param-viewerCount"))};this.emit(this.onRaid,p,h.get("login"),_,c);break}case"unraid":{this.emit(this.onRaidCancel,p,c);break}case"ritual":{const _={ritualName:h.get("msg-param-ritual-name"),message:f};this.emit(this.onRitual,p,h.get("login"),_,c);break}case"bitsbadgetier":{const _={displayName:h.get("display-name"),threshold:Number(h.get("msg-param-threshold"))};this.emit(this.onBitsBadgeUpgrade,p,h.get("login"),_,c);break}case"extendsub":{const _={userId:h.get("user-id"),displayName:h.get("display-name"),plan:h.get("msg-param-sub-plan"),months:Number(h.get("msg-param-cumulative-months")),endMonth:Number(h.get("msg-param-sub-benefit-end-month"))};this.emit(this.onSubExtend,p,h.get("login"),_,c);break}case"rewardgift":{const _={domain:h.get("msg-param-domain"),gifterId:h.get("user-id"),gifterDisplayName:h.get("display-name"),count:Number(h.get("msg-param-selected-count")),gifterGiftCount:Number(h.get("msg-param-total-reward-count")),triggerType:h.get("msg-param-trigger-type")};this.emit(this.onRewardGift,p,h.get("login"),_,c);break}case"announcement":{const _={color:h.get("msg-param-color")};this.emit(this.onAnnouncement,p,h.get("login"),_,c);break}default:this._chatLogger.warn(`Unrecognized usernotice ID: ${g}`)}}),this._ircClient.onTypedMessage(KG,c=>{this.emit(this.onWhisper,c.prefix.nick,c.text,c)}),this._ircClient.onTypedMessage(L6,async({target:c,text:u,tags:f})=>{const h=f.get("msg-id");switch(h){case"emote_only_on":{this.emit(this.onEmoteOnly,Hf(c),!0);break}case"emote_only_off":{this.emit(this.onEmoteOnly,Hf(c),!1);break}case"msg_channel_suspended":case"msg_banned":{this.emit(this._onJoinResult,c,void 0,h);break}case"r9k_on":{this.emit(this.onUniqueChat,Hf(c),!0);break}case"r9k_off":{this.emit(this.onUniqueChat,Hf(c),!1);break}case"subs_on":{this.emit(this.onSubsOnly,Hf(c),!0);break}case"subs_off":{this.emit(this.onSubsOnly,Hf(c),!1);break}case"cmds_available":break;case"followers_on":case"followers_on_zero":case"followers_off":case"slow_on":case"slow_off":break;case"timeout_success":break;case"unrecognized_cmd":break;case"no_permission":{this.emit(this.onNoPermission,Hf(c),u);break}case"msg_ratelimit":{this.emit(this.onMessageRatelimit,Hf(c),u);break}case"msg_duplicate":case"msg_emoteonly":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_subsonly":case"msg_slowmode":case"msg_r9k":case"msg_verified_email":case"msg_timedout":case"msg_rejected_mandatory":case"msg_channel_blocked":{this.emit(this.onMessageFailed,Hf(c),h);break}case void 0:{if(u==="Login authentication failed"||u==="Improperly formatted AUTH"||u==="Invalid NICK"){this._authVerified=!1,this._authRetryTimer||(this._authRetryTimer=Ebe(120),this._authRetryCount=0);const g=this._authRetryTimer.next().value,p=++this._authRetryCount;this.emit(this.onAuthenticationFailure,u,p),g!==0&&this._chatLogger.info(`Retrying authentication in ${g} seconds`),await evt(g*1e3),this._ircClient.reconnect()}break}default:h.startsWith("usage_")||this._chatLogger.warn(`Unrecognized notice ID: '${h}'`)}})}connect(){this._authProvider||this._ircClient.changeNick(Vz._generateJustinfanNick()),this._initializeRateLimiters(),this._ircClient.connect()}get irc(){return this._ircClient}get isConnected(){return this._ircClient.isConnected}get isConnecting(){return this._ircClient.isConnecting}get currentChannels(){return this._ircClient.currentChannels}async say(e,t,r={},i){const s={};r.replyTo&&(s["reply-parent-msg-id"]=pyt(r.replyTo));const a=_ae(t,500);await Promise.all(a.map(async o=>await this._messageRateLimiter.request({type:"say",channel:ZN(e),text:o,tags:s},i)))}async action(e,t,r){const i=_ae(t,490);await Promise.all(i.map(async s=>await this._messageRateLimiter.request({type:"action",channel:ZN(e),text:s},r)))}async join(e){await this._joinRateLimiter.request(ZN(e))}part(e){this._ircClient.part(ZN(e))}quit(){var e,t,r,i;(t=(e=this._messageRateLimiter)===null||e===void 0?void 0:e.destroy)===null||t===void 0||t.call(e),(i=(r=this._joinRateLimiter)===null||r===void 0?void 0:r.destroy)===null||i===void 0||i.call(r),this._messageRateLimiter=void 0,this._joinRateLimiter=void 0,this._ircClient.quitAbruptly()}reconnect(){this.quit(),this.connect()}async _getAuthToken(){var e,t;if(!this._authProvider){this._chatLogger.debug("No authProvider given; connecting anonymously");return}if(this._authToken&&!jP(this._authToken)&&this._authVerified)return this._chatLogger.debug("AccessToken assumed to be correct from last connection"),`oauth:${this._authToken.accessToken}`;const r=this._getNecessaryScopes();let i,s=!1;for(const a of this._authIntents){try{if(this._authToken=await this._authProvider.getAccessTokenForIntent(a,r),!this._authToken)continue;s=!0;const o=await ok(this._authToken.accessToken);if(!o.userName)throw new HP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}catch(o){o instanceof GT?i=o:this._chatLogger.error(`Retrieving an access token failed: ${o.message}`)}this._chatLogger.warn("No valid token available; trying to refresh");try{if(this._authToken=await((t=(e=this._authProvider).refreshAccessTokenForIntent)===null||t===void 0?void 0:t.call(e,a)),this._authToken){const o=await ok(this._authToken.accessToken);if(!o.userName)throw new HP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}}catch(o){o instanceof GT?i=o:this._chatLogger.error(`Refreshing the access token failed: ${o.message}`)}}throw this._authVerified=!1,i??new Error(s?"Could not retrieve a valid token":`None of the queried intents (${this._authIntents.join(", ")}) are known by the auth provider${this._authProvider instanceof j1?".\nPlease add one of these to the user you want to connect with using the `addIntentToUser` method or the additional parameter to `addUser` or `addUserForToken`.":""}`)}_getNecessaryScopes(){return this._useLegacyScopes?["chat_login"]:this._readOnly?["chat:read"]:["chat:read","chat:edit"]}static _generateJustinfanNick(){return`justinfan${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}`}_initializeRateLimiters(){const e=async({type:r,text:i,channel:s,tags:a})=>{r==="say"?this._ircClient.say(s,i,a):this._ircClient.action(s,i)},t=async r=>{const{promise:i,resolve:s,reject:a}=zz();let o;const l=this.addInternalListener(this._onJoinResult,(c,u,f)=>{c===r&&(clearTimeout(o),f?a(f):s(),this.removeListener(l))});o=setTimeout(()=>{this.removeListener(l),this.emit(this._onJoinResult,r,void 0,"twurple_timeout"),a(new Error(`Did not receive a reply to join ${r} in time; assuming that the join failed`))},1e4),this._ircClient.join(r),await i};if(this._isAlwaysMod)this._messageRateLimiter=new jz({bucketSize:this._botLevel==="verified"?7500:100,timeFrame:32e3,doRequest:e});else{let r=20;this._botLevel==="verified"?r=7500:this._botLevel==="known"&&(r=50),this._messageRateLimiter=new hvt(new fvt({bucketSize:1,timeFrame:1200,logger:{minLevel:ni.ERROR},doRequest:e,getPartitionKey:({channel:i})=>i}),{bucketSize:r,timeFrame:32e3})}this._joinRateLimiter=new jz({bucketSize:this._botLevel==="verified"?2e3:20,timeFrame:11e3,doRequest:t}),this._messageRateLimiter.pause(),this._joinRateLimiter.pause()}};rl([oS(!1)],v4.prototype,"_authProvider",void 0);v4=Vz=rl([k3("chat","ChatClient")],v4);var g7={exports:{}},vae;function gyt(){return vae||(vae=1,(function(n,e){(function(t,r){n.exports=r()})(self,(()=>(()=>{var t={2505:(a,o,l)=>{a.exports=l(8015)},5592:(a,o,l)=>{var c=l(9516),u=l(7522),f=l(3948),h=l(9106),g=l(9615),p=l(2012),_=l(4202),y=l(4896),v=l(5845),x=l(8563),E=l(5656);a.exports=function(M){return new Promise((function(k,N){var I,D=M.data,V=M.headers,G=M.responseType;function J(){M.cancelToken&&M.cancelToken.unsubscribe(I),M.signal&&M.signal.removeEventListener("abort",I)}c.isFormData(D)&&c.isStandardBrowserEnv()&&delete V["Content-Type"];var B=new XMLHttpRequest;if(M.auth){var $=M.auth.username||"",U=M.auth.password?unescape(encodeURIComponent(M.auth.password)):"";V.Authorization="Basic "+btoa($+":"+U)}var Q=g(M.baseURL,M.url);function W(){if(B){var ae="getAllResponseHeaders"in B?p(B.getAllResponseHeaders()):null,Z={data:G&&G!=="text"&&G!=="json"?B.response:B.responseText,status:B.status,statusText:B.statusText,headers:ae,config:M,request:B};u((function(K){k(K),J()}),(function(K){N(K),J()}),Z),B=null}}if(B.open(M.method.toUpperCase(),h(Q,M.params,M.paramsSerializer),!0),B.timeout=M.timeout,"onloadend"in B?B.onloadend=W:B.onreadystatechange=function(){B&&B.readyState===4&&(B.status!==0||B.responseURL&&B.responseURL.indexOf("file:")===0)&&setTimeout(W)},B.onabort=function(){B&&(N(new v("Request aborted",v.ECONNABORTED,M,B)),B=null)},B.onerror=function(){N(new v("Network Error",v.ERR_NETWORK,M,B,B)),B=null},B.ontimeout=function(){var ae=M.timeout?"timeout of "+M.timeout+"ms exceeded":"timeout exceeded",Z=M.transitional||y;M.timeoutErrorMessage&&(ae=M.timeoutErrorMessage),N(new v(ae,Z.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,M,B)),B=null},c.isStandardBrowserEnv()){var q=(M.withCredentials||_(Q))&&M.xsrfCookieName?f.read(M.xsrfCookieName):void 0;q&&(V[M.xsrfHeaderName]=q)}"setRequestHeader"in B&&c.forEach(V,(function(ae,Z){D===void 0&&Z.toLowerCase()==="content-type"?delete V[Z]:B.setRequestHeader(Z,ae)})),c.isUndefined(M.withCredentials)||(B.withCredentials=!!M.withCredentials),G&&G!=="json"&&(B.responseType=M.responseType),typeof M.onDownloadProgress=="function"&&B.addEventListener("progress",M.onDownloadProgress),typeof M.onUploadProgress=="function"&&B.upload&&B.upload.addEventListener("progress",M.onUploadProgress),(M.cancelToken||M.signal)&&(I=function(ae){B&&(N(!ae||ae&&ae.type?new x:ae),B.abort(),B=null)},M.cancelToken&&M.cancelToken.subscribe(I),M.signal&&(M.signal.aborted?I():M.signal.addEventListener("abort",I))),D||(D=null);var Y=E(Q);Y&&["http","https","file"].indexOf(Y)===-1?N(new v("Unsupported protocol "+Y+":",v.ERR_BAD_REQUEST,M)):B.send(D)}))}},8015:(a,o,l)=>{var c=l(9516),u=l(9012),f=l(5155),h=l(5343),g=(function p(_){var y=new f(_),v=u(f.prototype.request,y);return c.extend(v,f.prototype,y),c.extend(v,y),v.create=function(x){return p(h(_,x))},v})(l(7412));g.Axios=f,g.CanceledError=l(8563),g.CancelToken=l(3191),g.isCancel=l(3864),g.VERSION=l(9641).version,g.toFormData=l(6440),g.AxiosError=l(5845),g.Cancel=g.CanceledError,g.all=function(p){return Promise.all(p)},g.spread=l(7980),g.isAxiosError=l(5019),a.exports=g,a.exports.default=g},3191:(a,o,l)=>{var c=l(8563);function u(f){if(typeof f!="function")throw new TypeError("executor must be a function.");var h;this.promise=new Promise((function(p){h=p}));var g=this;this.promise.then((function(p){if(g._listeners){var _,y=g._listeners.length;for(_=0;_<y;_++)g._listeners[_](p);g._listeners=null}})),this.promise.then=function(p){var _,y=new Promise((function(v){g.subscribe(v),_=v})).then(p);return y.cancel=function(){g.unsubscribe(_)},y},f((function(p){g.reason||(g.reason=new c(p),h(g.reason))}))}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.prototype.subscribe=function(f){this.reason?f(this.reason):this._listeners?this._listeners.push(f):this._listeners=[f]},u.prototype.unsubscribe=function(f){if(this._listeners){var h=this._listeners.indexOf(f);h!==-1&&this._listeners.splice(h,1)}},u.source=function(){var f;return{token:new u((function(h){f=h})),cancel:f}},a.exports=u},8563:(a,o,l)=>{var c=l(5845);function u(f){c.call(this,f??"canceled",c.ERR_CANCELED),this.name="CanceledError"}l(9516).inherits(u,c,{__CANCEL__:!0}),a.exports=u},3864:a=>{a.exports=function(o){return!(!o||!o.__CANCEL__)}},5155:(a,o,l)=>{var c=l(9516),u=l(9106),f=l(3471),h=l(4490),g=l(5343),p=l(9615),_=l(4841),y=_.validators;function v(x){this.defaults=x,this.interceptors={request:new f,response:new f}}v.prototype.request=function(x,E){typeof x=="string"?(E=E||{}).url=x:E=x||{},(E=g(this.defaults,E)).method?E.method=E.method.toLowerCase():this.defaults.method?E.method=this.defaults.method.toLowerCase():E.method="get";var M=E.transitional;M!==void 0&&_.assertOptions(M,{silentJSONParsing:y.transitional(y.boolean),forcedJSONParsing:y.transitional(y.boolean),clarifyTimeoutError:y.transitional(y.boolean)},!1);var k=[],N=!0;this.interceptors.request.forEach((function($){typeof $.runWhen=="function"&&$.runWhen(E)===!1||(N=N&&$.synchronous,k.unshift($.fulfilled,$.rejected))}));var I,D=[];if(this.interceptors.response.forEach((function($){D.push($.fulfilled,$.rejected)})),!N){var V=[h,void 0];for(Array.prototype.unshift.apply(V,k),V=V.concat(D),I=Promise.resolve(E);V.length;)I=I.then(V.shift(),V.shift());return I}for(var G=E;k.length;){var J=k.shift(),B=k.shift();try{G=J(G)}catch($){B($);break}}try{I=h(G)}catch($){return Promise.reject($)}for(;D.length;)I=I.then(D.shift(),D.shift());return I},v.prototype.getUri=function(x){x=g(this.defaults,x);var E=p(x.baseURL,x.url);return u(E,x.params,x.paramsSerializer)},c.forEach(["delete","get","head","options"],(function(x){v.prototype[x]=function(E,M){return this.request(g(M||{},{method:x,url:E,data:(M||{}).data}))}})),c.forEach(["post","put","patch"],(function(x){function E(M){return function(k,N,I){return this.request(g(I||{},{method:x,headers:M?{"Content-Type":"multipart/form-data"}:{},url:k,data:N}))}}v.prototype[x]=E(),v.prototype[x+"Form"]=E(!0)})),a.exports=v},5845:(a,o,l)=>{var c=l(9516);function u(g,p,_,y,v){Error.call(this),this.message=g,this.name="AxiosError",p&&(this.code=p),_&&(this.config=_),y&&(this.request=y),v&&(this.response=v)}c.inherits(u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var f=u.prototype,h={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(g){h[g]={value:g}})),Object.defineProperties(u,h),Object.defineProperty(f,"isAxiosError",{value:!0}),u.from=function(g,p,_,y,v,x){var E=Object.create(f);return c.toFlatObject(g,E,(function(M){return M!==Error.prototype})),u.call(E,g.message,p,_,y,v),E.name=g.name,x&&Object.assign(E,x),E},a.exports=u},3471:(a,o,l)=>{var c=l(9516);function u(){this.handlers=[]}u.prototype.use=function(f,h,g){return this.handlers.push({fulfilled:f,rejected:h,synchronous:!!g&&g.synchronous,runWhen:g?g.runWhen:null}),this.handlers.length-1},u.prototype.eject=function(f){this.handlers[f]&&(this.handlers[f]=null)},u.prototype.forEach=function(f){c.forEach(this.handlers,(function(h){h!==null&&f(h)}))},a.exports=u},9615:(a,o,l)=>{var c=l(9137),u=l(4680);a.exports=function(f,h){return f&&!c(h)?u(f,h):h}},4490:(a,o,l)=>{var c=l(9516),u=l(2881),f=l(3864),h=l(7412),g=l(8563);function p(_){if(_.cancelToken&&_.cancelToken.throwIfRequested(),_.signal&&_.signal.aborted)throw new g}a.exports=function(_){return p(_),_.headers=_.headers||{},_.data=u.call(_,_.data,_.headers,_.transformRequest),_.headers=c.merge(_.headers.common||{},_.headers[_.method]||{},_.headers),c.forEach(["delete","get","head","post","put","patch","common"],(function(y){delete _.headers[y]})),(_.adapter||h.adapter)(_).then((function(y){return p(_),y.data=u.call(_,y.data,y.headers,_.transformResponse),y}),(function(y){return f(y)||(p(_),y&&y.response&&(y.response.data=u.call(_,y.response.data,y.response.headers,_.transformResponse))),Promise.reject(y)}))}},5343:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){f=f||{};var h={};function g(E,M){return c.isPlainObject(E)&&c.isPlainObject(M)?c.merge(E,M):c.isPlainObject(M)?c.merge({},M):c.isArray(M)?M.slice():M}function p(E){return c.isUndefined(f[E])?c.isUndefined(u[E])?void 0:g(void 0,u[E]):g(u[E],f[E])}function _(E){if(!c.isUndefined(f[E]))return g(void 0,f[E])}function y(E){return c.isUndefined(f[E])?c.isUndefined(u[E])?void 0:g(void 0,u[E]):g(void 0,f[E])}function v(E){return E in f?g(u[E],f[E]):E in u?g(void 0,u[E]):void 0}var x={url:_,method:_,data:_,baseURL:y,transformRequest:y,transformResponse:y,paramsSerializer:y,timeout:y,timeoutMessage:y,withCredentials:y,adapter:y,responseType:y,xsrfCookieName:y,xsrfHeaderName:y,onUploadProgress:y,onDownloadProgress:y,decompress:y,maxContentLength:y,maxBodyLength:y,beforeRedirect:y,transport:y,httpAgent:y,httpsAgent:y,cancelToken:y,socketPath:y,responseEncoding:y,validateStatus:v};return c.forEach(Object.keys(u).concat(Object.keys(f)),(function(E){var M=x[E]||p,k=M(E);c.isUndefined(k)&&M!==v||(h[E]=k)})),h}},7522:(a,o,l)=>{var c=l(5845);a.exports=function(u,f,h){var g=h.config.validateStatus;h.status&&g&&!g(h.status)?f(new c("Request failed with status code "+h.status,[c.ERR_BAD_REQUEST,c.ERR_BAD_RESPONSE][Math.floor(h.status/100)-4],h.config,h.request,h)):u(h)}},2881:(a,o,l)=>{var c=l(9516),u=l(7412);a.exports=function(f,h,g){var p=this||u;return c.forEach(g,(function(_){f=_.call(p,f,h)})),f}},7412:(a,o,l)=>{var c=l(9516),u=l(7018),f=l(5845),h=l(4896),g=l(6440),p={"Content-Type":"application/x-www-form-urlencoded"};function _(x,E){!c.isUndefined(x)&&c.isUndefined(x["Content-Type"])&&(x["Content-Type"]=E)}var y,v={transitional:h,adapter:((typeof XMLHttpRequest<"u"||typeof Tl<"u"&&Object.prototype.toString.call(Tl)==="[object process]")&&(y=l(5592)),y),transformRequest:[function(x,E){if(u(E,"Accept"),u(E,"Content-Type"),c.isFormData(x)||c.isArrayBuffer(x)||c.isBuffer(x)||c.isStream(x)||c.isFile(x)||c.isBlob(x))return x;if(c.isArrayBufferView(x))return x.buffer;if(c.isURLSearchParams(x))return _(E,"application/x-www-form-urlencoded;charset=utf-8"),x.toString();var M,k=c.isObject(x),N=E&&E["Content-Type"];if((M=c.isFileList(x))||k&&N==="multipart/form-data"){var I=this.env&&this.env.FormData;return g(M?{"files[]":x}:x,I&&new I)}return k||N==="application/json"?(_(E,"application/json"),(function(D,V,G){if(c.isString(D))try{return(V||JSON.parse)(D),c.trim(D)}catch(J){if(J.name!=="SyntaxError")throw J}return(G||JSON.stringify)(D)})(x)):x}],transformResponse:[function(x){var E=this.transitional||v.transitional,M=E&&E.silentJSONParsing,k=E&&E.forcedJSONParsing,N=!M&&this.responseType==="json";if(N||k&&c.isString(x)&&x.length)try{return JSON.parse(x)}catch(I){if(N)throw I.name==="SyntaxError"?f.from(I,f.ERR_BAD_RESPONSE,this,null,this.response):I}return x}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:l(1534)},validateStatus:function(x){return x>=200&&x<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};c.forEach(["delete","get","head"],(function(x){v.headers[x]={}})),c.forEach(["post","put","patch"],(function(x){v.headers[x]=c.merge(p)})),a.exports=v},4896:a=>{a.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},9641:a=>{a.exports={version:"0.27.2"}},9012:a=>{a.exports=function(o,l){return function(){for(var c=new Array(arguments.length),u=0;u<c.length;u++)c[u]=arguments[u];return o.apply(l,c)}}},9106:(a,o,l)=>{var c=l(9516);function u(f){return encodeURIComponent(f).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}a.exports=function(f,h,g){if(!h)return f;var p;if(g)p=g(h);else if(c.isURLSearchParams(h))p=h.toString();else{var _=[];c.forEach(h,(function(v,x){v!=null&&(c.isArray(v)?x+="[]":v=[v],c.forEach(v,(function(E){c.isDate(E)?E=E.toISOString():c.isObject(E)&&(E=JSON.stringify(E)),_.push(u(x)+"="+u(E))})))})),p=_.join("&")}if(p){var y=f.indexOf("#");y!==-1&&(f=f.slice(0,y)),f+=(f.indexOf("?")===-1?"?":"&")+p}return f}},4680:a=>{a.exports=function(o,l){return l?o.replace(/\/+$/,"")+"/"+l.replace(/^\/+/,""):o}},3948:(a,o,l)=>{var c=l(9516);a.exports=c.isStandardBrowserEnv()?{write:function(u,f,h,g,p,_){var y=[];y.push(u+"="+encodeURIComponent(f)),c.isNumber(h)&&y.push("expires="+new Date(h).toGMTString()),c.isString(g)&&y.push("path="+g),c.isString(p)&&y.push("domain="+p),_===!0&&y.push("secure"),document.cookie=y.join("; ")},read:function(u){var f=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return f?decodeURIComponent(f[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},9137:a=>{a.exports=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}},5019:(a,o,l)=>{var c=l(9516);a.exports=function(u){return c.isObject(u)&&u.isAxiosError===!0}},4202:(a,o,l)=>{var c=l(9516);a.exports=c.isStandardBrowserEnv()?(function(){var u,f=/(msie|trident)/i.test(navigator.userAgent),h=document.createElement("a");function g(p){var _=p;return f&&(h.setAttribute("href",_),_=h.href),h.setAttribute("href",_),{href:h.href,protocol:h.protocol?h.protocol.replace(/:$/,""):"",host:h.host,search:h.search?h.search.replace(/^\?/,""):"",hash:h.hash?h.hash.replace(/^#/,""):"",hostname:h.hostname,port:h.port,pathname:h.pathname.charAt(0)==="/"?h.pathname:"/"+h.pathname}}return u=g(window.location.href),function(p){var _=c.isString(p)?g(p):p;return _.protocol===u.protocol&&_.host===u.host}})():function(){return!0}},7018:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){c.forEach(u,(function(h,g){g!==f&&g.toUpperCase()===f.toUpperCase()&&(u[f]=h,delete u[g])}))}},1534:a=>{a.exports=null},2012:(a,o,l)=>{var c=l(9516),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];a.exports=function(f){var h,g,p,_={};return f&&c.forEach(f.split(`
`),(function(y){if(p=y.indexOf(":"),h=c.trim(y.substr(0,p)).toLowerCase(),g=c.trim(y.substr(p+1)),h){if(_[h]&&u.indexOf(h)>=0)return;_[h]=h==="set-cookie"?(_[h]?_[h]:[]).concat([g]):_[h]?_[h]+", "+g:g}})),_}},5656:a=>{a.exports=function(o){var l=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return l&&l[1]||""}},7980:a=>{a.exports=function(o){return function(l){return o.apply(null,l)}}},6440:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){f=f||new FormData;var h=[];function g(p){return p===null?"":c.isDate(p)?p.toISOString():c.isArrayBuffer(p)||c.isTypedArray(p)?typeof Blob=="function"?new Blob([p]):Bl.from(p):p}return(function p(_,y){if(c.isPlainObject(_)||c.isArray(_)){if(h.indexOf(_)!==-1)throw Error("Circular reference detected in "+y);h.push(_),c.forEach(_,(function(v,x){if(!c.isUndefined(v)){var E,M=y?y+"."+x:x;if(v&&!y&&typeof v=="object"){if(c.endsWith(x,"{}"))v=JSON.stringify(v);else if(c.endsWith(x,"[]")&&(E=c.toArray(v)))return void E.forEach((function(k){!c.isUndefined(k)&&f.append(M,g(k))}))}p(v,M)}})),h.pop()}else f.append(y,g(_))})(u),f}},4841:(a,o,l)=>{var c=l(9641).version,u=l(5845),f={};["object","boolean","number","function","string","symbol"].forEach((function(g,p){f[g]=function(_){return typeof _===g||"a"+(p<1?"n ":" ")+g}}));var h={};f.transitional=function(g,p,_){function y(v,x){return"[Axios v"+c+"] Transitional option '"+v+"'"+x+(_?". "+_:"")}return function(v,x,E){if(g===!1)throw new u(y(x," has been removed"+(p?" in "+p:"")),u.ERR_DEPRECATED);return p&&!h[x]&&(h[x]=!0,console.warn(y(x," has been deprecated since v"+p+" and will be removed in the near future"))),!g||g(v,x,E)}},a.exports={assertOptions:function(g,p,_){if(typeof g!="object")throw new u("options must be an object",u.ERR_BAD_OPTION_VALUE);for(var y=Object.keys(g),v=y.length;v-- >0;){var x=y[v],E=p[x];if(E){var M=g[x],k=M===void 0||E(M,x,g);if(k!==!0)throw new u("option "+x+" must be "+k,u.ERR_BAD_OPTION_VALUE)}else if(_!==!0)throw new u("Unknown option "+x,u.ERR_BAD_OPTION)}},validators:f}},9516:(a,o,l)=>{var c,u=l(9012),f=Object.prototype.toString,h=(c=Object.create(null),function(B){var $=f.call(B);return c[$]||(c[$]=$.slice(8,-1).toLowerCase())});function g(B){return B=B.toLowerCase(),function($){return h($)===B}}function p(B){return Array.isArray(B)}function _(B){return B===void 0}var y=g("ArrayBuffer");function v(B){return B!==null&&typeof B=="object"}function x(B){if(h(B)!=="object")return!1;var $=Object.getPrototypeOf(B);return $===null||$===Object.prototype}var E=g("Date"),M=g("File"),k=g("Blob"),N=g("FileList");function I(B){return f.call(B)==="[object Function]"}var D=g("URLSearchParams");function V(B,$){if(B!=null)if(typeof B!="object"&&(B=[B]),p(B))for(var U=0,Q=B.length;U<Q;U++)$.call(null,B[U],U,B);else for(var W in B)Object.prototype.hasOwnProperty.call(B,W)&&$.call(null,B[W],W,B)}var G,J=(G=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(B){return G&&B instanceof G});a.exports={isArray:p,isArrayBuffer:y,isBuffer:function(B){return B!==null&&!_(B)&&B.constructor!==null&&!_(B.constructor)&&typeof B.constructor.isBuffer=="function"&&B.constructor.isBuffer(B)},isFormData:function(B){var $="[object FormData]";return B&&(typeof FormData=="function"&&B instanceof FormData||f.call(B)===$||I(B.toString)&&B.toString()===$)},isArrayBufferView:function(B){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(B):B&&B.buffer&&y(B.buffer)},isString:function(B){return typeof B=="string"},isNumber:function(B){return typeof B=="number"},isObject:v,isPlainObject:x,isUndefined:_,isDate:E,isFile:M,isBlob:k,isFunction:I,isStream:function(B){return v(B)&&I(B.pipe)},isURLSearchParams:D,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:V,merge:function B(){var $={};function U(q,Y){x($[Y])&&x(q)?$[Y]=B($[Y],q):x(q)?$[Y]=B({},q):p(q)?$[Y]=q.slice():$[Y]=q}for(var Q=0,W=arguments.length;Q<W;Q++)V(arguments[Q],U);return $},extend:function(B,$,U){return V($,(function(Q,W){B[W]=U&&typeof Q=="function"?u(Q,U):Q})),B},trim:function(B){return B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")},stripBOM:function(B){return B.charCodeAt(0)===65279&&(B=B.slice(1)),B},inherits:function(B,$,U,Q){B.prototype=Object.create($.prototype,Q),B.prototype.constructor=B,U&&Object.assign(B.prototype,U)},toFlatObject:function(B,$,U){var Q,W,q,Y={};$=$||{};do{for(W=(Q=Object.getOwnPropertyNames(B)).length;W-- >0;)Y[q=Q[W]]||($[q]=B[q],Y[q]=!0);B=Object.getPrototypeOf(B)}while(B&&(!U||U(B,$))&&B!==Object.prototype);return $},kindOf:h,kindOfTest:g,endsWith:function(B,$,U){B=String(B),(U===void 0||U>B.length)&&(U=B.length),U-=$.length;var Q=B.indexOf($,U);return Q!==-1&&Q===U},toArray:function(B){if(!B)return null;var $=B.length;if(_($))return null;for(var U=new Array($);$-- >0;)U[$]=B[$];return U},isTypedArray:J,isFileList:N}},6880:function(a){a.exports=(function(o){var l={};function c(u){if(l[u])return l[u].exports;var f=l[u]={i:u,l:!1,exports:{}};return o[u].call(f.exports,f,f.exports,c),f.l=!0,f.exports}return c.m=o,c.c=l,c.d=function(u,f,h){c.o(u,f)||Object.defineProperty(u,f,{enumerable:!0,get:h})},c.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},c.t=function(u,f){if(1&f&&(u=c(u)),8&f||4&f&&typeof u=="object"&&u&&u.__esModule)return u;var h=Object.create(null);if(c.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:u}),2&f&&typeof u!="string")for(var g in u)c.d(h,g,(function(p){return u[p]}).bind(null,g));return h},c.n=function(u){var f=u&&u.__esModule?function(){return u.default}:function(){return u};return c.d(f,"a",f),f},c.o=function(u,f){return Object.prototype.hasOwnProperty.call(u,f)},c.p="",c(c.s=90)})({17:function(o,l,c){l.__esModule=!0,l.default=void 0;var u=c(18),f=(function(){function h(){}return h.getFirstMatch=function(g,p){var _=p.match(g);return _&&_.length>0&&_[1]||""},h.getSecondMatch=function(g,p){var _=p.match(g);return _&&_.length>1&&_[2]||""},h.matchAndReturnConst=function(g,p,_){if(g.test(p))return _},h.getWindowsVersionName=function(g){switch(g){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},h.getMacOSVersionName=function(g){var p=g.split(".").splice(0,2).map((function(_){return parseInt(_,10)||0}));if(p.push(0),p[0]===10)switch(p[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},h.getAndroidVersionName=function(g){var p=g.split(".").splice(0,2).map((function(_){return parseInt(_,10)||0}));if(p.push(0),!(p[0]===1&&p[1]<5))return p[0]===1&&p[1]<6?"Cupcake":p[0]===1&&p[1]>=6?"Donut":p[0]===2&&p[1]<2?"Eclair":p[0]===2&&p[1]===2?"Froyo":p[0]===2&&p[1]>2?"Gingerbread":p[0]===3?"Honeycomb":p[0]===4&&p[1]<1?"Ice Cream Sandwich":p[0]===4&&p[1]<4?"Jelly Bean":p[0]===4&&p[1]>=4?"KitKat":p[0]===5?"Lollipop":p[0]===6?"Marshmallow":p[0]===7?"Nougat":p[0]===8?"Oreo":p[0]===9?"Pie":void 0},h.getVersionPrecision=function(g){return g.split(".").length},h.compareVersions=function(g,p,_){_===void 0&&(_=!1);var y=h.getVersionPrecision(g),v=h.getVersionPrecision(p),x=Math.max(y,v),E=0,M=h.map([g,p],(function(k){var N=x-h.getVersionPrecision(k),I=k+new Array(N+1).join(".0");return h.map(I.split("."),(function(D){return new Array(20-D.length).join("0")+D})).reverse()}));for(_&&(E=x-Math.min(y,v)),x-=1;x>=E;){if(M[0][x]>M[1][x])return 1;if(M[0][x]===M[1][x]){if(x===E)return 0;x-=1}else if(M[0][x]<M[1][x])return-1}},h.map=function(g,p){var _,y=[];if(Array.prototype.map)return Array.prototype.map.call(g,p);for(_=0;_<g.length;_+=1)y.push(p(g[_]));return y},h.find=function(g,p){var _,y;if(Array.prototype.find)return Array.prototype.find.call(g,p);for(_=0,y=g.length;_<y;_+=1){var v=g[_];if(p(v,_))return v}},h.assign=function(g){for(var p,_,y=g,v=arguments.length,x=new Array(v>1?v-1:0),E=1;E<v;E++)x[E-1]=arguments[E];if(Object.assign)return Object.assign.apply(Object,[g].concat(x));var M=function(){var k=x[p];typeof k=="object"&&k!==null&&Object.keys(k).forEach((function(N){y[N]=k[N]}))};for(p=0,_=x.length;p<_;p+=1)M();return g},h.getBrowserAlias=function(g){return u.BROWSER_ALIASES_MAP[g]},h.getBrowserTypeByAlias=function(g){return u.BROWSER_MAP[g]||""},h})();l.default=f,o.exports=l.default},18:function(o,l,c){l.__esModule=!0,l.ENGINE_MAP=l.OS_MAP=l.PLATFORMS_MAP=l.BROWSER_MAP=l.BROWSER_ALIASES_MAP=void 0,l.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},l.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},l.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},l.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},l.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(91))&&u.__esModule?u:{default:u},h=c(18);function g(_,y){for(var v=0;v<y.length;v++){var x=y[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(_,x.key,x)}}var p=(function(){function _(){}var y,v,x;return _.getParser=function(E,M){if(M===void 0&&(M=!1),typeof E!="string")throw new Error("UserAgent should be a string");return new f.default(E,M)},_.parse=function(E){return new f.default(E).getResult()},y=_,x=[{key:"BROWSER_MAP",get:function(){return h.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return h.ENGINE_MAP}},{key:"OS_MAP",get:function(){return h.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return h.PLATFORMS_MAP}}],(v=null)&&g(y.prototype,v),x&&g(y,x),_})();l.default=p,o.exports=l.default},91:function(o,l,c){l.__esModule=!0,l.default=void 0;var u=_(c(92)),f=_(c(93)),h=_(c(94)),g=_(c(95)),p=_(c(17));function _(v){return v&&v.__esModule?v:{default:v}}var y=(function(){function v(E,M){if(M===void 0&&(M=!1),E==null||E==="")throw new Error("UserAgent parameter can't be empty");this._ua=E,this.parsedResult={},M!==!0&&this.parse()}var x=v.prototype;return x.getUA=function(){return this._ua},x.test=function(E){return E.test(this._ua)},x.parseBrowser=function(){var E=this;this.parsedResult.browser={};var M=p.default.find(u.default,(function(k){if(typeof k.test=="function")return k.test(E);if(k.test instanceof Array)return k.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.browser=M.describe(this.getUA())),this.parsedResult.browser},x.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},x.getBrowserName=function(E){return E?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},x.getBrowserVersion=function(){return this.getBrowser().version},x.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},x.parseOS=function(){var E=this;this.parsedResult.os={};var M=p.default.find(f.default,(function(k){if(typeof k.test=="function")return k.test(E);if(k.test instanceof Array)return k.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.os=M.describe(this.getUA())),this.parsedResult.os},x.getOSName=function(E){var M=this.getOS().name;return E?String(M).toLowerCase()||"":M||""},x.getOSVersion=function(){return this.getOS().version},x.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},x.getPlatformType=function(E){E===void 0&&(E=!1);var M=this.getPlatform().type;return E?String(M).toLowerCase()||"":M||""},x.parsePlatform=function(){var E=this;this.parsedResult.platform={};var M=p.default.find(h.default,(function(k){if(typeof k.test=="function")return k.test(E);if(k.test instanceof Array)return k.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.platform=M.describe(this.getUA())),this.parsedResult.platform},x.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},x.getEngineName=function(E){return E?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},x.parseEngine=function(){var E=this;this.parsedResult.engine={};var M=p.default.find(g.default,(function(k){if(typeof k.test=="function")return k.test(E);if(k.test instanceof Array)return k.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.engine=M.describe(this.getUA())),this.parsedResult.engine},x.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},x.getResult=function(){return p.default.assign({},this.parsedResult)},x.satisfies=function(E){var M=this,k={},N=0,I={},D=0;if(Object.keys(E).forEach((function(W){var q=E[W];typeof q=="string"?(I[W]=q,D+=1):typeof q=="object"&&(k[W]=q,N+=1)})),N>0){var V=Object.keys(k),G=p.default.find(V,(function(W){return M.isOS(W)}));if(G){var J=this.satisfies(k[G]);if(J!==void 0)return J}var B=p.default.find(V,(function(W){return M.isPlatform(W)}));if(B){var $=this.satisfies(k[B]);if($!==void 0)return $}}if(D>0){var U=Object.keys(I),Q=p.default.find(U,(function(W){return M.isBrowser(W,!0)}));if(Q!==void 0)return this.compareVersion(I[Q])}},x.isBrowser=function(E,M){M===void 0&&(M=!1);var k=this.getBrowserName().toLowerCase(),N=E.toLowerCase(),I=p.default.getBrowserTypeByAlias(N);return M&&I&&(N=I.toLowerCase()),N===k},x.compareVersion=function(E){var M=[0],k=E,N=!1,I=this.getBrowserVersion();if(typeof I=="string")return E[0]===">"||E[0]==="<"?(k=E.substr(1),E[1]==="="?(N=!0,k=E.substr(2)):M=[],E[0]===">"?M.push(1):M.push(-1)):E[0]==="="?k=E.substr(1):E[0]==="~"&&(N=!0,k=E.substr(1)),M.indexOf(p.default.compareVersions(I,k,N))>-1},x.isOS=function(E){return this.getOSName(!0)===String(E).toLowerCase()},x.isPlatform=function(E){return this.getPlatformType(!0)===String(E).toLowerCase()},x.isEngine=function(E){return this.getEngineName(!0)===String(E).toLowerCase()},x.is=function(E,M){return M===void 0&&(M=!1),this.isBrowser(E,M)||this.isOS(E)||this.isPlatform(E)},x.some=function(E){var M=this;return E===void 0&&(E=[]),E.some((function(k){return M.is(k)}))},v})();l.default=y,o.exports=l.default},92:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},h=/version\/(\d+(\.?_?\d+)+)/i,g=[{test:[/googlebot/i],describe:function(p){var _={name:"Googlebot"},y=f.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/opera/i],describe:function(p){var _={name:"Opera"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/opr\/|opios/i],describe:function(p){var _={name:"Opera"},y=f.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/SamsungBrowser/i],describe:function(p){var _={name:"Samsung Internet for Android"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/Whale/i],describe:function(p){var _={name:"NAVER Whale Browser"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/MZBrowser/i],describe:function(p){var _={name:"MZ Browser"},y=f.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/focus/i],describe:function(p){var _={name:"Focus"},y=f.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/swing/i],describe:function(p){var _={name:"Swing"},y=f.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/coast/i],describe:function(p){var _={name:"Opera Coast"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(p){var _={name:"Opera Touch"},y=f.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/yabrowser/i],describe:function(p){var _={name:"Yandex Browser"},y=f.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/ucbrowser/i],describe:function(p){var _={name:"UC Browser"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/Maxthon|mxios/i],describe:function(p){var _={name:"Maxthon"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/epiphany/i],describe:function(p){var _={name:"Epiphany"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/puffin/i],describe:function(p){var _={name:"Puffin"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/sleipnir/i],describe:function(p){var _={name:"Sleipnir"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/k-meleon/i],describe:function(p){var _={name:"K-Meleon"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/micromessenger/i],describe:function(p){var _={name:"WeChat"},y=f.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/qqbrowser/i],describe:function(p){var _={name:/qqbrowserlite/i.test(p)?"QQ Browser Lite":"QQ Browser"},y=f.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/msie|trident/i],describe:function(p){var _={name:"Internet Explorer"},y=f.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/\sedg\//i],describe:function(p){var _={name:"Microsoft Edge"},y=f.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/edg([ea]|ios)/i],describe:function(p){var _={name:"Microsoft Edge"},y=f.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/vivaldi/i],describe:function(p){var _={name:"Vivaldi"},y=f.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/seamonkey/i],describe:function(p){var _={name:"SeaMonkey"},y=f.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/sailfish/i],describe:function(p){var _={name:"Sailfish"},y=f.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,p);return y&&(_.version=y),_}},{test:[/silk/i],describe:function(p){var _={name:"Amazon Silk"},y=f.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/phantom/i],describe:function(p){var _={name:"PhantomJS"},y=f.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/slimerjs/i],describe:function(p){var _={name:"SlimerJS"},y=f.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var _={name:"BlackBerry"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var _={name:"WebOS Browser"},y=f.default.getFirstMatch(h,p)||f.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/bada/i],describe:function(p){var _={name:"Bada"},y=f.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/tizen/i],describe:function(p){var _={name:"Tizen"},y=f.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/qupzilla/i],describe:function(p){var _={name:"QupZilla"},y=f.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/firefox|iceweasel|fxios/i],describe:function(p){var _={name:"Firefox"},y=f.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/electron/i],describe:function(p){var _={name:"Electron"},y=f.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/MiuiBrowser/i],describe:function(p){var _={name:"Miui"},y=f.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/chromium/i],describe:function(p){var _={name:"Chromium"},y=f.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/chrome|crios|crmo/i],describe:function(p){var _={name:"Chrome"},y=f.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/GSA/i],describe:function(p){var _={name:"Google Search"},y=f.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){var _=!p.test(/like android/i),y=p.test(/android/i);return _&&y},describe:function(p){var _={name:"Android Browser"},y=f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/playstation 4/i],describe:function(p){var _={name:"PlayStation 4"},y=f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/safari|applewebkit/i],describe:function(p){var _={name:"Safari"},y=f.default.getFirstMatch(h,p);return y&&(_.version=y),_}},{test:[/.*/i],describe:function(p){var _=p.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:f.default.getFirstMatch(_,p),version:f.default.getSecondMatch(_,p)}}}];l.default=g,o.exports=l.default},93:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},h=c(18),g=[{test:[/Roku\/DVP/],describe:function(p){var _=f.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,p);return{name:h.OS_MAP.Roku,version:_}}},{test:[/windows phone/i],describe:function(p){var _=f.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,p);return{name:h.OS_MAP.WindowsPhone,version:_}}},{test:[/windows /i],describe:function(p){var _=f.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,p),y=f.default.getWindowsVersionName(_);return{name:h.OS_MAP.Windows,version:_,versionName:y}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(p){var _={name:h.OS_MAP.iOS},y=f.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,p);return y&&(_.version=y),_}},{test:[/macintosh/i],describe:function(p){var _=f.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,p).replace(/[_\s]/g,"."),y=f.default.getMacOSVersionName(_),v={name:h.OS_MAP.MacOS,version:_};return y&&(v.versionName=y),v}},{test:[/(ipod|iphone|ipad)/i],describe:function(p){var _=f.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,p).replace(/[_\s]/g,".");return{name:h.OS_MAP.iOS,version:_}}},{test:function(p){var _=!p.test(/like android/i),y=p.test(/android/i);return _&&y},describe:function(p){var _=f.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,p),y=f.default.getAndroidVersionName(_),v={name:h.OS_MAP.Android,version:_};return y&&(v.versionName=y),v}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var _=f.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,p),y={name:h.OS_MAP.WebOS};return _&&_.length&&(y.version=_),y}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var _=f.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,p)||f.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,p)||f.default.getFirstMatch(/\bbb(\d+)/i,p);return{name:h.OS_MAP.BlackBerry,version:_}}},{test:[/bada/i],describe:function(p){var _=f.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,p);return{name:h.OS_MAP.Bada,version:_}}},{test:[/tizen/i],describe:function(p){var _=f.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,p);return{name:h.OS_MAP.Tizen,version:_}}},{test:[/linux/i],describe:function(){return{name:h.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:h.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(p){var _=f.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,p);return{name:h.OS_MAP.PlayStation4,version:_}}}];l.default=g,o.exports=l.default},94:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},h=c(18),g=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(p){var _=f.default.getFirstMatch(/(can-l01)/i,p)&&"Nova",y={type:h.PLATFORMS_MAP.mobile,vendor:"Huawei"};return _&&(y.model=_),y}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:h.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:h.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:h.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:h.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:h.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:h.PLATFORMS_MAP.tablet}}},{test:function(p){var _=p.test(/ipod|iphone/i),y=p.test(/like (ipod|iphone)/i);return _&&!y},describe:function(p){var _=f.default.getFirstMatch(/(ipod|iphone)/i,p);return{type:h.PLATFORMS_MAP.mobile,vendor:"Apple",model:_}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:h.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:h.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName(!0)==="blackberry"},describe:function(){return{type:h.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(p){return p.getBrowserName(!0)==="bada"},describe:function(){return{type:h.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName()==="windows phone"},describe:function(){return{type:h.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(p){var _=Number(String(p.getOSVersion()).split(".")[0]);return p.getOSName(!0)==="android"&&_>=3},describe:function(){return{type:h.PLATFORMS_MAP.tablet}}},{test:function(p){return p.getOSName(!0)==="android"},describe:function(){return{type:h.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getOSName(!0)==="macos"},describe:function(){return{type:h.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(p){return p.getOSName(!0)==="windows"},describe:function(){return{type:h.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="linux"},describe:function(){return{type:h.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="playstation 4"},describe:function(){return{type:h.PLATFORMS_MAP.tv}}},{test:function(p){return p.getOSName(!0)==="roku"},describe:function(){return{type:h.PLATFORMS_MAP.tv}}}];l.default=g,o.exports=l.default},95:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},h=c(18),g=[{test:function(p){return p.getBrowserName(!0)==="microsoft edge"},describe:function(p){if(/\sedg\//i.test(p))return{name:h.ENGINE_MAP.Blink};var _=f.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,p);return{name:h.ENGINE_MAP.EdgeHTML,version:_}}},{test:[/trident/i],describe:function(p){var _={name:h.ENGINE_MAP.Trident},y=f.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){return p.test(/presto/i)},describe:function(p){var _={name:h.ENGINE_MAP.Presto},y=f.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){var _=p.test(/gecko/i),y=p.test(/like gecko/i);return _&&!y},describe:function(p){var _={name:h.ENGINE_MAP.Gecko},y=f.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:h.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(p){var _={name:h.ENGINE_MAP.WebKit},y=f.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}}];l.default=g,o.exports=l.default}})},228:a=>{var o=Object.prototype.hasOwnProperty,l="~";function c(){}function u(p,_,y){this.fn=p,this.context=_,this.once=y||!1}function f(p,_,y,v,x){if(typeof y!="function")throw new TypeError("The listener must be a function");var E=new u(y,v||p,x),M=l?l+_:_;return p._events[M]?p._events[M].fn?p._events[M]=[p._events[M],E]:p._events[M].push(E):(p._events[M]=E,p._eventsCount++),p}function h(p,_){--p._eventsCount==0?p._events=new c:delete p._events[_]}function g(){this._events=new c,this._eventsCount=0}Object.create&&(c.prototype=Object.create(null),new c().__proto__||(l=!1)),g.prototype.eventNames=function(){var p,_,y=[];if(this._eventsCount===0)return y;for(_ in p=this._events)o.call(p,_)&&y.push(l?_.slice(1):_);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(p)):y},g.prototype.listeners=function(p){var _=l?l+p:p,y=this._events[_];if(!y)return[];if(y.fn)return[y.fn];for(var v=0,x=y.length,E=new Array(x);v<x;v++)E[v]=y[v].fn;return E},g.prototype.listenerCount=function(p){var _=l?l+p:p,y=this._events[_];return y?y.fn?1:y.length:0},g.prototype.emit=function(p,_,y,v,x,E){var M=l?l+p:p;if(!this._events[M])return!1;var k,N,I=this._events[M],D=arguments.length;if(I.fn){switch(I.once&&this.removeListener(p,I.fn,void 0,!0),D){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,y),!0;case 4:return I.fn.call(I.context,_,y,v),!0;case 5:return I.fn.call(I.context,_,y,v,x),!0;case 6:return I.fn.call(I.context,_,y,v,x,E),!0}for(N=1,k=new Array(D-1);N<D;N++)k[N-1]=arguments[N];I.fn.apply(I.context,k)}else{var V,G=I.length;for(N=0;N<G;N++)switch(I[N].once&&this.removeListener(p,I[N].fn,void 0,!0),D){case 1:I[N].fn.call(I[N].context);break;case 2:I[N].fn.call(I[N].context,_);break;case 3:I[N].fn.call(I[N].context,_,y);break;case 4:I[N].fn.call(I[N].context,_,y,v);break;default:if(!k)for(V=1,k=new Array(D-1);V<D;V++)k[V-1]=arguments[V];I[N].fn.apply(I[N].context,k)}}return!0},g.prototype.on=function(p,_,y){return f(this,p,_,y,!1)},g.prototype.once=function(p,_,y){return f(this,p,_,y,!0)},g.prototype.removeListener=function(p,_,y,v){var x=l?l+p:p;if(!this._events[x])return this;if(!_)return h(this,x),this;var E=this._events[x];if(E.fn)E.fn!==_||v&&!E.once||y&&E.context!==y||h(this,x);else{for(var M=0,k=[],N=E.length;M<N;M++)(E[M].fn!==_||v&&!E[M].once||y&&E[M].context!==y)&&k.push(E[M]);k.length?this._events[x]=k.length===1?k[0]:k:h(this,x)}return this},g.prototype.removeAllListeners=function(p){var _;return p?(_=l?l+p:p,this._events[_]&&h(this,_)):(this._events=new c,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=l,g.EventEmitter=g,a.exports=g},8954:function(a){var o;o=()=>(()=>{var l={228:f=>{var h=Object.prototype.hasOwnProperty,g="~";function p(){}function _(E,M,k){this.fn=E,this.context=M,this.once=k||!1}function y(E,M,k,N,I){if(typeof k!="function")throw new TypeError("The listener must be a function");var D=new _(k,N||E,I),V=g?g+M:M;return E._events[V]?E._events[V].fn?E._events[V]=[E._events[V],D]:E._events[V].push(D):(E._events[V]=D,E._eventsCount++),E}function v(E,M){--E._eventsCount==0?E._events=new p:delete E._events[M]}function x(){this._events=new p,this._eventsCount=0}Object.create&&(p.prototype=Object.create(null),new p().__proto__||(g=!1)),x.prototype.eventNames=function(){var E,M,k=[];if(this._eventsCount===0)return k;for(M in E=this._events)h.call(E,M)&&k.push(g?M.slice(1):M);return Object.getOwnPropertySymbols?k.concat(Object.getOwnPropertySymbols(E)):k},x.prototype.listeners=function(E){var M=g?g+E:E,k=this._events[M];if(!k)return[];if(k.fn)return[k.fn];for(var N=0,I=k.length,D=new Array(I);N<I;N++)D[N]=k[N].fn;return D},x.prototype.listenerCount=function(E){var M=g?g+E:E,k=this._events[M];return k?k.fn?1:k.length:0},x.prototype.emit=function(E,M,k,N,I,D){var V=g?g+E:E;if(!this._events[V])return!1;var G,J,B=this._events[V],$=arguments.length;if(B.fn){switch(B.once&&this.removeListener(E,B.fn,void 0,!0),$){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,M),!0;case 3:return B.fn.call(B.context,M,k),!0;case 4:return B.fn.call(B.context,M,k,N),!0;case 5:return B.fn.call(B.context,M,k,N,I),!0;case 6:return B.fn.call(B.context,M,k,N,I,D),!0}for(J=1,G=new Array($-1);J<$;J++)G[J-1]=arguments[J];B.fn.apply(B.context,G)}else{var U,Q=B.length;for(J=0;J<Q;J++)switch(B[J].once&&this.removeListener(E,B[J].fn,void 0,!0),$){case 1:B[J].fn.call(B[J].context);break;case 2:B[J].fn.call(B[J].context,M);break;case 3:B[J].fn.call(B[J].context,M,k);break;case 4:B[J].fn.call(B[J].context,M,k,N);break;default:if(!G)for(U=1,G=new Array($-1);U<$;U++)G[U-1]=arguments[U];B[J].fn.apply(B[J].context,G)}}return!0},x.prototype.on=function(E,M,k){return y(this,E,M,k,!1)},x.prototype.once=function(E,M,k){return y(this,E,M,k,!0)},x.prototype.removeListener=function(E,M,k,N){var I=g?g+E:E;if(!this._events[I])return this;if(!M)return v(this,I),this;var D=this._events[I];if(D.fn)D.fn!==M||N&&!D.once||k&&D.context!==k||v(this,I);else{for(var V=0,G=[],J=D.length;V<J;V++)(D[V].fn!==M||N&&!D[V].once||k&&D[V].context!==k)&&G.push(D[V]);G.length?this._events[I]=G.length===1?G[0]:G:v(this,I)}return this},x.prototype.removeAllListeners=function(E){var M;return E?(M=g?g+E:E,this._events[M]&&v(this,M)):(this._events=new p,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=g,x.EventEmitter=x,f.exports=x},543:function(f,h,g){var p;f=g.nmd(f),(function(){var _,y="Expected a function",v="__lodash_hash_undefined__",x="__lodash_placeholder__",E=32,M=128,k=1/0,N=9007199254740991,I=NaN,D=4294967295,V=[["ary",M],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",E],["partialRight",64],["rearg",256]],G="[object Arguments]",J="[object Array]",B="[object Boolean]",$="[object Date]",U="[object Error]",Q="[object Function]",W="[object GeneratorFunction]",q="[object Map]",Y="[object Number]",ae="[object Object]",Z="[object Promise]",K="[object RegExp]",ne="[object Set]",le="[object String]",ce="[object Symbol]",de="[object WeakMap]",Me="[object ArrayBuffer]",qe="[object DataView]",Ne="[object Float32Array]",Ae="[object Float64Array]",Xe="[object Int8Array]",$e="[object Int16Array]",at="[object Int32Array]",pt="[object Uint8Array]",oe="[object Uint8ClampedArray]",Ue="[object Uint16Array]",Ge="[object Uint32Array]",ze=/\b__p \+= '';/g,Be=/\b(__p \+=) '' \+/g,me=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Se=/&(?:amp|lt|gt|quot|#39);/g,ke=/[&<>"']/g,be=RegExp(Se.source),Ke=RegExp(ke.source),ot=/<%-([\s\S]+?)%>/g,lt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,Vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/[\\^$.*+?()[\]{}|]/g,ge=RegExp(je.source),se=/^\s+/,_e=/\s/,Ie=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,De=/\{\n\/\* \[wrapped with (.+)\] \*/,Oe=/,? & /,we=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,st=/[()=,{}\[\]\/\s]/,Ve=/\\(\\)?/g,tt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ze=/\w*$/,nt=/^[-+]0x[0-9a-f]+$/i,vt=/^0b[01]+$/i,Je=/^\[object .+?Constructor\]$/,ht=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,ft=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,gn=/['\n\r\u2028\u2029\\]/g,_n="\\ud800-\\udfff",Bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Yt="\\u2700-\\u27bf",Mt="a-z\\xdf-\\xf6\\xf8-\\xff",fn="A-Z\\xc0-\\xd6\\xd8-\\xde",Bn="\\ufe0e\\ufe0f",cn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",In="["+_n+"]",Wn="["+cn+"]",er="["+Bt+"]",os="\\d+",gi="["+Yt+"]",Ni="["+Mt+"]",Fs="[^"+_n+cn+os+Yt+Mt+fn+"]",_i="\\ud83c[\\udffb-\\udfff]",Rs="[^"+_n+"]",ra="(?:\\ud83c[\\udde6-\\uddff]){2}",ls="[\\ud800-\\udbff][\\udc00-\\udfff]",We="["+fn+"]",At="\\u200d",Wt="(?:"+Ni+"|"+Fs+")",Kt="(?:"+We+"|"+Fs+")",Lt="(?:['’](?:d|ll|m|re|s|t|ve))?",yn="(?:['’](?:D|LL|M|RE|S|T|VE))?",zn="(?:"+er+"|"+_i+")?",En="["+Bn+"]?",tr=En+zn+"(?:"+At+"(?:"+[Rs,ra,ls].join("|")+")"+En+zn+")*",Nr="(?:"+[gi,ra,ls].join("|")+")"+tr,Er="(?:"+[Rs+er+"?",er,ra,ls,In].join("|")+")",rr=RegExp("['’]","g"),Lr=RegExp(er,"g"),ii=RegExp(_i+"(?="+_i+")|"+Er+tr,"g"),da=RegExp([We+"?"+Ni+"+"+Lt+"(?="+[Wn,We,"$"].join("|")+")",Kt+"+"+yn+"(?="+[Wn,We+Wt,"$"].join("|")+")",We+"?"+Wt+"+"+Lt,We+"+"+yn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",os,Nr].join("|"),"g"),Mr=RegExp("["+At+_n+Bt+Bn+"]"),si=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Tr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Dr=-1,Cn={};Cn[Ne]=Cn[Ae]=Cn[Xe]=Cn[$e]=Cn[at]=Cn[pt]=Cn[oe]=Cn[Ue]=Cn[Ge]=!0,Cn[G]=Cn[J]=Cn[Me]=Cn[B]=Cn[qe]=Cn[$]=Cn[U]=Cn[Q]=Cn[q]=Cn[Y]=Cn[ae]=Cn[K]=Cn[ne]=Cn[le]=Cn[de]=!1;var jr={};jr[G]=jr[J]=jr[Me]=jr[qe]=jr[B]=jr[$]=jr[Ne]=jr[Ae]=jr[Xe]=jr[$e]=jr[at]=jr[q]=jr[Y]=jr[ae]=jr[K]=jr[ne]=jr[le]=jr[ce]=jr[pt]=jr[oe]=jr[Ue]=jr[Ge]=!0,jr[U]=jr[Q]=jr[de]=!1;var Uo={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},cs=parseFloat,Bo=parseInt,us=typeof g.g=="object"&&g.g&&g.g.Object===Object&&g.g,Xn=typeof self=="object"&&self&&self.Object===Object&&self,ei=us||Xn||Function("return this")(),ur=h&&!h.nodeType&&h,zs=ur&&f&&!f.nodeType&&f,So=zs&&zs.exports===ur,pa=So&&us.process,ma=(function(){try{return zs&&zs.require&&zs.require("util").types||pa&&pa.binding&&pa.binding("util")}catch{}})(),zh=ma&&ma.isArrayBuffer,op=ma&&ma.isDate,Wp=ma&&ma.isMap,Yp=ma&&ma.isRegExp,rh=ma&&ma.isSet,wl=ma&&ma.isTypedArray;function cc(rt,Tt,Rt){switch(Rt.length){case 0:return rt.call(Tt);case 1:return rt.call(Tt,Rt[0]);case 2:return rt.call(Tt,Rt[0],Rt[1]);case 3:return rt.call(Tt,Rt[0],Rt[1],Rt[2])}return rt.apply(Tt,Rt)}function Fo(rt,Tt,Rt,tn){for(var wn=-1,Zn=rt==null?0:rt.length;++wn<Zn;){var Ci=rt[wn];Tt(tn,Ci,Rt(Ci),rt)}return tn}function il(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function Xp(rt,Tt){for(var Rt=rt==null?0:rt.length;Rt--&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function Ac(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(!Tt(rt[Rt],Rt,rt))return!1;return!0}function Wc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=0,Zn=[];++Rt<tn;){var Ci=rt[Rt];Tt(Ci,Rt,rt)&&(Zn[wn++]=Ci)}return Zn}function Yu(rt,Tt){return!(rt==null||!rt.length)&&ih(rt,Tt,0)>-1}function Yi(rt,Tt,Rt){for(var tn=-1,wn=rt==null?0:rt.length;++tn<wn;)if(Rt(Tt,rt[tn]))return!0;return!1}function Xi(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=Array(tn);++Rt<tn;)wn[Rt]=Tt(rt[Rt],Rt,rt);return wn}function Cc(rt,Tt){for(var Rt=-1,tn=Tt.length,wn=rt.length;++Rt<tn;)rt[wn+Rt]=Tt[Rt];return rt}function Ef(rt,Tt,Rt,tn){var wn=-1,Zn=rt==null?0:rt.length;for(tn&&Zn&&(Rt=rt[++wn]);++wn<Zn;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Jm(rt,Tt,Rt,tn){var wn=rt==null?0:rt.length;for(tn&&wn&&(Rt=rt[--wn]);wn--;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function uc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(Tt(rt[Rt],Rt,rt))return!0;return!1}var uo=ah("length");function Yc(rt,Tt,Rt){var tn;return Rt(rt,(function(wn,Zn,Ci){if(Tt(wn,Zn,Ci))return tn=Zn,!1})),tn}function Xc(rt,Tt,Rt,tn){for(var wn=rt.length,Zn=Rt+(tn?1:-1);tn?Zn--:++Zn<wn;)if(Tt(rt[Zn],Zn,rt))return Zn;return-1}function ih(rt,Tt,Rt){return Tt==Tt?(function(tn,wn,Zn){for(var Ci=Zn-1,al=tn.length;++Ci<al;)if(tn[Ci]===wn)return Ci;return-1})(rt,Tt,Rt):Xc(rt,xf,Rt)}function ga(rt,Tt,Rt,tn){for(var wn=Rt-1,Zn=rt.length;++wn<Zn;)if(tn(rt[wn],Tt))return wn;return-1}function xf(rt){return rt!=rt}function sh(rt,Tt){var Rt=rt==null?0:rt.length;return Rt?Tf(rt,Tt)/Rt:I}function ah(rt){return function(Tt){return Tt==null?_:Tt[rt]}}function Qm(rt){return function(Tt){return rt==null?_:rt[Tt]}}function Xu(rt,Tt,Rt,tn,wn){return wn(rt,(function(Zn,Ci,al){Rt=tn?(tn=!1,Zn):Tt(Rt,Zn,Ci,al)})),Rt}function Tf(rt,Tt){for(var Rt,tn=-1,wn=rt.length;++tn<wn;){var Zn=Tt(rt[tn]);Zn!==_&&(Rt=Rt===_?Zn:Rt+Zn)}return Rt}function oh(rt,Tt){for(var Rt=-1,tn=Array(rt);++Rt<rt;)tn[Rt]=Tt(Rt);return tn}function zo(rt){return rt&&rt.slice(0,cp(rt)+1).replace(se,"")}function $l(rt){return function(Tt){return rt(Tt)}}function Rd(rt,Tt){return Xi(Tt,(function(Rt){return rt[Rt]}))}function Kp(rt,Tt){return rt.has(Tt)}function sl(rt,Tt){for(var Rt=-1,tn=rt.length;++Rt<tn&&ih(Tt,rt[Rt],0)>-1;);return Rt}function eg(rt,Tt){for(var Rt=rt.length;Rt--&&ih(Tt,rt[Rt],0)>-1;);return Rt}var G_=Qm({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),$_=Qm({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function lp(rt){return"\\"+Uo[rt]}function jh(rt){return Mr.test(rt)}function Hh(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn,wn){Rt[++Tt]=[wn,tn]})),Rt}function Ku(rt,Tt){return function(Rt){return rt(Tt(Rt))}}function Zu(rt,Tt){for(var Rt=-1,tn=rt.length,wn=0,Zn=[];++Rt<tn;){var Ci=rt[Rt];Ci!==Tt&&Ci!==x||(rt[Rt]=x,Zn[wn++]=Rt)}return Zn}function tg(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=tn})),Rt}function ys(rt){return jh(rt)?(function(Tt){for(var Rt=ii.lastIndex=0;ii.test(Tt);)++Rt;return Rt})(rt):uo(rt)}function wa(rt){return jh(rt)?(function(Tt){return Tt.match(ii)||[]})(rt):(function(Tt){return Tt.split("")})(rt)}function cp(rt){for(var Tt=rt.length;Tt--&&_e.test(rt.charAt(Tt)););return Tt}var ng=Qm({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qh=(function rt(Tt){var Rt,tn=(Tt=Tt==null?ei:qh.defaults(ei.Object(),Tt,qh.pick(ei,Tr))).Array,wn=Tt.Date,Zn=Tt.Error,Ci=Tt.Function,al=Tt.Math,_r=Tt.Object,Eo=Tt.RegExp,wf=Tt.String,rs=Tt.TypeError,Mc=tn.prototype,lh=Ci.prototype,sr=_r.prototype,Oc=Tt["__core-js_shared__"],Ia=lh.toString,vr=sr.hasOwnProperty,Gr=0,ch=(Rt=/[^.]+$/.exec(Oc&&Oc.keys&&Oc.keys.IE_PROTO||""))?"Symbol(src)_1."+Rt:"",Rf=sr.toString,Q0=Ia.call(_r),Wl=ei._,rg=Eo("^"+Ia.call(vr).replace(je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xo=So?Tt.Buffer:_,jo=Tt.Symbol,xu=Tt.Uint8Array,Zg=xo?xo.allocUnsafe:_,Tu=Ku(_r.getPrototypeOf,_r),uh=_r.create,Zp=sr.propertyIsEnumerable,fh=Mc.splice,Af=jo?jo.isConcatSpreadable:_,Kc=jo?jo.iterator:_,Vi=jo?jo.toStringTag:_,wu=(function(){try{var d=go(_r,"defineProperty");return d({},"",{}),d}catch{}})(),W_=Tt.clearTimeout!==ei.clearTimeout&&Tt.clearTimeout,Y_=wn&&wn.now!==ei.Date.now&&wn.now,ig=Tt.setTimeout!==ei.setTimeout&&Tt.setTimeout,kc=al.ceil,Ad=al.floor,fo=_r.getOwnPropertySymbols,Cf=xo?xo.isBuffer:_,Yl=Tt.isFinite,sg=Mc.join,Jg=Ku(_r.keys,_r),vi=al.max,Ki=al.min,ag=wn.now,hh=Tt.parseInt,up=al.random,Fn=Mc.reverse,js=go(Tt,"DataView"),Mf=go(Tt,"Map"),To=go(Tt,"Promise"),Rl=go(Tt,"Set"),Ju=go(Tt,"WeakMap"),Of=go(_r,"create"),Ic=Ju&&new Ju,As={},Qg=Bc(js),Ks=Bc(Mf),e_=Bc(To),Al=Bc(Rl),fp=Bc(Ju),Ho=jo?jo.prototype:_,fc=Ho?Ho.valueOf:_,Fr=Ho?Ho.toString:_;function ve(d){if(ds(d)&&!Ar(d)&&!(d instanceof kn)){if(d instanceof Mi)return d;if(vr.call(d,"__wrapped__"))return om(d)}return new Mi(d)}var hc=(function(){function d(){}return function(b){if(!qr(b))return{};if(uh)return uh(b);d.prototype=b;var O=new d;return d.prototype=_,O}})();function eo(){}function Mi(d,b){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=_}function kn(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function ho(d){var b=-1,O=d==null?0:d.length;for(this.clear();++b<O;){var F=d[b];this.set(F[0],F[1])}}function po(d){var b=-1,O=d==null?0:d.length;for(this.clear();++b<O;){var F=d[b];this.set(F[0],F[1])}}function Zi(d){var b=-1,O=d==null?0:d.length;for(this.clear();++b<O;){var F=d[b];this.set(F[0],F[1])}}function hn(d){var b=-1,O=d==null?0:d.length;for(this.__data__=new Zi;++b<O;)this.add(d[b])}function Ti(d){var b=this.__data__=new po(d);this.size=b.size}function og(d,b){var O=Ar(d),F=!O&&Sr(d),ie=!O&&!F&&Ra(d),pe=!O&&!F&&!ie&&Di(d),ye=O||F||ie||pe,Re=ye?oh(d.length,wf):[],Pe=Re.length;for(var Fe in d)!b&&!vr.call(d,Fe)||ye&&(Fe=="length"||ie&&(Fe=="offset"||Fe=="parent")||pe&&(Fe=="buffer"||Fe=="byteLength"||Fe=="byteOffset")||of(Fe,Pe))||Re.push(Fe);return Re}function kf(d){var b=d.length;return b?d[ef(0,b-1)]:_}function If(d,b){return am(kl(d),Cl(b,0,d.length))}function lg(d){return am(kl(d))}function wo(d,b,O){(O!==_&&!aa(d[b],O)||O===_&&!(b in d))&&Na(d,b,O)}function Nc(d,b,O){var F=d[b];vr.call(d,b)&&aa(F,O)&&(O!==_||b in d)||Na(d,b,O)}function _a(d,b){for(var O=d.length;O--;)if(aa(d[O][0],b))return O;return-1}function hp(d,b,O,F){return fs(d,(function(ie,pe,ye){b(F,ie,O(ie),ye)})),F}function Ro(d,b){return d&&qs(b,Jr(b),d)}function Na(d,b,O){b=="__proto__"&&wu?wu(d,b,{configurable:!0,enumerable:!0,value:O,writable:!0}):d[b]=O}function dh(d,b){for(var O=-1,F=b.length,ie=tn(F),pe=d==null;++O<F;)ie[O]=pe?_:Ep(d,b[O]);return ie}function Cl(d,b,O){return d==d&&(O!==_&&(d=d<=O?d:O),b!==_&&(d=d>=b?d:b)),d}function Hs(d,b,O,F,ie,pe){var ye,Re=1&b,Pe=2&b,Fe=4&b;if(O&&(ye=ie?O(d,F,ie,pe):O(d)),ye!==_)return ye;if(!qr(d))return d;var Ye=Ar(d);if(Ye){if(ye=(function(gt){var kt=gt.length,wt=new gt.constructor(kt);return kt&&typeof gt[0]=="string"&&vr.call(gt,"index")&&(wt.index=gt.index,wt.input=gt.input),wt})(d),!Re)return kl(d,ye)}else{var dt=Vo(d),xt=dt==Q||dt==W;if(Ra(d))return em(d,Re);if(dt==ae||dt==G||xt&&!ie){if(ye=Pe||xt?{}:id(d),!Re)return Pe?(function(gt,kt){return qs(gt,vp(gt),kt)})(d,(function(gt,kt){return gt&&qs(kt,ao(kt),gt)})(ye,d)):(function(gt,kt){return qs(gt,Ql(gt),kt)})(d,Ro(ye,d))}else{if(!jr[dt])return ie?d:{};ye=(function(gt,kt,wt){var It,Ft=gt.constructor;switch(kt){case Me:return Hr(gt);case B:case $:return new Ft(+gt);case qe:return(function(Zt,Gt){var $t=Gt?Hr(Zt.buffer):Zt.buffer;return new Zt.constructor($t,Zt.byteOffset,Zt.byteLength)})(gt,wt);case Ne:case Ae:case Xe:case $e:case at:case pt:case oe:case Ue:case Ge:return Mu(gt,wt);case q:return new Ft;case Y:case le:return new Ft(gt);case K:return(function(Zt){var Gt=new Zt.constructor(Zt.source,Ze.exec(Zt));return Gt.lastIndex=Zt.lastIndex,Gt})(gt);case ne:return new Ft;case ce:return It=gt,fc?_r(fc.call(It)):{}}})(d,dt,Re)}}pe||(pe=new Ti);var Dt=pe.get(d);if(Dt)return Dt;pe.set(d,ye),cf(d)?d.forEach((function(gt){ye.add(Hs(gt,b,O,gt,d,pe))})):Aa(d)&&d.forEach((function(gt,kt){ye.set(kt,Hs(gt,b,O,kt,d,pe))}));var bt=Ye?_:(Fe?Pe?_p:Jl:Pe?ao:Jr)(d);return il(bt||d,(function(gt,kt){bt&&(gt=d[kt=gt]),Nc(ye,kt,Hs(gt,b,O,kt,d,pe))})),ye}function Ml(d,b,O){var F=O.length;if(d==null)return!F;for(d=_r(d);F--;){var ie=O[F],pe=b[ie],ye=d[ie];if(ye===_&&!(ie in d)||!pe(ye))return!1}return!0}function Vh(d,b,O){if(typeof d!="function")throw new rs(y);return Ld((function(){d.apply(_,O)}),b)}function Pc(d,b,O,F){var ie=-1,pe=Yu,ye=!0,Re=d.length,Pe=[],Fe=b.length;if(!Re)return Pe;O&&(b=Xi(b,$l(O))),F?(pe=Yi,ye=!1):b.length>=200&&(pe=Kp,ye=!1,b=new hn(b));e:for(;++ie<Re;){var Ye=d[ie],dt=O==null?Ye:O(Ye);if(Ye=F||Ye!==0?Ye:0,ye&&dt==dt){for(var xt=Fe;xt--;)if(b[xt]===dt)continue e;Pe.push(Ye)}else pe(b,dt,F)||Pe.push(Ye)}return Pe}ve.templateSettings={escape:ot,evaluate:lt,interpolate:ct,variable:"",imports:{_:ve}},ve.prototype=eo.prototype,ve.prototype.constructor=ve,Mi.prototype=hc(eo.prototype),Mi.prototype.constructor=Mi,kn.prototype=hc(eo.prototype),kn.prototype.constructor=kn,ho.prototype.clear=function(){this.__data__=Of?Of(null):{},this.size=0},ho.prototype.delete=function(d){var b=this.has(d)&&delete this.__data__[d];return this.size-=b?1:0,b},ho.prototype.get=function(d){var b=this.__data__;if(Of){var O=b[d];return O===v?_:O}return vr.call(b,d)?b[d]:_},ho.prototype.has=function(d){var b=this.__data__;return Of?b[d]!==_:vr.call(b,d)},ho.prototype.set=function(d,b){var O=this.__data__;return this.size+=this.has(d)?0:1,O[d]=Of&&b===_?v:b,this},po.prototype.clear=function(){this.__data__=[],this.size=0},po.prototype.delete=function(d){var b=this.__data__,O=_a(b,d);return!(O<0||(O==b.length-1?b.pop():fh.call(b,O,1),--this.size,0))},po.prototype.get=function(d){var b=this.__data__,O=_a(b,d);return O<0?_:b[O][1]},po.prototype.has=function(d){return _a(this.__data__,d)>-1},po.prototype.set=function(d,b){var O=this.__data__,F=_a(O,d);return F<0?(++this.size,O.push([d,b])):O[F][1]=b,this},Zi.prototype.clear=function(){this.size=0,this.__data__={hash:new ho,map:new(Mf||po),string:new ho}},Zi.prototype.delete=function(d){var b=br(this,d).delete(d);return this.size-=b?1:0,b},Zi.prototype.get=function(d){return br(this,d).get(d)},Zi.prototype.has=function(d){return br(this,d).has(d)},Zi.prototype.set=function(d,b){var O=br(this,d),F=O.size;return O.set(d,b),this.size+=O.size==F?0:1,this},hn.prototype.add=hn.prototype.push=function(d){return this.__data__.set(d,v),this},hn.prototype.has=function(d){return this.__data__.has(d)},Ti.prototype.clear=function(){this.__data__=new po,this.size=0},Ti.prototype.delete=function(d){var b=this.__data__,O=b.delete(d);return this.size=b.size,O},Ti.prototype.get=function(d){return this.__data__.get(d)},Ti.prototype.has=function(d){return this.__data__.has(d)},Ti.prototype.set=function(d,b){var O=this.__data__;if(O instanceof po){var F=O.__data__;if(!Mf||F.length<199)return F.push([d,b]),this.size=++O.size,this;O=this.__data__=new Zi(F)}return O.set(d,b),this.size=O.size,this};var fs=Id(Zs),dc=Id(Ao,!0);function Gh(d,b){var O=!0;return fs(d,(function(F,ie,pe){return O=!!b(F,ie,pe)})),O}function Xl(d,b,O){for(var F=-1,ie=d.length;++F<ie;){var pe=d[F],ye=b(pe);if(ye!=null&&(Re===_?ye==ye&&!Os(ye):O(ye,Re)))var Re=ye,Pe=pe}return Pe}function Ru(d,b){var O=[];return fs(d,(function(F,ie,pe){b(F,ie,pe)&&O.push(F)})),O}function ai(d,b,O,F,ie){var pe=-1,ye=d.length;for(O||(O=t0),ie||(ie=[]);++pe<ye;){var Re=d[pe];b>0&&O(Re)?b>1?ai(Re,b-1,O,F,ie):Cc(ie,Re):F||(ie[ie.length]=Re)}return ie}var $h=Nd(),Jp=Nd(!0);function Zs(d,b){return d&&$h(d,b,Jr)}function Ao(d,b){return d&&Jp(d,b,Jr)}function Cs(d,b){return Wc(b,(function(O){return $a(d[O])}))}function ti(d,b){for(var O=0,F=(b=Mo(b,d)).length;d!=null&&O<F;)d=d[ml(b[O++])];return O&&O==F?d:_}function Dc(d,b,O){var F=b(d);return Ar(d)?F:Cc(F,O(d))}function yi(d){return d==null?d===_?"[object Undefined]":"[object Null]":Vi&&Vi in _r(d)?(function(b){var O=vr.call(b,Vi),F=b[Vi];try{b[Vi]=_;var ie=!0}catch{}var pe=Rf.call(b);return ie&&(O?b[Vi]=F:delete b[Vi]),pe})(d):(function(b){return Rf.call(b)})(d)}function Wh(d,b){return d>b}function Yh(d,b){return d!=null&&vr.call(d,b)}function X_(d,b){return d!=null&&b in _r(d)}function Cd(d,b,O){for(var F=O?Yi:Yu,ie=d[0].length,pe=d.length,ye=pe,Re=tn(pe),Pe=1/0,Fe=[];ye--;){var Ye=d[ye];ye&&b&&(Ye=Xi(Ye,$l(b))),Pe=Ki(Ye.length,Pe),Re[ye]=!O&&(b||ie>=120&&Ye.length>=120)?new hn(ye&&Ye):_}Ye=d[0];var dt=-1,xt=Re[0];e:for(;++dt<ie&&Fe.length<Pe;){var Dt=Ye[dt],bt=b?b(Dt):Dt;if(Dt=O||Dt!==0?Dt:0,!(xt?Kp(xt,bt):F(Fe,bt,O))){for(ye=pe;--ye;){var gt=Re[ye];if(!(gt?Kp(gt,bt):F(d[ye],bt,O)))continue e}xt&&xt.push(bt),Fe.push(Dt)}}return Fe}function ol(d,b,O){var F=(d=im(d,b=Mo(b,d)))==null?d:d[ml(ec(b))];return F==null?_:cc(F,d,O)}function Jn(d){return ds(d)&&yi(d)==G}function Pi(d,b,O,F,ie){return d===b||(d==null||b==null||!ds(d)&&!ds(b)?d!=d&&b!=b:(function(pe,ye,Re,Pe,Fe,Ye){var dt=Ar(pe),xt=Ar(ye),Dt=dt?J:Vo(pe),bt=xt?J:Vo(ye),gt=(Dt=Dt==G?ae:Dt)==ae,kt=(bt=bt==G?ae:bt)==ae,wt=Dt==bt;if(wt&&Ra(pe)){if(!Ra(ye))return!1;dt=!0,gt=!1}if(wt&&!gt)return Ye||(Ye=new Ti),dt||Di(pe)?gp(pe,ye,Re,Pe,Fe,Ye):(function($t,dn,Rn,Nn,qn,Dn,gr){switch(Rn){case qe:if($t.byteLength!=dn.byteLength||$t.byteOffset!=dn.byteOffset)return!1;$t=$t.buffer,dn=dn.buffer;case Me:return!($t.byteLength!=dn.byteLength||!Dn(new xu($t),new xu(dn)));case B:case $:case Y:return aa(+$t,+dn);case U:return $t.name==dn.name&&$t.message==dn.message;case K:case le:return $t==dn+"";case q:var Br=Hh;case ne:var Oi=1&Nn;if(Br||(Br=tg),$t.size!=dn.size&&!Oi)return!1;var oi=gr.get($t);if(oi)return oi==dn;Nn|=2,gr.set($t,dn);var li=gp(Br($t),Br(dn),Nn,qn,Dn,gr);return gr.delete($t),li;case ce:if(fc)return fc.call($t)==fc.call(dn)}return!1})(pe,ye,Dt,Re,Pe,Fe,Ye);if(!(1&Re)){var It=gt&&vr.call(pe,"__wrapped__"),Ft=kt&&vr.call(ye,"__wrapped__");if(It||Ft){var Zt=It?pe.value():pe,Gt=Ft?ye.value():ye;return Ye||(Ye=new Ti),Fe(Zt,Gt,Re,Pe,Ye)}}return!!wt&&(Ye||(Ye=new Ti),(function($t,dn,Rn,Nn,qn,Dn){var gr=1&Rn,Br=Jl($t),Oi=Br.length;if(Oi!=Jl(dn).length&&!gr)return!1;for(var oi=Oi;oi--;){var li=Br[oi];if(!(gr?li in dn:vr.call(dn,li)))return!1}var Fi=Dn.get($t),Yr=Dn.get(dn);if(Fi&&Yr)return Fi==dn&&Yr==$t;var Ss=!0;Dn.set($t,dn),Dn.set(dn,$t);for(var ci=gr;++oi<Oi;){var Is=$t[li=Br[oi]],$i=dn[li];if(Nn)var ea=gr?Nn($i,Is,li,dn,$t,Dn):Nn(Is,$i,li,$t,dn,Dn);if(!(ea===_?Is===$i||qn(Is,$i,Rn,Nn,Dn):ea)){Ss=!1;break}ci||(ci=li=="constructor")}if(Ss&&!ci){var Ns=$t.constructor,ms=dn.constructor;Ns==ms||!("constructor"in $t)||!("constructor"in dn)||typeof Ns=="function"&&Ns instanceof Ns&&typeof ms=="function"&&ms instanceof ms||(Ss=!1)}return Dn.delete($t),Dn.delete(dn),Ss})(pe,ye,Re,Pe,Fe,Ye))})(d,b,O,F,Pi,ie))}function Zc(d,b,O,F){var ie=O.length,pe=ie,ye=!F;if(d==null)return!pe;for(d=_r(d);ie--;){var Re=O[ie];if(ye&&Re[2]?Re[1]!==d[Re[0]]:!(Re[0]in d))return!1}for(;++ie<pe;){var Pe=(Re=O[ie])[0],Fe=d[Pe],Ye=Re[1];if(ye&&Re[2]){if(Fe===_&&!(Pe in d))return!1}else{var dt=new Ti;if(F)var xt=F(Fe,Ye,Pe,d,b,dt);if(!(xt===_?Pi(Ye,Fe,3,F,dt):xt))return!1}}return!0}function mo(d){return!(!qr(d)||(b=d,ch&&ch in b))&&($a(d)?rg:Je).test(Bc(d));var b}function Nf(d){return typeof d=="function"?d:d==null?ps:typeof d=="object"?Ar(d)?Md(d[0],d[1]):Qp(d):hm(d)}function Jc(d){if(!nm(d))return Jg(d);var b=[];for(var O in _r(d))vr.call(d,O)&&O!="constructor"&&b.push(O);return b}function ph(d,b){return d<b}function Qc(d,b){var O=-1,F=Ui(d)?tn(d.length):[];return fs(d,(function(ie,pe,ye){F[++O]=b(ie,pe,ye)})),F}function Qp(d){var b=rd(d);return b.length==1&&b[0][2]?rm(b[0][0],b[0][1]):function(O){return O===d||Zc(O,d,b)}}function Md(d,b){return Go(d)&&Va(b)?rm(ml(d),b):function(O){var F=Ep(O,d);return F===_&&F===b?_l(O,d):Pi(b,F,3)}}function Co(d,b,O,F,ie){d!==b&&$h(b,(function(pe,ye){if(ie||(ie=new Ti),qr(pe))(function(Pe,Fe,Ye,dt,xt,Dt,bt){var gt=sm(Pe,Ye),kt=sm(Fe,Ye),wt=bt.get(kt);if(wt)wo(Pe,Ye,wt);else{var It=Dt?Dt(gt,kt,Ye+"",Pe,Fe,bt):_,Ft=It===_;if(Ft){var Zt=Ar(kt),Gt=!Zt&&Ra(kt),$t=!Zt&&!Gt&&Di(kt);It=kt,Zt||Gt||$t?Ar(gt)?It=gt:oa(gt)?It=kl(gt):Gt?(Ft=!1,It=em(kt,!0)):$t?(Ft=!1,It=Mu(kt,!0)):It=[]:Gi(kt)||Sr(kt)?(It=gt,Sr(gt)?It=Wr(gt):qr(gt)&&!$a(gt)||(It=id(kt))):Ft=!1}Ft&&(bt.set(kt,It),xt(It,kt,dt,Dt,bt),bt.delete(kt)),wo(Pe,Ye,It)}})(d,b,ye,O,Co,F,ie);else{var Re=F?F(sm(d,ye),pe,ye+"",d,b,ie):_;Re===_&&(Re=pe),wo(d,ye,Re)}}),ao)}function Xh(d,b){var O=d.length;if(O)return of(b+=b<0?O:0,O)?d[b]:_}function Qu(d,b,O){b=b.length?Xi(b,(function(pe){return Ar(pe)?function(ye){return ti(ye,pe.length===1?pe[0]:pe)}:pe})):[ps];var F=-1;b=Xi(b,$l(dr()));var ie=Qc(d,(function(pe,ye,Re){var Pe=Xi(b,(function(Fe){return Fe(pe)}));return{criteria:Pe,index:++F,value:pe}}));return(function(pe){var ye=pe.length;for(pe.sort((function(Re,Pe){return(function(Fe,Ye,dt){for(var xt=-1,Dt=Fe.criteria,bt=Ye.criteria,gt=Dt.length,kt=dt.length;++xt<gt;){var wt=Pf(Dt[xt],bt[xt]);if(wt)return xt>=kt?wt:wt*(dt[xt]=="desc"?-1:1)}return Fe.index-Ye.index})(Re,Pe,O)}));ye--;)pe[ye]=pe[ye].value;return pe})(ie)}function Pa(d,b,O){for(var F=-1,ie=b.length,pe={};++F<ie;){var ye=b[F],Re=ti(d,ye);O(Re,ye)&&Kl(pe,Mo(ye,d),Re)}return pe}function Kh(d,b,O,F){var ie=F?ga:ih,pe=-1,ye=b.length,Re=d;for(d===b&&(b=kl(b)),O&&(Re=Xi(d,$l(O)));++pe<ye;)for(var Pe=0,Fe=b[pe],Ye=O?O(Fe):Fe;(Pe=ie(Re,Ye,Pe,F))>-1;)Re!==d&&fh.call(Re,Pe,1),fh.call(d,Pe,1);return d}function dp(d,b){for(var O=d?b.length:0,F=O-1;O--;){var ie=b[O];if(O==F||ie!==pe){var pe=ie;of(ie)?fh.call(d,ie,1):Lc(d,ie)}}return d}function ef(d,b){return d+Ad(up()*(b-d+1))}function mh(d,b){var O="";if(!d||b<1||b>N)return O;do b%2&&(O+=d),(b=Ad(b/2))&&(d+=d);while(b);return O}function Ur(d,b){return Iu(n0(d,b,ps),d+"")}function yr(d){return kf(au(d))}function ll(d,b){var O=au(d);return am(O,Cl(b,0,O.length))}function Kl(d,b,O,F){if(!qr(d))return d;for(var ie=-1,pe=(b=Mo(b,d)).length,ye=pe-1,Re=d;Re!=null&&++ie<pe;){var Pe=ml(b[ie]),Fe=O;if(Pe==="__proto__"||Pe==="constructor"||Pe==="prototype")return d;if(ie!=ye){var Ye=Re[Pe];(Fe=F?F(Ye,Pe,Re):_)===_&&(Fe=qr(Ye)?Ye:of(b[ie+1])?[]:{})}Nc(Re,Pe,Fe),Re=Re[Pe]}return d}var wi=Ic?function(d,b){return Ic.set(d,b),d}:ps,pp=wu?function(d,b){return wu(d,"toString",{configurable:!0,enumerable:!1,value:bh(b),writable:!0})}:ps;function zr(d){return am(au(d))}function Ol(d,b,O){var F=-1,ie=d.length;b<0&&(b=-b>ie?0:ie+b),(O=O>ie?ie:O)<0&&(O+=ie),ie=b>O?0:O-b>>>0,b>>>=0;for(var pe=tn(ie);++F<ie;)pe[F]=d[F+b];return pe}function Da(d,b){var O;return fs(d,(function(F,ie,pe){return!(O=b(F,ie,pe))})),!!O}function Od(d,b,O){var F=0,ie=d==null?F:d.length;if(typeof b=="number"&&b==b&&ie<=2147483647){for(;F<ie;){var pe=F+ie>>>1,ye=d[pe];ye!==null&&!Os(ye)&&(O?ye<=b:ye<b)?F=pe+1:ie=pe}return ie}return mp(d,b,ps,O)}function mp(d,b,O,F){var ie=0,pe=d==null?0:d.length;if(pe===0)return 0;for(var ye=(b=O(b))!=b,Re=b===null,Pe=Os(b),Fe=b===_;ie<pe;){var Ye=Ad((ie+pe)/2),dt=O(d[Ye]),xt=dt!==_,Dt=dt===null,bt=dt==dt,gt=Os(dt);if(ye)var kt=F||bt;else kt=Fe?bt&&(F||xt):Re?bt&&xt&&(F||!Dt):Pe?bt&&xt&&!Dt&&(F||!gt):!Dt&&!gt&&(F?dt<=b:dt<b);kt?ie=Ye+1:pe=Ye}return Ki(pe,4294967294)}function cl(d,b){for(var O=-1,F=d.length,ie=0,pe=[];++O<F;){var ye=d[O],Re=b?b(ye):ye;if(!O||!aa(Re,Pe)){var Pe=Re;pe[ie++]=ye===0?0:ye}}return pe}function Zl(d){return typeof d=="number"?d:Os(d)?I:+d}function Ha(d){if(typeof d=="string")return d;if(Ar(d))return Xi(d,Ha)+"";if(Os(d))return Fr?Fr.call(d):"";var b=d+"";return b=="0"&&1/d==-1/0?"-0":b}function ia(d,b,O){var F=-1,ie=Yu,pe=d.length,ye=!0,Re=[],Pe=Re;if(O)ye=!1,ie=Yi;else if(pe>=200){var Fe=b?null:e0(d);if(Fe)return tg(Fe);ye=!1,ie=Kp,Pe=new hn}else Pe=b?[]:Re;e:for(;++F<pe;){var Ye=d[F],dt=b?b(Ye):Ye;if(Ye=O||Ye!==0?Ye:0,ye&&dt==dt){for(var xt=Pe.length;xt--;)if(Pe[xt]===dt)continue e;b&&Pe.push(dt),Re.push(Ye)}else ie(Pe,dt,O)||(Pe!==Re&&Pe.push(dt),Re.push(Ye))}return Re}function Lc(d,b){return(d=im(d,b=Mo(b,d)))==null||delete d[ml(ec(b))]}function kd(d,b,O,F){return Kl(d,b,O(ti(d,b)),F)}function Au(d,b,O,F){for(var ie=d.length,pe=F?ie:-1;(F?pe--:++pe<ie)&&b(d[pe],pe,d););return O?Ol(d,F?0:pe,F?pe+1:ie):Ol(d,F?pe+1:0,F?ie:pe)}function to(d,b){var O=d;return O instanceof kn&&(O=O.value()),Ef(b,(function(F,ie){return ie.func.apply(ie.thisArg,Cc([F],ie.args))}),O)}function tf(d,b,O){var F=d.length;if(F<2)return F?ia(d[0]):[];for(var ie=-1,pe=tn(F);++ie<F;)for(var ye=d[ie],Re=-1;++Re<F;)Re!=ie&&(pe[ie]=Pc(pe[ie]||ye,d[Re],b,O));return ia(ai(pe,1),b,O)}function Uc(d,b,O){for(var F=-1,ie=d.length,pe=b.length,ye={};++F<ie;){var Re=F<pe?b[F]:_;O(ye,d[F],Re)}return ye}function nf(d){return oa(d)?d:[]}function Cu(d){return typeof d=="function"?d:ps}function Mo(d,b){return Ar(d)?d:Go(d,b)?[d]:Nu(is(d))}var rf=Ur;function sf(d,b,O){var F=d.length;return O=O===_?F:O,!b&&O>=F?d:Ol(d,b,O)}var Oo=W_||function(d){return ei.clearTimeout(d)};function em(d,b){if(b)return d.slice();var O=d.length,F=Zg?Zg(O):new d.constructor(O);return d.copy(F),F}function Hr(d){var b=new d.constructor(d.byteLength);return new xu(b).set(new xu(d)),b}function Mu(d,b){var O=b?Hr(d.buffer):d.buffer;return new d.constructor(O,d.byteOffset,d.length)}function Pf(d,b){if(d!==b){var O=d!==_,F=d===null,ie=d==d,pe=Os(d),ye=b!==_,Re=b===null,Pe=b==b,Fe=Os(b);if(!Re&&!Fe&&!pe&&d>b||pe&&ye&&Pe&&!Re&&!Fe||F&&ye&&Pe||!O&&Pe||!ie)return 1;if(!F&&!pe&&!Fe&&d<b||Fe&&O&&ie&&!F&&!pe||Re&&O&&ie||!ye&&ie||!Pe)return-1}return 0}function Zh(d,b,O,F){for(var ie=-1,pe=d.length,ye=O.length,Re=-1,Pe=b.length,Fe=vi(pe-ye,0),Ye=tn(Pe+Fe),dt=!F;++Re<Pe;)Ye[Re]=b[Re];for(;++ie<ye;)(dt||ie<pe)&&(Ye[O[ie]]=d[ie]);for(;Fe--;)Ye[Re++]=d[ie++];return Ye}function Jh(d,b,O,F){for(var ie=-1,pe=d.length,ye=-1,Re=O.length,Pe=-1,Fe=b.length,Ye=vi(pe-Re,0),dt=tn(Ye+Fe),xt=!F;++ie<Ye;)dt[ie]=d[ie];for(var Dt=ie;++Pe<Fe;)dt[Dt+Pe]=b[Pe];for(;++ye<Re;)(xt||ie<pe)&&(dt[Dt+O[ye]]=d[ie++]);return dt}function kl(d,b){var O=-1,F=d.length;for(b||(b=tn(F));++O<F;)b[O]=d[O];return b}function qs(d,b,O,F){var ie=!O;O||(O={});for(var pe=-1,ye=b.length;++pe<ye;){var Re=b[pe],Pe=F?F(O[Re],d[Re],Re,O,d):_;Pe===_&&(Pe=d[Re]),ie?Na(O,Re,Pe):Nc(O,Re,Pe)}return O}function Il(d,b){return function(O,F){var ie=Ar(O)?Fo:hp,pe=b?b():{};return ie(O,d,dr(F,2),pe)}}function eu(d){return Ur((function(b,O){var F=-1,ie=O.length,pe=ie>1?O[ie-1]:_,ye=ie>2?O[2]:_;for(pe=d.length>3&&typeof pe=="function"?(ie--,pe):_,ye&&Ua(O[0],O[1],ye)&&(pe=ie<3?_:pe,ie=1),b=_r(b);++F<ie;){var Re=O[F];Re&&d(b,Re,F,pe)}return b}))}function Id(d,b){return function(O,F){if(O==null)return O;if(!Ui(O))return d(O,F);for(var ie=O.length,pe=b?ie:-1,ye=_r(O);(b?pe--:++pe<ie)&&F(ye[pe],pe,ye)!==!1;);return O}}function Nd(d){return function(b,O,F){for(var ie=-1,pe=_r(b),ye=F(b),Re=ye.length;Re--;){var Pe=ye[d?Re:++ie];if(O(pe[Pe],Pe,pe)===!1)break}return b}}function tm(d){return function(b){var O=jh(b=is(b))?wa(b):_,F=O?O[0]:b.charAt(0),ie=O?sf(O,1).join(""):b.slice(1);return F[d]()+ie}}function Qh(d){return function(b){return Ef(Bi(ua(b).replace(rr,"")),d,"")}}function Ou(d){return function(){var b=arguments;switch(b.length){case 0:return new d;case 1:return new d(b[0]);case 2:return new d(b[0],b[1]);case 3:return new d(b[0],b[1],b[2]);case 4:return new d(b[0],b[1],b[2],b[3]);case 5:return new d(b[0],b[1],b[2],b[3],b[4]);case 6:return new d(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new d(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var O=hc(d.prototype),F=d.apply(O,b);return qr(F)?F:O}}function ul(d){return function(b,O,F){var ie=_r(b);if(!Ui(b)){var pe=dr(O,3);b=Jr(b),O=function(Re){return pe(ie[Re],Re,ie)}}var ye=d(b,O,F);return ye>-1?ie[pe?b[ye]:ye]:_}}function af(d){return hl((function(b){var O=b.length,F=O,ie=Mi.prototype.thru;for(d&&b.reverse();F--;){var pe=b[F];if(typeof pe!="function")throw new rs(y);if(ie&&!ye&&sa(pe)=="wrapper")var ye=new Mi([],!0)}for(F=ye?F:O;++F<O;){var Re=sa(pe=b[F]),Pe=Re=="wrapper"?dl(pe):_;ye=Pe&&Pd(Pe[0])&&Pe[1]==424&&!Pe[4].length&&Pe[9]==1?ye[sa(Pe[0])].apply(ye,Pe[3]):pe.length==1&&Pd(pe)?ye[Re]():ye.thru(pe)}return function(){var Fe=arguments,Ye=Fe[0];if(ye&&Fe.length==1&&Ar(Ye))return ye.plant(Ye).value();for(var dt=0,xt=O?b[dt].apply(this,Fe):Ye;++dt<O;)xt=b[dt].call(this,xt);return xt}}))}function Zr(d,b,O,F,ie,pe,ye,Re,Pe,Fe){var Ye=b&M,dt=1&b,xt=2&b,Dt=24&b,bt=512&b,gt=xt?_:Ou(d);return function kt(){for(var wt=arguments.length,It=tn(wt),Ft=wt;Ft--;)It[Ft]=arguments[Ft];if(Dt)var Zt=mc(kt),Gt=(function(Nn,qn){for(var Dn=Nn.length,gr=0;Dn--;)Nn[Dn]===qn&&++gr;return gr})(It,Zt);if(F&&(It=Zh(It,F,ie,Dt)),pe&&(It=Jh(It,pe,ye,Dt)),wt-=Gt,Dt&&wt<Fe){var $t=Zu(It,Zt);return pc(d,b,Zr,kt.placeholder,O,It,$t,Re,Pe,Fe-wt)}var dn=dt?O:this,Rn=xt?dn[d]:d;return wt=It.length,Re?It=(function(Nn,qn){for(var Dn=Nn.length,gr=Ki(qn.length,Dn),Br=kl(Nn);gr--;){var Oi=qn[gr];Nn[gr]=of(Oi,Dn)?Br[Oi]:_}return Nn})(It,Re):bt&&wt>1&&It.reverse(),Ye&&Pe<wt&&(It.length=Pe),this&&this!==ei&&this instanceof kt&&(Rn=gt||Ou(Rn)),Rn.apply(dn,It)}}function hs(d,b){return function(O,F){return(function(ie,pe,ye,Re){return Zs(ie,(function(Pe,Fe,Ye){pe(Re,ye(Pe),Fe,Ye)})),Re})(O,d,b(F),{})}}function qa(d,b){return function(O,F){var ie;if(O===_&&F===_)return b;if(O!==_&&(ie=O),F!==_){if(ie===_)return F;typeof O=="string"||typeof F=="string"?(O=Ha(O),F=Ha(F)):(O=Zl(O),F=Zl(F)),ie=d(O,F)}return ie}}function ed(d){return hl((function(b){return b=Xi(b,$l(dr())),Ur((function(O){var F=this;return d(b,(function(ie){return cc(ie,F,O)}))}))}))}function ku(d,b){var O=(b=b===_?" ":Ha(b)).length;if(O<2)return O?mh(b,d):b;var F=mh(b,kc(d/ys(b)));return jh(b)?sf(wa(F),0,d).join(""):F.slice(0,d)}function fl(d){return function(b,O,F){return F&&typeof F!="number"&&Ua(b,O,F)&&(O=F=_),b=mr(b),O===_?(O=b,b=0):O=mr(O),(function(ie,pe,ye,Re){for(var Pe=-1,Fe=vi(kc((pe-ie)/(ye||1)),0),Ye=tn(Fe);Fe--;)Ye[Re?Fe:++Pe]=ie,ie+=ye;return Ye})(b,O,F=F===_?b<O?1:-1:mr(F),d)}}function no(d){return function(b,O){return typeof b=="string"&&typeof O=="string"||(b=Ya(b),O=Ya(O)),d(b,O)}}function pc(d,b,O,F,ie,pe,ye,Re,Pe,Fe){var Ye=8&b;b|=Ye?E:64,4&(b&=~(Ye?64:E))||(b&=-4);var dt=[d,b,ie,Ye?pe:_,Ye?ye:_,Ye?_:pe,Ye?_:ye,Re,Pe,Fe],xt=O.apply(_,dt);return Pd(d)&&Dd(xt,dt),xt.placeholder=F,ug(xt,d,b)}function qo(d){var b=al[d];return function(O,F){if(O=Ya(O),(F=F==null?0:Ki(fr(F),292))&&Yl(O)){var ie=(is(O)+"e").split("e");return+((ie=(is(b(ie[0]+"e"+(+ie[1]+F)))+"e").split("e"))[0]+"e"+(+ie[1]-F))}return b(O)}}var e0=Rl&&1/tg(new Rl([,-0]))[1]==k?function(d){return new Rl(d)}:hi;function La(d){return function(b){var O=Vo(b);return O==q?Hh(b):O==ne?(function(F){var ie=-1,pe=Array(F.size);return F.forEach((function(ye){pe[++ie]=[ye,ye]})),pe})(b):(function(F,ie){return Xi(ie,(function(pe){return[pe,F[pe]]}))})(b,d(b))}}function Js(d,b,O,F,ie,pe,ye,Re){var Pe=2&b;if(!Pe&&typeof d!="function")throw new rs(y);var Fe=F?F.length:0;if(Fe||(b&=-97,F=ie=_),ye=ye===_?ye:vi(fr(ye),0),Re=Re===_?Re:fr(Re),Fe-=ie?ie.length:0,64&b){var Ye=F,dt=ie;F=ie=_}var xt=Pe?_:dl(d),Dt=[d,b,O,F,ie,Ye,dt,pe,ye,Re];if(xt&&(function(gt,kt){var wt=gt[1],It=kt[1],Ft=wt|It,Zt=Ft<131,Gt=It==M&&wt==8||It==M&&wt==256&&gt[7].length<=kt[8]||It==384&&kt[7].length<=kt[8]&&wt==8;if(!Zt&&!Gt)return gt;1&It&&(gt[2]=kt[2],Ft|=1&wt?0:4);var $t=kt[3];if($t){var dn=gt[3];gt[3]=dn?Zh(dn,$t,kt[4]):$t,gt[4]=dn?Zu(gt[3],x):kt[4]}($t=kt[5])&&(dn=gt[5],gt[5]=dn?Jh(dn,$t,kt[6]):$t,gt[6]=dn?Zu(gt[5],x):kt[6]),($t=kt[7])&&(gt[7]=$t),It&M&&(gt[8]=gt[8]==null?kt[8]:Ki(gt[8],kt[8])),gt[9]==null&&(gt[9]=kt[9]),gt[0]=kt[0],gt[1]=Ft})(Dt,xt),d=Dt[0],b=Dt[1],O=Dt[2],F=Dt[3],ie=Dt[4],!(Re=Dt[9]=Dt[9]===_?Pe?0:d.length:vi(Dt[9]-Fe,0))&&24&b&&(b&=-25),b&&b!=1)bt=b==8||b==16?(function(gt,kt,wt){var It=Ou(gt);return function Ft(){for(var Zt=arguments.length,Gt=tn(Zt),$t=Zt,dn=mc(Ft);$t--;)Gt[$t]=arguments[$t];var Rn=Zt<3&&Gt[0]!==dn&&Gt[Zt-1]!==dn?[]:Zu(Gt,dn);return(Zt-=Rn.length)<wt?pc(gt,kt,Zr,Ft.placeholder,_,Gt,Rn,_,_,wt-Zt):cc(this&&this!==ei&&this instanceof Ft?It:gt,this,Gt)}})(d,b,Re):b!=E&&b!=33||ie.length?Zr.apply(_,Dt):(function(gt,kt,wt,It){var Ft=1&kt,Zt=Ou(gt);return function Gt(){for(var $t=-1,dn=arguments.length,Rn=-1,Nn=It.length,qn=tn(Nn+dn),Dn=this&&this!==ei&&this instanceof Gt?Zt:gt;++Rn<Nn;)qn[Rn]=It[Rn];for(;dn--;)qn[Rn++]=arguments[++$t];return cc(Dn,Ft?wt:this,qn)}})(d,b,O,F);else var bt=(function(gt,kt,wt){var It=1&kt,Ft=Ou(gt);return function Zt(){return(this&&this!==ei&&this instanceof Zt?Ft:gt).apply(It?wt:this,arguments)}})(d,b,O);return ug((xt?wi:Dd)(bt,Dt),d,b)}function ro(d,b,O,F){return d===_||aa(d,sr[O])&&!vr.call(F,O)?b:d}function td(d,b,O,F,ie,pe){return qr(d)&&qr(b)&&(pe.set(b,d),Co(d,b,_,td,pe),pe.delete(b)),d}function nd(d){return Gi(d)?_:d}function gp(d,b,O,F,ie,pe){var ye=1&O,Re=d.length,Pe=b.length;if(Re!=Pe&&!(ye&&Pe>Re))return!1;var Fe=pe.get(d),Ye=pe.get(b);if(Fe&&Ye)return Fe==b&&Ye==d;var dt=-1,xt=!0,Dt=2&O?new hn:_;for(pe.set(d,b),pe.set(b,d);++dt<Re;){var bt=d[dt],gt=b[dt];if(F)var kt=ye?F(gt,bt,dt,b,d,pe):F(bt,gt,dt,d,b,pe);if(kt!==_){if(kt)continue;xt=!1;break}if(Dt){if(!uc(b,(function(wt,It){if(!Kp(Dt,It)&&(bt===wt||ie(bt,wt,O,F,pe)))return Dt.push(It)}))){xt=!1;break}}else if(bt!==gt&&!ie(bt,gt,O,F,pe)){xt=!1;break}}return pe.delete(d),pe.delete(b),xt}function hl(d){return Iu(n0(d,_,cm),d+"")}function Jl(d){return Dc(d,Jr,Ql)}function _p(d){return Dc(d,ao,vp)}var dl=Ic?function(d){return Ic.get(d)}:hi;function sa(d){for(var b=d.name+"",O=As[b],F=vr.call(As,b)?O.length:0;F--;){var ie=O[F],pe=ie.func;if(pe==null||pe==d)return ie.name}return b}function mc(d){return(vr.call(ve,"placeholder")?ve:d).placeholder}function dr(){var d=ve.iteratee||Qs;return d=d===Qs?Nf:d,arguments.length?d(arguments[0],arguments[1]):d}function br(d,b){var O,F,ie=d.__data__;return((F=typeof(O=b))=="string"||F=="number"||F=="symbol"||F=="boolean"?O!=="__proto__":O===null)?ie[typeof b=="string"?"string":"hash"]:ie.map}function rd(d){for(var b=Jr(d),O=b.length;O--;){var F=b[O],ie=d[F];b[O]=[F,ie,Va(ie)]}return b}function go(d,b){var O=(function(F,ie){return F==null?_:F[ie]})(d,b);return mo(O)?O:_}var Ql=fo?function(d){return d==null?[]:(d=_r(d),Wc(fo(d),(function(b){return Zp.call(d,b)})))}:Uu,vp=fo?function(d){for(var b=[];d;)Cc(b,Ql(d)),d=Tu(d);return b}:Uu,Vo=yi;function pl(d,b,O){for(var F=-1,ie=(b=Mo(b,d)).length,pe=!1;++F<ie;){var ye=ml(b[F]);if(!(pe=d!=null&&O(d,ye)))break;d=d[ye]}return pe||++F!=ie?pe:!!(ie=d==null?0:d.length)&&la(ie)&&of(ye,ie)&&(Ar(d)||Sr(d))}function id(d){return typeof d.constructor!="function"||nm(d)?{}:hc(Tu(d))}function t0(d){return Ar(d)||Sr(d)||!!(Af&&d&&d[Af])}function of(d,b){var O=typeof d;return!!(b=b??N)&&(O=="number"||O!="symbol"&&mt.test(d))&&d>-1&&d%1==0&&d<b}function Ua(d,b,O){if(!qr(O))return!1;var F=typeof b;return!!(F=="number"?Ui(O)&&of(b,O.length):F=="string"&&b in O)&&aa(O[b],d)}function Go(d,b){if(Ar(d))return!1;var O=typeof d;return!(O!="number"&&O!="symbol"&&O!="boolean"&&d!=null&&!Os(d))||Ot.test(d)||!Vt.test(d)||b!=null&&d in _r(b)}function Pd(d){var b=sa(d),O=ve[b];if(typeof O!="function"||!(b in kn.prototype))return!1;if(d===O)return!0;var F=dl(O);return!!F&&d===F[0]}(js&&Vo(new js(new ArrayBuffer(1)))!=qe||Mf&&Vo(new Mf)!=q||To&&Vo(To.resolve())!=Z||Rl&&Vo(new Rl)!=ne||Ju&&Vo(new Ju)!=de)&&(Vo=function(d){var b=yi(d),O=b==ae?d.constructor:_,F=O?Bc(O):"";if(F)switch(F){case Qg:return qe;case Ks:return q;case e_:return Z;case Al:return ne;case fp:return de}return b});var cg=Oc?$a:j;function nm(d){var b=d&&d.constructor;return d===(typeof b=="function"&&b.prototype||sr)}function Va(d){return d==d&&!qr(d)}function rm(d,b){return function(O){return O!=null&&O[d]===b&&(b!==_||d in _r(O))}}function n0(d,b,O){return b=vi(b===_?d.length-1:b,0),function(){for(var F=arguments,ie=-1,pe=vi(F.length-b,0),ye=tn(pe);++ie<pe;)ye[ie]=F[b+ie];ie=-1;for(var Re=tn(b+1);++ie<b;)Re[ie]=F[ie];return Re[b]=O(ye),cc(d,this,Re)}}function im(d,b){return b.length<2?d:ti(d,Ol(b,0,-1))}function sm(d,b){if((b!=="constructor"||typeof d[b]!="function")&&b!="__proto__")return d[b]}var Dd=t_(wi),Ld=ig||function(d,b){return ei.setTimeout(d,b)},Iu=t_(pp);function ug(d,b,O){var F=b+"";return Iu(d,(function(ie,pe){var ye=pe.length;if(!ye)return ie;var Re=ye-1;return pe[Re]=(ye>1?"& ":"")+pe[Re],pe=pe.join(ye>2?", ":" "),ie.replace(Ie,`{
/* [wrapped with `+pe+`] */
`)})(F,(function(ie,pe){return il(V,(function(ye){var Re="_."+ye[0];pe&ye[1]&&!Yu(ie,Re)&&ie.push(Re)})),ie.sort()})((function(ie){var pe=ie.match(De);return pe?pe[1].split(Oe):[]})(F),O)))}function t_(d){var b=0,O=0;return function(){var F=ag(),ie=16-(F-O);if(O=F,ie>0){if(++b>=800)return arguments[0]}else b=0;return d.apply(_,arguments)}}function am(d,b){var O=-1,F=d.length,ie=F-1;for(b=b===_?F:b;++O<b;){var pe=ef(O,ie),ye=d[pe];d[pe]=d[O],d[O]=ye}return d.length=b,d}var Df,Ud,Nu=(Df=io((function(d){var b=[];return d.charCodeAt(0)===46&&b.push(""),d.replace(Ut,(function(O,F,ie,pe){b.push(ie?pe.replace(Ve,"$1"):F||O)})),b}),(function(d){return Ud.size===500&&Ud.clear(),d})),Ud=Df.cache,Df);function ml(d){if(typeof d=="string"||Os(d))return d;var b=d+"";return b=="0"&&1/d==-1/0?"-0":b}function Bc(d){if(d!=null){try{return Ia.call(d)}catch{}try{return d+""}catch{}}return""}function om(d){if(d instanceof kn)return d.clone();var b=new Mi(d.__wrapped__,d.__chain__);return b.__actions__=kl(d.__actions__),b.__index__=d.__index__,b.__values__=d.__values__,b}var r0=Ur((function(d,b){return oa(d)?Pc(d,ai(b,1,oa,!0)):[]})),lm=Ur((function(d,b){var O=ec(b);return oa(O)&&(O=_),oa(d)?Pc(d,ai(b,1,oa,!0),dr(O,2)):[]})),fg=Ur((function(d,b){var O=ec(b);return oa(O)&&(O=_),oa(d)?Pc(d,ai(b,1,oa,!0),_,O):[]}));function i0(d,b,O){var F=d==null?0:d.length;if(!F)return-1;var ie=O==null?0:fr(O);return ie<0&&(ie=vi(F+ie,0)),Xc(d,dr(b,3),ie)}function s0(d,b,O){var F=d==null?0:d.length;if(!F)return-1;var ie=F-1;return O!==_&&(ie=fr(O),ie=O<0?vi(F+ie,0):Ki(ie,F-1)),Xc(d,dr(b,3),ie,!0)}function cm(d){return d!=null&&d.length?ai(d,1):[]}function n_(d){return d&&d.length?d[0]:_}var um=Ur((function(d){var b=Xi(d,nf);return b.length&&b[0]===d[0]?Cd(b):[]})),a0=Ur((function(d){var b=ec(d),O=Xi(d,nf);return b===ec(O)?b=_:O.pop(),O.length&&O[0]===d[0]?Cd(O,dr(b,2)):[]})),Pu=Ur((function(d){var b=ec(d),O=Xi(d,nf);return(b=typeof b=="function"?b:_)&&O.pop(),O.length&&O[0]===d[0]?Cd(O,_,b):[]}));function ec(d){var b=d==null?0:d.length;return b?d[b-1]:_}var hg=Ur(dg);function dg(d,b){return d&&d.length&&b&&b.length?Kh(d,b):d}var o0=hl((function(d,b){var O=d==null?0:d.length,F=dh(d,b);return dp(d,Xi(b,(function(ie){return of(ie,O)?+ie:ie})).sort(Pf)),F}));function l0(d){return d==null?d:Fn.call(d)}var r_=Ur((function(d){return ia(ai(d,1,oa,!0))})),K_=Ur((function(d){var b=ec(d);return oa(b)&&(b=_),ia(ai(d,1,oa,!0),dr(b,2))})),c0=Ur((function(d){var b=ec(d);return b=typeof b=="function"?b:_,ia(ai(d,1,oa,!0),_,b)}));function u0(d){if(!d||!d.length)return[];var b=0;return d=Wc(d,(function(O){if(oa(O))return b=vi(O.length,b),!0})),oh(b,(function(O){return Xi(d,ah(O))}))}function i_(d,b){if(!d||!d.length)return[];var O=u0(d);return b==null?O:Xi(O,(function(F){return cc(b,_,F)}))}var Z_=Ur((function(d,b){return oa(d)?Pc(d,b):[]})),pg=Ur((function(d){return tf(Wc(d,oa))})),mg=Ur((function(d){var b=ec(d);return oa(b)&&(b=_),tf(Wc(d,oa),dr(b,2))})),f0=Ur((function(d){var b=ec(d);return b=typeof b=="function"?b:_,tf(Wc(d,oa),_,b)})),J_=Ur(u0),tu=Ur((function(d){var b=d.length,O=b>1?d[b-1]:_;return O=typeof O=="function"?(d.pop(),O):_,i_(d,O)}));function sd(d){var b=ve(d);return b.__chain__=!0,b}function yp(d,b){return b(d)}var s_=hl((function(d){var b=d.length,O=b?d[0]:0,F=this.__wrapped__,ie=function(pe){return dh(pe,d)};return!(b>1||this.__actions__.length)&&F instanceof kn&&of(O)?((F=F.slice(O,+O+(b?1:0))).__actions__.push({func:yp,args:[ie],thisArg:_}),new Mi(F,this.__chain__).thru((function(pe){return b&&!pe.length&&pe.push(_),pe}))):this.thru(ie)})),Q_=Il((function(d,b,O){vr.call(d,O)?++d[O]:Na(d,O,1)})),bp=ul(i0),fm=ul(s0);function Bd(d,b){return(Ar(d)?il:fs)(d,dr(b,3))}function gh(d,b){return(Ar(d)?Xp:dc)(d,dr(b,3))}var tc=Il((function(d,b,O){vr.call(d,O)?d[O].push(b):Na(d,O,[b])})),Du=Ur((function(d,b,O){var F=-1,ie=typeof b=="function",pe=Ui(d)?tn(d.length):[];return fs(d,(function(ye){pe[++F]=ie?cc(b,ye,O):ol(ye,b,O)})),pe})),Ms=Il((function(d,b,O){Na(d,O,b)}));function _h(d,b){return(Ar(d)?Xi:Qc)(d,dr(b,3))}var a_=Il((function(d,b,O){d[O?0:1].push(b)}),(function(){return[[],[]]})),Vs=Ur((function(d,b){if(d==null)return[];var O=b.length;return O>1&&Ua(d,b[0],b[1])?b=[]:O>2&&Ua(b[0],b[1],b[2])&&(b=[b[0]]),Qu(d,ai(b,1),[])})),gc=Y_||function(){return ei.Date.now()};function Lf(d,b,O){return b=O?_:b,b=d&&b==null?d.length:b,Js(d,M,_,_,_,_,b)}function gg(d,b){var O;if(typeof b!="function")throw new rs(y);return d=fr(d),function(){return--d>0&&(O=b.apply(this,arguments)),d<=1&&(b=_),O}}var Uf=Ur((function(d,b,O){var F=1;if(O.length){var ie=Zu(O,mc(Uf));F|=E}return Js(d,F,b,O,ie)})),lf=Ur((function(d,b,O){var F=3;if(O.length){var ie=Zu(O,mc(lf));F|=E}return Js(b,F,d,O,ie)}));function _o(d,b,O){var F,ie,pe,ye,Re,Pe,Fe=0,Ye=!1,dt=!1,xt=!0;if(typeof d!="function")throw new rs(y);function Dt(It){var Ft=F,Zt=ie;return F=ie=_,Fe=It,ye=d.apply(Zt,Ft)}function bt(It){var Ft=It-Pe;return Pe===_||Ft>=b||Ft<0||dt&&It-Fe>=pe}function gt(){var It=gc();if(bt(It))return kt(It);Re=Ld(gt,(function(Ft){var Zt=b-(Ft-Pe);return dt?Ki(Zt,pe-(Ft-Fe)):Zt})(It))}function kt(It){return Re=_,xt&&F?Dt(It):(F=ie=_,ye)}function wt(){var It=gc(),Ft=bt(It);if(F=arguments,ie=this,Pe=It,Ft){if(Re===_)return(function(Zt){return Fe=Zt,Re=Ld(gt,b),Ye?Dt(Zt):ye})(Pe);if(dt)return Oo(Re),Re=Ld(gt,b),Dt(Pe)}return Re===_&&(Re=Ld(gt,b)),ye}return b=Ya(b)||0,qr(O)&&(Ye=!!O.leading,pe=(dt="maxWait"in O)?vi(Ya(O.maxWait)||0,b):pe,xt="trailing"in O?!!O.trailing:xt),wt.cancel=function(){Re!==_&&Oo(Re),Fe=0,F=Pe=ie=Re=_},wt.flush=function(){return Re===_?ye:kt(gc())},wt}var ad=Ur((function(d,b){return Vh(d,1,b)})),Bf=Ur((function(d,b,O){return Vh(d,Ya(b)||0,O)}));function io(d,b){if(typeof d!="function"||b!=null&&typeof b!="function")throw new rs(y);var O=function(){var F=arguments,ie=b?b.apply(this,F):F[0],pe=O.cache;if(pe.has(ie))return pe.get(ie);var ye=d.apply(this,F);return O.cache=pe.set(ie,ye)||pe,ye};return O.cache=new(io.Cache||Zi),O}function $o(d){if(typeof d!="function")throw new rs(y);return function(){var b=arguments;switch(b.length){case 0:return!d.call(this);case 1:return!d.call(this,b[0]);case 2:return!d.call(this,b[0],b[1]);case 3:return!d.call(this,b[0],b[1],b[2])}return!d.apply(this,b)}}io.Cache=Zi;var _g=rf((function(d,b){var O=(b=b.length==1&&Ar(b[0])?Xi(b[0],$l(dr())):Xi(ai(b,1),$l(dr()))).length;return Ur((function(F){for(var ie=-1,pe=Ki(F.length,O);++ie<pe;)F[ie]=b[ie].call(this,F[ie]);return cc(d,this,F)}))})),nu=Ur((function(d,b){var O=Zu(b,mc(nu));return Js(d,E,_,b,O)})),Fd=Ur((function(d,b){var O=Zu(b,mc(Fd));return Js(d,64,_,b,O)})),gl=hl((function(d,b){return Js(d,256,_,_,_,b)}));function aa(d,b){return d===b||d!=d&&b!=b}var ev=no(Wh),Ff=no((function(d,b){return d>=b})),Sr=Jn((function(){return arguments})())?Jn:function(d){return ds(d)&&vr.call(d,"callee")&&!Zp.call(d,"callee")},Ar=tn.isArray,_c=zh?$l(zh):function(d){return ds(d)&&yi(d)==Me};function Ui(d){return d!=null&&la(d.length)&&!$a(d)}function oa(d){return ds(d)&&Ui(d)}var Ra=Cf||j,Ga=op?$l(op):function(d){return ds(d)&&yi(d)==$};function bs(d){if(!ds(d))return!1;var b=yi(d);return b==U||b=="[object DOMException]"||typeof d.message=="string"&&typeof d.name=="string"&&!Gi(d)}function $a(d){if(!qr(d))return!1;var b=yi(d);return b==Q||b==W||b=="[object AsyncFunction]"||b=="[object Proxy]"}function Nl(d){return typeof d=="number"&&d==fr(d)}function la(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=N}function qr(d){var b=typeof d;return d!=null&&(b=="object"||b=="function")}function ds(d){return d!=null&&typeof d=="object"}var Aa=Wp?$l(Wp):function(d){return ds(d)&&Vo(d)==q};function ru(d){return typeof d=="number"||ds(d)&&yi(d)==Y}function Gi(d){if(!ds(d)||yi(d)!=ae)return!1;var b=Tu(d);if(b===null)return!0;var O=vr.call(b,"constructor")&&b.constructor;return typeof O=="function"&&O instanceof O&&Ia.call(O)==Q0}var Wa=Yp?$l(Yp):function(d){return ds(d)&&yi(d)==K},cf=rh?$l(rh):function(d){return ds(d)&&Vo(d)==ne};function Gs(d){return typeof d=="string"||!Ar(d)&&ds(d)&&yi(d)==le}function Os(d){return typeof d=="symbol"||ds(d)&&yi(d)==ce}var Di=wl?$l(wl):function(d){return ds(d)&&la(d.length)&&!!Cn[yi(d)]},so=no(ph),vc=no((function(d,b){return d<=b}));function Pl(d){if(!d)return[];if(Ui(d))return Gs(d)?wa(d):kl(d);if(Kc&&d[Kc])return(function(O){for(var F,ie=[];!(F=O.next()).done;)ie.push(F.value);return ie})(d[Kc]());var b=Vo(d);return(b==q?Hh:b==ne?tg:au)(d)}function mr(d){return d?(d=Ya(d))===k||d===-1/0?17976931348623157e292*(d<0?-1:1):d==d?d:0:d===0?d:0}function fr(d){var b=mr(d),O=b%1;return b==b?O?b-O:b:0}function Yn(d){return d?Cl(fr(d),0,D):0}function Ya(d){if(typeof d=="number")return d;if(Os(d))return I;if(qr(d)){var b=typeof d.valueOf=="function"?d.valueOf():d;d=qr(b)?b+"":b}if(typeof d!="string")return d===0?d:+d;d=zo(d);var O=vt.test(d);return O||ht.test(d)?Bo(d.slice(2),O?2:8):nt.test(d)?I:+d}function Wr(d){return qs(d,ao(d))}function is(d){return d==null?"":Ha(d)}var Lu=eu((function(d,b){if(nm(b)||Ui(b))qs(b,Jr(b),d);else for(var O in b)vr.call(b,O)&&Nc(d,O,b[O])})),iu=eu((function(d,b){qs(b,ao(b),d)})),ko=eu((function(d,b,O,F){qs(b,ao(b),d,F)})),od=eu((function(d,b,O,F){qs(b,Jr(b),d,F)})),ld=hl(dh),Sp=Ur((function(d,b){d=_r(d);var O=-1,F=b.length,ie=F>2?b[2]:_;for(ie&&Ua(b[0],b[1],ie)&&(F=1);++O<F;)for(var pe=b[O],ye=ao(pe),Re=-1,Pe=ye.length;++Re<Pe;){var Fe=ye[Re],Ye=d[Fe];(Ye===_||aa(Ye,sr[Fe])&&!vr.call(d,Fe))&&(d[Fe]=pe[Fe])}return d})),ca=Ur((function(d){return d.push(_,td),cc(yl,_,d)}));function Ep(d,b,O){var F=d==null?_:ti(d,b);return F===_?O:F}function _l(d,b){return d!=null&&pl(d,b,X_)}var vl=hs((function(d,b,O){b!=null&&typeof b.toString!="function"&&(b=Rf.call(b)),d[b]=O}),bh(ps)),Fc=hs((function(d,b,O){b!=null&&typeof b.toString!="function"&&(b=Rf.call(b)),vr.call(d,b)?d[b].push(O):d[b]=[O]}),dr),Ji=Ur(ol);function Jr(d){return Ui(d)?og(d):Jc(d)}function ao(d){return Ui(d)?og(d,!0):(function(b){if(!qr(b))return(function(pe){var ye=[];if(pe!=null)for(var Re in _r(pe))ye.push(Re);return ye})(b);var O=nm(b),F=[];for(var ie in b)(ie!="constructor"||!O&&vr.call(b,ie))&&F.push(ie);return F})(d)}var vh=eu((function(d,b,O){Co(d,b,O)})),yl=eu((function(d,b,O,F){Co(d,b,O,F)})),va=hl((function(d,b){var O={};if(d==null)return O;var F=!1;b=Xi(b,(function(pe){return pe=Mo(pe,d),F||(F=pe.length>1),pe})),qs(d,_p(d),O),F&&(O=Hs(O,7,nd));for(var ie=b.length;ie--;)Lc(O,b[ie]);return O})),Wo=hl((function(d,b){return d==null?{}:(function(O,F){return Pa(O,F,(function(ie,pe){return _l(O,pe)}))})(d,b)}));function zd(d,b){if(d==null)return{};var O=Xi(_p(d),(function(F){return[F]}));return b=dr(b),Pa(d,O,(function(F,ie){return b(F,ie[0])}))}var zf=La(Jr),su=La(ao);function au(d){return d==null?[]:Rd(d,Jr(d))}var yh=Qh((function(d,b,O){return b=b.toLowerCase(),d+(O?uf(b):b)}));function uf(d){return ar(is(d).toLowerCase())}function ua(d){return(d=is(d))&&d.replace(ft,G_).replace(Lr,"")}var jd=Qh((function(d,b,O){return d+(O?"-":"")+b.toLowerCase()})),ou=Qh((function(d,b,O){return d+(O?" ":"")+b.toLowerCase()})),$s=tm("toLowerCase"),Io=Qh((function(d,b,O){return d+(O?"_":"")+b.toLowerCase()})),cd=Qh((function(d,b,O){return d+(O?" ":"")+ar(b)})),bi=Qh((function(d,b,O){return d+(O?" ":"")+b.toUpperCase()})),ar=tm("toUpperCase");function Bi(d,b,O){return d=is(d),(b=O?_:b)===_?(function(F){return si.test(F)})(d)?(function(F){return F.match(da)||[]})(d):(function(F){return F.match(we)||[]})(d):d.match(b)||[]}var Yo=Ur((function(d,b){try{return cc(d,_,b)}catch(O){return bs(O)?O:new Zn(O)}})),ud=hl((function(d,b){return il(b,(function(O){O=ml(O),Na(d,O,Uf(d[O],d))})),d}));function bh(d){return function(){return d}}var vg=af(),No=af(!0);function ps(d){return d}function Qs(d){return Nf(typeof d=="function"?d:Hs(d,1))}var nc=Ur((function(d,b){return function(O){return ol(O,d,b)}})),ks=Ur((function(d,b){return function(O){return ol(d,O,b)}}));function ff(d,b,O){var F=Jr(b),ie=Cs(b,F);O!=null||qr(b)&&(ie.length||!F.length)||(O=b,b=d,d=this,ie=Cs(b,Jr(b)));var pe=!(qr(O)&&"chain"in O&&!O.chain),ye=$a(d);return il(ie,(function(Re){var Pe=b[Re];d[Re]=Pe,ye&&(d.prototype[Re]=function(){var Fe=this.__chain__;if(pe||Fe){var Ye=d(this.__wrapped__);return(Ye.__actions__=kl(this.__actions__)).push({func:Pe,args:arguments,thisArg:d}),Ye.__chain__=Fe,Ye}return Pe.apply(d,Cc([this.value()],arguments))})})),d}function hi(){}var lu=ed(Xi),Sh=ed(Ac),fd=ed(uc);function hm(d){return Go(d)?ah(ml(d)):(function(b){return function(O){return ti(O,b)}})(d)}var ya=fl(),jf=fl(!0);function Uu(){return[]}function j(){return!1}var C,P=qa((function(d,b){return d+b}),0),H=qo("ceil"),X=qa((function(d,b){return d/b}),1),te=qo("floor"),ue=qa((function(d,b){return d*b}),1),Ee=qo("round"),w=qa((function(d,b){return d-b}),0);return ve.after=function(d,b){if(typeof b!="function")throw new rs(y);return d=fr(d),function(){if(--d<1)return b.apply(this,arguments)}},ve.ary=Lf,ve.assign=Lu,ve.assignIn=iu,ve.assignInWith=ko,ve.assignWith=od,ve.at=ld,ve.before=gg,ve.bind=Uf,ve.bindAll=ud,ve.bindKey=lf,ve.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return Ar(d)?d:[d]},ve.chain=sd,ve.chunk=function(d,b,O){b=(O?Ua(d,b,O):b===_)?1:vi(fr(b),0);var F=d==null?0:d.length;if(!F||b<1)return[];for(var ie=0,pe=0,ye=tn(kc(F/b));ie<F;)ye[pe++]=Ol(d,ie,ie+=b);return ye},ve.compact=function(d){for(var b=-1,O=d==null?0:d.length,F=0,ie=[];++b<O;){var pe=d[b];pe&&(ie[F++]=pe)}return ie},ve.concat=function(){var d=arguments.length;if(!d)return[];for(var b=tn(d-1),O=arguments[0],F=d;F--;)b[F-1]=arguments[F];return Cc(Ar(O)?kl(O):[O],ai(b,1))},ve.cond=function(d){var b=d==null?0:d.length,O=dr();return d=b?Xi(d,(function(F){if(typeof F[1]!="function")throw new rs(y);return[O(F[0]),F[1]]})):[],Ur((function(F){for(var ie=-1;++ie<b;){var pe=d[ie];if(cc(pe[0],this,F))return cc(pe[1],this,F)}}))},ve.conforms=function(d){return(function(b){var O=Jr(b);return function(F){return Ml(F,b,O)}})(Hs(d,1))},ve.constant=bh,ve.countBy=Q_,ve.create=function(d,b){var O=hc(d);return b==null?O:Ro(O,b)},ve.curry=function d(b,O,F){var ie=Js(b,8,_,_,_,_,_,O=F?_:O);return ie.placeholder=d.placeholder,ie},ve.curryRight=function d(b,O,F){var ie=Js(b,16,_,_,_,_,_,O=F?_:O);return ie.placeholder=d.placeholder,ie},ve.debounce=_o,ve.defaults=Sp,ve.defaultsDeep=ca,ve.defer=ad,ve.delay=Bf,ve.difference=r0,ve.differenceBy=lm,ve.differenceWith=fg,ve.drop=function(d,b,O){var F=d==null?0:d.length;return F?Ol(d,(b=O||b===_?1:fr(b))<0?0:b,F):[]},ve.dropRight=function(d,b,O){var F=d==null?0:d.length;return F?Ol(d,0,(b=F-(b=O||b===_?1:fr(b)))<0?0:b):[]},ve.dropRightWhile=function(d,b){return d&&d.length?Au(d,dr(b,3),!0,!0):[]},ve.dropWhile=function(d,b){return d&&d.length?Au(d,dr(b,3),!0):[]},ve.fill=function(d,b,O,F){var ie=d==null?0:d.length;return ie?(O&&typeof O!="number"&&Ua(d,b,O)&&(O=0,F=ie),(function(pe,ye,Re,Pe){var Fe=pe.length;for((Re=fr(Re))<0&&(Re=-Re>Fe?0:Fe+Re),(Pe=Pe===_||Pe>Fe?Fe:fr(Pe))<0&&(Pe+=Fe),Pe=Re>Pe?0:Yn(Pe);Re<Pe;)pe[Re++]=ye;return pe})(d,b,O,F)):[]},ve.filter=function(d,b){return(Ar(d)?Wc:Ru)(d,dr(b,3))},ve.flatMap=function(d,b){return ai(_h(d,b),1)},ve.flatMapDeep=function(d,b){return ai(_h(d,b),k)},ve.flatMapDepth=function(d,b,O){return O=O===_?1:fr(O),ai(_h(d,b),O)},ve.flatten=cm,ve.flattenDeep=function(d){return d!=null&&d.length?ai(d,k):[]},ve.flattenDepth=function(d,b){return d!=null&&d.length?ai(d,b=b===_?1:fr(b)):[]},ve.flip=function(d){return Js(d,512)},ve.flow=vg,ve.flowRight=No,ve.fromPairs=function(d){for(var b=-1,O=d==null?0:d.length,F={};++b<O;){var ie=d[b];F[ie[0]]=ie[1]}return F},ve.functions=function(d){return d==null?[]:Cs(d,Jr(d))},ve.functionsIn=function(d){return d==null?[]:Cs(d,ao(d))},ve.groupBy=tc,ve.initial=function(d){return d!=null&&d.length?Ol(d,0,-1):[]},ve.intersection=um,ve.intersectionBy=a0,ve.intersectionWith=Pu,ve.invert=vl,ve.invertBy=Fc,ve.invokeMap=Du,ve.iteratee=Qs,ve.keyBy=Ms,ve.keys=Jr,ve.keysIn=ao,ve.map=_h,ve.mapKeys=function(d,b){var O={};return b=dr(b,3),Zs(d,(function(F,ie,pe){Na(O,b(F,ie,pe),F)})),O},ve.mapValues=function(d,b){var O={};return b=dr(b,3),Zs(d,(function(F,ie,pe){Na(O,ie,b(F,ie,pe))})),O},ve.matches=function(d){return Qp(Hs(d,1))},ve.matchesProperty=function(d,b){return Md(d,Hs(b,1))},ve.memoize=io,ve.merge=vh,ve.mergeWith=yl,ve.method=nc,ve.methodOf=ks,ve.mixin=ff,ve.negate=$o,ve.nthArg=function(d){return d=fr(d),Ur((function(b){return Xh(b,d)}))},ve.omit=va,ve.omitBy=function(d,b){return zd(d,$o(dr(b)))},ve.once=function(d){return gg(2,d)},ve.orderBy=function(d,b,O,F){return d==null?[]:(Ar(b)||(b=b==null?[]:[b]),Ar(O=F?_:O)||(O=O==null?[]:[O]),Qu(d,b,O))},ve.over=lu,ve.overArgs=_g,ve.overEvery=Sh,ve.overSome=fd,ve.partial=nu,ve.partialRight=Fd,ve.partition=a_,ve.pick=Wo,ve.pickBy=zd,ve.property=hm,ve.propertyOf=function(d){return function(b){return d==null?_:ti(d,b)}},ve.pull=hg,ve.pullAll=dg,ve.pullAllBy=function(d,b,O){return d&&d.length&&b&&b.length?Kh(d,b,dr(O,2)):d},ve.pullAllWith=function(d,b,O){return d&&d.length&&b&&b.length?Kh(d,b,_,O):d},ve.pullAt=o0,ve.range=ya,ve.rangeRight=jf,ve.rearg=gl,ve.reject=function(d,b){return(Ar(d)?Wc:Ru)(d,$o(dr(b,3)))},ve.remove=function(d,b){var O=[];if(!d||!d.length)return O;var F=-1,ie=[],pe=d.length;for(b=dr(b,3);++F<pe;){var ye=d[F];b(ye,F,d)&&(O.push(ye),ie.push(F))}return dp(d,ie),O},ve.rest=function(d,b){if(typeof d!="function")throw new rs(y);return Ur(d,b=b===_?b:fr(b))},ve.reverse=l0,ve.sampleSize=function(d,b,O){return b=(O?Ua(d,b,O):b===_)?1:fr(b),(Ar(d)?If:ll)(d,b)},ve.set=function(d,b,O){return d==null?d:Kl(d,b,O)},ve.setWith=function(d,b,O,F){return F=typeof F=="function"?F:_,d==null?d:Kl(d,b,O,F)},ve.shuffle=function(d){return(Ar(d)?lg:zr)(d)},ve.slice=function(d,b,O){var F=d==null?0:d.length;return F?(O&&typeof O!="number"&&Ua(d,b,O)?(b=0,O=F):(b=b==null?0:fr(b),O=O===_?F:fr(O)),Ol(d,b,O)):[]},ve.sortBy=Vs,ve.sortedUniq=function(d){return d&&d.length?cl(d):[]},ve.sortedUniqBy=function(d,b){return d&&d.length?cl(d,dr(b,2)):[]},ve.split=function(d,b,O){return O&&typeof O!="number"&&Ua(d,b,O)&&(b=O=_),(O=O===_?D:O>>>0)?(d=is(d))&&(typeof b=="string"||b!=null&&!Wa(b))&&!(b=Ha(b))&&jh(d)?sf(wa(d),0,O):d.split(b,O):[]},ve.spread=function(d,b){if(typeof d!="function")throw new rs(y);return b=b==null?0:vi(fr(b),0),Ur((function(O){var F=O[b],ie=sf(O,0,b);return F&&Cc(ie,F),cc(d,this,ie)}))},ve.tail=function(d){var b=d==null?0:d.length;return b?Ol(d,1,b):[]},ve.take=function(d,b,O){return d&&d.length?Ol(d,0,(b=O||b===_?1:fr(b))<0?0:b):[]},ve.takeRight=function(d,b,O){var F=d==null?0:d.length;return F?Ol(d,(b=F-(b=O||b===_?1:fr(b)))<0?0:b,F):[]},ve.takeRightWhile=function(d,b){return d&&d.length?Au(d,dr(b,3),!1,!0):[]},ve.takeWhile=function(d,b){return d&&d.length?Au(d,dr(b,3)):[]},ve.tap=function(d,b){return b(d),d},ve.throttle=function(d,b,O){var F=!0,ie=!0;if(typeof d!="function")throw new rs(y);return qr(O)&&(F="leading"in O?!!O.leading:F,ie="trailing"in O?!!O.trailing:ie),_o(d,b,{leading:F,maxWait:b,trailing:ie})},ve.thru=yp,ve.toArray=Pl,ve.toPairs=zf,ve.toPairsIn=su,ve.toPath=function(d){return Ar(d)?Xi(d,ml):Os(d)?[d]:kl(Nu(is(d)))},ve.toPlainObject=Wr,ve.transform=function(d,b,O){var F=Ar(d),ie=F||Ra(d)||Di(d);if(b=dr(b,4),O==null){var pe=d&&d.constructor;O=ie?F?new pe:[]:qr(d)&&$a(pe)?hc(Tu(d)):{}}return(ie?il:Zs)(d,(function(ye,Re,Pe){return b(O,ye,Re,Pe)})),O},ve.unary=function(d){return Lf(d,1)},ve.union=r_,ve.unionBy=K_,ve.unionWith=c0,ve.uniq=function(d){return d&&d.length?ia(d):[]},ve.uniqBy=function(d,b){return d&&d.length?ia(d,dr(b,2)):[]},ve.uniqWith=function(d,b){return b=typeof b=="function"?b:_,d&&d.length?ia(d,_,b):[]},ve.unset=function(d,b){return d==null||Lc(d,b)},ve.unzip=u0,ve.unzipWith=i_,ve.update=function(d,b,O){return d==null?d:kd(d,b,Cu(O))},ve.updateWith=function(d,b,O,F){return F=typeof F=="function"?F:_,d==null?d:kd(d,b,Cu(O),F)},ve.values=au,ve.valuesIn=function(d){return d==null?[]:Rd(d,ao(d))},ve.without=Z_,ve.words=Bi,ve.wrap=function(d,b){return nu(Cu(b),d)},ve.xor=pg,ve.xorBy=mg,ve.xorWith=f0,ve.zip=J_,ve.zipObject=function(d,b){return Uc(d||[],b||[],Nc)},ve.zipObjectDeep=function(d,b){return Uc(d||[],b||[],Kl)},ve.zipWith=tu,ve.entries=zf,ve.entriesIn=su,ve.extend=iu,ve.extendWith=ko,ff(ve,ve),ve.add=P,ve.attempt=Yo,ve.camelCase=yh,ve.capitalize=uf,ve.ceil=H,ve.clamp=function(d,b,O){return O===_&&(O=b,b=_),O!==_&&(O=(O=Ya(O))==O?O:0),b!==_&&(b=(b=Ya(b))==b?b:0),Cl(Ya(d),b,O)},ve.clone=function(d){return Hs(d,4)},ve.cloneDeep=function(d){return Hs(d,5)},ve.cloneDeepWith=function(d,b){return Hs(d,5,b=typeof b=="function"?b:_)},ve.cloneWith=function(d,b){return Hs(d,4,b=typeof b=="function"?b:_)},ve.conformsTo=function(d,b){return b==null||Ml(d,b,Jr(b))},ve.deburr=ua,ve.defaultTo=function(d,b){return d==null||d!=d?b:d},ve.divide=X,ve.endsWith=function(d,b,O){d=is(d),b=Ha(b);var F=d.length,ie=O=O===_?F:Cl(fr(O),0,F);return(O-=b.length)>=0&&d.slice(O,ie)==b},ve.eq=aa,ve.escape=function(d){return(d=is(d))&&Ke.test(d)?d.replace(ke,$_):d},ve.escapeRegExp=function(d){return(d=is(d))&&ge.test(d)?d.replace(je,"\\$&"):d},ve.every=function(d,b,O){var F=Ar(d)?Ac:Gh;return O&&Ua(d,b,O)&&(b=_),F(d,dr(b,3))},ve.find=bp,ve.findIndex=i0,ve.findKey=function(d,b){return Yc(d,dr(b,3),Zs)},ve.findLast=fm,ve.findLastIndex=s0,ve.findLastKey=function(d,b){return Yc(d,dr(b,3),Ao)},ve.floor=te,ve.forEach=Bd,ve.forEachRight=gh,ve.forIn=function(d,b){return d==null?d:$h(d,dr(b,3),ao)},ve.forInRight=function(d,b){return d==null?d:Jp(d,dr(b,3),ao)},ve.forOwn=function(d,b){return d&&Zs(d,dr(b,3))},ve.forOwnRight=function(d,b){return d&&Ao(d,dr(b,3))},ve.get=Ep,ve.gt=ev,ve.gte=Ff,ve.has=function(d,b){return d!=null&&pl(d,b,Yh)},ve.hasIn=_l,ve.head=n_,ve.identity=ps,ve.includes=function(d,b,O,F){d=Ui(d)?d:au(d),O=O&&!F?fr(O):0;var ie=d.length;return O<0&&(O=vi(ie+O,0)),Gs(d)?O<=ie&&d.indexOf(b,O)>-1:!!ie&&ih(d,b,O)>-1},ve.indexOf=function(d,b,O){var F=d==null?0:d.length;if(!F)return-1;var ie=O==null?0:fr(O);return ie<0&&(ie=vi(F+ie,0)),ih(d,b,ie)},ve.inRange=function(d,b,O){return b=mr(b),O===_?(O=b,b=0):O=mr(O),(function(F,ie,pe){return F>=Ki(ie,pe)&&F<vi(ie,pe)})(d=Ya(d),b,O)},ve.invoke=Ji,ve.isArguments=Sr,ve.isArray=Ar,ve.isArrayBuffer=_c,ve.isArrayLike=Ui,ve.isArrayLikeObject=oa,ve.isBoolean=function(d){return d===!0||d===!1||ds(d)&&yi(d)==B},ve.isBuffer=Ra,ve.isDate=Ga,ve.isElement=function(d){return ds(d)&&d.nodeType===1&&!Gi(d)},ve.isEmpty=function(d){if(d==null)return!0;if(Ui(d)&&(Ar(d)||typeof d=="string"||typeof d.splice=="function"||Ra(d)||Di(d)||Sr(d)))return!d.length;var b=Vo(d);if(b==q||b==ne)return!d.size;if(nm(d))return!Jc(d).length;for(var O in d)if(vr.call(d,O))return!1;return!0},ve.isEqual=function(d,b){return Pi(d,b)},ve.isEqualWith=function(d,b,O){var F=(O=typeof O=="function"?O:_)?O(d,b):_;return F===_?Pi(d,b,_,O):!!F},ve.isError=bs,ve.isFinite=function(d){return typeof d=="number"&&Yl(d)},ve.isFunction=$a,ve.isInteger=Nl,ve.isLength=la,ve.isMap=Aa,ve.isMatch=function(d,b){return d===b||Zc(d,b,rd(b))},ve.isMatchWith=function(d,b,O){return O=typeof O=="function"?O:_,Zc(d,b,rd(b),O)},ve.isNaN=function(d){return ru(d)&&d!=+d},ve.isNative=function(d){if(cg(d))throw new Zn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return mo(d)},ve.isNil=function(d){return d==null},ve.isNull=function(d){return d===null},ve.isNumber=ru,ve.isObject=qr,ve.isObjectLike=ds,ve.isPlainObject=Gi,ve.isRegExp=Wa,ve.isSafeInteger=function(d){return Nl(d)&&d>=-9007199254740991&&d<=N},ve.isSet=cf,ve.isString=Gs,ve.isSymbol=Os,ve.isTypedArray=Di,ve.isUndefined=function(d){return d===_},ve.isWeakMap=function(d){return ds(d)&&Vo(d)==de},ve.isWeakSet=function(d){return ds(d)&&yi(d)=="[object WeakSet]"},ve.join=function(d,b){return d==null?"":sg.call(d,b)},ve.kebabCase=jd,ve.last=ec,ve.lastIndexOf=function(d,b,O){var F=d==null?0:d.length;if(!F)return-1;var ie=F;return O!==_&&(ie=(ie=fr(O))<0?vi(F+ie,0):Ki(ie,F-1)),b==b?(function(pe,ye,Re){for(var Pe=Re+1;Pe--;)if(pe[Pe]===ye)return Pe;return Pe})(d,b,ie):Xc(d,xf,ie,!0)},ve.lowerCase=ou,ve.lowerFirst=$s,ve.lt=so,ve.lte=vc,ve.max=function(d){return d&&d.length?Xl(d,ps,Wh):_},ve.maxBy=function(d,b){return d&&d.length?Xl(d,dr(b,2),Wh):_},ve.mean=function(d){return sh(d,ps)},ve.meanBy=function(d,b){return sh(d,dr(b,2))},ve.min=function(d){return d&&d.length?Xl(d,ps,ph):_},ve.minBy=function(d,b){return d&&d.length?Xl(d,dr(b,2),ph):_},ve.stubArray=Uu,ve.stubFalse=j,ve.stubObject=function(){return{}},ve.stubString=function(){return""},ve.stubTrue=function(){return!0},ve.multiply=ue,ve.nth=function(d,b){return d&&d.length?Xh(d,fr(b)):_},ve.noConflict=function(){return ei._===this&&(ei._=Wl),this},ve.noop=hi,ve.now=gc,ve.pad=function(d,b,O){d=is(d);var F=(b=fr(b))?ys(d):0;if(!b||F>=b)return d;var ie=(b-F)/2;return ku(Ad(ie),O)+d+ku(kc(ie),O)},ve.padEnd=function(d,b,O){d=is(d);var F=(b=fr(b))?ys(d):0;return b&&F<b?d+ku(b-F,O):d},ve.padStart=function(d,b,O){d=is(d);var F=(b=fr(b))?ys(d):0;return b&&F<b?ku(b-F,O)+d:d},ve.parseInt=function(d,b,O){return O||b==null?b=0:b&&(b=+b),hh(is(d).replace(se,""),b||0)},ve.random=function(d,b,O){if(O&&typeof O!="boolean"&&Ua(d,b,O)&&(b=O=_),O===_&&(typeof b=="boolean"?(O=b,b=_):typeof d=="boolean"&&(O=d,d=_)),d===_&&b===_?(d=0,b=1):(d=mr(d),b===_?(b=d,d=0):b=mr(b)),d>b){var F=d;d=b,b=F}if(O||d%1||b%1){var ie=up();return Ki(d+ie*(b-d+cs("1e-"+((ie+"").length-1))),b)}return ef(d,b)},ve.reduce=function(d,b,O){var F=Ar(d)?Ef:Xu,ie=arguments.length<3;return F(d,dr(b,4),O,ie,fs)},ve.reduceRight=function(d,b,O){var F=Ar(d)?Jm:Xu,ie=arguments.length<3;return F(d,dr(b,4),O,ie,dc)},ve.repeat=function(d,b,O){return b=(O?Ua(d,b,O):b===_)?1:fr(b),mh(is(d),b)},ve.replace=function(){var d=arguments,b=is(d[0]);return d.length<3?b:b.replace(d[1],d[2])},ve.result=function(d,b,O){var F=-1,ie=(b=Mo(b,d)).length;for(ie||(ie=1,d=_);++F<ie;){var pe=d==null?_:d[ml(b[F])];pe===_&&(F=ie,pe=O),d=$a(pe)?pe.call(d):pe}return d},ve.round=Ee,ve.runInContext=rt,ve.sample=function(d){return(Ar(d)?kf:yr)(d)},ve.size=function(d){if(d==null)return 0;if(Ui(d))return Gs(d)?ys(d):d.length;var b=Vo(d);return b==q||b==ne?d.size:Jc(d).length},ve.snakeCase=Io,ve.some=function(d,b,O){var F=Ar(d)?uc:Da;return O&&Ua(d,b,O)&&(b=_),F(d,dr(b,3))},ve.sortedIndex=function(d,b){return Od(d,b)},ve.sortedIndexBy=function(d,b,O){return mp(d,b,dr(O,2))},ve.sortedIndexOf=function(d,b){var O=d==null?0:d.length;if(O){var F=Od(d,b);if(F<O&&aa(d[F],b))return F}return-1},ve.sortedLastIndex=function(d,b){return Od(d,b,!0)},ve.sortedLastIndexBy=function(d,b,O){return mp(d,b,dr(O,2),!0)},ve.sortedLastIndexOf=function(d,b){if(d!=null&&d.length){var O=Od(d,b,!0)-1;if(aa(d[O],b))return O}return-1},ve.startCase=cd,ve.startsWith=function(d,b,O){return d=is(d),O=O==null?0:Cl(fr(O),0,d.length),b=Ha(b),d.slice(O,O+b.length)==b},ve.subtract=w,ve.sum=function(d){return d&&d.length?Tf(d,ps):0},ve.sumBy=function(d,b){return d&&d.length?Tf(d,dr(b,2)):0},ve.template=function(d,b,O){var F=ve.templateSettings;O&&Ua(d,b,O)&&(b=_),d=is(d),b=ko({},b,F,ro);var ie,pe,ye=ko({},b.imports,F.imports,ro),Re=Jr(ye),Pe=Rd(ye,Re),Fe=0,Ye=b.interpolate||_t,dt="__p += '",xt=Eo((b.escape||_t).source+"|"+Ye.source+"|"+(Ye===ct?tt:_t).source+"|"+(b.evaluate||_t).source+"|$","g"),Dt="//# sourceURL="+(vr.call(b,"sourceURL")?(b.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Dr+"]")+`
`;d.replace(xt,(function(kt,wt,It,Ft,Zt,Gt){return It||(It=Ft),dt+=d.slice(Fe,Gt).replace(gn,lp),wt&&(ie=!0,dt+=`' +
__e(`+wt+`) +
'`),Zt&&(pe=!0,dt+=`';
`+Zt+`;
__p += '`),It&&(dt+=`' +
((__t = (`+It+`)) == null ? '' : __t) +
'`),Fe=Gt+kt.length,kt})),dt+=`';
`;var bt=vr.call(b,"variable")&&b.variable;if(bt){if(st.test(bt))throw new Zn("Invalid `variable` option passed into `_.template`")}else dt=`with (obj) {
`+dt+`
}
`;dt=(pe?dt.replace(ze,""):dt).replace(Be,"$1").replace(me,"$1;"),dt="function("+(bt||"obj")+`) {
`+(bt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ie?", __e = _.escape":"")+(pe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+dt+`return __p
}`;var gt=Yo((function(){return Ci(Re,Dt+"return "+dt).apply(_,Pe)}));if(gt.source=dt,bs(gt))throw gt;return gt},ve.times=function(d,b){if((d=fr(d))<1||d>N)return[];var O=D,F=Ki(d,D);b=dr(b),d-=D;for(var ie=oh(F,b);++O<d;)b(O);return ie},ve.toFinite=mr,ve.toInteger=fr,ve.toLength=Yn,ve.toLower=function(d){return is(d).toLowerCase()},ve.toNumber=Ya,ve.toSafeInteger=function(d){return d?Cl(fr(d),-9007199254740991,N):d===0?d:0},ve.toString=is,ve.toUpper=function(d){return is(d).toUpperCase()},ve.trim=function(d,b,O){if((d=is(d))&&(O||b===_))return zo(d);if(!d||!(b=Ha(b)))return d;var F=wa(d),ie=wa(b);return sf(F,sl(F,ie),eg(F,ie)+1).join("")},ve.trimEnd=function(d,b,O){if((d=is(d))&&(O||b===_))return d.slice(0,cp(d)+1);if(!d||!(b=Ha(b)))return d;var F=wa(d);return sf(F,0,eg(F,wa(b))+1).join("")},ve.trimStart=function(d,b,O){if((d=is(d))&&(O||b===_))return d.replace(se,"");if(!d||!(b=Ha(b)))return d;var F=wa(d);return sf(F,sl(F,wa(b))).join("")},ve.truncate=function(d,b){var O=30,F="...";if(qr(b)){var ie="separator"in b?b.separator:ie;O="length"in b?fr(b.length):O,F="omission"in b?Ha(b.omission):F}var pe=(d=is(d)).length;if(jh(d)){var ye=wa(d);pe=ye.length}if(O>=pe)return d;var Re=O-ys(F);if(Re<1)return F;var Pe=ye?sf(ye,0,Re).join(""):d.slice(0,Re);if(ie===_)return Pe+F;if(ye&&(Re+=Pe.length-Re),Wa(ie)){if(d.slice(Re).search(ie)){var Fe,Ye=Pe;for(ie.global||(ie=Eo(ie.source,is(Ze.exec(ie))+"g")),ie.lastIndex=0;Fe=ie.exec(Ye);)var dt=Fe.index;Pe=Pe.slice(0,dt===_?Re:dt)}}else if(d.indexOf(Ha(ie),Re)!=Re){var xt=Pe.lastIndexOf(ie);xt>-1&&(Pe=Pe.slice(0,xt))}return Pe+F},ve.unescape=function(d){return(d=is(d))&&be.test(d)?d.replace(Se,ng):d},ve.uniqueId=function(d){var b=++Gr;return is(d)+b},ve.upperCase=bi,ve.upperFirst=ar,ve.each=Bd,ve.eachRight=gh,ve.first=n_,ff(ve,(C={},Zs(ve,(function(d,b){vr.call(ve.prototype,b)||(C[b]=d)})),C),{chain:!1}),ve.VERSION="4.17.21",il(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(d){ve[d].placeholder=ve})),il(["drop","take"],(function(d,b){kn.prototype[d]=function(O){O=O===_?1:vi(fr(O),0);var F=this.__filtered__&&!b?new kn(this):this.clone();return F.__filtered__?F.__takeCount__=Ki(O,F.__takeCount__):F.__views__.push({size:Ki(O,D),type:d+(F.__dir__<0?"Right":"")}),F},kn.prototype[d+"Right"]=function(O){return this.reverse()[d](O).reverse()}})),il(["filter","map","takeWhile"],(function(d,b){var O=b+1,F=O==1||O==3;kn.prototype[d]=function(ie){var pe=this.clone();return pe.__iteratees__.push({iteratee:dr(ie,3),type:O}),pe.__filtered__=pe.__filtered__||F,pe}})),il(["head","last"],(function(d,b){var O="take"+(b?"Right":"");kn.prototype[d]=function(){return this[O](1).value()[0]}})),il(["initial","tail"],(function(d,b){var O="drop"+(b?"":"Right");kn.prototype[d]=function(){return this.__filtered__?new kn(this):this[O](1)}})),kn.prototype.compact=function(){return this.filter(ps)},kn.prototype.find=function(d){return this.filter(d).head()},kn.prototype.findLast=function(d){return this.reverse().find(d)},kn.prototype.invokeMap=Ur((function(d,b){return typeof d=="function"?new kn(this):this.map((function(O){return ol(O,d,b)}))})),kn.prototype.reject=function(d){return this.filter($o(dr(d)))},kn.prototype.slice=function(d,b){d=fr(d);var O=this;return O.__filtered__&&(d>0||b<0)?new kn(O):(d<0?O=O.takeRight(-d):d&&(O=O.drop(d)),b!==_&&(O=(b=fr(b))<0?O.dropRight(-b):O.take(b-d)),O)},kn.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},kn.prototype.toArray=function(){return this.take(D)},Zs(kn.prototype,(function(d,b){var O=/^(?:filter|find|map|reject)|While$/.test(b),F=/^(?:head|last)$/.test(b),ie=ve[F?"take"+(b=="last"?"Right":""):b],pe=F||/^find/.test(b);ie&&(ve.prototype[b]=function(){var ye=this.__wrapped__,Re=F?[1]:arguments,Pe=ye instanceof kn,Fe=Re[0],Ye=Pe||Ar(ye),dt=function(wt){var It=ie.apply(ve,Cc([wt],Re));return F&&xt?It[0]:It};Ye&&O&&typeof Fe=="function"&&Fe.length!=1&&(Pe=Ye=!1);var xt=this.__chain__,Dt=!!this.__actions__.length,bt=pe&&!xt,gt=Pe&&!Dt;if(!pe&&Ye){ye=gt?ye:new kn(this);var kt=d.apply(ye,Re);return kt.__actions__.push({func:yp,args:[dt],thisArg:_}),new Mi(kt,xt)}return bt&&gt?d.apply(this,Re):(kt=this.thru(dt),bt?F?kt.value()[0]:kt.value():kt)})})),il(["pop","push","shift","sort","splice","unshift"],(function(d){var b=Mc[d],O=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);ve.prototype[d]=function(){var ie=arguments;if(F&&!this.__chain__){var pe=this.value();return b.apply(Ar(pe)?pe:[],ie)}return this[O]((function(ye){return b.apply(Ar(ye)?ye:[],ie)}))}})),Zs(kn.prototype,(function(d,b){var O=ve[b];if(O){var F=O.name+"";vr.call(As,F)||(As[F]=[]),As[F].push({name:b,func:O})}})),As[Zr(_,2).name]=[{name:"wrapper",func:_}],kn.prototype.clone=function(){var d=new kn(this.__wrapped__);return d.__actions__=kl(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=kl(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=kl(this.__views__),d},kn.prototype.reverse=function(){if(this.__filtered__){var d=new kn(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},kn.prototype.value=function(){var d=this.__wrapped__.value(),b=this.__dir__,O=Ar(d),F=b<0,ie=O?d.length:0,pe=(function(Gt,$t,dn){for(var Rn=-1,Nn=dn.length;++Rn<Nn;){var qn=dn[Rn],Dn=qn.size;switch(qn.type){case"drop":Gt+=Dn;break;case"dropRight":$t-=Dn;break;case"take":$t=Ki($t,Gt+Dn);break;case"takeRight":Gt=vi(Gt,$t-Dn)}}return{start:Gt,end:$t}})(0,ie,this.__views__),ye=pe.start,Re=pe.end,Pe=Re-ye,Fe=F?Re:ye-1,Ye=this.__iteratees__,dt=Ye.length,xt=0,Dt=Ki(Pe,this.__takeCount__);if(!O||!F&&ie==Pe&&Dt==Pe)return to(d,this.__actions__);var bt=[];e:for(;Pe--&&xt<Dt;){for(var gt=-1,kt=d[Fe+=b];++gt<dt;){var wt=Ye[gt],It=wt.iteratee,Ft=wt.type,Zt=It(kt);if(Ft==2)kt=Zt;else if(!Zt){if(Ft==1)continue e;break e}}bt[xt++]=kt}return bt},ve.prototype.at=s_,ve.prototype.chain=function(){return sd(this)},ve.prototype.commit=function(){return new Mi(this.value(),this.__chain__)},ve.prototype.next=function(){this.__values__===_&&(this.__values__=Pl(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?_:this.__values__[this.__index__++]}},ve.prototype.plant=function(d){for(var b,O=this;O instanceof eo;){var F=om(O);F.__index__=0,F.__values__=_,b?ie.__wrapped__=F:b=F;var ie=F;O=O.__wrapped__}return ie.__wrapped__=d,b},ve.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof kn){var b=d;return this.__actions__.length&&(b=new kn(this)),(b=b.reverse()).__actions__.push({func:yp,args:[l0],thisArg:_}),new Mi(b,this.__chain__)}return this.thru(l0)},ve.prototype.toJSON=ve.prototype.valueOf=ve.prototype.value=function(){return to(this.__wrapped__,this.__actions__)},ve.prototype.first=ve.prototype.head,Kc&&(ve.prototype[Kc]=function(){return this}),ve})();ei._=qh,(p=(function(){return qh}).call(h,g,h,f))===_||(f.exports=p)}).call(this)},815:function(f,h){var g,p,_=this&&this.__extends||(g=function(W,q){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,ae){Y.__proto__=ae}||function(Y,ae){for(var Z in ae)Object.prototype.hasOwnProperty.call(ae,Z)&&(Y[Z]=ae[Z])},g(W,q)},function(W,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");function Y(){this.constructor=W}g(W,q),W.prototype=q===null?Object.create(q):(Y.prototype=q.prototype,new Y)});function y(W){return 60*W*60}function v(W,q){var Y={};return Object.assign(Y,W),q&&Object.assign(Y,q),Y}Object.defineProperty(h,"__esModule",{value:!0}),h.DeviceConfigPropertyHolder=h.DeviceConfigManager=h.DeviceConfigEnv=void 0,(function(W){W.BETA="beta",W.PROD="prod",W.CUSTOM="custom"})(p||(h.DeviceConfigEnv=p={}));var x=(function(W){function q(Y){return W.call(this,Y)||this}return _(q,W),q})(Error),E="data",M=y(2),k="base64",N=(function(){function W(q,Y){var ae,Z,K,ne,le,ce,de,Me;if(!Y.fileKey)throw new Error("options.fileKey cannot be empty");var qe=(ae=Y.clock)!==null&&ae!==void 0?ae:new $,Ne=qe.getMillis();switch(this.context=q,this.fileKey=Y.fileKey,this.env=Y.standardEnv,Y.standardEnv){case p.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case p.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case p.CUSTOM:if(!Y.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=Y.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(Y.standardEnv))}this.trace=(Z=Y.trace)!==null&&Z!==void 0?Z:new G(Y.enableConsoleLog),this.fetch=(K=Y.fetch)!==null&&K!==void 0?K:new V(q),this.storage=new B("amazon_ivs_device_config_v1_"+Y.fileKey,q.localStorage),this.state=new Q(this.storage,"state"),this.refresh={refreshIntervalSeconds:(ne=Y.refresh.refreshIntervalSeconds)!==null&&ne!==void 0?ne:900,retryCount:(le=Y.refresh.retryCount)!==null&&le!==void 0?le:3,retryIntervalSeconds:(ce=Y.refresh.retryIntervalSeconds)!==null&&ce!==void 0?ce:10,maxCacheAgeSeconds:(de=Y.refresh.maxCacheAgeSeconds)!==null&&de!==void 0?de:259200,stopRefreshAfterSeconds:(Me=Y.refresh.stopRefreshAfterSeconds)!==null&&Me!==void 0?Me:M,canRefreshNow:Y.refresh.canRefreshNow},this.emitMetrics=Y.emitMetrics,this.analyticsProperties=Y.analyticsProperties,this.enableConsoleLog=Y.enableConsoleLog,this.clock=qe,this.isInitialRefreshDone=!1;var Ae=0,Xe=this.state.getState();Xe&&Xe.fetchServer===this.fetchServer&&Xe.lastFetchWhenMs&&(Ae=Xe.lastFetchWhenMs);var $e,at=qe.getMillis(),pt=(at-Ae)/1e3;if(pt<=this.refresh.maxCacheAgeSeconds){var oe=this.storage.getJson(E);oe&&oe.fetchServer===this.fetchServer&&this.setData(oe.json)}this.lastUseMs=at,pt>=this.refresh.refreshIntervalSeconds||Ae==0?$e=0:($e=Math.round(this.refresh.refreshIntervalSeconds-pt),this.isInitialRefreshDone=!0),$e<5&&($e=5),this.trace.onTrace("Will start refresh in "+$e+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*$e);var Ue=qe.getMillis();this.initialLoadTime=Ue-Ne}return W.getInstance=function(q,Y){try{if(!(q.fetch&&q.setTimeout&&q.clearTimeout&&q.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(ae){return void console.error("Error checking for context properties "+ae)}if(this.gInstance){if(this.gInstance.fileKey!=Y.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(Y.fileKey));return this.gInstance}return this.gInstance=new W(q,Y),this.gInstance},W.prototype.getConfigurationHolder=function(q){var Y,ae=this.clock.getMillis();this.lastUseMs=ae;var Z=(Y=q.analytics)!==null&&Y!==void 0?Y:new J(this.enableConsoleLog),K=0,ne=this.state.getState();return ne&&ne.fetchServer===this.fetchServer&&ne.lastFetchWhenMs&&(K=ne.lastFetchWhenMs),(ae-K)/1e3<=this.refresh.maxCacheAgeSeconds?new I(Z,this.analyticsProperties,this.properties,K,this.clock):new I(Z,void 0,void 0,0,this.clock)},W.prototype.getFetchUrl=function(){var q="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),Y=new URL(q);return Y.searchParams.set("version","1.0"),Y},W.clearInstance=function(){var q;(q=this.gInstance)===null||q===void 0||q.clearInstanceImpl(),this.gInstance=void 0},W.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},W.prototype.startRefresh=function(){var q=this;this.trace.onTrace("Starting refresh request"),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds);var Y=this.clock.getMillis();if((Y-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds)this.trace.onTrace("Will not refresh due to refresh timeout");else if(!this.isInitialRefreshDone||this.refresh.canRefreshNow()){this.isInitialRefreshDone=!0;var ae={};this.fetchData().then((function(Z){q.processResponse(Z,ae,Y),q.emitMetricsImpl(ae)})).catch((function(Z){q.exceptionMetrics(ae,Z),q.emitMetricsImpl(ae),q.trace.onTrace("Fetch error: "+Z),q.refresh.retryCount>0&&q.scheduleRetry(1)}))}else this.trace.onTrace("Will not refresh due to callback having returned false")},W.prototype.fetchData=function(){var q=this.getFetchUrl(),Y=new Headers,ae=this.state.getState();return ae.fetchServer===this.fetchServer&&(ae.lastFetchWhenFullMs&&this.clock.getMillis()-ae.lastFetchWhenFullMs>1e3*y(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&ae.lastFetchEtagHeader&&Y.set("If-None-Match",ae.lastFetchEtagHeader)),this.fetch.fetchUrl(q,Y)},W.prototype.processResponse=function(q,Y,ae){var Z={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},K=q.headers.get("etag");if(K&&(Z.lastFetchEtagHeader=K),q.status<300&&q.json)if(this.setData(q.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(E,{fetchServer:this.fetchServer,json:q.json});var ne=this.clock.getMillis();Z.lastFetchWhenFullMs=ne,this.state.setState(Z),Y.success_new_data_count=1,Y.fetch_duration_average=Math.max(0,ne-ae)}else Y.fail_invalid_data_count=1;else{if(q.status!==304){var le="Unexpected http fetch status: "+q.status;throw this.trace.onTrace(le),new x(le)}this.trace.onTrace("Server said no change in data"),ne=this.clock.getMillis(),Z.lastFetchWhenMs=ne,this.state.setState(Z),Y.success_no_change_count=1,Y.fetch_duration_average=Math.max(0,ne-ae)}},W.prototype.scheduleRetry=function(q){var Y=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var ae=q*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout((function(){Y.retryTask=void 0,Y.fetchRetry(q)}),1e3*ae)},W.prototype.fetchRetry=function(q){var Y=this;this.trace.onTrace("Starting retry request ".concat(q,"..."));var ae={},Z=this.clock.getMillis();this.fetchData().then((function(K){Y.processResponse(K,ae,Z),Y.emitMetricsImpl(ae)})).catch((function(K){Y.exceptionMetrics(ae,K),Y.emitMetricsImpl(ae),Y.trace.onTrace("Fetch error: "+K),Y.refresh.retryCount>q&&Y.scheduleRetry(q+1)}))},W.prototype.setData=function(q){if(!q)return!1;if(q.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var Y=q.properties;if(!Y||!Array.isArray(Y))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var ae=new Map,Z=0,K=Y;Z<K.length;Z++){var ne=K[Z];if(ne.name&&ne.type&&this.isValidValueType(ne.type)){if(ne.value_string&&typeof ne.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof ne.value_string);continue}if(ne.value_number&&typeof ne.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof ne.value_number);continue}if(ne.value_boolean&&typeof ne.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof ne.value_boolean);continue}if(ne.value_json&&typeof ne.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof ne.value_json);continue}if(ne.value_analytics&&typeof ne.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof ne.value_analytics);continue}var le=new U(ne.name,this.parseValueType(ne.type),ne.value_string,ne.value_number,ne.value_boolean,ne.value_json,ne.value_analytics,ne.encoding);ae.set(le.name,le)}}return ae.size!=0&&(this.properties=ae,!0)},W.prototype.isValidValueType=function(q){return q==="string"||q==="number"||q==="boolean"||q=="json"},W.prototype.parseValueType=function(q){switch(q){case"string":return D.STRING;case"number":return D.NUMBER;case"boolean":return D.BOOLEAN;case"json":return D.JSON;default:throw new Error("Unsupported value type ".concat(q))}},W.prototype.emitMetricsImpl=function(q){var Y,ae,Z,K,ne,le,ce={initial_load_time:this.initialLoadTime,fetch_attempt_count:1,fetch_duration_average:(Y=q.fetch_duration_average)!==null&&Y!==void 0?Y:0,success_no_change_count:(ae=q.success_no_change_count)!==null&&ae!==void 0?ae:0,success_new_data_count:(Z=q.success_new_data_count)!==null&&Z!==void 0?Z:0,fail_exception_count:(K=q.fail_exception_count)!==null&&K!==void 0?K:0,fail_http_error_count:(ne=q.fail_http_error_count)!==null&&ne!==void 0?ne:0,fail_invalid_data_count:(le=q.fail_invalid_data_count)!==null&&le!==void 0?le:0};this.emitMetrics(v(ce,this.analyticsProperties))},W.prototype.exceptionMetrics=function(q,Y){var ae;Y instanceof x||!((ae=Y?.message)===null||ae===void 0)&&ae.startsWith("http error")?q.fail_http_error_count=1:q.fail_exception_count=1},W})();h.DeviceConfigManager=N;var I=(function(){function W(q,Y,ae,Z,K){this.analytics=q,this.analyticsProperties=Y,this.properties=ae,this.dataFetchedWhenMs=Z,this.clock=K}return W.prototype.getSize=function(){return this.properties?this.properties.size:-1},W.prototype.getStringValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.STRING){var K=(Y=Z.valueString)!==null&&Y!==void 0?Y:"";return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not string"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getNumberValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.NUMBER){var K=(Y=Z.valueNumber)!==null&&Y!==void 0?Y:0;return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getBooleanValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.BOOLEAN){var K=(Y=Z.valueBoolean)!==null&&Y!==void 0&&Y;return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getJsonValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.JSON){var K=Z.valueJson;if(!K)return this.analytics.onValue(v({key_name:Z.name,value:(Y=Z.valueAnalytics)!==null&&Y!==void 0?Y:"",fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),null;try{var ne=JSON.parse(K);return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:ne,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),ne}catch{return void this.analytics.onError(v({key_name:Z.name,message:"JSON parse error"},this.analyticsProperties))}}this.analytics.onError(v({key_name:Z.name,message:"Type is not JSON"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getFetchedSecondsAgo=function(){if(this.dataFetchedWhenMs)return(this.clock.getMillis()-this.dataFetchedWhenMs)/1e3},W})();h.DeviceConfigPropertyHolder=I;var D,V=(function(){function W(q){this.context=q}return W.prototype.fetchUrl=function(q,Y){var ae=this,Z={headers:Y,cache:"no-store"},K=null;if(typeof AbortController<"u"){var ne=new AbortController;K=this.context.setTimeout((function(){return ne.abort()}),15e3),Z.signal=ne.signal}return new Promise((function(le,ce){ae.context.fetch(q,Z).then((function(de){if(de.status>=400)ce(new x("http error ".concat(de.status,", ").concat(de.statusText)));else{var Me={status:de.status,headers:de.headers};de.json().then((function(qe){Me.json=qe,le(Me)})).catch((function(){le(Me)}))}})).catch((function(de){ce(de)})).finally((function(){K&&ae.context.clearTimeout(K)}))}))},W})(),G=(function(){function W(q){this.enableConsoleLog=q}return W.prototype.onTrace=function(q){this.enableConsoleLog&&console.log("DeviceConfig trace: "+q)},W})(),J=(function(){function W(q){this.enableConsoleLog=q}return W.prototype.onValue=function(q){this.enableConsoleLog&&console.log("DeviceConfig analytics value:  ".concat(q))},W.prototype.onError=function(q){this.enableConsoleLog&&console.error("DeviceConfig analytics error: ".concat(q))},W.prototype.onTrace=function(q){this.enableConsoleLog&&console.log("DeviceConfig analytics trace: ".concat(q))},W})(),B=(function(){function W(q,Y){this.prefix=q,this.storage=Y}return W.prototype.getJson=function(q){var Y=this.prefix+"_"+q;try{var ae=this.storage.getItem(Y);if(ae)return JSON.parse(ae)}catch(Z){console.error("Error getting local storage key ".concat(Y)+Z)}return null},W.prototype.setJson=function(q,Y){var ae=this.prefix+"_"+q;try{this.storage.setItem(ae,JSON.stringify(Y))}catch(Z){console.error("Error setting local storage key ".concat(ae,": ")+Z)}},W})(),$=(function(){function W(){}return W.prototype.getMillis=function(){return Date.now()},W})();(function(W){W[W.STRING=0]="STRING",W[W.NUMBER=1]="NUMBER",W[W.BOOLEAN=2]="BOOLEAN",W[W.JSON=3]="JSON"})(D||(D={}));var U=function(W,q,Y,ae,Z,K,ne,le){switch(this.name=W,this.type=q,this.valueString=Y,this.valueNumber=ae,this.valueBoolean=Z,this.valueJson=K,this.valueAnalytics=ne,this.type){case D.STRING:le===k&&Y&&(this.valueString=atob(Y));break;case D.JSON:le===k&&K&&(this.valueJson=atob(K))}},Q=(function(){function W(q,Y){var ae;this.storage=q,this.key=Y,this.state=(ae=q.getJson(Y))!==null&&ae!==void 0?ae:{}}return W.prototype.getState=function(){return this.state},W.prototype.setState=function(q){Object.assign(this.state,q),this.storage.setJson(this.key,this.state)},W})()},456:function(f,h,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(h,"__esModule",{value:!0}),_(g(903),h)},903:function(f,h,g){var p=this&&this.__spreadArray||function(v,x,E){if(E||arguments.length===2)for(var M,k=0,N=x.length;k<N;k++)!M&&k in x||(M||(M=Array.prototype.slice.call(x,0,k)),M[k]=x[k]);return v.concat(M||Array.prototype.slice.call(x))};Object.defineProperty(h,"__esModule",{value:!0}),h.TypedEmitter=void 0;var _=g(228),y=(function(){function v(x){var E=x.propagateErrors;this.emitter=new _.EventEmitter,this.propagateErrors=E!=null&&E}return v.prototype.on=function(x,E){E.call=this.wrapCall(x,E),this.emitter.on(x,E)},v.prototype.off=function(x,E){this.emitter.off(x,E)},v.prototype.emit=function(x){for(var E,M=[],k=1;k<arguments.length;k++)M[k-1]=arguments[k];(E=this.emitter).emit.apply(E,p([x],M,!1))},v.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},v.prototype.wrapCall=function(x,E){var M=this;return function(k){for(var N=[],I=1;I<arguments.length;I++)N[I-1]=arguments[I];if(M.propagateErrors)E.apply(k,N);else try{E.apply(k,N)}catch(G){var D="Error in callback for ".concat(x),V=E.name;return V&&(D+=" for function ".concat(V)),void console.error(D,G)}}},v})();h.TypedEmitter=y},987:function(f,h,g){var p,_=this&&this.__extends||(p=function(N,I){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,V){D.__proto__=V}||function(D,V){for(var G in V)Object.prototype.hasOwnProperty.call(V,G)&&(D[G]=V[G])},p(N,I)},function(N,I){if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function D(){this.constructor=N}p(N,I),N.prototype=I===null?Object.create(I):(D.prototype=I.prototype,new D)}),y=this&&this.__createBinding||(Object.create?function(N,I,D,V){V===void 0&&(V=D);var G=Object.getOwnPropertyDescriptor(I,D);G&&!("get"in G?!I.__esModule:G.writable||G.configurable)||(G={enumerable:!0,get:function(){return I[D]}}),Object.defineProperty(N,V,G)}:function(N,I,D,V){V===void 0&&(V=D),N[V]=I[D]}),v=this&&this.__setModuleDefault||(Object.create?function(N,I){Object.defineProperty(N,"default",{enumerable:!0,value:I})}:function(N,I){N.default=I}),x=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var I={};if(N!=null)for(var D in N)D!=="default"&&Object.prototype.hasOwnProperty.call(N,D)&&y(I,N,D);return v(I,N),I};Object.defineProperty(h,"__esModule",{value:!0}),h.createFsm=h.FsmWildcardState=h.RejectedTransitionError=h.InvalidStateTransitionError=void 0;var E=x(g(293)),M=(function(N){function I(D,V){var G=N.call(this,"Invalid transition from '".concat(V,"' via event '").concat(D,"'"))||this;return G.name="InvalidStateTransitionError",G}return _(I,N),I})(Error);h.InvalidStateTransitionError=M;var k=(function(N){function I(D,V,G){var J=N.call(this,"Transition from '".concat(V,"' via event '").concat(D,"' was rejected for: ").concat(G))||this;return J.name="RejectedTransitionError",J}return _(I,N),I})(Error);h.RejectedTransitionError=k,h.FsmWildcardState="*",h.createFsm=function(N){var I,D=N.transitions,V=N.callbacks,G=N.initialState,J=function(B){var $,U=($=D[B])===null||$===void 0?void 0:$.from;return!!U&&(typeof U=="string"?U===h.FsmWildcardState:U.includes(G))};return{canTransition:J,transition:function(B,$){var U,Q,W,q,Y,ae;if(!J(B))return E.err(new M(String(G),String(B)));var Z=D[B];return Z.shouldTransition===void 0||Z.shouldTransition(G)?((Q=(U=V?.[G])===null||U===void 0?void 0:U.onExiting)===null||Q===void 0||Q.call(U),(W=V?.onStateExiting)===null||W===void 0||W.call(V,G),I=G,G=Z.to,(Y=(q=V?.[G])===null||q===void 0?void 0:q.onChanged)===null||Y===void 0||Y.call(q,I,$),(ae=V?.onStateChanged)===null||ae===void 0||ae.call(V,I,G,$),E.ok(G)):E.err(new k(String(G),String(B),"shouldTransition returned false"))},previousState:function(){return I},currentState:function(){return G}}}},156:function(f,h,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(h,"__esModule",{value:!0}),h.VERSION=void 0,h.VERSION="0.5.0",_(g(815),h),_(g(456),h),_(g(987),h),_(g(293),h),_(g(925),h)},925:function(f,h,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(h,"__esModule",{value:!0}),_(g(166),h),_(g(612),h),_(g(56),h),_(g(139),h),_(g(877),h)},166:function(f,h,g){var p=this&&this.__assign||function(){return p=Object.assign||function(N){for(var I,D=1,V=arguments.length;D<V;D++)for(var G in I=arguments[D])Object.prototype.hasOwnProperty.call(I,G)&&(N[G]=I[G]);return N},p.apply(this,arguments)},_=this&&this.__spreadArray||function(N,I,D){if(D||arguments.length===2)for(var V,G=0,J=I.length;G<J;G++)!V&&G in I||(V||(V=Array.prototype.slice.call(I,0,G)),V[G]=I[G]);return N.concat(V||Array.prototype.slice.call(I))};Object.defineProperty(h,"__esModule",{value:!0}),h.getLogConfig=h.setLogConfig=h.setLogConfigByLevel=h.extractLogConfig=void 0;var y=g(612),v=g(56),x=g(139),E=g(478),M={enabled:!1,levels:{debug:!0,log:!0,info:!0,warn:!0,error:!0},targets:[(0,v.createConsoleLogTarget)()],categories:{}},k=Object.keys(M);h.extractLogConfig=function(N){var I={};if(Object.keys(N).some((function(B){return k.includes(B)}))){for(var D=0,V=k;D<V.length;D++){var G=V[D];if(N[G]!==void 0){var J=N[G];I[G]=J}}return I}},h.setLogConfigByLevel=function(N){var I=N.enabled||M.enabled,D=N.targets||M.targets,V={debug:!1,log:!1,info:!1,warn:!1,error:!1},G=function(J,B){for(var $=0,U=J;$<U.length;$++){var Q=U[$];V[Q]=B}};switch(N.level){case"debug":G(["debug","log","info","warn","error"],I);break;case"log":G(["log","info","warn","error"],I);break;case"info":G(["info","warn","error"],!0);break;case"warn":G(["warn","error"],!0);break;case"error":G(["error"],!0)}(0,h.setLogConfig)({enabled:I,levels:V,targets:D})},h.setLogConfig=function(N){var I=(0,E.mergeConfigs)(M,N);I&&(M=I,y.defaultLogEmitter.emit(x.LogEventType.CONFIG_UPDATED,M))},h.getLogConfig=function(){return{enabled:M.enabled,levels:p({},M.levels),targets:_([],M.targets,!0),categories:p({},M.categories)}}},612:(f,h,g)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.defaultLogEmitter=void 0;var p=g(456);h.defaultLogEmitter=new p.TypedEmitter({})},56:function(f,h,g){var p=this&&this.__spreadArray||function(y,v,x){if(x||arguments.length===2)for(var E,M=0,k=v.length;M<k;M++)!E&&M in v||(E||(E=Array.prototype.slice.call(v,0,M)),E[M]=v[M]);return y.concat(E||Array.prototype.slice.call(v))};Object.defineProperty(h,"__esModule",{value:!0}),h.createEventLogTarget=h.createConsoleLogTarget=void 0;var _=g(139);h.createConsoleLogTarget=function(){return{handleMessage:function(y){for(var v=[],x=1;x<arguments.length;x++)v[x-1]=arguments[x];console[y].apply(console,v)}}},h.createEventLogTarget=function(y){return{handleMessage:function(v){for(var x=[],E=1;E<arguments.length;E++)x[E-1]=arguments[E];y.emit.apply(y,p([_.LogEventType.MESSAGE_LOGGED,v],x,!1))}}}},139:(f,h)=>{var g;Object.defineProperty(h,"__esModule",{value:!0}),h.LogEventType=void 0,(function(p){p.CONFIG_UPDATED="logConfigUpdated",p.MESSAGE_LOGGED="messageLogged"})(g||(h.LogEventType=g={}))},877:function(f,h,g){var p=this&&this.__assign||function(){return p=Object.assign||function(k){for(var N,I=1,D=arguments.length;I<D;I++)for(var V in N=arguments[I])Object.prototype.hasOwnProperty.call(N,V)&&(k[V]=N[V]);return k},p.apply(this,arguments)},_=this&&this.__spreadArray||function(k,N,I){if(I||arguments.length===2)for(var D,V=0,G=N.length;V<G;V++)!D&&V in N||(D||(D=Array.prototype.slice.call(N,0,V)),D[V]=N[V]);return k.concat(D||Array.prototype.slice.call(N))};Object.defineProperty(h,"__esModule",{value:!0}),h.createLogger=void 0;var y=g(478),v=g(166),x=g(612),E=g(139),M=function(k,N){return(0,y.mergeConfigs)(k,N)||k};h.createLogger=function(k){var N=k.name,I=k.category,D=k.parent,V=(0,v.extractLogConfig)(k)||{},G=M((0,v.getLogConfig)(),V);x.defaultLogEmitter.on(E.LogEventType.CONFIG_UPDATED,(function(Q){G=M(Q,V||{})}));var J=function(Q){for(var W=[],q=1;q<arguments.length;q++)W[q-1]=arguments[q];if(D&&!D.canLog(Q)||!$(Q))return!1;for(var Y=B(),ae=new Date().toTimeString().split(" ")[0],Z=_(["".concat(ae," - (").concat(Y,")")],W,!0),K=0,ne=G.targets;K<ne.length;K++){var le=ne[K];le.handleMessage.apply(le,_([Q],Z,!1))}return!0},B=function(){return D?"".concat(D.getName()," | ").concat(N):N},$=function(Q){return!(!G.enabled||!G.levels[Q]||G.targets.length===0||I!==void 0&&!G.categories[I])},U={debug:function(){for(var Q=[],W=0;W<arguments.length;W++)Q[W]=arguments[W];return J.apply(void 0,_(["debug"],Q,!1))},log:function(){for(var Q=[],W=0;W<arguments.length;W++)Q[W]=arguments[W];return J.apply(void 0,_(["log"],Q,!1))},info:function(){for(var Q=[],W=0;W<arguments.length;W++)Q[W]=arguments[W];return J.apply(void 0,_(["info"],Q,!1))},warn:function(){for(var Q=[],W=0;W<arguments.length;W++)Q[W]=arguments[W];return J.apply(void 0,_(["warn"],Q,!1))},error:function(){for(var Q=[],W=0;W<arguments.length;W++)Q[W]=arguments[W];return J.apply(void 0,_(["error"],Q,!1))},getName:B,canLog:$,getChildLogger:function(Q){return(0,h.createLogger)(p(p({},Q),{parent:U}))},setConfig:function(Q){G=M(G,V=Q)}};return U}},478:function(f,h,g){var p=this&&this.__spreadArray||function(v,x,E){if(E||arguments.length===2)for(var M,k=0,N=x.length;k<N;k++)!M&&k in x||(M||(M=Array.prototype.slice.call(x,0,k)),M[k]=x[k]);return v.concat(M||Array.prototype.slice.call(x))};Object.defineProperty(h,"__esModule",{value:!0}),h.mergeConfigs=void 0;var _=g(543),y=function(v,x){if((0,_.isArray)(v))return x};h.mergeConfigs=function(v){for(var x=[],E=1;E<arguments.length;E++)x[E-1]=arguments[E];var M=x.map((function(k){return k==null||typeof k!="object"})).filter(Boolean).length>0;if(typeof v=="object"&&!M)return _.mergeWith.apply(void 0,p(p([{},v],x,!1),[y],!1))}},293:(f,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getErr=h.getOk_or=h.getOk=h.isNotOk=h.isOk=h.err=h.ok=void 0,h.ok=function(g){return{ok:!0,value:g}},h.err=function(g){return{ok:!1,error:g}},h.isOk=function(g){return g.ok===!0},h.isNotOk=function(g){return!(0,h.isOk)(g)},h.getOk=function(g){return g.ok===!0?g.value:void 0},h.getOk_or=function(g,p){return g.ok===!0?g.value:p},h.getErr=function(g){return g.ok===!0?void 0:g.error}}},c={};function u(f){var h=c[f];if(h!==void 0)return h.exports;var g=c[f]={id:f,loaded:!1,exports:{}};return l[f].call(g.exports,g,g.exports,u),g.loaded=!0,g.exports}return u.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),u.nmd=f=>(f.paths=[],f.children||(f.children=[]),f),u(156)})(),a.exports=o()},1549:(a,o,l)=>{var c=l(2032),u=l(3862),f=l(6721),h=l(2749),g=l(5749);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=h,p.prototype.set=g,a.exports=p},79:(a,o,l)=>{var c=l(3702),u=l(80),f=l(4739),h=l(8655),g=l(1175);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=h,p.prototype.set=g,a.exports=p},8223:(a,o,l)=>{var c=l(6110)(l(9325),"Map");a.exports=c},3661:(a,o,l)=>{var c=l(3040),u=l(7670),f=l(289),h=l(4509),g=l(2949);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=h,p.prototype.set=g,a.exports=p},7217:(a,o,l)=>{var c=l(79),u=l(1420),f=l(938),h=l(3605),g=l(9817),p=l(945);function _(y){var v=this.__data__=new c(y);this.size=v.size}_.prototype.clear=u,_.prototype.delete=f,_.prototype.get=h,_.prototype.has=g,_.prototype.set=p,a.exports=_},1873:(a,o,l)=>{var c=l(9325).Symbol;a.exports=c},7828:(a,o,l)=>{var c=l(9325).Uint8Array;a.exports=c},1033:a=>{a.exports=function(o,l,c){switch(c.length){case 0:return o.call(l);case 1:return o.call(l,c[0]);case 2:return o.call(l,c[0],c[1]);case 3:return o.call(l,c[0],c[1],c[2])}return o.apply(l,c)}},695:(a,o,l)=>{var c=l(8096),u=l(2428),f=l(6449),h=l(3656),g=l(361),p=l(7167),_=Object.prototype.hasOwnProperty;a.exports=function(y,v){var x=f(y),E=!x&&u(y),M=!x&&!E&&h(y),k=!x&&!E&&!M&&p(y),N=x||E||M||k,I=N?c(y.length,String):[],D=I.length;for(var V in y)!v&&!_.call(y,V)||N&&(V=="length"||M&&(V=="offset"||V=="parent")||k&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||g(V,D))||I.push(V);return I}},7805:(a,o,l)=>{var c=l(3360),u=l(5288);a.exports=function(f,h,g){(g!==void 0&&!u(f[h],g)||g===void 0&&!(h in f))&&c(f,h,g)}},6547:(a,o,l)=>{var c=l(3360),u=l(5288),f=Object.prototype.hasOwnProperty;a.exports=function(h,g,p){var _=h[g];f.call(h,g)&&u(_,p)&&(p!==void 0||g in h)||c(h,g,p)}},6025:(a,o,l)=>{var c=l(5288);a.exports=function(u,f){for(var h=u.length;h--;)if(c(u[h][0],f))return h;return-1}},3360:(a,o,l)=>{var c=l(3243);a.exports=function(u,f,h){f=="__proto__"&&c?c(u,f,{configurable:!0,enumerable:!0,value:h,writable:!0}):u[f]=h}},9344:(a,o,l)=>{var c=l(3805),u=Object.create,f=(function(){function h(){}return function(g){if(!c(g))return{};if(u)return u(g);h.prototype=g;var p=new h;return h.prototype=void 0,p}})();a.exports=f},6649:(a,o,l)=>{var c=l(3221)();a.exports=c},2552:(a,o,l)=>{var c=l(1873),u=l(659),f=l(9350),h=c?c.toStringTag:void 0;a.exports=function(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":h&&h in Object(g)?u(g):f(g)}},7534:(a,o,l)=>{var c=l(2552),u=l(346);a.exports=function(f){return u(f)&&c(f)=="[object Arguments]"}},5083:(a,o,l)=>{var c=l(1882),u=l(7296),f=l(3805),h=l(7473),g=/^\[object .+?Constructor\]$/,p=Function.prototype,_=Object.prototype,y=p.toString,v=_.hasOwnProperty,x=RegExp("^"+y.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(E){return!(!f(E)||u(E))&&(c(E)?x:g).test(h(E))}},4901:(a,o,l)=>{var c=l(2552),u=l(294),f=l(346),h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h["[object Arguments]"]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h["[object Map]"]=h["[object Number]"]=h["[object Object]"]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1,a.exports=function(g){return f(g)&&u(g.length)&&!!h[c(g)]}},2903:(a,o,l)=>{var c=l(3805),u=l(5527),f=l(181),h=Object.prototype.hasOwnProperty;a.exports=function(g){if(!c(g))return f(g);var p=u(g),_=[];for(var y in g)(y!="constructor"||!p&&h.call(g,y))&&_.push(y);return _}},5250:(a,o,l)=>{var c=l(7217),u=l(7805),f=l(6649),h=l(2824),g=l(3805),p=l(7241),_=l(4974);a.exports=function y(v,x,E,M,k){v!==x&&f(x,(function(N,I){if(k||(k=new c),g(N))h(v,x,I,E,y,M,k);else{var D=M?M(_(v,I),N,I+"",v,x,k):void 0;D===void 0&&(D=N),u(v,I,D)}}),p)}},2824:(a,o,l)=>{var c=l(7805),u=l(3290),f=l(1961),h=l(3007),g=l(5529),p=l(2428),_=l(6449),y=l(3693),v=l(3656),x=l(1882),E=l(3805),M=l(1331),k=l(7167),N=l(4974),I=l(9884);a.exports=function(D,V,G,J,B,$,U){var Q=N(D,G),W=N(V,G),q=U.get(W);if(q)c(D,G,q);else{var Y=$?$(Q,W,G+"",D,V,U):void 0,ae=Y===void 0;if(ae){var Z=_(W),K=!Z&&v(W),ne=!Z&&!K&&k(W);Y=W,Z||K||ne?_(Q)?Y=Q:y(Q)?Y=h(Q):K?(ae=!1,Y=u(W,!0)):ne?(ae=!1,Y=f(W,!0)):Y=[]:M(W)||p(W)?(Y=Q,p(Q)?Y=I(Q):E(Q)&&!x(Q)||(Y=g(W))):ae=!1}ae&&(U.set(W,Y),B(Y,W,J,$,U),U.delete(W)),c(D,G,Y)}}},9302:(a,o,l)=>{var c=l(3488),u=l(6757),f=l(2865);a.exports=function(h,g){return f(u(h,g,c),h+"")}},9570:(a,o,l)=>{var c=l(7334),u=l(3243),f=l(3488),h=u?function(g,p){return u(g,"toString",{configurable:!0,enumerable:!1,value:c(p),writable:!0})}:f;a.exports=h},8096:a=>{a.exports=function(o,l){for(var c=-1,u=Array(o);++c<o;)u[c]=l(c);return u}},7301:a=>{a.exports=function(o){return function(l){return o(l)}}},9653:(a,o,l)=>{var c=l(7828);a.exports=function(u){var f=new u.constructor(u.byteLength);return new c(f).set(new c(u)),f}},3290:(a,o,l)=>{a=l.nmd(a);var c=l(9325),u=o&&!o.nodeType&&o,f=u&&a&&!a.nodeType&&a,h=f&&f.exports===u?c.Buffer:void 0,g=h?h.allocUnsafe:void 0;a.exports=function(p,_){if(_)return p.slice();var y=p.length,v=g?g(y):new p.constructor(y);return p.copy(v),v}},1961:(a,o,l)=>{var c=l(9653);a.exports=function(u,f){var h=f?c(u.buffer):u.buffer;return new u.constructor(h,u.byteOffset,u.length)}},3007:a=>{a.exports=function(o,l){var c=-1,u=o.length;for(l||(l=Array(u));++c<u;)l[c]=o[c];return l}},1791:(a,o,l)=>{var c=l(6547),u=l(3360);a.exports=function(f,h,g,p){var _=!g;g||(g={});for(var y=-1,v=h.length;++y<v;){var x=h[y],E=p?p(g[x],f[x],x,g,f):void 0;E===void 0&&(E=f[x]),_?u(g,x,E):c(g,x,E)}return g}},5481:(a,o,l)=>{var c=l(9325)["__core-js_shared__"];a.exports=c},999:(a,o,l)=>{var c=l(9302),u=l(6800);a.exports=function(f){return c((function(h,g){var p=-1,_=g.length,y=_>1?g[_-1]:void 0,v=_>2?g[2]:void 0;for(y=f.length>3&&typeof y=="function"?(_--,y):void 0,v&&u(g[0],g[1],v)&&(y=_<3?void 0:y,_=1),h=Object(h);++p<_;){var x=g[p];x&&f(h,x,p,y)}return h}))}},3221:a=>{a.exports=function(o){return function(l,c,u){for(var f=-1,h=Object(l),g=u(l),p=g.length;p--;){var _=g[o?p:++f];if(c(h[_],_,h)===!1)break}return l}}},3243:(a,o,l)=>{var c=l(6110),u=(function(){try{var f=c(Object,"defineProperty");return f({},"",{}),f}catch{}})();a.exports=u},4840:(a,o,l)=>{var c=typeof l.g=="object"&&l.g&&l.g.Object===Object&&l.g;a.exports=c},2651:(a,o,l)=>{var c=l(4218);a.exports=function(u,f){var h=u.__data__;return c(f)?h[typeof f=="string"?"string":"hash"]:h.map}},6110:(a,o,l)=>{var c=l(5083),u=l(392);a.exports=function(f,h){var g=u(f,h);return c(g)?g:void 0}},8879:(a,o,l)=>{var c=l(4335)(Object.getPrototypeOf,Object);a.exports=c},659:(a,o,l)=>{var c=l(1873),u=Object.prototype,f=u.hasOwnProperty,h=u.toString,g=c?c.toStringTag:void 0;a.exports=function(p){var _=f.call(p,g),y=p[g];try{p[g]=void 0;var v=!0}catch{}var x=h.call(p);return v&&(_?p[g]=y:delete p[g]),x}},392:a=>{a.exports=function(o,l){return o?.[l]}},2032:(a,o,l)=>{var c=l(1042);a.exports=function(){this.__data__=c?c(null):{},this.size=0}},3862:a=>{a.exports=function(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}},6721:(a,o,l)=>{var c=l(1042),u=Object.prototype.hasOwnProperty;a.exports=function(f){var h=this.__data__;if(c){var g=h[f];return g==="__lodash_hash_undefined__"?void 0:g}return u.call(h,f)?h[f]:void 0}},2749:(a,o,l)=>{var c=l(1042),u=Object.prototype.hasOwnProperty;a.exports=function(f){var h=this.__data__;return c?h[f]!==void 0:u.call(h,f)}},5749:(a,o,l)=>{var c=l(1042);a.exports=function(u,f){var h=this.__data__;return this.size+=this.has(u)?0:1,h[u]=c&&f===void 0?"__lodash_hash_undefined__":f,this}},5529:(a,o,l)=>{var c=l(9344),u=l(8879),f=l(5527);a.exports=function(h){return typeof h.constructor!="function"||f(h)?{}:c(u(h))}},361:a=>{var o=/^(?:0|[1-9]\d*)$/;a.exports=function(l,c){var u=typeof l;return!!(c=c??9007199254740991)&&(u=="number"||u!="symbol"&&o.test(l))&&l>-1&&l%1==0&&l<c}},6800:(a,o,l)=>{var c=l(5288),u=l(4894),f=l(361),h=l(3805);a.exports=function(g,p,_){if(!h(_))return!1;var y=typeof p;return!!(y=="number"?u(_)&&f(p,_.length):y=="string"&&p in _)&&c(_[p],g)}},4218:a=>{a.exports=function(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}},7296:(a,o,l)=>{var c,u=l(5481),f=(c=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"";a.exports=function(h){return!!f&&f in h}},5527:a=>{var o=Object.prototype;a.exports=function(l){var c=l&&l.constructor;return l===(typeof c=="function"&&c.prototype||o)}},3702:a=>{a.exports=function(){this.__data__=[],this.size=0}},80:(a,o,l)=>{var c=l(6025),u=Array.prototype.splice;a.exports=function(f){var h=this.__data__,g=c(h,f);return!(g<0)&&(g==h.length-1?h.pop():u.call(h,g,1),--this.size,!0)}},4739:(a,o,l)=>{var c=l(6025);a.exports=function(u){var f=this.__data__,h=c(f,u);return h<0?void 0:f[h][1]}},8655:(a,o,l)=>{var c=l(6025);a.exports=function(u){return c(this.__data__,u)>-1}},1175:(a,o,l)=>{var c=l(6025);a.exports=function(u,f){var h=this.__data__,g=c(h,u);return g<0?(++this.size,h.push([u,f])):h[g][1]=f,this}},3040:(a,o,l)=>{var c=l(1549),u=l(79),f=l(8223);a.exports=function(){this.size=0,this.__data__={hash:new c,map:new(f||u),string:new c}}},7670:(a,o,l)=>{var c=l(2651);a.exports=function(u){var f=c(this,u).delete(u);return this.size-=f?1:0,f}},289:(a,o,l)=>{var c=l(2651);a.exports=function(u){return c(this,u).get(u)}},4509:(a,o,l)=>{var c=l(2651);a.exports=function(u){return c(this,u).has(u)}},2949:(a,o,l)=>{var c=l(2651);a.exports=function(u,f){var h=c(this,u),g=h.size;return h.set(u,f),this.size+=h.size==g?0:1,this}},1042:(a,o,l)=>{var c=l(6110)(Object,"create");a.exports=c},181:a=>{a.exports=function(o){var l=[];if(o!=null)for(var c in Object(o))l.push(c);return l}},6009:(a,o,l)=>{a=l.nmd(a);var c=l(4840),u=o&&!o.nodeType&&o,f=u&&a&&!a.nodeType&&a,h=f&&f.exports===u&&c.process,g=(function(){try{var p=f&&f.require&&f.require("util").types;return p||h&&h.binding&&h.binding("util")}catch{}})();a.exports=g},9350:a=>{var o=Object.prototype.toString;a.exports=function(l){return o.call(l)}},4335:a=>{a.exports=function(o,l){return function(c){return o(l(c))}}},6757:(a,o,l)=>{var c=l(1033),u=Math.max;a.exports=function(f,h,g){return h=u(h===void 0?f.length-1:h,0),function(){for(var p=arguments,_=-1,y=u(p.length-h,0),v=Array(y);++_<y;)v[_]=p[h+_];_=-1;for(var x=Array(h+1);++_<h;)x[_]=p[_];return x[h]=g(v),c(f,this,x)}}},9325:(a,o,l)=>{var c=l(4840),u=typeof self=="object"&&self&&self.Object===Object&&self,f=c||u||Function("return this")();a.exports=f},4974:a=>{a.exports=function(o,l){if((l!=="constructor"||typeof o[l]!="function")&&l!="__proto__")return o[l]}},2865:(a,o,l)=>{var c=l(9570),u=l(1811)(c);a.exports=u},1811:a=>{var o=Date.now;a.exports=function(l){var c=0,u=0;return function(){var f=o(),h=16-(f-u);if(u=f,h>0){if(++c>=800)return arguments[0]}else c=0;return l.apply(void 0,arguments)}}},1420:(a,o,l)=>{var c=l(79);a.exports=function(){this.__data__=new c,this.size=0}},938:a=>{a.exports=function(o){var l=this.__data__,c=l.delete(o);return this.size=l.size,c}},3605:a=>{a.exports=function(o){return this.__data__.get(o)}},9817:a=>{a.exports=function(o){return this.__data__.has(o)}},945:(a,o,l)=>{var c=l(79),u=l(8223),f=l(3661);a.exports=function(h,g){var p=this.__data__;if(p instanceof c){var _=p.__data__;if(!u||_.length<199)return _.push([h,g]),this.size=++p.size,this;p=this.__data__=new f(_)}return p.set(h,g),this.size=p.size,this}},7473:a=>{var o=Function.prototype.toString;a.exports=function(l){if(l!=null){try{return o.call(l)}catch{}try{return l+""}catch{}}return""}},7334:a=>{a.exports=function(o){return function(){return o}}},5288:a=>{a.exports=function(o,l){return o===l||o!=o&&l!=l}},3488:a=>{a.exports=function(o){return o}},2428:(a,o,l)=>{var c=l(7534),u=l(346),f=Object.prototype,h=f.hasOwnProperty,g=f.propertyIsEnumerable,p=c((function(){return arguments})())?c:function(_){return u(_)&&h.call(_,"callee")&&!g.call(_,"callee")};a.exports=p},6449:a=>{var o=Array.isArray;a.exports=o},4894:(a,o,l)=>{var c=l(1882),u=l(294);a.exports=function(f){return f!=null&&u(f.length)&&!c(f)}},3693:(a,o,l)=>{var c=l(4894),u=l(346);a.exports=function(f){return u(f)&&c(f)}},3656:(a,o,l)=>{a=l.nmd(a);var c=l(9325),u=l(9935),f=o&&!o.nodeType&&o,h=f&&a&&!a.nodeType&&a,g=h&&h.exports===f?c.Buffer:void 0,p=(g?g.isBuffer:void 0)||u;a.exports=p},1882:(a,o,l)=>{var c=l(2552),u=l(3805);a.exports=function(f){if(!u(f))return!1;var h=c(f);return h=="[object Function]"||h=="[object GeneratorFunction]"||h=="[object AsyncFunction]"||h=="[object Proxy]"}},294:a=>{a.exports=function(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=9007199254740991}},3805:a=>{a.exports=function(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}},346:a=>{a.exports=function(o){return o!=null&&typeof o=="object"}},1331:(a,o,l)=>{var c=l(2552),u=l(8879),f=l(346),h=Function.prototype,g=Object.prototype,p=h.toString,_=g.hasOwnProperty,y=p.call(Object);a.exports=function(v){if(!f(v)||c(v)!="[object Object]")return!1;var x=u(v);if(x===null)return!0;var E=_.call(x,"constructor")&&x.constructor;return typeof E=="function"&&E instanceof E&&p.call(E)==y}},7167:(a,o,l)=>{var c=l(4901),u=l(7301),f=l(6009),h=f&&f.isTypedArray,g=h?u(h):c;a.exports=g},7241:(a,o,l)=>{var c=l(695),u=l(2903),f=l(4894);a.exports=function(h){return f(h)?c(h,!0):u(h)}},2543:function(a,o,l){var c;a=l.nmd(a),(function(){var u,f="Expected a function",h="__lodash_hash_undefined__",g="__lodash_placeholder__",p=16,_=32,y=64,v=128,x=256,E=1/0,M=9007199254740991,k=NaN,N=4294967295,I=[["ary",v],["bind",1],["bindKey",2],["curry",8],["curryRight",p],["flip",512],["partial",_],["partialRight",y],["rearg",x]],D="[object Arguments]",V="[object Array]",G="[object Boolean]",J="[object Date]",B="[object Error]",$="[object Function]",U="[object GeneratorFunction]",Q="[object Map]",W="[object Number]",q="[object Object]",Y="[object Promise]",ae="[object RegExp]",Z="[object Set]",K="[object String]",ne="[object Symbol]",le="[object WeakMap]",ce="[object ArrayBuffer]",de="[object DataView]",Me="[object Float32Array]",qe="[object Float64Array]",Ne="[object Int8Array]",Ae="[object Int16Array]",Xe="[object Int32Array]",$e="[object Uint8Array]",at="[object Uint8ClampedArray]",pt="[object Uint16Array]",oe="[object Uint32Array]",Ue=/\b__p \+= '';/g,Ge=/\b(__p \+=) '' \+/g,ze=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Be=/&(?:amp|lt|gt|quot|#39);/g,me=/[&<>"']/g,Se=RegExp(Be.source),ke=RegExp(me.source),be=/<%-([\s\S]+?)%>/g,Ke=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,lt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,Vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(Ot.source),je=/^\s+/,ge=/\s/,se=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,_e=/\{\n\/\* \[wrapped with (.+)\] \*/,Ie=/,? & /,De=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Oe=/[()=,{}\[\]\/\s]/,we=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ve=/\w*$/,tt=/^[-+]0x[0-9a-f]+$/i,Ze=/^0b[01]+$/i,nt=/^\[object .+?Constructor\]$/,vt=/^0o[0-7]+$/i,Je=/^(?:0|[1-9]\d*)$/,ht=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,mt=/($^)/,ft=/['\n\r\u2028\u2029\\]/g,_t="\\ud800-\\udfff",gn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",_n="\\u2700-\\u27bf",Bt="a-z\\xdf-\\xf6\\xf8-\\xff",Yt="A-Z\\xc0-\\xd6\\xd8-\\xde",Mt="\\ufe0e\\ufe0f",fn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bn="['’]",cn="["+_t+"]",In="["+fn+"]",Wn="["+gn+"]",er="\\d+",os="["+_n+"]",gi="["+Bt+"]",Ni="[^"+_t+fn+er+_n+Bt+Yt+"]",Fs="\\ud83c[\\udffb-\\udfff]",_i="[^"+_t+"]",Rs="(?:\\ud83c[\\udde6-\\uddff]){2}",ra="[\\ud800-\\udbff][\\udc00-\\udfff]",ls="["+Yt+"]",We="\\u200d",At="(?:"+gi+"|"+Ni+")",Wt="(?:"+ls+"|"+Ni+")",Kt="(?:['’](?:d|ll|m|re|s|t|ve))?",Lt="(?:['’](?:D|LL|M|RE|S|T|VE))?",yn="(?:"+Wn+"|"+Fs+")?",zn="["+Mt+"]?",En=zn+yn+("(?:"+We+"(?:"+[_i,Rs,ra].join("|")+")"+zn+yn+")*"),tr="(?:"+[os,Rs,ra].join("|")+")"+En,Nr="(?:"+[_i+Wn+"?",Wn,Rs,ra,cn].join("|")+")",Er=RegExp(Bn,"g"),rr=RegExp(Wn,"g"),Lr=RegExp(Fs+"(?="+Fs+")|"+Nr+En,"g"),ii=RegExp([ls+"?"+gi+"+"+Kt+"(?="+[In,ls,"$"].join("|")+")",Wt+"+"+Lt+"(?="+[In,ls+At,"$"].join("|")+")",ls+"?"+At+"+"+Kt,ls+"+"+Lt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",er,tr].join("|"),"g"),da=RegExp("["+We+_t+gn+Mt+"]"),Mr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,si=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Tr=-1,Dr={};Dr[Me]=Dr[qe]=Dr[Ne]=Dr[Ae]=Dr[Xe]=Dr[$e]=Dr[at]=Dr[pt]=Dr[oe]=!0,Dr[D]=Dr[V]=Dr[ce]=Dr[G]=Dr[de]=Dr[J]=Dr[B]=Dr[$]=Dr[Q]=Dr[W]=Dr[q]=Dr[ae]=Dr[Z]=Dr[K]=Dr[le]=!1;var Cn={};Cn[D]=Cn[V]=Cn[ce]=Cn[de]=Cn[G]=Cn[J]=Cn[Me]=Cn[qe]=Cn[Ne]=Cn[Ae]=Cn[Xe]=Cn[Q]=Cn[W]=Cn[q]=Cn[ae]=Cn[Z]=Cn[K]=Cn[ne]=Cn[$e]=Cn[at]=Cn[pt]=Cn[oe]=!0,Cn[B]=Cn[$]=Cn[le]=!1;var jr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Uo=parseFloat,cs=parseInt,Bo=typeof l.g=="object"&&l.g&&l.g.Object===Object&&l.g,us=typeof self=="object"&&self&&self.Object===Object&&self,Xn=Bo||us||Function("return this")(),ei=o&&!o.nodeType&&o,ur=ei&&a&&!a.nodeType&&a,zs=ur&&ur.exports===ei,So=zs&&Bo.process,pa=(function(){try{var rt=ur&&ur.require&&ur.require("util").types;return rt||So&&So.binding&&So.binding("util")}catch{}})(),ma=pa&&pa.isArrayBuffer,zh=pa&&pa.isDate,op=pa&&pa.isMap,Wp=pa&&pa.isRegExp,Yp=pa&&pa.isSet,rh=pa&&pa.isTypedArray;function wl(rt,Tt,Rt){switch(Rt.length){case 0:return rt.call(Tt);case 1:return rt.call(Tt,Rt[0]);case 2:return rt.call(Tt,Rt[0],Rt[1]);case 3:return rt.call(Tt,Rt[0],Rt[1],Rt[2])}return rt.apply(Tt,Rt)}function cc(rt,Tt,Rt,tn){for(var wn=-1,Zn=rt==null?0:rt.length;++wn<Zn;){var Ci=rt[wn];Tt(tn,Ci,Rt(Ci),rt)}return tn}function Fo(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function il(rt,Tt){for(var Rt=rt==null?0:rt.length;Rt--&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function Xp(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(!Tt(rt[Rt],Rt,rt))return!1;return!0}function Ac(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=0,Zn=[];++Rt<tn;){var Ci=rt[Rt];Tt(Ci,Rt,rt)&&(Zn[wn++]=Ci)}return Zn}function Wc(rt,Tt){return!!(rt!=null&&rt.length)&&Xc(rt,Tt,0)>-1}function Yu(rt,Tt,Rt){for(var tn=-1,wn=rt==null?0:rt.length;++tn<wn;)if(Rt(Tt,rt[tn]))return!0;return!1}function Yi(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=Array(tn);++Rt<tn;)wn[Rt]=Tt(rt[Rt],Rt,rt);return wn}function Xi(rt,Tt){for(var Rt=-1,tn=Tt.length,wn=rt.length;++Rt<tn;)rt[wn+Rt]=Tt[Rt];return rt}function Cc(rt,Tt,Rt,tn){var wn=-1,Zn=rt==null?0:rt.length;for(tn&&Zn&&(Rt=rt[++wn]);++wn<Zn;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Ef(rt,Tt,Rt,tn){var wn=rt==null?0:rt.length;for(tn&&wn&&(Rt=rt[--wn]);wn--;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Jm(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(Tt(rt[Rt],Rt,rt))return!0;return!1}var uc=sh("length");function uo(rt,Tt,Rt){var tn;return Rt(rt,(function(wn,Zn,Ci){if(Tt(wn,Zn,Ci))return tn=Zn,!1})),tn}function Yc(rt,Tt,Rt,tn){for(var wn=rt.length,Zn=Rt+(tn?1:-1);tn?Zn--:++Zn<wn;)if(Tt(rt[Zn],Zn,rt))return Zn;return-1}function Xc(rt,Tt,Rt){return Tt==Tt?(function(tn,wn,Zn){for(var Ci=Zn-1,al=tn.length;++Ci<al;)if(tn[Ci]===wn)return Ci;return-1})(rt,Tt,Rt):Yc(rt,ga,Rt)}function ih(rt,Tt,Rt,tn){for(var wn=Rt-1,Zn=rt.length;++wn<Zn;)if(tn(rt[wn],Tt))return wn;return-1}function ga(rt){return rt!=rt}function xf(rt,Tt){var Rt=rt==null?0:rt.length;return Rt?Xu(rt,Tt)/Rt:k}function sh(rt){return function(Tt){return Tt==null?u:Tt[rt]}}function ah(rt){return function(Tt){return rt==null?u:rt[Tt]}}function Qm(rt,Tt,Rt,tn,wn){return wn(rt,(function(Zn,Ci,al){Rt=tn?(tn=!1,Zn):Tt(Rt,Zn,Ci,al)})),Rt}function Xu(rt,Tt){for(var Rt,tn=-1,wn=rt.length;++tn<wn;){var Zn=Tt(rt[tn]);Zn!==u&&(Rt=Rt===u?Zn:Rt+Zn)}return Rt}function Tf(rt,Tt){for(var Rt=-1,tn=Array(rt);++Rt<rt;)tn[Rt]=Tt(Rt);return tn}function oh(rt){return rt&&rt.slice(0,cp(rt)+1).replace(je,"")}function zo(rt){return function(Tt){return rt(Tt)}}function $l(rt,Tt){return Yi(Tt,(function(Rt){return rt[Rt]}))}function Rd(rt,Tt){return rt.has(Tt)}function Kp(rt,Tt){for(var Rt=-1,tn=rt.length;++Rt<tn&&Xc(Tt,rt[Rt],0)>-1;);return Rt}function sl(rt,Tt){for(var Rt=rt.length;Rt--&&Xc(Tt,rt[Rt],0)>-1;);return Rt}var eg=ah({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),G_=ah({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function $_(rt){return"\\"+jr[rt]}function lp(rt){return da.test(rt)}function jh(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn,wn){Rt[++Tt]=[wn,tn]})),Rt}function Hh(rt,Tt){return function(Rt){return rt(Tt(Rt))}}function Ku(rt,Tt){for(var Rt=-1,tn=rt.length,wn=0,Zn=[];++Rt<tn;){var Ci=rt[Rt];Ci!==Tt&&Ci!==g||(rt[Rt]=g,Zn[wn++]=Rt)}return Zn}function Zu(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=tn})),Rt}function tg(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=[tn,tn]})),Rt}function ys(rt){return lp(rt)?(function(Tt){for(var Rt=Lr.lastIndex=0;Lr.test(Tt);)++Rt;return Rt})(rt):uc(rt)}function wa(rt){return lp(rt)?(function(Tt){return Tt.match(Lr)||[]})(rt):(function(Tt){return Tt.split("")})(rt)}function cp(rt){for(var Tt=rt.length;Tt--&&ge.test(rt.charAt(Tt)););return Tt}var ng=ah({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qh=(function rt(Tt){var Rt,tn=(Tt=Tt==null?Xn:qh.defaults(Xn.Object(),Tt,qh.pick(Xn,si))).Array,wn=Tt.Date,Zn=Tt.Error,Ci=Tt.Function,al=Tt.Math,_r=Tt.Object,Eo=Tt.RegExp,wf=Tt.String,rs=Tt.TypeError,Mc=tn.prototype,lh=Ci.prototype,sr=_r.prototype,Oc=Tt["__core-js_shared__"],Ia=lh.toString,vr=sr.hasOwnProperty,Gr=0,ch=(Rt=/[^.]+$/.exec(Oc&&Oc.keys&&Oc.keys.IE_PROTO||""))?"Symbol(src)_1."+Rt:"",Rf=sr.toString,Q0=Ia.call(_r),Wl=Xn._,rg=Eo("^"+Ia.call(vr).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xo=zs?Tt.Buffer:u,jo=Tt.Symbol,xu=Tt.Uint8Array,Zg=xo?xo.allocUnsafe:u,Tu=Hh(_r.getPrototypeOf,_r),uh=_r.create,Zp=sr.propertyIsEnumerable,fh=Mc.splice,Af=jo?jo.isConcatSpreadable:u,Kc=jo?jo.iterator:u,Vi=jo?jo.toStringTag:u,wu=(function(){try{var w=Ql(_r,"defineProperty");return w({},"",{}),w}catch{}})(),W_=Tt.clearTimeout!==Xn.clearTimeout&&Tt.clearTimeout,Y_=wn&&wn.now!==Xn.Date.now&&wn.now,ig=Tt.setTimeout!==Xn.setTimeout&&Tt.setTimeout,kc=al.ceil,Ad=al.floor,fo=_r.getOwnPropertySymbols,Cf=xo?xo.isBuffer:u,Yl=Tt.isFinite,sg=Mc.join,Jg=Hh(_r.keys,_r),vi=al.max,Ki=al.min,ag=wn.now,hh=Tt.parseInt,up=al.random,Fn=Mc.reverse,js=Ql(Tt,"DataView"),Mf=Ql(Tt,"Map"),To=Ql(Tt,"Promise"),Rl=Ql(Tt,"Set"),Ju=Ql(Tt,"WeakMap"),Of=Ql(_r,"create"),Ic=Ju&&new Ju,As={},Qg=ml(js),Ks=ml(Mf),e_=ml(To),Al=ml(Rl),fp=ml(Ju),Ho=jo?jo.prototype:u,fc=Ho?Ho.valueOf:u,Fr=Ho?Ho.toString:u;function ve(w){if(qr(w)&&!Sr(w)&&!(w instanceof kn)){if(w instanceof Mi)return w;if(vr.call(w,"__wrapped__"))return Bc(w)}return new Mi(w)}var hc=(function(){function w(){}return function(d){if(!la(d))return{};if(uh)return uh(d);w.prototype=d;var b=new w;return w.prototype=u,b}})();function eo(){}function Mi(w,d){this.__wrapped__=w,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=u}function kn(w){this.__wrapped__=w,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=N,this.__views__=[]}function ho(w){var d=-1,b=w==null?0:w.length;for(this.clear();++d<b;){var O=w[d];this.set(O[0],O[1])}}function po(w){var d=-1,b=w==null?0:w.length;for(this.clear();++d<b;){var O=w[d];this.set(O[0],O[1])}}function Zi(w){var d=-1,b=w==null?0:w.length;for(this.clear();++d<b;){var O=w[d];this.set(O[0],O[1])}}function hn(w){var d=-1,b=w==null?0:w.length;for(this.__data__=new Zi;++d<b;)this.add(w[d])}function Ti(w){var d=this.__data__=new po(w);this.size=d.size}function og(w,d){var b=Sr(w),O=!b&&Ff(w),F=!b&&!O&&oa(w),ie=!b&&!O&&!F&&Os(w),pe=b||O||F||ie,ye=pe?Tf(w.length,wf):[],Re=ye.length;for(var Pe in w)!d&&!vr.call(w,Pe)||pe&&(Pe=="length"||F&&(Pe=="offset"||Pe=="parent")||ie&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||Ua(Pe,Re))||ye.push(Pe);return ye}function kf(w){var d=w.length;return d?w[mh(0,d-1)]:u}function If(w,d){return Df(qs(w),Cl(d,0,w.length))}function lg(w){return Df(qs(w))}function wo(w,d,b){(b!==u&&!gl(w[d],b)||b===u&&!(d in w))&&Na(w,d,b)}function Nc(w,d,b){var O=w[d];vr.call(w,d)&&gl(O,b)&&(b!==u||d in w)||Na(w,d,b)}function _a(w,d){for(var b=w.length;b--;)if(gl(w[b][0],d))return b;return-1}function hp(w,d,b,O){return fs(w,(function(F,ie,pe){d(O,F,b(F),pe)})),O}function Ro(w,d){return w&&Il(d,Ji(d),w)}function Na(w,d,b){d=="__proto__"&&wu?wu(w,d,{configurable:!0,enumerable:!0,value:b,writable:!0}):w[d]=b}function dh(w,d){for(var b=-1,O=d.length,F=tn(O),ie=w==null;++b<O;)F[b]=ie?u:ca(w,d[b]);return F}function Cl(w,d,b){return w==w&&(b!==u&&(w=w<=b?w:b),d!==u&&(w=w>=d?w:d)),w}function Hs(w,d,b,O,F,ie){var pe,ye=1&d,Re=2&d,Pe=4&d;if(b&&(pe=F?b(w,O,F,ie):b(w)),pe!==u)return pe;if(!la(w))return w;var Fe=Sr(w);if(Fe){if(pe=(function(bt){var gt=bt.length,kt=new bt.constructor(gt);return gt&&typeof bt[0]=="string"&&vr.call(bt,"index")&&(kt.index=bt.index,kt.input=bt.input),kt})(w),!ye)return qs(w,pe)}else{var Ye=pl(w),dt=Ye==$||Ye==U;if(oa(w))return Hr(w,ye);if(Ye==q||Ye==D||dt&&!F){if(pe=Re||dt?{}:t0(w),!ye)return Re?(function(bt,gt){return Il(bt,Vo(bt),gt)})(w,(function(bt,gt){return bt&&Il(gt,Jr(gt),bt)})(pe,w)):(function(bt,gt){return Il(bt,vp(bt),gt)})(w,Ro(pe,w))}else{if(!Cn[Ye])return F?w:{};pe=(function(bt,gt,kt){var wt=bt.constructor;switch(gt){case ce:return Mu(bt);case G:case J:return new wt(+bt);case de:return(function(Ft,Zt){var Gt=Zt?Mu(Ft.buffer):Ft.buffer;return new Ft.constructor(Gt,Ft.byteOffset,Ft.byteLength)})(bt,kt);case Me:case qe:case Ne:case Ae:case Xe:case $e:case at:case pt:case oe:return Pf(bt,kt);case Q:return new wt;case W:case K:return new wt(bt);case ae:return(function(Ft){var Zt=new Ft.constructor(Ft.source,Ve.exec(Ft));return Zt.lastIndex=Ft.lastIndex,Zt})(bt);case Z:return new wt;case ne:return It=bt,fc?_r(fc.call(It)):{}}var It})(w,Ye,ye)}}ie||(ie=new Ti);var xt=ie.get(w);if(xt)return xt;ie.set(w,pe),Wa(w)?w.forEach((function(bt){pe.add(Hs(bt,d,b,bt,w,ie))})):ds(w)&&w.forEach((function(bt,gt){pe.set(gt,Hs(bt,d,b,gt,w,ie))}));var Dt=Fe?u:(Pe?Re?dl:_p:Re?Jr:Ji)(w);return Fo(Dt||w,(function(bt,gt){Dt&&(bt=w[gt=bt]),Nc(pe,gt,Hs(bt,d,b,gt,w,ie))})),pe}function Ml(w,d,b){var O=b.length;if(w==null)return!O;for(w=_r(w);O--;){var F=b[O],ie=d[F],pe=w[F];if(pe===u&&!(F in w)||!ie(pe))return!1}return!0}function Vh(w,d,b){if(typeof w!="function")throw new rs(f);return Iu((function(){w.apply(u,b)}),d)}function Pc(w,d,b,O){var F=-1,ie=Wc,pe=!0,ye=w.length,Re=[],Pe=d.length;if(!ye)return Re;b&&(d=Yi(d,zo(b))),O?(ie=Yu,pe=!1):d.length>=200&&(ie=Rd,pe=!1,d=new hn(d));e:for(;++F<ye;){var Fe=w[F],Ye=b==null?Fe:b(Fe);if(Fe=O||Fe!==0?Fe:0,pe&&Ye==Ye){for(var dt=Pe;dt--;)if(d[dt]===Ye)continue e;Re.push(Fe)}else ie(d,Ye,O)||Re.push(Fe)}return Re}ve.templateSettings={escape:be,evaluate:Ke,interpolate:ot,variable:"",imports:{_:ve}},ve.prototype=eo.prototype,ve.prototype.constructor=ve,Mi.prototype=hc(eo.prototype),Mi.prototype.constructor=Mi,kn.prototype=hc(eo.prototype),kn.prototype.constructor=kn,ho.prototype.clear=function(){this.__data__=Of?Of(null):{},this.size=0},ho.prototype.delete=function(w){var d=this.has(w)&&delete this.__data__[w];return this.size-=d?1:0,d},ho.prototype.get=function(w){var d=this.__data__;if(Of){var b=d[w];return b===h?u:b}return vr.call(d,w)?d[w]:u},ho.prototype.has=function(w){var d=this.__data__;return Of?d[w]!==u:vr.call(d,w)},ho.prototype.set=function(w,d){var b=this.__data__;return this.size+=this.has(w)?0:1,b[w]=Of&&d===u?h:d,this},po.prototype.clear=function(){this.__data__=[],this.size=0},po.prototype.delete=function(w){var d=this.__data__,b=_a(d,w);return!(b<0)&&(b==d.length-1?d.pop():fh.call(d,b,1),--this.size,!0)},po.prototype.get=function(w){var d=this.__data__,b=_a(d,w);return b<0?u:d[b][1]},po.prototype.has=function(w){return _a(this.__data__,w)>-1},po.prototype.set=function(w,d){var b=this.__data__,O=_a(b,w);return O<0?(++this.size,b.push([w,d])):b[O][1]=d,this},Zi.prototype.clear=function(){this.size=0,this.__data__={hash:new ho,map:new(Mf||po),string:new ho}},Zi.prototype.delete=function(w){var d=rd(this,w).delete(w);return this.size-=d?1:0,d},Zi.prototype.get=function(w){return rd(this,w).get(w)},Zi.prototype.has=function(w){return rd(this,w).has(w)},Zi.prototype.set=function(w,d){var b=rd(this,w),O=b.size;return b.set(w,d),this.size+=b.size==O?0:1,this},hn.prototype.add=hn.prototype.push=function(w){return this.__data__.set(w,h),this},hn.prototype.has=function(w){return this.__data__.has(w)},Ti.prototype.clear=function(){this.__data__=new po,this.size=0},Ti.prototype.delete=function(w){var d=this.__data__,b=d.delete(w);return this.size=d.size,b},Ti.prototype.get=function(w){return this.__data__.get(w)},Ti.prototype.has=function(w){return this.__data__.has(w)},Ti.prototype.set=function(w,d){var b=this.__data__;if(b instanceof po){var O=b.__data__;if(!Mf||O.length<199)return O.push([w,d]),this.size=++b.size,this;b=this.__data__=new Zi(O)}return b.set(w,d),this.size=b.size,this};var fs=Nd(Zs),dc=Nd(Ao,!0);function Gh(w,d){var b=!0;return fs(w,(function(O,F,ie){return b=!!d(O,F,ie)})),b}function Xl(w,d,b){for(var O=-1,F=w.length;++O<F;){var ie=w[O],pe=d(ie);if(pe!=null&&(ye===u?pe==pe&&!Gs(pe):b(pe,ye)))var ye=pe,Re=ie}return Re}function Ru(w,d){var b=[];return fs(w,(function(O,F,ie){d(O,F,ie)&&b.push(O)})),b}function ai(w,d,b,O,F){var ie=-1,pe=w.length;for(b||(b=of),F||(F=[]);++ie<pe;){var ye=w[ie];d>0&&b(ye)?d>1?ai(ye,d-1,b,O,F):Xi(F,ye):O||(F[F.length]=ye)}return F}var $h=tm(),Jp=tm(!0);function Zs(w,d){return w&&$h(w,d,Ji)}function Ao(w,d){return w&&Jp(w,d,Ji)}function Cs(w,d){return Ac(d,(function(b){return bs(w[b])}))}function ti(w,d){for(var b=0,O=(d=rf(d,w)).length;w!=null&&b<O;)w=w[Nu(d[b++])];return b&&b==O?w:u}function Dc(w,d,b){var O=d(w);return Sr(w)?O:Xi(O,b(w))}function yi(w){return w==null?w===u?"[object Undefined]":"[object Null]":Vi&&Vi in _r(w)?(function(d){var b=vr.call(d,Vi),O=d[Vi];try{d[Vi]=u;var F=!0}catch{}var ie=Rf.call(d);return F&&(b?d[Vi]=O:delete d[Vi]),ie})(w):(function(d){return Rf.call(d)})(w)}function Wh(w,d){return w>d}function Yh(w,d){return w!=null&&vr.call(w,d)}function X_(w,d){return w!=null&&d in _r(w)}function Cd(w,d,b){for(var O=b?Yu:Wc,F=w[0].length,ie=w.length,pe=ie,ye=tn(ie),Re=1/0,Pe=[];pe--;){var Fe=w[pe];pe&&d&&(Fe=Yi(Fe,zo(d))),Re=Ki(Fe.length,Re),ye[pe]=!b&&(d||F>=120&&Fe.length>=120)?new hn(pe&&Fe):u}Fe=w[0];var Ye=-1,dt=ye[0];e:for(;++Ye<F&&Pe.length<Re;){var xt=Fe[Ye],Dt=d?d(xt):xt;if(xt=b||xt!==0?xt:0,!(dt?Rd(dt,Dt):O(Pe,Dt,b))){for(pe=ie;--pe;){var bt=ye[pe];if(!(bt?Rd(bt,Dt):O(w[pe],Dt,b)))continue e}dt&&dt.push(Dt),Pe.push(xt)}}return Pe}function ol(w,d,b){var O=(w=sm(w,d=rf(d,w)))==null?w:w[Nu(Pu(d))];return O==null?u:wl(O,w,b)}function Jn(w){return qr(w)&&yi(w)==D}function Pi(w,d,b,O,F){return w===d||(w==null||d==null||!qr(w)&&!qr(d)?w!=w&&d!=d:(function(ie,pe,ye,Re,Pe,Fe){var Ye=Sr(ie),dt=Sr(pe),xt=Ye?V:pl(ie),Dt=dt?V:pl(pe),bt=(xt=xt==D?q:xt)==q,gt=(Dt=Dt==D?q:Dt)==q,kt=xt==Dt;if(kt&&oa(ie)){if(!oa(pe))return!1;Ye=!0,bt=!1}if(kt&&!bt)return Fe||(Fe=new Ti),Ye||Os(ie)?hl(ie,pe,ye,Re,Pe,Fe):(function(Gt,$t,dn,Rn,Nn,qn,Dn){switch(dn){case de:if(Gt.byteLength!=$t.byteLength||Gt.byteOffset!=$t.byteOffset)return!1;Gt=Gt.buffer,$t=$t.buffer;case ce:return!(Gt.byteLength!=$t.byteLength||!qn(new xu(Gt),new xu($t)));case G:case J:case W:return gl(+Gt,+$t);case B:return Gt.name==$t.name&&Gt.message==$t.message;case ae:case K:return Gt==$t+"";case Q:var gr=jh;case Z:var Br=1&Rn;if(gr||(gr=Zu),Gt.size!=$t.size&&!Br)return!1;var Oi=Dn.get(Gt);if(Oi)return Oi==$t;Rn|=2,Dn.set(Gt,$t);var oi=hl(gr(Gt),gr($t),Rn,Nn,qn,Dn);return Dn.delete(Gt),oi;case ne:if(fc)return fc.call(Gt)==fc.call($t)}return!1})(ie,pe,xt,ye,Re,Pe,Fe);if(!(1&ye)){var wt=bt&&vr.call(ie,"__wrapped__"),It=gt&&vr.call(pe,"__wrapped__");if(wt||It){var Ft=wt?ie.value():ie,Zt=It?pe.value():pe;return Fe||(Fe=new Ti),Pe(Ft,Zt,ye,Re,Fe)}}return kt?(Fe||(Fe=new Ti),(function(Gt,$t,dn,Rn,Nn,qn){var Dn=1&dn,gr=_p(Gt),Br=gr.length,Oi=_p($t),oi=Oi.length;if(Br!=oi&&!Dn)return!1;for(var li=Br;li--;){var Fi=gr[li];if(!(Dn?Fi in $t:vr.call($t,Fi)))return!1}var Yr=qn.get(Gt),Ss=qn.get($t);if(Yr&&Ss)return Yr==$t&&Ss==Gt;var ci=!0;qn.set(Gt,$t),qn.set($t,Gt);for(var Is=Dn;++li<Br;){var $i=Gt[Fi=gr[li]],ea=$t[Fi];if(Rn)var Ns=Dn?Rn(ea,$i,Fi,$t,Gt,qn):Rn($i,ea,Fi,Gt,$t,qn);if(!(Ns===u?$i===ea||Nn($i,ea,dn,Rn,qn):Ns)){ci=!1;break}Is||(Is=Fi=="constructor")}if(ci&&!Is){var ms=Gt.constructor,vo=$t.constructor;ms==vo||!("constructor"in Gt)||!("constructor"in $t)||typeof ms=="function"&&ms instanceof ms&&typeof vo=="function"&&vo instanceof vo||(ci=!1)}return qn.delete(Gt),qn.delete($t),ci})(ie,pe,ye,Re,Pe,Fe)):!1})(w,d,b,O,Pi,F))}function Zc(w,d,b,O){var F=b.length,ie=F,pe=!O;if(w==null)return!ie;for(w=_r(w);F--;){var ye=b[F];if(pe&&ye[2]?ye[1]!==w[ye[0]]:!(ye[0]in w))return!1}for(;++F<ie;){var Re=(ye=b[F])[0],Pe=w[Re],Fe=ye[1];if(pe&&ye[2]){if(Pe===u&&!(Re in w))return!1}else{var Ye=new Ti;if(O)var dt=O(Pe,Fe,Re,w,d,Ye);if(!(dt===u?Pi(Fe,Pe,3,O,Ye):dt))return!1}}return!0}function mo(w){return!(!la(w)||(d=w,ch&&ch in d))&&(bs(w)?rg:nt).test(ml(w));var d}function Nf(w){return typeof w=="function"?w:w==null?No:typeof w=="object"?Sr(w)?Co(w[0],w[1]):Md(w):fd(w)}function Jc(w){if(!Va(w))return Jg(w);var d=[];for(var b in _r(w))vr.call(w,b)&&b!="constructor"&&d.push(b);return d}function ph(w){if(!la(w))return(function(F){var ie=[];if(F!=null)for(var pe in _r(F))ie.push(pe);return ie})(w);var d=Va(w),b=[];for(var O in w)(O!="constructor"||!d&&vr.call(w,O))&&b.push(O);return b}function Qc(w,d){return w<d}function Qp(w,d){var b=-1,O=_c(w)?tn(w.length):[];return fs(w,(function(F,ie,pe){O[++b]=d(F,ie,pe)})),O}function Md(w){var d=go(w);return d.length==1&&d[0][2]?n0(d[0][0],d[0][1]):function(b){return b===w||Zc(b,w,d)}}function Co(w,d){return Pd(w)&&rm(d)?n0(Nu(w),d):function(b){var O=ca(b,w);return O===u&&O===d?Ep(b,w):Pi(d,O,3)}}function Xh(w,d,b,O,F){w!==d&&$h(d,(function(ie,pe){if(F||(F=new Ti),la(ie))(function(Re,Pe,Fe,Ye,dt,xt,Dt){var bt=Dd(Re,Fe),gt=Dd(Pe,Fe),kt=Dt.get(gt);if(kt)return void wo(Re,Fe,kt);var wt=xt?xt(bt,gt,Fe+"",Re,Pe,Dt):u,It=wt===u;if(It){var Ft=Sr(gt),Zt=!Ft&&oa(gt),Gt=!Ft&&!Zt&&Os(gt);wt=gt,Ft||Zt||Gt?Sr(bt)?wt=bt:Ui(bt)?wt=qs(bt):Zt?(It=!1,wt=Hr(gt,!0)):Gt?(It=!1,wt=Pf(gt,!0)):wt=[]:ru(gt)||Ff(gt)?(wt=bt,Ff(bt)?wt=Ya(bt):la(bt)&&!bs(bt)||(wt=t0(gt))):It=!1}It&&(Dt.set(gt,wt),dt(wt,gt,Ye,xt,Dt),Dt.delete(gt)),wo(Re,Fe,wt)})(w,d,pe,b,Xh,O,F);else{var ye=O?O(Dd(w,pe),ie,pe+"",w,d,F):u;ye===u&&(ye=ie),wo(w,pe,ye)}}),Jr)}function Qu(w,d){var b=w.length;if(b)return Ua(d+=d<0?b:0,b)?w[d]:u}function Pa(w,d,b){d=d.length?Yi(d,(function(ie){return Sr(ie)?function(pe){return ti(pe,ie.length===1?ie[0]:ie)}:ie})):[No];var O=-1;d=Yi(d,zo(br()));var F=Qp(w,(function(ie,pe,ye){var Re=Yi(d,(function(Pe){return Pe(ie)}));return{criteria:Re,index:++O,value:ie}}));return(function(ie,pe){var ye=ie.length;for(ie.sort(pe);ye--;)ie[ye]=ie[ye].value;return ie})(F,(function(ie,pe){return(function(ye,Re,Pe){for(var Fe=-1,Ye=ye.criteria,dt=Re.criteria,xt=Ye.length,Dt=Pe.length;++Fe<xt;){var bt=Zh(Ye[Fe],dt[Fe]);if(bt)return Fe>=Dt?bt:bt*(Pe[Fe]=="desc"?-1:1)}return ye.index-Re.index})(ie,pe,b)}))}function Kh(w,d,b){for(var O=-1,F=d.length,ie={};++O<F;){var pe=d[O],ye=ti(w,pe);b(ye,pe)&&wi(ie,rf(pe,w),ye)}return ie}function dp(w,d,b,O){var F=O?ih:Xc,ie=-1,pe=d.length,ye=w;for(w===d&&(d=qs(d)),b&&(ye=Yi(w,zo(b)));++ie<pe;)for(var Re=0,Pe=d[ie],Fe=b?b(Pe):Pe;(Re=F(ye,Fe,Re,O))>-1;)ye!==w&&fh.call(ye,Re,1),fh.call(w,Re,1);return w}function ef(w,d){for(var b=w?d.length:0,O=b-1;b--;){var F=d[b];if(b==O||F!==ie){var ie=F;Ua(F)?fh.call(w,F,1):kd(w,F)}}return w}function mh(w,d){return w+Ad(up()*(d-w+1))}function Ur(w,d){var b="";if(!w||d<1||d>M)return b;do d%2&&(b+=w),(d=Ad(d/2))&&(w+=w);while(d);return b}function yr(w,d){return ug(im(w,d,No),w+"")}function ll(w){return kf(su(w))}function Kl(w,d){var b=su(w);return Df(b,Cl(d,0,b.length))}function wi(w,d,b,O){if(!la(w))return w;for(var F=-1,ie=(d=rf(d,w)).length,pe=ie-1,ye=w;ye!=null&&++F<ie;){var Re=Nu(d[F]),Pe=b;if(Re==="__proto__"||Re==="constructor"||Re==="prototype")return w;if(F!=pe){var Fe=ye[Re];(Pe=O?O(Fe,Re,ye):u)===u&&(Pe=la(Fe)?Fe:Ua(d[F+1])?[]:{})}Nc(ye,Re,Pe),ye=ye[Re]}return w}var pp=Ic?function(w,d){return Ic.set(w,d),w}:No,zr=wu?function(w,d){return wu(w,"toString",{configurable:!0,enumerable:!1,value:ud(d),writable:!0})}:No;function Ol(w){return Df(su(w))}function Da(w,d,b){var O=-1,F=w.length;d<0&&(d=-d>F?0:F+d),(b=b>F?F:b)<0&&(b+=F),F=d>b?0:b-d>>>0,d>>>=0;for(var ie=tn(F);++O<F;)ie[O]=w[O+d];return ie}function Od(w,d){var b;return fs(w,(function(O,F,ie){return!(b=d(O,F,ie))})),!!b}function mp(w,d,b){var O=0,F=w==null?O:w.length;if(typeof d=="number"&&d==d&&F<=2147483647){for(;O<F;){var ie=O+F>>>1,pe=w[ie];pe!==null&&!Gs(pe)&&(b?pe<=d:pe<d)?O=ie+1:F=ie}return F}return cl(w,d,No,b)}function cl(w,d,b,O){var F=0,ie=w==null?0:w.length;if(ie===0)return 0;for(var pe=(d=b(d))!=d,ye=d===null,Re=Gs(d),Pe=d===u;F<ie;){var Fe=Ad((F+ie)/2),Ye=b(w[Fe]),dt=Ye!==u,xt=Ye===null,Dt=Ye==Ye,bt=Gs(Ye);if(pe)var gt=O||Dt;else gt=Pe?Dt&&(O||dt):ye?Dt&&dt&&(O||!xt):Re?Dt&&dt&&!xt&&(O||!bt):!xt&&!bt&&(O?Ye<=d:Ye<d);gt?F=Fe+1:ie=Fe}return Ki(ie,4294967294)}function Zl(w,d){for(var b=-1,O=w.length,F=0,ie=[];++b<O;){var pe=w[b],ye=d?d(pe):pe;if(!b||!gl(ye,Re)){var Re=ye;ie[F++]=pe===0?0:pe}}return ie}function Ha(w){return typeof w=="number"?w:Gs(w)?k:+w}function ia(w){if(typeof w=="string")return w;if(Sr(w))return Yi(w,ia)+"";if(Gs(w))return Fr?Fr.call(w):"";var d=w+"";return d=="0"&&1/w==-1/0?"-0":d}function Lc(w,d,b){var O=-1,F=Wc,ie=w.length,pe=!0,ye=[],Re=ye;if(b)pe=!1,F=Yu;else if(ie>=200){var Pe=d?null:La(w);if(Pe)return Zu(Pe);pe=!1,F=Rd,Re=new hn}else Re=d?[]:ye;e:for(;++O<ie;){var Fe=w[O],Ye=d?d(Fe):Fe;if(Fe=b||Fe!==0?Fe:0,pe&&Ye==Ye){for(var dt=Re.length;dt--;)if(Re[dt]===Ye)continue e;d&&Re.push(Ye),ye.push(Fe)}else F(Re,Ye,b)||(Re!==ye&&Re.push(Ye),ye.push(Fe))}return ye}function kd(w,d){return(w=sm(w,d=rf(d,w)))==null||delete w[Nu(Pu(d))]}function Au(w,d,b,O){return wi(w,d,b(ti(w,d)),O)}function to(w,d,b,O){for(var F=w.length,ie=O?F:-1;(O?ie--:++ie<F)&&d(w[ie],ie,w););return b?Da(w,O?0:ie,O?ie+1:F):Da(w,O?ie+1:0,O?F:ie)}function tf(w,d){var b=w;return b instanceof kn&&(b=b.value()),Cc(d,(function(O,F){return F.func.apply(F.thisArg,Xi([O],F.args))}),b)}function Uc(w,d,b){var O=w.length;if(O<2)return O?Lc(w[0]):[];for(var F=-1,ie=tn(O);++F<O;)for(var pe=w[F],ye=-1;++ye<O;)ye!=F&&(ie[F]=Pc(ie[F]||pe,w[ye],d,b));return Lc(ai(ie,1),d,b)}function nf(w,d,b){for(var O=-1,F=w.length,ie=d.length,pe={};++O<F;){var ye=O<ie?d[O]:u;b(pe,w[O],ye)}return pe}function Cu(w){return Ui(w)?w:[]}function Mo(w){return typeof w=="function"?w:No}function rf(w,d){return Sr(w)?w:Pd(w,d)?[w]:Ud(Wr(w))}var sf=yr;function Oo(w,d,b){var O=w.length;return b=b===u?O:b,!d&&b>=O?w:Da(w,d,b)}var em=W_||function(w){return Xn.clearTimeout(w)};function Hr(w,d){if(d)return w.slice();var b=w.length,O=Zg?Zg(b):new w.constructor(b);return w.copy(O),O}function Mu(w){var d=new w.constructor(w.byteLength);return new xu(d).set(new xu(w)),d}function Pf(w,d){var b=d?Mu(w.buffer):w.buffer;return new w.constructor(b,w.byteOffset,w.length)}function Zh(w,d){if(w!==d){var b=w!==u,O=w===null,F=w==w,ie=Gs(w),pe=d!==u,ye=d===null,Re=d==d,Pe=Gs(d);if(!ye&&!Pe&&!ie&&w>d||ie&&pe&&Re&&!ye&&!Pe||O&&pe&&Re||!b&&Re||!F)return 1;if(!O&&!ie&&!Pe&&w<d||Pe&&b&&F&&!O&&!ie||ye&&b&&F||!pe&&F||!Re)return-1}return 0}function Jh(w,d,b,O){for(var F=-1,ie=w.length,pe=b.length,ye=-1,Re=d.length,Pe=vi(ie-pe,0),Fe=tn(Re+Pe),Ye=!O;++ye<Re;)Fe[ye]=d[ye];for(;++F<pe;)(Ye||F<ie)&&(Fe[b[F]]=w[F]);for(;Pe--;)Fe[ye++]=w[F++];return Fe}function kl(w,d,b,O){for(var F=-1,ie=w.length,pe=-1,ye=b.length,Re=-1,Pe=d.length,Fe=vi(ie-ye,0),Ye=tn(Fe+Pe),dt=!O;++F<Fe;)Ye[F]=w[F];for(var xt=F;++Re<Pe;)Ye[xt+Re]=d[Re];for(;++pe<ye;)(dt||F<ie)&&(Ye[xt+b[pe]]=w[F++]);return Ye}function qs(w,d){var b=-1,O=w.length;for(d||(d=tn(O));++b<O;)d[b]=w[b];return d}function Il(w,d,b,O){var F=!b;b||(b={});for(var ie=-1,pe=d.length;++ie<pe;){var ye=d[ie],Re=O?O(b[ye],w[ye],ye,b,w):u;Re===u&&(Re=w[ye]),F?Na(b,ye,Re):Nc(b,ye,Re)}return b}function eu(w,d){return function(b,O){var F=Sr(b)?cc:hp,ie=d?d():{};return F(b,w,br(O,2),ie)}}function Id(w){return yr((function(d,b){var O=-1,F=b.length,ie=F>1?b[F-1]:u,pe=F>2?b[2]:u;for(ie=w.length>3&&typeof ie=="function"?(F--,ie):u,pe&&Go(b[0],b[1],pe)&&(ie=F<3?u:ie,F=1),d=_r(d);++O<F;){var ye=b[O];ye&&w(d,ye,O,ie)}return d}))}function Nd(w,d){return function(b,O){if(b==null)return b;if(!_c(b))return w(b,O);for(var F=b.length,ie=d?F:-1,pe=_r(b);(d?ie--:++ie<F)&&O(pe[ie],ie,pe)!==!1;);return b}}function tm(w){return function(d,b,O){for(var F=-1,ie=_r(d),pe=O(d),ye=pe.length;ye--;){var Re=pe[w?ye:++F];if(b(ie[Re],Re,ie)===!1)break}return d}}function Qh(w){return function(d){var b=lp(d=Wr(d))?wa(d):u,O=b?b[0]:d.charAt(0),F=b?Oo(b,1).join(""):d.slice(1);return O[w]()+F}}function Ou(w){return function(d){return Cc(ar(uf(d).replace(Er,"")),w,"")}}function ul(w){return function(){var d=arguments;switch(d.length){case 0:return new w;case 1:return new w(d[0]);case 2:return new w(d[0],d[1]);case 3:return new w(d[0],d[1],d[2]);case 4:return new w(d[0],d[1],d[2],d[3]);case 5:return new w(d[0],d[1],d[2],d[3],d[4]);case 6:return new w(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new w(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var b=hc(w.prototype),O=w.apply(b,d);return la(O)?O:b}}function af(w){return function(d,b,O){var F=_r(d);if(!_c(d)){var ie=br(b,3);d=Ji(d),b=function(ye){return ie(F[ye],ye,F)}}var pe=w(d,b,O);return pe>-1?F[ie?d[pe]:pe]:u}}function Zr(w){return Jl((function(d){var b=d.length,O=b,F=Mi.prototype.thru;for(w&&d.reverse();O--;){var ie=d[O];if(typeof ie!="function")throw new rs(f);if(F&&!pe&&mc(ie)=="wrapper")var pe=new Mi([],!0)}for(O=pe?O:b;++O<b;){var ye=mc(ie=d[O]),Re=ye=="wrapper"?sa(ie):u;pe=Re&&cg(Re[0])&&Re[1]==424&&!Re[4].length&&Re[9]==1?pe[mc(Re[0])].apply(pe,Re[3]):ie.length==1&&cg(ie)?pe[ye]():pe.thru(ie)}return function(){var Pe=arguments,Fe=Pe[0];if(pe&&Pe.length==1&&Sr(Fe))return pe.plant(Fe).value();for(var Ye=0,dt=b?d[Ye].apply(this,Pe):Fe;++Ye<b;)dt=d[Ye].call(this,dt);return dt}}))}function hs(w,d,b,O,F,ie,pe,ye,Re,Pe){var Fe=d&v,Ye=1&d,dt=2&d,xt=24&d,Dt=512&d,bt=dt?u:ul(w);return function gt(){for(var kt=arguments.length,wt=tn(kt),It=kt;It--;)wt[It]=arguments[It];if(xt)var Ft=dr(gt),Zt=(function(Rn,Nn){for(var qn=Rn.length,Dn=0;qn--;)Rn[qn]===Nn&&++Dn;return Dn})(wt,Ft);if(O&&(wt=Jh(wt,O,F,xt)),ie&&(wt=kl(wt,ie,pe,xt)),kt-=Zt,xt&&kt<Pe){var Gt=Ku(wt,Ft);return qo(w,d,hs,gt.placeholder,b,wt,Gt,ye,Re,Pe-kt)}var $t=Ye?b:this,dn=dt?$t[w]:w;return kt=wt.length,ye?wt=(function(Rn,Nn){for(var qn=Rn.length,Dn=Ki(Nn.length,qn),gr=qs(Rn);Dn--;){var Br=Nn[Dn];Rn[Dn]=Ua(Br,qn)?gr[Br]:u}return Rn})(wt,ye):Dt&&kt>1&&wt.reverse(),Fe&&Re<kt&&(wt.length=Re),this&&this!==Xn&&this instanceof gt&&(dn=bt||ul(dn)),dn.apply($t,wt)}}function qa(w,d){return function(b,O){return(function(F,ie,pe,ye){return Zs(F,(function(Re,Pe,Fe){ie(ye,pe(Re),Pe,Fe)})),ye})(b,w,d(O),{})}}function ed(w,d){return function(b,O){var F;if(b===u&&O===u)return d;if(b!==u&&(F=b),O!==u){if(F===u)return O;typeof b=="string"||typeof O=="string"?(b=ia(b),O=ia(O)):(b=Ha(b),O=Ha(O)),F=w(b,O)}return F}}function ku(w){return Jl((function(d){return d=Yi(d,zo(br())),yr((function(b){var O=this;return w(d,(function(F){return wl(F,O,b)}))}))}))}function fl(w,d){var b=(d=d===u?" ":ia(d)).length;if(b<2)return b?Ur(d,w):d;var O=Ur(d,kc(w/ys(d)));return lp(d)?Oo(wa(O),0,w).join(""):O.slice(0,w)}function no(w){return function(d,b,O){return O&&typeof O!="number"&&Go(d,b,O)&&(b=O=u),d=Pl(d),b===u?(b=d,d=0):b=Pl(b),(function(F,ie,pe,ye){for(var Re=-1,Pe=vi(kc((ie-F)/(pe||1)),0),Fe=tn(Pe);Pe--;)Fe[ye?Pe:++Re]=F,F+=pe;return Fe})(d,b,O=O===u?d<b?1:-1:Pl(O),w)}}function pc(w){return function(d,b){return typeof d=="string"&&typeof b=="string"||(d=Yn(d),b=Yn(b)),w(d,b)}}function qo(w,d,b,O,F,ie,pe,ye,Re,Pe){var Fe=8&d;d|=Fe?_:y,4&(d&=~(Fe?y:_))||(d&=-4);var Ye=[w,d,F,Fe?ie:u,Fe?pe:u,Fe?u:ie,Fe?u:pe,ye,Re,Pe],dt=b.apply(u,Ye);return cg(w)&&Ld(dt,Ye),dt.placeholder=O,t_(dt,w,d)}function e0(w){var d=al[w];return function(b,O){if(b=Yn(b),(O=O==null?0:Ki(mr(O),292))&&Yl(b)){var F=(Wr(b)+"e").split("e");return+((F=(Wr(d(F[0]+"e"+(+F[1]+O)))+"e").split("e"))[0]+"e"+(+F[1]-O))}return d(b)}}var La=Rl&&1/Zu(new Rl([,-0]))[1]==E?function(w){return new Rl(w)}:ff;function Js(w){return function(d){var b=pl(d);return b==Q?jh(d):b==Z?tg(d):(function(O,F){return Yi(F,(function(ie){return[ie,O[ie]]}))})(d,w(d))}}function ro(w,d,b,O,F,ie,pe,ye){var Re=2&d;if(!Re&&typeof w!="function")throw new rs(f);var Pe=O?O.length:0;if(Pe||(d&=-97,O=F=u),pe=pe===u?pe:vi(mr(pe),0),ye=ye===u?ye:mr(ye),Pe-=F?F.length:0,d&y){var Fe=O,Ye=F;O=F=u}var dt=Re?u:sa(w),xt=[w,d,b,O,F,Fe,Ye,ie,pe,ye];if(dt&&(function(bt,gt){var kt=bt[1],wt=gt[1],It=kt|wt,Ft=It<131,Zt=wt==v&&kt==8||wt==v&&kt==x&&bt[7].length<=gt[8]||wt==384&&gt[7].length<=gt[8]&&kt==8;if(!Ft&&!Zt)return bt;1&wt&&(bt[2]=gt[2],It|=1&kt?0:4);var Gt=gt[3];if(Gt){var $t=bt[3];bt[3]=$t?Jh($t,Gt,gt[4]):Gt,bt[4]=$t?Ku(bt[3],g):gt[4]}(Gt=gt[5])&&($t=bt[5],bt[5]=$t?kl($t,Gt,gt[6]):Gt,bt[6]=$t?Ku(bt[5],g):gt[6]),(Gt=gt[7])&&(bt[7]=Gt),wt&v&&(bt[8]=bt[8]==null?gt[8]:Ki(bt[8],gt[8])),bt[9]==null&&(bt[9]=gt[9]),bt[0]=gt[0],bt[1]=It})(xt,dt),w=xt[0],d=xt[1],b=xt[2],O=xt[3],F=xt[4],!(ye=xt[9]=xt[9]===u?Re?0:w.length:vi(xt[9]-Pe,0))&&24&d&&(d&=-25),d&&d!=1)Dt=d==8||d==p?(function(bt,gt,kt){var wt=ul(bt);return function It(){for(var Ft=arguments.length,Zt=tn(Ft),Gt=Ft,$t=dr(It);Gt--;)Zt[Gt]=arguments[Gt];var dn=Ft<3&&Zt[0]!==$t&&Zt[Ft-1]!==$t?[]:Ku(Zt,$t);return(Ft-=dn.length)<kt?qo(bt,gt,hs,It.placeholder,u,Zt,dn,u,u,kt-Ft):wl(this&&this!==Xn&&this instanceof It?wt:bt,this,Zt)}})(w,d,ye):d!=_&&d!=33||F.length?hs.apply(u,xt):(function(bt,gt,kt,wt){var It=1&gt,Ft=ul(bt);return function Zt(){for(var Gt=-1,$t=arguments.length,dn=-1,Rn=wt.length,Nn=tn(Rn+$t),qn=this&&this!==Xn&&this instanceof Zt?Ft:bt;++dn<Rn;)Nn[dn]=wt[dn];for(;$t--;)Nn[dn++]=arguments[++Gt];return wl(qn,It?kt:this,Nn)}})(w,d,b,O);else var Dt=(function(bt,gt,kt){var wt=1&gt,It=ul(bt);return function Ft(){return(this&&this!==Xn&&this instanceof Ft?It:bt).apply(wt?kt:this,arguments)}})(w,d,b);return t_((dt?pp:Ld)(Dt,xt),w,d)}function td(w,d,b,O){return w===u||gl(w,sr[b])&&!vr.call(O,b)?d:w}function nd(w,d,b,O,F,ie){return la(w)&&la(d)&&(ie.set(d,w),Xh(w,d,u,nd,ie),ie.delete(d)),w}function gp(w){return ru(w)?u:w}function hl(w,d,b,O,F,ie){var pe=1&b,ye=w.length,Re=d.length;if(ye!=Re&&!(pe&&Re>ye))return!1;var Pe=ie.get(w),Fe=ie.get(d);if(Pe&&Fe)return Pe==d&&Fe==w;var Ye=-1,dt=!0,xt=2&b?new hn:u;for(ie.set(w,d),ie.set(d,w);++Ye<ye;){var Dt=w[Ye],bt=d[Ye];if(O)var gt=pe?O(bt,Dt,Ye,d,w,ie):O(Dt,bt,Ye,w,d,ie);if(gt!==u){if(gt)continue;dt=!1;break}if(xt){if(!Jm(d,(function(kt,wt){if(!Rd(xt,wt)&&(Dt===kt||F(Dt,kt,b,O,ie)))return xt.push(wt)}))){dt=!1;break}}else if(Dt!==bt&&!F(Dt,bt,b,O,ie)){dt=!1;break}}return ie.delete(w),ie.delete(d),dt}function Jl(w){return ug(im(w,u,s0),w+"")}function _p(w){return Dc(w,Ji,vp)}function dl(w){return Dc(w,Jr,Vo)}var sa=Ic?function(w){return Ic.get(w)}:ff;function mc(w){for(var d=w.name+"",b=As[d],O=vr.call(As,d)?b.length:0;O--;){var F=b[O],ie=F.func;if(ie==null||ie==w)return F.name}return d}function dr(w){return(vr.call(ve,"placeholder")?ve:w).placeholder}function br(){var w=ve.iteratee||ps;return w=w===ps?Nf:w,arguments.length?w(arguments[0],arguments[1]):w}function rd(w,d){var b,O,F=w.__data__;return((O=typeof(b=d))=="string"||O=="number"||O=="symbol"||O=="boolean"?b!=="__proto__":b===null)?F[typeof d=="string"?"string":"hash"]:F.map}function go(w){for(var d=Ji(w),b=d.length;b--;){var O=d[b],F=w[O];d[b]=[O,F,rm(F)]}return d}function Ql(w,d){var b=(function(O,F){return O==null?u:O[F]})(w,d);return mo(b)?b:u}var vp=fo?function(w){return w==null?[]:(w=_r(w),Ac(fo(w),(function(d){return Zp.call(w,d)})))}:jf,Vo=fo?function(w){for(var d=[];w;)Xi(d,vp(w)),w=Tu(w);return d}:jf,pl=yi;function id(w,d,b){for(var O=-1,F=(d=rf(d,w)).length,ie=!1;++O<F;){var pe=Nu(d[O]);if(!(ie=w!=null&&b(w,pe)))break;w=w[pe]}return ie||++O!=F?ie:!!(F=w==null?0:w.length)&&Nl(F)&&Ua(pe,F)&&(Sr(w)||Ff(w))}function t0(w){return typeof w.constructor!="function"||Va(w)?{}:hc(Tu(w))}function of(w){return Sr(w)||Ff(w)||!!(Af&&w&&w[Af])}function Ua(w,d){var b=typeof w;return!!(d=d??M)&&(b=="number"||b!="symbol"&&Je.test(w))&&w>-1&&w%1==0&&w<d}function Go(w,d,b){if(!la(b))return!1;var O=typeof d;return!!(O=="number"?_c(b)&&Ua(d,b.length):O=="string"&&d in b)&&gl(b[d],w)}function Pd(w,d){if(Sr(w))return!1;var b=typeof w;return!(b!="number"&&b!="symbol"&&b!="boolean"&&w!=null&&!Gs(w))||ct.test(w)||!lt.test(w)||d!=null&&w in _r(d)}function cg(w){var d=mc(w),b=ve[d];if(typeof b!="function"||!(d in kn.prototype))return!1;if(w===b)return!0;var O=sa(b);return!!O&&w===O[0]}(js&&pl(new js(new ArrayBuffer(1)))!=de||Mf&&pl(new Mf)!=Q||To&&pl(To.resolve())!=Y||Rl&&pl(new Rl)!=Z||Ju&&pl(new Ju)!=le)&&(pl=function(w){var d=yi(w),b=d==q?w.constructor:u,O=b?ml(b):"";if(O)switch(O){case Qg:return de;case Ks:return Q;case e_:return Y;case Al:return Z;case fp:return le}return d});var nm=Oc?bs:Uu;function Va(w){var d=w&&w.constructor;return w===(typeof d=="function"&&d.prototype||sr)}function rm(w){return w==w&&!la(w)}function n0(w,d){return function(b){return b!=null&&b[w]===d&&(d!==u||w in _r(b))}}function im(w,d,b){return d=vi(d===u?w.length-1:d,0),function(){for(var O=arguments,F=-1,ie=vi(O.length-d,0),pe=tn(ie);++F<ie;)pe[F]=O[d+F];F=-1;for(var ye=tn(d+1);++F<d;)ye[F]=O[F];return ye[d]=b(pe),wl(w,this,ye)}}function sm(w,d){return d.length<2?w:ti(w,Da(d,0,-1))}function Dd(w,d){if((d!=="constructor"||typeof w[d]!="function")&&d!="__proto__")return w[d]}var Ld=am(pp),Iu=ig||function(w,d){return Xn.setTimeout(w,d)},ug=am(zr);function t_(w,d,b){var O=d+"";return ug(w,(function(F,ie){var pe=ie.length;if(!pe)return F;var ye=pe-1;return ie[ye]=(pe>1?"& ":"")+ie[ye],ie=ie.join(pe>2?", ":" "),F.replace(se,`{
/* [wrapped with `+ie+`] */
`)})(O,(function(F,ie){return Fo(I,(function(pe){var ye="_."+pe[0];ie&pe[1]&&!Wc(F,ye)&&F.push(ye)})),F.sort()})((function(F){var ie=F.match(_e);return ie?ie[1].split(Ie):[]})(O),b)))}function am(w){var d=0,b=0;return function(){var O=ag(),F=16-(O-b);if(b=O,F>0){if(++d>=800)return arguments[0]}else d=0;return w.apply(u,arguments)}}function Df(w,d){var b=-1,O=w.length,F=O-1;for(d=d===u?O:d;++b<d;){var ie=mh(b,F),pe=w[ie];w[ie]=w[b],w[b]=pe}return w.length=d,w}var Ud=(function(w){var d=Bf(w,(function(O){return b.size===500&&b.clear(),O})),b=d.cache;return d})((function(w){var d=[];return w.charCodeAt(0)===46&&d.push(""),w.replace(Vt,(function(b,O,F,ie){d.push(F?ie.replace(we,"$1"):O||b)})),d}));function Nu(w){if(typeof w=="string"||Gs(w))return w;var d=w+"";return d=="0"&&1/w==-1/0?"-0":d}function ml(w){if(w!=null){try{return Ia.call(w)}catch{}try{return w+""}catch{}}return""}function Bc(w){if(w instanceof kn)return w.clone();var d=new Mi(w.__wrapped__,w.__chain__);return d.__actions__=qs(w.__actions__),d.__index__=w.__index__,d.__values__=w.__values__,d}var om=yr((function(w,d){return Ui(w)?Pc(w,ai(d,1,Ui,!0)):[]})),r0=yr((function(w,d){var b=Pu(d);return Ui(b)&&(b=u),Ui(w)?Pc(w,ai(d,1,Ui,!0),br(b,2)):[]})),lm=yr((function(w,d){var b=Pu(d);return Ui(b)&&(b=u),Ui(w)?Pc(w,ai(d,1,Ui,!0),u,b):[]}));function fg(w,d,b){var O=w==null?0:w.length;if(!O)return-1;var F=b==null?0:mr(b);return F<0&&(F=vi(O+F,0)),Yc(w,br(d,3),F)}function i0(w,d,b){var O=w==null?0:w.length;if(!O)return-1;var F=O-1;return b!==u&&(F=mr(b),F=b<0?vi(O+F,0):Ki(F,O-1)),Yc(w,br(d,3),F,!0)}function s0(w){return w!=null&&w.length?ai(w,1):[]}function cm(w){return w&&w.length?w[0]:u}var n_=yr((function(w){var d=Yi(w,Cu);return d.length&&d[0]===w[0]?Cd(d):[]})),um=yr((function(w){var d=Pu(w),b=Yi(w,Cu);return d===Pu(b)?d=u:b.pop(),b.length&&b[0]===w[0]?Cd(b,br(d,2)):[]})),a0=yr((function(w){var d=Pu(w),b=Yi(w,Cu);return(d=typeof d=="function"?d:u)&&b.pop(),b.length&&b[0]===w[0]?Cd(b,u,d):[]}));function Pu(w){var d=w==null?0:w.length;return d?w[d-1]:u}var ec=yr(hg);function hg(w,d){return w&&w.length&&d&&d.length?dp(w,d):w}var dg=Jl((function(w,d){var b=w==null?0:w.length,O=dh(w,d);return ef(w,Yi(d,(function(F){return Ua(F,b)?+F:F})).sort(Zh)),O}));function o0(w){return w==null?w:Fn.call(w)}var l0=yr((function(w){return Lc(ai(w,1,Ui,!0))})),r_=yr((function(w){var d=Pu(w);return Ui(d)&&(d=u),Lc(ai(w,1,Ui,!0),br(d,2))})),K_=yr((function(w){var d=Pu(w);return d=typeof d=="function"?d:u,Lc(ai(w,1,Ui,!0),u,d)}));function c0(w){if(!w||!w.length)return[];var d=0;return w=Ac(w,(function(b){if(Ui(b))return d=vi(b.length,d),!0})),Tf(d,(function(b){return Yi(w,sh(b))}))}function u0(w,d){if(!w||!w.length)return[];var b=c0(w);return d==null?b:Yi(b,(function(O){return wl(d,u,O)}))}var i_=yr((function(w,d){return Ui(w)?Pc(w,d):[]})),Z_=yr((function(w){return Uc(Ac(w,Ui))})),pg=yr((function(w){var d=Pu(w);return Ui(d)&&(d=u),Uc(Ac(w,Ui),br(d,2))})),mg=yr((function(w){var d=Pu(w);return d=typeof d=="function"?d:u,Uc(Ac(w,Ui),u,d)})),f0=yr(c0),J_=yr((function(w){var d=w.length,b=d>1?w[d-1]:u;return b=typeof b=="function"?(w.pop(),b):u,u0(w,b)}));function tu(w){var d=ve(w);return d.__chain__=!0,d}function sd(w,d){return d(w)}var yp=Jl((function(w){var d=w.length,b=d?w[0]:0,O=this.__wrapped__,F=function(ie){return dh(ie,w)};return!(d>1||this.__actions__.length)&&O instanceof kn&&Ua(b)?((O=O.slice(b,+b+(d?1:0))).__actions__.push({func:sd,args:[F],thisArg:u}),new Mi(O,this.__chain__).thru((function(ie){return d&&!ie.length&&ie.push(u),ie}))):this.thru(F)})),s_=eu((function(w,d,b){vr.call(w,b)?++w[b]:Na(w,b,1)})),Q_=af(fg),bp=af(i0);function fm(w,d){return(Sr(w)?Fo:fs)(w,br(d,3))}function Bd(w,d){return(Sr(w)?il:dc)(w,br(d,3))}var gh=eu((function(w,d,b){vr.call(w,b)?w[b].push(d):Na(w,b,[d])})),tc=yr((function(w,d,b){var O=-1,F=typeof d=="function",ie=_c(w)?tn(w.length):[];return fs(w,(function(pe){ie[++O]=F?wl(d,pe,b):ol(pe,d,b)})),ie})),Du=eu((function(w,d,b){Na(w,b,d)}));function Ms(w,d){return(Sr(w)?Yi:Qp)(w,br(d,3))}var _h=eu((function(w,d,b){w[b?0:1].push(d)}),(function(){return[[],[]]})),a_=yr((function(w,d){if(w==null)return[];var b=d.length;return b>1&&Go(w,d[0],d[1])?d=[]:b>2&&Go(d[0],d[1],d[2])&&(d=[d[0]]),Pa(w,ai(d,1),[])})),Vs=Y_||function(){return Xn.Date.now()};function gc(w,d,b){return d=b?u:d,d=w&&d==null?w.length:d,ro(w,v,u,u,u,u,d)}function Lf(w,d){var b;if(typeof d!="function")throw new rs(f);return w=mr(w),function(){return--w>0&&(b=d.apply(this,arguments)),w<=1&&(d=u),b}}var gg=yr((function(w,d,b){var O=1;if(b.length){var F=Ku(b,dr(gg));O|=_}return ro(w,O,d,b,F)})),Uf=yr((function(w,d,b){var O=3;if(b.length){var F=Ku(b,dr(Uf));O|=_}return ro(d,O,w,b,F)}));function lf(w,d,b){var O,F,ie,pe,ye,Re,Pe=0,Fe=!1,Ye=!1,dt=!0;if(typeof w!="function")throw new rs(f);function xt(wt){var It=O,Ft=F;return O=F=u,Pe=wt,pe=w.apply(Ft,It)}function Dt(wt){var It=wt-Re;return Re===u||It>=d||It<0||Ye&&wt-Pe>=ie}function bt(){var wt=Vs();if(Dt(wt))return gt(wt);ye=Iu(bt,(function(It){var Ft=d-(It-Re);return Ye?Ki(Ft,ie-(It-Pe)):Ft})(wt))}function gt(wt){return ye=u,dt&&O?xt(wt):(O=F=u,pe)}function kt(){var wt=Vs(),It=Dt(wt);if(O=arguments,F=this,Re=wt,It){if(ye===u)return(function(Ft){return Pe=Ft,ye=Iu(bt,d),Fe?xt(Ft):pe})(Re);if(Ye)return em(ye),ye=Iu(bt,d),xt(Re)}return ye===u&&(ye=Iu(bt,d)),pe}return d=Yn(d)||0,la(b)&&(Fe=!!b.leading,ie=(Ye="maxWait"in b)?vi(Yn(b.maxWait)||0,d):ie,dt="trailing"in b?!!b.trailing:dt),kt.cancel=function(){ye!==u&&em(ye),Pe=0,O=Re=F=ye=u},kt.flush=function(){return ye===u?pe:gt(Vs())},kt}var _o=yr((function(w,d){return Vh(w,1,d)})),ad=yr((function(w,d,b){return Vh(w,Yn(d)||0,b)}));function Bf(w,d){if(typeof w!="function"||d!=null&&typeof d!="function")throw new rs(f);var b=function(){var O=arguments,F=d?d.apply(this,O):O[0],ie=b.cache;if(ie.has(F))return ie.get(F);var pe=w.apply(this,O);return b.cache=ie.set(F,pe)||ie,pe};return b.cache=new(Bf.Cache||Zi),b}function io(w){if(typeof w!="function")throw new rs(f);return function(){var d=arguments;switch(d.length){case 0:return!w.call(this);case 1:return!w.call(this,d[0]);case 2:return!w.call(this,d[0],d[1]);case 3:return!w.call(this,d[0],d[1],d[2])}return!w.apply(this,d)}}Bf.Cache=Zi;var $o=sf((function(w,d){var b=(d=d.length==1&&Sr(d[0])?Yi(d[0],zo(br())):Yi(ai(d,1),zo(br()))).length;return yr((function(O){for(var F=-1,ie=Ki(O.length,b);++F<ie;)O[F]=d[F].call(this,O[F]);return wl(w,this,O)}))})),_g=yr((function(w,d){var b=Ku(d,dr(_g));return ro(w,_,u,d,b)})),nu=yr((function(w,d){var b=Ku(d,dr(nu));return ro(w,y,u,d,b)})),Fd=Jl((function(w,d){return ro(w,x,u,u,u,d)}));function gl(w,d){return w===d||w!=w&&d!=d}var aa=pc(Wh),ev=pc((function(w,d){return w>=d})),Ff=Jn((function(){return arguments})())?Jn:function(w){return qr(w)&&vr.call(w,"callee")&&!Zp.call(w,"callee")},Sr=tn.isArray,Ar=ma?zo(ma):function(w){return qr(w)&&yi(w)==ce};function _c(w){return w!=null&&Nl(w.length)&&!bs(w)}function Ui(w){return qr(w)&&_c(w)}var oa=Cf||Uu,Ra=zh?zo(zh):function(w){return qr(w)&&yi(w)==J};function Ga(w){if(!qr(w))return!1;var d=yi(w);return d==B||d=="[object DOMException]"||typeof w.message=="string"&&typeof w.name=="string"&&!ru(w)}function bs(w){if(!la(w))return!1;var d=yi(w);return d==$||d==U||d=="[object AsyncFunction]"||d=="[object Proxy]"}function $a(w){return typeof w=="number"&&w==mr(w)}function Nl(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=M}function la(w){var d=typeof w;return w!=null&&(d=="object"||d=="function")}function qr(w){return w!=null&&typeof w=="object"}var ds=op?zo(op):function(w){return qr(w)&&pl(w)==Q};function Aa(w){return typeof w=="number"||qr(w)&&yi(w)==W}function ru(w){if(!qr(w)||yi(w)!=q)return!1;var d=Tu(w);if(d===null)return!0;var b=vr.call(d,"constructor")&&d.constructor;return typeof b=="function"&&b instanceof b&&Ia.call(b)==Q0}var Gi=Wp?zo(Wp):function(w){return qr(w)&&yi(w)==ae},Wa=Yp?zo(Yp):function(w){return qr(w)&&pl(w)==Z};function cf(w){return typeof w=="string"||!Sr(w)&&qr(w)&&yi(w)==K}function Gs(w){return typeof w=="symbol"||qr(w)&&yi(w)==ne}var Os=rh?zo(rh):function(w){return qr(w)&&Nl(w.length)&&!!Dr[yi(w)]},Di=pc(Qc),so=pc((function(w,d){return w<=d}));function vc(w){if(!w)return[];if(_c(w))return cf(w)?wa(w):qs(w);if(Kc&&w[Kc])return(function(b){for(var O,F=[];!(O=b.next()).done;)F.push(O.value);return F})(w[Kc]());var d=pl(w);return(d==Q?jh:d==Z?Zu:su)(w)}function Pl(w){return w?(w=Yn(w))===E||w===-1/0?17976931348623157e292*(w<0?-1:1):w==w?w:0:w===0?w:0}function mr(w){var d=Pl(w),b=d%1;return d==d?b?d-b:d:0}function fr(w){return w?Cl(mr(w),0,N):0}function Yn(w){if(typeof w=="number")return w;if(Gs(w))return k;if(la(w)){var d=typeof w.valueOf=="function"?w.valueOf():w;w=la(d)?d+"":d}if(typeof w!="string")return w===0?w:+w;w=oh(w);var b=Ze.test(w);return b||vt.test(w)?cs(w.slice(2),b?2:8):tt.test(w)?k:+w}function Ya(w){return Il(w,Jr(w))}function Wr(w){return w==null?"":ia(w)}var is=Id((function(w,d){if(Va(d)||_c(d))Il(d,Ji(d),w);else for(var b in d)vr.call(d,b)&&Nc(w,b,d[b])})),Lu=Id((function(w,d){Il(d,Jr(d),w)})),iu=Id((function(w,d,b,O){Il(d,Jr(d),w,O)})),ko=Id((function(w,d,b,O){Il(d,Ji(d),w,O)})),od=Jl(dh),ld=yr((function(w,d){w=_r(w);var b=-1,O=d.length,F=O>2?d[2]:u;for(F&&Go(d[0],d[1],F)&&(O=1);++b<O;)for(var ie=d[b],pe=Jr(ie),ye=-1,Re=pe.length;++ye<Re;){var Pe=pe[ye],Fe=w[Pe];(Fe===u||gl(Fe,sr[Pe])&&!vr.call(w,Pe))&&(w[Pe]=ie[Pe])}return w})),Sp=yr((function(w){return w.push(u,nd),wl(vh,u,w)}));function ca(w,d,b){var O=w==null?u:ti(w,d);return O===u?b:O}function Ep(w,d){return w!=null&&id(w,d,X_)}var _l=qa((function(w,d,b){d!=null&&typeof d.toString!="function"&&(d=Rf.call(d)),w[d]=b}),ud(No)),vl=qa((function(w,d,b){d!=null&&typeof d.toString!="function"&&(d=Rf.call(d)),vr.call(w,d)?w[d].push(b):w[d]=[b]}),br),Fc=yr(ol);function Ji(w){return _c(w)?og(w):Jc(w)}function Jr(w){return _c(w)?og(w,!0):ph(w)}var ao=Id((function(w,d,b){Xh(w,d,b)})),vh=Id((function(w,d,b,O){Xh(w,d,b,O)})),yl=Jl((function(w,d){var b={};if(w==null)return b;var O=!1;d=Yi(d,(function(ie){return ie=rf(ie,w),O||(O=ie.length>1),ie})),Il(w,dl(w),b),O&&(b=Hs(b,7,gp));for(var F=d.length;F--;)kd(b,d[F]);return b})),va=Jl((function(w,d){return w==null?{}:(function(b,O){return Kh(b,O,(function(F,ie){return Ep(b,ie)}))})(w,d)}));function Wo(w,d){if(w==null)return{};var b=Yi(dl(w),(function(O){return[O]}));return d=br(d),Kh(w,b,(function(O,F){return d(O,F[0])}))}var zd=Js(Ji),zf=Js(Jr);function su(w){return w==null?[]:$l(w,Ji(w))}var au=Ou((function(w,d,b){return d=d.toLowerCase(),w+(b?yh(d):d)}));function yh(w){return bi(Wr(w).toLowerCase())}function uf(w){return(w=Wr(w))&&w.replace(ht,eg).replace(rr,"")}var ua=Ou((function(w,d,b){return w+(b?"-":"")+d.toLowerCase()})),jd=Ou((function(w,d,b){return w+(b?" ":"")+d.toLowerCase()})),ou=Qh("toLowerCase"),$s=Ou((function(w,d,b){return w+(b?"_":"")+d.toLowerCase()})),Io=Ou((function(w,d,b){return w+(b?" ":"")+bi(d)})),cd=Ou((function(w,d,b){return w+(b?" ":"")+d.toUpperCase()})),bi=Qh("toUpperCase");function ar(w,d,b){return w=Wr(w),(d=b?u:d)===u?(function(O){return Mr.test(O)})(w)?(function(O){return O.match(ii)||[]})(w):(function(O){return O.match(De)||[]})(w):w.match(d)||[]}var Bi=yr((function(w,d){try{return wl(w,u,d)}catch(b){return Ga(b)?b:new Zn(b)}})),Yo=Jl((function(w,d){return Fo(d,(function(b){b=Nu(b),Na(w,b,gg(w[b],w))})),w}));function ud(w){return function(){return w}}var bh=Zr(),vg=Zr(!0);function No(w){return w}function ps(w){return Nf(typeof w=="function"?w:Hs(w,1))}var Qs=yr((function(w,d){return function(b){return ol(b,w,d)}})),nc=yr((function(w,d){return function(b){return ol(w,b,d)}}));function ks(w,d,b){var O=Ji(d),F=Cs(d,O);b!=null||la(d)&&(F.length||!O.length)||(b=d,d=w,w=this,F=Cs(d,Ji(d)));var ie=!(la(b)&&"chain"in b&&!b.chain),pe=bs(w);return Fo(F,(function(ye){var Re=d[ye];w[ye]=Re,pe&&(w.prototype[ye]=function(){var Pe=this.__chain__;if(ie||Pe){var Fe=w(this.__wrapped__);return(Fe.__actions__=qs(this.__actions__)).push({func:Re,args:arguments,thisArg:w}),Fe.__chain__=Pe,Fe}return Re.apply(w,Xi([this.value()],arguments))})})),w}function ff(){}var hi=ku(Yi),lu=ku(Xp),Sh=ku(Jm);function fd(w){return Pd(w)?sh(Nu(w)):(function(d){return function(b){return ti(b,d)}})(w)}var hm=no(),ya=no(!0);function jf(){return[]}function Uu(){return!1}var j=ed((function(w,d){return w+d}),0),C=e0("ceil"),P=ed((function(w,d){return w/d}),1),H=e0("floor"),X,te=ed((function(w,d){return w*d}),1),ue=e0("round"),Ee=ed((function(w,d){return w-d}),0);return ve.after=function(w,d){if(typeof d!="function")throw new rs(f);return w=mr(w),function(){if(--w<1)return d.apply(this,arguments)}},ve.ary=gc,ve.assign=is,ve.assignIn=Lu,ve.assignInWith=iu,ve.assignWith=ko,ve.at=od,ve.before=Lf,ve.bind=gg,ve.bindAll=Yo,ve.bindKey=Uf,ve.castArray=function(){if(!arguments.length)return[];var w=arguments[0];return Sr(w)?w:[w]},ve.chain=tu,ve.chunk=function(w,d,b){d=(b?Go(w,d,b):d===u)?1:vi(mr(d),0);var O=w==null?0:w.length;if(!O||d<1)return[];for(var F=0,ie=0,pe=tn(kc(O/d));F<O;)pe[ie++]=Da(w,F,F+=d);return pe},ve.compact=function(w){for(var d=-1,b=w==null?0:w.length,O=0,F=[];++d<b;){var ie=w[d];ie&&(F[O++]=ie)}return F},ve.concat=function(){var w=arguments.length;if(!w)return[];for(var d=tn(w-1),b=arguments[0],O=w;O--;)d[O-1]=arguments[O];return Xi(Sr(b)?qs(b):[b],ai(d,1))},ve.cond=function(w){var d=w==null?0:w.length,b=br();return w=d?Yi(w,(function(O){if(typeof O[1]!="function")throw new rs(f);return[b(O[0]),O[1]]})):[],yr((function(O){for(var F=-1;++F<d;){var ie=w[F];if(wl(ie[0],this,O))return wl(ie[1],this,O)}}))},ve.conforms=function(w){return(function(d){var b=Ji(d);return function(O){return Ml(O,d,b)}})(Hs(w,1))},ve.constant=ud,ve.countBy=s_,ve.create=function(w,d){var b=hc(w);return d==null?b:Ro(b,d)},ve.curry=function w(d,b,O){var F=ro(d,8,u,u,u,u,u,b=O?u:b);return F.placeholder=w.placeholder,F},ve.curryRight=function w(d,b,O){var F=ro(d,p,u,u,u,u,u,b=O?u:b);return F.placeholder=w.placeholder,F},ve.debounce=lf,ve.defaults=ld,ve.defaultsDeep=Sp,ve.defer=_o,ve.delay=ad,ve.difference=om,ve.differenceBy=r0,ve.differenceWith=lm,ve.drop=function(w,d,b){var O=w==null?0:w.length;return O?Da(w,(d=b||d===u?1:mr(d))<0?0:d,O):[]},ve.dropRight=function(w,d,b){var O=w==null?0:w.length;return O?Da(w,0,(d=O-(d=b||d===u?1:mr(d)))<0?0:d):[]},ve.dropRightWhile=function(w,d){return w&&w.length?to(w,br(d,3),!0,!0):[]},ve.dropWhile=function(w,d){return w&&w.length?to(w,br(d,3),!0):[]},ve.fill=function(w,d,b,O){var F=w==null?0:w.length;return F?(b&&typeof b!="number"&&Go(w,d,b)&&(b=0,O=F),(function(ie,pe,ye,Re){var Pe=ie.length;for((ye=mr(ye))<0&&(ye=-ye>Pe?0:Pe+ye),(Re=Re===u||Re>Pe?Pe:mr(Re))<0&&(Re+=Pe),Re=ye>Re?0:fr(Re);ye<Re;)ie[ye++]=pe;return ie})(w,d,b,O)):[]},ve.filter=function(w,d){return(Sr(w)?Ac:Ru)(w,br(d,3))},ve.flatMap=function(w,d){return ai(Ms(w,d),1)},ve.flatMapDeep=function(w,d){return ai(Ms(w,d),E)},ve.flatMapDepth=function(w,d,b){return b=b===u?1:mr(b),ai(Ms(w,d),b)},ve.flatten=s0,ve.flattenDeep=function(w){return w!=null&&w.length?ai(w,E):[]},ve.flattenDepth=function(w,d){return w!=null&&w.length?ai(w,d=d===u?1:mr(d)):[]},ve.flip=function(w){return ro(w,512)},ve.flow=bh,ve.flowRight=vg,ve.fromPairs=function(w){for(var d=-1,b=w==null?0:w.length,O={};++d<b;){var F=w[d];O[F[0]]=F[1]}return O},ve.functions=function(w){return w==null?[]:Cs(w,Ji(w))},ve.functionsIn=function(w){return w==null?[]:Cs(w,Jr(w))},ve.groupBy=gh,ve.initial=function(w){return w!=null&&w.length?Da(w,0,-1):[]},ve.intersection=n_,ve.intersectionBy=um,ve.intersectionWith=a0,ve.invert=_l,ve.invertBy=vl,ve.invokeMap=tc,ve.iteratee=ps,ve.keyBy=Du,ve.keys=Ji,ve.keysIn=Jr,ve.map=Ms,ve.mapKeys=function(w,d){var b={};return d=br(d,3),Zs(w,(function(O,F,ie){Na(b,d(O,F,ie),O)})),b},ve.mapValues=function(w,d){var b={};return d=br(d,3),Zs(w,(function(O,F,ie){Na(b,F,d(O,F,ie))})),b},ve.matches=function(w){return Md(Hs(w,1))},ve.matchesProperty=function(w,d){return Co(w,Hs(d,1))},ve.memoize=Bf,ve.merge=ao,ve.mergeWith=vh,ve.method=Qs,ve.methodOf=nc,ve.mixin=ks,ve.negate=io,ve.nthArg=function(w){return w=mr(w),yr((function(d){return Qu(d,w)}))},ve.omit=yl,ve.omitBy=function(w,d){return Wo(w,io(br(d)))},ve.once=function(w){return Lf(2,w)},ve.orderBy=function(w,d,b,O){return w==null?[]:(Sr(d)||(d=d==null?[]:[d]),Sr(b=O?u:b)||(b=b==null?[]:[b]),Pa(w,d,b))},ve.over=hi,ve.overArgs=$o,ve.overEvery=lu,ve.overSome=Sh,ve.partial=_g,ve.partialRight=nu,ve.partition=_h,ve.pick=va,ve.pickBy=Wo,ve.property=fd,ve.propertyOf=function(w){return function(d){return w==null?u:ti(w,d)}},ve.pull=ec,ve.pullAll=hg,ve.pullAllBy=function(w,d,b){return w&&w.length&&d&&d.length?dp(w,d,br(b,2)):w},ve.pullAllWith=function(w,d,b){return w&&w.length&&d&&d.length?dp(w,d,u,b):w},ve.pullAt=dg,ve.range=hm,ve.rangeRight=ya,ve.rearg=Fd,ve.reject=function(w,d){return(Sr(w)?Ac:Ru)(w,io(br(d,3)))},ve.remove=function(w,d){var b=[];if(!w||!w.length)return b;var O=-1,F=[],ie=w.length;for(d=br(d,3);++O<ie;){var pe=w[O];d(pe,O,w)&&(b.push(pe),F.push(O))}return ef(w,F),b},ve.rest=function(w,d){if(typeof w!="function")throw new rs(f);return yr(w,d=d===u?d:mr(d))},ve.reverse=o0,ve.sampleSize=function(w,d,b){return d=(b?Go(w,d,b):d===u)?1:mr(d),(Sr(w)?If:Kl)(w,d)},ve.set=function(w,d,b){return w==null?w:wi(w,d,b)},ve.setWith=function(w,d,b,O){return O=typeof O=="function"?O:u,w==null?w:wi(w,d,b,O)},ve.shuffle=function(w){return(Sr(w)?lg:Ol)(w)},ve.slice=function(w,d,b){var O=w==null?0:w.length;return O?(b&&typeof b!="number"&&Go(w,d,b)?(d=0,b=O):(d=d==null?0:mr(d),b=b===u?O:mr(b)),Da(w,d,b)):[]},ve.sortBy=a_,ve.sortedUniq=function(w){return w&&w.length?Zl(w):[]},ve.sortedUniqBy=function(w,d){return w&&w.length?Zl(w,br(d,2)):[]},ve.split=function(w,d,b){return b&&typeof b!="number"&&Go(w,d,b)&&(d=b=u),(b=b===u?N:b>>>0)?(w=Wr(w))&&(typeof d=="string"||d!=null&&!Gi(d))&&!(d=ia(d))&&lp(w)?Oo(wa(w),0,b):w.split(d,b):[]},ve.spread=function(w,d){if(typeof w!="function")throw new rs(f);return d=d==null?0:vi(mr(d),0),yr((function(b){var O=b[d],F=Oo(b,0,d);return O&&Xi(F,O),wl(w,this,F)}))},ve.tail=function(w){var d=w==null?0:w.length;return d?Da(w,1,d):[]},ve.take=function(w,d,b){return w&&w.length?Da(w,0,(d=b||d===u?1:mr(d))<0?0:d):[]},ve.takeRight=function(w,d,b){var O=w==null?0:w.length;return O?Da(w,(d=O-(d=b||d===u?1:mr(d)))<0?0:d,O):[]},ve.takeRightWhile=function(w,d){return w&&w.length?to(w,br(d,3),!1,!0):[]},ve.takeWhile=function(w,d){return w&&w.length?to(w,br(d,3)):[]},ve.tap=function(w,d){return d(w),w},ve.throttle=function(w,d,b){var O=!0,F=!0;if(typeof w!="function")throw new rs(f);return la(b)&&(O="leading"in b?!!b.leading:O,F="trailing"in b?!!b.trailing:F),lf(w,d,{leading:O,maxWait:d,trailing:F})},ve.thru=sd,ve.toArray=vc,ve.toPairs=zd,ve.toPairsIn=zf,ve.toPath=function(w){return Sr(w)?Yi(w,Nu):Gs(w)?[w]:qs(Ud(Wr(w)))},ve.toPlainObject=Ya,ve.transform=function(w,d,b){var O=Sr(w),F=O||oa(w)||Os(w);if(d=br(d,4),b==null){var ie=w&&w.constructor;b=F?O?new ie:[]:la(w)&&bs(ie)?hc(Tu(w)):{}}return(F?Fo:Zs)(w,(function(pe,ye,Re){return d(b,pe,ye,Re)})),b},ve.unary=function(w){return gc(w,1)},ve.union=l0,ve.unionBy=r_,ve.unionWith=K_,ve.uniq=function(w){return w&&w.length?Lc(w):[]},ve.uniqBy=function(w,d){return w&&w.length?Lc(w,br(d,2)):[]},ve.uniqWith=function(w,d){return d=typeof d=="function"?d:u,w&&w.length?Lc(w,u,d):[]},ve.unset=function(w,d){return w==null||kd(w,d)},ve.unzip=c0,ve.unzipWith=u0,ve.update=function(w,d,b){return w==null?w:Au(w,d,Mo(b))},ve.updateWith=function(w,d,b,O){return O=typeof O=="function"?O:u,w==null?w:Au(w,d,Mo(b),O)},ve.values=su,ve.valuesIn=function(w){return w==null?[]:$l(w,Jr(w))},ve.without=i_,ve.words=ar,ve.wrap=function(w,d){return _g(Mo(d),w)},ve.xor=Z_,ve.xorBy=pg,ve.xorWith=mg,ve.zip=f0,ve.zipObject=function(w,d){return nf(w||[],d||[],Nc)},ve.zipObjectDeep=function(w,d){return nf(w||[],d||[],wi)},ve.zipWith=J_,ve.entries=zd,ve.entriesIn=zf,ve.extend=Lu,ve.extendWith=iu,ks(ve,ve),ve.add=j,ve.attempt=Bi,ve.camelCase=au,ve.capitalize=yh,ve.ceil=C,ve.clamp=function(w,d,b){return b===u&&(b=d,d=u),b!==u&&(b=(b=Yn(b))==b?b:0),d!==u&&(d=(d=Yn(d))==d?d:0),Cl(Yn(w),d,b)},ve.clone=function(w){return Hs(w,4)},ve.cloneDeep=function(w){return Hs(w,5)},ve.cloneDeepWith=function(w,d){return Hs(w,5,d=typeof d=="function"?d:u)},ve.cloneWith=function(w,d){return Hs(w,4,d=typeof d=="function"?d:u)},ve.conformsTo=function(w,d){return d==null||Ml(w,d,Ji(d))},ve.deburr=uf,ve.defaultTo=function(w,d){return w==null||w!=w?d:w},ve.divide=P,ve.endsWith=function(w,d,b){w=Wr(w),d=ia(d);var O=w.length,F=b=b===u?O:Cl(mr(b),0,O);return(b-=d.length)>=0&&w.slice(b,F)==d},ve.eq=gl,ve.escape=function(w){return(w=Wr(w))&&ke.test(w)?w.replace(me,G_):w},ve.escapeRegExp=function(w){return(w=Wr(w))&&Ut.test(w)?w.replace(Ot,"\\$&"):w},ve.every=function(w,d,b){var O=Sr(w)?Xp:Gh;return b&&Go(w,d,b)&&(d=u),O(w,br(d,3))},ve.find=Q_,ve.findIndex=fg,ve.findKey=function(w,d){return uo(w,br(d,3),Zs)},ve.findLast=bp,ve.findLastIndex=i0,ve.findLastKey=function(w,d){return uo(w,br(d,3),Ao)},ve.floor=H,ve.forEach=fm,ve.forEachRight=Bd,ve.forIn=function(w,d){return w==null?w:$h(w,br(d,3),Jr)},ve.forInRight=function(w,d){return w==null?w:Jp(w,br(d,3),Jr)},ve.forOwn=function(w,d){return w&&Zs(w,br(d,3))},ve.forOwnRight=function(w,d){return w&&Ao(w,br(d,3))},ve.get=ca,ve.gt=aa,ve.gte=ev,ve.has=function(w,d){return w!=null&&id(w,d,Yh)},ve.hasIn=Ep,ve.head=cm,ve.identity=No,ve.includes=function(w,d,b,O){w=_c(w)?w:su(w),b=b&&!O?mr(b):0;var F=w.length;return b<0&&(b=vi(F+b,0)),cf(w)?b<=F&&w.indexOf(d,b)>-1:!!F&&Xc(w,d,b)>-1},ve.indexOf=function(w,d,b){var O=w==null?0:w.length;if(!O)return-1;var F=b==null?0:mr(b);return F<0&&(F=vi(O+F,0)),Xc(w,d,F)},ve.inRange=function(w,d,b){return d=Pl(d),b===u?(b=d,d=0):b=Pl(b),(function(O,F,ie){return O>=Ki(F,ie)&&O<vi(F,ie)})(w=Yn(w),d,b)},ve.invoke=Fc,ve.isArguments=Ff,ve.isArray=Sr,ve.isArrayBuffer=Ar,ve.isArrayLike=_c,ve.isArrayLikeObject=Ui,ve.isBoolean=function(w){return w===!0||w===!1||qr(w)&&yi(w)==G},ve.isBuffer=oa,ve.isDate=Ra,ve.isElement=function(w){return qr(w)&&w.nodeType===1&&!ru(w)},ve.isEmpty=function(w){if(w==null)return!0;if(_c(w)&&(Sr(w)||typeof w=="string"||typeof w.splice=="function"||oa(w)||Os(w)||Ff(w)))return!w.length;var d=pl(w);if(d==Q||d==Z)return!w.size;if(Va(w))return!Jc(w).length;for(var b in w)if(vr.call(w,b))return!1;return!0},ve.isEqual=function(w,d){return Pi(w,d)},ve.isEqualWith=function(w,d,b){var O=(b=typeof b=="function"?b:u)?b(w,d):u;return O===u?Pi(w,d,u,b):!!O},ve.isError=Ga,ve.isFinite=function(w){return typeof w=="number"&&Yl(w)},ve.isFunction=bs,ve.isInteger=$a,ve.isLength=Nl,ve.isMap=ds,ve.isMatch=function(w,d){return w===d||Zc(w,d,go(d))},ve.isMatchWith=function(w,d,b){return b=typeof b=="function"?b:u,Zc(w,d,go(d),b)},ve.isNaN=function(w){return Aa(w)&&w!=+w},ve.isNative=function(w){if(nm(w))throw new Zn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return mo(w)},ve.isNil=function(w){return w==null},ve.isNull=function(w){return w===null},ve.isNumber=Aa,ve.isObject=la,ve.isObjectLike=qr,ve.isPlainObject=ru,ve.isRegExp=Gi,ve.isSafeInteger=function(w){return $a(w)&&w>=-9007199254740991&&w<=M},ve.isSet=Wa,ve.isString=cf,ve.isSymbol=Gs,ve.isTypedArray=Os,ve.isUndefined=function(w){return w===u},ve.isWeakMap=function(w){return qr(w)&&pl(w)==le},ve.isWeakSet=function(w){return qr(w)&&yi(w)=="[object WeakSet]"},ve.join=function(w,d){return w==null?"":sg.call(w,d)},ve.kebabCase=ua,ve.last=Pu,ve.lastIndexOf=function(w,d,b){var O=w==null?0:w.length;if(!O)return-1;var F=O;return b!==u&&(F=(F=mr(b))<0?vi(O+F,0):Ki(F,O-1)),d==d?(function(ie,pe,ye){for(var Re=ye+1;Re--;)if(ie[Re]===pe)return Re;return Re})(w,d,F):Yc(w,ga,F,!0)},ve.lowerCase=jd,ve.lowerFirst=ou,ve.lt=Di,ve.lte=so,ve.max=function(w){return w&&w.length?Xl(w,No,Wh):u},ve.maxBy=function(w,d){return w&&w.length?Xl(w,br(d,2),Wh):u},ve.mean=function(w){return xf(w,No)},ve.meanBy=function(w,d){return xf(w,br(d,2))},ve.min=function(w){return w&&w.length?Xl(w,No,Qc):u},ve.minBy=function(w,d){return w&&w.length?Xl(w,br(d,2),Qc):u},ve.stubArray=jf,ve.stubFalse=Uu,ve.stubObject=function(){return{}},ve.stubString=function(){return""},ve.stubTrue=function(){return!0},ve.multiply=te,ve.nth=function(w,d){return w&&w.length?Qu(w,mr(d)):u},ve.noConflict=function(){return Xn._===this&&(Xn._=Wl),this},ve.noop=ff,ve.now=Vs,ve.pad=function(w,d,b){w=Wr(w);var O=(d=mr(d))?ys(w):0;if(!d||O>=d)return w;var F=(d-O)/2;return fl(Ad(F),b)+w+fl(kc(F),b)},ve.padEnd=function(w,d,b){w=Wr(w);var O=(d=mr(d))?ys(w):0;return d&&O<d?w+fl(d-O,b):w},ve.padStart=function(w,d,b){w=Wr(w);var O=(d=mr(d))?ys(w):0;return d&&O<d?fl(d-O,b)+w:w},ve.parseInt=function(w,d,b){return b||d==null?d=0:d&&(d=+d),hh(Wr(w).replace(je,""),d||0)},ve.random=function(w,d,b){if(b&&typeof b!="boolean"&&Go(w,d,b)&&(d=b=u),b===u&&(typeof d=="boolean"?(b=d,d=u):typeof w=="boolean"&&(b=w,w=u)),w===u&&d===u?(w=0,d=1):(w=Pl(w),d===u?(d=w,w=0):d=Pl(d)),w>d){var O=w;w=d,d=O}if(b||w%1||d%1){var F=up();return Ki(w+F*(d-w+Uo("1e-"+((F+"").length-1))),d)}return mh(w,d)},ve.reduce=function(w,d,b){var O=Sr(w)?Cc:Qm,F=arguments.length<3;return O(w,br(d,4),b,F,fs)},ve.reduceRight=function(w,d,b){var O=Sr(w)?Ef:Qm,F=arguments.length<3;return O(w,br(d,4),b,F,dc)},ve.repeat=function(w,d,b){return d=(b?Go(w,d,b):d===u)?1:mr(d),Ur(Wr(w),d)},ve.replace=function(){var w=arguments,d=Wr(w[0]);return w.length<3?d:d.replace(w[1],w[2])},ve.result=function(w,d,b){var O=-1,F=(d=rf(d,w)).length;for(F||(F=1,w=u);++O<F;){var ie=w==null?u:w[Nu(d[O])];ie===u&&(O=F,ie=b),w=bs(ie)?ie.call(w):ie}return w},ve.round=ue,ve.runInContext=rt,ve.sample=function(w){return(Sr(w)?kf:ll)(w)},ve.size=function(w){if(w==null)return 0;if(_c(w))return cf(w)?ys(w):w.length;var d=pl(w);return d==Q||d==Z?w.size:Jc(w).length},ve.snakeCase=$s,ve.some=function(w,d,b){var O=Sr(w)?Jm:Od;return b&&Go(w,d,b)&&(d=u),O(w,br(d,3))},ve.sortedIndex=function(w,d){return mp(w,d)},ve.sortedIndexBy=function(w,d,b){return cl(w,d,br(b,2))},ve.sortedIndexOf=function(w,d){var b=w==null?0:w.length;if(b){var O=mp(w,d);if(O<b&&gl(w[O],d))return O}return-1},ve.sortedLastIndex=function(w,d){return mp(w,d,!0)},ve.sortedLastIndexBy=function(w,d,b){return cl(w,d,br(b,2),!0)},ve.sortedLastIndexOf=function(w,d){if(w!=null&&w.length){var b=mp(w,d,!0)-1;if(gl(w[b],d))return b}return-1},ve.startCase=Io,ve.startsWith=function(w,d,b){return w=Wr(w),b=b==null?0:Cl(mr(b),0,w.length),d=ia(d),w.slice(b,b+d.length)==d},ve.subtract=Ee,ve.sum=function(w){return w&&w.length?Xu(w,No):0},ve.sumBy=function(w,d){return w&&w.length?Xu(w,br(d,2)):0},ve.template=function(w,d,b){var O=ve.templateSettings;b&&Go(w,d,b)&&(d=u),w=Wr(w),d=iu({},d,O,td);var F,ie,pe=iu({},d.imports,O.imports,td),ye=Ji(pe),Re=$l(pe,ye),Pe=0,Fe=d.interpolate||mt,Ye="__p += '",dt=Eo((d.escape||mt).source+"|"+Fe.source+"|"+(Fe===ot?st:mt).source+"|"+(d.evaluate||mt).source+"|$","g"),xt="//# sourceURL="+(vr.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Tr+"]")+`
`;w.replace(dt,(function(gt,kt,wt,It,Ft,Zt){return wt||(wt=It),Ye+=w.slice(Pe,Zt).replace(ft,$_),kt&&(F=!0,Ye+=`' +
__e(`+kt+`) +
'`),Ft&&(ie=!0,Ye+=`';
`+Ft+`;
__p += '`),wt&&(Ye+=`' +
((__t = (`+wt+`)) == null ? '' : __t) +
'`),Pe=Zt+gt.length,gt})),Ye+=`';
`;var Dt=vr.call(d,"variable")&&d.variable;if(Dt){if(Oe.test(Dt))throw new Zn("Invalid `variable` option passed into `_.template`")}else Ye=`with (obj) {
`+Ye+`
}
`;Ye=(ie?Ye.replace(Ue,""):Ye).replace(Ge,"$1").replace(ze,"$1;"),Ye="function("+(Dt||"obj")+`) {
`+(Dt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ye+`return __p
}`;var bt=Bi((function(){return Ci(ye,xt+"return "+Ye).apply(u,Re)}));if(bt.source=Ye,Ga(bt))throw bt;return bt},ve.times=function(w,d){if((w=mr(w))<1||w>M)return[];var b=N,O=Ki(w,N);d=br(d),w-=N;for(var F=Tf(O,d);++b<w;)d(b);return F},ve.toFinite=Pl,ve.toInteger=mr,ve.toLength=fr,ve.toLower=function(w){return Wr(w).toLowerCase()},ve.toNumber=Yn,ve.toSafeInteger=function(w){return w?Cl(mr(w),-9007199254740991,M):w===0?w:0},ve.toString=Wr,ve.toUpper=function(w){return Wr(w).toUpperCase()},ve.trim=function(w,d,b){if((w=Wr(w))&&(b||d===u))return oh(w);if(!w||!(d=ia(d)))return w;var O=wa(w),F=wa(d);return Oo(O,Kp(O,F),sl(O,F)+1).join("")},ve.trimEnd=function(w,d,b){if((w=Wr(w))&&(b||d===u))return w.slice(0,cp(w)+1);if(!w||!(d=ia(d)))return w;var O=wa(w);return Oo(O,0,sl(O,wa(d))+1).join("")},ve.trimStart=function(w,d,b){if((w=Wr(w))&&(b||d===u))return w.replace(je,"");if(!w||!(d=ia(d)))return w;var O=wa(w);return Oo(O,Kp(O,wa(d))).join("")},ve.truncate=function(w,d){var b=30,O="...";if(la(d)){var F="separator"in d?d.separator:F;b="length"in d?mr(d.length):b,O="omission"in d?ia(d.omission):O}var ie=(w=Wr(w)).length;if(lp(w)){var pe=wa(w);ie=pe.length}if(b>=ie)return w;var ye=b-ys(O);if(ye<1)return O;var Re=pe?Oo(pe,0,ye).join(""):w.slice(0,ye);if(F===u)return Re+O;if(pe&&(ye+=Re.length-ye),Gi(F)){if(w.slice(ye).search(F)){var Pe,Fe=Re;for(F.global||(F=Eo(F.source,Wr(Ve.exec(F))+"g")),F.lastIndex=0;Pe=F.exec(Fe);)var Ye=Pe.index;Re=Re.slice(0,Ye===u?ye:Ye)}}else if(w.indexOf(ia(F),ye)!=ye){var dt=Re.lastIndexOf(F);dt>-1&&(Re=Re.slice(0,dt))}return Re+O},ve.unescape=function(w){return(w=Wr(w))&&Se.test(w)?w.replace(Be,ng):w},ve.uniqueId=function(w){var d=++Gr;return Wr(w)+d},ve.upperCase=cd,ve.upperFirst=bi,ve.each=fm,ve.eachRight=Bd,ve.first=cm,ks(ve,(X={},Zs(ve,(function(w,d){vr.call(ve.prototype,d)||(X[d]=w)})),X),{chain:!1}),ve.VERSION="4.17.21",Fo(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(w){ve[w].placeholder=ve})),Fo(["drop","take"],(function(w,d){kn.prototype[w]=function(b){b=b===u?1:vi(mr(b),0);var O=this.__filtered__&&!d?new kn(this):this.clone();return O.__filtered__?O.__takeCount__=Ki(b,O.__takeCount__):O.__views__.push({size:Ki(b,N),type:w+(O.__dir__<0?"Right":"")}),O},kn.prototype[w+"Right"]=function(b){return this.reverse()[w](b).reverse()}})),Fo(["filter","map","takeWhile"],(function(w,d){var b=d+1,O=b==1||b==3;kn.prototype[w]=function(F){var ie=this.clone();return ie.__iteratees__.push({iteratee:br(F,3),type:b}),ie.__filtered__=ie.__filtered__||O,ie}})),Fo(["head","last"],(function(w,d){var b="take"+(d?"Right":"");kn.prototype[w]=function(){return this[b](1).value()[0]}})),Fo(["initial","tail"],(function(w,d){var b="drop"+(d?"":"Right");kn.prototype[w]=function(){return this.__filtered__?new kn(this):this[b](1)}})),kn.prototype.compact=function(){return this.filter(No)},kn.prototype.find=function(w){return this.filter(w).head()},kn.prototype.findLast=function(w){return this.reverse().find(w)},kn.prototype.invokeMap=yr((function(w,d){return typeof w=="function"?new kn(this):this.map((function(b){return ol(b,w,d)}))})),kn.prototype.reject=function(w){return this.filter(io(br(w)))},kn.prototype.slice=function(w,d){w=mr(w);var b=this;return b.__filtered__&&(w>0||d<0)?new kn(b):(w<0?b=b.takeRight(-w):w&&(b=b.drop(w)),d!==u&&(b=(d=mr(d))<0?b.dropRight(-d):b.take(d-w)),b)},kn.prototype.takeRightWhile=function(w){return this.reverse().takeWhile(w).reverse()},kn.prototype.toArray=function(){return this.take(N)},Zs(kn.prototype,(function(w,d){var b=/^(?:filter|find|map|reject)|While$/.test(d),O=/^(?:head|last)$/.test(d),F=ve[O?"take"+(d=="last"?"Right":""):d],ie=O||/^find/.test(d);F&&(ve.prototype[d]=function(){var pe=this.__wrapped__,ye=O?[1]:arguments,Re=pe instanceof kn,Pe=ye[0],Fe=Re||Sr(pe),Ye=function(kt){var wt=F.apply(ve,Xi([kt],ye));return O&&dt?wt[0]:wt};Fe&&b&&typeof Pe=="function"&&Pe.length!=1&&(Re=Fe=!1);var dt=this.__chain__,xt=!!this.__actions__.length,Dt=ie&&!dt,bt=Re&&!xt;if(!ie&&Fe){pe=bt?pe:new kn(this);var gt=w.apply(pe,ye);return gt.__actions__.push({func:sd,args:[Ye],thisArg:u}),new Mi(gt,dt)}return Dt&&bt?w.apply(this,ye):(gt=this.thru(Ye),Dt?O?gt.value()[0]:gt.value():gt)})})),Fo(["pop","push","shift","sort","splice","unshift"],(function(w){var d=Mc[w],b=/^(?:push|sort|unshift)$/.test(w)?"tap":"thru",O=/^(?:pop|shift)$/.test(w);ve.prototype[w]=function(){var F=arguments;if(O&&!this.__chain__){var ie=this.value();return d.apply(Sr(ie)?ie:[],F)}return this[b]((function(pe){return d.apply(Sr(pe)?pe:[],F)}))}})),Zs(kn.prototype,(function(w,d){var b=ve[d];if(b){var O=b.name+"";vr.call(As,O)||(As[O]=[]),As[O].push({name:d,func:b})}})),As[hs(u,2).name]=[{name:"wrapper",func:u}],kn.prototype.clone=function(){var w=new kn(this.__wrapped__);return w.__actions__=qs(this.__actions__),w.__dir__=this.__dir__,w.__filtered__=this.__filtered__,w.__iteratees__=qs(this.__iteratees__),w.__takeCount__=this.__takeCount__,w.__views__=qs(this.__views__),w},kn.prototype.reverse=function(){if(this.__filtered__){var w=new kn(this);w.__dir__=-1,w.__filtered__=!0}else(w=this.clone()).__dir__*=-1;return w},kn.prototype.value=function(){var w=this.__wrapped__.value(),d=this.__dir__,b=Sr(w),O=d<0,F=b?w.length:0,ie=(function(Zt,Gt,$t){for(var dn=-1,Rn=$t.length;++dn<Rn;){var Nn=$t[dn],qn=Nn.size;switch(Nn.type){case"drop":Zt+=qn;break;case"dropRight":Gt-=qn;break;case"take":Gt=Ki(Gt,Zt+qn);break;case"takeRight":Zt=vi(Zt,Gt-qn)}}return{start:Zt,end:Gt}})(0,F,this.__views__),pe=ie.start,ye=ie.end,Re=ye-pe,Pe=O?ye:pe-1,Fe=this.__iteratees__,Ye=Fe.length,dt=0,xt=Ki(Re,this.__takeCount__);if(!b||!O&&F==Re&&xt==Re)return tf(w,this.__actions__);var Dt=[];e:for(;Re--&&dt<xt;){for(var bt=-1,gt=w[Pe+=d];++bt<Ye;){var kt=Fe[bt],wt=kt.iteratee,It=kt.type,Ft=wt(gt);if(It==2)gt=Ft;else if(!Ft){if(It==1)continue e;break e}}Dt[dt++]=gt}return Dt},ve.prototype.at=yp,ve.prototype.chain=function(){return tu(this)},ve.prototype.commit=function(){return new Mi(this.value(),this.__chain__)},ve.prototype.next=function(){this.__values__===u&&(this.__values__=vc(this.value()));var w=this.__index__>=this.__values__.length;return{done:w,value:w?u:this.__values__[this.__index__++]}},ve.prototype.plant=function(w){for(var d,b=this;b instanceof eo;){var O=Bc(b);O.__index__=0,O.__values__=u,d?F.__wrapped__=O:d=O;var F=O;b=b.__wrapped__}return F.__wrapped__=w,d},ve.prototype.reverse=function(){var w=this.__wrapped__;if(w instanceof kn){var d=w;return this.__actions__.length&&(d=new kn(this)),(d=d.reverse()).__actions__.push({func:sd,args:[o0],thisArg:u}),new Mi(d,this.__chain__)}return this.thru(o0)},ve.prototype.toJSON=ve.prototype.valueOf=ve.prototype.value=function(){return tf(this.__wrapped__,this.__actions__)},ve.prototype.first=ve.prototype.head,Kc&&(ve.prototype[Kc]=function(){return this}),ve})();Xn._=qh,(c=(function(){return qh}).call(o,l,o,a))===u||(a.exports=c)}).call(this)},5364:(a,o,l)=>{var c=l(5250),u=l(999)((function(f,h,g){c(f,h,g)}));a.exports=u},9935:a=>{a.exports=function(){return!1}},9884:(a,o,l)=>{var c=l(1791),u=l(7241);a.exports=function(f){return c(f,u(f))}},5602:a=>{var o=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(l){return l.encoding?"rtpmap:%d %s/%s/%s":l.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(l){return l.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(l){return l.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(l){return"extmap:%d"+(l.direction?"/%s":"%v")+(l["encrypt-uri"]?" %s":"%v")+" %s"+(l.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(l){return l.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(l){var c="candidate:%s %d %s %d %s %d typ %s";return c+=l.raddr!=null?" raddr %s rport %d":"%v%v",c+=l.tcptype!=null?" tcptype %s":"%v",l.generation!=null&&(c+=" generation %d"),c+=l["network-id"]!=null?" network-id %d":"%v",c+=l["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(l){var c="ssrc:%d";return l.attribute!=null&&(c+=" %s",l.value!=null&&(c+=":%s")),c}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(l){return l.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(l){return l.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(l){return"imageattr:%s %s %s"+(l.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(l){return"simulcast:%s %s"+(l.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(l){return"ts-refclk:%s"+(l.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(l){var c="mediaclk:";return c+=l.id!=null?"id=%s %s":"%v%s",c+=l.mediaClockValue!=null?"=%s":"",c+=l.rateNumerator!=null?" rate=%s":"",c+=l.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(o).forEach((function(l){o[l].forEach((function(c){c.reg||(c.reg=/(.*)/),c.format||(c.format="%s")}))}))},7363:(a,o,l)=>{var c=l(5020),u=l(3804);o.M9=u,o.qg=c.parse,o.Sl=c.parseParams,c.parseFmtpConfig,c.parsePayloads,c.parseRemoteCandidates,c.parseImageAttributes,c.parseSimulcastStreamList},5020:(a,o,l)=>{var c=function(p){return String(Number(p))===p?Number(p):p},u=function(p,_,y){var v=p.name&&p.names;p.push&&!_[p.push]?_[p.push]=[]:v&&!_[p.name]&&(_[p.name]={});var x=p.push?{}:v?_[p.name]:_;(function(E,M,k,N){if(N&&!k)M[N]=c(E[1]);else for(var I=0;I<k.length;I+=1)E[I+1]!=null&&(M[k[I]]=c(E[I+1]))})(y.match(p.reg),x,p.names,p.name),p.push&&_[p.push].push(x)},f=l(5602),h=RegExp.prototype.test.bind(/^([a-z])=(.*)/);o.parse=function(p){var _={},y=[],v=_;return p.split(/(\r\n|\r|\n)/).filter(h).forEach((function(x){var E=x[0],M=x.slice(2);E==="m"&&(y.push({rtp:[],fmtp:[]}),v=y[y.length-1]);for(var k=0;k<(f[E]||[]).length;k+=1){var N=f[E][k];if(N.reg.test(M))return u(N,v,M)}})),_.media=y,_};var g=function(p,_){var y=_.split(/=(.+)/,2);return y.length===2?p[y[0]]=c(y[1]):y.length===1&&_.length>1&&(p[y[0]]=void 0),p};o.parseParams=function(p){return p.split(/;\s?/).reduce(g,{})},o.parseFmtpConfig=o.parseParams,o.parsePayloads=function(p){return p.toString().split(" ").map(Number)},o.parseRemoteCandidates=function(p){for(var _=[],y=p.split(" ").map(c),v=0;v<y.length;v+=3)_.push({component:y[v],ip:y[v+1],port:y[v+2]});return _},o.parseImageAttributes=function(p){return p.split(" ").map((function(_){return _.substring(1,_.length-1).split(",").reduce(g,{})}))},o.parseSimulcastStreamList=function(p){return p.split(";").map((function(_){return _.split(",").map((function(y){var v,x=!1;return y[0]!=="~"?v=c(y):(v=c(y.substring(1,y.length)),x=!0),{scid:v,paused:x}}))}))}},3804:(a,o,l)=>{var c=l(5602),u=/%[sdv%]/g,f=function(_){var y=1,v=arguments,x=v.length;return _.replace(u,(function(E){if(y>=x)return E;var M=v[y];switch(y+=1,E){case"%%":return"%";case"%s":return String(M);case"%d":return Number(M);case"%v":return""}}))},h=function(_,y,v){var x=[_+"="+(y.format instanceof Function?y.format(y.push?v:v[y.name]):y.format)];if(y.names)for(var E=0;E<y.names.length;E+=1){var M=y.names[E];y.name?x.push(v[y.name][M]):x.push(v[y.names[E]])}else x.push(v[y.name]);return f.apply(null,x)},g=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];a.exports=function(_,y){y=y||{},_.version==null&&(_.version=0),_.name==null&&(_.name=" "),_.media.forEach((function(M){M.payloads==null&&(M.payloads="")}));var v=y.outerOrder||g,x=y.innerOrder||p,E=[];return v.forEach((function(M){c[M].forEach((function(k){k.name in _&&_[k.name]!=null?E.push(h(M,k,_)):k.push in _&&_[k.push]!=null&&_[k.push].forEach((function(N){E.push(h(M,k,N))}))}))})),_.media.forEach((function(M){E.push(h("m",c.m[0],M)),x.forEach((function(k){c[k].forEach((function(N){N.name in M&&M[N.name]!=null?E.push(h(k,N,M)):N.push in M&&M[N.push]!=null&&M[N.push].forEach((function(I){E.push(h(k,N,I))}))}))}))})),E.join(`\r
`)+`\r
`}},7963:a=>{const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(l){return l.trim().split(`
`).map((c=>c.trim()))},o.splitSections=function(l){return l.split(`
m=`).map(((c,u)=>(u>0?"m="+c:c).trim()+`\r
`))},o.getDescription=function(l){const c=o.splitSections(l);return c&&c[0]},o.getMediaSections=function(l){const c=o.splitSections(l);return c.shift(),c},o.matchPrefix=function(l,c){return o.splitLines(l).filter((u=>u.indexOf(c)===0))},o.parseCandidate=function(l){let c;c=l.indexOf("a=candidate:")===0?l.substring(12).split(" "):l.substring(10).split(" ");const u={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let f=8;f<c.length;f+=2)switch(c[f]){case"raddr":u.relatedAddress=c[f+1];break;case"rport":u.relatedPort=parseInt(c[f+1],10);break;case"tcptype":u.tcpType=c[f+1];break;case"ufrag":u.ufrag=c[f+1],u.usernameFragment=c[f+1];break;default:u[c[f]]===void 0&&(u[c[f]]=c[f+1])}return u},o.writeCandidate=function(l){const c=[];c.push(l.foundation);const u=l.component;u==="rtp"?c.push(1):u==="rtcp"?c.push(2):c.push(u),c.push(l.protocol.toUpperCase()),c.push(l.priority),c.push(l.address||l.ip),c.push(l.port);const f=l.type;return c.push("typ"),c.push(f),f!=="host"&&l.relatedAddress&&l.relatedPort&&(c.push("raddr"),c.push(l.relatedAddress),c.push("rport"),c.push(l.relatedPort)),l.tcpType&&l.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(l.tcpType)),(l.usernameFragment||l.ufrag)&&(c.push("ufrag"),c.push(l.usernameFragment||l.ufrag)),"candidate:"+c.join(" ")},o.parseIceOptions=function(l){return l.substring(14).split(" ")},o.parseRtpMap=function(l){let c=l.substring(9).split(" ");const u={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),u.name=c[0],u.clockRate=parseInt(c[1],10),u.channels=c.length===3?parseInt(c[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(l){let c=l.payloadType;l.preferredPayloadType!==void 0&&(c=l.preferredPayloadType);const u=l.channels||l.numChannels||1;return"a=rtpmap:"+c+" "+l.name+"/"+l.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(l){const c=l.substring(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1],attributes:c.slice(2).join(" ")}},o.writeExtmap=function(l){return"a=extmap:"+(l.id||l.preferredId)+(l.direction&&l.direction!=="sendrecv"?"/"+l.direction:"")+" "+l.uri+(l.attributes?" "+l.attributes:"")+`\r
`},o.parseFmtp=function(l){const c={};let u;const f=l.substring(l.indexOf(" ")+1).split(";");for(let h=0;h<f.length;h++)u=f[h].trim().split("="),c[u[0].trim()]=u[1];return c},o.writeFmtp=function(l){let c="",u=l.payloadType;if(l.preferredPayloadType!==void 0&&(u=l.preferredPayloadType),l.parameters&&Object.keys(l.parameters).length){const f=[];Object.keys(l.parameters).forEach((h=>{l.parameters[h]!==void 0?f.push(h+"="+l.parameters[h]):f.push(h)})),c+="a=fmtp:"+u+" "+f.join(";")+`\r
`}return c},o.parseRtcpFb=function(l){const c=l.substring(l.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},o.writeRtcpFb=function(l){let c="",u=l.payloadType;return l.preferredPayloadType!==void 0&&(u=l.preferredPayloadType),l.rtcpFeedback&&l.rtcpFeedback.length&&l.rtcpFeedback.forEach((f=>{c+="a=rtcp-fb:"+u+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`})),c},o.parseSsrcMedia=function(l){const c=l.indexOf(" "),u={ssrc:parseInt(l.substring(7,c),10)},f=l.indexOf(":",c);return f>-1?(u.attribute=l.substring(c+1,f),u.value=l.substring(f+1)):u.attribute=l.substring(c+1),u},o.parseSsrcGroup=function(l){const c=l.substring(13).split(" ");return{semantics:c.shift(),ssrcs:c.map((u=>parseInt(u,10)))}},o.getMid=function(l){const c=o.matchPrefix(l,"a=mid:")[0];if(c)return c.substring(6)},o.parseFingerprint=function(l){const c=l.substring(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},o.getDtlsParameters=function(l,c){return{role:"auto",fingerprints:o.matchPrefix(l+c,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(l,c){let u="a=setup:"+c+`\r
`;return l.fingerprints.forEach((f=>{u+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`})),u},o.parseCryptoLine=function(l){const c=l.substring(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},o.writeCryptoLine=function(l){return"a=crypto:"+l.tag+" "+l.cryptoSuite+" "+(typeof l.keyParams=="object"?o.writeCryptoKeyParams(l.keyParams):l.keyParams)+(l.sessionParams?" "+l.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(l){if(l.indexOf("inline:")!==0)return null;const c=l.substring(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(l){return l.keyMethod+":"+l.keySalt+(l.lifeTime?"|"+l.lifeTime:"")+(l.mkiValue&&l.mkiLength?"|"+l.mkiValue+":"+l.mkiLength:"")},o.getCryptoParameters=function(l,c){return o.matchPrefix(l+c,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(l,c){const u=o.matchPrefix(l+c,"a=ice-ufrag:")[0],f=o.matchPrefix(l+c,"a=ice-pwd:")[0];return u&&f?{usernameFragment:u.substring(12),password:f.substring(10)}:null},o.writeIceParameters=function(l){let c="a=ice-ufrag:"+l.usernameFragment+`\r
a=ice-pwd:`+l.password+`\r
`;return l.iceLite&&(c+=`a=ice-lite\r
`),c},o.parseRtpParameters=function(l){const c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(l)[0].split(" ");c.profile=u[2];for(let h=3;h<u.length;h++){const g=u[h],p=o.matchPrefix(l,"a=rtpmap:"+g+" ")[0];if(p){const _=o.parseRtpMap(p),y=o.matchPrefix(l,"a=fmtp:"+g+" ");switch(_.parameters=y.length?o.parseFmtp(y[0]):{},_.rtcpFeedback=o.matchPrefix(l,"a=rtcp-fb:"+g+" ").map(o.parseRtcpFb),c.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(_.name.toUpperCase())}}}o.matchPrefix(l,"a=extmap:").forEach((h=>{c.headerExtensions.push(o.parseExtmap(h))}));const f=o.matchPrefix(l,"a=rtcp-fb:* ").map(o.parseRtcpFb);return c.codecs.forEach((h=>{f.forEach((g=>{h.rtcpFeedback.find((p=>p.type===g.type&&p.parameter===g.parameter))||h.rtcpFeedback.push(g)}))})),c},o.writeRtpDescription=function(l,c){let u="";u+="m="+l+" ",u+=c.codecs.length>0?"9":"0",u+=" "+(c.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=c.codecs.map((h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType)).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach((h=>{u+=o.writeRtpMap(h),u+=o.writeFmtp(h),u+=o.writeRtcpFb(h)}));let f=0;return c.codecs.forEach((h=>{h.maxptime>f&&(f=h.maxptime)})),f>0&&(u+="a=maxptime:"+f+`\r
`),c.headerExtensions&&c.headerExtensions.forEach((h=>{u+=o.writeExtmap(h)})),u},o.parseRtpEncodingParameters=function(l){const c=[],u=o.parseRtpParameters(l),f=u.fecMechanisms.indexOf("RED")!==-1,h=u.fecMechanisms.indexOf("ULPFEC")!==-1,g=o.matchPrefix(l,"a=ssrc:").map((x=>o.parseSsrcMedia(x))).filter((x=>x.attribute==="cname")),p=g.length>0&&g[0].ssrc;let _;const y=o.matchPrefix(l,"a=ssrc-group:FID").map((x=>x.substring(17).split(" ").map((E=>parseInt(E,10)))));y.length>0&&y[0].length>1&&y[0][0]===p&&(_=y[0][1]),u.codecs.forEach((x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let E={ssrc:p,codecPayloadType:parseInt(x.parameters.apt,10)};p&&_&&(E.rtx={ssrc:_}),c.push(E),f&&(E=JSON.parse(JSON.stringify(E)),E.fec={ssrc:p,mechanism:h?"red+ulpfec":"red"},c.push(E))}})),c.length===0&&p&&c.push({ssrc:p});let v=o.matchPrefix(l,"b=");return v.length&&(v=v[0].indexOf("b=TIAS:")===0?parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?1e3*parseInt(v[0].substring(5),10)*.95-16e3:void 0,c.forEach((x=>{x.maxBitrate=v}))),c},o.parseRtcpParameters=function(l){const c={},u=o.matchPrefix(l,"a=ssrc:").map((g=>o.parseSsrcMedia(g))).filter((g=>g.attribute==="cname"))[0];u&&(c.cname=u.value,c.ssrc=u.ssrc);const f=o.matchPrefix(l,"a=rtcp-rsize");c.reducedSize=f.length>0,c.compound=f.length===0;const h=o.matchPrefix(l,"a=rtcp-mux");return c.mux=h.length>0,c},o.writeRtcpParameters=function(l){let c="";return l.reducedSize&&(c+=`a=rtcp-rsize\r
`),l.mux&&(c+=`a=rtcp-mux\r
`),l.ssrc!==void 0&&l.cname&&(c+="a=ssrc:"+l.ssrc+" cname:"+l.cname+`\r
`),c},o.parseMsid=function(l){let c;const u=o.matchPrefix(l,"a=msid:");if(u.length===1)return c=u[0].substring(7).split(" "),{stream:c[0],track:c[1]};const f=o.matchPrefix(l,"a=ssrc:").map((h=>o.parseSsrcMedia(h))).filter((h=>h.attribute==="msid"));return f.length>0?(c=f[0].value.split(" "),{stream:c[0],track:c[1]}):void 0},o.parseSctpDescription=function(l){const c=o.parseMLine(l),u=o.matchPrefix(l,"a=max-message-size:");let f;u.length>0&&(f=parseInt(u[0].substring(19),10)),isNaN(f)&&(f=65536);const h=o.matchPrefix(l,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substring(12),10),protocol:c.fmt,maxMessageSize:f};const g=o.matchPrefix(l,"a=sctpmap:");if(g.length>0){const p=g[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:f}}},o.writeSctpDescription=function(l,c){let u=[];return u=l.protocol!=="DTLS/SCTP"?["m="+l.kind+" 9 "+l.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:["m="+l.kind+" 9 "+l.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&u.push("a=max-message-size:"+c.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(l,c,u){let f;const h=c!==void 0?c:2;return f=l||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+f+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(l,c){const u=o.splitLines(l);for(let f=0;f<u.length;f++)switch(u[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[f].substring(2)}return c?o.getDirection(c):"sendrecv"},o.getKind=function(l){return o.splitLines(l)[0].split(" ")[0].substring(2)},o.isRejected=function(l){return l.split(" ",2)[1]==="0"},o.parseMLine=function(l){const c=o.splitLines(l)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},o.parseOLine=function(l){const c=o.matchPrefix(l,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},o.isValidSDP=function(l){if(typeof l!="string"||l.length===0)return!1;const c=o.splitLines(l);for(let u=0;u<c.length;u++)if(c[u].length<2||c[u].charAt(1)!=="=")return!1;return!0},a.exports=o},5512:a=>{a.exports=function(o,l,c,u){var f=self||window;try{try{var h;try{h=new f.Blob([o])}catch{(h=new(f.BlobBuilder||f.WebKitBlobBuilder||f.MozBlobBuilder||f.MSBlobBuilder)).append(o),h=h.getBlob()}var g=f.URL||f.webkitURL,p=g.createObjectURL(h),_=new f[l](p,c);return g.revokeObjectURL(p),_}catch{return new f[l]("data:application/javascript,".concat(encodeURIComponent(o)),c)}}catch{if(!u)throw Error("Inline worker is not supported");return new f[l](u,c)}}},8630:(a,o,l)=>{var c;(function(u){(function(){var f=typeof globalThis=="object"?globalThis:typeof l.g=="object"?l.g:typeof self=="object"?self:typeof this=="object"?this:(function(){try{return Function("return this;")()}catch{}})()||(function(){try{return(0,eval)("(function() { return this; })()")}catch{}})(),h=g(u);function g(p,_){return function(y,v){Object.defineProperty(p,y,{configurable:!0,writable:!0,value:v}),_&&_(y,v)}}f.Reflect!==void 0&&(h=g(f.Reflect,h)),(function(p,_){var y=Object.prototype.hasOwnProperty,v=typeof Symbol=="function",x=v&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",E=v&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",M=typeof Object.create=="function",k={__proto__:[]}instanceof Array,N=!M&&!k,I={create:M?function(){return vt(Object.create(null))}:k?function(){return vt({__proto__:null})}:function(){return vt({})},has:N?function(Je,ht){return y.call(Je,ht)}:function(Je,ht){return ht in Je},get:N?function(Je,ht){return y.call(Je,ht)?Je[ht]:void 0}:function(Je,ht){return Je[ht]}},D=Object.getPrototypeOf(Function),V=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:tt(),G=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ze(),J=typeof WeakMap=="function"?WeakMap:nt(),B=v?Symbol.for("@reflect-metadata:registry"):void 0,$=Oe(),U=we($);function Q(Je,ht,mt,ft){if(Ue(mt)){if(!ot(Je))throw new TypeError;if(!ct(ht))throw new TypeError;return de(Je,ht)}if(!ot(Je))throw new TypeError;if(!Be(ht))throw new TypeError;if(!Be(ft)&&!Ue(ft)&&!Ge(ft))throw new TypeError;return Ge(ft)&&(ft=void 0),Me(Je,ht,mt=Ke(mt),ft)}function W(Je,ht){function mt(ft,_t){if(!Be(ft))throw new TypeError;if(!Ue(_t)&&!Vt(_t))throw new TypeError;$e(Je,ht,ft,_t)}return mt}function q(Je,ht,mt,ft){if(!Be(mt))throw new TypeError;return Ue(ft)||(ft=Ke(ft)),$e(Je,ht,mt,ft)}function Y(Je,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),qe(Je,ht,mt)}function ae(Je,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Ne(Je,ht,mt)}function Z(Je,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Ae(Je,ht,mt)}function K(Je,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Xe(Je,ht,mt)}function ne(Je,ht){if(!Be(Je))throw new TypeError;return Ue(ht)||(ht=Ke(ht)),at(Je,ht)}function le(Je,ht){if(!Be(Je))throw new TypeError;return Ue(ht)||(ht=Ke(ht)),pt(Je,ht)}function ce(Je,ht,mt){if(!Be(ht))throw new TypeError;if(Ue(mt)||(mt=Ke(mt)),!Be(ht))throw new TypeError;Ue(mt)||(mt=Ke(mt));var ft=Ve(ht,mt,!1);return!Ue(ft)&&ft.OrdinaryDeleteMetadata(Je,ht,mt)}function de(Je,ht){for(var mt=Je.length-1;mt>=0;--mt){var ft=(0,Je[mt])(ht);if(!Ue(ft)&&!Ge(ft)){if(!ct(ft))throw new TypeError;ht=ft}}return ht}function Me(Je,ht,mt,ft){for(var _t=Je.length-1;_t>=0;--_t){var gn=(0,Je[_t])(ht,mt,ft);if(!Ue(gn)&&!Ge(gn)){if(!Be(gn))throw new TypeError;ft=gn}}return ft}function qe(Je,ht,mt){if(Ne(Je,ht,mt))return!0;var ft=Ie(ht);return!Ge(ft)&&qe(Je,ft,mt)}function Ne(Je,ht,mt){var ft=Ve(ht,mt,!1);return!Ue(ft)&&ke(ft.OrdinaryHasOwnMetadata(Je,ht,mt))}function Ae(Je,ht,mt){if(Ne(Je,ht,mt))return Xe(Je,ht,mt);var ft=Ie(ht);return Ge(ft)?void 0:Ae(Je,ft,mt)}function Xe(Je,ht,mt){var ft=Ve(ht,mt,!1);if(!Ue(ft))return ft.OrdinaryGetOwnMetadata(Je,ht,mt)}function $e(Je,ht,mt,ft){Ve(mt,ft,!0).OrdinaryDefineOwnMetadata(Je,ht,mt,ft)}function at(Je,ht){var mt=pt(Je,ht),ft=Ie(Je);if(ft===null)return mt;var _t=at(ft,ht);if(_t.length<=0)return mt;if(mt.length<=0)return _t;for(var gn=new G,_n=[],Bt=0,Yt=mt;Bt<Yt.length;Bt++){var Mt=Yt[Bt];gn.has(Mt)||(gn.add(Mt),_n.push(Mt))}for(var fn=0,Bn=_t;fn<Bn.length;fn++)Mt=Bn[fn],gn.has(Mt)||(gn.add(Mt),_n.push(Mt));return _n}function pt(Je,ht){var mt=Ve(Je,ht,!1);return mt?mt.OrdinaryOwnMetadataKeys(Je,ht):[]}function oe(Je){if(Je===null)return 1;switch(typeof Je){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Je===null?1:6;default:return 6}}function Ue(Je){return Je===void 0}function Ge(Je){return Je===null}function ze(Je){return typeof Je=="symbol"}function Be(Je){return typeof Je=="object"?Je!==null:typeof Je=="function"}function me(Je,ht){switch(oe(Je)){case 0:case 1:case 2:case 3:case 4:case 5:return Je}var mt="string",ft=Ut(Je,x);if(ft!==void 0){var _t=ft.call(Je,mt);if(Be(_t))throw new TypeError;return _t}return Se(Je)}function Se(Je,ht){var mt,ft;{var _t=Je.toString;if(lt(_t)&&!Be(ft=_t.call(Je))||lt(mt=Je.valueOf)&&!Be(ft=mt.call(Je)))return ft}throw new TypeError}function ke(Je){return!!Je}function be(Je){return""+Je}function Ke(Je){var ht=me(Je);return ze(ht)?ht:be(ht)}function ot(Je){return Array.isArray?Array.isArray(Je):Je instanceof Object?Je instanceof Array:Object.prototype.toString.call(Je)==="[object Array]"}function lt(Je){return typeof Je=="function"}function ct(Je){return typeof Je=="function"}function Vt(Je){switch(oe(Je)){case 3:case 4:return!0;default:return!1}}function Ot(Je,ht){return Je===ht||Je!=Je&&ht!=ht}function Ut(Je,ht){var mt=Je[ht];if(mt!=null){if(!lt(mt))throw new TypeError;return mt}}function je(Je){var ht=Ut(Je,E);if(!lt(ht))throw new TypeError;var mt=ht.call(Je);if(!Be(mt))throw new TypeError;return mt}function ge(Je){return Je.value}function se(Je){var ht=Je.next();return!ht.done&&ht}function _e(Je){var ht=Je.return;ht&&ht.call(Je)}function Ie(Je){var ht=Object.getPrototypeOf(Je);if(typeof Je!="function"||Je===D||ht!==D)return ht;var mt=Je.prototype,ft=mt&&Object.getPrototypeOf(mt);if(ft==null||ft===Object.prototype)return ht;var _t=ft.constructor;return typeof _t!="function"||_t===Je?ht:_t}function De(){var Je,ht,mt,ft;Ue(B)||_.Reflect===void 0||B in _.Reflect||typeof _.Reflect.defineMetadata!="function"||(Je=st(_.Reflect));var _t=new J,gn={registerProvider:_n,getProvider:Yt,setProvider:fn};return gn;function _n(Bn){if(!Object.isExtensible(gn))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Je===Bn:break;case Ue(ht):ht=Bn;break;case ht===Bn:break;case Ue(mt):mt=Bn;break;case mt===Bn:break;default:ft===void 0&&(ft=new G),ft.add(Bn)}}function Bt(Bn,cn){if(!Ue(ht)){if(ht.isProviderFor(Bn,cn))return ht;if(!Ue(mt)){if(mt.isProviderFor(Bn,cn))return ht;if(!Ue(ft))for(var In=je(ft);;){var Wn=se(In);if(!Wn)return;var er=ge(Wn);if(er.isProviderFor(Bn,cn))return _e(In),er}}}if(!Ue(Je)&&Je.isProviderFor(Bn,cn))return Je}function Yt(Bn,cn){var In,Wn=_t.get(Bn);return Ue(Wn)||(In=Wn.get(cn)),Ue(In)&&(Ue(In=Bt(Bn,cn))||(Ue(Wn)&&(Wn=new V,_t.set(Bn,Wn)),Wn.set(cn,In))),In}function Mt(Bn){if(Ue(Bn))throw new TypeError;return ht===Bn||mt===Bn||!Ue(ft)&&ft.has(Bn)}function fn(Bn,cn,In){if(!Mt(In))throw new Error("Metadata provider not registered.");var Wn=Yt(Bn,cn);if(Wn!==In){if(!Ue(Wn))return!1;var er=_t.get(Bn);Ue(er)&&(er=new V,_t.set(Bn,er)),er.set(cn,In)}return!0}}function Oe(){var Je;return!Ue(B)&&Be(_.Reflect)&&Object.isExtensible(_.Reflect)&&(Je=_.Reflect[B]),Ue(Je)&&(Je=De()),!Ue(B)&&Be(_.Reflect)&&Object.isExtensible(_.Reflect)&&Object.defineProperty(_.Reflect,B,{enumerable:!1,configurable:!1,writable:!1,value:Je}),Je}function we(Je){var ht=new J,mt={isProviderFor:function(Mt,fn){var Bn=ht.get(Mt);return!Ue(Bn)&&Bn.has(fn)},OrdinaryDefineOwnMetadata:_n,OrdinaryHasOwnMetadata:_t,OrdinaryGetOwnMetadata:gn,OrdinaryOwnMetadataKeys:Bt,OrdinaryDeleteMetadata:Yt};return $.registerProvider(mt),mt;function ft(Mt,fn,Bn){var cn=ht.get(Mt),In=!1;if(Ue(cn)){if(!Bn)return;cn=new V,ht.set(Mt,cn),In=!0}var Wn=cn.get(fn);if(Ue(Wn)){if(!Bn)return;if(Wn=new V,cn.set(fn,Wn),!Je.setProvider(Mt,fn,mt))throw cn.delete(fn),In&&ht.delete(Mt),new Error("Wrong provider for target.")}return Wn}function _t(Mt,fn,Bn){var cn=ft(fn,Bn,!1);return!Ue(cn)&&ke(cn.has(Mt))}function gn(Mt,fn,Bn){var cn=ft(fn,Bn,!1);if(!Ue(cn))return cn.get(Mt)}function _n(Mt,fn,Bn,cn){ft(Bn,cn,!0).set(Mt,fn)}function Bt(Mt,fn){var Bn=[],cn=ft(Mt,fn,!1);if(Ue(cn))return Bn;for(var In=je(cn.keys()),Wn=0;;){var er=se(In);if(!er)return Bn.length=Wn,Bn;var os=ge(er);try{Bn[Wn]=os}catch(gi){try{_e(In)}finally{throw gi}}Wn++}}function Yt(Mt,fn,Bn){var cn=ft(fn,Bn,!1);if(Ue(cn)||!cn.delete(Mt))return!1;if(cn.size===0){var In=ht.get(fn);Ue(In)||(In.delete(Bn),In.size===0&&ht.delete(In))}return!0}}function st(Je){var ht=Je.defineMetadata,mt=Je.hasOwnMetadata,ft=Je.getOwnMetadata,_t=Je.getOwnMetadataKeys,gn=Je.deleteMetadata,_n=new J;return{isProviderFor:function(Bt,Yt){var Mt=_n.get(Bt);return!(Ue(Mt)||!Mt.has(Yt))||!!_t(Bt,Yt).length&&(Ue(Mt)&&(Mt=new G,_n.set(Bt,Mt)),Mt.add(Yt),!0)},OrdinaryDefineOwnMetadata:ht,OrdinaryHasOwnMetadata:mt,OrdinaryGetOwnMetadata:ft,OrdinaryOwnMetadataKeys:_t,OrdinaryDeleteMetadata:gn}}function Ve(Je,ht,mt){var ft=$.getProvider(Je,ht);if(!Ue(ft))return ft;if(mt){if($.setProvider(Je,ht,U))return U;throw new Error("Illegal state.")}}function tt(){var Je={},ht=[],mt=(function(){function _n(Bt,Yt,Mt){this._index=0,this._keys=Bt,this._values=Yt,this._selector=Mt}return _n.prototype["@@iterator"]=function(){return this},_n.prototype[E]=function(){return this},_n.prototype.next=function(){var Bt=this._index;if(Bt>=0&&Bt<this._keys.length){var Yt=this._selector(this._keys[Bt],this._values[Bt]);return Bt+1>=this._keys.length?(this._index=-1,this._keys=ht,this._values=ht):this._index++,{value:Yt,done:!1}}return{value:void 0,done:!0}},_n.prototype.throw=function(Bt){throw this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),Bt},_n.prototype.return=function(Bt){return this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),{value:Bt,done:!0}},_n})();return(function(){function _n(){this._keys=[],this._values=[],this._cacheKey=Je,this._cacheIndex=-2}return Object.defineProperty(_n.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_n.prototype.has=function(Bt){return this._find(Bt,!1)>=0},_n.prototype.get=function(Bt){var Yt=this._find(Bt,!1);return Yt>=0?this._values[Yt]:void 0},_n.prototype.set=function(Bt,Yt){var Mt=this._find(Bt,!0);return this._values[Mt]=Yt,this},_n.prototype.delete=function(Bt){var Yt=this._find(Bt,!1);if(Yt>=0){for(var Mt=this._keys.length,fn=Yt+1;fn<Mt;fn++)this._keys[fn-1]=this._keys[fn],this._values[fn-1]=this._values[fn];return this._keys.length--,this._values.length--,Ot(Bt,this._cacheKey)&&(this._cacheKey=Je,this._cacheIndex=-2),!0}return!1},_n.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Je,this._cacheIndex=-2},_n.prototype.keys=function(){return new mt(this._keys,this._values,ft)},_n.prototype.values=function(){return new mt(this._keys,this._values,_t)},_n.prototype.entries=function(){return new mt(this._keys,this._values,gn)},_n.prototype["@@iterator"]=function(){return this.entries()},_n.prototype[E]=function(){return this.entries()},_n.prototype._find=function(Bt,Yt){if(!Ot(this._cacheKey,Bt)){this._cacheIndex=-1;for(var Mt=0;Mt<this._keys.length;Mt++)if(Ot(this._keys[Mt],Bt)){this._cacheIndex=Mt;break}}return this._cacheIndex<0&&Yt&&(this._cacheIndex=this._keys.length,this._keys.push(Bt),this._values.push(void 0)),this._cacheIndex},_n})();function ft(_n,Bt){return _n}function _t(_n,Bt){return Bt}function gn(_n,Bt){return[_n,Bt]}}function Ze(){return(function(){function Je(){this._map=new V}return Object.defineProperty(Je.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Je.prototype.has=function(ht){return this._map.has(ht)},Je.prototype.add=function(ht){return this._map.set(ht,ht),this},Je.prototype.delete=function(ht){return this._map.delete(ht)},Je.prototype.clear=function(){this._map.clear()},Je.prototype.keys=function(){return this._map.keys()},Je.prototype.values=function(){return this._map.keys()},Je.prototype.entries=function(){return this._map.entries()},Je.prototype["@@iterator"]=function(){return this.keys()},Je.prototype[E]=function(){return this.keys()},Je})()}function nt(){var Je=16,ht=I.create(),mt=ft();return(function(){function Yt(){this._key=ft()}return Yt.prototype.has=function(Mt){var fn=_t(Mt,!1);return fn!==void 0&&I.has(fn,this._key)},Yt.prototype.get=function(Mt){var fn=_t(Mt,!1);return fn!==void 0?I.get(fn,this._key):void 0},Yt.prototype.set=function(Mt,fn){return _t(Mt,!0)[this._key]=fn,this},Yt.prototype.delete=function(Mt){var fn=_t(Mt,!1);return fn!==void 0&&delete fn[this._key]},Yt.prototype.clear=function(){this._key=ft()},Yt})();function ft(){var Yt;do Yt="@@WeakMap@@"+Bt();while(I.has(ht,Yt));return ht[Yt]=!0,Yt}function _t(Yt,Mt){if(!y.call(Yt,mt)){if(!Mt)return;Object.defineProperty(Yt,mt,{value:I.create()})}return Yt[mt]}function gn(Yt,Mt){for(var fn=0;fn<Mt;++fn)Yt[fn]=255*Math.random()|0;return Yt}function _n(Yt){if(typeof Uint8Array=="function"){var Mt=new Uint8Array(Yt);return typeof crypto<"u"?crypto.getRandomValues(Mt):typeof msCrypto<"u"?msCrypto.getRandomValues(Mt):gn(Mt,Yt),Mt}return gn(new Array(Yt),Yt)}function Bt(){var Yt=_n(Je);Yt[6]=79&Yt[6]|64,Yt[8]=191&Yt[8]|128;for(var Mt="",fn=0;fn<Je;++fn){var Bn=Yt[fn];fn!==4&&fn!==6&&fn!==8||(Mt+="-"),Bn<16&&(Mt+="0"),Mt+=Bn.toString(16).toLowerCase()}return Mt}}function vt(Je){return Je.__=void 0,delete Je.__,Je}p("decorate",Q),p("metadata",W),p("defineMetadata",q),p("hasMetadata",Y),p("hasOwnMetadata",ae),p("getMetadata",Z),p("getOwnMetadata",K),p("getMetadataKeys",ne),p("getOwnMetadataKeys",le),p("deleteMetadata",ce)})(h,f),f.Reflect===void 0&&(f.Reflect=u)})()})(c||(c={}))}},r={};function i(a){var o=r[a];if(o!==void 0)return o.exports;var l=r[a]={id:a,loaded:!1,exports:{}};return t[a].call(l.exports,l,l.exports,i),l.loaded=!0,l.exports}i.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return i.d(o,{a:o}),o},i.d=(a,o)=>{for(var l in o)i.o(o,l)&&!i.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})},i.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),i.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),i.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var s={};return(()=>{i.r(s),i.d(s,{BASIC_FULL_HD_LANDSCAPE:()=>Dr,BASIC_FULL_HD_PORTRAIT:()=>Cn,BASIC_LANDSCAPE:()=>si,BASIC_PORTRAIT:()=>Tr,BroadcastClientError:()=>we,BroadcastClientEvents:()=>_r,ConnectionState:()=>sr,Errors:()=>u,InitialLayerPreference:()=>mh,JitterBufferMinDelay:()=>ll,LOG_LEVEL:()=>se,LocalStageStream:()=>zf,LocalStageStreamEvents:()=>Jr,LogLevels:()=>se,RemoteStageStream:()=>ou,RemoteStageStreamEvents:()=>Fc,SIMULCAST_DUPLICATE_LAYERS_CONFIGURED:()=>vp,SIMULCAST_LAYER_CONFIGURATION_CONFLICT:()=>Go,SIMULCAST_LAYER_INPUT_FRAMERATE_INSUFFICIENT:()=>nm,SIMULCAST_LAYER_INPUT_RESOLUTION_INSUFFICIENT:()=>cg,SIMULCAST_LAYER_INVALID_TYPE:()=>go,SIMULCAST_LAYER_ORIENTATION_MISMATCH:()=>Pd,SIMULCAST_MAX_LAYERS_EXCEEDED:()=>Ql,SIMULCAST_MAX_LAYER_BITRATE_EXCEEDED:()=>Vo,SIMULCAST_MAX_LAYER_DIMENSIONS_EXCEEDED:()=>of,SIMULCAST_MAX_LAYER_FRAMERATE_EXCEEDED:()=>id,SIMULCAST_MIN_LAYER_BITRATE_EXCEEDED:()=>pl,SIMULCAST_MIN_LAYER_DIMENSIONS_EXCEEDED:()=>Ua,SIMULCAST_MIN_LAYER_FRAMERATE_EXCEEDED:()=>t0,SIMULCAST_UNSUPPORTED:()=>rd,STAGE_MAX_AUDIO_BITRATE_KBPS:()=>Oo,STAGE_MAX_AUDIO_BITRATE_KBPS_DEFAULT:()=>em,STAGE_MAX_BITRATE:()=>to,STAGE_MAX_FRAMERATE:()=>Uc,STAGE_MAX_RESOLUTION:()=>Cu,STAGE_MIN_AUDIO_BITRATE_KBPS:()=>sf,STAGE_MIN_BITRATE:()=>Au,STAGE_MIN_FRAMERATE:()=>tf,STAGE_MIN_RESOLUTION:()=>nf,STANDARD_LANDSCAPE:()=>jr,STANDARD_PORTRAIT:()=>Uo,SimulcastLayerPresets:()=>Ha,Stage:()=>ya,StageConnectionState:()=>Ms,StageErrorCategory:()=>fr,StageErrorCode:()=>Yn,StageEvents:()=>hi,StageLeftReason:()=>jf,StageParticipantPublishState:()=>va,StageParticipantSubscribeState:()=>Wo,StageStream:()=>vh,StageStreamLayerSelectedReason:()=>Ji,StreamType:()=>Gr,SubscribeType:()=>so,__version:()=>up,create:()=>hh,default:()=>Uu,isSupported:()=>ge});var a={};i.r(a),i.d(a,{fixNegotiationNeeded:()=>ae,shimAddTrackRemoveTrack:()=>q,shimAddTrackRemoveTrackWithNative:()=>W,shimGetDisplayMedia:()=>G,shimGetSendersWithDtmf:()=>$,shimGetStats:()=>U,shimGetUserMedia:()=>V,shimMediaStream:()=>J,shimOnTrack:()=>B,shimPeerConnection:()=>Y,shimSenderReceiverGetStats:()=>Q});var o={};i.r(o),i.d(o,{shimAddTransceiver:()=>Ne,shimCreateAnswer:()=>$e,shimCreateOffer:()=>Xe,shimGetDisplayMedia:()=>K,shimGetParameters:()=>Ae,shimGetUserMedia:()=>Z,shimOnTrack:()=>ne,shimPeerConnection:()=>le,shimRTCDataChannel:()=>qe,shimReceiverGetStats:()=>de,shimRemoveStream:()=>Me,shimSenderGetStats:()=>ce});var l={};i.r(l),i.d(l,{shimAudioContext:()=>Se,shimCallbacksAPI:()=>oe,shimConstraints:()=>Ge,shimCreateOfferLegacy:()=>me,shimGetUserMedia:()=>Ue,shimLocalStreamsAPI:()=>at,shimRTCIceServerUrls:()=>ze,shimRemoteStreamsAPI:()=>pt,shimTrackEventTransceiver:()=>Be});var c={};i.r(c),i.d(c,{removeExtmapAllowMixed:()=>Ot,shimAddIceCandidateNullOrEmpty:()=>Ut,shimConnectionState:()=>Vt,shimMaxMessageSize:()=>lt,shimParameterlessSetLocalDescription:()=>je,shimRTCIceCandidate:()=>Ke,shimRTCIceCandidateRelayProtocol:()=>ot,shimSendThrowTypeError:()=>ct});var u={};i.r(u),i.d(u,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Je,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>vt,ADD_DEVICE_CONSTRAINTS_ERROR:()=>ft,ADD_DEVICE_DEVICE_ERROR:()=>Ze,ADD_DEVICE_NAME_EXISTS_ERROR:()=>nt,ADD_DEVICE_NAME_MISSING_ERROR:()=>ht,ADD_DEVICE_UNSUPPORTED:()=>mt,BROADCAST_CONFIGURATION_ERROR:()=>Wn,BROADCAST_ERROR:()=>st,CAMERA_ERROR:()=>Ve,CLIENT_INVALID_ERROR:()=>_i,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>Mt,FAILED_TO_ADD_IMAGE_ERROR:()=>fn,INGEST_ENDPOINT_TYPE_ERROR:()=>os,INGEST_ENDPOINT_URL_ERROR:()=>gi,INPUT_ERROR:()=>tt,INVALID_STREAM_KEY:()=>In,LOGGER_TYPE_ERROR:()=>Fs,LOG_LEVEL_TYPE_ERROR:()=>Ni,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>Rs,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>ra,PEER_CONNECTION_ERROR:()=>cn,PEER_SETUP_ERROR:()=>Bn,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>_t,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>gn,STAGE_TOKEN_TYPE_ERROR:()=>We,STAGE_WHIP_OVERRIDE_ERROR:()=>At,STREAM_CONFIGURATION_ERROR:()=>er,STREAM_KEY_INVALID_CHAR_ERROR:()=>ls,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Bt,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>_n,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>Yt});var f={};i.r(f),i.d(f,{BASIC_FULL_HD_LANDSCAPE:()=>Dr,BASIC_FULL_HD_PORTRAIT:()=>Cn,BASIC_LANDSCAPE:()=>si,BASIC_PORTRAIT:()=>Tr,BroadcastClientError:()=>we,BroadcastClientEvents:()=>_r,ConnectionState:()=>sr,Errors:()=>u,LOG_LEVEL:()=>se,LogLevels:()=>se,STANDARD_LANDSCAPE:()=>jr,STANDARD_PORTRAIT:()=>Uo,__version:()=>up,create:()=>hh,isSupported:()=>ge});let h=!0,g=!0;function p(j,C,P){const H=j.match(C);return H&&H.length>=P&&parseInt(H[P],10)}function _(j,C,P){if(!j.RTCPeerConnection)return;const H=j.RTCPeerConnection.prototype,X=H.addEventListener;H.addEventListener=function(ue,Ee){if(ue!==C)return X.apply(this,arguments);const w=d=>{const b=P(d);b&&(Ee.handleEvent?Ee.handleEvent(b):Ee(b))};return this._eventMap=this._eventMap||{},this._eventMap[C]||(this._eventMap[C]=new Map),this._eventMap[C].set(Ee,w),X.apply(this,[ue,w])};const te=H.removeEventListener;H.removeEventListener=function(ue,Ee){if(ue!==C||!this._eventMap||!this._eventMap[C])return te.apply(this,arguments);if(!this._eventMap[C].has(Ee))return te.apply(this,arguments);const w=this._eventMap[C].get(Ee);return this._eventMap[C].delete(Ee),this._eventMap[C].size===0&&delete this._eventMap[C],Object.keys(this._eventMap).length===0&&delete this._eventMap,te.apply(this,[ue,w])},Object.defineProperty(H,"on"+C,{get(){return this["_on"+C]},set(ue){this["_on"+C]&&(this.removeEventListener(C,this["_on"+C]),delete this["_on"+C]),ue&&this.addEventListener(C,this["_on"+C]=ue)},enumerable:!0,configurable:!0})}function y(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(h=j,j?"adapter.js logging disabled":"adapter.js logging enabled")}function v(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(g=!j,"adapter.js deprecation warnings "+(j?"disabled":"enabled"))}function x(){if(typeof window=="object"){if(h)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function E(j,C){g&&console.warn(j+" is deprecated, please use "+C+" instead.")}function M(j){return Object.prototype.toString.call(j)==="[object Object]"}function k(j){return M(j)?Object.keys(j).reduce((function(C,P){const H=M(j[P]),X=H?k(j[P]):j[P],te=H&&!Object.keys(X).length;return X===void 0||te?C:Object.assign(C,{[P]:X})}),{}):j}function N(j,C,P){C&&!P.has(C.id)&&(P.set(C.id,C),Object.keys(C).forEach((H=>{H.endsWith("Id")?N(j,j.get(C[H]),P):H.endsWith("Ids")&&C[H].forEach((X=>{N(j,j.get(X),P)}))})))}function I(j,C,P){const H=P?"outbound-rtp":"inbound-rtp",X=new Map;if(C===null)return X;const te=[];return j.forEach((ue=>{ue.type==="track"&&ue.trackIdentifier===C.id&&te.push(ue)})),te.forEach((ue=>{j.forEach((Ee=>{Ee.type===H&&Ee.trackId===ue.id&&N(j,Ee,X)}))})),X}const D=x;function V(j,C){const P=j&&j.navigator;if(!P.mediaDevices)return;const H=function(ue){if(typeof ue!="object"||ue.mandatory||ue.optional)return ue;const Ee={};return Object.keys(ue).forEach((w=>{if(w==="require"||w==="advanced"||w==="mediaSource")return;const d=typeof ue[w]=="object"?ue[w]:{ideal:ue[w]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const b=function(O,F){return O?O+F.charAt(0).toUpperCase()+F.slice(1):F==="deviceId"?"sourceId":F};if(d.ideal!==void 0){Ee.optional=Ee.optional||[];let O={};typeof d.ideal=="number"?(O[b("min",w)]=d.ideal,Ee.optional.push(O),O={},O[b("max",w)]=d.ideal,Ee.optional.push(O)):(O[b("",w)]=d.ideal,Ee.optional.push(O))}d.exact!==void 0&&typeof d.exact!="number"?(Ee.mandatory=Ee.mandatory||{},Ee.mandatory[b("",w)]=d.exact):["min","max"].forEach((O=>{d[O]!==void 0&&(Ee.mandatory=Ee.mandatory||{},Ee.mandatory[b(O,w)]=d[O])}))})),ue.advanced&&(Ee.optional=(Ee.optional||[]).concat(ue.advanced)),Ee},X=function(ue,Ee){if(C.version>=61)return Ee(ue);if((ue=JSON.parse(JSON.stringify(ue)))&&typeof ue.audio=="object"){const w=function(d,b,O){b in d&&!(O in d)&&(d[O]=d[b],delete d[b])};w((ue=JSON.parse(JSON.stringify(ue))).audio,"autoGainControl","googAutoGainControl"),w(ue.audio,"noiseSuppression","googNoiseSuppression"),ue.audio=H(ue.audio)}if(ue&&typeof ue.video=="object"){let w=ue.video.facingMode;w=w&&(typeof w=="object"?w:{ideal:w});const d=C.version<66;if(w&&(w.exact==="user"||w.exact==="environment"||w.ideal==="user"||w.ideal==="environment")&&(!P.mediaDevices.getSupportedConstraints||!P.mediaDevices.getSupportedConstraints().facingMode||d)){let b;if(delete ue.video.facingMode,w.exact==="environment"||w.ideal==="environment"?b=["back","rear"]:w.exact!=="user"&&w.ideal!=="user"||(b=["front"]),b)return P.mediaDevices.enumerateDevices().then((O=>{let F=(O=O.filter((ie=>ie.kind==="videoinput"))).find((ie=>b.some((pe=>ie.label.toLowerCase().includes(pe)))));return!F&&O.length&&b.includes("back")&&(F=O[O.length-1]),F&&(ue.video.deviceId=w.exact?{exact:F.deviceId}:{ideal:F.deviceId}),ue.video=H(ue.video),D("chrome: "+JSON.stringify(ue)),Ee(ue)}))}ue.video=H(ue.video)}return D("chrome: "+JSON.stringify(ue)),Ee(ue)},te=function(ue){return C.version>=64?ue:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[ue.name]||ue.name,message:ue.message,constraint:ue.constraint||ue.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(P.getUserMedia=(function(ue,Ee,w){X(ue,(d=>{P.webkitGetUserMedia(d,Ee,(b=>{w&&w(te(b))}))}))}).bind(P),P.mediaDevices.getUserMedia){const ue=P.mediaDevices.getUserMedia.bind(P.mediaDevices);P.mediaDevices.getUserMedia=function(Ee){return X(Ee,(w=>ue(w).then((d=>{if(w.audio&&!d.getAudioTracks().length||w.video&&!d.getVideoTracks().length)throw d.getTracks().forEach((b=>{b.stop()})),new DOMException("","NotFoundError");return d}),(d=>Promise.reject(te(d))))))}}}function G(j,C){j.navigator.mediaDevices&&"getDisplayMedia"in j.navigator.mediaDevices||j.navigator.mediaDevices&&(typeof C=="function"?j.navigator.mediaDevices.getDisplayMedia=function(P){return C(P).then((H=>{const X=P.video&&P.video.width,te=P.video&&P.video.height,ue=P.video&&P.video.frameRate;return P.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:H,maxFrameRate:ue||3}},X&&(P.video.mandatory.maxWidth=X),te&&(P.video.mandatory.maxHeight=te),j.navigator.mediaDevices.getUserMedia(P)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function J(j){j.MediaStream=j.MediaStream||j.webkitMediaStream}function B(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("ontrack"in j.RTCPeerConnection.prototype)){Object.defineProperty(j.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(P){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=P)},enumerable:!0,configurable:!0});const C=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=P=>{P.stream.addEventListener("addtrack",(H=>{let X;X=j.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((ue=>ue.track&&ue.track.id===H.track.id)):{track:H.track};const te=new Event("track");te.track=H.track,te.receiver=X,te.transceiver={receiver:X},te.streams=[P.stream],this.dispatchEvent(te)})),P.stream.getTracks().forEach((H=>{let X;X=j.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((ue=>ue.track&&ue.track.id===H.id)):{track:H};const te=new Event("track");te.track=H,te.receiver=X,te.transceiver={receiver:X},te.streams=[P.stream],this.dispatchEvent(te)}))},this.addEventListener("addstream",this._ontrackpoly)),C.apply(this,arguments)}}else _(j,"track",(C=>(C.transceiver||Object.defineProperty(C,"transceiver",{value:{receiver:C.receiver}}),C)))}function $(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("getSenders"in j.RTCPeerConnection.prototype)&&"createDTMFSender"in j.RTCPeerConnection.prototype){const C=function(X,te){return{track:te,get dtmf(){return this._dtmf===void 0&&(te.kind==="audio"?this._dtmf=X.createDTMFSender(te):this._dtmf=null),this._dtmf},_pc:X}};if(!j.RTCPeerConnection.prototype.getSenders){j.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const X=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(ue,Ee){let w=X.apply(this,arguments);return w||(w=C(this,ue),this._senders.push(w)),w};const te=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(ue){te.apply(this,arguments);const Ee=this._senders.indexOf(ue);Ee!==-1&&this._senders.splice(Ee,1)}}const P=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(X){this._senders=this._senders||[],P.apply(this,[X]),X.getTracks().forEach((te=>{this._senders.push(C(this,te))}))};const H=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(X){this._senders=this._senders||[],H.apply(this,[X]),X.getTracks().forEach((te=>{const ue=this._senders.find((Ee=>Ee.track===te));ue&&this._senders.splice(this._senders.indexOf(ue),1)}))}}else if(typeof j=="object"&&j.RTCPeerConnection&&"getSenders"in j.RTCPeerConnection.prototype&&"createDTMFSender"in j.RTCPeerConnection.prototype&&j.RTCRtpSender&&!("dtmf"in j.RTCRtpSender.prototype)){const C=j.RTCPeerConnection.prototype.getSenders;j.RTCPeerConnection.prototype.getSenders=function(){const P=C.apply(this,[]);return P.forEach((H=>H._pc=this)),P},Object.defineProperty(j.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function U(j){if(!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){const[P,H,X]=arguments;if(arguments.length>0&&typeof P=="function")return C.apply(this,arguments);if(C.length===0&&(arguments.length===0||typeof P!="function"))return C.apply(this,[]);const te=function(Ee){const w={};return Ee.result().forEach((d=>{const b={id:d.id,timestamp:d.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type};d.names().forEach((O=>{b[O]=d.stat(O)})),w[b.id]=b})),w},ue=function(Ee){return new Map(Object.keys(Ee).map((w=>[w,Ee[w]])))};if(arguments.length>=2){const Ee=function(w){H(ue(te(w)))};return C.apply(this,[Ee,P])}return new Promise(((Ee,w)=>{C.apply(this,[function(d){Ee(ue(te(d)))},w])})).then(H,X)}}function Q(j){if(!(typeof j=="object"&&j.RTCPeerConnection&&j.RTCRtpSender&&j.RTCRtpReceiver))return;if(!("getStats"in j.RTCRtpSender.prototype)){const P=j.RTCPeerConnection.prototype.getSenders;P&&(j.RTCPeerConnection.prototype.getSenders=function(){const X=P.apply(this,[]);return X.forEach((te=>te._pc=this)),X});const H=j.RTCPeerConnection.prototype.addTrack;H&&(j.RTCPeerConnection.prototype.addTrack=function(){const X=H.apply(this,arguments);return X._pc=this,X}),j.RTCRtpSender.prototype.getStats=function(){const X=this;return this._pc.getStats().then((te=>I(te,X.track,!0)))}}if(!("getStats"in j.RTCRtpReceiver.prototype)){const P=j.RTCPeerConnection.prototype.getReceivers;P&&(j.RTCPeerConnection.prototype.getReceivers=function(){const H=P.apply(this,[]);return H.forEach((X=>X._pc=this)),H}),_(j,"track",(H=>(H.receiver._pc=H.srcElement,H))),j.RTCRtpReceiver.prototype.getStats=function(){const H=this;return this._pc.getStats().then((X=>I(X,H.track,!1)))}}if(!("getStats"in j.RTCRtpSender.prototype)||!("getStats"in j.RTCRtpReceiver.prototype))return;const C=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof j.MediaStreamTrack){const P=arguments[0];let H,X,te;return this.getSenders().forEach((ue=>{ue.track===P&&(H?te=!0:H=ue)})),this.getReceivers().forEach((ue=>(ue.track===P&&(X?te=!0:X=ue),ue.track===P))),te||H&&X?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):H?H.getStats():X?X.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return C.apply(this,arguments)}}function W(j){j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((te=>this._shimmedLocalStreams[te][0]))};const C=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(te,ue){if(!ue)return C.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const Ee=C.apply(this,arguments);return this._shimmedLocalStreams[ue.id]?this._shimmedLocalStreams[ue.id].indexOf(Ee)===-1&&this._shimmedLocalStreams[ue.id].push(Ee):this._shimmedLocalStreams[ue.id]=[ue,Ee],Ee};const P=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(te){this._shimmedLocalStreams=this._shimmedLocalStreams||{},te.getTracks().forEach((w=>{if(this.getSenders().find((d=>d.track===w)))throw new DOMException("Track already exists.","InvalidAccessError")}));const ue=this.getSenders();P.apply(this,arguments);const Ee=this.getSenders().filter((w=>ue.indexOf(w)===-1));this._shimmedLocalStreams[te.id]=[te].concat(Ee)};const H=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[te.id],H.apply(this,arguments)};const X=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},te&&Object.keys(this._shimmedLocalStreams).forEach((ue=>{const Ee=this._shimmedLocalStreams[ue].indexOf(te);Ee!==-1&&this._shimmedLocalStreams[ue].splice(Ee,1),this._shimmedLocalStreams[ue].length===1&&delete this._shimmedLocalStreams[ue]})),X.apply(this,arguments)}}function q(j,C){if(!j.RTCPeerConnection)return;if(j.RTCPeerConnection.prototype.addTrack&&C.version>=65)return W(j);const P=j.RTCPeerConnection.prototype.getLocalStreams;j.RTCPeerConnection.prototype.getLocalStreams=function(){const w=P.apply(this);return this._reverseStreams=this._reverseStreams||{},w.map((d=>this._reverseStreams[d.id]))};const H=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(w){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},w.getTracks().forEach((d=>{if(this.getSenders().find((b=>b.track===d)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[w.id]){const d=new j.MediaStream(w.getTracks());this._streams[w.id]=d,this._reverseStreams[d.id]=w,w=d}H.apply(this,[w])};const X=j.RTCPeerConnection.prototype.removeStream;function te(w,d){let b=d.sdp;return Object.keys(w._reverseStreams||[]).forEach((O=>{const F=w._reverseStreams[O],ie=w._streams[F.id];b=b.replace(new RegExp(ie.id,"g"),F.id)})),new RTCSessionDescription({type:d.type,sdp:b})}j.RTCPeerConnection.prototype.removeStream=function(w){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},X.apply(this,[this._streams[w.id]||w]),delete this._reverseStreams[this._streams[w.id]?this._streams[w.id].id:w.id],delete this._streams[w.id]},j.RTCPeerConnection.prototype.addTrack=function(w,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find((F=>F===w)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((F=>F.track===w)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const O=this._streams[d.id];if(O)O.addTrack(w),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const F=new j.MediaStream([w]);this._streams[d.id]=F,this._reverseStreams[F.id]=d,this.addStream(F)}return this.getSenders().find((F=>F.track===w))},["createOffer","createAnswer"].forEach((function(w){const d=j.RTCPeerConnection.prototype[w],b={[w](){const O=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[F=>{const ie=te(this,F);O[0].apply(null,[ie])},F=>{O[1]&&O[1].apply(null,F)},arguments[2]]):d.apply(this,arguments).then((F=>te(this,F)))}};j.RTCPeerConnection.prototype[w]=b[w]}));const ue=j.RTCPeerConnection.prototype.setLocalDescription;j.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(function(w,d){let b=d.sdp;return Object.keys(w._reverseStreams||[]).forEach((O=>{const F=w._reverseStreams[O],ie=w._streams[F.id];b=b.replace(new RegExp(F.id,"g"),ie.id)})),new RTCSessionDescription({type:d.type,sdp:b})})(this,arguments[0]),ue.apply(this,arguments)):ue.apply(this,arguments)};const Ee=Object.getOwnPropertyDescriptor(j.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(j.RTCPeerConnection.prototype,"localDescription",{get(){const w=Ee.get.apply(this);return w.type===""?w:te(this,w)}}),j.RTCPeerConnection.prototype.removeTrack=function(w){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!w._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(w._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let d;this._streams=this._streams||{},Object.keys(this._streams).forEach((b=>{this._streams[b].getTracks().find((O=>w.track===O))&&(d=this._streams[b])})),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(w.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Y(j,C){!j.RTCPeerConnection&&j.webkitRTCPeerConnection&&(j.RTCPeerConnection=j.webkitRTCPeerConnection),j.RTCPeerConnection&&C.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(P){const H=j.RTCPeerConnection.prototype[P],X={[P](){return arguments[0]=new(P==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),H.apply(this,arguments)}};j.RTCPeerConnection.prototype[P]=X[P]}))}function ae(j,C){_(j,"negotiationneeded",(P=>{const H=P.target;if(!(C.version<72||H.getConfiguration&&H.getConfiguration().sdpSemantics==="plan-b")||H.signalingState==="stable")return P}))}function Z(j,C){const P=j&&j.navigator,H=j&&j.MediaStreamTrack;if(P.getUserMedia=function(X,te,ue){E("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),P.mediaDevices.getUserMedia(X).then(te,ue)},!(C.version>55&&"autoGainControl"in P.mediaDevices.getSupportedConstraints())){const X=function(ue,Ee,w){Ee in ue&&!(w in ue)&&(ue[w]=ue[Ee],delete ue[Ee])},te=P.mediaDevices.getUserMedia.bind(P.mediaDevices);if(P.mediaDevices.getUserMedia=function(ue){return typeof ue=="object"&&typeof ue.audio=="object"&&(ue=JSON.parse(JSON.stringify(ue)),X(ue.audio,"autoGainControl","mozAutoGainControl"),X(ue.audio,"noiseSuppression","mozNoiseSuppression")),te(ue)},H&&H.prototype.getSettings){const ue=H.prototype.getSettings;H.prototype.getSettings=function(){const Ee=ue.apply(this,arguments);return X(Ee,"mozAutoGainControl","autoGainControl"),X(Ee,"mozNoiseSuppression","noiseSuppression"),Ee}}if(H&&H.prototype.applyConstraints){const ue=H.prototype.applyConstraints;H.prototype.applyConstraints=function(Ee){return this.kind==="audio"&&typeof Ee=="object"&&(Ee=JSON.parse(JSON.stringify(Ee)),X(Ee,"autoGainControl","mozAutoGainControl"),X(Ee,"noiseSuppression","mozNoiseSuppression")),ue.apply(this,[Ee])}}}}function K(j,C){j.navigator.mediaDevices&&"getDisplayMedia"in j.navigator.mediaDevices||j.navigator.mediaDevices&&(j.navigator.mediaDevices.getDisplayMedia=function(P){if(!P||!P.video){const H=new DOMException("getDisplayMedia without video constraints is undefined");return H.name="NotFoundError",H.code=8,Promise.reject(H)}return P.video===!0?P.video={mediaSource:C}:P.video.mediaSource=C,j.navigator.mediaDevices.getUserMedia(P)})}function ne(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function le(j,C){if(typeof j!="object"||!j.RTCPeerConnection&&!j.mozRTCPeerConnection)return;!j.RTCPeerConnection&&j.mozRTCPeerConnection&&(j.RTCPeerConnection=j.mozRTCPeerConnection),C.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(X){const te=j.RTCPeerConnection.prototype[X],ue={[X](){return arguments[0]=new(X==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),te.apply(this,arguments)}};j.RTCPeerConnection.prototype[X]=ue[X]}));const P={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},H=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){const[X,te,ue]=arguments;return H.apply(this,[X||null]).then((Ee=>{if(C.version<53&&!te)try{Ee.forEach((w=>{w.type=P[w.type]||w.type}))}catch(w){if(w.name!=="TypeError")throw w;Ee.forEach(((d,b)=>{Ee.set(b,Object.assign({},d,{type:P[d.type]||d.type}))}))}return Ee})).then(te,ue)}}function ce(j){if(typeof j!="object"||!j.RTCPeerConnection||!j.RTCRtpSender||j.RTCRtpSender&&"getStats"in j.RTCRtpSender.prototype)return;const C=j.RTCPeerConnection.prototype.getSenders;C&&(j.RTCPeerConnection.prototype.getSenders=function(){const H=C.apply(this,[]);return H.forEach((X=>X._pc=this)),H});const P=j.RTCPeerConnection.prototype.addTrack;P&&(j.RTCPeerConnection.prototype.addTrack=function(){const H=P.apply(this,arguments);return H._pc=this,H}),j.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function de(j){if(typeof j!="object"||!j.RTCPeerConnection||!j.RTCRtpSender||j.RTCRtpSender&&"getStats"in j.RTCRtpReceiver.prototype)return;const C=j.RTCPeerConnection.prototype.getReceivers;C&&(j.RTCPeerConnection.prototype.getReceivers=function(){const P=C.apply(this,[]);return P.forEach((H=>H._pc=this)),P}),_(j,"track",(P=>(P.receiver._pc=P.srcElement,P))),j.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Me(j){j.RTCPeerConnection&&!("removeStream"in j.RTCPeerConnection.prototype)&&(j.RTCPeerConnection.prototype.removeStream=function(C){E("removeStream","removeTrack"),this.getSenders().forEach((P=>{P.track&&C.getTracks().includes(P.track)&&this.removeTrack(P)}))})}function qe(j){j.DataChannel&&!j.RTCDataChannel&&(j.RTCDataChannel=j.DataChannel)}function Ne(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.addTransceiver;C&&(j.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let P=arguments[1]&&arguments[1].sendEncodings;P===void 0&&(P=[]),P=[...P];const H=P.length>0;H&&P.forEach((te=>{if("rid"in te&&!/^[a-z0-9]{0,16}$/i.test(te.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in te&&!(parseFloat(te.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in te&&!(parseFloat(te.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const X=C.apply(this,arguments);if(H){const{sender:te}=X,ue=te.getParameters();(!("encodings"in ue)||ue.encodings.length===1&&Object.keys(ue.encodings[0]).length===0)&&(ue.encodings=P,te.sendEncodings=P,this.setParametersPromises.push(te.setParameters(ue).then((()=>{delete te.sendEncodings})).catch((()=>{delete te.sendEncodings}))))}return X})}function Ae(j){if(typeof j!="object"||!j.RTCRtpSender)return;const C=j.RTCRtpSender.prototype.getParameters;C&&(j.RTCRtpSender.prototype.getParameters=function(){const P=C.apply(this,arguments);return"encodings"in P||(P.encodings=[].concat(this.sendEncodings||[{}])),P})}function Xe(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>C.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):C.apply(this,arguments)}}function $e(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.createAnswer;j.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>C.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):C.apply(this,arguments)}}function at(j){if(typeof j=="object"&&j.RTCPeerConnection){if("getLocalStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in j.RTCPeerConnection.prototype)){const C=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addStream=function(P){this._localStreams||(this._localStreams=[]),this._localStreams.includes(P)||this._localStreams.push(P),P.getAudioTracks().forEach((H=>C.call(this,H,P))),P.getVideoTracks().forEach((H=>C.call(this,H,P)))},j.RTCPeerConnection.prototype.addTrack=function(P,...H){return H&&H.forEach((X=>{this._localStreams?this._localStreams.includes(X)||this._localStreams.push(X):this._localStreams=[X]})),C.apply(this,arguments)}}"removeStream"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.removeStream=function(C){this._localStreams||(this._localStreams=[]);const P=this._localStreams.indexOf(C);if(P===-1)return;this._localStreams.splice(P,1);const H=C.getTracks();this.getSenders().forEach((X=>{H.includes(X.track)&&this.removeTrack(X)}))})}}function pt(j){if(typeof j=="object"&&j.RTCPeerConnection&&("getRemoteStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in j.RTCPeerConnection.prototype))){Object.defineProperty(j.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(P){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=P),this.addEventListener("track",this._onaddstreampoly=H=>{H.streams.forEach((X=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(X))return;this._remoteStreams.push(X);const te=new Event("addstream");te.stream=X,this.dispatchEvent(te)}))})}});const C=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){const P=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(H){H.streams.forEach((X=>{if(P._remoteStreams||(P._remoteStreams=[]),P._remoteStreams.indexOf(X)>=0)return;P._remoteStreams.push(X);const te=new Event("addstream");te.stream=X,P.dispatchEvent(te)}))}),C.apply(P,arguments)}}}function oe(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype,P=C.createOffer,H=C.createAnswer,X=C.setLocalDescription,te=C.setRemoteDescription,ue=C.addIceCandidate;C.createOffer=function(w,d){const b=arguments.length>=2?arguments[2]:arguments[0],O=P.apply(this,[b]);return d?(O.then(w,d),Promise.resolve()):O},C.createAnswer=function(w,d){const b=arguments.length>=2?arguments[2]:arguments[0],O=H.apply(this,[b]);return d?(O.then(w,d),Promise.resolve()):O};let Ee=function(w,d,b){const O=X.apply(this,[w]);return b?(O.then(d,b),Promise.resolve()):O};C.setLocalDescription=Ee,Ee=function(w,d,b){const O=te.apply(this,[w]);return b?(O.then(d,b),Promise.resolve()):O},C.setRemoteDescription=Ee,Ee=function(w,d,b){const O=ue.apply(this,[w]);return b?(O.then(d,b),Promise.resolve()):O},C.addIceCandidate=Ee}function Ue(j){const C=j&&j.navigator;if(C.mediaDevices&&C.mediaDevices.getUserMedia){const P=C.mediaDevices,H=P.getUserMedia.bind(P);C.mediaDevices.getUserMedia=X=>H(Ge(X))}!C.getUserMedia&&C.mediaDevices&&C.mediaDevices.getUserMedia&&(C.getUserMedia=(function(P,H,X){C.mediaDevices.getUserMedia(P).then(H,X)}).bind(C))}function Ge(j){return j&&j.video!==void 0?Object.assign({},j,{video:k(j.video)}):j}function ze(j){if(!j.RTCPeerConnection)return;const C=j.RTCPeerConnection;j.RTCPeerConnection=function(P,H){if(P&&P.iceServers){const X=[];for(let te=0;te<P.iceServers.length;te++){let ue=P.iceServers[te];ue.urls===void 0&&ue.url?(E("RTCIceServer.url","RTCIceServer.urls"),ue=JSON.parse(JSON.stringify(ue)),ue.urls=ue.url,delete ue.url,X.push(ue)):X.push(P.iceServers[te])}P.iceServers=X}return new C(P,H)},j.RTCPeerConnection.prototype=C.prototype,"generateCertificate"in C&&Object.defineProperty(j.RTCPeerConnection,"generateCertificate",{get:()=>C.generateCertificate})}function Be(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function me(j){const C=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(P){if(P){P.offerToReceiveAudio!==void 0&&(P.offerToReceiveAudio=!!P.offerToReceiveAudio);const H=this.getTransceivers().find((te=>te.receiver.track.kind==="audio"));P.offerToReceiveAudio===!1&&H?H.direction==="sendrecv"?H.setDirection?H.setDirection("sendonly"):H.direction="sendonly":H.direction==="recvonly"&&(H.setDirection?H.setDirection("inactive"):H.direction="inactive"):P.offerToReceiveAudio!==!0||H||this.addTransceiver("audio",{direction:"recvonly"}),P.offerToReceiveVideo!==void 0&&(P.offerToReceiveVideo=!!P.offerToReceiveVideo);const X=this.getTransceivers().find((te=>te.receiver.track.kind==="video"));P.offerToReceiveVideo===!1&&X?X.direction==="sendrecv"?X.setDirection?X.setDirection("sendonly"):X.direction="sendonly":X.direction==="recvonly"&&(X.setDirection?X.setDirection("inactive"):X.direction="inactive"):P.offerToReceiveVideo!==!0||X||this.addTransceiver("video",{direction:"recvonly"})}return C.apply(this,arguments)}}function Se(j){typeof j!="object"||j.AudioContext||(j.AudioContext=j.webkitAudioContext)}var ke=i(7963),be=i.n(ke);function Ke(j){if(!j.RTCIceCandidate||j.RTCIceCandidate&&"foundation"in j.RTCIceCandidate.prototype)return;const C=j.RTCIceCandidate;j.RTCIceCandidate=function(P){if(typeof P=="object"&&P.candidate&&P.candidate.indexOf("a=")===0&&((P=JSON.parse(JSON.stringify(P))).candidate=P.candidate.substring(2)),P.candidate&&P.candidate.length){const H=new C(P),X=be().parseCandidate(P.candidate);for(const te in X)te in H||Object.defineProperty(H,te,{value:X[te]});return H.toJSON=function(){return{candidate:H.candidate,sdpMid:H.sdpMid,sdpMLineIndex:H.sdpMLineIndex,usernameFragment:H.usernameFragment}},H}return new C(P)},j.RTCIceCandidate.prototype=C.prototype,_(j,"icecandidate",(P=>(P.candidate&&Object.defineProperty(P,"candidate",{value:new j.RTCIceCandidate(P.candidate),writable:"false"}),P)))}function ot(j){!j.RTCIceCandidate||j.RTCIceCandidate&&"relayProtocol"in j.RTCIceCandidate.prototype||_(j,"icecandidate",(C=>{if(C.candidate){const P=be().parseCandidate(C.candidate.candidate);P.type==="relay"&&(C.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[P.priority>>24])}return C}))}function lt(j,C){if(!j.RTCPeerConnection)return;"sctp"in j.RTCPeerConnection.prototype||Object.defineProperty(j.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const P=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,C.browser==="chrome"&&C.version>=76){const{sdpSemantics:H}=this.getConfiguration();H==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if((function(H){if(!H||!H.sdp)return!1;const X=be().splitSections(H.sdp);return X.shift(),X.some((te=>{const ue=be().parseMLine(te);return ue&&ue.kind==="application"&&ue.protocol.indexOf("SCTP")!==-1}))})(arguments[0])){const H=(function(w){const d=w.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(d===null||d.length<2)return-1;const b=parseInt(d[1],10);return b!=b?-1:b})(arguments[0]),X=(function(w){let d=65536;return C.browser==="firefox"&&(d=C.version<57?w===-1?16384:2147483637:C.version<60?C.version===57?65535:65536:2147483637),d})(H),te=(function(w,d){let b=65536;C.browser==="firefox"&&C.version===57&&(b=65535);const O=be().matchPrefix(w.sdp,"a=max-message-size:");return O.length>0?b=parseInt(O[0].substring(19),10):C.browser==="firefox"&&d!==-1&&(b=2147483637),b})(arguments[0],H);let ue;ue=X===0&&te===0?Number.POSITIVE_INFINITY:X===0||te===0?Math.max(X,te):Math.min(X,te);const Ee={};Object.defineProperty(Ee,"maxMessageSize",{get:()=>ue}),this._sctp=Ee}return P.apply(this,arguments)}}function ct(j){if(!j.RTCPeerConnection||!("createDataChannel"in j.RTCPeerConnection.prototype))return;function C(H,X){const te=H.send;H.send=function(){const ue=arguments[0],Ee=ue.length||ue.size||ue.byteLength;if(H.readyState==="open"&&X.sctp&&Ee>X.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+X.sctp.maxMessageSize+" bytes)");return te.apply(H,arguments)}}const P=j.RTCPeerConnection.prototype.createDataChannel;j.RTCPeerConnection.prototype.createDataChannel=function(){const H=P.apply(this,arguments);return C(H,this),H},_(j,"datachannel",(H=>(C(H.channel,H.target),H)))}function Vt(j){if(!j.RTCPeerConnection||"connectionState"in j.RTCPeerConnection.prototype)return;const C=j.RTCPeerConnection.prototype;Object.defineProperty(C,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(C,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(P){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),P&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=P)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((P=>{const H=C[P];C[P]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=X=>{const te=X.target;if(te._lastConnectionState!==te.connectionState){te._lastConnectionState=te.connectionState;const ue=new Event("connectionstatechange",X);te.dispatchEvent(ue)}return X},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),H.apply(this,arguments)}}))}function Ot(j,C){if(!j.RTCPeerConnection||C.browser==="chrome"&&C.version>=71||C.browser==="safari"&&C.version>=605)return;const P=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(H){if(H&&H.sdp&&H.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const X=H.sdp.split(`
`).filter((te=>te.trim()!=="a=extmap-allow-mixed")).join(`
`);j.RTCSessionDescription&&H instanceof j.RTCSessionDescription?arguments[0]=new j.RTCSessionDescription({type:H.type,sdp:X}):H.sdp=X}return P.apply(this,arguments)}}function Ut(j,C){if(!j.RTCPeerConnection||!j.RTCPeerConnection.prototype)return;const P=j.RTCPeerConnection.prototype.addIceCandidate;P&&P.length!==0&&(j.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(C.browser==="chrome"&&C.version<78||C.browser==="firefox"&&C.version<68||C.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():P.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function je(j,C){if(!j.RTCPeerConnection||!j.RTCPeerConnection.prototype)return;const P=j.RTCPeerConnection.prototype.setLocalDescription;P&&P.length!==0&&(j.RTCPeerConnection.prototype.setLocalDescription=function(){let H=arguments[0]||{};if(typeof H!="object"||H.type&&H.sdp)return P.apply(this,arguments);if(H={type:H.type,sdp:H.sdp},!H.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":H.type="offer";break;default:H.type="answer"}return H.sdp||H.type!=="offer"&&H.type!=="answer"?P.apply(this,[H]):(H.type==="offer"?this.createOffer:this.createAnswer).apply(this).then((X=>P.apply(this,[X])))})}(function({window:j}={},C={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const P=x,H=(function(te){const ue={browser:null,version:null};if(te===void 0||!te.navigator||!te.navigator.userAgent)return ue.browser="Not a browser.",ue;const{navigator:Ee}=te;if(Ee.mozGetUserMedia)ue.browser="firefox",ue.version=p(Ee.userAgent,/Firefox\/(\d+)\./,1);else if(Ee.webkitGetUserMedia||te.isSecureContext===!1&&te.webkitRTCPeerConnection)ue.browser="chrome",ue.version=p(Ee.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!te.RTCPeerConnection||!Ee.userAgent.match(/AppleWebKit\/(\d+)\./))return ue.browser="Not a supported browser.",ue;ue.browser="safari",ue.version=p(Ee.userAgent,/AppleWebKit\/(\d+)\./,1),ue.supportsUnifiedPlan=te.RTCRtpTransceiver&&"currentDirection"in te.RTCRtpTransceiver.prototype}return ue})(j),X={browserDetails:H,commonShim:c,extractVersion:p,disableLog:y,disableWarnings:v,sdp:ke};switch(H.browser){case"chrome":if(!a||!Y||!C.shimChrome)return P("Chrome shim is not included in this adapter release."),X;if(H.version===null)return P("Chrome shim can not determine version, not shimming."),X;P("adapter.js shimming chrome."),X.browserShim=a,Ut(j,H),je(j),V(j,H),J(j),Y(j,H),B(j),q(j,H),$(j),U(j),Q(j),ae(j,H),Ke(j),ot(j),Vt(j),lt(j,H),ct(j),Ot(j,H);break;case"firefox":if(!o||!le||!C.shimFirefox)return P("Firefox shim is not included in this adapter release."),X;P("adapter.js shimming firefox."),X.browserShim=o,Ut(j,H),je(j),Z(j,H),le(j,H),ne(j),Me(j),ce(j),de(j),qe(j),Ne(j),Ae(j),Xe(j),$e(j),Ke(j),Vt(j),lt(j,H),ct(j);break;case"safari":if(!l||!C.shimSafari)return P("Safari shim is not included in this adapter release."),X;P("adapter.js shimming safari."),X.browserShim=l,Ut(j,H),je(j),ze(j),me(j),oe(j),at(j),pt(j),Be(j),Ue(j),Se(j),Ke(j),ot(j),lt(j,H),ct(j),Ot(j,H);break;default:P("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),i(8630);const ge=()=>typeof RTCPeerConnection=="function";var se,_e;(function(j){j[j.TRACE=0]="TRACE",j[j.DEBUG=1]="DEBUG",j[j.INFO=2]="INFO",j[j.WARN=3]="WARN",j[j.ERROR=4]="ERROR",j[j.SILENT=5]="SILENT"})(se||(se={})),(function(j){j.TIME="Time",j.WEBRTC="WebRTC",j.EMITTER="Emitter",j.MEDIA="Media",j.SUBSCRIPTION="StageSubscription",j.PUBLICATION="StagePublication",j.CONNECTION="StageConnection",j.SOCKET="StageSocket",j.BROADCAST_STAGE_CLIENT="BroadcastStageClient",j.STAGE="Stage",j.REMOTE_PARTICIPANT="RemoteParticipant",j.LOCAL_PARTICIPANT="LocalParticipant",j.CONFIGURATION="Configuration",j.REMOTE_PLAYBACK="RemotePlaybackController",j.REMOTE_STAGE_STREAM="RemoteStageStream"})(_e||(_e={}));const Ie=12e4,De=3e5,Oe="no-rid";class we extends Error{constructor({name:C,message:P,code:H,details:X,cause:te,params:ue}){super(P),Error.captureStackTrace&&Error.captureStackTrace(this,we),this.name=C||"BroadcastClientError",this.message=P,this.code=H,this.details=X,this.cause=te,this.params=ue}}const st={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},Ve={name:"CameraError",code:2e3,message:"Camera could not be captured"},tt={name:"InputError",code:3e3,message:"Input could not be attached"},Ze={name:"AddDeviceError",code:4e3,message:"Device is missing"},nt={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},vt={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},Je={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},ht={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},mt={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},ft={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},_t={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},gn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},_n={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},Bt={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},Yt={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},Mt={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},fn={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},Bn={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},cn={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},In={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},Wn={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},er={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},os={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},gi={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},Ni={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},Fs={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},_i={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},Rs={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},ra={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},ls={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},We={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},At={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var Wt,Kt,Lt,yn,zn,En,tr,Nr,Er,rr=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)},Lr=function(j,C,P,H,X){if(typeof C=="function"?j!==C||!0:!C.has(j))throw new TypeError("Cannot write private member to an object whose class did not declare it");return C.set(j,P),P};const ii=1920,da=1080,Mr=se.ERROR,si={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},Tr={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},Dr={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},Cn={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},jr={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},Uo={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},cs={reconnect:!1,timeout:Ie};function Bo(j){var C,P;if(typeof j!="string"&&j!==void 0)throw new we(os);if(j){if(j.startsWith("https"))return j;{const H=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(j);if(((C=H?.groups)===null||C===void 0?void 0:C.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(P=H?.groups)===null||P===void 0?void 0:P.id)return`https://${H.groups.id}.webrtc.live-video.net:4443`;throw new we(gi)}}return""}class us{constructor(C,P,H=si,X,te=cs){this.LOG_LEVEL=se,this.BASIC_LANDSCAPE=si,this.BASIC_PORTRAIT=Tr,this.BASIC_FULL_HD_LANDSCAPE=Dr,this.BASIC_FULL_HD_PORTRAIT=Cn,this.STANDARD_LANDSCAPE=jr,this.STANDARD_PORTRAIT=Uo,Wt.set(this,void 0),Kt.set(this,void 0),Lt.set(this,si),yn.set(this,void 0),zn.set(this,cs),En.set(this,(ue=>{if(!ue)throw new we(Object.assign(Object.assign({},er),{details:"missing stream configuration"}));if(!(ue.maxBitrate<=8500&&ue.maxBitrate>=200))throw new we(Object.assign(Object.assign({},er),{details:"maxBitrate must be between 200 and 8500"}));if(!(ue.maxFramerate<=60&&ue.maxFramerate>=10))throw new we(Object.assign(Object.assign({},er),{details:"maxFramerate must be between 10 and 60"}));const Ee=ue.maxResolution.width,w=ue.maxResolution.height;if(Ee>ii||w>ii||Ee<160||w<160||Ee===ii&&w>da||w===ii&&Ee>da)throw new we(Object.assign(Object.assign({},er),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))})),tr.set(this,(ue=>{if(!ue)return;const Ee=Number(ue),w=Number.isInteger(Ee),d=Ee>=se.TRACE,b=Ee<=se.SILENT;if(!w||!d||!b)throw new we(Ni)})),Nr.set(this,(ue=>{if(ue&&typeof ue!="object")throw new we(Fs)})),Er.set(this,(ue=>{if(!ue)return;if(typeof ue!="object"||typeof ue.reconnect!="boolean")throw new we(Rs);const{timeout:Ee}=ue;if(Ee!==void 0&&(Number.isNaN(Ee)||typeof Ee!="number"||Ee<1e4||Ee>De))throw new we(ra)})),rr(this,Nr,"f").call(this,X),rr(this,tr,"f").call(this,P),rr(this,En,"f").call(this,H),Lr(this,Wt,C),Lr(this,Kt,P),Lr(this,Lt,H),Lr(this,yn,X),Lr(this,zn,te)}get ingestEndpoint(){return rr(this,Wt,"f")}set ingestEndpoint(C){Lr(this,Wt,Bo(C))}get streamConfig(){return rr(this,Lt,"f")}set streamConfig(C){rr(this,En,"f").call(this,C),Lr(this,Lt,C)}get logLevel(){return rr(this,Kt,"f")}set logLevel(C){rr(this,tr,"f").call(this,C),Lr(this,Kt,C)}get logger(){return rr(this,yn,"f")}set logger(C){rr(this,Nr,"f").call(this,C),Lr(this,yn,C)}get networkReconnectConfig(){return rr(this,zn,"f")}set networkReconnectConfig(C){rr(this,Er,"f").call(this,C),Lr(this,zn,C)}}Wt=new WeakMap,Kt=new WeakMap,Lt=new WeakMap,yn=new WeakMap,zn=new WeakMap,En=new WeakMap,tr=new WeakMap,Nr=new WeakMap,Er=new WeakMap;var Xn,ei=i(228);(function(j){j.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",j.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",j.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",j.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",j.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",j.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",j.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",j.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",j.PUBLISH="ivs_broadcast_multihost_publish",j.UNPUBLISH="ivs_broadcast_multihost_unpublish",j.SUBSCRIBE="ivs_broadcast_multihost_subscribe",j.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",j.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",j.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",j.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",j.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",j.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",j.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",j.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",j.FIRST_FRAME="ivs_broadcast_multihost_first_frame",j.JOIN="ivs_broadcast_multihost_join",j.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",j.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",j.JOIN_ENDED="ivs_broadcast_multihost_join_ended",j.LEAVE="ivs_broadcast_multihost_leave",j.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",j.SERVER_REQUEST="ivs_broadcast_multihost_server_request",j.TRACE="ivs_broadcast_stage_trace",j.ERROR="ivs_broadcast_error",j.MINUTE="ivs_broadcast_multihost_minute",j.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",j.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",j.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",j.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",j.EDP_PONG="ivs_broadcast_multihost_edp_rtt",j.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",j.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",j.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",j.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",j.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state",j.SELECTED_PAIR_CHANGE="ivs_broadcast_webrtc_selected_pair_change",j.ANALYTICS_HEALTH_REPORT="ivs_broadcast_analytics_health_report"})(Xn||(Xn={}));class ur{constructor(C,P,H,X){let te="unknown";if(P.stageARN&&P.stageARN.startsWith("arn:aws:ivs:")){const ue=P.stageARN.split(":");ue.length===6&&(te=ue[4])}this.event=C,this.properties={client_time:new Date().toISOString(),customer_id:te,device_software:window.navigator.userAgent,multihost_id:P.stageARN,participant_id:P.participantID,participant_user_id:P.userID,platform:"web",sdk_version:"1.27.0",stage_arn:P.stageARN,trace_id:H.value},P.attrGsRole&&(this.properties.token_attribute_0=P.attrGsRole),P.attrGsSessionId&&(this.properties.token_attribute_1=P.attrGsSessionId),this.critical=X}}class zs extends ur{constructor(C){super(Xn.ERROR,C.token,C.traceId,!0),Object.assign(this.properties,{code:C.code,tag:C.tag,description:C.message,remote_participant_id:C.remoteParticipantId,request_uuid:C.requestUUID,is_nominal:C.nominal,is_fatal:C.fatal,details:C.details,location:C.location,event_count:C.count})}}function So(j){const C=window.IVS_CLIENT_OVERRIDES;return typeof C=="object"?C[j]:j==="logLevel"?window.STAGES_LOG_LEVEL:j==="appLabel"?window.IVS_APP_LABEL:j==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function pa(j){const C=So(j);if(typeof C=="string")return C}function ma(j){const C=So(j);if(typeof C=="boolean")return C}function zh(j){const C=So(j);if(typeof C=="number")return C;if(typeof C=="string"){const P=parseFloat(C);if(!isNaN(P))return P}}function op(){const j=So("logLevel");if(typeof j=="number"&&Object.values(se).includes(j))return j}function Wp(){return ma("disableXdp")}function Yp(){return ma("preferMainProfile")}function rh(){return ma("enableInitialLayerOnSdp")}function wl(){return ma("disableAudioRtcpRsize")}var cc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Fo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(j=>{const C=16*Math.random()|0;return(j==="x"?C:3&C|8).toString(16)}))}function il(j,C=P=>{}){cc(this,void 0,void 0,(function*(){try{yield j()}catch(P){C(P)}}))}var Xp=i(6880),Ac=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Wc(j,C,P={},H=""){return Ac(this,void 0,void 0,(function*(){const X=new XMLHttpRequest;return X.open(j,C,!0),P&&Object.keys(P).forEach((te=>{P.hasOwnProperty(te)&&X.setRequestHeader(te,P[te])})),new Promise(((te,ue)=>{X.onreadystatechange=()=>{X.readyState===4&&(X.status>=200&&X.status<300?te(X.responseText):ue(new Error(`Ingest ${j} ${C} responded ${X.status}
${X.responseText}`)))},X.send(H)}))}))}function Yu(j){const C=Date.now();for(const H of j)H.properties.batch_time_millis=C;var P;return{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`data=${P=JSON.stringify(j),btoa(encodeURIComponent(P).replace(/%([0-9A-F]{2})/g,((H,X)=>String.fromCharCode(+`0x${X}`))))}`}}class Yi{send(C,P=!1){return Ac(this,void 0,void 0,(function*(){const{currentEndpoint:H}=ga,{headers:X,body:te}=Yu(C),ue="eventSenderResult",Ee=C.length;if(P){const w=navigator.sendBeacon(H,te);ga.trackEvent({type:ue,success:w,count:Ee})}else il((()=>Ac(this,void 0,void 0,(function*(){yield Wc("POST",H,X,te),ga.trackEvent({type:ue,success:!0,count:Ee})}))),(()=>{ga.trackEvent({type:ue,success:!1,count:Ee})}))}))}}class Xi{constructor({globalProperties:C,totalEvents:P,totalEventsLost:H,windowedEvents:X,windowedEventsLost:te,currentEndpoint:ue}){this.transformProperties=(w,d,b,O,F)=>({total_events:w,total_events_lost:d,windowed_events:b,windowed_events_lost:O,current_endpoint:F});const Ee=this.transformProperties(P,H,X,te,ue);this.data={event:Xn.ANALYTICS_HEALTH_REPORT,properties:Object.assign(Object.assign({},C),Ee)}}}var Cc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Ef={totalEvents:0,totalEventsSent:0,totalEventsLost:0,windowedEvents:0,windowedEventsSent:0,windowedEventsLost:0};class Jm{constructor(C){this.globalSession=C,this.eventSenderMetrics=Object.assign({},Ef),this.emptyWindows=0,this.scheduleHealthReport=()=>{this.reportTimer=window.setTimeout(this.onHealthReportInterval,6e4)},this.onHealthReportInterval=()=>{const P=Object.assign({},this.eventSenderMetrics);if(this.eventSenderMetrics.windowedEvents===0?this.emptyWindows++:this.emptyWindows=0,this.emptyWindows>3)return window.clearTimeout(this.reportTimer),void(this.reportTimer=void 0);this.postHealthReport(P),this.eventSenderMetrics.windowedEvents=0,this.eventSenderMetrics.windowedEventsSent=0,this.eventSenderMetrics.windowedEventsLost=0,this.scheduleHealthReport()}}trackEventSendResult(C){const{count:P,success:H}=C;this.eventSenderMetrics.totalEvents+=P,this.eventSenderMetrics.windowedEvents+=P,H?(this.eventSenderMetrics.totalEventsSent+=P,this.eventSenderMetrics.windowedEventsSent+=P):(this.eventSenderMetrics.totalEventsLost+=P,this.eventSenderMetrics.windowedEventsLost+=P),this.isHealthReportScheduled()||this.scheduleHealthReport()}isHealthReportScheduled(){return typeof this.reportTimer=="number"}postHealthReport(C){const P=this.globalSession.parseGlobalProperties(),H=this.globalSession.currentEndpoint,X=new Xi(Object.assign(Object.assign({globalProperties:P},C),{currentEndpoint:H})),{headers:te,body:ue}=Yu([X.data]);il((()=>Cc(this,void 0,void 0,(function*(){yield Wc("POST",H,te,ue)}))))}}class uc{constructor(){this.emitter=new ei}hasListenersFor(C){return this.emitter.listenerCount(C)>0}on(C,P,H){P.call=(function(X,te){return function(ue,...Ee){try{te.apply(ue,Ee)}catch(w){let d=`Error in callback for ${X}`;const b=te.name;return b&&(d+=` for function ${b}`),void console.error(`${d}
`,w)}}})(C,P),this.emitter.on(C,P,H)}off(C,P,H){this.emitter.off(C,P,H)}emit(C,...P){this.emitter.emit(C,...P)}removeAllListeners(){this.emitter.removeAllListeners()}}var uo;(function(j){j[j.EXCELLENT=4]="EXCELLENT",j[j.GOOD=3]="GOOD",j[j.NORMAL=2]="NORMAL",j[j.POOR=1]="POOR",j[j.DOWN=0]="DOWN"})(uo||(uo={}));var Yc;(function(j){j.NETWORK_QUALITY_CHANGE="networkQualityChange"})(Yc||(Yc={}));class Xc extends uc{constructor(){super(),this.lastNetworkStatus={},this.networkAssessment={networkQuality:uo.NORMAL,reason:"no-data"},this.checkNetworkStatus=()=>{var C,P;const H=(C=navigator?.connection)!==null&&C!==void 0?C:{},X={downlink:H.downlink,effectiveType:H.effectiveType,rtt:H.rtt,isOnline:(P=navigator.onLine)===null||P===void 0||P};if(!this.isChangedNetworkStatus(this.lastNetworkStatus,X))return;this.lastNetworkStatus=X;const te=this.networkAssessment,ue=(function(Ee){const{rtt:w,downlink:d,isOnline:b}=Ee;if(!b)return{networkQuality:uo.DOWN,reason:"offline"};if(typeof w!="number"||typeof d!="number")return{networkQuality:uo.NORMAL,reason:"no-data"};let O=0;w>800?O+=2:w>300&&(O+=1),d<2.5?O+=2:d<5&&(O+=1);const F="score";switch(O){case 4:return{networkQuality:uo.POOR,reason:F};case 0:return{networkQuality:uo.EXCELLENT,reason:F};default:return{networkQuality:O<=2?uo.GOOD:uo.NORMAL,reason:F}}})(X);te.networkQuality!==ue.networkQuality&&this.emit(Yc.NETWORK_QUALITY_CHANGE,te.networkQuality,ue.networkQuality),this.networkAssessment=ue},this.getNetworkQuality=()=>this.networkAssessment.networkQuality,this.setupWindowListeners(),this.checkNetworkStatus()}setupWindowListeners(){window.addEventListener("online",(()=>{this.checkNetworkStatus()})),window.addEventListener("offline",(()=>{this.checkNetworkStatus()})),window.navigator.connection&&window.navigator.connection.addEventListener("change",(()=>{this.checkNetworkStatus()}))}isChangedNetworkStatus(C,P){const{downlink:H,effectiveType:X,rtt:te,isOnline:ue}=P;return C.effectiveType!==X||C.downlink!==H||C.rtt!==te||C.isOnline!==ue}}class ih{constructor(){this.globalSessionId=Fo(),this.currentGlobalEndpoint="https://broadcast.stats.live-video.net/",this.healthReporter=new Jm(this),this.networkMonitor=new Xc}getGlobalSessionId(){return this.globalSessionId}set currentEndpoint(C){this.currentGlobalEndpoint=C}get currentEndpoint(){var C;return!((C=window.IVS_CLIENT_OVERRIDES)===null||C===void 0)&&C.analyticsPostUrl?window.IVS_CLIENT_OVERRIDES.analyticsPostUrl:this.currentGlobalEndpoint}trackEvent(C){C.type==="eventSenderResult"&&this.healthReporter.trackEventSendResult(C)}getNetworkQuality(){return this.networkMonitor.getNetworkQuality()}parseGlobalProperties(){const C=Xp.getParser(navigator.userAgent),P=(function(H){const X=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(H)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(H)||/^(\d+)$/.exec(H)||[];return{major:parseInt(X[1],10)||0,minor:parseInt(X[2],10)||0,patch:parseInt(X[3],10)||0}})(String(C.getBrowserVersion()));return{browser:navigator.appVersion,browser_family:C.getBrowserName().toLowerCase(),browser_version:`${P.major}.${P.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:C.getOSName(),os_version:String(C.getOSVersion()),platform:"web",global_session_id:this.getGlobalSessionId(),sdk_version:"1.27.0",user_agent:navigator.userAgent,is_backgrounded:document?.visibilityState==="hidden"}}}window.IVS_CLIENT_GLOBAL_STATE||(window.IVS_CLIENT_GLOBAL_STATE={}),window.IVS_CLIENT_GLOBAL_STATE.session||(window.IVS_CLIENT_GLOBAL_STATE.session=new ih);const ga=window.IVS_CLIENT_GLOBAL_STATE.session;function xf(j){if(!j)throw new Error("eventSender is not defined")}class sh{constructor(){this.sharedProperties={},this.eventSender={},this.queuedEvents=[],this.genSessionId();const C=(function(){const P=pa("appLabel");if(P!==void 0)return P.substring(0,64)})();this.eventSender=new Yi,this.initSharedProperties({appLabel:C}),this.errorReports=new Map}start(){this.flushInterval||(this.flushInterval=window.setInterval((()=>{this.queueAggregateErrors({force:!1}),this.flushEvents()}),1e3))}stop(C){let P=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,this.queueAggregateErrors({force:!0}),C&&(this.queuedEvents=this.queuedEvents.filter((H=>H.critical)),P=!0),this.flushEvents(P),this.genSessionId()}trackEvent(C,P=!1){let H=this.sharedProperties;P&&(H={global_session_id:this.sharedProperties.global_session_id,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version,is_backgrounded:this.sharedProperties.is_backgrounded}),document?.visibilityState==="hidden"&&(H.is_backgrounded=!0),"data"in C?(C.data.properties=Object.assign({},H,C.data.properties),this.queuedEvents.push(C.data)):(C.properties=Object.assign({},H,C.properties),this.queuedEvents.push(C))}trackEventNoSharedProps(C){this.trackEvent(C,!0)}trackErrorAndThrow(C){throw this.trackError(C),C}trackError(C){const P=`${C.code}${C.fatal}${C.nominal}${C.tag}${C.traceId.value}`,H=this.errorReports.get(P),X={error:C,queuedAt:Date.now(),count:0};return H?(H.count===0&&(H.error=C),H.count+=1,H.queuedAt+6e4<=Date.now()?(this.trackErrorReportIfNeeded(H),void this.errorReports.set(P,X)):void 0):(this.errorReports.set(P,X),void this.trackEvent(new zs(C)))}queueAggregateErrors({force:C=!1}){this.errorReports.forEach(((P,H)=>{const X=P.queuedAt+6e4;!C&&X>Date.now()||(this.trackErrorReportIfNeeded(P),this.errorReports.delete(H))}))}trackErrorReportIfNeeded(C){if(C.count===0)return;const P=C.error;P.count=C.count,this.trackEvent(new zs(P))}batchEvents(C){xf(this.eventSender);const P=C.map((H=>(H.data.properties=Object.assign({},this.sharedProperties,H.data.properties),H.data)));this.eventSender.send(P)}initSharedProperties({appLabel:C}){const P=ga.parseGlobalProperties();this.sharedProperties=Object.assign(Object.assign({},P),{session_id:this.sessionId}),C&&(this.sharedProperties.app_label=C)}genSessionId(){this.sessionId=Fo(),this.sharedProperties.session_id=this.sessionId}flushEvents(C=!1){xf(this.eventSender),this.queuedEvents.length>0&&this.eventSender.send(this.queuedEvents,C),this.queuedEvents=[]}getSessionId(){return this.sessionId}}class ah{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.CONGESTION_TIME,properties:H}}}class Qm{constructor(C,P,H){this.transformProperties=(te,ue,Ee)=>({duration:(te.getTime()-(ue?.getTime()||0))/1e3,ecn_negotiated:!1,ingest_session_id:Ee});const X=this.transformProperties(C,P,H);this.data={event:ys.CONNECTION_ESTABLISHED,properties:X}}}class Xu{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.CONNECTION_RTT,properties:H}}}class Tf{constructor(C){this.transformProperties=H=>{var X;return{is_fatal:(X=H.isFatal)!==null&&X!==void 0&&X,value:H.value,code:H.code,description:H.description}};const P=this.transformProperties(C);this.data={event:ys.ERROR,properties:P}}}class oh{constructor(C,P){this.transformProperties=(X,te)=>({type:X,input_device_id:te.deviceId,position:te.facingMode||"unknown"});const H=this.transformProperties(C,P);this.data={event:ys.INPUT_DEVICE_ATTACHED,properties:H}}}class zo{constructor(C,P){this.transformProperties=(X,te)=>({type:X,input_device_id:te.deviceId,position:te.facingMode||"unknown"});const H=this.transformProperties(C,P);this.data={event:ys.INPUT_DEVICE_DETACHED,properties:H}}}class $l{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.MEASURED_BITRATE,properties:H}}}class Rd{constructor(C,P){this.transformProperties=(X,te)=>({minutes_logged:Math.round((X.timestamp-te)/6e4)});const H=this.transformProperties(C,P);this.data={event:ys.MINUTE_BROADCAST,properties:H}}}class Kp{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.RECOMMENDED_BITRATE,properties:H}}}class sl{constructor(C){this.transformProperties=H=>({codec:H.mimeType,bitrate:0,sample_rate:H.clockRate,channel_count:H.channels});const P=this.transformProperties(C);this.data={event:ys.SESSION_AUDIO_ENCODER_CONFIGURED,properties:P}}}class eg{constructor(C){this.transformProperties=H=>({codec:"audio",bitrate:32e3,sample_rate:H.sampleRate,channel_count:H.channelCount});const P=this.transformProperties(C);this.data={event:ys.SESSION_AUDIO_PROPERTIES,properties:P}}}class G_{constructor(C,P,H){this.transformProperties=(te,ue,Ee)=>({codec:Ee.mimeType,codec_profile:ue.profile,codec_level:ue.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:te.width,height:te.height,bframe_count:0,target_fps:te.frameRate});const X=this.transformProperties(C,P,H);this.data={event:ys.SESSION_VIDEO_ENCODER_CONFIGURED,properties:X}}}class $_{constructor(C){this.transformProperties=H=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:H.width,height:H.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:H.frameRate});const P=this.transformProperties(C);this.data={event:ys.SESSION_VIDEO_PROPERTIES,properties:P}}}class lp{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.SOURCE_AUDIO_LATENCY,properties:H}}}class jh{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:ys.SOURCE_VIDEO_LATENCY,properties:H}}}class Hh{constructor(C,P){this.transformProperties=({protocol:X,hostname:te,port:ue},Ee)=>({protocol:X,endpoint_host:te,endpoint_port:ue,reason:Ee});const H=this.transformProperties(C,P);this.data={event:ys.START_BROADCAST,properties:H}}}class Ku{constructor(C){this.transformProperties=({protocol:H,hostname:X,port:te})=>({protocol:H,endpoint_host:X,endpoint_port:te});const P=this.transformProperties(C);this.data={event:ys.STOP_BROADCAST,properties:P}}}class Zu{constructor(C){this.transformProperties=H=>({bytes_sent:H.bytesSent,header_bytes_sent:H.headerBytesSent,nack_count:H.nackCount,packets_sent:H.packetsSent,retransmitted_bytes_sent:H.retransmittedBytesSent,retransmitted_packets_sent:H.retransmittedPacketsSent});const P=this.transformProperties(C);this.data={event:ys.WEBRTC_AUDIO_STATS,properties:P}}}class tg{constructor(C){this.transformProperties=H=>({bytes_sent:H.bytesSent,fir_count:H.firCount,frames_encoded:H.framesEncoded,frames_sent:H.framesSent,header_bytes_sent:H.headerBytesSent,huge_frames_sent:H.hugeFramesSent,key_frames_encoded:H.keyFramesEncoded,nack_count:H.nackCount,packets_sent:H.packetsSent,pli_count:H.pliCount,quality_limitation_reason:H.qualityLimitationReason,quality_limitation_resolution_changes:H.qualityLimitationResolutionChanges,retransmitted_bytes_sent:H.retransmittedBytesSent,retransmitted_packets_sent:H.retransmittedPacketsSent,total_encode_time:H.totalEncodeTime,total_encoded_bytes_target:H.totalEncodedBytesTarget,total_packet_send_delay:H.totalPacketSendDelay});const P=this.transformProperties(C);this.data={event:ys.WEBRTC_VIDEO_STATS,properties:P}}}var ys,wa;(function(j){j.START_BROADCAST="ivs_broadcast_start_broadcast",j.STOP_BROADCAST="ivs_broadcast_stop_broadcast",j.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",j.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",j.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",j.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",j.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",j.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",j.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",j.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",j.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",j.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",j.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",j.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",j.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",j.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",j.CONGESTION_TIME="ivs_broadcast_congestion_time",j.BUFFER_DURATION="ivs_broadcast_buffer_duration",j.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",j.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",j.CONNECTION_RTT="ivs_broadcast_connection_rtt",j.ERROR="ivs_broadcast_error"})(ys||(ys={})),(function(j){j.USER_INITIATED="user-initiated",j.NETWORK_DISCONNECT="network-disconnect"})(wa||(wa={}));const cp={[se.INFO]:"#528bff",[se.WARN]:"#ffb31a",[se.DEBUG]:"#00f593",[se.ERROR]:"#ff4f4d",[se.TRACE]:"",[se.SILENT]:"",[_e.TIME]:"#53535f",[_e.WEBRTC]:"#0e9bd8",[_e.SUBSCRIPTION]:"#ffc400",[_e.CONNECTION]:"#ff5edb",[_e.SOCKET]:"#8585ff",[_e.EMITTER]:"#adadb8",[_e.LOCAL_PARTICIPANT]:"#1DD21D",[_e.STAGE]:"#EC9806",[_e.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},ng=({label:j})=>`background: ${cp[j]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,qh=Object.entries(se),rt=(j,C,P)=>{const H=ng({label:j}),[X]=qh.find((([,pe])=>pe===Number(j)))||[],te=`%c${X}`,ue=ng({label:C}),Ee=`%c${C}`,w=ng({label:_e.TIME}),d=`%c[${new Date().toISOString()}]`,b=ng({label:"details"}),O=`%c[${P}]`,F=[d,te,Ee],ie=[w,H,ue];return P&&(F.push(O),ie.push(b)),[F.join(""),...ie]},Tt={debug(j){console.groupCollapsed(...rt(se.DEBUG,j.scope,j.label)),console.debug(j.msg,Object.assign(Object.assign({},j),{level:"debug"})),console.groupEnd()},info(j){console.groupCollapsed(...rt(se.INFO,j.scope,j.label)),console.info(j.msg,Object.assign(Object.assign({},j),{level:"info"})),console.groupEnd()},warn(j){console.groupCollapsed(...rt(se.WARN,j.scope,j.label)),console.warn(j.msg,Object.assign(Object.assign({},j),{level:"warn"})),console.groupEnd()},error(j){console.groupCollapsed(...rt(se.ERROR,j.scope,j.label)),console.error(j),console.groupEnd()}};var Rt=function(j,C){var P={};for(var H in j)Object.prototype.hasOwnProperty.call(j,H)&&C.indexOf(H)<0&&(P[H]=j[H]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function"){var X=0;for(H=Object.getOwnPropertySymbols(j);X<H.length;X++)C.indexOf(H[X])<0&&Object.prototype.propertyIsEnumerable.call(j,H[X])&&(P[H[X]]=j[H[X]])}return P};Object.entries(se);class tn{constructor(C=Mr,P=Tt){this.logLevel=C,this.loggerInstance=P}debug(C){var P,H;this.logLevel>se.DEBUG||(H=(P=this.loggerInstance).debug)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"debug"}))))}info(C){var P,H;this.logLevel>se.INFO||(H=(P=this.loggerInstance).info)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"info"}))))}warn(C){var P,H;this.logLevel>se.WARN||(H=(P=this.loggerInstance).warn)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"warn"}))))}error(C){var P,H,{err:X}=C,te=Rt(C,["err"]);this.logLevel>se.ERROR||(H=(P=this.loggerInstance).error)===null||H===void 0||H.call(P,Object.assign({err:X},te))}}class wn{constructor(C,P){this.logger=C,this.scope=P}debug(C){var P,H;(H=(P=this.logger).debug)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}info(C){var P,H;(H=(P=this.logger).info)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}warn(C){var P,H;(H=(P=this.logger).warn)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}error(C){var P,H,{err:X}=C,te=Rt(C,["err"]);(H=(P=this.logger).error)===null||H===void 0||H.call(P,Object.assign(Object.assign({err:X},te),{scope:this.scope}))}unwrap(){return this.logger}}class Zn{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(C){(this.min===0||C<this.min)&&(this.min=C),C>=this.max&&(this.max=C),this.data.push(C),this.sum+=C}median(){this.data.sort();const C=this.data.length>>1;return this.data.length%2==0?this.data[C-1]+this.data[C]>>1:this.data[C]}percentile(C){if(this.data.length===0)return 0;if(C<=0)return this.data[0];if(C>=1)return this.data[this.data.length-1];const P=(this.data.length-1)*C,H=Math.floor(P),X=H+1,te=P%1;return X>=this.data.length?this.data[H]:this.data[H]*(1-te)+this.data[X]*te}}var Ci=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class al{constructor(C,P,H,X){this.peerClient=C,this.broadcastCanvasManager=P,this.analyticsTracker=X,this.logger=new wn(H,_e.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval((()=>{this.collectSamples()}),1e3),this.trackSamplesTimerId=window.setInterval((()=>{this.trackSamples()}),3e4),this.trackPeerConnectionStatsTimerId=window.setInterval((()=>{this.trackPeerConnectionStats()}),6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return Ci(this,void 0,void 0,(function*(){(yield this.peerClient.getReports()).forEach((C=>{if(C.type==="outbound-rtp")switch(C.kind){case"audio":this.analyticsTracker.trackEvent(new Zu(C));break;case"video":{const P=new tg(C),H=new Rd(C,this.startTimestamp);this.analyticsTracker.batchEvents([P,H]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:C.kind})}}))}))}collectSamples(){return Ci(this,void 0,void 0,(function*(){let C=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach((H=>{switch(H.type){case"candidate-pair":H.nominated&&(this.rttSamples.push(H.currentRoundTripTime),this.recommendedBitrateSamples.push(H.availableOutgoingBitrate));break;case"outbound-rtp":C+=H.bytesSent||0,this.startTimestamp===0&&H.kind==="video"&&(this.startTimestamp=H.timestamp)}}));const P=8*Math.round(C-this.previousBytesSent);this.previousBytesSent=C,this.measuredBitrateSamples.push(P)}))}trackSamples(){const P=new lp(this.audioLatencySamples,30),H=new jh(this.videoLatencySamples,30),X=new ah(this.congestionTimeSamples,30),te=new $l(this.measuredBitrateSamples,30),ue=new Kp(this.recommendedBitrateSamples,30),Ee=new Xu(this.rttSamples,30);this.analyticsTracker.batchEvents([P,H,X,te,ue,Ee]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new Zn,this.videoLatencySamples=new Zn,this.congestionTimeSamples=new Zn,this.measuredBitrateSamples=new Zn,this.recommendedBitrateSamples=new Zn,this.rttSamples=new Zn}}const _r={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},Eo="connectionStateChange",wf="sdpNegotiated",rs="clientError",Mc="seiMessageReceived",lh="transformError";var sr;(function(j){j.CLOSED="closed",j.COMPLETED="completed",j.CONNECTED="connected",j.CONNECTING="connecting",j.DISCONNECTED="disconnected",j.FAILED="failed",j.IDLE="idle",j.NEW="new",j.NONE="none"})(sr||(sr={}));const Oc=j=>{const C=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("web-contents-media-stream")?"tab":void 0},P=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("window")&&te.displaySurface==="window"?"window":void 0},H=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("screen")&&te.displaySurface==="monitor"?"screen":void 0};return(C(X=j)||P(X)||H(X)?void 0:"camera")||H(j)||P(j)||C(j)||"unknown";var X};function Ia(j,C){return j.find((P=>P.kind===C))}function vr(j){return j?.readyState==="live"}var Gr;(function(j){j.VIDEO="video",j.AUDIO="audio"})(Gr||(Gr={}));class ch{constructor(){this.mediaTracks=new Map([[Gr.VIDEO,void 0],[Gr.AUDIO,void 0]])}setTrack(C,P){this.mediaTracks.set(C,P)}getTrack(C){return this.mediaTracks.get(C)}}class Rf{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(C){return C?(C.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map((P=>P.trim())).filter(Boolean).forEach((P=>{const H=P.split("=");if(H.length===2)switch(H[0]){case"level-asymmetry-allowed":H[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":H[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(H[1]),this.level=this.getLevelFromId(H[1])}})),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(C){const P=C.substr(0,2),H=C.substr(2,2);switch(P.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return H==="00"?"high 10":"high 10 intra";case"7a":return H==="00"?"high 42":"high 42 intra";case"f4":return H==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(C){return parseInt(C.substr(4,2),16)}}function Q0(j){return btoa(JSON.stringify(j))}var Wl,rg=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};(function(j){j.IDLE="idle",j.EXECUTING="executing",j.RECONNECTING="reconnecting"})(Wl||(Wl={}));class xo{constructor(C,P=12e4,H,X){this.state=Wl.IDLE,this.failureCallback=()=>{},this.peerClient=C,this.timeout=P,this.logger=H,this.emitter=X}onFailure(C){this.failureCallback=C}setStartConfig(C,P){this.ingestEndpoint=C,this.streamKey=P}execute(){const{id:C}=this;this.state===Wl.IDLE&&(this.state=Wl.EXECUTING,this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:C}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(C){this.timeoutTimerId=window.setTimeout((()=>{this.state!==Wl.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.FAILED),this.failureCallback())}),C)}stop(){this.state=Wl.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return rg(this,void 0,void 0,(function*(){if(this.ingestEndpoint&&this.streamKey){const C=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),C===sr.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(P){throw this.logger.error({err:P}),P}}}))}isActive(){return this.state!==Wl.IDLE}}class jo extends xo{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let C=5e3;const P=()=>rg(this,void 0,void 0,(function*(){if(this.state===Wl.EXECUTING)try{this.state=Wl.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:C}),this.state=Wl.EXECUTING,this.currentTimeoutId=window.setTimeout(P,C),C*=2}}));this.currentTimeoutId=window.setTimeout(P,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class xu extends xo{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>rg(this,void 0,void 0,(function*(){if(navigator.onLine&&this.state===Wl.EXECUTING){this.state=Wl.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=Wl.EXECUTING}}}))}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class Zg{static create(C,P=cs,H,X){const{reconnect:te,timeout:ue}=P;if(te){const Ee=Xp.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(Ee)&&navigator.connection?new xu(C,ue,H,X):new jo(C,ue,H,X)}}}var Tu,uh=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Zp=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};const fh=j=>!!j;function Af(j){if(!j)throw new Error("PeerConnection is not defined")}const Kc={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class Vi{constructor(C,P,H,X,te){this.config=C,this.emitter=P,this.mediaStreamManager=H,this.analyticsTracker=te,this.establishConnection=(ue,Ee)=>uh(this,void 0,void 0,(function*(){var w,d,b;Af(this.peerConnection);try{const O=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(O),yield this.sendSetupRequest(ue,Ee,O)}catch(O){if(O instanceof Error){(w=(b=O).code)!==null&&w!==void 0||(b.code=Bn.code);const F=new we(Object.assign(Object.assign({},Bn),{name:O.name,message:O.message,code:O?.code,cause:O}));throw!((d=this.reconnectStrategy)===null||d===void 0)&&d.isActive()||this.handleError(O.code,O.message),this.stop(),F}}})),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var ue;if(!this.peerConnection)return sr.NONE;const Ee=(ue=this.reconnectStrategy)===null||ue===void 0?void 0:ue.isActive(),w=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(w){case"new":return sr.NEW;case"closed":return sr.CLOSED;case"disconnected":return Ee?sr.CONNECTING:sr.DISCONNECTED;case"failed":return Ee?sr.CONNECTING:sr.FAILED;case"idle":return sr.IDLE;case"checking":case"connecting":return sr.CONNECTING;case"completed":case"connected":return sr.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:w}),sr.IDLE}},this.onConnectionStateChange=()=>{var ue;const Ee=this.getConnectionState();switch(Ee){case sr.CONNECTED:{this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee);const w=new Date;this.analyticsTracker.trackEvent(new Qm(w,this.connectionStartDate,this.ingestSessionId));const d=this.mediaStreamManager.getTrack(Gr.AUDIO),b=this.mediaStreamManager.getTrack(Gr.VIDEO);if(b){const O=b.getSettings();this.analyticsTracker.trackEvent(new $_(O))}if(d){const O=d.getSettings();this.analyticsTracker.trackEvent(new eg(O))}(((ue=this.peerConnection)===null||ue===void 0?void 0:ue.getSenders())||[]).forEach((O=>{var F;(((F=O.getParameters())===null||F===void 0?void 0:F.codecs)||[]).forEach((ie=>{var pe;switch((pe=O.track)===null||pe===void 0?void 0:pe.kind){case"video":{if(!b)break;const ye=new Rf().extractVideoSdpFmtpLine(ie.sdpFmtpLine),Re=b.getSettings();this.analyticsTracker.trackEvent(new G_(Re,ye,ie));break}case"audio":if(!d)break;this.analyticsTracker.trackEvent(new sl(ie))}}))}));break}case sr.CONNECTING:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case sr.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.handleTerminalConnectionFailure());break;case sr.DISCONNECTED:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee)}},this.handleLocalDescription=ue=>uh(this,void 0,void 0,(function*(){var Ee;return(Ee=this.peerConnection)===null||Ee===void 0?void 0:Ee.setLocalDescription(ue)})),Tu.set(this,(ue=>{if(typeof ue!="string")throw new we(os);try{new URL(ue)}catch{throw new we(gi)}})),this.logger=new wn(X,_e.WEBRTC),this.createReconnectStrategy(C)}start(C,P){var H;return uh(this,void 0,void 0,(function*(){Zp(this,Tu,"f").call(this,C);const X=[this.mediaStreamManager.getTrack(Gr.VIDEO),this.mediaStreamManager.getTrack(Gr.AUDIO)].filter(fh);if(this.createPeerConnection(),this.addTracks({tracks:X}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(C,P),yield this.establishConnection(C,P),!((H=this.reconnectStrategy)===null||H===void 0)&&H.isActive()){const te=new URL(C);this.analyticsTracker.trackEvent(new Hh({protocol:"webrtc",hostname:te.hostname,port:te.port},wa.NETWORK_DISCONNECT))}}))}stop(){var C,P,H,X;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[sr.NEW,sr.CONNECTING,sr.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.CLOSED),(C=this.peerConnection)===null||C===void 0||C.close(),(P=this.peerConnection)===null||P===void 0||P.removeEventListener("connectionstatechange",this.onConnectionStateChange),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(X=this.reconnectStrategy)===null||X===void 0||X.stop()}addTracks(C){var P;if(Af(this.peerConnection),!C)return;const H=this.peerConnection.getSenders().map((te=>{var ue;return(ue=te.track)===null||ue===void 0?void 0:ue.id})),X=C.tracks.filter((te=>!H.includes(te.id)));for(const te of X)(P=this.peerConnection)===null||P===void 0||P.addTrack(te)}getReports(){var C;return uh(this,void 0,void 0,(function*(){try{const P=(yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats())||[],H=[];return P.forEach((X=>{H.push(X)})),H}catch{return[]}}))}sendSetupRequest(C,P,H){var X;return uh(this,void 0,void 0,(function*(){const te=yield fetch(`${C}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:Q0(H),streamKey:P},this.config.streamConfig))});if(!te.ok)throw(function(Ee){let w=new we(Object.assign({},Bn));return Ee?.code===1007&&(w=new we(Object.assign({},In))),Ee?.message&&(w.message=Ee.message),w})(yield te.json());const ue=yield te.json();ue?.answer&&(yield(X=this.peerConnection)===null||X===void 0?void 0:X.setRemoteDescription((function(Ee){return JSON.parse(atob(Ee))})(ue.answer)),this.ingestSessionId=ue.ingestSessionId)}))}handleTerminalConnectionFailure(){const C=new we(cn);this.handleError(C.code,C.message)}handleError(C,P){this.analyticsTracker.trackEvent(new Tf({code:C,description:P,isFatal:!0})),this.emitter.emit(_r.ERROR,{code:C,message:P})}createPeerConnection(){var C;const P=this.getConnectionState(),H=P!==sr.NONE,X=P!==sr.CLOSED,te=(C=this.reconnectStrategy)===null||C===void 0?void 0:C.isActive();H&&X&&!te||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval((()=>{const ue=this.getConnectionState();if(this.reconnectStrategy&&ue===sr.DISCONNECTED&&this.disconnectionStartDate){const Ee=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:Ee}),Ee>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else ue===sr.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)}),1e3),this.peerConnection=new RTCPeerConnection(Kc),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(C){if(this.reconnectStrategy=Zg.create(this,C.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const P=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:P})}}}Tu=new WeakMap;var wu,W_,Y_=i(5364);(function(j){j.CONFIG="config",j.UPDATE="update",j.START="start",j.STOP="stop"})(wu||(wu={})),(function(j){j.VIDEO_SEND="video/send",j.VIDEO_RECEIVE="video/receive",j.INSERT_SEI="insertSei"})(W_||(W_={}));var ig=i(5512),kc=i.n(ig);function Ad(){return kc()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var i,t;!function(i){i.CONFIG="config",i.UPDATE="update",i.START="start",i.STOP="stop"}(i||(i={})),function(i){i.VIDEO_SEND="video/send",i.VIDEO_RECEIVE="video/receive",i.INSERT_SEI="insertSei"}(t||(t={}));const s=self;const n=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(i){this.config=Object.assign(Object.assign({},this.config),i),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{s.postMessage({type:i.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};s.addEventListener("message",(function(t){var s;if(null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.type)switch(t.data.type){case i.CONFIG:n.setConfig(t.data.payload||{});break;case i.START:n.start();break;case i.STOP:n.stop()}}))})();`,"Worker",void 0,void 0)}var fo=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class Cf{constructor(C,P,H){this.config=C,this.mediaStreamManager=P,this.analyticsTracker=H,this.handleWorkerEvent=Ee=>{var w;((w=Ee.data)===null||w===void 0?void 0:w.type)===wu.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new Ad,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const X=this.compositeEl.getContext("2d");if(X===null)throw new we(Object.assign({},st));this.compositeContext=X,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const te=Ia(this.compositeStream.getTracks(),Gr.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const ue=Ia(this.audioDestination.stream.getTracks(),Gr.AUDIO);te&&this.mediaStreamManager.setTrack(Gr.VIDEO,te),ue&&this.mediaStreamManager.setTrack(Gr.AUDIO,ue),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:wu.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(C){this.previewElement=C;const{width:P,height:H}=this.config.streamConfig.maxResolution;this.previewElement.width=P,this.previewElement.height=H,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const C=this.audioContext.createConstantSource(),P=this.audioContext.createGain();P.gain.value=.001,C.connect(P),P.connect(this.audioDestination),C.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const C=document.body,P=["touchstart","touchend","mousedown","keydown"],H=()=>{P.forEach((te=>{C.removeEventListener(te,X)}))},X=()=>{this.audioContext.resume().then(H)};P.forEach((te=>{C.addEventListener(te,X,!1)}))}getTracks(){return[this.mediaStreamManager.getTrack(Gr.VIDEO),this.mediaStreamManager.getTrack(Gr.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(Gr.VIDEO)}getAudioInputDevice(C){if(typeof C!="string")return;const P=this.mixer.audio.find((H=>{if(H.name===C)return H.source}));return P?.source}getVideoInputDevice(C){if(typeof C=="string")return this.mixer.video.find((P=>P.name===C))}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(C,P,H){var X;return fo(this,void 0,void 0,(function*(){if(typeof C!="object")throw new we(Object.assign({},Ze));if(!P||typeof P!="string")throw new we(Object.assign({},ht));if(this.mixer.video.some((F=>F.name===P)))throw new we(Object.assign({},nt));if(!H)throw new we(Object.assign({},vt));if(typeof H.index!="number")throw new we(Object.assign({},Je));const te=(function(){const F=document.createElement("video");return F.autoplay=!0,F.muted=!0,F.setAttribute("playsinline",""),F.setAttribute("webkit-playsinline",""),F})(),ue=C.getVideoTracks(),[Ee]=ue;if(!ue.length)throw new we(Object.assign({},Ve));const w=Ee.getConstraints(),d=Y_({},w,{frameRate:this.config.streamConfig.maxFramerate});try{yield Ee.applyConstraints(d)}catch(F){let ie="Unknown constraints error";F instanceof Error&&(ie=F.message),this.analyticsTracker.trackEvent(new Tf({description:`${ft.message}: ${ie}`,isFatal:!1,code:ft.code}))}const b=()=>fo(this,void 0,void 0,(function*(){let F=0;for(;F<5;)try{return void(yield te.play())}catch(ie){if(!(ie instanceof Error))throw new Error("unknown error trying to add video to broadcast");F++,yield new Promise((pe=>setTimeout(pe,150)))}throw new Error("Error playing video, tries exceeded")})),O=new MediaStream([Ee]);te.srcObject=O;try{yield b();const F={name:P,element:te,position:H,source:O,render:!0},ie=((X=Ee.getSettings)===null||X===void 0?void 0:X.call(Ee))||{};this.analyticsTracker.trackEvent(new oh(Oc(ie),ie)),this.mixer.video.push(F)}catch(F){throw new we(Object.assign(Object.assign({},Ve),{cause:F}))}}))}addImageSource(C,P,H){var X;return fo(this,void 0,void 0,(function*(){if(!C)throw new we(Object.assign({},Ze));if(!P||typeof P!="string")throw new we(Object.assign({},ht));if(C.tagName==="image")throw new we(Object.assign({},mt));if(this.mixer.video.some((ue=>ue.name===P)))throw new we(Object.assign({},nt));if(!H)throw new we(Object.assign({},vt));if(typeof H.index!="number")throw new we(Object.assign({},Je));if(C instanceof Image){const ue=(X=C.src)===null||X===void 0?void 0:X.slice();try{const Ee=C.src?new URL(C.src):{};if(Ee.host&&Ee.hostname){const w=yield fetch(C.src).then((b=>fo(this,void 0,void 0,(function*(){return b.blob()})))),d=yield new Promise((b=>{const O=new FileReader;O.onload=()=>{b(O.result)},O.readAsDataURL(w)}));C.src=d}}catch{throw new we(Object.assign(Object.assign({},fn),{params:{details:`Image URL: ${ue}`}}))}}const te={name:P,element:C,position:H,render:!0};this.mixer.video.push(te)}))}addAudioInputDevice(C,P){return fo(this,void 0,void 0,(function*(){if(typeof C!="object")throw new we(Object.assign({},Ze));if(!P||typeof P!="string")throw new we(Object.assign({},ht));if(this.mixer.audio.some((Ee=>Ee.name===P)))throw new we(Object.assign({},nt));const H=C.getAudioTracks();if(!H.length)throw new we(Object.assign({},tt));const X=this.audioContext.createMediaStreamSource(new MediaStream(H)),te=this.audioContext.createGain();te.gain.value=1,X.connect(te),te.connect(this.audioDestination);const ue={name:P,source:C,audioTrackSource:X,gainNode:te};this.analyticsTracker.trackEvent(new oh("audio",{deviceId:C.id})),this.mixer.audio.push(ue)}))}removeImage(C){const P=this.mixer.video.findIndex((H=>H.name===C));if(P<0)throw new we(Object.assign({},gn));this.mixer.video.splice(P,1)}removeVideoInputDevice(C){var P;const H=this.removeDevice(C,this.mixer.video);if(!H)throw new we(Object.assign({},_t));{const X=Ia(H.source.getTracks(),Gr.VIDEO);if(!X)throw new we(Object.assign({},_t));H.element.srcObject=null,X.stop();const te=((P=X?.getSettings)===null||P===void 0?void 0:P.call(X))||{};this.analyticsTracker.trackEvent(new zo(Oc(te),te))}}removeAudioInputDevice(C){const P=this.removeDevice(C,this.mixer.audio);if(P?.audioTrackSource){for(const H of P.source.getTracks())H.stop(),this.analyticsTracker.trackEvent(new zo("audio",{deviceId:H.id}));P.gainNode.disconnect(this.audioDestination)}else if(!P)throw new we(Object.assign({},_t))}updateVideoDeviceComposition(C,P){if(!C||typeof C!="string")throw new we(Object.assign({},Yt));if(!P)throw new we(Object.assign({},_n));if(typeof P.index!="number")throw new we(Object.assign({},Bt));this.mixer.video.forEach(((H,X)=>{H.name===C&&(H.position=P)}))}exchangeVideoDevicePositions(C,P){const H=this.getVideoInputDevice(C),X=this.getVideoInputDevice(P);if(!H)throw new we(Object.assign(Object.assign({},Mt),{params:{details:`device with name: "${C}" not found`}}));if(!X)throw new we(Object.assign(Object.assign({},Mt),{params:{details:`device with name: "${P}" not found`}}));const te=Object.assign({},H.position),ue=Object.assign({},X.position);for(const Ee of this.mixer.video)Ee.name===C&&(Yl(ue.x)?Ee.position=Object.assign(Object.assign({},Ee.position),ue):Ee.position={index:ue.index}),Ee.name===P&&(Yl(te.x)?Ee.position=Object.assign(Object.assign({},Ee.position),te):Ee.position={index:te.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:wu.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:wu.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var C;return((C=this.mediaStreamManager.getTrack(Gr.VIDEO))===null||C===void 0?void 0:C.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach((C=>{C.render=!1}))}enableVideo(){this.mixer.video.forEach((C=>{C.render=!0}))}disableAudio(){this.mixer.audio.forEach((C=>{C.audioTrackSource&&(C.gainNode.gain.value=0)}))}enableAudio(){this.mixer.audio.forEach((C=>{C.audioTrackSource&&(C.gainNode.gain.value=1)}))}getDrawRegion(C,P,H){var X,te,ue,Ee;let w=(X=C.position.x)!==null&&X!==void 0?X:0,d=(te=C.position.y)!==null&&te!==void 0?te:0;const b=(ue=C.position.width)!==null&&ue!==void 0?ue:P-w,O=(Ee=C.position.height)!==null&&Ee!==void 0?Ee:H-d,F=b/O;let ie=C.element.width,pe=C.element.height;C.element instanceof HTMLVideoElement&&(ie=C.element.videoWidth,pe=C.element.videoHeight);const ye=ie/pe;let Re=b,Pe=O;return ye>F?(Re=b,Pe=2*Math.round(b/ye/2),d+=(O-Pe)/2):ye<F&&(Pe=O,Re=2*Math.round(O*ye/2),w+=(b-Re)/2),{x:w,y:d,width:Re,height:Pe}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const C=this.mixer.video.filter((P=>P.render));C.sort(((P,H)=>P.position.index-H.position.index));for(const P of C){const{x:H,y:X,width:te,height:ue}=this.getDrawRegion(P,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(P.element,H,X,te,ue)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(Gr.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(C,P){const H=P.findIndex((X=>(te=>te.name===C)(X)));if(!(H<0))return P.splice(H,1)[0]}shouldMix(C){if(C.getTime()<this.nextMix)return!1;for(;this.nextMix<=C.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function Yl(j){return Number.isSafeInteger(j)}var sg,Jg,vi=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Ki=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};class ag{constructor(C){this.config=C,sg.add(this),this.emitter=new ei,this.isValid=!0,this.emitter.on(_r.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new sh,this.mediaStreamManager=new ch;const P=new tn(C.logLevel,C.logger);this.peerClient=new Vi(this.config,this.emitter,this.mediaStreamManager,P,this.analyticsTracker),this.broadcastCanvasManager=new Cf(C,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new al(this.peerClient,this.broadcastCanvasManager,P,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(ag.prototype).forEach((H=>{this[H]=new Proxy(this[H],{apply:(X,te,ue)=>{if(!te.isValid)throw new we(Object.assign({},_i));return Reflect.apply(X,te,ue)}})})),window.addEventListener("beforeunload",(()=>{this.analyticsTracker.stop(!0)}))}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(C,P){return vi(this,void 0,void 0,(function*(){Ki(this,sg,"m",Jg).call(this,C);const H=Bo(P||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(H,C),this.emitter.emit(_r.ACTIVE_STATE_CHANGE,!0),this.url=new URL(H),this.url&&this.analyticsTracker.trackEvent(new Hh({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},wa.USER_INITIATED))}))}stopBroadcast(){var C,P,H;this.url&&this.analyticsTracker.trackEvent(new Ku({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(C=this.peerStatsTracker)===null||C===void 0||C.stop(),(P=this.peerClient)===null||P===void 0||P.stop(),(H=this.emitter)===null||H===void 0||H.emit(_r.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(C,P,H){return vi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addVideoInputDevice(C,P,H)}))}addImageSource(C,P,H){return vi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addImageSource(C,P,H)}))}addAudioInputDevice(C,P){return vi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addAudioInputDevice(C,P)}))}removeVideoInputDevice(C){this.broadcastCanvasManager.removeVideoInputDevice(C)}removeAudioInputDevice(C){this.broadcastCanvasManager.removeAudioInputDevice(C)}removeImage(C){this.broadcastCanvasManager.removeImage(C)}updateVideoDeviceComposition(C,P){this.broadcastCanvasManager.updateVideoDeviceComposition(C,P)}exchangeVideoDevicePositions(C,P){this.broadcastCanvasManager.exchangeVideoDevicePositions(C,P)}getAudioInputDevice(C){return this.broadcastCanvasManager.getAudioInputDevice(C)}getVideoInputDevice(C){return this.broadcastCanvasManager.getVideoInputDevice(C)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(C,P){this.emitter.on(C,P)}off(C,P){this.emitter.off(C,P)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(C){this.broadcastCanvasManager.attachPreview(C)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function hh(j){return new ag((function(C){const P=new us;return P.streamConfig=C.streamConfig,P.ingestEndpoint=C.ingestEndpoint,P.logger=C.logger,P.logLevel=C.logLevel,P.networkReconnectConfig=C.networkReconnectConfig,P})(j))}sg=new WeakSet,Jg=function(j){if(typeof j!="string"||!/^[a-zA-Z0-9_-]+$/.test(j))throw new we(ls)};const up="1.27.0";var Fn,js=i(2543);(function(j){j.PUBLISH="publish",j.SUBSCRIBE="subscribe",j.JOIN="join",j.LEAVE="leave"})(Fn||(Fn={}));const Mf=2,To="X-Stages-Options",Rl="cap";class Ju extends ur{constructor(C){super(Xn.LEAVE,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.LEAVE,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint,reason:C.reason}),this.critical=!0}}function Of(j){const C="0123456789abcdef";let P="";for(let H=0;H<j;H+=1)P+=C.charAt(Math.floor(16*Math.random()));return P}class Ic{constructor(){const C=Of;this.value=`${C(8)}-${C(4)}-${C(4)}-${C(4)}-${C(12)}`}}function As(){return new Ic}class Qg{constructor(){const C=(Date.now()/1e3|0).toString(16);this.value=`1-${C}-${Of(24)}`}}function Ks(){return new Qg}var e_,Al,fp,Ho=i(2505),fc=i.n(Ho);(function(j){j.MESSAGE="message",j.RESPONSE="response"})(e_||(e_={})),(function(j){j.STAGE_DELETED="STAGE_DELETED",j.PARTICIPANT_DISCONNECTED="PARTICIPANT_DISCONNECTED",j.TOKEN_INVALID="TOKEN_INVALID",j.TOKEN_EXPIRED="TOKEN_EXPIRED",j.TOKEN_INVALID_SIGNATURE="TOKEN_INVALID_SIGNATURE",j.TOKEN_MISSING="TOKEN_MISSING",j.INTERNAL="INTERNAL",j.BAD_REQUEST="BAD_REQUEST"})(Al||(Al={})),(function(j){j[j.BAD_REQUEST=400]="BAD_REQUEST",j[j.UNAUTHORIZED=401]="UNAUTHORIZED",j[j.FORBIDDEN=403]="FORBIDDEN",j[j.NOT_FOUND=404]="NOT_FOUND",j[j.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"})(fp||(fp={}));class Fr extends we{constructor({token:C,traceId:P,code:H,tag:X,location:te,message:ue,details:Ee,remoteParticipantId:w,requestUUID:d,fatal:b,nominal:O,action:F,count:ie=1}){super({name:"StageClientError",message:ue,code:H}),Error.captureStackTrace&&Error.captureStackTrace(this,Fr),this.action=F,this.token=C,this.traceId=P,this.code=H,this.tag=X,this.location=te,this.message=ue,this.details=Ee,this.remoteParticipantId=w,this.requestUUID=d,this.fatal=b,this.nominal=O,this.count=ie}}const ve="signalling_session",hc="webrtc_sink",eo="webrtc_unsink",Mi="webrtc_source";function kn(j,C){switch(j){case Fn.PUBLISH:return hc;case Fn.SUBSCRIBE:return`webrtc_source:${C}`;default:return"unknown"}}function ho(j,C){var P,H,X,te;const ue={code:j.code,message:`${j.message}: ${C.name} ${C.message}`,fatal:(P=j.fatal)!==null&&P!==void 0&&P,nominal:(H=j.nominal)!==null&&H!==void 0&&H};return C instanceof Fr&&(ue.fatal=(X=C.fatal)!==null&&X!==void 0&&X,ue.nominal=(te=C.nominal)!==null&&te!==void 0&&te),ue}function po(j,C){if(j===0)return hn.UNKNOWN_SERVER_ERROR;if(!(j<400))if(j>=400&&j<=403)switch(C){case Zi.TokenExpired:return hn.EXPIRED_TOKEN;case Zi.NoPermissions:return hn.TOKEN_PERMISSIONS_DENIED;case Zi.StageAtCapacity:return hn.STAGE_AT_CAPACITY;case Zi.NoMatchingCodec:return hn.NO_MATCHING_CODEC;default:return hn.UNKNOWN_SERVER_ERROR}else{if(j===404)return C===Zi.RemoteStreamNotFound?hn.REMOTE_STREAM_NOT_FOUND:hn.UNKNOWN_SERVER_ERROR;if(j===412)return C===Zi.AbortedMHCPError?hn.MHCP_ABORTED:hn.UNKNOWN_SERVER_ERROR;if(j===429)return C===Zi.StageAuthThrottled?hn.STAGE_AUTH_THROTTLED:hn.WHIP_TOO_MANY_REQUESTS;if(j!==500)return hn.UNKNOWN_SERVER_ERROR;switch(C){case Zi.InternalMHCPError:return hn.INTERNAL_MHCP_ERROR;case Zi.UnreachableMHCP:return hn.UNREACHABLE_MHCP;case Zi.InvalidSessionStatus:return hn.INVALID_SESSION_STATUS;default:return hn.INTERNAL_SERVER_ERROR}}}var Zi;(function(j){j[j.Unspecified=2001]="Unspecified",j[j.TokenExpired=2002]="TokenExpired",j[j.NoPermissions=2003]="NoPermissions",j[j.RemoteStreamNotFound=2004]="RemoteStreamNotFound",j[j.StageAtCapacity=2005]="StageAtCapacity",j[j.InternalMHCPError=2006]="InternalMHCPError",j[j.UncategorizedMHCPError=2007]="UncategorizedMHCPError",j[j.UnreachableMHCP=2008]="UnreachableMHCP",j[j.InvalidSessionStatus=2010]="InvalidSessionStatus",j[j.PostWithoutOptions=2011]="PostWithoutOptions",j[j.AbortedMHCPError=2012]="AbortedMHCPError",j[j.StageAuthThrottled=2013]="StageAuthThrottled",j[j.NoMatchingCodec=2014]="NoMatchingCodec"})(Zi||(Zi={}));const hn={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},STAGE_DELETED:{code:1037,message:"Stage has been deleted",fatal:!0,nominal:!0},PARTICIPANT_DISCONNECTED:{code:1038,message:"Participant has been disconnected",fatal:!0,nominal:!0},JOIN_SERVER_INTERNAL_ERROR:{code:1039,message:"Internal server error during join",fatal:!1,nominal:!1},JOIN_SERVER_BAD_REQUEST:{code:1040,message:"Bad request during join",fatal:!0,nominal:!1},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message"},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},SEI_INSERT_NOT_PUBLISHING_VIDEO:{code:1460,message:"SEI failed to insert due to not publishing video",fatal:!1,nominal:!0},SEI_INSERT_INBAND_NOT_ENABLED:{code:1461,message:"SEI failed to insert due to in-band messaging not being enabled",fatal:!1,nominal:!0},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var Ti;(function(j){j.UNPUBLISH="unpublish",j.UNSUBSCRIBE="unsubscribe",j.UNLOAD="unload",j.CONNECTION_FAIL="connection fail",j.REASSIGNMENT="reassignment"})(Ti||(Ti={}));const og="stageJoined",kf="stageParticipantJoined",If="stageParticipantLeft",lg="stageParticipantKicked",wo="stageParticipantUpdated",Nc="localPublishingChanged",_a="stageRefresh",hp="stateChange",Ro="error",Na="reassignmentRequest",dh="incompatibleCodecs",Cl="connectionStateChange",Hs="mediaStreamCreated",Ml="mediaStreamRemoved",Vh="error",Pc="stageStreamSeiMessageReceived",fs="transformError",dc="reassignmentStarted",Gh="reassignmentSuccess",Xl="reassignmentFailed",Ru="open",ai="closed",$h="messageParseError",Jp="refresh",Zs="error",Ao="stageStateMessage",Cs="sdpAnswer",ti="disconnectMessage",Dc="reassignmentMessage",yi="incompatibleCodecs",Wh="ssu";function Yh(j){return P=(function(H){return H.replace(/-/g,"+").replace(/_/g,"/").padEnd(H.length+(4-H.length%4)%4,"=")})(j),window.atob(P);var P}class X_{constructor(C,P){this.analyticsTracker=P,this.rawToken=C;const H=C.split(".");if(H.length!==3)throw Error(`Token format incorrect. length: ${H.length}`);try{this.header=JSON.parse(Yh(H[0]))}catch(ue){const Ee=ue instanceof Error?`: ${ue.message}`:"";throw Error(`Error parsing Stage Token header${Ee}`)}try{this.claims=JSON.parse(Yh(H[1]))}catch(ue){const Ee=ue instanceof Error?`: ${ue.message}`:"";throw Error(`Error parsing Stage Token claims${Ee}`)}this.signature=H[2];const{claims:X}=this;this.stageARN=X.resource,this.participantID=X.jti,this.eventsURL=X.events_url,this.whipURL=pa("whipUrl")||X.whip_url,this.userID=X.user_id,this.expirationTime=X.exp,this.topic=X.topic,this.parseVersionFlags(X.version);const{attributes:te}=X;te&&(this.attrGsRole=te.gs_role,this.attrGsSessionId=te.gs_session_id)}getPublishEndpoint(){let C="";return this.whipURL&&this.participantID&&(C=`${this.whipURL}/publish/${this.participantID}`),C}getSubscribeEndpoint(C){let P="";return this.whipURL&&(P=`${this.whipURL}/subscribe/${C}`),P}assertTokenIsUnexpired(C,P,H,X){ma("disableTokenValidation")||(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new Fr(Object.assign(Object.assign({},hn.EXPIRED_TOKEN),{action:Fn.JOIN,location:H,tag:P,token:this,traceId:C,remoteParticipantId:X,message:hn.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(C){if(!C)return;const P=C.split(".");P.length===2&&(this.versionFlags=parseInt(P[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||!!(this.versionFlags&Mf)}}function Cd(j,C){return new X_(j,C)}class ol{constructor(C,P){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=C,this.trailing=!(P&&P.skipTrailing)}invoke(C,...P){return this.throttled?(this.trailingFn=C,this.trailingFnArgs=P,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),C(...P),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}var Jn=i(8954);class Pi extends ur{constructor(C,P,H,X,te,ue,Ee,w){super(Xn.SERVER_REQUEST,P,Ee,!0),Object.assign(this.properties,{action:C,http_method:X,remote_participant_id:ue,request_uuid:te,url:H,transport:w})}}const Zc="draft-ietf-wish-whip-04";var mo,Nf=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Jc(j,C){return Nf(this,void 0,void 0,(function*(){j.validateStatus=H=>H>=200&&H<300||H===403;const P=yield fc()(j);if(P.status===403){if(P.data.code===2003)throw new Ho.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",j,P.request,P);return j.url===P.request.responseURL?(j.validateStatus=H=>H>=200&&H<300,fc()(j)):(j.url=P.request.responseURL,C<5?Jc(j,C+1):(j.validateStatus=H=>H>=200&&H<300,fc()(j)))}return P}))}function ph(j){return Nf(this,void 0,void 0,(function*(){return Jc(j,0)}))}function Qc(){}function Qp(j){switch(j){case"new":return sr.NEW;case"closed":return sr.CLOSED;case"disconnected":return sr.DISCONNECTED;case"failed":return sr.FAILED;case"idle":return sr.IDLE;case"checking":case"connecting":return sr.CONNECTING;case"completed":case"connected":return sr.CONNECTED;default:throw new Error(`unknown connecion state: ${j}`)}}function Md(j,C,P){let H=document.createElement(C);const X=()=>{H&&(H.removeEventListener("loadeddata",te),H.removeEventListener("error",X),H.srcObject=null,H.src="",H=null)},te=()=>{X(),P(C)};return H.addEventListener("loadeddata",te),H.addEventListener("error",X),H.srcObject=j,X}class Co extends ur{constructor(C,P,H,X,te){super(Xn.TRACE,C,P,!1),Object.assign(this.properties,{action:X,message:H,remote_participant_id:te})}}class Xh extends ur{constructor(C,P,H,X,te){super(Xn.CONNECTION_STATE,P,H,!1),Object.assign(this.properties,{action:C,remote_participant_id:te,state:X})}}class Qu extends ur{constructor(C,P,H,X,te){super(Xn.ICE_GATHERING_STATE,P,H,!1),Object.assign(this.properties,{action:C,remote_participant_id:te,state:X})}}(function(j){j.POST="post",j.CONNECTED="connected",j.ICE_GATHERING="icegathering",j.SDP_EXCHANGE="sdpExchange",j.SET_REMOTE_DESC="setRemoteDesc",j.PEER_CONNECTION="peerConnection"})(mo||(mo={}));const Pa="start",Kh="stop";class dp{constructor(C,P){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=C,this.traceId=P}markActionStart(){this.markStart(mo.CONNECTED)}markPostStart(){this.markStart(mo.POST)}markPostStop(){this.markStop(mo.POST),this.postDuration=this.measure(mo.POST)}markIceGatheringStart(){this.markStart(mo.ICE_GATHERING)}markIceGatheringStop(){this.markStop(mo.ICE_GATHERING),this.timeToCandidate=this.measure(mo.ICE_GATHERING)}markActionStop(){this.markStop(mo.CONNECTED),this.timeToConnected=this.measure(mo.CONNECTED),this.markStop(mo.PEER_CONNECTION),this.peerConnectionDuration=this.measure(mo.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(mo.SET_REMOTE_DESC)}markSetRemoteDescStop(){const C=mo.SET_REMOTE_DESC;this.markStop(C),this.setRemoteDescDuration=this.measure(C),this.markStart(mo.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(mo.SDP_EXCHANGE)}markSdpExchangeStop(){const C=mo.SDP_EXCHANGE;this.markStop(C),this.sdpExchangeDuration=this.measure(C)}setTransport(C){this.sdpExchangeTransport=C}markStart(C){this.marks[`${this.namespace}.${C}.${Pa}`]=performance.now()}markStop(C){this.marks[`${this.namespace}.${C}.${Kh}`]=performance.now()}measure(C){const P=`${this.namespace}.${C}.${Pa}`,H=`${this.namespace}.${C}.${Kh}`,X=this.marks[P],te=this.marks[H];return X===void 0||te===void 0?0:te-X}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:C,postDuration:P,timeToCandidate:H,timeToConnected:X,sdpExchangeDuration:te,sdpExchangeTransport:ue,setRemoteDescDuration:Ee,peerConnectionDuration:w}=this;return{optionsDuration:C,postDuration:P,timeToCandidate:H,timeToConnected:X,sdpExchangeDuration:te,sdpExchangeTransport:ue,setRemoteDescDuration:Ee,peerConnectionDuration:w}}resetMeasurements(C){this.traceId=C,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var ef,mh,Ur,yr,ll;(function(j){j.VIDEO="video",j.AUDIO="audio"})(ef||(ef={})),(function(j){j.LOWEST_QUALITY="lowest_quality",j.HIGHEST_QUALITY="highest_quality"})(mh||(mh={})),(function(j){j.HI="hi",j.MID="mid",j.LOW="low"})(Ur||(Ur={})),(function(j){j.PORTRAIT="portrait",j.LANDSCAPE="landscape"})(yr||(yr={})),(function(j){j.DEFAULT="default",j.LOW="low",j.MEDIUM="medium",j.HIGH="high"})(ll||(ll={}));var Kl=i(7363);class wi{constructor(C){this.sdp=C}static splitLines(C){return C.trim().split(`
`).map((P=>P.trim()))}static splitSections(C){return C.split(`
m=`).map(((P,H)=>(H>0?`m=${P}`:P).trim()+wi.CRLF))}getUniqueRtpHeaderExtensionId(C){const P=[];for(const X of C)if(/^a=extmap:/.test(X.trim())){const te=+X.split("a=extmap:")[1].split(" ")[0];P.includes(te)||P.push(te)}P.sort(((X,te)=>X-te));let H=0;for(const X of P){if(X-H>1)return H+1;H=X}return H===14?-1:H+1}withVideoLayersAllocationRtpHeaderExtension(C){const P="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",H=C?C.getRtpHeaderExtensionId(P):-1,X=H===-1?this.getUniqueRtpHeaderExtensionId(wi.splitLines(this.sdp)):H,te=wi.splitSections(this.sdp),ue=[];for(let w of te){if(/^m=video/.test(w)&&wi.getRtpHeaderExtensionIdInSection(w,P)===-1){const d=wi.splitLines(w),b=[];if(X===-1||this.hasRtpHeaderExtensionId(X)){ue.push(w);continue}for(const O of d)if(b.push(O),/^a=sendrecv/.test(O.trim())){const F=`a=extmap:${X} ${P}`;b.push(F)}w=b.join(wi.CRLF)+wi.CRLF}else if(H!==-1&&/^m=video/.test(w)&&wi.getRtpHeaderExtensionIdInSection(w,P)!==H){const d=wi.splitLines(w),b=[];for(const O of d){if(/^a=extmap:/.test(O.trim())&&O.split("a=extmap:")[1].split(" ")[1]===P){if(!this.hasRtpHeaderExtensionId(H)){const F=`a=extmap:${H} ${P}`;b.push(F)}continue}b.push(O)}w=b.join(wi.CRLF)+wi.CRLF}ue.push(w)}const Ee=ue.join("");return new wi(Ee)}withOpusAudioConfig(C,P){const H=Kl.qg(this.sdp);for(const X of H.media)if(X.type==="audio"){const{payload:te}=X.rtp.find((d=>d.codec==="opus"));if(!te)continue;let ue=X.fmtp.find((d=>d.payload===te));ue||(ue={payload:te,config:""});const Ee=Kl.Sl(ue.config);if(Ee.maxaveragebitrate=C,typeof P=="boolean"){const d=P?1:0;Ee["sprop-stereo"]=d,Ee.stereo=d}let w="";for(const d of Object.keys(Ee))w+=`${d}=${Ee[d]}; `;ue.config=w.trim()}return new wi(Kl.M9(H))}withoutAudioRtcpRSize(){var C;const P=Kl.qg(this.sdp);for(const H of P.media){if(H.type!=="audio")continue;const X=wl()!==void 0,te=(C=wl())!==null&&C!==void 0&&C;X&&(H.rtcpRsize=te?void 0:"rtcp-rsize")}return new wi(Kl.M9(P))}withFilteredCandidates(C){const P=Kl.qg(this.sdp);return P.media.forEach((H=>{const X=H.candidates;if(X){const te=X.filter((ue=>ue.transport===C));H.candidates=te}})),new wi(Kl.M9(P))}static getRtpHeaderExtensionIdInSection(C,P){const H=wi.splitLines(C);for(const X of H)if(/^a=extmap:/.test(X.trim())){const te=X.split("a=extmap:")[1].split(" "),ue=+te[0];if(te[1]===P)return ue}return-1}getRtpHeaderExtensionId(C){const P=wi.splitSections(this.sdp);for(const H of P)if(/^m=video/.test(H)){const X=wi.getRtpHeaderExtensionIdInSection(H,C);if(X!==-1)return X}return-1}hasRtpHeaderExtensionId(C){const P=wi.splitLines(this.sdp);for(const H of P)if(/^a=extmap:/.test(H.trim())&&+H.split("a=extmap:")[1].split(" ")[0]===C)return!0;return!1}hasAudioNacksEnabled(){var C,P,H;return((H=(P=((C=Kl.qg(this.sdp).media.filter((X=>X.type==="audio"))[0])!==null&&C!==void 0?C:{}).rtcpFb)===null||P===void 0?void 0:P.filter((X=>X.type==="nack")))!==null&&H!==void 0?H:[]).length>0}}function pp(j){const{config:C}=j;return[{maxBitrate:C.maxBitrateBps}]}wi.CRLF=`\r
`,wi.rfc7587LowestBitrate=6e3,wi.rfc7587HighestBitrate=51e4;function zr(j){return 1e3*j}const Ol=(j,...C)=>{const P=C.map((H=>typeof H!="object")).filter(Boolean).length>0;if(typeof j=="object"&&!P)return(0,js.merge)({},j,...C)},Da=j=>Od(j),Od=j=>(0,js.cloneDeep)(j),mp=j=>{switch(j){case mh.HIGHEST_QUALITY:return"highest";case mh.LOWEST_QUALITY:default:return"lowest"}},cl=j=>Object.freeze(j),Zl=Object.freeze({DEFAULT_1080:cl({maxBitrateKbps:2500,maxFramerate:30,width:1920,height:1080}),INACTIVE:cl({maxBitrateKbps:0,maxFramerate:0,width:0,height:0})}),Ha=Object.freeze({DEFAULT_720:cl({maxBitrateKbps:2500,maxFramerate:30,width:1280,height:720}),DEFAULT_540:cl({maxBitrateKbps:1400,maxFramerate:15,width:960,height:540}),DEFAULT_480:cl({maxBitrateKbps:1100,maxFramerate:15,width:854,height:480}),DEFAULT_360:cl({maxBitrateKbps:600,maxFramerate:15,width:640,height:360}),DEFAULT_270:cl({maxBitrateKbps:350,maxFramerate:15,width:480,height:270}),DEFAULT_180:cl({maxBitrateKbps:150,maxFramerate:15,width:320,height:180}),DEFAULT_160:cl({maxBitrateKbps:120,maxFramerate:15,width:284,height:160})}),ia=Object.freeze({HI:cl(Object.assign({},Ha.DEFAULT_720)),MID:cl(Object.assign(Object.assign({},Ha.DEFAULT_360),{maxBitrateKbps:700,maxFramerate:20})),LOW:cl(Object.assign(Object.assign({},Ha.DEFAULT_180),{maxBitrateKbps:200,maxFramerate:15}))}),Lc=j=>({rid:j,active:!1,scaleFactor:kd(j),maxBitrateBps:zr(Zl.INACTIVE.maxBitrateKbps),maxFramerate:Zl.INACTIVE.maxFramerate,width:Zl.INACTIVE.width,height:Zl.INACTIVE.height}),kd=j=>{switch(j){case Ur.HI:return 1;case Ur.MID:return 2;case Ur.LOW:return 4;default:return 1}},Au=50,to=2500,tf=10,Uc=30,nf=160,Cu=1280,Mo=720*Cu,rf=16/9,sf=12,Oo=128,em=64,Hr={[ll.DEFAULT]:0,[ll.LOW]:50,[ll.MEDIUM]:150,[ll.HIGH]:250},Mu={[ll.DEFAULT]:0,[ll.LOW]:100,[ll.MEDIUM]:200,[ll.HIGH]:300};function Pf(j){const{outbound:C,remoteInbound:P,networkQuality:H}=j;return{networkQuality:H,nackCount:C.nackCount,packetsSent:C.packetsSent,packetsLost:P?.packetsLost,retransmittedPacketsSent:C.retransmittedPacketsSent,bytesSent:C.bytesSent,headerBytesSent:C.headerBytesSent,retransmittedBytesSent:C.retransmittedBytesSent,totalPacketSendDelay:C.totalPacketSendDelay}}function Zh(j){var C,P,H;const{outbound:X,remoteInbound:te,networkQuality:ue}=j;return{networkQuality:ue,nackCount:X.nackCount,packetsSent:X.packetsSent,packetsLost:te?.packetsLost,retransmittedPacketsSent:X.retransmittedPacketsSent,bytesSent:X.bytesSent,headerBytesSent:X.headerBytesSent,retransmittedBytesSent:X.retransmittedBytesSent,totalPacketSendDelay:X.totalPacketSendDelay,firCount:X.firCount,pliCount:X.pliCount,framesEncoded:X.framesEncoded,keyFramesEncoded:X.keyFramesEncoded,totalEncodeTime:X.totalEncodeTime,totalEncodedBytesTarget:X.totalEncodedBytesTarget,framesSent:X.framesSent,hugeFramesSent:X.hugeFramesSent,active:((C=X.framesPerSecond)!==null&&C!==void 0?C:0)!==0,qualityLimitationReason:X.qualityLimitationReason,qualityLimitationResolutionChanges:X.qualityLimitationResolutionChanges,qualityLimitationCpuDuration:(P=X.qualityLimitationDurations)===null||P===void 0?void 0:P.cpu,qualityLimitationBandwidthDuration:(H=X.qualityLimitationDurations)===null||H===void 0?void 0:H.bandwidth,frameWidth:X.frameWidth,frameHeight:X.frameHeight,framesPerSecond:X.framesPerSecond,rid:X.rid,ssrc:X.ssrc}}function Jh(j,C){const P=new Map,H=new Map;for(const X of C.values())if(X.kind===j&&X.type==="outbound-rtp"&&X.ssrc){const te=X.rid||Oe;H.set(X.ssrc,te);let ue=P.get(te);ue||(ue={},P.set(te,ue)),ue.outbound=X}for(const X of C.values())if(X.kind===j&&X.type==="remote-inbound-rtp"&&X.ssrc){const te=H.get(X.ssrc)||Oe,ue=P.get(te);ue&&(ue.remoteInbound=X)}return P}function kl(j,C){const P=new Map;for(const H of C.values())if(H.kind===j&&H.type==="inbound-rtp"){const X=H.rid||Oe;P.set(X,{inbound:H})}return P}function qs(j,C){return j!==uo.DOWN&&C!=null?C:j}const Il=(j,C)=>{const P=[],H=ga.getNetworkQuality(),X=Jh("audio",j);for(const te of X.values())if(te.outbound){const ue=te.outbound.rid||Oe,Ee=qs(H,C.get(ue)),w=Pf({outbound:te.outbound,remoteInbound:te.remoteInbound,networkQuality:Ee});P.push(w)}if(P.length)return P},eu=(j,C)=>{const P=[],H=ga.getNetworkQuality(),X=Jh("video",j);for(const te of X.values())if(te.outbound){const ue=te.outbound.rid||Oe,Ee=Zh({outbound:te.outbound,remoteInbound:te.remoteInbound});if(Ee.active){const w=qs(H,C.get(ue));Ee.networkQuality=w}P.push(Ee)}if(P.length)return P},Id=(j,C)=>{const P=[],H=ga.getNetworkQuality(),X=kl("audio",j);for(const ue of X.values())if(ue.inbound){const Ee=ue.inbound.id;if(!Ee)continue;const w=qs(H,C.get(Ee)),d={networkQuality:(te={inbound:ue.inbound,networkQuality:w}).networkQuality,nackCount:te.inbound.nackCount,packetsReceived:te.inbound.packetsReceived,packetsLost:te.inbound.packetsLost,packetsDiscarded:te.inbound.packetsDiscarded,bytesReceived:te.inbound.bytesReceived,headerBytesReceived:te.inbound.headerBytesReceived,jitterBufferDelay:te.inbound.jitterBufferDelay,jitterBufferEmittedCount:te.inbound.jitterBufferEmittedCount,jitter:te.inbound.jitter,totalSamplesReceived:te.inbound.totalSamplesReceived,concealedSamples:te.inbound.concealedSamples,silentConcealedSamples:te.inbound.silentConcealedSamples,concealmentEvents:te.inbound.concealmentEvents,insertedSamplesForDeceleration:te.inbound.insertedSamplesForDeceleration,removedSamplesForAcceleration:te.inbound.removedSamplesForAcceleration,audioLevel:te.inbound.audioLevel};P.push(d)}var te;if(P.length)return P},Nd=(j,C)=>{const P=[],H=ga.getNetworkQuality(),X=kl("video",j);for(const ue of X.values())if(ue.inbound){const Ee=ue.inbound.id;if(!Ee)continue;const w={networkQuality:(te={inbound:ue.inbound,networkQuality:qs(H,C.get(Ee))}).networkQuality,nackCount:te.inbound.nackCount,packetsReceived:te.inbound.packetsReceived,packetsLost:te.inbound.packetsLost,packetsDiscarded:te.inbound.packetsDiscarded,bytesReceived:te.inbound.bytesReceived,headerBytesReceived:te.inbound.headerBytesReceived,jitterBufferDelay:te.inbound.jitterBufferDelay,jitterBufferEmittedCount:te.inbound.jitterBufferEmittedCount,jitter:te.inbound.jitter,pliCount:te.inbound.pliCount,firCount:te.inbound.firCount,framesReceived:te.inbound.framesReceived,framesDecoded:te.inbound.framesDecoded,keyFramesDecoded:te.inbound.keyFramesDecoded,framesDropped:te.inbound.framesDropped,totalDecodeTime:te.inbound.totalDecodeTime,totalInterFrameDelay:te.inbound.totalInterFrameDelay,totalSquaredInterFrameDelay:te.inbound.totalSquaredInterFrameDelay,pauseCount:te.inbound.pauseCount,totalPausesDuration:te.inbound.totalPausesDuration,freezeCount:te.inbound.freezeCount,totalFreezesDuration:te.inbound.totalFreezesDuration,frameWidth:te.inbound.frameWidth,frameHeight:te.inbound.frameHeight,framesPerSecond:te.inbound.framesPerSecond,ssrc:te.inbound.ssrc};P.push(w)}var te;if(P.length)return P};var tm=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Qh="H264",Ou=j=>{const C=j?.split("/");if(C?.length===2)return C[1]},ul=(j,C)=>{const P=Ou(j);if(j===void 0||P===void 0)return;const H={mimeSubtype:P};if(C){const X=(te=>{const ue=te.split(";"),Ee=new Map;for(const w of ue){const[d,b]=w.split("=");Ee.set(d,b)}return Ee})(C);switch(P){case Qh:{const te=X.get("profile-level-id");te&&((ue,Ee)=>{if(Ee.length<6)return;const w=Ee.substring(0,4),d=parseInt(Ee.substring(4,6),16);ue.profile=w,ue.level=d})(H,te);break}case"H265":((te,ue)=>{const Ee=ue.get("profile-id")||"0",w=ue.get("tier-flag")||"0",d=parseInt(ue.get("level-id")||"0",10),b=[w,Ee].join("_");te.profile=b,te.level=d})(H,X)}}return H},af=(j,C)=>j.sort(((P,H)=>{if(Ou(P.mimeType)===Qh){const X=ul(P.mimeType,P.sdpFmtpLine);if(X?.profile===C)return-1}return 0})),Zr=(j,C)=>{var P;const H=ul(j.mimeType,j.sdpFmtpLine);return H?.mimeSubtype.toLowerCase()===C.mime.toLowerCase()&&((P=H?.profile)===null||P===void 0?void 0:P.toLowerCase().indexOf(C.config.toLowerCase()))===0},hs=(j,C)=>C.filter((P=>!P.mimeType.endsWith("rtx"))).filter((P=>P.mimeType.indexOf("packetization-mode=0")===-1)).find((P=>j.reduce(((H,X)=>H&&Zr(P,X)===!1),!0)));class qa extends ur{constructor(C,P,H,X,te,ue,Ee,w,d){var b,O;super(Xn.PUBLISHED_VIDEO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(b=H?.node)!==null&&b!==void 0?b:"",cluster:(O=H?.cluster)!==null&&O!==void 0?O:""},((F,ie,pe,ye,Re,Pe)=>{var Fe,Ye,dt,xt,Dt,bt,gt,kt,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br,Oi,oi,li,Fi,Yr,Ss,ci,Is,$i,ea,Ns,ms;const vo=(Ye=(Fe=F?.qualityLimitationDurations)===null||Fe===void 0?void 0:Fe.cpu)!==null&&Ye!==void 0?Ye:0,Dl=(xt=(dt=F?.qualityLimitationDurations)===null||dt===void 0?void 0:dt.bandwidth)!==null&&xt!==void 0?xt:0,yc=Math.max((Dt=F?.bytesSent)!==null&&Dt!==void 0?Dt:0,0),cu=8*yc/(Pe??1),Bu=Math.max((bt=ie?.packetsLost)!==null&&bt!==void 0?bt:0,0),T=Math.max((gt=F?.packetsSent)!==null&&gt!==void 0?gt:0,0),R=Bu/Math.max(T,1),z=ul(ye?.mimeType,ye?.sdpFmtpLine);return{active:!!F?.framesPerSecond&&F.framesPerSecond!==0,bytes_sent:yc,codec_mime_type:z?.mimeSubtype,codec_profile:z?.profile,codec_level:z?.level,configured_bitrate:Re?.max_bitrate,connection_bandwidth:(wt=(kt=pe?.candidatePair)===null||kt===void 0?void 0:kt.availableOutgoingBitrate)!==null&&wt!==void 0?wt:0,encode_bitrate:cu,encoder_implementation:(It=F?.encoderImplementation)!==null&&It!==void 0?It:"unknown",fir_count:(Ft=F?.firCount)!==null&&Ft!==void 0?Ft:0,fraction_packets_lost:R,frame_height:Math.max((Zt=F?.frameHeight)!==null&&Zt!==void 0?Zt:0,0),frame_width:Math.max((Gt=F?.frameWidth)!==null&&Gt!==void 0?Gt:0,0),frames_encoded:($t=F?.framesEncoded)!==null&&$t!==void 0?$t:0,frames_per_second:Math.max((dn=F?.framesPerSecond)!==null&&dn!==void 0?dn:0,0),frames_sent:(Rn=F?.framesSent)!==null&&Rn!==void 0?Rn:0,header_bytes_sent:(Nn=F?.headerBytesSent)!==null&&Nn!==void 0?Nn:0,huge_frames_sent:(qn=F?.hugeFramesSent)!==null&&qn!==void 0?qn:0,key_frames_encoded:(Dn=F?.keyFramesEncoded)!==null&&Dn!==void 0?Dn:0,nack_count:(gr=F?.nackCount)!==null&&gr!==void 0?gr:0,packets_lost:Bu,packets_sent:T,power_efficient_encoder:(Br=F?.powerEfficientEncoder)!==null&&Br!==void 0&&Br,pli_count:(Oi=F?.pliCount)!==null&&Oi!==void 0?Oi:0,quality_limitation_reason:(oi=F?.qualityLimitationReason)!==null&&oi!==void 0?oi:"none",quality_limitation_resolution_changes:(li=F?.qualityLimitationResolutionChanges)!==null&&li!==void 0?li:0,quality_limitation_cpu_duration:vo,quality_limitation_bandwidth_duration:Dl,retransmitted_bytes_sent:(Fi=F?.retransmittedBytesSent)!==null&&Fi!==void 0?Fi:0,retransmitted_packets_sent:(Yr=F?.retransmittedPacketsSent)!==null&&Yr!==void 0?Yr:0,rid:(Ss=F?.rid)!==null&&Ss!==void 0?Ss:Oe,scalability_mode:(ci=F?.scalabilityMode)!==null&&ci!==void 0?ci:"unknown",target_bitrate:Math.max((Is=F?.targetBitrate)!==null&&Is!==void 0?Is:0,0),total_encode_time:($i=F?.totalEncodeTime)!==null&&$i!==void 0?$i:0,total_encoded_bytes_target:(ea=F?.totalEncodedBytesTarget)!==null&&ea!==void 0?ea:0,total_packet_send_delay:(Ns=F?.totalPacketSendDelay)!==null&&Ns!==void 0?Ns:0,protocol:(ms=pe?.localCandidate)===null||ms===void 0?void 0:ms.protocol}})(X,te,ue,Ee,w,d)))}}class ed extends ur{constructor(C,P,H,X,te,ue,Ee,w,d,b,O,F){var ie,pe,ye,Re;super(Xn.PUBLISHED_VIDEO_STATS_WINDOW,C,P,!1);const Pe=Math.max(((ie=X?.timestamp)!==null&&ie!==void 0?ie:0)-((pe=te?.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(ye=H?.node)!==null&&ye!==void 0?ye:"",cluster:(Re=H?.cluster)!==null&&Re!==void 0?Re:"",window_size_ms:Pe},((Fe,Ye,dt,xt,Dt,bt,gt,kt,wt,It)=>{var Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br,Oi,oi,li,Fi,Yr,Ss,ci,Is,$i,ea,Ns,ms,vo,Dl,yc,cu,Bu,T,R,z,re,he,Te,et,yt,zt,mn,Ln,Qn,nr,Xr,uu,hd,dd,Jt,Ct,nn,Un,Or,ba,Kr,Es,Ca;const Qi=(Zt=(Ft=Fe?.qualityLimitationDurations)===null||Ft===void 0?void 0:Ft.cpu)!==null&&Zt!==void 0?Zt:0,pd=($t=(Gt=Ye?.qualityLimitationDurations)===null||Gt===void 0?void 0:Gt.cpu)!==null&&$t!==void 0?$t:0,o_=(Rn=(dn=Fe?.qualityLimitationDurations)===null||dn===void 0?void 0:dn.bandwidth)!==null&&Rn!==void 0?Rn:0,bR=(qn=(Nn=Ye?.qualityLimitationDurations)===null||Nn===void 0?void 0:Nn.bandwidth)!==null&&qn!==void 0?qn:0,tv=Math.max(((Dn=Fe?.bytesSent)!==null&&Dn!==void 0?Dn:0)-((gr=Ye?.bytesSent)!==null&&gr!==void 0?gr:0),0),yg=typeof kt!="number"?1:kt/1e3,lS=8*tv/yg,N3=Math.max(((Br=dt?.packetsLost)!==null&&Br!==void 0?Br:0)-((Oi=xt?.packetsLost)!==null&&Oi!==void 0?Oi:0),0),SR=Math.max(((oi=Fe?.packetsSent)!==null&&oi!==void 0?oi:0)-((li=Ye?.packetsSent)!==null&&li!==void 0?li:0),0),P3=N3/Math.max(SR,1),cy=ul(bt?.mimeType,bt?.sdpFmtpLine),D3=8*(It||0)/yg;return{active:!!Fe?.framesPerSecond&&Fe?.framesPerSecond!==0,bytes_sent:tv,codec_mime_type:cy?.mimeSubtype,codec_profile:cy?.profile,codec_level:cy?.level,configured_bitrate:gt?.max_bitrate,connection_bandwidth:(Yr=(Fi=Dt?.candidatePair)===null||Fi===void 0?void 0:Fi.availableOutgoingBitrate)!==null&&Yr!==void 0?Yr:0,encode_bitrate:lS,encoder_implementation:(Ss=Fe?.encoderImplementation)!==null&&Ss!==void 0?Ss:"unknown",fir_count:Math.max(((ci=Fe?.firCount)!==null&&ci!==void 0?ci:0)-((Is=Ye?.firCount)!==null&&Is!==void 0?Is:0),0),fraction_packets_lost:P3,frame_height:Math.max(($i=Fe?.frameHeight)!==null&&$i!==void 0?$i:0,0),frame_width:Math.max((ea=Fe?.frameWidth)!==null&&ea!==void 0?ea:0,0),frames_encoded:Math.max(((Ns=Fe?.framesEncoded)!==null&&Ns!==void 0?Ns:0)-((ms=Ye?.framesEncoded)!==null&&ms!==void 0?ms:0),0),frames_per_second:Math.max((vo=Fe?.framesPerSecond)!==null&&vo!==void 0?vo:0,0),frames_sent:Math.max(((Dl=Fe?.framesSent)!==null&&Dl!==void 0?Dl:0)-((yc=Ye?.framesSent)!==null&&yc!==void 0?yc:0),0),header_bytes_sent:Math.max(((cu=Fe?.headerBytesSent)!==null&&cu!==void 0?cu:0)-((Bu=Ye?.headerBytesSent)!==null&&Bu!==void 0?Bu:0),0),huge_frames_sent:Math.max(((T=Fe?.hugeFramesSent)!==null&&T!==void 0?T:0)-((R=Ye?.hugeFramesSent)!==null&&R!==void 0?R:0),0),key_frames_encoded:Math.max(((z=Fe?.keyFramesEncoded)!==null&&z!==void 0?z:0)-((re=Ye?.keyFramesEncoded)!==null&&re!==void 0?re:0),0),nack_count:Math.max(((he=Fe?.nackCount)!==null&&he!==void 0?he:0)-((Te=Ye?.nackCount)!==null&&Te!==void 0?Te:0),0),packets_lost:N3,packets_sent:SR,power_efficient_encoder:(et=Fe?.powerEfficientEncoder)!==null&&et!==void 0&&et,pli_count:Math.max(((yt=Fe?.pliCount)!==null&&yt!==void 0?yt:0)-((zt=Ye?.pliCount)!==null&&zt!==void 0?zt:0),0),quality_limitation_reason:(mn=Fe?.qualityLimitationReason)!==null&&mn!==void 0?mn:"none",quality_limitation_resolution_changes:Math.max(((Ln=Fe?.qualityLimitationResolutionChanges)!==null&&Ln!==void 0?Ln:0)-((Qn=Ye?.qualityLimitationResolutionChanges)!==null&&Qn!==void 0?Qn:0),0),quality_limitation_cpu_duration:Math.max(Qi-pd,0),quality_limitation_bandwidth_duration:Math.max(o_-bR,0),retransmitted_bytes_sent:Math.max(((nr=Fe?.retransmittedBytesSent)!==null&&nr!==void 0?nr:0)-((Xr=Ye?.retransmittedBytesSent)!==null&&Xr!==void 0?Xr:0),0),rid:(uu=Fe?.rid)!==null&&uu!==void 0?uu:Oe,retransmitted_packets_sent:Math.max(((hd=Fe?.retransmittedPacketsSent)!==null&&hd!==void 0?hd:0)-((dd=Ye?.retransmittedPacketsSent)!==null&&dd!==void 0?dd:0),0),scalability_mode:(Jt=Fe?.scalabilityMode)!==null&&Jt!==void 0?Jt:"unknown",target_bitrate:Math.max((Ct=Fe?.targetBitrate)!==null&&Ct!==void 0?Ct:0,0),total_encode_time:Math.max(((nn=Fe?.totalEncodeTime)!==null&&nn!==void 0?nn:0)-((Un=Ye?.totalEncodeTime)!==null&&Un!==void 0?Un:0),0),total_encoded_bytes_target:Math.max(((Or=Fe?.totalEncodedBytesTarget)!==null&&Or!==void 0?Or:0)-((ba=Ye?.totalEncodedBytesTarget)!==null&&ba!==void 0?ba:0),0),total_packet_send_delay:Math.max(((Kr=Fe?.totalPacketSendDelay)!==null&&Kr!==void 0?Kr:0)-((Es=Ye?.totalPacketSendDelay)!==null&&Es!==void 0?Es:0),0),sei_write_count:wt,sei_bytes_sent:It,sei_bitrate:D3,protocol:(Ca=Dt?.localCandidate)===null||Ca===void 0?void 0:Ca.protocol}})(X,te,ue,Ee,w,d,b,Pe,O,F)))}}class ku extends ur{constructor(C,P,H,X,te,ue,Ee,w,d,b){var O,F;super(Xn.PUBLISHED_AUDIO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(O=H?.node)!==null&&O!==void 0?O:"",cluster:(F=H?.cluster)!==null&&F!==void 0?F:""},((ie,pe,ye,Re,Pe,Fe,Ye)=>{var dt,xt,Dt,bt,gt,kt,wt,It,Ft,Zt,Gt,$t,dn;const Rn=Math.max((dt=ie?.bytesSent)!==null&&dt!==void 0?dt:0,0),Nn=8*Rn/(Fe??1),qn=Math.max((xt=pe?.packetsLost)!==null&&xt!==void 0?xt:0,0),Dn=Math.max((Dt=ie?.packetsSent)!==null&&Dt!==void 0?Dt:0,0),gr=qn/Math.max(Dn,1),Br=ul(Re?.mimeType,Re?.sdpFmtpLine);return{audio_nacks_enabled:(bt=Ye?.audioNacks)!==null&&bt!==void 0&&bt,bytes_sent:Rn,codec_mime_type:Br?.mimeSubtype,configured_bitrate:(gt=Pe?.max_audio_bitrate_bps)!==null&&gt!==void 0?gt:0,connection_bandwidth:(wt=(kt=ye?.candidatePair)===null||kt===void 0?void 0:kt.availableOutgoingBitrate)!==null&&wt!==void 0?wt:0,encode_bitrate:Nn,fraction_packets_lost:gr,header_bytes_sent:(It=ie?.headerBytesSent)!==null&&It!==void 0?It:0,nack_count:(Ft=ie?.nackCount)!==null&&Ft!==void 0?Ft:0,packets_lost:qn,packets_sent:Dn,retransmitted_bytes_sent:(Zt=ie?.retransmittedBytesSent)!==null&&Zt!==void 0?Zt:0,retransmitted_packets_sent:(Gt=ie?.retransmittedPacketsSent)!==null&&Gt!==void 0?Gt:0,target_bitrate:($t=ie?.targetBitrate)!==null&&$t!==void 0?$t:0,protocol:(dn=ye?.localCandidate)===null||dn===void 0?void 0:dn.protocol}})(X,te,ue,Ee,w,d,b)))}}class fl extends ur{constructor(C,P,H,X,te,ue,Ee,w,d,b,O){var F,ie,pe,ye;super(Xn.PUBLISHED_AUDIO_STATS_WINDOW,C,P,!1);const Re=Math.max(((F=X?.timestamp)!==null&&F!==void 0?F:0)-((ie=te?.timestamp)!==null&&ie!==void 0?ie:0),0);Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(pe=H?.node)!==null&&pe!==void 0?pe:"",cluster:(ye=H?.cluster)!==null&&ye!==void 0?ye:"",window_size_ms:Re},((Pe,Fe,Ye,dt,xt,Dt,bt,gt,kt)=>{var wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br,Oi,oi,li,Fi,Yr,Ss,ci,Is,$i;const ea=Math.max(((wt=Pe?.bytesSent)!==null&&wt!==void 0?wt:0)-((It=Fe?.bytesSent)!==null&&It!==void 0?It:0),0),Ns=8*ea/(typeof gt!="number"?1:gt/1e3),ms=Math.max(((Ft=Ye?.packetsLost)!==null&&Ft!==void 0?Ft:0)-((Zt=dt?.packetsLost)!==null&&Zt!==void 0?Zt:0),0),vo=Math.max(((Gt=Pe?.packetsSent)!==null&&Gt!==void 0?Gt:0)-(($t=Fe?.packetsSent)!==null&&$t!==void 0?$t:0),0),Dl=ms/Math.max(vo,1),yc=ul(Dt?.mimeType,Dt?.sdpFmtpLine);return{audio_nacks_enabled:(dn=kt?.audioNacks)!==null&&dn!==void 0&&dn,bytes_sent:ea,codec_mime_type:yc?.mimeSubtype,configured_bitrate:(Rn=bt?.max_audio_bitrate_bps)!==null&&Rn!==void 0?Rn:0,connection_bandwidth:(qn=(Nn=xt?.candidatePair)===null||Nn===void 0?void 0:Nn.availableOutgoingBitrate)!==null&&qn!==void 0?qn:0,encode_bitrate:Ns,fraction_packets_lost:Dl,header_bytes_sent:Math.max(((Dn=Pe?.headerBytesSent)!==null&&Dn!==void 0?Dn:0)-((gr=Fe?.headerBytesSent)!==null&&gr!==void 0?gr:0),0),nack_count:Math.max(((Br=Pe?.nackCount)!==null&&Br!==void 0?Br:0)-((Oi=Fe?.nackCount)!==null&&Oi!==void 0?Oi:0),0),packets_lost:ms,packets_sent:Math.max(((oi=Pe?.packetsSent)!==null&&oi!==void 0?oi:0)-((li=Fe?.packetsSent)!==null&&li!==void 0?li:0),0),retransmitted_bytes_sent:Math.max(((Fi=Pe?.retransmittedBytesSent)!==null&&Fi!==void 0?Fi:0)-((Yr=Fe?.retransmittedBytesSent)!==null&&Yr!==void 0?Yr:0),0),retransmitted_packets_sent:Math.max(((Ss=Pe?.retransmittedPacketsSent)!==null&&Ss!==void 0?Ss:0)-((ci=Fe?.retransmittedPacketsSent)!==null&&ci!==void 0?ci:0),0),target_bitrate:Math.max((Is=Pe?.targetBitrate)!==null&&Is!==void 0?Is:0,0),protocol:($i=xt?.localCandidate)===null||$i===void 0?void 0:$i.protocol}})(X,te,ue,Ee,w,d,b,Re,O)))}}class no extends ur{constructor(C,P,H,X,te,ue,Ee,w){var d,b;super(Xn.SUBSCRIBED_VIDEO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(d=X?.node)!==null&&d!==void 0?d:"",cluster:(b=X?.cluster)!==null&&b!==void 0?b:"",remote_participant_id:H},((O,F,ie,pe)=>{var ye,Re,Pe,Fe,Ye,dt,xt,Dt,bt,gt,kt,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br;let Oi=0;O?.jitterBufferDelay&&O?.jitterBufferEmittedCount&&O.jitterBufferEmittedCount>0&&(Oi=O.jitterBufferDelay/O.jitterBufferEmittedCount);const oi=pe??1,li=Math.max((ye=O?.bytesReceived)!==null&&ye!==void 0?ye:0,0),Fi=8*li/oi;let Yr=0;O?.totalDecodeTime&&O?.framesDecoded&&(Yr=O.totalDecodeTime/Math.max(O?.framesDecoded,1));const Ss=Math.max((Re=O?.packetsLost)!==null&&Re!==void 0?Re:0,0),ci=Math.max((Pe=O?.packetsReceived)!==null&&Pe!==void 0?Pe:0,0),Is=Ss/Math.max(ci+Ss,1),$i=ul(ie?.mimeType,ie?.sdpFmtpLine);return{bytes_received:li,codec_mime_type:$i?.mimeSubtype,codec_profile:$i?.profile,codec_level:$i?.level,connection_bandwidth:(Ye=(Fe=F?.candidatePair)===null||Fe===void 0?void 0:Fe.availableIncomingBitrate)!==null&&Ye!==void 0?Ye:0,decode_bitrate:Fi,decoder_implementation:(dt=O?.decoderImplementation)!==null&&dt!==void 0?dt:"unknown",fir_count:Math.max((xt=O?.firCount)!==null&&xt!==void 0?xt:0,0),fraction_packets_lost:Is,frame_decode_time_avg:Yr,frame_height:Math.max((Dt=O?.frameHeight)!==null&&Dt!==void 0?Dt:0,0),frame_width:Math.max((bt=O?.frameWidth)!==null&&bt!==void 0?bt:0,0),frames_decoded:Math.max((gt=O?.framesDecoded)!==null&&gt!==void 0?gt:0,0),frames_dropped:Math.max((kt=O?.framesDropped)!==null&&kt!==void 0?kt:0,0),frames_received:Math.max((wt=O?.framesReceived)!==null&&wt!==void 0?wt:0,0),freeze_count:Math.max((It=O?.freezeCount)!==null&&It!==void 0?It:0,0),frames_rendered:Math.max((Ft=O?.framesRendered)!==null&&Ft!==void 0?Ft:0,0),frames_per_second:Math.max((Zt=O?.framesPerSecond)!==null&&Zt!==void 0?Zt:0,0),header_bytes_received:Math.max((Gt=O?.headerBytesReceived)!==null&&Gt!==void 0?Gt:0,0),jitter_buffer_delay_avg:Oi,key_frames_decoded:Math.max(($t=O?.keyFramesDecoded)!==null&&$t!==void 0?$t:0,0),nack_count:Math.max((dn=O?.nackCount)!==null&&dn!==void 0?dn:0,0),packets_discarded:Math.max((Rn=O?.packetsDiscarded)!==null&&Rn!==void 0?Rn:0,0),packets_lost:Ss,packets_received:ci,pause_count:Math.max((Nn=O?.pauseCount)!==null&&Nn!==void 0?Nn:0,0),pli_count:Math.max((qn=O?.pliCount)!==null&&qn!==void 0?qn:0,0),power_efficient_decoder:(Dn=O?.powerEfficientDecoder)!==null&&Dn!==void 0&&Dn,total_freezes_duration:Math.max((gr=O?.totalFreezesDuration)!==null&&gr!==void 0?gr:0,0),total_pauses_duration:Math.max((Br=O?.totalPausesDuration)!==null&&Br!==void 0?Br:0,0)}})(te,ue,Ee,w)))}}class pc extends ur{constructor(C,P,H,X,te,ue,Ee,w,d,b,O){var F,ie,pe,ye;super(Xn.SUBSCRIBED_VIDEO_STATS_WINDOW,C,P,!1);const Re=Math.max(((F=te?.timestamp)!==null&&F!==void 0?F:0)-((ie=ue?.timestamp)!==null&&ie!==void 0?ie:0),0);Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(pe=X?.node)!==null&&pe!==void 0?pe:"",cluster:(ye=X?.cluster)!==null&&ye!==void 0?ye:"",window_size_ms:Re,remote_participant_id:H},((Pe,Fe,Ye,dt,xt,Dt,bt,gt)=>{var kt,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br,Oi,oi,li,Fi,Yr,Ss,ci,Is,$i,ea,Ns,ms,vo,Dl,yc,cu,Bu,T,R,z,re,he,Te,et,yt,zt,mn,Ln,Qn,nr,Xr;let uu=0,hd=0;if(Pe?.jitterBufferEmittedCount&&Fe?.jitterBufferEmittedCount&&Pe.jitterBufferEmittedCount>Fe.jitterBufferEmittedCount){Pe?.jitterBufferDelay&&Fe?.jitterBufferDelay&&(uu=(Pe.jitterBufferDelay-Fe.jitterBufferDelay)/(Pe.jitterBufferEmittedCount-Fe.jitterBufferEmittedCount));const pd=Fe?.jitterBufferMinimumDelay,o_=Pe?.jitterBufferMinimumDelay;pd&&o_&&(hd=(o_-pd)/(Pe.jitterBufferEmittedCount-Fe.jitterBufferEmittedCount))}const dd=Math.max(((kt=Pe?.bytesReceived)!==null&&kt!==void 0?kt:0)-((wt=Fe?.bytesReceived)!==null&&wt!==void 0?wt:0),0),Jt=typeof xt!="number"?1:xt/1e3,Ct=8*dd/Jt,nn=Math.max(((It=Pe?.totalDecodeTime)!==null&&It!==void 0?It:0)-((Ft=Fe?.totalDecodeTime)!==null&&Ft!==void 0?Ft:0),0),Un=Math.max(((Zt=Pe?.framesDecoded)!==null&&Zt!==void 0?Zt:0)-((Gt=Fe?.framesDecoded)!==null&&Gt!==void 0?Gt:0),0),Or=nn/Math.max(Un,1),ba=Math.max((($t=Pe?.packetsLost)!==null&&$t!==void 0?$t:0)-((dn=Fe?.packetsLost)!==null&&dn!==void 0?dn:0),0),Kr=Math.max(((Rn=Pe?.packetsReceived)!==null&&Rn!==void 0?Rn:0)-((Nn=Fe?.packetsReceived)!==null&&Nn!==void 0?Nn:0),0),Es=ba/Math.max(Kr+ba,1),Ca=ul(dt?.mimeType,dt?.sdpFmtpLine),Qi=8*(gt||0)/Jt;return{bytes_received:dd,codec_mime_type:Ca?.mimeSubtype,codec_profile:Ca?.profile,codec_level:Ca?.level,connection_bandwidth:(Dn=(qn=Ye?.candidatePair)===null||qn===void 0?void 0:qn.availableIncomingBitrate)!==null&&Dn!==void 0?Dn:0,decode_bitrate:Ct,decoder_implementation:(gr=Pe?.decoderImplementation)!==null&&gr!==void 0?gr:"unknown",fir_count:Math.max(((Br=Pe?.firCount)!==null&&Br!==void 0?Br:0)-((Oi=Fe?.firCount)!==null&&Oi!==void 0?Oi:0),0),fraction_packets_lost:Es,frame_decode_time_avg:Or,frame_height:Math.max((oi=Pe?.frameHeight)!==null&&oi!==void 0?oi:0,0),frame_width:Math.max((li=Pe?.frameWidth)!==null&&li!==void 0?li:0,0),frames_decoded:Math.max(((Fi=Pe?.framesDecoded)!==null&&Fi!==void 0?Fi:0)-((Yr=Fe?.framesDecoded)!==null&&Yr!==void 0?Yr:0),0),frames_dropped:Math.max(((Ss=Pe?.framesDropped)!==null&&Ss!==void 0?Ss:0)-((ci=Fe?.framesDropped)!==null&&ci!==void 0?ci:0),0),frames_received:Math.max(((Is=Pe?.framesReceived)!==null&&Is!==void 0?Is:0)-(($i=Fe?.framesReceived)!==null&&$i!==void 0?$i:0),0),freeze_count:Math.max(((ea=Pe?.freezeCount)!==null&&ea!==void 0?ea:0)-((Ns=Fe?.freezeCount)!==null&&Ns!==void 0?Ns:0),0),frames_rendered:Math.max((ms=Pe?.framesRendered)!==null&&ms!==void 0?ms:0,0),frames_per_second:Math.max((vo=Pe?.framesPerSecond)!==null&&vo!==void 0?vo:0,0),header_bytes_received:Math.max(((Dl=Pe?.headerBytesReceived)!==null&&Dl!==void 0?Dl:0)-((yc=Fe?.headerBytesReceived)!==null&&yc!==void 0?yc:0),0),configured_jitter_buffer_min_delay_ms:Dt??0,jitter_buffer_min_obtainable_delay:hd,jitter_buffer_delay_avg:uu,key_frames_decoded:Math.max(((cu=Pe?.keyFramesDecoded)!==null&&cu!==void 0?cu:0)-((Bu=Fe?.keyFramesDecoded)!==null&&Bu!==void 0?Bu:0),0),nack_count:Math.max(((T=Pe?.nackCount)!==null&&T!==void 0?T:0)-((R=Fe?.nackCount)!==null&&R!==void 0?R:0),0),packets_discarded:Math.max(((z=Pe?.packetsDiscarded)!==null&&z!==void 0?z:0)-((re=Fe?.packetsDiscarded)!==null&&re!==void 0?re:0),0),packets_lost:ba,packets_received:Kr,pause_count:Math.max(((he=Pe?.pauseCount)!==null&&he!==void 0?he:0)-((Te=Fe?.pauseCount)!==null&&Te!==void 0?Te:0),0),pli_count:Math.max(((et=Pe?.pliCount)!==null&&et!==void 0?et:0)-((yt=Fe?.pliCount)!==null&&yt!==void 0?yt:0),0),power_efficient_decoder:(zt=Pe?.powerEfficientDecoder)!==null&&zt!==void 0&&zt,total_freezes_duration:Math.max(((mn=Pe?.totalFreezesDuration)!==null&&mn!==void 0?mn:0)-((Ln=Fe?.totalFreezesDuration)!==null&&Ln!==void 0?Ln:0),0),total_pauses_duration:Math.max(((Qn=Pe?.totalPausesDuration)!==null&&Qn!==void 0?Qn:0)-((nr=Fe?.totalPausesDuration)!==null&&nr!==void 0?nr:0),0),sei_read_count:bt,sei_bytes_received:gt,sei_bitrate:Qi,protocol:(Xr=Ye?.localCandidate)===null||Xr===void 0?void 0:Xr.protocol}})(te,ue,Ee,w,Re,d,b,O)))}}class qo extends ur{constructor(C,P,H,X,te,ue,Ee,w,d){var b,O;super(Xn.SUBSCRIBED_AUDIO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(b=X?.node)!==null&&b!==void 0?b:"",cluster:(O=X?.cluster)!==null&&O!==void 0?O:"",remote_participant_id:H},((F,ie,pe,ye,Re)=>{var Pe,Fe,Ye,dt,xt,Dt,bt,gt,kt,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn;let qn=0;F?.jitterBufferDelay&&F?.jitterBufferEmittedCount&&F.jitterBufferEmittedCount>0&&(qn=F.jitterBufferDelay/F.jitterBufferEmittedCount);const Dn=ye??1,gr=Math.max((Pe=F?.bytesReceived)!==null&&Pe!==void 0?Pe:0,0),Br=8*gr/Dn,Oi=Math.max((Fe=F?.packetsLost)!==null&&Fe!==void 0?Fe:0,0),oi=Math.max((Ye=F?.packetsReceived)!==null&&Ye!==void 0?Ye:0,0),li=Oi/Math.max(oi+Oi,1),Fi=Math.max((dt=F?.concealedSamples)!==null&&dt!==void 0?dt:0,0),Yr=Math.max((xt=F?.totalSamplesReceived)!==null&&xt!==void 0?xt:0,0),Ss=Fi/Math.max(Yr,1),ci=ul(pe?.mimeType,pe?.sdpFmtpLine);return{audio_level:(Dt=F?.audioLevel)!==null&&Dt!==void 0?Dt:0,audio_nacks_enabled:(bt=Re?.audioNacks)!==null&&bt!==void 0&&bt,bytes_received:gr,codec_mime_type:ci?.mimeSubtype,connection_bandwidth:(kt=(gt=ie?.candidatePair)===null||gt===void 0?void 0:gt.availableIncomingBitrate)!==null&&kt!==void 0?kt:0,concealed_samples:Fi,concealment_events:Math.max((wt=F?.concealmentEvents)!==null&&wt!==void 0?wt:0,0),silent_concealed_samples:Math.max((It=F?.silentConcealedSamples)!==null&&It!==void 0?It:0,0),decode_bitrate:Br,fraction_audio_concealed:Ss,fraction_packets_lost:li,header_bytes_received:Math.max((Ft=F?.headerBytesReceived)!==null&&Ft!==void 0?Ft:0,0),inserted_samples_for_deceleration:Math.max((Zt=F?.insertedSamplesForDeceleration)!==null&&Zt!==void 0?Zt:0,0),jitter_buffer_delay_avg:qn,packets_discarded:Math.max((Gt=F?.packetsDiscarded)!==null&&Gt!==void 0?Gt:0,0),retransmitted_packets_received:Math.max(($t=F?.retransmittedPacketsReceived)!==null&&$t!==void 0?$t:0,0),retransmitted_bytes_received:Math.max((dn=F?.retransmittedBytesReceived)!==null&&dn!==void 0?dn:0,0),packets_lost:Oi,packets_received:oi,nack_count:Math.max((Rn=F?.nackCount)!==null&&Rn!==void 0?Rn:0,0),removed_samples_for_acceleration:Math.max((Nn=F?.removedSamplesForAcceleration)!==null&&Nn!==void 0?Nn:0,0),total_samples_received:Yr}})(te,ue,Ee,w,d)))}}class e0 extends ur{constructor(C,P,H,X,te,ue,Ee,w,d,b){var O,F,ie,pe;super(Xn.SUBSCRIBED_AUDIO_STATS_WINDOW,C,P,!1);const ye=Math.max(((O=te?.timestamp)!==null&&O!==void 0?O:0)-((F=ue?.timestamp)!==null&&F!==void 0?F:0),0);Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,window_size_ms:ye,node:(ie=X?.node)!==null&&ie!==void 0?ie:"",cluster:(pe=X?.cluster)!==null&&pe!==void 0?pe:"",remote_participant_id:H},((Re,Pe,Fe,Ye,dt,xt,Dt)=>{var bt,gt,kt,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Br,Oi,oi,li,Fi,Yr,Ss,ci,Is,$i,ea,Ns,ms,vo,Dl,yc,cu,Bu;let T=0,R=0;if(Re?.jitterBufferEmittedCount&&Pe?.jitterBufferEmittedCount&&Re.jitterBufferEmittedCount>Pe.jitterBufferEmittedCount){Re?.jitterBufferDelay&&Pe?.jitterBufferDelay&&(T=(Re.jitterBufferDelay-Pe.jitterBufferDelay)/(Re.jitterBufferEmittedCount-Pe.jitterBufferEmittedCount));const nr=Pe?.jitterBufferMinimumDelay,Xr=Re?.jitterBufferMinimumDelay;nr&&Xr&&(R=(Xr-nr)/(Re.jitterBufferEmittedCount-Pe.jitterBufferEmittedCount))}const z=typeof dt!="number"?1:dt/1e3,re=Math.max(((bt=Re?.bytesReceived)!==null&&bt!==void 0?bt:0)-((gt=Pe?.bytesReceived)!==null&&gt!==void 0?gt:0),0),he=8*re/z,Te=Math.max(((kt=Re?.packetsLost)!==null&&kt!==void 0?kt:0)-((wt=Pe?.packetsLost)!==null&&wt!==void 0?wt:0),0),et=Math.max(((It=Re?.packetsReceived)!==null&&It!==void 0?It:0)-((Ft=Pe?.packetsReceived)!==null&&Ft!==void 0?Ft:0),0),yt=Te/Math.max(et+Te,1),zt=Math.max(((Zt=Re?.concealedSamples)!==null&&Zt!==void 0?Zt:0)-((Gt=Pe?.concealedSamples)!==null&&Gt!==void 0?Gt:0),0),mn=Math.max((($t=Re?.totalSamplesReceived)!==null&&$t!==void 0?$t:0)-((dn=Pe?.totalSamplesReceived)!==null&&dn!==void 0?dn:0),0),Ln=zt/Math.max(mn,1),Qn=ul(Ye?.mimeType,Ye?.sdpFmtpLine);return{audio_level:(Rn=Re?.audioLevel)!==null&&Rn!==void 0?Rn:0,audio_nacks_enabled:(Nn=xt?.audioNacks)!==null&&Nn!==void 0&&Nn,bytes_received:re,codec_mime_type:Qn?.mimeSubtype,connection_bandwidth:(Dn=(qn=Fe?.candidatePair)===null||qn===void 0?void 0:qn.availableIncomingBitrate)!==null&&Dn!==void 0?Dn:0,decode_bitrate:he,concealed_samples:zt,concealment_events:Math.max(((gr=Re?.concealmentEvents)!==null&&gr!==void 0?gr:0)-((Br=Pe?.concealmentEvents)!==null&&Br!==void 0?Br:0),0),silent_concealed_samples:Math.max(((Oi=Re?.silentConcealedSamples)!==null&&Oi!==void 0?Oi:0)-((oi=Pe?.silentConcealedSamples)!==null&&oi!==void 0?oi:0),0),fraction_audio_concealed:Ln,fraction_packets_lost:yt,header_bytes_received:Math.max(((li=Re?.headerBytesReceived)!==null&&li!==void 0?li:0)-((Fi=Pe?.headerBytesReceived)!==null&&Fi!==void 0?Fi:0),0),inserted_samples_for_deceleration:Math.max(((Yr=Re?.insertedSamplesForDeceleration)!==null&&Yr!==void 0?Yr:0)-((Ss=Pe?.insertedSamplesForDeceleration)!==null&&Ss!==void 0?Ss:0),0),configured_jitter_buffer_min_delay_ms:Dt??0,jitter_buffer_min_obtainable_delay:R,jitter_buffer_delay_avg:T,packets_discarded:Math.max(((ci=Re?.packetsDiscarded)!==null&&ci!==void 0?ci:0)-((Is=Pe?.packetsDiscarded)!==null&&Is!==void 0?Is:0),0),packets_lost:Te,packets_received:et,nack_count:Math.max((($i=Re?.nackCount)!==null&&$i!==void 0?$i:0)-((ea=Pe?.nackCount)!==null&&ea!==void 0?ea:0),0),removed_samples_for_acceleration:Math.max(((Ns=Re?.removedSamplesForAcceleration)!==null&&Ns!==void 0?Ns:0)-((ms=Pe?.removedSamplesForAcceleration)!==null&&ms!==void 0?ms:0),0),retransmitted_packets_received:Math.max(((vo=Re?.retransmittedPacketsReceived)!==null&&vo!==void 0?vo:0)-((Dl=Pe?.retransmittedPacketsReceived)!==null&&Dl!==void 0?Dl:0),0),retransmitted_bytes_received:Math.max(((yc=Re?.retransmittedBytesReceived)!==null&&yc!==void 0?yc:0)-((cu=Pe?.retransmittedBytesReceived)!==null&&cu!==void 0?cu:0),0),total_samples_received:mn,protocol:(Bu=Fe?.localCandidate)===null||Bu===void 0?void 0:Bu.protocol}})(te,ue,Ee,w,ye,d,b)))}}class La extends ur{constructor(C,P,H,X,te=Fn.PUBLISH,ue=!1,Ee=""){super(Xn.SIMULCAST_LAYER_INFO,C,P,!1),Object.assign(this.properties,{rid:H,active:X,selected:ue,source:te===Fn.PUBLISH?"publisher":"subscriber",remote_participant_id:Ee})}}const Js=j=>{console.warn(`[IVS Stages] ${j}`)};var ro,td,nd;(function(j){j.Mobile="mobile",j.Tablet="tablet",j.Desktop="desktop",j.Tv="tv"})(ro||(ro={})),(function(j){j.IOS="iOS",j.MacOS="macOS",j.Windows="Windows",j.Android="Android"})(td||(td={})),(function(j){j.Safari="Safari",j.Firefox="Firefox",j.Chrome="Chrome",j.IE="Internet Explorer",j.Edge="Microsoft Edge"})(nd||(nd={}));const gp=(function(j){const C=hl(j);return{platform:{isMobile:Jl(ro.Mobile,C),isTablet:Jl(ro.Tablet,C),isDesktop:Jl(ro.Desktop,C),isTv:Jl(ro.Tv,C)},os:{name:dl(C),version:_p(C),isIOS:sa(td.IOS,C),isMacOS:sa(td.MacOS,C),isWindows:sa(td.Windows,C),isAndroid:sa(td.Android,C)},browser:{name:dr(C),version:mc(C),isSafari:br(nd.Safari,C),isFirefox:br(nd.Firefox,C),isChrome:br(nd.Chrome,C),isIE:br(nd.IE,C),isEdge:br(nd.Edge,C)}}})(window.navigator.userAgent);function hl(j){try{return Xp.getParser(j||window.navigator.userAgent)}catch{}}function Jl(j,C){return()=>(C||(C=hl()),!(!C||C.getPlatformType(!0)!==j.toLowerCase()))}function _p(j){return()=>(j||(j=hl()),j&&j.getOSVersion()||"")}function dl(j){return()=>(j||(j=hl()),j&&j.getOSName()||"")}function sa(j,C){return()=>(C||(C=hl()),!(!C||C.getOSName(!0)!==j.toLowerCase()))}function mc(j){return()=>(j||(j=hl()),j&&j.getBrowserVersion()||"")}function dr(j){return()=>(j||(j=hl()),j&&j.getBrowserName()||"")}function br(j,C){return()=>(C||(C=hl()),!(!C||C.getBrowserName().toLowerCase()!==j.toLowerCase()))}const rd={name:"SimulcastUnsupported",message:`Simulcast is only supported on Chromium browsers at bitrates over ${ia.MID.maxBitrateKbps}Kbps`,code:100},go={name:"SimulcastLayerInvalidType",message:"Layer configuration is invalid: ",code:101},Ql={name:"SimulcastMaxLayersExceeded",message:"No more than 3 simulcast layers may be configured",code:102},vp={name:"SimulcastDuplicateLayersConfigured",message:"Two duplicate layers are configured. At minimum bitrate, framerate, or dimensions must differ",code:103},Vo={name:"SimulcastMaxLayerBitrateExceeded",message:`maxBitrateKbps cannot exceed ${to} Kbps`,code:105},pl={name:"SimulcastMinLayerBitrateExceeded",message:`maxBitrateKbps cannot be less than ${Au} Kbps`,code:106},id={name:"SimulcastMaxLayerFramerateExceeded",message:`maxFramerate cannot exceed ${Uc} fps`,code:107},t0={name:"SimulcastMinLayerFramerateExceeded",message:`maxFramerate cannot be less than ${tf} fps`,code:108},of={name:"SimulcastMaxLayerDimensionsExceeded",message:`dimensions cannot exceed max resolution of ${Cu}x720`,code:109},Ua={name:"SimulcastMinLayerDimensionsExceeded",message:`width or height cannot be lower than ${nf}`,code:110},Go={name:"SimulcastLayerConfigurationConflict",message:"Layer configuration conflict: ",code:111},Pd={name:"SimulcastLayerOrientationMismatch",message:"Layer orientation different from input video track: ",code:112},cg={name:"SimulcastLayerInputResolutionInsufficient",message:"Input video resolution is lower than the configured layer: ",code:113},nm={name:"SimulcastLayerInputFramerateInsufficient",message:"Input video framerate is lower than the configured layer: ",code:114};class Va extends Error{constructor({name:C,message:P,code:H,details:X,cause:te,params:ue}){super(P),Error.captureStackTrace&&Error.captureStackTrace(this,Va),this.name=C,this.message=P,this.code=H,this.details=X,this.cause=te,this.params=ue}}const rm=j=>({rid:j.rid,active:j.active,scaleResolutionDownBy:j.scaleFactor,maxBitrate:j.maxBitrateBps,maxFramerate:j.maxFramerate}),n0=(j,C)=>j.width*j.height>C.width*C.height||j.maxBitrateKbps>C.maxBitrateKbps||j.maxFramerate>C.maxFramerate?1:im(j,C)?0:-1,im=(j,C)=>{if(typeof j!="object"||typeof C!="object")return!1;const P=Object.keys(j);for(const H of P)if(j[H]!==C[H])return!1;return!0},sm=j=>{const{width:C,height:P}=Dd(j);return C*P},Dd=j=>{const{height:C,width:P}=j;let H=Cu/rf,X=Cu;return C!==void 0&&(H=C),P!==void 0&&(X=P),C&&!P&&(X=C*rf),!C&&P&&(H=P/rf),{height:H,width:X}},Ld=j=>{const{width:C,height:P}=j;return C/P>=1?yr.LANDSCAPE:yr.PORTRAIT},Iu=(j,C,P)=>{var H;const X=(H=j.getSettings().frameRate)!==null&&H!==void 0?H:Uc;return Object.assign(Object.assign({},P),{active:!0,height:C.height,width:C.width,maxBitrateBps:zr(C.maxBitrateKbps),maxFramerate:Math.min(C.maxFramerate,X),scaleFactor:ug(C,j)})},ug=(j,C)=>{const P=sm(C.getSettings()),H=sm(j);if(H>=P)return 1;const X=1/Math.sqrt(H/P);return Math.max(X,1)},t_=j=>{if(typeof j!="object"){const C=Object.assign({},go);throw C.message+=" is not an object",new Va(C)}},am=(j,C)=>{if(typeof j!="number"){const P=Object.assign({},go);throw P.message+="maxBitrateKbps is not a number",new Va(P)}if(j<Au)throw new Va(Object.assign({},pl));if(j>to)throw new Va(Object.assign({},Vo));if(C&&j>C){const P=Object.assign({},Go);throw P.message+=`maxBitrateKbps cannot be greater than stage maxVideoBitrateKbps of ${C}`,new Va(P)}},Df=(j,C)=>{if(typeof j!="number"){const P=Object.assign({},go);throw P.message+="maxFramerate is not a number",new Va(P)}if(j<tf)throw new Va(Object.assign({},t0));if(j>Uc)throw new Va(Object.assign({},id));if(C&&j>C){const P=Object.assign({},Go);throw P.message+=`maxFramerate cannot be greater than stage maxFramerate of ${C} `,new Va(P)}},Ud=(j,C)=>{var P;if(typeof j!="number"||typeof C!="number"){const te=Object.assign({},go);throw te.message+="width and height must be numbers",new Va(te)}if(j<nf||C<nf)throw new Va(Object.assign({},Ua));const H=(P=ma("enable1080pResolution"))!==null&&P!==void 0&&P,X=H?1920:Cu;if(j>X||C>X)throw new Va(Object.assign({},of));if(j*C>(H?2073600:Mo))throw new Va(Object.assign({},of))},Nu=(j,C)=>{const P=Dd(C.getSettings()),H=Ld(P);H!==Ld(j)&&Js(`${Pd.message}forcing orientation to ${H}`)},ml=(j,C)=>{var P,H,X,te,ue;let Ee=(0,js.cloneDeep)(C);const w=(P=Ee.simulcast)!==null&&P!==void 0?P:{},d=!gp.browser.isChrome()&&!gp.browser.isEdge(),b=(X=(H=j.getSettings())===null||H===void 0?void 0:H.displaySurface)!==null&&X!==void 0&&X,O=(te=Ee.maxVideoBitrateKbps)!==null&&te!==void 0?te:to,F=!(Array.isArray((ue=C.simulcast)===null||ue===void 0?void 0:ue.layers)||!C.maxVideoBitrateKbps)&&O<ia.MID.maxBitrateKbps;if(typeof w.enabled=="boolean"&&w.enabled&&(d||b||F)){Ee.simulcast={enabled:!1};const{name:ie,message:pe}=rd;Js(`${ie}${pe}, disabling the feature`)}return Ee=((ie,pe)=>{var ye,Re;const Pe=pe,Fe=(ye=pe.simulcast)===null||ye===void 0?void 0:ye.layers;if(Fe===void 0)return Pe;if(!Array.isArray(Fe)){const Ye=Object.assign({},go);throw Ye.message+=" layers is not an array",new Va(Ye)}if(Fe.length===0)return(Re=Pe.simulcast)===null||Re===void 0||delete Re.layers,Pe;if(Fe.length>3)throw new Va(Object.assign({},Ql));if((0,js.uniqWith)(Fe,im).length!==Fe.length)throw new Va(Object.assign({},vp));for(const Ye of Fe)t_(Ye),am(Ye.maxBitrateKbps,pe.maxVideoBitrateKbps),Df(Ye.maxFramerate,pe.maxFramerate),Ud(Ye.width,Ye.height),Nu(Ye,ie);return Pe})(j,Ee),Ee};function Bc(j){return j.track.kind===ef.AUDIO}function om(j){return j.track.kind===ef.VIDEO&&typeof j.config=="object"}function r0(j){if(j!==void 0&&(j<Au||j>to))throw new Error(`Stage bitrate must be a number between ${Au} kbps and ${to} kbps inclusive`)}function lm(j){return j!==void 0&&("maxBitrate"in j||"maxVideoBitrateKbps"in j||"maxFramerate"in j||"simulcast"in j||"inBandMessaging"in j||"minBitrate"in j)}function fg(j,C){if(C===void 0)return C;let P=(0,js.cloneDeep)(C);return lm(P)?(P.maxBitrate!==void 0&&(P.maxVideoBitrateKbps=P.maxBitrate,Js("maxBitrate is deprecated in favor of maxVideoBitrateKbps")),P=ml(j,P),r0(P.maxVideoBitrateKbps),r0(P.minBitrate),(function(H){if(H!==void 0&&(H>Uc||H<tf))throw new Error(`Stage framerate must be between ${tf} fps and ${Uc} fps inclusive`)})(P.maxFramerate),(function(H){if(H!==void 0){if(typeof H!="object")throw new Error("In-band messaging config must be an object");if(typeof H.enabled!="boolean")throw new Error("In-band messaging config enabled property must be a boolean")}})(P.inBandMessaging)):((function(H){if(H!==void 0&&(H<sf||H>Oo))throw new Error(`Stage audio bitrate must be between ${sf} Kbps and ${Oo} Kbps inclusive`)})(P.maxAudioBitrateKbps),(function(H){if(H!==void 0&&typeof H!="boolean")throw new Error("Stage stereo prop must be a boolean")})(P.stereo)),P}const i0=(j,C,P)=>{var H;const X={[Ur.HI]:Lc(Ur.HI),[Ur.MID]:Lc(Ur.MID),[Ur.LOW]:Lc(Ur.LOW)},te=C.simulcast,ue=P?.simulcast;let Ee=te.layers.sort(n0);const w=(H=ue?.layers)!==null&&H!==void 0?H:[],d=Ee.length,b=w.length;return Ee=Ee.map((O=>{((ie,pe)=>{const{width:ye,height:Re}=Dd(pe.getSettings()),{width:Pe,height:Fe}=ie;if(Pe*Fe>ye*Re){const Ye=`forcing layer of ${Pe}x${Fe} to the input dimensions ${ye}x${Re}`,{name:dt,message:xt}=cg;Js(`${dt}${xt}${Ye}`)}})(O,j),((ie,pe)=>{var ye;const Re=(ye=pe.getSettings().frameRate)!==null&&ye!==void 0?ye:Uc,Pe=ie.maxFramerate;if(Pe>Re){const Fe=`forcing layer of ${Pe}fps to the input framerate of ${Re}`,{name:Ye,message:dt}=nm;Js(`${Ye}${dt}${Fe}`)}})(O,j);let F=((ie,pe)=>{const{maxVideoBitrateKbps:ye}=pe,Re=ie;return ye&&ie.maxBitrateKbps>ye&&(Re.maxBitrateKbps=ye),Re})(O,C);return F=((ie,pe)=>{const{maxFramerate:ye}=pe,Re=ie;return ye&&ie.maxFramerate>ye&&(Re.maxFramerate=ye),Re})(O,C),F})),(b===0||b===3)&&d===3?(X.hi=Iu(j,Ee[2],X.hi),X.mid=Iu(j,Ee[1],X.mid),X.low=Iu(j,Ee[0],X.low),Jn.ok(X)):b===1&&d===1?(X.hi=Iu(j,Ee[0],X.hi),Jn.ok(X)):b===2&&d===2?(X.hi=Iu(j,Ee[1],X.hi),X.low=Iu(j,Ee[0],X.low),Jn.ok(X)):Jn.err(null)},s0=(j,C,P)=>{const H=C.simulcast,X=C.inBandMessaging,te=zr(C.minBitrate),ue=zr(C.maxVideoBitrateKbps),Ee=C.maxFramerate;let w=[{maxBitrate:ue,maxFramerate:Ee}];const d=i0(j,C,P??{});return H.enabled&&d.ok&&(w=(b=>{const{hi:O,mid:F,low:ie}=b;return[rm(ie),rm(F),rm(O)]})(d.value)),{track:j,config:{minBitrateBps:te,maxBitrateBps:ue,maxFramerate:Ee,inBandMessagingEnabled:X.enabled,simulcastEnabled:H.enabled,simulcastLayers:d.ok?d.value:void 0,encodingLayers:w}}},cm=j=>{const C=j.mediaStreamTrack,P=j.normalizedConfig;let H={};const X=j.validatedExternalConfig;return lm(X)&&(H=X),(function(te){return te.kind===ef.AUDIO})(C)?((te,ue)=>{const Ee={maxBitrateBps:zr(ue.maxAudioBitrateKbps)},w=ue?.stereo;return typeof w=="boolean"&&(Ee.stereo=w),{track:te,config:Ee}})(C,P):s0(C,P,H)},n_=(j,C)=>{const P={minBitrate:Au,maxBitrate:to,maxVideoBitrateKbps:to,maxFramerate:Uc,simulcast:{enabled:!1,layers:[Object.assign({},ia.HI),Object.assign({},ia.MID),Object.assign({},ia.LOW)]},maxAudioBitrateKbps:em,stereo:!1,inBandMessaging:{enabled:!1}},H=(0,js.cloneDeep)(C),X=Object.assign(Object.assign({},P),H);return lm(H)&&(H.simulcast&&(X.simulcast=Object.assign(Object.assign({},P.simulcast),H.simulcast)),H.inBandMessaging&&(X.inBandMessaging=Object.assign(Object.assign({},P.inBandMessaging),H.inBandMessaging))),X},um=(j,C)=>{if(typeof j=="number")return j;const P=C?Hr:Mu;return P[j]!==void 0?P[j]:0};class a0 extends ur{constructor(C,P,H,X){super(Xn.MULTIHOST_CONFIGURATION,C,P,!1),Object.assign(this.properties,Object.assign(Object.assign({},H),{action:X}))}}class Pu extends ur{constructor(C,P,H,X,te){super(Xn.MULTIHOST_SUBSCRIBE_CONFIGURATION,C,P,!1);const ue={trigger:H,remote_participant_id:X,min_delay_when_publishing:um(te.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:um(te.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:te.inBandMessaging.enabled,simulcast_initial_layer_preference:te.simulcast.initialLayerPreference,simulcast_layer_poll_interval_ms:te.simulcast.layerPollingIntervalMs,simulcast_layer_poll_enabled:te.simulcast.layerPollingEnabled};Object.assign(this.properties,ue)}}var ec=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class hg{constructor(C,P,H,X,te){this.analyticsTracker=te,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new wi(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=hg.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.seiStats={seiReadCnt:0,seiBytesRead:0,seiWriteCnt:0,seiBytesWritten:0},this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0},this.vidNetworkQualityMap=new Map,this.audioNetworkQualityMap=new Map,this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case sr.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case sr.FAILED:this.flushStats()}},this.action=C,this.token=P,this.traceId=H,this.identifier=X}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:zr(Oo),hi_video_layer:"",mid_video_layer:"",low_video_layer:""}}set sdpAnswer(C){try{this.sdp=new wi(C),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(C,P=!1){this.peerConnection=C,this.simulcastEnabled=P,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var C;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(C=this.peerConnection)===null||C===void 0||C.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(C){this.sfuResource=C}updateMultihostConfiguration(C,P){var H,X,te,ue,Ee,w,d,b,O;return ec(this,void 0,void 0,(function*(){if(this.action!==Fn.PUBLISH||!this.peerConnection)return;const F=hg.defaultMultihostConfiguration();if(P){const ie=this.peerConnection.getSenders().filter((Re=>Re.track!==null&&Re.track.kind==="video"));let pe="unknown";ie.length>0&&(yield ie[0].getStats()).forEach((Re=>{if(Re.type==="codec"&&(F.video_codec=Re.mimeType,Re.sdpFmtpLine)){const Pe=Re.sdpFmtpLine.match(/profile-level-id=([a-f0-9]+)/);Pe&&Pe.length>0&&(pe=Pe[1])}}));const ye=P.track.getSettings();F.width=(H=ye.width)!==null&&H!==void 0?H:0,F.height=(X=ye.height)!==null&&X!==void 0?X:0,F.target_fps=(te=ye.frameRate)!==null&&te!==void 0?te:0,P.config?(F.max_bitrate=P.config.maxBitrateBps,F.min_bitrate=P.config.minBitrateBps,F.enable_simulcast=P.config.simulcastEnabled):(F.max_bitrate=zr(to),F.min_bitrate=zr(Au),F.enable_simulcast=!1),P.config.simulcastEnabled&&(F.hi_video_layer=this.mapLayerToMetric(pe,(ue=P.config.simulcastLayers)===null||ue===void 0?void 0:ue.hi),F.mid_video_layer=this.mapLayerToMetric(pe,(Ee=P.config.simulcastLayers)===null||Ee===void 0?void 0:Ee.mid),F.low_video_layer=this.mapLayerToMetric(pe,(w=P.config.simulcastLayers)===null||w===void 0?void 0:w.low))}if(C){const ie=C.track.getSettings();F.auto_gain=(d=ie.autoGainControl)!==null&&d!==void 0&&d,F.echo_cancellation=(b=ie.echoCancellation)!==null&&b!==void 0&&b,F.noise_suppression=(O=ie.noiseSuppression)!==null&&O!==void 0&&O,F.max_audio_bitrate_bps=C.config.maxBitrateBps,F.stereo=C.config.stereo}(0,js.isEqual)(F,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new a0(this.token,this.traceId,F,this.action)),this.multihostConfiguration=F)}))}resetTransformers(C,P){this.senderVideoTransformer=P,this.receiveVideoTransformer=C,this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0}}getStats(C){var P;return ec(this,void 0,void 0,(function*(){const H=yield(P=this.peerConnection)===null||P===void 0?void 0:P.getStats(C),{action:X}=this;if(H)if(C.kind==="audio"){if(X===Fn.PUBLISH)return{action:X,rawReport:H,stats:Il(H,this.audioNetworkQualityMap)};if(X===Fn.SUBSCRIBE)return{action:X,rawReport:H,stats:Id(H,this.audioNetworkQualityMap)}}else{if(X===Fn.PUBLISH)return{action:X,rawReport:H,stats:eu(H,this.vidNetworkQualityMap)};if(X===Fn.SUBSCRIBE)return{action:X,rawReport:H,stats:Nd(H,this.vidNetworkQualityMap)}}}))}mapLayerToMetric(C,P){return!P||!P.active?"":`${`${P.height}x${P.width}`}_${`${P.maxFramerate}fps`}_${P.maxBitrateBps/1e3+"kbps"}_${C}`}updateJitterBufferMinDelay(C){this.jitterBufferMinDelayInMs=C}setupIntervals(){this.action===Fn.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(C,P){return setInterval(C.bind(this),P)}getConnectionState(){var C;if(!this.peerConnection)return sr.NONE;const P=(C=this.peerConnection.connectionState)!==null&&C!==void 0?C:this.peerConnection.iceConnectionState;try{return Qp(P)}catch{return sr.IDLE}}pollSimulcastLayers(){var C;return ec(this,void 0,void 0,(function*(){if(this.getConnectionState()===sr.CONNECTED){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();if(!P)return;P.forEach((H=>{var X;if(H.type==="outbound-rtp"){const te=((X=H.framesPerSecond)!==null&&X!==void 0?X:0)!==0;switch(H.rid){case"low":te!==this.simulcastState.low&&(this.simulcastState.low=te,this.analyticsTracker.trackEventNoSharedProps(new La(this.token,this.traceId,H.rid,te)));break;case"mid":te!==this.simulcastState.mid&&(this.simulcastState.mid=te,this.analyticsTracker.trackEventNoSharedProps(new La(this.token,this.traceId,H.rid,te)));break;case"hi":te!==this.simulcastState.hi&&(this.simulcastState.hi=te,this.analyticsTracker.trackEventNoSharedProps(new La(this.token,this.traceId,H.rid,te)))}}}))}}))}flushStats(){var C;return ec(this,void 0,void 0,(function*(){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();P&&(this.action===Fn.PUBLISH?this.uploadPublisherStats(P):this.action===Fn.SUBSCRIBE&&this.uploadSubscriberStats(P))}))}uploadStats(){var C;return ec(this,void 0,void 0,(function*(){if(this.getConnectionState()===sr.CONNECTED){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();if(!P)return;this.action===Fn.PUBLISH?this.uploadPublisherStats(P):this.action===Fn.SUBSCRIBE&&this.uploadSubscriberStats(P)}}))}uploadPublisherStats(C){var P,H;const X={audio:{},video:[],candidateStats:{}},te=new Map,ue=(Date.now()-this.connectionStartedTimestamp)/1e3,Ee=Object.assign({},this.multihostConfiguration),{seiWriteCnt:w,seiBytesWritten:d}=this.updateAndDiffSeiPublishStatsSinceLastUpdate((P=this.senderVideoTransformer)===null||P===void 0?void 0:P.getSenderStats());if(this.seiStats.seiWriteCnt+=w,this.seiStats.seiBytesWritten+=d,C.forEach((b=>{if(b.type==="outbound-rtp"){const O=C.get(b.remoteId),F=this.prevRemoteInboundStats.get(b.remoteId);switch(O&&this.prevRemoteInboundStats.set(O.id,O),b.kind){case"audio":X.audio=this.updateOutboundAudio(b),X.audio.remoteInbound=O,X.audio.prevRemoteInbound=F,X.audio.codec=te.get(b.codecId);break;case"video":X.video.push(Object.assign({},this.updateOutboundVideo(b),{remoteInbound:O,prevRemoteInbound:F,codec:te.get(b.codecId)}))}}b.type==="candidate-pair"&&b.nominated&&(X.candidateStats.candidatePair=b,X.candidateStats.localCandidate=C.get(b.localCandidateId),X.candidateStats.remoteCandidate=C.get(b.remoteCandidate)),b.type==="codec"&&te.set(b.id,b)})),X.video.forEach((b=>{var O,F;const{outbound:ie,prevOutbound:pe}=b;if(!ie)return;const ye=(F=(O=b.outbound)===null||O===void 0?void 0:O.rid)!==null&&F!==void 0?F:Oe;this.updateNetworkQualityPublish(ye,this.vidNetworkQualityMap,ie,pe)})),X.audio.outbound){const b=(H=X.audio.outbound.rid)!==null&&H!==void 0?H:Oe;this.updateNetworkQualityPublish(b,this.audioNetworkQualityMap,X.audio.outbound,X.audio.prevOutbound)}this.analyticsTracker.trackEventNoSharedProps(new ku(this.token,this.traceId,this.sfuResource,X.audio.outbound,X.audio.remoteInbound,X.candidateStats,X.audio.codec,Ee,ue,this.sdpFeatures)),X.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new fl(this.token,this.traceId,this.sfuResource,X.audio.outbound,X.audio.prevOutbound,X.audio.remoteInbound,X.audio.prevRemoteInbound,X.candidateStats,X.audio.codec,Ee,this.sdpFeatures)),X.video.forEach((b=>{this.analyticsTracker.trackEventNoSharedProps(new qa(this.token,this.traceId,this.sfuResource,b.outbound,b.remoteInbound,X.candidateStats,b.codec,Ee,ue)),b.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new ed(this.token,this.traceId,this.sfuResource,b.outbound,b.prevOutbound,b.remoteInbound,b.prevRemoteInbound,X.candidateStats,b.codec,Ee,this.seiStats.seiWriteCnt,this.seiStats.seiBytesWritten))}))}updateNetworkQualityPublish(C,P,H,X){var te,ue,Ee,w;let d=0;const b=ga.getNetworkQuality(),O=(te=H.packetsSent)!==null&&te!==void 0?te:0,F=(ue=H.nackCount)!==null&&ue!==void 0?ue:0;if(X)if(b===uo.DOWN)P.set(C,uo.DOWN);else{d=(F-((Ee=X?.nackCount)!==null&&Ee!==void 0?Ee:0))/(O-((w=X?.packetsSent)!==null&&w!==void 0?w:0));const ie=this.convertLostRatioToQuality(d);P.set(C,ie)}else P.set(C,b)}updateNetworkQualitySubscribe(C,P,H){var X,te,ue,Ee;let w=0;const d=ga.getNetworkQuality(),b=(X=P?.packetsReceived)!==null&&X!==void 0?X:0,O=(te=P?.nackCount)!==null&&te!==void 0?te:0;if(!P)return;const F=P.id;if(F)if(H)if(d===uo.DOWN)C.set(F,uo.DOWN);else{w=(O-((ue=H?.nackCount)!==null&&ue!==void 0?ue:0))/(b-((Ee=H?.packetsReceived)!==null&&Ee!==void 0?Ee:0));const ie=this.convertLostRatioToQuality(w);C.set(F,ie)}else C.set(F,d)}uploadSubscriberStats(C){var P,H;const X={audio:{},video:{},candidateStats:{}},te=new Map,ue=(Date.now()-this.connectionStartedTimestamp)/1e3,Ee=(P=this.jitterBufferMinDelayInMs)!==null&&P!==void 0?P:0,{seiReadCnt:w,seiBytesRead:d}=this.updateAndDiffSeiSubscribeStatsSinceLastUpdate((H=this.receiveVideoTransformer)===null||H===void 0?void 0:H.getReceiverStats());this.seiStats.seiReadCnt+=w,this.seiStats.seiBytesRead+=d,C.forEach((b=>{if(b.type==="inbound-rtp")switch(b.kind){case"audio":X.audio=this.updateInboundAudio(b),X.audio.codec=te.get(b.codecId),this.updateNetworkQualitySubscribe(this.audioNetworkQualityMap,X.audio.inbound,X.audio.prevInbound);break;case"video":X.video=this.updateInboundVideo(b),X.video.codec=te.get(b.codecId),this.updateNetworkQualitySubscribe(this.vidNetworkQualityMap,X.video.inbound,X.video.prevInbound)}b.type==="candidate-pair"&&b.nominated&&(X.candidateStats.candidatePair=b,X.candidateStats.localCandidate=C.get(b.localCandidateId),X.candidateStats.remoteCandidate=C.get(b.remoteCandidate)),b.type==="codec"&&te.set(b.id,b)})),this.analyticsTracker.trackEventNoSharedProps(new qo(this.token,this.traceId,this.identifier,this.sfuResource,X.audio.inbound,X.candidateStats,X.audio.codec,ue,this.sdpFeatures)),X.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new e0(this.token,this.traceId,this.identifier,this.sfuResource,X.audio.inbound,X.audio.prevInbound,X.candidateStats,X.audio.codec,this.sdpFeatures,Ee)),this.analyticsTracker.trackEventNoSharedProps(new no(this.token,this.traceId,this.identifier,this.sfuResource,X.video.inbound,X.candidateStats,X.video.codec,ue)),X.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new pc(this.token,this.traceId,this.identifier,this.sfuResource,X.video.inbound,X.video.prevInbound,X.candidateStats,X.video.codec,Ee,this.seiStats.seiReadCnt,this.seiStats.seiBytesRead))}updateAndDiffSeiSubscribeStatsSinceLastUpdate(C){const P=this.prevVideoReceiverTransformerStats;if(!C)return{seiReadCnt:P.seiReadCnt,seiBytesRead:P.seiBytesRead};const H=C.seiReadCnt-P.seiReadCnt,X=C.seiBytesRead-P.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:C.seiReadCnt,seiBytesRead:C.seiBytesRead},{seiReadCnt:H,seiBytesRead:X}}updateAndDiffSeiPublishStatsSinceLastUpdate(C){const P=this.prevVideoSenderTransformerStats;if(!C)return{seiWriteCnt:P.seiWriteCnt,seiBytesWritten:P.seiBytesWritten};const H=C.seiWriteCnt-P.seiWriteCnt,X=C.seiBytesWritten-P.seiBytesWritten;return this.prevVideoSenderTransformerStats={seiWriteCnt:C.seiWriteCnt,seiBytesWritten:C.seiBytesWritten},{seiWriteCnt:H,seiBytesWritten:X}}updateOutboundAudio(C){const P=C,H=this.prevOutboundAudioStats,X=C.id===H?.id?H:void 0;return this.prevOutboundAudioStats=C,{outbound:P,prevOutbound:X}}updateInboundAudio(C){const P=C,H=this.prevInboundAudioStats,X=C.id===H?.id?H:void 0;return this.prevInboundAudioStats=C,{inbound:P,prevInbound:X}}updateInboundVideo(C){const P=C,H=this.prevInboundVideoStats.get(Oe),X=C.id===H?.id?H:void 0;return this.prevInboundVideoStats.set(Oe,C),{inbound:P,prevInbound:X}}updateOutboundVideo(C){const P=C,H=this.getPrevOutboundVideo(C),X=C.id===H?.id?H:void 0;return this.setPrevVideoStat(C),{outbound:P,prevOutbound:X}}getPrevOutboundVideo(C){return this.simulcastEnabled&&C.rid&&this.prevOutboundVideoStats.has(C.rid)?this.prevOutboundVideoStats.get(C.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(Oe)?this.prevOutboundVideoStats.get(Oe):void 0}setPrevVideoStat(C){this.simulcastEnabled&&C.rid?this.prevOutboundVideoStats.set(C.rid,C):this.simulcastEnabled||this.prevOutboundVideoStats.set(Oe,C)}convertLostRatioToQuality(C){return C<=0?uo.EXCELLENT:C<=.01?uo.GOOD:C<=.03?uo.NORMAL:C<=.1?uo.POOR:uo.DOWN}}class dg extends ur{constructor(C,P,H,X,te){super(Xn.MINUTE,C,P,!1),Object.assign(this.properties,{action:X?Fn.PUBLISH:Fn.SUBSCRIBE,is_publishing:X,minutes_logged:H,subscribed_number:te})}}class o0 extends ur{constructor(C){super(Xn.PUBLISH,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID})}}class l0 extends ur{constructor(C){super(Xn.UNPUBLISH,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID})}}class r_ extends ur{constructor(C){var P,H,X,te;super(Xn.SUBSCRIBE,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.subscribedId,subscribed_id:C.subscribedId,is_edp_connected:C.isEdpConnected,is_reassignment:C.isReassignment,node:(H=(P=C.preAttemptSfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.preAttemptSfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:""})}}class K_ extends ur{constructor(C){super(Xn.UNSUBSCRIBE,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.unsubscribedId,unsubscribed_id:C.unsubscribedId})}}class c0 extends ur{constructor(C){var P,H,X,te;super(Xn.PUBLISH_STARTED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,options_duration:C.optionsDuration,post_duration:C.postDuration,remote_participant_id:C.token.participantID,time_to_candidate:C.timeToCandidate,total_duration:C.totalDuration,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",publish_retry_times:C.publishRetries,total_duration_with_retries:C.totalDurationWithRetries,protocol:C.protocol})}}class u0 extends ur{constructor(C){super(Xn.PUBLISH_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,protocol:C.protocol})}}class i_ extends ur{constructor(C){super(Xn.PUBLISH_ENDED,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID,unpublish_successful:C.isUnpublishSuccessful,reason:C.reason,protocol:C.protocol})}}class Z_ extends ur{constructor(C){var P,H,X,te;super(Xn.SUBSCRIBE_STARTED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,options_duration:C.optionsDuration,post_duration:C.postDuration,remote_participant_id:C.remoteParticipantId,time_to_candidate:C.timeToCandidate,total_duration:C.totalDuration,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_initial_state_publishing_count:C.edpInitialStatePublishingCount,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",total_duration_with_retries:C.totalDurationWithRetries,subscribe_retry_times:C.subscribeRetryTimes,is_reassignment:C.isReassignment,protocol:C.protocol})}}class pg extends ur{constructor(C){super(Xn.SUBSCRIBE_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,is_reassignment:C.isReassignment,protocol:C.protocol})}}class mg extends ur{constructor(C){super(Xn.SUBSCRIBE_ENDED,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,unsubscribe_successful:C.isUnsubscribeSuccessful,reason:C.reason,protocol:C.protocol}),this.critical=!0}}class f0 extends ur{constructor(C){super(Xn.STATE_UPDATED,C.token,C.traceId,!1),Object.assign(this.properties,{audio_muted:C.isAudioMuted,is_disconnected:C.isDisconnected,is_publishing:C.isPublishing,other_participant_id:C.otherParticipantId,other_participant_user_id:C.otherParticipantUserId,video_stopped:C.isVideoStopped})}}class J_ extends ur{constructor(C){var P,H,X,te,ue;super(Xn.FIRST_FRAME,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_initial_state_publishing_count:C.edpInitialStatePublishingCount,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",video_was_paused:C.videoWasPaused,first_frame_duration:C.firstFrameDuration,total_duration_with_retries:C.totalDurationWithRetries,subscribe_retry_times:C.subscribeRetryTimes,media_type:C.mediaType,configured_jitter_buffer_min_delay_ms:(ue=C.currentJitterBufferMinDelayInMs)!==null&&ue!==void 0?ue:0,protocol:C.protocol})}}class tu extends ur{constructor(C){super(Xn.EDP_PONG,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol,edp_rtt:C.edpRttMs})}}class sd extends ur{constructor(C){super(Xn.JOIN,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint})}}class yp extends ur{constructor(C){super(Xn.JOIN_ATTEMPT,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint})}}class s_ extends ur{constructor(C){super(Xn.JOIN_ATTEMPT_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,connect_retry_times:C.retryCnt})}}class Q_ extends ur{constructor(C){super(Xn.EDP_DISCONNECTED,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol}),this.critical=!0}}class bp extends ur{constructor(C){super(Xn.EDP_CONNECTED,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol,connect_retry_times:C.numRetries}),this.critical=!0}}class fm{constructor(C,P,H){this.token=C,this.analyticsTracker=H,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.maxConnectRetries=6,this.connectionAttempts=0,this.latestSequenceNumber=0,this.nextConnectionAttemptId=0,this.connectTimeoutId=0,this.latestPingTimestamp=0,this.pingIntervalId=0,this.pongTimeoutId=0,this.pingIntervalMs=15e3,this.pongTimeoutMs=3e4,this.attemptConnect=Ee=>{this.latestSequenceNumber=0,this.traceId=Ee||Ks(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:w,rawToken:d}=this.token;this.connecting=!0,this.closing=!1;try{const b=encodeURIComponent(this.traceId.value),O=`topic=${w}/publishers`,F=`traceid=${b}`,ie="error_over_ws=1",pe=`${this.addr}?${ie}&${O}&${F}`;this.socket=this.createWebSocket(pe,d),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(b){const O=b instanceof Error?b.message:void 0,F=this.createError(hn.EVENT_PLANE_WS_CREATE_FAILED,O);this.trackJoinFailed(F,this.getRetryCount()),this.emitter.emit(Zs,F)}},this.triggerSocketOpen=Ee=>{this.clearConnectionAttemptTimeouts();const w=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(w),this.emitter.emit(Ru,{retryCnt:w,traceId:this.traceId,initialStageState:Ee}),this.pingIntervalId=window.setInterval(this.ping,this.pingIntervalMs)},this.ping=()=>{var Ee;if(this.logger.debug({msg:`${this.id}sending PING`}),!this.isSocketOpen()){const w=`${this.id} attempting to ping an unopened socket`;return this.logger.warn({msg:w}),void this.traceJoinOp(w)}this.latestPingTimestamp=performance.now(),this.pongTimeoutId===0&&(this.pongTimeoutId=window.setTimeout(this.pongTimedOut,this.pongTimeoutMs)),(Ee=this.socket)===null||Ee===void 0||Ee.send(JSON.stringify({type:"PING"}))},this.pongTimedOut=()=>{if(!this.isSocketOpen()){const w=`${this.id} attempting pong timeout on an unopened socket`;return this.logger.warn({msg:w}),void this.traceJoinOp(w)}this.logger.debug({msg:`${this.id} Pong timed out!`}),this.clearPingPongTracking();const Ee=this.createError(hn.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(Zs,Ee)},this.beforeUnload=()=>{this.emitter.emit(ai,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(Ee,w,d,b,O,F,ie,pe)=>{var ye;const Re={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:w,requestId:b,traceId:d,platform:"web",sdk:"1.27.0",whipVersion:Zc,content:Ee,contentType:"application/sdp"}};O&&(Re.payload.forceNode=O),F&&(Re.payload.assignmentToken=F),ie&&(Re.payload.multiCodec=ie);const Pe=rh()===void 0,Fe=rh()||Pe;pe&&Fe&&(Re.payload.initialLayerPref=mp(pe)),(ye=this.socket)===null||ye===void 0||ye.send(JSON.stringify(Re))},this.checkNonFatalRetriesLimit=Ee=>{if(Ee.fatal||this.connectionAttempts<=this.maxConnectRetries)return Jn.ok(!0);this.logger.debug({msg:`${this.id} maximum non-fatal retries of ${this.maxConnectRetries} exceeded`});const w=this.createError(hn.JOIN_TIMED_OUT);return Jn.err(w)},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackSocketError=Ee=>{this.connecting&&this.trackJoinFailed(Ee,this.getRetryCount()),this.analyticsTracker.trackError(Ee)},this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new Q_({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.traceJoinOp=Ee=>{this.analyticsTracker.trackEventNoSharedProps(new Co(this.token,this.traceId,Ee,Fn.JOIN))},this.logger=new wn(P,_e.SOCKET),this.emitter=new ei.EventEmitter,this.traceId=Ks(),this.id=`[${As().value}] `;const X=zh("socketPingMs");X!==void 0&&(this.pingIntervalMs=X);const te=zh("socketPongMs");te!==void 0&&(this.pongTimeoutMs=te);const ue=zh("socketConnectMaxRetries");ue!==void 0&&(this.maxConnectRetries=ue),window.addEventListener("beforeunload",this.beforeUnload)}connect(C,P,H=!1){this.close(),this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=C,this.traceId=P,H&&!this.connecting&&(window.clearTimeout(this.connectTimeoutId),this.connectTimeoutId=window.setTimeout(this.connectTimedOut.bind(this),12e3)),this.attemptConnect(P)}send(C){var P;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(C)}`}),this.logger.debug({msg:`${this.id}isReady called`}),this.isSocketOpen()?(P=this.socket)===null||P===void 0||P.send(JSON.stringify(C)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const C=this.connecting,P=this.isSocketOpen(),H=this.socket&&this.socket.readyState===this.socket.CLOSING,X=this.getRetryCount();if(this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.connectionAttempts=0,this.socket){if(this.cleanupWebSocket(),P&&this.isStateMessageReceived())this.trackJoinEnded(),this.emitter.emit(ai,"intentional-close");else if(C&&!H){const te=this.createError(hn.OPERATION_ABORTED);this.trackJoinFailed(te,X),this.analyticsTracker.trackError(te),this.emitter.emit(Zs,te)}}}markSocketAsClosed(){this.closing=!0,this.connecting=!1}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(C,P){return new WebSocket(C,P)}cleanupWebSocket(){this.socket&&(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,this.socket=void 0)}createError(C,P){return new Fr(Object.assign({action:Fn.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:ve,details:P},C))}on(C,P){this.emitter.on(C,P)}off(C,P){this.emitter.off(C,P)}onMessage(C){this.logger.debug({msg:`${this.id}received message: ${C.data}`});try{const P=JSON.parse(C.data);switch(P.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const H=P.payload.sequenceNumber;H>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&this.connectTimeoutId>0?(this.triggerSocketOpen(P),window.setTimeout((()=>{this.emitter.emit(Ao,P)}))):this.emitter.emit(Ao,P),this.latestSequenceNumber=H);break}case"PONG":window.clearTimeout(this.pongTimeoutId),this.pongTimeoutId=0,this.analyticsTracker.trackEventNoSharedProps(new tu({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp}));break;case"REFRESH":this.emitter.emit(Jp);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(Cs,P.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(ti,P.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(Dc,P.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(yi,P.payload);break;case"aws:ivs:SSU":this.emitter.emit(Wh,P.payload);break;case"aws:ivs:JOIN_ERROR":this.handleJoinError(P.payload);break;default:(0,js.noop)()}}catch(P){this.logger.debug({msg:`onMessage JSON Parse error: ${P}`}),this.emitter.emit($h,P)}}onError(C){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(C)}`})}onClose(C){if(this.logger.debug({msg:`${this.id} onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.clearPingPongTracking(),this.closing)return void(this.closing=!1);if(this.windowUnloading)return;const P=`code: ${C?.code}, reason: ${C?.reason}, wasClean: ${C?.wasClean}`;if(this.connecting){const X=this.createError(hn.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,P);return void this.handleSocketError(X)}this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(ai,"unknown");const H=this.createError(hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE,P);this.trackJoinEnded(),this.emitter.emit(Zs,H)}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),this.connectTimeoutId=window.setTimeout(this.triggerSocketOpen,12e3)}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttemptId),window.clearTimeout(this.connectTimeoutId),this.nextConnectionAttemptId=0,this.connectTimeoutId=0}clearConnectionAttempts(){this.connectionAttempts=0}connectTimedOut(){this.connecting=!1,this.logger.debug({msg:`${this.id} Connect timed out!`});const C=this.createError(hn.JOIN_TIMED_OUT);this.isSocketConnecting()&&this.trackJoinFailed(C,this.getRetryCount()),this.emitter.emit(Zs,C),this.close()}clearPingPongTracking(){window.clearInterval(this.pingIntervalId),window.clearTimeout(this.pongTimeoutId),this.pingIntervalId=0,this.pongTimeoutId=0}handleJoinError(C){const P=(function(X){var te,ue;let Ee;switch(X.code){case Al.TOKEN_EXPIRED:Ee=hn.EXPIRED_TOKEN;break;case Al.TOKEN_INVALID:case Al.TOKEN_INVALID_SIGNATURE:case Al.TOKEN_MISSING:Ee=hn.MALFORMED_TOKEN;break;case Al.STAGE_DELETED:Ee=hn.STAGE_DELETED;break;case Al.PARTICIPANT_DISCONNECTED:Ee=hn.PARTICIPANT_DISCONNECTED;break;case Al.INTERNAL:Ee=hn.JOIN_SERVER_INTERNAL_ERROR;break;case Al.BAD_REQUEST:Ee=hn.JOIN_SERVER_BAD_REQUEST;break;default:Ee=Object.assign(Object.assign({},hn.JOIN_FAILURE),{message:X.message||hn.JOIN_FAILURE.message})}return Object.assign(Object.assign({},Ee),{fatal:(te=X.fatal)!==null&&te!==void 0?te:Ee.fatal,nominal:(ue=X.nominal)!==null&&ue!==void 0?ue:Ee.nominal})})(C),H=this.createError(P,`JOIN_ERROR: ${C.code}`);this.logger.debug({msg:`${this.id} received JOIN_ERROR: ${JSON.stringify(C)}`}),this.handleSocketError(H)}handleSocketError(C){const P=this.checkNonFatalRetriesLimit(C);let H=C;P.ok||(H=P.error,H.details=`Timeout triggered by ${C.code}`),this.trackSocketError(H),this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.cleanupWebSocket(),H.fatal?(this.clearConnectionAttempts(),this.emitter.emit(Zs,H)):this.queueExponentialBackoffRetry()}queueExponentialBackoffRetry(){let C=Math.pow(2,this.connectionAttempts-1);C>32&&(C=32),this.logger.debug({msg:`${this.id} reconnecting in ${C} seconds`}),window.clearTimeout(this.nextConnectionAttemptId),this.nextConnectionAttemptId=window.setTimeout(this.attemptConnect,1e3*C)}isSocketConnecting(){return this.socket&&this.socket.readyState===this.socket.CONNECTING}isSocketOpen(){return this.socket&&this.socket.readyState===this.socket.OPEN}isStateMessageReceived(){return this.latestSequenceNumber!==0}trackJoinStarted(C){this.analyticsTracker.trackEventNoSharedProps(new bp({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:C,protocol:this.protocol,traceId:this.traceId}))}trackJoinAttempt(C){const{token:P,traceId:H}=this;this.analyticsTracker.trackEvent(new yp({token:P,eventEndpoint:P?.eventsURL||"",whipEndpoint:P?.whipURL||"",traceId:H}))}trackJoinFailed(C,P){const{token:H,traceId:X,code:te,message:ue,fatal:Ee,nominal:w}=C;this.analyticsTracker.trackEvent(new s_({token:H,eventEndpoint:H.eventsURL,whipEndpoint:H.whipURL,traceId:X,code:te,message:ue,fatal:Ee,nominal:w,retryCnt:P}))}}var Bd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},gh,tc,Du,Ms;(function(j){j.SDP_EXCHANGE="xdp",j.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(gh||(gh={})),(function(j){j.USER_INITIATED="user-initiated",j.CLIENT_RECONNECT="reconnect",j.TOKEN_REUSED="token-reused",j.UNKNOWN="unknown",j.PARTICIPANT_DISCONNECTED="participant-disconnected",j.STAGE_DELETED="stage-deleted",j.TOKEN_EXPIRED="token-expired"})(tc||(tc={})),(function(j){j[j.NOT_CONNECTED=0]="NOT_CONNECTED",j[j.CONNECTION_LOST=1]="CONNECTION_LOST",j[j.TIMEDOUT=2]="TIMEDOUT",j[j.ABORTED=3]="ABORTED",j[j.INVALID_MESSAGE=4]="INVALID_MESSAGE",j[j.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"})(Du||(Du={})),(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Ms||(Ms={}));class _h extends uc{constructor(C,P,H){super(),this.token=C,this.nonScopedLogger=P,this.analyticsTracker=H,this.participants=new Map,this.disconnected=[],this.state={value:Ms.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(X,te)=>{this.logger.debug({msg:"onConnecting",context:X,event:te}),X.connectStartTime=performance.now();const ue=te.type==="RECONNECT";ue&&this.stageSocket.close();const{eventsURL:Ee}=this.token;this.emit(hp,Ms.CONNECTING),this.state.value=Ms.CONNECTING;const w=!ue;this.stageSocket.connect(Ee,this.traceId,w)},this.onConnected=(X,te)=>{this.logger.debug({msg:"onConnected",context:X,event:te}),X.hasConnected=!0,this.emit(og),this.emit(hp,Ms.CONNECTED),this.state.value=Ms.CONNECTED},this.onDisconnected=(X,te)=>{this.logger.debug({msg:"onDisconnected",context:X}),this.state.value=Ms.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),X.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(hp,Ms.DISCONNECTED,te)},this.onErrored=(X,te)=>{var ue;this.logger.error({msg:"Connection failure occurred",err:te.payload.error}),this.emit(hp,Ms.ERRORED),this.emit(Ro,te.payload.error),this.state.value=Ms.ERRORED;const Ee=te.payload.error;if(Ee instanceof Fr&&Ee.fatal&&(!((ue=Ee.details)===null||ue===void 0)&&ue.includes("JOIN_ERROR"))&&X.hasConnected){const w=this.mapJoinErrorCodeToDisconnectReason(Ee);this.processStateUpdate({type:"DISCONNECT",reason:w})}else X.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=X=>{const te=this.state.value,ue=this.state.context;switch(te){case Ms.DISCONNECTED:X.type==="CONNECT"&&this.onConnecting(ue,X);break;case Ms.CONNECTING:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"?this.onDisconnected(ue,X.reason):X.type==="CONNECT_SUCCESS"?this.onConnected(ue,X):X.type==="ERROR"&&this.onErrored(ue,X);break;case Ms.CONNECTED:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"?this.onDisconnected(ue,X.reason):X.type==="ERROR"&&this.onErrored(ue,X);break;case Ms.ERRORED:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"&&this.onDisconnected(ue,X.reason)}},this.measureConnect=(X,te)=>{const ue=this.stats.edpConnectCount,Ee=ue+1,w=performance.now(),d=w-te;return Object.assign(this.stats,{edpConnectCount:Ee,edpConnectDuration:d}),ue===0&&Object.assign(this.stats,{edpInitialStartConnectTime:te,edpInitialFinishConnectTime:w,edpInitialConnectDuration:d,edpInitialConnectRetries:X}),this.stats},this.measureStateUpdate=X=>{const{edpInitialFinishConnectTime:te}=this.stats,ue=this.stats.edpStateUpdateCount,Ee=ue+1;return Object.assign(this.stats,{edpStateUpdateCount:Ee}),ue===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-te,edpInitialStatePublishingCount:X}),this.stats},this.trackMessageParseError=X=>{this.logger.error({msg:"Message Parse Error occurred",err:X.err});const te=new Fr({token:X.token,traceId:X.traceId,code:hn.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:X.tag,location:X.location,message:X.message,details:X.err.message});this.analyticsTracker.trackEvent(new zs(te))},this.trackStageSocketMessageParseError=(X,te,ue)=>{this.trackMessageParseError({token:X,traceId:te,tag:ve,location:"StageConnection.onMessage",message:hn.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:ue})},this.trackStageStateMessageParseError=(X,te,ue,Ee)=>{this.trackMessageParseError({token:X,traceId:te,tag:ve,location:"StageConnection.onStageStateMessage",message:Ee,err:ue})},this.onDisconnectMessage=X=>{this.analyticsTracker.trackEventNoSharedProps(new Co(this.token,this.traceId,`DISCONNECT message received: ${X.code}:${X.reason}`,Fn.JOIN));let te=tc.UNKNOWN;if(X.code==="PARTICIPANT_DISCONNECTED")te=tc.PARTICIPANT_DISCONNECTED;else if(X.code==="STAGE_DELETED")te=tc.STAGE_DELETED;else if(X.code==="TOKEN_REUSED"&&(te=tc.TOKEN_REUSED,ma("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${X.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:te})},this.onReassignmentMessage=X=>{this.emit(Na,X)},this.onIncompatibleCodecsMessage=X=>{this.emit(dh,X)},this.onSsuMessage=X=>{var te;const ue=window.atob((te=X.A)!==null&&te!==void 0?te:"").trim();ue&&ue.startsWith("http")?ga.currentEndpoint=ue:this.logger.warn({msg:"SSU Url invalid"})},this.onStageStateMessage=(X,te,ue)=>{var Ee,w;this.logger.debug({msg:"State Stage Message occurred",state:ue});const d=ue.payload,b=(Ee=d.participants)!==null&&Ee!==void 0?Ee:[],O=(w=d.disconnected)!==null&&w!==void 0?w:[],F=[],ie=[];this.measureStateUpdate(b.length),this.enableFeaturesBasedOnServerFeatures(d.serverFeatures||[]);const pe=(ye,Re)=>{this.analyticsTracker.trackEventNoSharedProps(new f0({token:X,otherParticipantId:ye.id,otherParticipantUserId:ye.userId,isAudioMuted:ye.audioMuted,isVideoStopped:ye.videoStopped,isPublishing:ye.isPublishing,isDisconnected:Re,traceId:te}))};this.participants.forEach((ye=>{const Re=b.find((Pe=>Pe.id===ye.id));if(Re){let Pe=!0,Fe=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach((Ye=>{Pe=Pe&&Re[Ye.toString()]===ye[Ye.toString()],Pe||(ye[Ye.toString()]=Re[Ye.toString()],Fe=!0)})),Object.keys(ye.attributes).forEach((Ye=>{Pe=Pe&&Re.attributes[Ye]===ye.attributes[Ye],Pe||(ye.attributes=Re.attributes,Fe=!0)})),Fe&&(pe(ye,!1),this.emit(wo,Re))}else ie.push(ye)})),b.forEach((ye=>{this.participants.get(ye.id)||F.push(ye)})),ie.forEach((ye=>{this.participants.delete(ye.id),pe(ye,!0),this.emit(If,ye)})),F.forEach((ye=>{this.participants.set(ye.id,ye),pe(ye,!1),this.emit(kf,ye)})),O.forEach((ye=>{this.disconnected.find((Re=>Re.id===ye.id))||(this.disconnected.push(ye),ye.status==="KICKED"&&this.emit(lg,ye))})),this.disconnected=O},this.nonScopedLogger=P,this.logger=new wn(P,_e.CONNECTION),this.stageSocket=new fm(C,this.nonScopedLogger,H),this.token=C,this.traceId=Ks()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(C){return Bd(this,void 0,void 0,(function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:C}),this.traceId=C,this.state.value!==Ms.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:tc.CLIENT_RECONNECT})),new Promise(((P,H)=>{this.stageSocket.on(Ru,(X=>{var te,ue;const{retryCnt:Ee,initialStageState:w}=X;w&&this.enableFeaturesBasedOnServerFeatures((ue=(te=w.payload)===null||te===void 0?void 0:te.serverFeatures)!==null&&ue!==void 0?ue:[]),this.traceId=X.traceId||Ks(),this.measureConnect(Ee,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),P(this.traceId)})),this.stageSocket.on(Zs,(X=>{H(X),this.processStateUpdate({type:"ERROR",payload:{error:X}})})),this.stageSocket.on(Jp,(()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(_a),this.processStateUpdate({type:"RECONNECT"})})),this.stageSocket.on(Ao,(X=>this.onStageStateMessage(this.token,this.traceId,X))),this.stageSocket.on($h,(X=>this.trackStageSocketMessageParseError(this.token,this.traceId,X))),this.stageSocket.on(ti,this.onDisconnectMessage),this.stageSocket.on(Dc,this.onReassignmentMessage),this.stageSocket.on(yi,this.onIncompatibleCodecsMessage),this.stageSocket.on(Wh,this.onSsuMessage),this.stageSocket.on(ai,(X=>{this.stopStageMinuteLoggedInterval()})),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:C}})}))}))}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:tc.USER_INITIATED}),this.traceId}getParticipant(C){return this.participants.get(C)}listConnectedParticipants(){const C=[];return this.participants.forEach((P=>{P.subscribed&&C.push(P)})),C}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(C,P){this.stageSocket.send({audioMuted:C,type:"SET_STATE",version:"0",videoStopped:P})}setStagePublishing(C){this.isStagePublishing=C,this.emit(Nc,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(C,P){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new dg(C,P,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval((()=>{this.analyticsTracker.trackEvent(new dg(C,P??Ks(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++}),6e4))}stopStageMinuteLoggedInterval(C=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),C&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(C){const P=(ue,Ee)=>{this.trackStageStateMessageParseError(this.token,this.traceId,Ee,`Could not parse "${ue}" from the Eevee server features list`)},H=C.includes(gh.SDP_EXCHANGE);this.features.sdpExchange!==H&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${H}`}),this.features.sdpExchange=H);const X=C.find((ue=>ue.indexOf(gh.JITTER_BUFFER_MIN_DELAY_MS)!==-1)),te=ue=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${ue}`}),this.features.jitterBufferMinDelayInMs=ue};if(X!==void 0)try{const ue=X.split("=")[1],Ee=parseInt(ue,10);if(isNaN(Ee))throw new Error("Unable to parse - result is NaN");if(Ee<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===Ee||te(Ee)}catch(ue){P(X,ue),te(void 0)}else te(void 0)}mapJoinErrorCodeToDisconnectReason(C){switch(C.code){case hn.PARTICIPANT_DISCONNECTED.code:return tc.PARTICIPANT_DISCONNECTED;case hn.STAGE_DELETED.code:return tc.STAGE_DELETED;case hn.EXPIRED_TOKEN.code:return tc.TOKEN_EXPIRED;default:return tc.UNKNOWN}}isConnected(){return this.state.value===Ms.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(C,P,H,X,te,ue,Ee,w,d){return Bd(this,void 0,void 0,(function*(){return this.isConnected()?new Promise(((b,O)=>{const F=window.setTimeout((()=>{ie(),O(Du.TIMEDOUT)}),12e3),ie=()=>{window.clearTimeout(F),this.stageSocket.off(Cs,pe),this.stageSocket.off(Zs,ye)},pe=Re=>{Re.requestId===X&&(ie(),b(Re))},ye=()=>{ie(),O(Du.CONNECTION_LOST)};te?.addEventListener("abort",(()=>{ie(),O(Du.ABORTED)})),this.stageSocket.on(Cs,pe),this.stageSocket.on(Zs,ye),this.stageSocket.sendSdpOffer(C,P,H,X,ue,Ee,w,d)})):Promise.reject(Du.NOT_CONNECTED)}))}}class a_{constructor(C){this.token=C}}const Vs=new RegExp("^(?:[a-z+]+:)?//","i");function gc(j){return Vs.test(j)}function Lf({sdpExchangeTransport:j,serverHttpResponse:C,serverErrorCode:P}){return`sdpExchangeTransport: ${j}, serverHttpResponse: ${C}, serverErrorCode: ${P}`}var gg=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Uf={[Du.ABORTED]:hn.OPERATION_ABORTED,[Du.NOT_CONNECTED]:hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Du.CONNECTION_LOST]:hn.XDP_CONNECTION_LOST,[Du.TIMEDOUT]:hn.XDP_TIMEOUT,[Du.INVALID_MESSAGE]:hn.XDP_INVALID_ANSWER_MSG,[Du.UNEXPECTED_ERROR]:hn.XDP_UNEXPECTED_ERROR};class lf extends a_{constructor(C,P,H,X){super(C),this.token=C,this.stageConnection=P,this.contextData=H,this.analyticsTracker=X}exchange(C){return gg(this,void 0,void 0,(function*(){const P=As(),{action:H}=this.contextData,{sdpOffer:X,url:te,traceId:ue,forceNode:Ee,assignmentToken:w,multiCodec:d,abortController:b,initialLayerPreference:O}=C;let F;this.trackAttempt(te,P,ue);try{F=yield this.stageConnection.exchangeSdp(X,te,ue.value,P.value,b?.signal,Ee,w,d,O)}catch(dt){if(typeof dt=="number")throw this.createClientSideErrorFromReasonCode(dt,ue,P,H)}if(!F)return;const{httpStatusCode:ie,errorCode:pe,location:ye,content:Re,sessionDeleteLink:Pe,subscriberControlLink:Fe,videoLayersLink:Ye}=F;if(ie>=200&&ie<300)return{sdpAnswer:Re,url:te,location:ye,sessionDeleteLink:Pe,mediaControls:Fe,layerControls:Ye};throw this.createServerSideError(ue,P,ie,pe,H)}))}trackAttempt(C,P,H){const{remoteParticipantId:X,action:te}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new Pi(te,this.token,C,"POST",P.value,X,H,"xdp"))}createServerSideError(C,P,H,X,te){const ue=this.baseErrorProps(C,P);let Ee=po(H,X);return Ee||(Ee=hn.UNKNOWN_SERVER_ERROR),new Fr(Object.assign(Object.assign(Object.assign({action:te},ue),Ee),{details:Lf({sdpExchangeTransport:"xdp",serverHttpResponse:H,serverErrorCode:X})}))}baseErrorProps(C,P){const{remoteParticipantId:H,action:X}=this.contextData;return{token:this.token,traceId:C,tag:kn(X,H),location:"EdpSdpExchanger.exchange",requestUUID:P,remoteParticipantId:H}}createClientSideErrorFromReasonCode(C,P,H,X){const te=this.baseErrorProps(P,H),ue=Uf[C];return new Fr(ue?Object.assign(Object.assign({action:X},te),ue):Object.assign(Object.assign({action:X},te),hn.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}var _o=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class ad extends a_{constructor(C,P,H){super(C),this.contextData=P,this.analyticsTracker=H}exchange(C){var P,H,X;return _o(this,void 0,void 0,(function*(){const te=As(),{token:ue}=this,{action:Ee,remoteParticipantId:w}=this.contextData,{sdpOffer:d,url:b,traceId:O,forceNode:F,assignmentToken:ie,multiCodec:pe,abortController:ye,initialLayerPreference:Re}=C;try{const Fe="POST",Ye="http";this.analyticsTracker.trackEventNoSharedProps(new Pi(Ee,ue,b,Fe,te.value,w,O,Ye));const dt={data:d,headers:{Authorization:`Bearer ${ue.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":te.value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":O.value,"X-Stages-WHIP-Version":Zc,[To]:(Pe=JSON.stringify({[Rl]:["sau"]}),btoa(Pe).replace(/[^A-Za-z0-9+/]/g,""))},method:Fe,responseType:"text",url:b,signal:ye?.signal,params:{}};F&&(dt.params.force_node=F),ie&&(dt.params.assignment_token=ie),pe&&(dt.params.multi_codec=!0);const xt=rh()===void 0,Dt=rh()||xt;Re&&dt.headers&&Dt&&(dt.headers["X-Stages-Initial-Layer-Pref"]=mp(Re));const{data:bt,headers:gt,request:kt}=yield ph(dt),wt=this.parseWhipResource(b,gt.location,gt.link);return{url:kt.responseURL,sdpAnswer:bt,location:wt?.location,sessionDeleteLink:wt?.sessionDeleteLink,mediaControls:wt?.mediaControls,layerControls:wt?.layerControls}}catch(Fe){if(fc().isCancel(Fe))throw new Fr(Object.assign(Object.assign({},ho(hn.OPERATION_ABORTED,Fe)),{action:Ee,token:ue,traceId:O,tag:kn(Ee,w),location:"StagePeerClient.start",requestUUID:te,remoteParticipantId:w}));const Ye=Number((P=Fe?.response)===null||P===void 0?void 0:P.status)||-1,dt=((X=(H=Fe?.response)===null||H===void 0?void 0:H.data)===null||X===void 0?void 0:X.code)||-1,xt=(function(Dt,bt){var gt;return Dt instanceof Ho.AxiosError&&Dt.response&&typeof Dt.response.status=="number"?Dt instanceof Ho.AxiosError&&Dt.code==="ERR_NETWORK"?hn.NETWORK_FAILURE:po(Number(Dt.response.status),(gt=Dt.response.data)===null||gt===void 0?void 0:gt.code)||bt:bt})(Fe,hn.WHIP_POST_FAILURE);throw new Fr(Object.assign(Object.assign({},ho(xt,Fe)),{action:Ee,token:ue,traceId:O,tag:kn(Ee,w),details:Lf({sdpExchangeTransport:"http",serverHttpResponse:Ye,serverErrorCode:dt}),location:"StagePeerClient.start",requestUUID:te,remoteParticipantId:w}))}var Pe}))}parseWhipResource(C,P,H){const X=new URL(C);let te;return te=(function(ue,Ee,w){if(!w)return ue;if(ue||(ue={}),gc(w))return ue.location=w,ue;const d=Ee.port?`:${Ee.port}`:"";return ue.location=`${Ee.protocol}//${Ee.hostname}${d}${w}`,ue})(te,X,P),te=(function(ue,Ee,w){if(!w)return ue;ue||(ue={});const d=ue;return w.split(",").forEach((b=>{const O=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(b);if(O?.length!==3)return;let F;if(gc(O[1]))F=O[1];else{const ie=Ee.port?`:${Ee.port}`:"";F=`${Ee.protocol}//${Ee.hostname}${ie}${O[1]}`}switch(O[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":d.sessionDeleteLink=F;break;case"urn:ietf:params:whep:core:playback-controls":d.mediaControls=F;break;case"urn:ietf:params:whep:ext:core:layer":d.layerControls=F;break;default:return}})),d})(te,X,H),te}getTransport(){return"http"}}function Bf(j){const{connection:C,token:P,action:H,identifier:X,tracker:te}=j,ue=C&&C.supportsSdpExchange()&&C.isConnected(),Ee=H===Fn.SUBSCRIBE&&ue&&!Wp()&&!ma("disableXdpSubscribe"),w=H===Fn.PUBLISH&&ue&&!Wp()&&!ma("disableXdpPublish");return Ee||w?new lf(P,C,{action:H,remoteParticipantId:X},te):new ad(P,{action:H,remoteParticipantId:X},te)}function io({stageErrorValue:j,action:C,token:P,traceId:H,tag:X,identifier:te,details:ue}){return new Fr(Object.assign(Object.assign({},j),{token:P,traceId:H,location:"peer-client",tag:X,action:C,remoteParticipantId:te,details:ue}))}var $o;function _g(j){var C;return!((C=j?.sender)===null||C===void 0)&&C.createEncodedStreams?$o.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?$o.ENCODED_TRANSFORMS:$o.NONE}function nu(j){var C;return!((C=j?.receiver)===null||C===void 0)&&C.createEncodedStreams?$o.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?$o.ENCODED_TRANSFORMS:$o.NONE}function Fd(){return kc()(`/*! For license information please see transform.worker.worker.js.LICENSE.txt */
(()=>{"use strict";const e=new Uint8Array([158,80,78,165,238,90,79,2,148,159,176,51,163,118,141,162]);var t;!function(e){e.VIDEO_SEND="video/send",e.VIDEO_RECEIVE="video/receive",e.INSERT_SEI="insertSei"}(t||(t={}));function n(t,n){const{transformerId:s,type:r,payloads:a}=n;let o=[];if("sei"===n.type){const{value:n,messages:s}=function(t,n){function s(e,t,n){return n+t.length<=e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function r(e,t){const n=function(e,t){return new Uint8Array([0,0,1,6,5,...t,...e])}(e,function(e){const t=[];for(;e>=255;)t.push(255),e-=255;return t.push(e),new Uint8Array(t)}(t.length+e.length)),s=function(e){const t=[...e];let n=3;for(;n<t.length-2;)0!==t[n]||0!==t[n+1]||0!==t[n+2]&&1!==t[n+2]&&2!==t[n+2]&&3!==t[n+2]?n+=1:(t.splice(n+2,0,3),n+=3);return t}(new Uint8Array([...n,...t,128]));return new Uint8Array(s)}function a(e,n){const r=function(e){const t=new DataView(e);for(let e=0;e<t.byteLength-4;e++)if(s(t,[0,0,1],e)){const n=31&t.getUint8(e+3);if(n>=1&&n<=5)return e}return-1}(t.data);if(r>=0){const e=new ArrayBuffer(t.data.byteLength+n.byteLength),s=new Uint8Array(e);return s.set(new Uint8Array(t.data.slice(0,r)),0),s.set(n,r),s.set(new Uint8Array(t.data.slice(r)),r+n.byteLength),e}return e}return function(){const s=[];for(let o=0;o<n.length;o+=1){const i=r(e,new Uint8Array(n[o]));t.data=a(t.data,i),s.push({uuid:e,payload:n[o]})}return{value:t,messages:s}}()}(t,a||[]);t=n,o=s}return{success:!0,frame:t,transformerId:s,type:r,seiResult:o}}const s=function(){let e=[];const t=new Map;return{add:({payload:t,repeatCount:n})=>(e.push({payload:t,repeatCount:n}),!0),poll(n){t.has(n)||t.set(n,[]),t.size>0&&(t.forEach((t=>{t.push(...e)})),e=[]);const s=t.get(n)||[],r=s.filter((e=>e.repeatCount>0)).map((e=>Object.assign(Object.assign({},e),{repeatCount:e.repeatCount-1})));return t.set(n,r),s}}}(),r=e=>(t,r)=>{try{const a=t.getMetadata().synchronizationSource,o=(s?s.poll(a):[]).map((e=>e.payload)),i=n(t,Object.assign(Object.assign({},e),{payloads:o}));r.enqueue(i.frame),self.postMessage(Object.assign({success:i.success,seiResult:i.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}},a=e=>(t,n)=>{try{const s=function(e,t){const{type:n,transformerId:s}=t;if("sei"===n){const t=function(e){function t(e,t,n){return n+t.length<e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function n(e){const t=[];let n=0;for(;n<e.length;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(t.push(e[n]),t.push(e[n+1]),n+=3):(t.push(e[n]),n+=1);return new Uint8Array(t)}function s(e){let t=2;const n=e.byteLength;for(;t<n;){let s=0;for(;t<n&&255===e[t];)s+=255,t++;s+=e[t],t++;const r=Math.min(t+s,n),a=new Uint8Array(e.slice(t,r));return{uuid:a.slice(0,16),payload:a.slice(16)}}}return{messages:function(e){const r=new DataView(e.data),a=[];let o=0;if(!t(r,[0,0,1],0)&&!t(r,[0,0,0,1],0))return[];for(;o<r.byteLength-5;)if(t(r,[0,0,1],o)){const i=o+3;o=i;const c=31&r.getUint8(o),u=31&r.getUint8(o+1);if(6===c&&5===u){for(;o<r.byteLength&&!t(r,[0,0,1],o);)o++;const c=o,u=s(n(new Uint8Array(e.data.slice(i,c))));u&&a.push(Object.assign({},u))}else o++}else o++;return a}(e),frame:e}}(e),{frame:r,messages:a}=t;return{success:!0,frame:r,type:n,transformerId:s,seiResult:a}}return{success:!0,frame:e,transformerId:s,type:n}}(t,e);n.enqueue(s.frame),self.postMessage(Object.assign({success:s.success,seiResult:s.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}};function o(e,t,n,s){const o=new TransformStream({transform:"video/send"===e?r(t):a(t)});n.pipeThrough(o).pipeTo(s)}const i=self;i.addEventListener("message",(function(e){var n,r,a;if(!(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.operation)||!(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.transformerId))return;const{operation:i,transformerId:c}=e.data;switch(i){case t.VIDEO_SEND:case t.VIDEO_RECEIVE:o(i,{method:i,transformerId:c,type:"sei"},e.data.readable,e.data.writable);break;case t.INSERT_SEI:s.add({payload:e.data.payload,repeatCount:null!==(a=e.data.repeatCount)&&void 0!==a?a:0})}})),i.addEventListener("rtctransform",(function(e){const t=e.transformer;if(!t)return;o(t.options.method,t.options,t.readable,t.writable)}))})();`,"Worker",void 0,void 0)}(function(j){j.NONE="none",j.ENCODED_TRANSFORMS="encodedTransforms",j.INSERTABLE_STREAMS="insertableStreams"})($o||($o={}));const gl=(()=>{const j={};return{getWorker:C=>(j[C]||(j[C]=new Fd),j[C]),destroy:C=>{var P;(P=j[C])===null||P===void 0||P.terminate(),j[C]=void 0}}})();var aa;(function(j){j.NOT_PUBLISHING_VIDEO="NOT_PUBLISHING_VIDEO",j.INBAND_MESSAGING_NOT_ENABLED="INBAND_MESSAGING_NOT_ENABLED",j.INVALID_REPEAT_COUNT="INVALID_REPEAT_COUNT",j.PAYLOAD_SIZE_INVALID="PAYLOAD_SIZE_INVALID",j.PAYLOAD_RATE_EXCEEDED="PAYLOAD_RATE_EXCEEDED",j.INVALID_TRACK_TYPE="INVALID_TRACK_TYPE"})(aa||(aa={}));class ev{constructor(C){this.maxFramerate=C,this.queued=[]}validateMessagePayload(C,P){if(C.byteLength<=0)return Jn.err(aa.PAYLOAD_SIZE_INVALID);if(P<0||P>30)return Jn.err(aa.INVALID_REPEAT_COUNT);if(C.byteLength>1024)return Jn.err(aa.PAYLOAD_SIZE_INVALID);this.queued=this.trimPastPayloads(this.queued,1e3);const{before:H,after:X}=this.getPayloadSums(this.queued);if(H+C.byteLength>10240||X+C.byteLength*Math.max(1,P)>10240)return Jn.err(aa.PAYLOAD_RATE_EXCEEDED);if(this.queued.push({byteLength:C.byteLength,timestamp:Date.now()}),P>0){const te=1e3/this.maxFramerate;let ue=Date.now()+te;for(let Ee=0;Ee<P;Ee+=1)this.queued.push({byteLength:C.byteLength,timestamp:ue}),ue+=te}return Jn.ok(!0)}trimPastPayloads(C,P){const H=Date.now()-P;return C.filter((X=>X.timestamp>H))}getPayloadSums(C){const P=Date.now();return C.reduce(((H,X)=>{const{before:te,after:ue}=H;return X.timestamp<=P?{before:te+X.byteLength,after:ue}:{before:te,after:ue+X.byteLength}}),{before:0,after:0})}}const Ff="seiMessageReceived",Sr="error";var Ar;(function(j){j.CREATED="created",j.INITIALIZED="initialized",j.DESTROYED="destroyed"})(Ar||(Ar={}));class _c extends uc{constructor(C){super(),this.sessionId=C,this.state=Ar.CREATED,this.transformerId=As().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=P=>{this.onTransformResult(P.data)}}initializeInsertableStreams(C){var P,H;this.worker=gl.getWorker(this.sessionId);const X=C.receiver.createEncodedStreams(),{readable:te,writable:ue}=X;(P=this.worker)===null||P===void 0||P.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:te,writable:ue},[te,ue]),(H=this.worker)===null||H===void 0||H.addEventListener("message",this.onMessage)}initializeEncodedTransforms(C){var P;this.worker=gl.getWorker(this.sessionId);const H={method:"video/receive",type:"sei",transformerId:this.transformerId};C.receiver.transform=new RTCRtpScriptTransform(this.worker,H),(P=this.worker)===null||P===void 0||P.addEventListener("message",this.onMessage)}initialize(C,P){if(this.state!==Ar.CREATED)return!1;const H=nu(C);if(H===$o.NONE)return!1;if(P&&H===$o.INSERTABLE_STREAMS)this.initializeInsertableStreams(C);else{if(P||H!==$o.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(C)}return this.transceiver=C,this.state=Ar.INITIALIZED,!0}onTransceiverAdd(C){return this.initialize(C,!0)}onTrackEvent(C){return C.track.kind==="video"&&this.initialize(C.transceiver,!1)}static isSupported(C){return nu(C)!==$o.NONE}onTransformResult(C){return C.transformerId===this.transformerId&&(C.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!C.seiResult&&(C.seiResult.forEach((P=>{const{payload:H,uuid:X}=P;this.updateReadStats(P),this.emit(Ff,{uuid:X,payload:H})})),C.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(C,hn.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(C,hn.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(C){this.seiReadCnt++,this.seiBytesRead+=C.payload.byteLength}getReceiverStats(){const{seiBytesRead:C,seiReadCnt:P}=this;return{seiReadCnt:P,seiBytesRead:C}}onError(C,P){const{type:H}=C;this.emit(Sr,{type:H,stageErrorValue:P})}destroy(){var C,P;this.state!==Ar.DESTROYED&&(this.removeAllListeners(),(C=this.worker)===null||C===void 0||C.removeEventListener("message",this.onMessage),!((P=this.transceiver)===null||P===void 0)&&P.receiver&&(this.transceiver.receiver.transform=null),this.state=Ar.DESTROYED)}getState(){return this.state}}class Ui{constructor(C){this.sessionId=C,this.state=Ar.CREATED,this.transformerId=As().value,this.seiWriteCnt=0,this.seiBytesWritten=0,this.onMessage=P=>{this.onTransformResult(P.data)}}initializeInsertableStreams(C,P){var H,X;this.worker=gl.getWorker(this.sessionId);const te=C.sender.createEncodedStreams(),{readable:ue,writable:Ee}=te;(H=this.worker)===null||H===void 0||H.postMessage({operation:"video/send",transformerId:this.transformerId,readable:ue,writable:Ee},[ue,Ee]),(X=this.worker)===null||X===void 0||X.addEventListener("message",this.onMessage)}initializeEncodedTransforms(C,P){var H;this.worker=gl.getWorker(this.sessionId);const X={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:P};C.sender.transform=new RTCRtpScriptTransform(this.worker,X),(H=this.worker)===null||H===void 0||H.addEventListener("message",this.onMessage)}initialize(C){var P;if(this.state!==Ar.CREATED)return!1;const H=_g(C);if(H===$o.NONE)return!1;const X=C.sender.getParameters(),te=((P=X?.encodings)===null||P===void 0?void 0:P.length)||1;if(H===$o.INSERTABLE_STREAMS)this.initializeInsertableStreams(C,te);else{if(H!==$o.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(C,te)}return this.transceiver=C,this.state=Ar.INITIALIZED,!0}static isSupported(C){return _g(C)!==$o.NONE}sendSeiMessage(C,P){var H;return this.state===Ar.INITIALIZED&&this.transceiver?((H=this.worker)===null||H===void 0||H.postMessage({operation:"insertSei",transformerId:this.transformerId,payload:C,repeatCount:P}),Jn.ok(!0)):Jn.err(aa.NOT_PUBLISHING_VIDEO)}onTransceiverAdd(C){return this.initialize(C)}onTrackEvent(C){return!1}onTransformResult(C){return C.transformerId===this.transformerId&&(C.success&&this.updateSendStats(C),C.success)}updateSendStats(C){C.seiResult&&C.seiResult.forEach((P=>{this.seiWriteCnt++,this.seiBytesWritten+=P.payload.byteLength}))}getSenderStats(){const{seiBytesWritten:C,seiWriteCnt:P}=this;return{seiWriteCnt:P,seiBytesWritten:C}}destroy(){var C;this.state!==Ar.DESTROYED&&(!((C=this.transceiver)===null||C===void 0)&&C.receiver&&(this.transceiver.receiver.transform=null),this.state=Ar.DESTROYED)}getState(){return this.state}}class oa extends ur{constructor(C,P,H,X,te,ue,Ee,w,d){super(Xn.SELECTED_PAIR_CHANGE,P,H,!1),Object.assign(this.properties,{action:C,protocol:X,local_type:te,local_addr:ue,remote_addr:Ee,local_candidate_priority:w,remote_participant_id:d})}}var Ra=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};let Ga=null;class bs extends uc{constructor(C,P,H,X,te,ue,Ee,w,d){var b;if(super(),this.analyticsTracker=ue,this.subscribeConfig=d,this.sfuResource={node:"",cluster:""},this.protocol="",this.incompatibleCodecs=new Set,this.connect=({audioOnly:O=!1,traceId:F,iceRestartOptions:ie})=>Ra(this,void 0,void 0,(function*(){const{token:pe,tag:ye,identifier:Re,action:Pe}=this,Fe=!!ie,Ye=new AbortController;let dt,xt,Dt;this.abortController=Ye,this.traceId=F,this.protocol="",this.perfTracker.resetMeasurements(F);const bt=()=>{dt&&this.off(rs,dt),xt&&this.off(Eo,xt)},gt=new Promise(((kt,wt)=>{const It=(function({action:Gt,token:$t,traceId:dn,tag:Rn,identifier:Nn}){const qn=Gt===Fn.SUBSCRIBE?hn.SUBSCRIBE_TIMED_OUT:hn.PUBLISH_TIMED_OUT;return new Fr(Object.assign(Object.assign({},qn),{action:Gt,token:$t,traceId:dn,tag:Rn,location:"connect",remoteParticipantId:Nn}))})({action:Pe,token:pe,traceId:F,tag:ye,identifier:Re}),Ft=(function({action:Gt,token:$t,traceId:dn,tag:Rn}){const Nn=hn.OPERATION_ABORTED;return new Fr(Object.assign(Object.assign({},Nn),{token:$t,traceId:dn,location:"peer-client.connect",tag:Rn,action:Gt}))})({action:Pe,token:pe,traceId:F,tag:ye}),Zt=setTimeout((()=>{this.stop(),this.analyticsTracker.trackError(It),wt(It)}),1e4);dt=Gt=>{clearTimeout(Zt),Fe||this.stop(),wt(Gt)},xt=Gt=>{if(Gt===sr.CONNECTED)clearTimeout(Zt),kt();else if(Gt===sr.FAILED){const $t=(function({action:dn,token:Rn,traceId:Nn,tag:qn}){return new Fr(Object.assign(Object.assign({},hn.PEER_CONNECTION_NETWORK_FAILURE),{token:Rn,traceId:Nn,location:"peer-client.connect",tag:qn,action:dn}))})({action:Pe,token:pe,traceId:F,tag:ye});clearTimeout(Zt),wt($t)}},this.on(rs,dt),this.on(Eo,xt),Dt=()=>{clearTimeout(Zt)},Ye.signal.aborted&&(clearTimeout(Zt),wt(Ft)),Ye.signal.addEventListener("abort",(()=>{clearTimeout(Zt),wt(Ft)}))}));try{const kt=yield Promise.all([Ra(this,void 0,void 0,(function*(){Fe||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(O));const It=ie?.assignmentToken,Ft=ie?.nodeOverride;return yield this.exchangeSdp({iceRestart:Fe,nodeOverride:Ft,assignmentToken:It,abortController:Ye}),this.mediaStream})),gt]);this.statsReporter.traceId=F;const wt=kt[0];if(this.abortController=void 0,!Fe&&Pe===Fn.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(It){this.logger.error({err:It,msg:"error syncing transceivers"})}return{mediaStream:wt}}catch(kt){throw Dt&&Dt(),kt}finally{bt()}})),this.disconnect=(O=!1)=>Ra(this,void 0,void 0,(function*(){var F;const{token:ie,action:pe}=this;(F=this.abortController)===null||F===void 0||F.abort(),this.stop(),this.protocol="",O?this.cleanup(pe,ie.participantID,ie,O):yield this.cleanup(pe,ie.participantID,ie,O)})),this.resetTransformers=()=>{var O,F;(O=this.videoSenderTransformer)===null||O===void 0||O.destroy(),this.videoSenderTransformer=this.createVideoSenderTransformer(),(F=this.videoReceiverTransformer)===null||F===void 0||F.destroy(),this.videoReceiverTransformer=this.createVideoReceiverTransformer(),this.statsReporter.resetTransformers(this.videoReceiverTransformer,this.videoSenderTransformer)},this.onTrack=O=>{var F,ie;const{token:pe,action:ye,traceId:Re,identifier:Pe}=this;this.trace(pe,Re,`onTrack: ${O.track.kind}`,ye,Pe),this.sendInBandMessagingEnabled&&((F=this.videoSenderTransformer)===null||F===void 0||F.onTrackEvent(O)),this.receiveInBandMessagingEnabled&&((ie=this.videoReceiverTransformer)===null||ie===void 0||ie.onTrackEvent(O))},this.onIceGatheringStateChange=()=>{var O,F,ie;const{token:pe,action:ye,traceId:Re,identifier:Pe}=this;if(((O=this.peerConnection)===null||O===void 0?void 0:O.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((F=this.peerConnection)===null||F===void 0?void 0:F.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const Fe=this.peerConnection.iceGatheringState,Ye=new Qu(ye,pe,Re,Fe,Pe);this.analyticsTracker.trackEventNoSharedProps(Ye)}this.trace(pe,Re,`ICE gathering state change: ${(ie=this.peerConnection)===null||ie===void 0?void 0:ie.iceGatheringState}`,ye,Pe)},this.onSelectedCandidatePairChange=()=>{var O,F,ie,pe,ye,Re,Pe,Fe,Ye,dt,xt,Dt,bt,gt;const{token:kt,action:wt,traceId:It,identifier:Ft}=this,Zt=(F=(O=this.peerConnection)===null||O===void 0?void 0:O.getReceivers()[0].transport)===null||F===void 0?void 0:F.iceTransport,Gt=Zt?.getSelectedCandidatePair();if(Gt){const{local:$t,remote:dn}=Gt,Rn=`Selected candidate pair change (local, remote): ${$t?.candidate}, ${dn?.candidate}`;this.logger.debug({msg:Rn});const Nn=new oa(wt,kt,It,(pe=(ie=Gt.local)===null||ie===void 0?void 0:ie.protocol)!==null&&pe!==void 0?pe:"",(Re=(ye=Gt.local)===null||ye===void 0?void 0:ye.type)!==null&&Re!==void 0?Re:"",(Fe=(Pe=Gt.local)===null||Pe===void 0?void 0:Pe.address)!==null&&Fe!==void 0?Fe:"",(dt=(Ye=Gt.remote)===null||Ye===void 0?void 0:Ye.address)!==null&&dt!==void 0?dt:"",(Dt=(xt=Gt.local)===null||xt===void 0?void 0:xt.priority)!==null&&Dt!==void 0?Dt:0,Ft);this.analyticsTracker.trackEvent(Nn),this.protocol=(gt=(bt=Gt.local)===null||bt===void 0?void 0:bt.protocol)!==null&&gt!==void 0?gt:""}},this.onIceCandidate=O=>Ra(this,void 0,void 0,(function*(){var F,ie;const{identifier:pe,action:ye,traceId:Re}=this,Pe=(F=O.target.localDescription)===null||F===void 0?void 0:F.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new Co(this.token,Re,`ice candidate: hasRelay = ${Pe}, candidate = ${(ie=O.candidate)===null||ie===void 0?void 0:ie.candidate}`,ye,pe))})),this.onMute=()=>Ra(this,void 0,void 0,(function*(){const{token:O,action:F,traceId:ie,identifier:pe}=this;this.trace(O,ie,"Track has muted",F,pe)})),this.onUnMute=()=>Ra(this,void 0,void 0,(function*(){const{token:O,action:F,traceId:ie,identifier:pe}=this;this.trace(O,ie,"Track has unmuted",F,pe)})),this.fetchAndSetRemoteDescription=O=>Ra(this,void 0,void 0,(function*(){var F,ie,pe,ye;const Re=(ie=(F=this.peerConnection)===null||F===void 0?void 0:F.localDescription)===null||ie===void 0?void 0:ie.sdp;Re||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:Pe,traceId:Fe,action:Ye,identifier:dt,tag:xt}=this,{endpointURL:Dt,nodeOverride:bt,assignmentToken:gt,multiCodec:kt,abortController:wt}=O;let It;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{const dn=Bf({connection:this.stageConnection,action:Ye,token:Pe,identifier:this.identifier,tracker:this.analyticsTracker});this.perfTracker.setTransport(dn.getTransport());const Rn=bt||pa("node")||pa("dataPlaneEndpoint");It=yield dn.exchange({sdpOffer:Re,url:Dt,traceId:Fe,forceNode:Rn,assignmentToken:gt,multiCodec:kt,abortController:wt,initialLayerPreference:(pe=this.simulcastSubscribeConfig)===null||pe===void 0?void 0:pe.initialLayerPreference})}catch(dn){let Rn=dn;Rn instanceof Fr||(Rn=new Fr(Object.assign(Object.assign({},hn.UNEXPECTED_ERROR),{action:Ye,token:Pe,traceId:Fe,tag:xt,details:dn instanceof Error?dn.message:"",location:"sdp-exchange"}))),Rn instanceof Fr&&(this.analyticsTracker.trackError(Rn),this.emit(rs,Rn))}if(this.perfTracker.markSdpExchangeStop(),!It)return;const{location:Ft,sessionDeleteLink:Zt,mediaControls:Gt}=It;let $t=It.sdpAnswer;try{$t=this.mungeSdpAnswer($t),It.sdpAnswer=$t}catch(dn){this.logger.error({err:dn,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=$t,this.emit(wf,It),Ft&&(this.whipResource={location:Ft,sessionDeleteLink:Zt,mediaControls:Gt},this.sfuResource=(function(dn){const Rn=dn.match(/https:\/\/([^/]+)\//);if(Rn){const Nn=Rn[1].split(".");if(Nn[0].includes("video-rtx"))return{node:`${Nn[0]}.${Nn[1]}`,cluster:Nn[1]}}})(Ft)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(ye=this.peerConnection)===null||ye===void 0?void 0:ye.setRemoteDescription({sdp:$t,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(dn){const Rn=new Fr(Object.assign(Object.assign({},hn.SET_ANSWER_FAILURE),{action:Ye,token:Pe,traceId:Fe,tag:kn(Ye,dt),location:"setRemoteDescription",remoteParticipantId:dt,details:dn instanceof Error?dn.message:""}));this.analyticsTracker.trackError(Rn),this.emit(rs,Rn)}})),this.cleanup=(O,F,ie,pe=!1)=>Ra(this,void 0,void 0,(function*(){var ye,Re,Pe;const Fe=As();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,this.closeFailedPeerConnections(),!(!((ye=this.whipResource)===null||ye===void 0)&&ye.location))return this.trace(ie,this.traceId,"whipResource location not known, exiting cleanup",O,F),void this.analyticsTracker.trackError(new Fr(Object.assign(Object.assign({},hn.WHIP_URL_MISSING),{action:O,token:ie,traceId:this.traceId,tag:kn(O,F),location:O===Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})));let Ye=this.whipResource.location;if(this.trace(ie,this.traceId,`use hostnamecachedurl: ${Ye}`,O,F),pe){if(!((Pe=this.whipResource)===null||Pe===void 0)&&Pe.sessionDeleteLink){Ye=this.whipResource.sessionDeleteLink,this.trace(ie,this.traceId,`DELETE via session-delete beacon path: ${Ye}`,O,F);try{navigator.sendBeacon(Ye,JSON.stringify({authorization:ie.rawToken}))}catch(dt){this.analyticsTracker.trackErrorAndThrow(new Fr(Object.assign(Object.assign({},ho(hn.WHIP_DELETE_FAILURE,dt)),{action:O,token:ie,traceId:this.traceId,tag:kn(O,F),location:Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})))}}}else try{yield fc().delete(Ye,{headers:{Authorization:`Bearer ${ie.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":Fe.value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":Zc}})}catch(dt){((Re=dt.response)===null||Re===void 0?void 0:Re.status)===404?this.trace(ie,this.traceId,`DELETE returned 404, ignoring, action = ${O}, uuid = ${Fe.value}`,O,F):this.analyticsTracker.trackErrorAndThrow(new Fr(Object.assign(Object.assign({},ho(hn.WHIP_DELETE_FAILURE,dt)),{action:O,token:ie,traceId:this.traceId,tag:kn(O,F),location:Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})))}})),this.getConnectionState=()=>{if(!this.peerConnection)return sr.NONE;const O=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return Qp(O)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:O}),sr.IDLE}},this.onIceCandidateError=O=>{const{token:F,traceId:ie,tag:pe}=this;if(O.errorCode!==701){const ye=new Fr(Object.assign(Object.assign({},hn.ICE_CANDIDATE_ERROR),{action:this.action,token:F,traceId:ie,tag:pe,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(ye),this.emit(rs,ye)}},this.onIceConnectionStateChange=()=>{var O,F;const{token:ie,traceId:pe,action:ye,identifier:Re}=this;this.trace(ie,pe,`ICE connection state change: ${(O=this.peerConnection)===null||O===void 0?void 0:O.iceConnectionState}`,ye,Re),((F=this.peerConnection)===null||F===void 0?void 0:F.iceConnectionState)==="checking"&&this.peerConnection.getTransceivers().forEach((({receiver:Pe,sender:Fe})=>{[Pe,Fe].forEach((Ye=>{var dt,xt;(xt=(dt=Ye?.transport)===null||dt===void 0?void 0:dt.iceTransport)===null||xt===void 0||xt.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)}))})),this.onConnectionStateChange()},this.createVideoSenderTransformer=()=>new Ui(this.analyticsTracker.getSessionId()),this.createVideoReceiverTransformer=()=>{const O=new _c(this.analyticsTracker.getSessionId()),{token:F,tag:ie,identifier:pe,action:ye,traceId:Re}=this;O.on(Ff,(Ye=>{this.emit(Mc,Ye)}));const Pe=(function(Ye,dt){let xt=0;return function(...Dt){const bt=Date.now();bt-xt>=dt&&(xt=bt,Ye(...Dt))}})((Ye=>{const dt=`Transform error occurred: ${Ye.type}`,xt=io({traceId:Re,token:F,tag:ie,identifier:pe,action:ye,details:dt,stageErrorValue:hn.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:xt,msg:"Error encountered when transforming receiver",error:Ye})}),1e3),Fe=Ye=>{const dt=`Too many errors occurred: ${Ye.type}`,xt=io({traceId:Re,token:F,tag:ie,identifier:pe,action:ye,details:dt,stageErrorValue:hn.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:xt,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:Ye}),O.destroy(),this.analyticsTracker.trackError(xt),this.emit(lh,xt)};return O.on(Sr,(Ye=>{Ye.stageErrorValue.code!==hn.TRANSFORM_TOO_MANY_ERRORS.code?Pe(Ye):Fe(Ye)})),O},this.onConnectionStateChange=()=>{if(this.peerConnection){const F=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:ie,traceId:pe,identifier:ye,action:Re}=this,Pe=new Xh(Re,ie,pe,F,ye);this.analyticsTracker.trackEventNoSharedProps(Pe),this.trace(ie,pe,`connection state change: ${F}`,Re,ye)}const O=this.getConnectionState();switch(O){case sr.CONNECTED:this.closeFailedPeerConnections(),this.perfTracker.markActionStop(),this.emit(Eo,O),this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream);break;case sr.FAILED:this.storeFailedPeerConnection(this.peerConnection),this.destroyPeerConnection({closeConnection:!1}),this.emit(Eo,O),this.handleConnectionFailure();break;default:this.emit(Eo,O)}},this.onIncompatibleCodecs=O=>Ra(this,void 0,void 0,(function*(){if(O.forEach((pe=>{let ye=!1;this.incompatibleCodecs.forEach((Re=>{Re.config===pe.config&&Re.mime===pe.mime&&(ye=!0)})),ye||this.incompatibleCodecs.add(pe)})),this.peerConnection)try{yield(F=this.peerConnection,ie=[...this.incompatibleCodecs],tm(void 0,void 0,void 0,(function*(){var pe;for(const ye of F.getSenders()){const Re=ye.getParameters();if(Re.codecs.length>1){const Pe=Re.codecs[0];let Fe=!1;for(const Ye of ie)Zr(Pe,Ye)&&(Fe=!0);if(Fe){const Ye=hs(ie,Re.codecs);(pe=Re.encodings)===null||pe===void 0||pe.forEach((dt=>{dt.active&&(dt.codec=Ye)})),yield ye.setParameters(Re)}}}})))}catch(pe){const{token:ye,action:Re,traceId:Pe,identifier:Fe}=this,Ye=new Fr(Object.assign(Object.assign({},hn.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:Re,token:ye,traceId:Pe,tag:kn(Re,Fe),location:"onIncompatibleCodecs",remoteParticipantId:Fe,details:pe instanceof Error?pe.message:""}));this.analyticsTracker.trackError(Ye),this.emit(rs,Ye)}var F,ie})),this.token=C,this.logger=new wn(P,_e.WEBRTC),this.action=H,this.tag=X,this.traceId=te,H===Fn.SUBSCRIBE&&!Ee)throw new Error("Subscribe action provided without subscriber Id");this.jitterBufferConfig=d?.jitterBuffer,this.simulcastSubscribeConfig=d?.simulcast,this.subscriberId=Ee,this.stageConnection=w,this.failedPeerConnections=[],this.receiveInBandMessagingEnabled=!!(!((b=this.subscribeConfig)===null||b===void 0)&&b.inBandMessaging.enabled),this.perfTracker=new dp(this.action,this.traceId),this.statsReporter=new hg(H,C,te,this.identifier,this.analyticsTracker),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var C,P;return(P=(C=this.videoTransceiver)===null||C===void 0?void 0:C.mid)!==null&&P!==void 0?P:null}toggleStageConnectionListeners(C){var P,H;C?(P=this.stageConnection)===null||P===void 0||P.on(Nc,this.handlePublishingChangedBinding):(H=this.stageConnection)===null||H===void 0||H.off(Nc,this.handlePublishingChangedBinding)}updateSubscribeConfig(C){var P,H;if(this.jitterBufferConfig=C.jitterBuffer,this.simulcastSubscribeConfig=C.simulcast,this.action===Fn.SUBSCRIBE){const X=C.inBandMessaging.enabled;this.receiveInBandMessagingEnabled!==X&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for receiver"})}this.applyJitterBufferMinDelayConditionally((H=(P=this.stageConnection)===null||P===void 0?void 0:P.getIsStagePublishing())!==null&&H!==void 0&&H)}verifyOrUpdateTransceiverSync(){var C,P;return Ra(this,void 0,void 0,(function*(){if(this.publishVideoStream){const H=this.getTransceiverForKind("video");H?this.publishVideoStream.track.id!==((C=H.sender.track)===null||C===void 0?void 0:C.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishVideoStream)):this.logger.warn({msg:"missing transceiver for video"})}if(this.publishAudioStream){const H=this.getTransceiverForKind("audio");H?this.publishAudioStream.track.id!==((P=H.sender.track)===null||P===void 0?void 0:P.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishAudioStream)):this.logger.warn({msg:"missing transceiver for audio"})}}))}start(){return Ra(this,void 0,void 0,(function*(){const{token:C,action:P,traceId:H,identifier:X}=this;P!==Fn.PUBLISH||C.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new Fr(Object.assign(Object.assign({},ho(hn.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:P,token:C,traceId:H,tag:kn(P,X),location:"StagePeerClient.start",remoteParticipantId:X})));const te=(function({action:ue,identifier:Ee,token:w,analyticsTracker:d}){let b="";const O=Cd(w,d);switch(ue){case Fn.PUBLISH:b=O.getPublishEndpoint();break;case Fn.SUBSCRIBE:Ee&&(b=O.getSubscribeEndpoint(Ee))}return b})({action:P,identifier:X,token:C.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.endpointURL=te,this.createPeerConnection(),this.trace(C,H,"peer connection created",P,X)}catch(ue){const Ee=new Fr(Object.assign(Object.assign({action:P},ho(hn.CREATE_PEER_CONNECTION_FAILURE,ue)),{token:C,traceId:H,tag:kn(P,X),location:"StagePeerClient.start",remoteParticipantId:X}));P===Fn.PUBLISH&&this.emit(Eo,sr.FAILED),this.emit(rs,Ee),this.analyticsTracker.trackErrorAndThrow(Ee)}}))}mungeSdpOffer(C,P,H){if(H.simulcastEnabled&&(C=new wi(C).withVideoLayersAllocationRtpHeaderExtension().sdp),P===Fn.SUBSCRIBE)C=new wi(C).withOpusAudioConfig(zr(Oo),!0).sdp;else if(P===Fn.PUBLISH&&H.audioConfig){const{maxBitrateBps:X,stereo:te}=H.audioConfig;C=new wi(C).withOpusAudioConfig(X,te).sdp}return C}mungeSdpAnswer(C){gp.browser.isFirefox()&&this.publishAudioStream&&this.action===Fn.PUBLISH&&(C=new wi(C).withOpusAudioConfig(this.publishAudioStream.config.maxBitrateBps,void 0).sdp);const P=gp.browser.isChrome()||gp.browser.isEdge();this.action===Fn.SUBSCRIBE&&P&&(C=new wi(C).withoutAudioRtcpRSize().sdp);const H=(function(){const X=pa("subscribeForceIceProtocol");if(X==="tcp"||X==="udp")return X})();return this.action===Fn.SUBSCRIBE&&H&&(C=new wi(C).withFilteredCandidates(H).sdp),C}createPeerConnection(){var C;this.logger.debug({msg:"setting up peer connection"}),this.peerConnection&&(this.logger.debug({msg:"peer connection is already established, cleaning up previous connection"}),this.destroyPeerConnection({closeConnection:!1})),this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,(C=this.publishVideoStream)===null||C===void 0?void 0:C.config.simulcastEnabled),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute)}destroyPeerConnection(C){var P,H,X,te,ue,Ee,w,d,b;this.statsReporter.stop(),(P=this.peerConnection)===null||P===void 0||P.removeEventListener("connectionstatechange",this.onConnectionStateChange),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(X=this.peerConnection)===null||X===void 0||X.removeEventListener("icecandidateerror",this.onIceCandidateError),(te=this.peerConnection)===null||te===void 0||te.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(ue=this.peerConnection)===null||ue===void 0||ue.removeEventListener("icecandidate",this.onIceCandidate),(Ee=this.peerConnection)===null||Ee===void 0||Ee.removeEventListener("track",this.onTrack),(w=this.peerConnection)===null||w===void 0||w.removeEventListener("mute",this.onMute),(d=this.peerConnection)===null||d===void 0||d.removeEventListener("unmute",this.onUnMute),(C.closeConnection||this.action===Fn.PUBLISH)&&((b=this.peerConnection)===null||b===void 0||b.close()),this.peerConnection=void 0}closeFailedPeerConnections(){for(const C of this.failedPeerConnections)C?.close();this.failedPeerConnections=[]}storeFailedPeerConnection(C){C&&this.action!==Fn.PUBLISH&&this.failedPeerConnections.push(C)}stop(){var C,P;(C=this.videoReceiverTransformer)===null||C===void 0||C.destroy(),(P=this.videoSenderTransformer)===null||P===void 0||P.destroy(),this.destroyPeerConnection({closeConnection:!0})}getTransceiverForKind(C){if(!this.peerConnection)return;const P=this.peerConnection.getTransceivers();return C==="audio"?P.find((H=>H.mid==="0")):C==="video"?P.find((H=>H.mid==="1")):void 0}removeTrack(C){return Ra(this,void 0,void 0,(function*(){if(C==="audio"||C==="video")if(this.peerConnection)try{const P=this.getTransceiverForKind(C);if(!P)return void this.logger.warn({msg:`tried removing track type ${C} but couldn't find transceiver`});yield P.sender.replaceTrack(null),C===ef.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0,yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(P){this.logger.warn({msg:"error replacing track",err:P})}else C===ef.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:C})}))}replaceOrUpdateStream(C){return Ra(this,void 0,void 0,(function*(){if(C.track){if(Bc(C)?this.publishAudioStream=C:om(C)&&(this.publishVideoStream=C),this.peerConnection)try{const P=this.getTransceiverForKind(C.track.kind);if(!P)return void this.logger.warn({msg:`tried replacing track type ${C.track.kind} but couldn't find transceiver`,track:C.track});if(om(C)){const H=P.sender.getParameters(),X=C.config.encodingLayers;H.encodings=H.encodings.map((te=>{var ue;const Ee=(ue=te.rid)!==null&&ue!==void 0?ue:"",w=X.find((d=>{var b;return((b=d.rid)!==null&&b!==void 0?b:"")===Ee}));return w?Object.assign(Object.assign({},te),w):te})),yield P.sender.setParameters(H)}else if(Bc(C)){const H=P.sender.getParameters(),X=pp(C)[0];H.encodings=H.encodings.map((te=>Object.assign(Object.assign({},te),X))),yield P.sender.setParameters(H)}yield P.sender.replaceTrack(C.track),yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(P){this.logger.warn({msg:"error replacing track",err:P})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateStream with no track"})}))}initializePeerConnection(C=!1){var P,H,X,te,ue,Ee,w,d;return Ra(this,void 0,void 0,(function*(){const{traceId:b,token:O,action:F,identifier:ie}=this;Af(this.peerConnection),this.resetTransformers();let pe=new MediaStream;if(F===Fn.PUBLISH){this.publishAudioStream||(this.publishAudioStream={track:this.getSilentAudio(),config:{maxBitrateBps:zr(sf),stereo:!1}});const ye=this.peerConnection.getTransceivers(),Re=[];ye.forEach((bt=>{var gt;Re.concat((gt=bt.sender.track)===null||gt===void 0?void 0:gt.id)})),pe=new MediaStream([this.publishAudioStream.track,(P=this.publishVideoStream)===null||P===void 0?void 0:P.track].filter((bt=>!!bt&&!Re.includes(bt.id))));const Pe=pe.getAudioTracks()[0]||"audio",Fe=pe.getVideoTracks()[0]||"video",Ye={direction:"sendonly",streams:[pe],sendEncodings:pp(this.publishAudioStream)},dt={direction:"sendrecv",streams:[pe],sendEncodings:(H=this.publishVideoStream)===null||H===void 0?void 0:H.config.encodingLayers};this.peerConnection.addTransceiver(Pe,Ye),this.trace(O,b,`track added, type: ${Pe.kind||Pe}`,F,ie);const xt=this.peerConnection.addTransceiver(Fe,dt);this.trace(O,b,`track added, type: ${Fe.kind||Fe}`,F,ie);const Dt=!!(!((te=(X=this.publishVideoStream)===null||X===void 0?void 0:X.config)===null||te===void 0)&&te.inBandMessagingEnabled);this.sendInBandMessagingEnabled===void 0?this.sendInBandMessagingEnabled=Dt:this.sendInBandMessagingEnabled!==Dt&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for sender"}),this.sendInBandMessagingEnabled&&!Ui.isSupported(xt)?this.handleTransformNotSupported():this.sendInBandMessagingEnabled&&((ue=this.videoSenderTransformer)===null||ue===void 0||ue.onTransceiverAdd(xt))}else F===Fn.SUBSCRIBE&&(O.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(O,b,"track added, type: audio",F,ie),C||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(O,b,"track added, type: video",F,ie),this.receiveInBandMessagingEnabled&&!_c.isSupported(this.videoTransceiver)?this.handleTransformNotSupported():this.receiveInBandMessagingEnabled&&((Ee=this.videoReceiverTransformer)===null||Ee===void 0||Ee.onTransceiverAdd(this.videoTransceiver))),this.peerConnection.getTransceivers().forEach((ye=>{ye.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),pe?.addTrack(ye.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})})),this.applyJitterBufferMinDelayConditionally((d=(w=this.stageConnection)===null||w===void 0?void 0:w.getIsStagePublishing())!==null&&d!==void 0&&d));return pe}))}handlePublishingChanged(C){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${C}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===Fn.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(C)}applyJitterBufferMinDelayConditionally(C){const P=this.currentJitterBufferMinDelayInMs,H=this.calcJitterBufferMinDelay(C,this.jitterBufferConfig);if(C){if(P===void 0||P>H){const X=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${H}`;this.logger.debug({msg:X}),this.trace(this.token,this.traceId,X,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(H)}}else if(P===void 0||H!==P){const X=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${H}`;this.logger.debug({msg:X}),this.trace(this.token,this.traceId,X,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(H)}}calcJitterBufferMinDelay(C,P){var H,X,te;let ue=0;if(!(()=>{const Ee=RTCRtpReceiver.prototype;return!(!Ee||typeof Ee!="object")&&("jitterBufferTarget"in Ee||"playoutDelayHint"in Ee)})())return 0;if(C)ue=um((H=P?.minDelayWhenPublishing)!==null&&H!==void 0?H:ll.DEFAULT,C);else{ue=um((X=P?.minDelayWhenSubscribeOnly)!==null&&X!==void 0?X:ll.DEFAULT,C);const Ee=(te=this.stageConnection)===null||te===void 0?void 0:te.jitterBufferMinDelayInMs();P?.minDelayWhenSubscribeOnly===ll.DEFAULT&&Ee!==void 0&&(ue=Ee,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${ue}`}))}return ue}applyAndTrackJitterBufferMinDelay(C){var P,H;this.currentJitterBufferMinDelayInMs=C,this.statsReporter.updateJitterBufferMinDelay(C),C!==void 0&&((H=(P=this.peerConnection)===null||P===void 0?void 0:P.getTransceivers())===null||H===void 0||H.forEach((X=>{X.receiver&&this.applyJitterBufferMinDelay(X.receiver,C)})))}applyJitterBufferMinDelay(C,P){let H="Unable to set jitter buffer min delay";if("jitterBufferTarget"in C)H=`setting jitterBufferTarget to: ${P} for track: ${C.track.kind}`,this.logger.debug({msg:H}),C.jitterBufferTarget=P;else if("playoutDelayHint"in C){const X=P/1e3;H=`setting playoutDelayHint to: ${P} for track: ${C.track.kind}`,this.logger.debug({msg:H}),C.playoutDelayHint=X}else this.logger.warn({msg:H});this.trace(this.token,this.traceId,H,this.action,this.identifier)}exchangeSdp(C){var P,H,X;return Ra(this,void 0,void 0,(function*(){const{traceId:te,token:ue,action:Ee,identifier:w,tag:d,endpointURL:b}=this,{iceRestart:O=!1,nodeOverride:F,assignmentToken:ie,abortController:pe}=C;let ye;this.logger.debug({msg:`Exchanging SDP: ${te.value}, iceRestart=${O}, nodeOverride=${F}, assignmentToken=${ie}`}),Af(this.peerConnection),Ee===Fn.PUBLISH&&Yp()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((Pe,Fe)=>{var Ye,dt;const xt=(Ye=RTCRtpReceiver.getCapabilities("video"))===null||Ye===void 0?void 0:Ye.codecs;if(!xt)return;let Dt=xt;Dt=af(xt,"42e0"),Fe.preferMainProfile&&(Dt=af(xt,"4d00")),(dt=Pe.getTransceivers().find((bt=>bt.receiver.track.kind==="video")))===null||dt===void 0||dt.setCodecPreferences(Dt)})(this.peerConnection,{preferMainProfile:Yp()}));try{this.trace(ue,te,"Creating offer",Ee,w),ye=yield this.peerConnection.createOffer({iceRestart:O})}catch(Pe){const Fe=new Fr(Object.assign(Object.assign({},ho(hn.CREATE_OFFER_FAILURE,Pe)),{action:Ee,token:ue,traceId:te,tag:d,location:"exchangeSdp",remoteParticipantId:w}));this.emit(rs,Fe),this.analyticsTracker.trackErrorAndThrow(Fe)}ye.sdp&&(ye.sdp=this.mungeSdpOffer(ye.sdp,Ee,{simulcastEnabled:(H=(P=this.publishVideoStream)===null||P===void 0?void 0:P.config.simulcastEnabled)!==null&&H!==void 0&&H,audioConfig:(X=this.publishAudioStream)===null||X===void 0?void 0:X.config})),this.trace(ue,te,"Setting local description",Ee,w),yield this.peerConnection.setLocalDescription(ye),this.trace(ue,te,"local description set",Ee,w),b||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const Re=Ee===Fn.PUBLISH&&Yp()||Ee===Fn.SUBSCRIBE&&ma("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:b,nodeOverride:F,assignmentToken:ie,multiCodec:Re,abortController:pe})}))}getReports(){var C;return Ra(this,void 0,void 0,(function*(){try{const P=(yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats())||[],H=[];return P.forEach((X=>{H.push(X)})),H}catch{return[]}}))}requestRTCStats(C){return Ra(this,void 0,void 0,(function*(){if(this.peerConnection)return this.statsReporter.getStats(C)}))}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:C,tag:P,identifier:H,action:X,traceId:te}=this,ue=io({traceId:te,token:C,tag:P,identifier:H,action:X,stageErrorValue:hn.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:ue,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(ue),this.emit(lh,ue)}handleConnectionFailure(){return Ra(this,void 0,void 0,(function*(){const{token:C,traceId:P,tag:H}=this;this.analyticsTracker.trackError(new Fr(Object.assign(Object.assign({},hn.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:C,traceId:P,tag:H,location:"onIceCandidateError",remoteParticipantId:this.identifier})))}))}getSilentAudio(){Ga||(Ga=new AudioContext);const C=Ga.createOscillator(),P=Ga.createGain();C.connect(P);const H=Ga.createMediaStreamDestination();return P.connect(H),P.gain.value=0,C.start(),H.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}getProtocol(){return this.protocol}initStreamsToPublish(C){this.publishVideoStream=C.find(om),this.publishAudioStream=C.find(Bc)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var C,P;return this.calcJitterBufferMinDelay((P=(C=this.stageConnection)===null||C===void 0?void 0:C.getIsStagePublishing())!==null&&P!==void 0&&P,this.jitterBufferConfig)}trace(C,P,H,X,te){this.analyticsTracker.trackEventNoSharedProps(new Co(C,P,H,X,te))}sendSeiMessage(C,P){const H=this.getTransceiverForKind("video");return this.videoSenderTransformer&&this.sendInBandMessagingEnabled?this.action===Fn.PUBLISH&&H?this.videoSenderTransformer.sendSeiMessage(C,P):Jn.err(aa.NOT_PUBLISHING_VIDEO):Jn.err(aa.INBAND_MESSAGING_NOT_ENABLED)}}const $a=Fn.SUBSCRIBE;class Nl{constructor(C,P,H){this.analyticsTracker=C,this.token=P,this.remoteId=H,this.action=$a}trackAttempt({stageConnectionStats:C,isReassignment:P=!1,traceIdOverride:H,preAttemptSfuResource:X}){const{action:te,analyticsTracker:ue,token:Ee,remoteId:w}=this,d=H||Ks();return ue.trackEvent(new r_({token:this.token,subscribedId:this.remoteId,traceId:d,isEdpConnected:C.isConnected,isReassignment:P,preAttemptSfuResource:X})),{getTraceId:()=>d,trackSubscribeStarted({totalDurationWithRetries:b,retryTimes:O,sfuResource:F,peerClientPerfStats:ie,protocol:pe}){const{optionsDuration:ye,postDuration:Re,timeToCandidate:Pe,timeToConnected:Fe,sdpExchangeDuration:Ye,sdpExchangeTransport:dt,setRemoteDescDuration:xt,peerConnectionDuration:Dt}=ie,{edpInitialConnectDuration:bt,edpInitialConnectRetries:gt,edpInitialStateDuration:kt,edpInitialStatePublishingCount:wt,edpStateUpdateCount:It}=C;ue.trackEvent(new Z_({token:Ee,traceId:d,remoteParticipantId:w,optionsDuration:ye,postDuration:Re,timeToCandidate:Pe,totalDuration:Fe,edpInitialConnectDuration:bt,edpInitialConnectRetries:gt,edpInitialStateDuration:kt,edpInitialStatePublishingCount:wt,edpStateUpdateCount:It,sdpExchangeDuration:Ye,sdpExchangeTransport:dt,setRemoteDescDuration:xt,peerConnectionDuration:Dt,sfuResource:F,totalDurationWithRetries:b,subscribeRetryTimes:O,isReassignment:P,protocol:pe}))},trackSubscribeFirstFrame:({peerClientPerfStats:b,totalDurationWithRetries:O,sfuResource:F,retryTimes:ie,currentJitterBufferMinDelayInMs:pe,mediaType:ye,firstFrameDuration:Re,protocol:Pe})=>{const{sdpExchangeDuration:Fe,sdpExchangeTransport:Ye,setRemoteDescDuration:dt,peerConnectionDuration:xt}=b,{edpInitialConnectDuration:Dt,edpInitialConnectRetries:bt,edpInitialStateDuration:gt,edpInitialStatePublishingCount:kt,edpStateUpdateCount:wt}=C;this.analyticsTracker.trackEvent(new J_({token:this.token,traceId:d,remoteParticipantId:w,edpInitialConnectDuration:Dt,edpInitialConnectRetries:bt,edpInitialStateDuration:gt,edpInitialStatePublishingCount:kt,edpStateUpdateCount:wt,sdpExchangeDuration:Fe,sdpExchangeTransport:Ye,setRemoteDescDuration:dt,peerConnectionDuration:xt,videoWasPaused:!1,firstFrameDuration:Re,mediaType:ye,sfuResource:F,totalDurationWithRetries:O,subscribeRetryTimes:ie,currentJitterBufferMinDelayInMs:pe,protocol:Pe}))},trackSubscribeFailed(b,O,F){const ie=((Re,Pe,Fe)=>{if(Re instanceof Fr)return Re;let Ye="";return Re instanceof Ho.AxiosError&&(Ye+=`AxiosError - ${Re.code}`),new Fr(Object.assign(Object.assign(Object.assign({},hn.SUBSCRIBE_FAILURE),{action:$a,token:Pe,traceId:Fe,tag:Mi,location:"subscribe",details:`${Ye} ${Re?.message}`}),{fatal:!0}))})(b,Ee,d);ue.trackEvent(new pg({token:Ee,traceId:d,remoteParticipantId:w,code:ie.code,message:ie.message,fatal:ie.fatal,nominal:ie.nominal,isReassignment:P,protocol:O}));const{isConnected:pe}=C,ye=new Fr(Object.assign(Object.assign({},hn.SUBSCRIBE_FAILURE),{action:te,token:Ee,traceId:d,tag:kn(Fn.SUBSCRIBE,w),location:"subscribe",remoteParticipantId:w,isEdpConnected:pe,details:F}));return b instanceof Fr&&(ye.fatal=b.fatal,ye.nominal=b.nominal,ye.location=`subscribe > ${b.location}`),ue.trackError(ye),ie},trackUnsubscribe:()=>{ue.trackEvent(new K_({token:Ee,unsubscribedId:w,traceId:d}))},trackEndSucceeded:(b,O)=>{ue.trackEvent(new mg({token:Ee,traceId:d,remoteParticipantId:w,isUnsubscribeSuccessful:!0,reason:b,protocol:O}))},trackEndFailed:(b,O)=>{const F=new Fr(Object.assign(Object.assign({},hn.UNSUBSCRIBE_FAILURE),{token:Ee,traceId:d,tag:kn(Fn.SUBSCRIBE,w),location:"unsubscribe",remoteParticipantId:w}));return b!==Ti.UNLOAD&&b!==Ti.UNSUBSCRIBE||ue.trackError(F),ue.trackEvent(new mg({token:Ee,traceId:d,remoteParticipantId:w,isUnsubscribeSuccessful:!0,reason:b,protocol:O})),F}}}}class la extends ur{constructor(C,P,H,X,te,ue){super(Xn.PLAYBACK_LAYER_REQUEST,C,P,!1),Object.assign(this.properties,{media_type:H,remote_participant_id:X,track_id:te,layer_id:ue})}}class qr extends ur{constructor(C,P,H,X,te,ue=1){super(Xn.PLAYBACK_LAYER_STATE,C,P,!1),Object.assign(this.properties,{media_type:H,remote_participant_id:X,track_id:te,request_count:ue})}}var ds,Aa,ru,Gi;(function(j){j.PAUSE="pause",j.PLAY="play"})(ds||(ds={})),(function(j){j.IDLE="idle",j.ACTIVE="active",j.ERRORED="errored",j.DESTROYED="destroyed"})(Aa||(Aa={})),(function(j){j.SUCCESS="success"})(ru||(ru={})),(function(j){j.FAILED="failed",j.DESTROYED="destroyed",j.THROTTLED="throttled"})(Gi||(Gi={}));var Wa=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class cf{constructor(C){this.state=Aa.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>Wa(this,void 0,void 0,(function*(){return this.state!==Aa.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(ds.PAUSE)})),this.startVideo=()=>Wa(this,void 0,void 0,(function*(){return this.state!==Aa.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(ds.PLAY)})),this.setLayer=P=>Wa(this,void 0,void 0,(function*(){return this.state!==Aa.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(P)})),this.unsetLayer=()=>Wa(this,void 0,void 0,(function*(){return this.state!==Aa.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()})),this.getLayers=()=>Wa(this,void 0,void 0,(function*(){return this.state!==Aa.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()})),this.sendPlaybackRequest=P=>Wa(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Jn.err)(Gi.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,Jn.err)(Gi.FAILED);this.logger.info({msg:`Sending ${P} request to ${this.playbackEndpoint}`});const H=P===ds.PAUSE?{pause:[this.mid]}:{play:[this.mid]},X=this.createPostWhepRequest(H);return fetch(this.playbackEndpoint,X).then((te=>{if(te.status>=300){const ue=new Error(`Error sending media controls request: ${te.status}:${te.statusText}`);return this.logger.error({err:ue}),(0,Jn.err)(Gi.FAILED)}return this.logger.debug({msg:`Request to ${P} was successful: ${te.status}`}),(0,Jn.ok)(ru.SUCCESS)})).catch((te=>(this.logger.error({err:te,msg:"Error sending media controls request"}),(0,Jn.err)(Gi.FAILED))))})),this.sendLayerRequest=P=>Wa(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Jn.err)(Gi.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Jn.err)(Gi.FAILED);const H=typeof P=="string",X=H?{mediaId:this.mid,encodingId:P}:{},te=H?`set : ${P}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${te} at ${this.layersEndpoint}`});const ue=this.createPostWhepRequest(X);return this.trackLayerRequest(P??"auto"),fetch(this.layersEndpoint,ue).then((Ee=>this.state===Aa.DESTROYED?(0,Jn.err)(Gi.DESTROYED):Ee.status>=300?this.handleLayerRequestError(Ee.status,Ee.statusText):(this.logger.debug({msg:`Request to ${te} was successful: ${Ee.status}`}),(0,Jn.ok)(ru.SUCCESS)))).catch((Ee=>this.handleLayerRequestError(0,Ee.message)))})),this.sendLayerStateRequest=()=>Wa(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Jn.err)(Gi.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Jn.err)(Gi.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const P=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,P).then((H=>Wa(this,void 0,void 0,(function*(){var X;if(this.state===Aa.DESTROYED)return(0,Jn.err)(Gi.DESTROYED);if(H.status>=300)return this.handleLayerStateRequestError(H.status,H.statusText);const te=yield H.json(),ue=(X=te?.layers)!==null&&X!==void 0?X:[],Ee=JSON.stringify(ue,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${Ee}`}),(0,Jn.ok)(ue)})))).catch((H=>this.handleLayerStateRequestError(0,H.message)))})),this.logger=new wn(C.logger,_e.REMOTE_PLAYBACK),this.token=C.token,this.traceId=C.traceId,this.analyticsTracker=C.analyticsTracker,this.remoteParticipantId=C.remoteParticipantId}set mediaId(C){if(this.state!==Aa.DESTROYED){if(this.mid=C,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Aa.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Aa.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(C){var P,H;if(this.state!==Aa.DESTROYED){if(this.playbackEndpoint=(P=C.playback)!==null&&P!==void 0?P:null,this.layersEndpoint=(H=C.layers)!==null&&H!==void 0?H:null,!this.playbackEndpoint||!this.layersEndpoint){const X={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(X,null)}`}),void(this.state=Aa.IDLE)}this.mid&&(this.state=Aa.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Aa.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(C="command"){this.logger.info({msg:`skipping ${C}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(C){return C===Aa.DESTROYED?(0,Jn.err)(Gi.DESTROYED):(0,Jn.err)(Gi.FAILED)}createPostWhepRequest(C){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(C)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var C,P;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":As().value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(P=(C=this.traceId)===null||C===void 0?void 0:C.value)!==null&&P!==void 0?P:"","X-Stages-WHIP-Version":Zc}}trackLayerRequest(C){var P;this.analyticsTracker.trackEventNoSharedProps(new la(this.token,this.traceId,Gr.VIDEO,this.remoteParticipantId,(P=this.mid)!==null&&P!==void 0?P:"unknown",C))}trackLayerStateRequest(C=1){var P;this.analyticsTracker.trackEventNoSharedProps(new qr(this.token,this.traceId,Gr.VIDEO,this.remoteParticipantId,(P=this.mid)!==null&&P!==void 0?P:"unknown",C))}handleLayerRequestError(C,P){const H=`sendLayerRequest failed for reason: ${C} ${P}`;let X,te;return C===429?(X=Gi.THROTTLED,te=hn.WHEP_SET_LAYER_REQUEST_THROTTLED):(X=Gi.FAILED,te=hn.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(te,H),(0,Jn.err)(X)}handleLayerStateRequestError(C,P){const H=`sendLayerStateRequest failed for reason: ${C} ${P}`;let X,te;return C===429?(X=Gi.THROTTLED,te=hn.WHEP_GET_LAYER_STATE_THROTTLED):(X=Gi.FAILED,te=hn.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(te,H),(0,Jn.err)(X)}trackRequestError(C,P){const H=new Error(P);this.logger.error({err:H}),C.message=P;const X=this.createError(C);this.analyticsTracker.trackError(X)}createError(C,P){return new Fr(Object.assign({action:Fn.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:Mi,details:P},C))}}var Gs,Os,Di,so,vc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Pl=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Di||(Di={})),(function(j){j.NONE="none",j.AUDIO_ONLY="audio_only",j.AUDIO_VIDEO="audio_video"})(so||(so={}));class mr extends uc{constructor(C,P,H,X,te,ue,Ee){super(),this.id=C,this.token=P,this.stageConnection=H,this.nonScopedLogger=X,this.analyticsTracker=te,this.desiredSubscribeType=ue,Gs.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:Di.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new ol(1e3),this.cleanupFirstFrameTracking=Qc,this.actualSubscribeType=so.NONE,this.action=Fn.SUBSCRIBE,this.updateDesiredSubscribeType=d=>{this.desiredSubscribeType=d,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=d=>{this.peerClient.updateSubscribeConfig(d)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const d=this.actualSubscribeType,b=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${b}`}),this.subscriptionState.connectionState===Di.CONNECTED&&b!==so.NONE&&d!==b&&this.applyVideoControlsBySubscribeType(b,d)},this.onParticipantUpdated=d=>{Pl(this,Gs,"m",Os).call(this,d)&&(this.logger.debug({msg:"onParticipantUpdated",participant:d}),this.processStateUpdate({isTargetPublishing:d.isPublishing}))},this.onParticipantJoined=d=>{Pl(this,Gs,"m",Os).call(this,d)&&(this.logger.debug({msg:"onParticipantJoined",participant:d}),this.processStateUpdate({isTargetPublishing:d.isPublishing}))},this.onParticipantLeft=d=>{Pl(this,Gs,"m",Os).call(this,d)&&(this.logger.debug({msg:"onParticipantLeft",participant:d}),this.processStateUpdate({isTargetPublishing:!1}))},this.onPeerClientConnectionStateChange=d=>{const b=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${d}`,state:d,targetParticipant:b}),this.processStateUpdate({peerClientState:d})},this.onPeerClientTransformError=d=>{this.emit(fs,d)},this.onSdpNegotiated=d=>{this.remotePlaybackController.endpoints={playback:d.mediaControls,layers:d.layerControls}},this.seiMessageHandler=d=>{this.emit(Pc,d)},this.requestRTCStats=d=>vc(this,void 0,void 0,(function*(){return this.peerClient.requestRTCStats(d)})),this.trySubscribe=d=>vc(this,void 0,void 0,(function*(){var b,O;if(this.logger.debug({msg:`Subscribe attempt started: ${d}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==Di.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:Di.CONNECTING}));const F=this.stageConnection.getConnectionStats(),ie=this.peerClient.getExpectedJitterBufferMinDelayInMs(),pe=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:F,preAttemptSfuResource:pe});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:ye}=yield this.subscribe(this.attemptTracker.getTraceId()),Re=performance.now()-this.startConnectingTimestamp,Pe=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const Fe=this.failedRetries;this.attemptToActualizeSubscribeType();const Ye=this.peerClient.getActionMeasurements(),dt=this.peerClient.getProtocol();if(this.attemptTracker.trackSubscribeStarted({sfuResource:Pe,totalDurationWithRetries:Re,retryTimes:Fe,peerClientPerfStats:Ye,protocol:dt}),ye){this.cleanupFirstFrameTracking();const xt=this.actualSubscribeType,Dt=this.attemptTracker,bt=(gt,kt)=>{Dt.trackSubscribeFirstFrame({peerClientPerfStats:Ye,sfuResource:Pe,totalDurationWithRetries:Re,retryTimes:Fe,currentJitterBufferMinDelayInMs:ie,mediaType:kt,firstFrameDuration:gt,protocol:dt})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:ye,subscribeType:xt,callback:bt})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,ye&&this.emit(Hs,ye,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(ye){const Re=(O=(b=this.peerClient)===null||b===void 0?void 0:b.getProtocol())!==null&&O!==void 0?O:"",Pe=this.attemptTracker.trackSubscribeFailed(ye,Re);this.logger.error({log:"Subscribe attempt failed",err:ye}),this.onTrySubscribeFailure(Pe,d)}return!1}));const w=Ks();this.peerClient=new bs(P,this.nonScopedLogger,this.action,kn(this.action,C),w,te,C,H,Ee),this.logger=new wn(X,_e.SUBSCRIPTION),this.subscribeTracker=new Nl(this.analyticsTracker,P,C),this.remotePlaybackController=new cf({token:P,analyticsTracker:te,traceId:w,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(C,P){try{C===so.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch((H=>{this.logger.error({err:H,msg:"Remote playback request to stop video failed"})})):C===so.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch((H=>{this.logger.error({err:H,msg:"Remote playback request to start video failed"})})),this.actualSubscribeType=C,this.logger.debug({msg:`Desired subscribe type actualized from ${P} to ${C}.`})}catch(H){this.logger.error({err:H,msg:`Error updating subscribe type from ${P} to ${C}.`})}}processStateUpdate(C){const P=this.previousSignalState,H=Object.assign({},P,C);if(!this.isSubscriptionActive)return void this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"});H.isTargetPublishing?C.peerClientState===sr.CONNECTED?this.updateState({connectionState:Di.CONNECTED,subscribeInProgress:!0}):C.peerClientState===sr.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ti.CONNECTION_FAIL,this.peerClient.getProtocol()),this.updateState({subscribeInProgress:!1}),this.emit(Ml)):(P.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:Di.DISCONNECTED}));const X=!P.isTargetPublishing&&C.isTargetPublishing,te=this.subscriptionState.connectionState===Di.CONNECTED&&C.peerClientState===sr.FAILED;(X||te)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,C)}onTrySubscribeFailure(C,P){this.logger.debug({msg:"Changing/keeping state FAILED"});const H=C.fatal,X=C.code===hn.OPERATION_ABORTED.code,te=this.failedRetries<=4;if(!X&&!H&&te){const ue=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${ue}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout((()=>vc(this,void 0,void 0,(function*(){this.throttledTrySubscribe(P)}))),ue)}else this.updateState({connectionState:Di.ERRORED}),this.emit(Vh,C),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(Eo,this.onPeerClientConnectionStateChange),this.peerClient.on(wf,this.onSdpNegotiated),this.peerClient.on(Mc,this.seiMessageHandler),this.peerClient.on(lh,this.onPeerClientTransformError),this.stageConnection.on(wo,this.onParticipantUpdated),this.stageConnection.on(kf,this.onParticipantJoined),this.stageConnection.on(If,this.onParticipantLeft),this.stageConnection.on(lg,this.onParticipantLeft);let C=!0;if(this.stageConnection.isConnected()){const P=this.stageConnection.getParticipant(this.id);C=!!P?.isPublishing}this.processStateUpdate({isTargetPublishing:C})}throttledTrySubscribe(C){return this.throttler.invoke(this.trySubscribe,C)}updateState(C){C.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=C.subscribeInProgress),C.connectionState&&this.subscriptionState.connectionState!==C.connectionState&&(this.subscriptionState.connectionState=C.connectionState,this.emit(Cl,this.subscriptionState.connectionState))}stop(C=!1){this.peerClient.off(Eo,this.onPeerClientConnectionStateChange),this.peerClient.off(lh,this.onPeerClientTransformError),this.peerClient.off(wf,this.onSdpNegotiated),this.peerClient.off(Mc,this.seiMessageHandler),this.unsubscribe(C),this.throttler.clear(),this.stageConnection.off(wo,this.onParticipantUpdated),this.stageConnection.off(kf,this.onParticipantJoined),this.stageConnection.off(If,this.onParticipantLeft),this.stageConnection.off(lg,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:Di.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(C,P){return vc(this,void 0,void 0,(function*(){const{token:H,id:X}=this;H.assertTokenIsUnexpired(C,kn(Fn.SUBSCRIBE,X),"subscribe",X);const{mediaStream:te}=yield this.peerClient.connect({audioOnly:P,traceId:C});return{peerClient:this.peerClient,mediaStream:te}}))}unsubscribe(C=!1){return vc(this,void 0,void 0,(function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===Di.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const P=C?Ti.UNLOAD:Ti.UNSUBSCRIBE,H=this.peerClient.getProtocol();try{C?this.peerClient.disconnect(C):yield this.peerClient.disconnect(C),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(P,H)}catch{this.attemptTracker.trackEndFailed(P,H)}}))}triggerIceRestart(C){var P;return vc(this,void 0,void 0,(function*(){const H=this.stageConnection.getConnectionStats(),X=this.peerClient.getSfuResource(),te=this.subscribeTracker.trackAttempt({stageConnectionStats:H,isReassignment:!0,traceIdOverride:C.traceId,preAttemptSfuResource:X}),ue=performance.now();try{this.emit(dc),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:C,traceId:C.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const Ee=performance.now()-ue,w=this.peerClient.getSfuResource(),d=this.peerClient.getActionMeasurements();(P=this.attemptTracker)===null||P===void 0||P.trackEndSucceeded(Ti.REASSIGNMENT,this.peerClient.getProtocol()),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),te.trackSubscribeStarted({totalDurationWithRetries:Ee,sfuResource:w,retryTimes:0,peerClientPerfStats:d,protocol:this.peerClient.getProtocol()}),this.emit(Gh)}catch(Ee){this.emit(Xl),this.logger.error({msg:"ICE restart attempt failed",err:Ee});const w=this.peerClient.getSfuResource(),d=te.trackSubscribeFailed(Ee,this.peerClient.getProtocol(),`iceRestart=true, startNode=${X.node}, endNode=${w?.node}`);throw d.code===hn.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(d,"ice restart timeout"),Ee}}))}measureFirstFrameDuration({mediaStream:C,subscribeType:P,callback:H}){const X=performance.now(),te=w=>{const d=performance.now()-X;H(d,w),w==="audio"?Ee():ue()};let ue=Qc,Ee=Qc;return P!==so.AUDIO_ONLY&&(ue=(function(w,d){return Md(w,"video",d)})(C,te)),Ee=(function(w,d){return Md(w,"audio",d)})(C,te),()=>{ue(),Ee()}}}var fr,Yn;Gs=new WeakSet,Os=function(j){return j.id===this.id},(function(j){j.JOIN_ERROR="JOIN_ERROR",j.PUBLISH_ERROR="PUBLISH_ERROR",j.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"})(fr||(fr={})),(function(j){j[j.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",j[j.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",j[j.TIMEOUT=3]="TIMEOUT",j[j.FAILED=4]="FAILED",j[j.CANCELED=5]="CANCELED",j[j.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",j[j.CODEC_MISMATCH=7]="CODEC_MISMATCH",j[j.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED",j[j.STAGE_DELETED=9]="STAGE_DELETED",j[j.PARTICIPANT_DISCONNECTED=10]="PARTICIPANT_DISCONNECTED"})(Yn||(Yn={}));const Ya={[Yn.TOKEN_MALFORMED]:"Token is malformed",[Yn.TOKEN_EXPIRED]:"Token expired and is no longer valid",[Yn.TIMEOUT]:"Operation timed out",[Yn.FAILED]:"Operation failed",[Yn.CANCELED]:"Operation canceled",[Yn.STAGE_AT_CAPACITY]:"Stage at capacity",[Yn.CODEC_MISMATCH]:"Client codec is not supported",[Yn.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation",[Yn.STAGE_DELETED]:"Stage has been deleted, unable to join",[Yn.PARTICIPANT_DISCONNECTED]:"Participant has been disconnected, unable to join"},Wr={[hn.EXPIRED_TOKEN.code]:Yn.TOKEN_EXPIRED,[hn.MALFORMED_TOKEN.code]:Yn.TOKEN_MALFORMED,[hn.JOIN_SERVER_BAD_REQUEST.code]:Yn.FAILED,[hn.TOKEN_PERMISSIONS_DENIED.code]:Yn.TOKEN_NOT_ALLOWED,[hn.OPERATION_ABORTED.code]:Yn.CANCELED,[hn.JOIN_TIMED_OUT.code]:Yn.TIMEOUT,[hn.STAGE_DELETED.code]:Yn.STAGE_DELETED,[hn.PARTICIPANT_DISCONNECTED.code]:Yn.PARTICIPANT_DISCONNECTED,[hn.EVENT_PLANE_WS_CREATE_FAILED.code]:Yn.FAILED,[hn.PUBLISH_TIMED_OUT.code]:Yn.TIMEOUT,[hn.PUBLISH_FAILURE.code]:Yn.FAILED,[hn.SUBSCRIBE_TIMED_OUT.code]:Yn.TIMEOUT,[hn.SUBSCRIBE_FAILURE.code]:Yn.FAILED,[hn.STAGE_AT_CAPACITY.code]:Yn.STAGE_AT_CAPACITY,[hn.NO_MATCHING_CODEC.code]:Yn.CODEC_MISMATCH,[hn.NETWORK_FAILURE.code]:Yn.FAILED,[hn.INTERNAL_SERVER_ERROR.code]:Yn.FAILED,[hn.REMOTE_STREAM_NOT_FOUND.code]:Yn.FAILED,[hn.INTERNAL_MHCP_ERROR.code]:Yn.FAILED,[hn.UNREACHABLE_MHCP.code]:Yn.FAILED,[hn.INVALID_SESSION_STATUS.code]:Yn.FAILED,[hn.MHCP_ABORTED.code]:Yn.FAILED,[hn.EVENT_PLANE_PONG_TIMEOUT.code]:Yn.FAILED,[hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:Yn.FAILED},is={[hn.SEI_INSERT_NOT_PUBLISHING_VIDEO.code]:"SEI insert failed due to not publishing video",[hn.SEI_INSERT_INBAND_NOT_ENABLED.code]:"SEI insert failed due to in-band messaging not being enabled for the stage stream"};class Lu extends Error{constructor(C,P,H){super(),this.code=C,this.category=P,this.message=H,this.name="StageError",this.errorDetails=[],this.message=`[${P}] ${H}`}addDetails(C){this.errorDetails.push(C)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var iu,ko,od;function ld(j,C){let P;if(j instanceof Fr){if(C===fr.JOIN_ERROR&&(j.code===hn.EVENT_PLANE_PONG_TIMEOUT.code||j.code===hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code))return;const H=Wr[j.code];H&&(P=(function(X,te,ue){var Ee,w,d;const b=Ya[X],O=new Lu(X,te,b);return O.addDetails({stageErrorMessage:b,stageErrorCode:X,stageErrorCategory:te,stageArn:(Ee=ue.token)===null||Ee===void 0?void 0:Ee.stageARN,traceId:(w=ue.traceId)===null||w===void 0?void 0:w.value,causeCode:ue.code,causeDetails:ue.details,causeMessage:ue.message,causeLocation:ue.location,participantId:(d=ue.token)===null||d===void 0?void 0:d.participantID,timeUTC:new Date().toISOString()}),O})(H,C,j))}return P}(function(j){j.ERROR="error"})(iu||(iu={}));class Sp extends uc{constructor(C){super(),this.logger=C,this.handleError=(P,H,X=!0)=>{const te=(function(Ee){let w;return Ee instanceof Fr&&(w=is[Ee.code]),w})(P),ue=ld(P,H);if(te&&this.logger.warn({msg:te}),ue)return X&&this.emit(iu.ERROR,ue),ue}}}(function(j){j.INTERNAL="internal",j.REMOTE="remote",j.API="api"})(ko||(ko={})),(function(j){j.ADDITIVE="additive",j.REPLACE="replace"})(od||(od={}));class ca{constructor(C){this.logger=new wn(C.logger,_e.CONNECTION),this.subscribeConfig={defaults:C.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(C,P,H,X=od.REPLACE){P=(b=>{const O=Od(b);if(O.jitterBuffer!==void 0){const F=ie=>{if(typeof ie=="number"){if(ie<0)return 0;if(ie>4e3)return 4e3}return ie};O.jitterBuffer.minDelayWhenPublishing!==void 0&&(O.jitterBuffer.minDelayWhenPublishing=F(O.jitterBuffer.minDelayWhenPublishing)),O.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(O.jitterBuffer.minDelayWhenSubscribeOnly=F(O.jitterBuffer.minDelayWhenSubscribeOnly))}return O})(P),this.subscribeConfig.participants[C]===void 0&&(this.subscribeConfig.participants[C]={internalOverrides:{},apiOverrides:{},remoteOverrides:{},lastMerged:this.subscribeConfig.defaults});const te=this.subscribeConfig.participants[C];switch(H){case ko.INTERNAL:te.internalOverrides=this.handleSubscribeConfigLevelMerging(te.internalOverrides,P,X);break;case ko.REMOTE:te.remoteOverrides=this.handleSubscribeConfigLevelMerging(te.remoteOverrides,P,X);break;case ko.API:te.apiOverrides=this.handleSubscribeConfigLevelMerging(te.apiOverrides,P,X);break;default:(function(b){throw new Error(`Unknown case kind: ${b}`)})(H)}const ue=Ol(this.subscribeConfig.defaults,te.internalOverrides,te.remoteOverrides,te.apiOverrides);if(ue===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${C} | ${te}, ${P}`}),!1;const Ee=(w=te.lastMerged,d=ue,(typeof w=="object"&&typeof d=="object"&&(0,js.isEqual)(w,d))===!1);var w,d;return te.lastMerged=ue,this.subscribeConfig.participants[C]=te,Ee}handleExternalSubscribeConfigUpdate(C,P,H,X=od.REPLACE){const te=(ue=>{const Ee={};return typeof ue!="object"?Jn.err(new Error("Invalid input")):(ue.jitterBuffer!==void 0&&(Ee.jitterBuffer={},ue.jitterBuffer.minDelay!==void 0&&(Ee.jitterBuffer.minDelayWhenSubscribeOnly=ue.jitterBuffer.minDelay)),ue.inBandMessaging!==void 0&&(Ee.inBandMessaging={enabled:ue.inBandMessaging.enabled===!0}),ue.simulcast!==void 0&&(Ee.simulcast={},ue.simulcast.initialLayerPreference!==void 0&&(Ee.simulcast.initialLayerPreference=ue.simulcast.initialLayerPreference)),Jn.ok(Ee))})(P);return te.ok===!0&&this.handleSubscribeConfigUpdate(C,te.value,H,X)}handleSubscribeConfigLevelMerging(C,P,H){if(H===od.REPLACE)return P;{const X=Ol(C,P);return X===void 0?(this.logger.warn({msg:`Unable to merge '${C}' and '${P}' with type ${H}`}),C):X}}getSubscribeConfigSnapshot(C){return this.subscribeConfig.participants[C]===void 0?Da(this.subscribeConfig.defaults):Da(this.subscribeConfig.participants[C].lastMerged)}}class Ep extends ur{constructor(C){super(Xn.REASSIGNMENT_REQUEST,C.token,C.traceId,!1),Object.assign(this.properties,{target_local_participant_id:C.targetLocalParticipantId,target_remote_participant_id:C.targetRemoteParticipantId}),this.critical=!0}}var _l,vl,Fc,Ji,Jr,ao=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class vh extends uc{constructor(C,P){super(),this.setGetStats=H=>{this._getInternalStats=H},this.getStats=()=>ao(this,void 0,void 0,(function*(){return this.requestRTCStats()})),this.requestRTCStats=()=>ao(this,void 0,void 0,(function*(){if(!this._getInternalStats)return;const H=yield this._getInternalStats(this.mediaStreamTrack);return H?H.rawReport:void 0})),this._getInternalStats=P,this.id=C.id,this.isMuted=!C.enabled,this.mediaStreamTrack=C,this.streamType=this.mediaStreamTrack.kind==="audio"?Gr.AUDIO:Gr.VIDEO}cleanup(){this.removeAllListeners(),this._getInternalStats=void 0}}(function(j){j.IDLE="IDLE",j.INITIALIZING="INITIALIZING",j.ACTIVE="ACTIVE",j.CONTROLS_PAUSED="CONTROLS_PAUSED",j.DESTROYED="DESTROYED"})(_l||(_l={})),(function(j){j.LAYERS_CHANGED="LAYERS_CHANGED",j.LAYER_SELECTED="LAYER_SELECTED",j.ADAPTION_CHANGED="ADAPTION_CHANGED"})(vl||(vl={})),(function(j){j.LAYERS_CHANGED="LAYERS_CHANGED",j.LAYER_SELECTED="LAYER_SELECTED",j.ADAPTION_CHANGED="ADAPTION_CHANGED"})(Fc||(Fc={})),(function(j){j.UNAVAILABLE="unavailable",j.SELECTED="selected"})(Ji||(Ji={})),(function(j){j.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged",j.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST="localStreamInsertSeiMsgRequest"})(Jr||(Jr={}));var yl,va,Wo,zd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class zf extends vh{constructor(C,P){super(C),this.setMuted=H=>{H!==this.isMuted&&(this.mediaStreamTrack.enabled=!H,this.isMuted=H,this.emit(Jr.LOCAL_STREAM_MUTE_CHANGED,this))},this.insertSeiMessage=(H,X)=>zd(this,void 0,void 0,(function*(){let te;if(this.streamType==="audio")te=aa.INVALID_TRACK_TYPE;else if(this.mediaConfig.inBandMessaging.enabled){const ue=this.validator.validateMessagePayload(H,X?.repeatCount||0);te=Jn.getErr(ue)}else te=aa.INBAND_MESSAGING_NOT_ENABLED;te?console.warn(`Unable to insert SEI message due to ${te}`):this.emit(Jr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this,H,X)})),this.requestQualityStats=()=>zd(this,void 0,void 0,(function*(){if(!this._getInternalStats)return;const H=yield this._getInternalStats(this.mediaStreamTrack);return H?H.stats:void 0})),this.validatedExternalConfig=fg(C,P),this.normalizedConfig=n_(0,this.validatedExternalConfig),this.mediaConfig=(0,js.cloneDeep)(this.normalizedConfig),this.validator=new ev(Uc)}}class su{constructor(C,P){this.strategy=C,this.logger=P}setStrategy(C){this.strategy=C}hasStrategy(C){return this.strategy[C]!==void 0}stageStreamsToPublish(){let C=[];try{C=this.strategy.stageStreamsToPublish(),C=C.filter((X=>X instanceof zf))}catch(X){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:X}),console.error("Error executing stageStreamsToPublish",X),Jn.err(X)}let P=0,H=0;for(const X of C)X.mediaStreamTrack.kind==="audio"?P++:X.mediaStreamTrack.kind==="video"&&H++;if(P>1||H>1){const X=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return Jn.err(X)}return Jn.ok(C)}shouldPublishParticipant(C){try{return Jn.ok(this.strategy.shouldPublishParticipant(C))}catch(P){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:P}),console.error("Error executing shouldPublishParticipant",P),Jn.err(P)}}shouldSubscribeToParticipant(C){try{return Jn.ok(this.strategy.shouldSubscribeToParticipant(C))}catch(P){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:P}),console.error("Error executing shouldSubscribeToParticipant",P),Jn.err(P)}}subscribeConfiguration(C){var P,H;try{return Jn.ok((H=(P=this.strategy).subscribeConfiguration)===null||H===void 0?void 0:H.call(P,C))}catch(X){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:X}),console.error("Error executing subscribeConfiguration",X),Jn.err(X)}}preferredLayerForStream(C,P){var H,X;try{return Jn.ok((X=(H=this.strategy).preferredLayerForStream)===null||X===void 0?void 0:X.call(H,C,P))}catch(te){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:te}),console.error("Error executing preferredLayerForStream",te),Jn.err(te)}}}class au extends uc{constructor(C,P){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=va.NOT_PUBLISHED,this.logger=P,this.info=C,this.audioMuted=C.audioMuted,this.videoStopped=C.videoStopped}}(function(j){j.PUBLISH="publish",j.SUBSCRIBE="subscribe"})(yl||(yl={})),(function(j){j.NOT_PUBLISHED="not_published",j.ATTEMPTING_PUBLISH="attempting_publish",j.PUBLISHED="published",j.ERRORED="errored"})(va||(va={})),(function(j){j.NOT_SUBSCRIBED="not_subscribed",j.ATTEMPTING_SUBSCRIBE="attempting_subscribe",j.SUBSCRIBED="subscribed",j.ERRORED="errored"})(Wo||(Wo={}));function yh(j){return j.map((C=>C.remote))}function uf(j){return{label:j.encodingId,bitrateBps:1e3*j.bitrate,width:j.width,height:j.height,framesPerSecond:j.framesPerSecond,selected:j.selected}}function ua(j,C){const P=j.width*j.height,H=C.width*C.height;return P>H||j.bitrateBps>C.bitrateBps||j.framesPerSecond>C.framesPerSecond?1:P===H&&j.bitrateBps===C.bitrateBps&&j.framesPerSecond===C.framesPerSecond?0:-1}var jd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class ou extends uc{constructor(C){var P,H,X;super(),this.onAdaptionChanged=te=>{this.emit(Fc.ADAPTION_CHANGED,te)},this.onLayersChanged=te=>{this.emit(Fc.LAYERS_CHANGED,te)},this.onLayerSelected=(te,ue)=>{this.emit(Fc.LAYER_SELECTED,te,ue)},this.setGetStats=()=>{},this.requestRTCStats=()=>jd(this,void 0,void 0,(function*(){var te;return(te=this.internalStream)===null||te===void 0?void 0:te.requestRTCStats()})),this.requestQualityStats=()=>jd(this,void 0,void 0,(function*(){if(this.internalStream)try{const te=yield this.internalStream.getInternalStats();return te?te.stats:void 0}catch{return}})),this.getStats=()=>jd(this,void 0,void 0,(function*(){var te;return(te=this.internalStream)===null||te===void 0?void 0:te.requestRTCStats()})),this.setMuted=te=>{var ue;(ue=this.internalStream)===null||ue===void 0||ue.setMuted(te)},this.getLayers=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.layers)!==null&&ue!==void 0?ue:this.cachedLayers},this.getSelectedLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.selectedLayer)!==null&&ue!==void 0?ue:this.cachedSelectedLayer},this.getLowestQualityLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.lowestQualityLayer)!==null&&ue!==void 0?ue:this.cachedLowestLowestLayer},this.getHighestQualityLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.highestQualityLayer)!==null&&ue!==void 0?ue:this.cachedHighestQualityLayer},this.internalStream=C,this.cachedId=this.internalStream.id,this.cachedParticipantInfo=(0,js.cloneDeep)(this.internalStream.participantInfo),this.cachedStreamType=this.internalStream.streamType,this.cachedMediaStreamTrack=(X=(H=(P=this.internalStream.mediaStreamTrack).clone)===null||H===void 0?void 0:H.call(P))!==null&&X!==void 0?X:{},this.cachedIsMuted=this.internalStream.isMuted,this.cachedIsAdapting=this.internalStream.isAdapting,this.cachedLayers=this.internalStream.layers,this.updateCachedStreamData(),this.internalStream.on(vl.ADAPTION_CHANGED,this.onAdaptionChanged),this.internalStream.on(vl.LAYERS_CHANGED,this.onLayersChanged),this.internalStream.on(vl.LAYER_SELECTED,this.onLayerSelected)}updateCachedStreamData(){var C,P,H,X,te;this.cachedLayers=(P=(C=this.internalStream)===null||C===void 0?void 0:C.layers)!==null&&P!==void 0?P:[],this.cachedHighestQualityLayer=(H=this.internalStream)===null||H===void 0?void 0:H.highestQualityLayer,this.cachedLowestLowestLayer=(X=this.internalStream)===null||X===void 0?void 0:X.lowestQualityLayer,this.cachedSelectedLayer=(te=this.internalStream)===null||te===void 0?void 0:te.selectedLayer}get id(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.id)!==null&&P!==void 0?P:this.cachedId}get participantInfo(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.participantInfo)!==null&&P!==void 0?P:this.cachedParticipantInfo}get streamType(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.streamType)!==null&&P!==void 0?P:this.cachedStreamType}get mediaStreamTrack(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.mediaStreamTrack)!==null&&P!==void 0?P:this.cachedMediaStreamTrack}get isMuted(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.isMuted)!==null&&P!==void 0?P:this.cachedIsMuted}set isMuted(C){var P;(P=this.internalStream)===null||P===void 0||P.setMuted(C)}get isAdapting(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.isAdapting)!==null&&P!==void 0?P:this.cachedIsAdapting}cleanup(){var C,P,H;this.updateCachedStreamData(),(C=this.internalStream)===null||C===void 0||C.off(vl.ADAPTION_CHANGED,this.onAdaptionChanged),(P=this.internalStream)===null||P===void 0||P.off(vl.LAYERS_CHANGED,this.onLayersChanged),(H=this.internalStream)===null||H===void 0||H.off(vl.LAYER_SELECTED,this.onLayerSelected),this.internalStream=void 0,this.removeAllListeners()}}var $s,Io,cd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class bi extends vh{constructor({track:C,info:P,getStats:H,remotePlaybackController:X,analyticsTracker:te,token:ue,subscribeConfig:Ee}){super(C,H),this.hasRemoteListenersForLayerEvents=()=>{const d=this.remote;return d.hasListenersFor(Fc.ADAPTION_CHANGED)||d.hasListenersFor(Fc.LAYERS_CHANGED)||d.hasListenersFor(Fc.LAYER_SELECTED)},this.setMuted=d=>{this.isMuted=d,this.mediaStreamTrack.enabled=!d},this.setLayer=d=>{const b=(0,js.cloneDeep)(d);if(this.queueLayerUpdateForValidState(b))return void this.logger.debug({msg:`setLayer:${b} queued, skipping for now`});const O=(function(ie,pe){if(!ie)return(0,Jn.ok)(void 0);const ye=typeof ie=="string"?ie:ie.label,Re=pe.filter((Pe=>Pe.label===ye))[0];return Re?(0,Jn.ok)(Re):(0,Jn.err)(`Provided layer with id ${ye} does not exist`)})(b,this._layers);if(!O.ok){const ie=O.error;return void this.logger.error({err:ie,msg:"Unable to select layer, skipping selection"})}const F=O.value;if(this.isNextUpdateAdaptionOnly(F))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(F)||this.isAdapting?F&&(this.logger.warn({msg:`setLayer:${JSON.stringify(F)} `}),this.handleManualUpdate(F)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=_l.INITIALIZING,this.prevState=_l.IDLE,this.analyticsTracker=te,this.token=ue,this.id=C.id,this.info=P,this.mediaStreamTrack=C,this.remotePlaybackController=X,this.layerPollingIntervalId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this.subscribeConfig=Ee,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const w=op();this.logger=new wn(new tn(w),_e.REMOTE_STAGE_STREAM),this.streamType===Gr.AUDIO?this.isMuted=P.audioMuted:this.isMuted=P.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers(!0)}transitionStateTo(C){this.state!==C&&(this.prevState=this.state,this.state=C)}initializeLayerPolling(){vr(this.mediaStreamTrack)?this.streamType!==Gr.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingIntervalId!==null&&clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=setInterval((()=>{this.pollInternalLayers()}),this.subscribeConfig.simulcast.layerPollingIntervalMs)):this.logger.debug({msg:"Skipping initializing polling for audio streams"}):this.logger.debug({msg:"Skipping initializing polling, media track is not active"})}startLayerPolling(){this.layerPollingIntervalId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingIntervalId!==null?(clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(C=!1){if(!vr(this.mediaStreamTrack))return void this.pauseControls();if(this.streamType===Gr.AUDIO)return this.logger.debug({msg:"Skipping layer poll request for audio stream"}),void this.transitionStateTo(_l.ACTIVE);const P=!this.hasRemoteListenersForLayerEvents(),H=!this.subscribeConfig.simulcast.layerPollingEnabled;!C&&P&&H?this.logger.debug({msg:"Skipping layer request due to no listeners"}):this.remotePlaybackController.getLayers().then((X=>{if(this.isStateValidForLayerUpdates()){if(!X.ok)throw Error(X.error);this.updateInternalLayersFromRemote(X.value),this.transitionStateTo(_l.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})})).catch((X=>{this.logger.error({err:X,msg:"Error calling getLayers, returning current layers"})}))}updateInternalLayersFromRemote(C){const P=this._layers,H=C.map(uf).sort(ua),X=!(0,js.isEqual)(H,P);this._layers=H;const te=this._selectedLayer,ue=this._layers.filter((w=>w.selected))[0],Ee=!(0,js.isEqual)(ue,te);te&&(te.selected=!1),this._selectedLayer=ue,Ee&&(this.trackLayerUpdate(te),this.trackLayerUpdate(ue)),this.isCommandQueueEmpty()&&(X&&this.emitLayersChanged(),Ee&&this.emitLayerSelected(ue))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const C=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${C}`});for(const P of this.commandMap.keys()){const H=this.commandMap.get(P);H?.()}this.commandMap.clear()}queueLayerUpdateForValidState(C){if(!C)return this.commandMap.delete("setLayer"),!1;if(this.state===_l.INITIALIZING){const P=this.setLayer.bind(this,C);return this.commandMap.set("setLayer",P),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const C=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then((P=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(C,`Stream in invalid state: ${this.state}`);P.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(C,P.error)})).catch((()=>{}))}resetAdaptionStateOnError(C,P){this._isAdapting=C,this.emitAdaptionChanged(),this.logger.error({err:P,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(C){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const P=this._isAdapting,H=this._selectedLayer;H&&(H.selected=!1),this._isAdapting=!1,this._selectedLayer=C,C.selected=!0,P!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(C,H),this.trackLayerUpdate(H),this.trackLayerUpdate(C),this.emitLayersChanged(),this.emitLayerSelected(C),this.remotePlaybackController.setLayer(C.label).then((X=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const te=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(P,te),void this.resetLayerOnError(H,C,te)}if(!X.ok){const te=X.error;return this.resetAdaptionStateOnError(P,te),void this.resetLayerOnError(H,C,te)}this.logger.debug({msg:`Layer successfully selected: ${C.label}`})})).catch((()=>{}))}applyExistingControlState(){var C;this._isAdapting?this.remotePlaybackController.unsetLayer().then((()=>{})).catch((()=>{})):!((C=this._selectedLayer)===null||C===void 0)&&C.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then((()=>{})).catch((()=>{}))}resetLayerOnError(C,P,H){P&&(P.selected=!1),C&&(C.selected=!0),this._selectedLayer=C,this.logger.error({err:H,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(C,P),this.emitLayersChanged(),C!==null&&this.emitLayerSelected(C,Ji.UNAVAILABLE),this.trackLayerUpdate(P),this.trackLayerUpdate(C)}updateLocalLayerStateBeforeRemote(C,P){this._layers=this._layers.map((H=>H.label===C?.label?C:H.label===P?.label?P:H)).sort(ua)}trackLayerUpdate(C){var P,H;this.analyticsTracker.trackEventNoSharedProps(new La(this.token,Ks(),(P=C?.label)!==null&&P!==void 0?P:"auto",!0,Fn.SUBSCRIBE,(H=C?.selected)!==null&&H!==void 0&&H,this.info.id))}isNextUpdateAdaptionOnly(C){return C===void 0&&this.isFirstLayerUpdate()||C===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(C){var P;return((P=this._selectedLayer)===null||P===void 0?void 0:P.label)===C?.label}isStateValidForLayerUpdates(){return this.state===_l.ACTIVE||this.state===_l.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(C,P=Ji.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(C,null,2)}`}),this.emit(vl.LAYER_SELECTED,(0,js.cloneDeep)(C),P)}emitLayersChanged(){this.emit(vl.LAYERS_CHANGED,(0,js.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(vl.ADAPTION_CHANGED,this._isAdapting)}get remote(){const C=this.weakRemoteMap.get(this.weakRemoteKey);if(C)return C;const P=new ou(this);return this.weakRemoteMap.set(this.weakRemoteKey,P),P}get participantInfo(){return(0,js.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,js.cloneDeep)(this._layers)}get selectedLayer(){var C;return(0,js.cloneDeep)((C=this._selectedLayer)!==null&&C!==void 0?C:void 0)}get highestQualityLayer(){return(0,js.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,js.cloneDeep)(this.layers[0])}getInternalStats(){return cd(this,void 0,void 0,(function*(){if(this._getInternalStats)return this._getInternalStats(this.mediaStreamTrack)}))}pauseControls(){this.transitionStateTo(_l.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(_l.ACTIVE)}updateSubscribeConfig(C){const P=this.subscribeConfig;this.subscribeConfig=C,P.simulcast.layerPollingIntervalMs!==C.simulcast.layerPollingIntervalMs&&this.isStateValidForLayerUpdates()&&this.initializeLayerPolling()}cleanup(){this.transitionStateTo(_l.DESTROYED),super.cleanup(),this.weakRemoteMap.delete(this.weakRemoteKey),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(j){j.STATE_CHANGE="stateChange",j.MEDIA_STREAM_ADDED="mediaStreamAdded",j.MEDIA_STREAM_REMOVED="mediaStreamRemoved",j.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",j.ERROR="error"})($s||($s={})),(function(j){j.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",j.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"})(Io||(Io={}));const ar=Object.assign(Object.assign({},$s),Io);var Bi;(function(j){j.PUBLICATION_STATE_CHANGE="publicationStateChange"})(Bi||(Bi={}));const Yo=Object.assign(Object.assign({},$s),Bi);var ud=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class bh extends au{constructor(C,P,H,X,te,ue,Ee,w=!1){super(C,new wn(X,_e.REMOTE_PARTICIPANT)),this.subscribeState=Wo.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=d=>{this.logger.debug({msg:"subscriptionStateChange",state:d}),d===Di.DISCONNECTED?this.updateSubscriptionState(Wo.NOT_SUBSCRIBED):d===Di.CONNECTED?this.updateSubscriptionState(Wo.SUBSCRIBED):d===Di.CONNECTING?this.updateSubscriptionState(Wo.ATTEMPTING_SUBSCRIBE):d===Di.ERRORED?(this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams(),this.updateSubscriptionState(Wo.ERRORED)):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:d})},this.onSubscriptionStreamRemoved=()=>{this.logger.debug({msg:"onSubscriptionStreamRemoved"}),this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams()},this.onSubscriptionStreamCreated=(d,b)=>{this.logger.debug({msg:"onSubscriptionStreamCreated",stream:d}),this.pruneInactiveStreams();let O=d.getTracks().map((F=>{const ie=new bi({track:F,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:b,analyticsTracker:this.analyticsTracker,token:this.token,subscribeConfig:this.subscribeConfig});return this.streams.push(ie),ie}));this.subscription.getDesiredSubscribeType()===so.AUDIO_ONLY&&(O=O.filter((F=>F.streamType!==Gr.VIDEO))),this.emit(ar.MEDIA_STREAM_ADDED,O)},this.onSubscriptionError=d=>{this.emit(ar.ERROR,d)},this.onSubscriptionSeiMessageReceived=d=>{this.emit(ar.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,d)},this.onSubscriptionTransformError=d=>{this.emit(ar.ERROR,d)},this.onSubscriptionReassignmentStart=()=>{for(const d of this.streams)d.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const d of this.streams)d.resumeControls()},this.updateSubscribeStateIfNecessary=(d,b)=>{if(!this.info.capabilities.has(yl.SUBSCRIBE))return;b!==void 0&&(this.subscribeConfig=b,this.subscription.updateSubscribeConfig(b),this.streams.forEach((ie=>{ie.updateSubscribeConfig(b)})));const O=d!==so.NONE&&this.publishState===va.PUBLISHED,F=this.subscribeState!==Wo.NOT_SUBSCRIBED&&this.subscribeState!==Wo.ERRORED;if(O&&!F)this.subscription.updateDesiredSubscribeType(d),this.subscribe();else if(!O&&F)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(d);else if(this.subscribeState===Wo.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==d)try{d===so.AUDIO_ONLY?this.emit(ar.MEDIA_STREAM_REMOVED,this.filterStreamsByType(this.streams,Gr.VIDEO)):d===so.AUDIO_VIDEO&&this.emit(ar.MEDIA_STREAM_ADDED,this.filterStreamsByType(this.streams,Gr.VIDEO)),this.subscription.updateDesiredSubscribeType(d)}catch(ie){this.logger.error({err:ie,msg:"error updating subscribe type"})}},this.updatePublishState=d=>{const b=d&&this.publishState===va.PUBLISHED,O=!d&&this.publishState===va.NOT_PUBLISHED;return!b&&!O&&(this.info.isPublishing=d,this.publishState=d?va.PUBLISHED:va.NOT_PUBLISHED,!0)},this.updateStreamState=(d,b)=>{this.audioMuted!==d&&(this.audioMuted=d,this.info.audioMuted=d,this.updateStreamMuteState(Gr.AUDIO,d)),this.videoStopped!==b&&(this.videoStopped=b,this.info.videoStopped=b,this.updateStreamMuteState(Gr.VIDEO,b))},this.updateStreamMuteState=(d,b)=>{const O=this.filterStreamsByType(this.streams,d),F=O[O.length-1];if(!F){const ie=`state update received for ${this.info.id} for non-existent ${d} stream`;return this.logger.warn({msg:ie}),void this.traceRemoteParticipantMsg(ie)}F.setMuted(b),this.emit(ar.MEDIA_STREAM_MUTE_CHANGED,F)},this.cleanup=()=>{this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==Wo.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=Ee,this.token=P,this.subscribeConfig=ue,this.createSubscription=()=>{const d=new mr(C.id,P,H,X,Ee,te,ue);return d.on(Cl,this.onSubscriptionStateChange),d.on(Hs,this.onSubscriptionStreamCreated),d.on(Ml,this.onSubscriptionStreamRemoved),d.on(Vh,this.onSubscriptionError),d.on(Pc,this.onSubscriptionSeiMessageReceived),d.on(fs,this.onSubscriptionTransformError),d.on(dc,this.onSubscriptionReassignmentStart),d.on(Gh,this.onSubscriptionReassignmentDone),d.on(Xl,this.onSubscriptionReassignmentDone),d},this.subscription=this.createSubscription(),w&&(this.publishState=va.PUBLISHED)}updateSubscriptionState(C){C!==this.subscribeState&&(this.subscribeState=C,this.emit(ar.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}pruneInactiveStreams(){const C=[];this.streams=this.streams.filter((te=>!!vr(te.mediaStreamTrack)||(C.push(te),!1)));const P=C.length;if(P===0)return;const H=this.filterStreamsByType(C,Gr.AUDIO).length,X=P-H;this.traceRemoteParticipantMsg(`Pruning inactive streams (${H} audio, ${X} video)`),this.emitStreamsRemoved(C),C.forEach((te=>{te.remote.cleanup(),te.cleanup()}))}filterStreamsByType(C,P){return C.filter((H=>H.streamType===P))}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(Wo.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===Wo.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(Cl,this.onSubscriptionStateChange),this.subscription.off(Hs,this.onSubscriptionStreamCreated),this.subscription.off(Ml,this.onSubscriptionStreamRemoved),this.subscription.off(Vh,this.onSubscriptionError),this.subscription.off(fs,this.onSubscriptionTransformError);const C=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),this.emitStreamsRemovedByType(C),this.updateSubscriptionState(Wo.NOT_SUBSCRIBED),this.cleanupStreams()}emitStreamsRemovedByType(C){switch(C){case so.AUDIO_VIDEO:this.emitStreamsRemoved(this.streams);break;case so.AUDIO_ONLY:this.emitStreamsRemoved(this.filterStreamsByType(this.streams,Gr.AUDIO));case so.NONE:}}emitStreamsRemoved(C){this.emit(ar.MEDIA_STREAM_REMOVED,C)}cleanupStreams(){this.streams.length!==0&&(this.logger.debug({msg:"Cleaning up streams due to internal removal"}),this.streams.forEach((C=>{C.remote.cleanup(),C.cleanup()})),this.streams=[])}traceRemoteParticipantMsg(C){this.analyticsTracker.trackEventNoSharedProps(new Co(this.token,Ks(),C,Fn.SUBSCRIBE,this.info.id))}triggerIceRestart(C){return ud(this,void 0,void 0,(function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(C)}finally{this.reassigning=!1}}))}}const vg=Fn.PUBLISH;function No(j,C,P){return new Fr(Object.assign(Object.assign({},j),{token:C,traceId:P,location:"stage-publication.sendSeiMessage",tag:hc,action:Fn.PUBLISH}))}class ps{constructor(C,P){this.analyticsTracker=C,this.token=P,this.action=vg,this.traceId=Ks()}trackPublish(C){const{action:P,traceId:H,analyticsTracker:X,token:te}=this;return X.trackEvent(new o0({token:te,traceId:H})),{getTraceId:()=>H,trackPublishStarted({totalDurationWithRetries:ue,retryTimes:Ee,sfuResource:w,peerClientPerfStats:d,protocol:b}){const{optionsDuration:O,postDuration:F,timeToCandidate:ie,timeToConnected:pe,sdpExchangeDuration:ye,sdpExchangeTransport:Re,setRemoteDescDuration:Pe,peerConnectionDuration:Fe}=d,{edpInitialConnectDuration:Ye,edpInitialConnectRetries:dt,edpInitialStateDuration:xt,edpStateUpdateCount:Dt}=C;X.trackEvent(new c0({token:te,traceId:H,optionsDuration:O,postDuration:F,timeToCandidate:ie,totalDuration:pe,edpInitialConnectDuration:Ye,edpInitialConnectRetries:dt,edpInitialStateDuration:xt,edpStateUpdateCount:Dt,sdpExchangeDuration:ye,sdpExchangeTransport:Re,setRemoteDescDuration:Pe,peerConnectionDuration:Fe,publishRetries:Ee,totalDurationWithRetries:ue,sfuResource:w,protocol:b}))},trackPublishFailed(ue,Ee){const w=((b,O,F)=>{if(b instanceof Fr)return b;let ie="";return b instanceof Ho.AxiosError&&(ie+=`AxiosError - ${b.code}`),new Fr(Object.assign(Object.assign(Object.assign({},hn.PUBLISH_FAILURE),{action:vg,token:O,traceId:F,tag:hc,location:"publish",details:`${ie} ${b.message}`}),{fatal:!0}))})(ue,te,H);X.trackEvent(new u0({token:te,traceId:H,code:w.code,message:w.message,fatal:w.fatal,nominal:w.nominal,protocol:Ee}));const d=new Fr(Object.assign(Object.assign({},hn.PUBLISH_FAILURE),{action:P,token:te,traceId:H,tag:hc,location:"publish"}));return ue instanceof Fr&&(d.fatal=ue.fatal,d.nominal=ue.nominal,d.location=`publish > ${ue.location}`),X.trackError(d),w},trackUnpublish:()=>{X.trackEvent(new l0({token:te,traceId:H}))},trackEndSucceeded:(ue,Ee)=>{X.trackEvent(new i_({token:te,isUnpublishSuccessful:!0,traceId:H,reason:ue,protocol:Ee}))},trackEndFailed:(ue,Ee)=>{const w=new Fr(Object.assign(Object.assign({},hn.UNPUBLISH_FAILURE),{token:te,traceId:H,tag:eo,location:"unpublish"}));return ue!==Ti.UNLOAD&&ue!==Ti.UNPUBLISH||this.analyticsTracker.trackError(w),X.trackEvent(new i_({token:te,isUnpublishSuccessful:!1,traceId:H,reason:ue,protocol:Ee})),w},createSeiNotPublishingVideoError:()=>No(hn.SEI_INSERT_NOT_PUBLISHING_VIDEO,te,H),createSeiInBandMessagingNotEnabledError:()=>No(hn.SEI_INSERT_INBAND_NOT_ENABLED,te,H)}}}var Qs,nc,ks=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Qs||(Qs={})),(function(j){j.STATE_CHANGE="stateChange",j.ERROR="error",j.TRANSFORM_ERROR="transformError"})(nc||(nc={}));class ff extends uc{constructor(C,P,H,X){super(),this.token=C,this.stageConnection=P,this.nonScopedLogger=H,this.analyticsTracker=X,this.streamsToPublish=[],this.publicationState=Qs.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=Fn.PUBLISH,this.start=te=>{this.publicationState===Qs.DISCONNECTED||this.publicationState===Qs.ERRORED?(this.streamsToPublish=te,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=te=>ks(this,void 0,void 0,(function*(){return this.peerClient.requestRTCStats(te)})),this.stop=(te=!1)=>ks(this,void 0,void 0,(function*(){this.peerClient.off(Eo,this.onPeerClientConnectionStateChange),this.peerClient.off(lh,this.onPeerClientTransformError),yield this.unpublish(te),this.updateState(Qs.DISCONNECTED)})),this.processStateUpdate=te=>{const{publicationState:ue}=this;ue===Qs.DISCONNECTED||ue===Qs.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Qs.CONNECTING),this.tryPublish()):ue===Qs.CONNECTING?te===sr.CONNECTED&&this.updateState(Qs.CONNECTED):ue===Qs.CONNECTED&&te===sr.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ti.CONNECTION_FAIL,this.peerClient.getProtocol()),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Qs.CONNECTING),this.tryPublish()))},this.updateState=te=>{this.publicationState=te,this.emit(nc.STATE_CHANGE,te)},this.tryPublish=()=>ks(this,void 0,void 0,(function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const te=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(te);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.streamsToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const ue=this.peerClient.getSfuResource(),Ee=this.latestPubAttemptNum-1,w=performance.now()-this.startConnectingTimestamp,d=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:ue,totalDurationWithRetries:w,retryTimes:Ee,peerClientPerfStats:d,protocol:this.peerClient.getProtocol()}),this.latestPubAttemptNum=0}catch(ue){this.logger.error({msg:"publish failed!",err:ue});const Ee=this.attemptTracker.trackPublishFailed(ue,this.peerClient.getProtocol()),w=Ee.code===hn.OPERATION_ABORTED.code,d=Ee.fatal,b=this.latestPubAttemptNum===4;if(w)return;if(d||b)return this.logger.error({msg:`Stopping attempts: isFatal=${d}, isLastAttempt=${b}`,err:ue}),this.updateState(Qs.ERRORED),void this.emit(nc.ERROR,Ee);const O=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${O}ms`}),this.nextAttemptTimerId=window.setTimeout((()=>{this.tryPublish()}),O)}}})),this.publish=(te,ue)=>ks(this,void 0,void 0,(function*(){this.peerClient.initStreamsToPublish(te),yield this.peerClient.connect({audioOnly:!1,traceId:ue})})),this.unpublish=(te=!1)=>ks(this,void 0,void 0,(function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===Qs.DISCONNECTED||this.publicationState===Qs.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const ue=te?Ti.UNLOAD:Ti.UNPUBLISH,Ee=this.peerClient.getProtocol();try{te?this.peerClient.disconnect(te):yield this.peerClient.disconnect(te),this.attemptTracker.trackEndSucceeded(ue,Ee)}catch{this.attemptTracker.trackEndFailed(ue,Ee)}})),this.replaceOrUpdateStream=te=>ks(this,void 0,void 0,(function*(){this.streamsToPublish.find((ue=>ue.track.kind===te.track.kind))?this.streamsToPublish=this.streamsToPublish.map((ue=>ue.track.kind===te.track.kind?te:ue)):this.streamsToPublish.push(te),yield this.peerClient.replaceOrUpdateStream(te)})),this.onPeerClientConnectionStateChange=te=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${te}`,state:te}),this.processStateUpdate(te)},this.onPeerClientTransformError=te=>{this.emit(nc.TRANSFORM_ERROR,te)},this.onIncompatibleCodecs=te=>ks(this,void 0,void 0,(function*(){yield this.peerClient.onIncompatibleCodecs(te)})),this.sendSeiMessage=(te,ue)=>{if(this.publicationState!==Qs.CONNECTED)return this.attemptTracker&&this.emit(nc.ERROR,this.attemptTracker.createSeiNotPublishingVideoError()),Jn.err(aa.NOT_PUBLISHING_VIDEO);const Ee=this.peerClient.sendSeiMessage(te,ue),w=Jn.getErr(Ee);return w&&this.attemptTracker&&(w===aa.INBAND_MESSAGING_NOT_ENABLED?this.emit(nc.ERROR,this.attemptTracker.createSeiInBandMessagingNotEnabledError()):w===aa.NOT_PUBLISHING_VIDEO&&this.emit(nc.ERROR,this.attemptTracker.createSeiNotPublishingVideoError())),Ee},this.peerClient=new bs(C,this.nonScopedLogger,this.action,kn(this.action),Ks(),this.analyticsTracker,void 0,P,void 0),this.logger=new wn(H,_e.PUBLICATION),this.peerClient.on(Eo,this.onPeerClientConnectionStateChange),this.peerClient.on(lh,this.onPeerClientTransformError),this.publishTracker=new ps(this.analyticsTracker,this.token)}removeTrack(C){return ks(this,void 0,void 0,(function*(){this.streamsToPublish=this.streamsToPublish.filter((P=>P.track.kind!==C)),yield this.peerClient.removeTrack(C)}))}}var hi,lu=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class Sh extends au{constructor(C,P,H,X,te){super(C,new wn(H,_e.LOCAL_PARTICIPANT)),this.onPublicationStateChange=ue=>{switch(this.logger.debug({msg:"publicationStateChange",state:ue}),ue){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(va.PUBLISHED);break;case"connecting":this.updatePublishState(va.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(va.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:ue})}},this.onPublicationError=ue=>{this.emit(Yo.ERROR,ue)},this.updatePublishState=ue=>{this.info.isPublishing=ue===va.PUBLISHED,this.publishState=ue,this.emit(Yo.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=ue=>{ue.streamType===Gr.AUDIO&&(this.audioMuted=ue.isMuted,this.info.audioMuted=ue.isMuted),ue.streamType===Gr.VIDEO&&(this.videoStopped=ue.isMuted,this.info.videoStopped=ue.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit(Yo.MEDIA_STREAM_MUTE_CHANGED,ue)},this.handleInsertSeiMsgRequest=(ue,Ee,w)=>{this.sendSeiMessage(Ee,w?.repeatCount)},this.publish=ue=>{this.logger.debug({msg:"publish"}),ue.forEach((w=>{w&&(this.setupStreamListeners(w),w.streamType===Gr.AUDIO?(this.audioStream=w,this.audioMuted=!w.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):w.streamType===Gr.VIDEO&&(this.videoStream=w,this.videoStopped=!w.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),w.setGetStats(this.publication.requestRTCStats))})),this.connection.emitStageState(this.audioMuted,this.videoStopped);const Ee=ue.map((w=>cm(w)));this.publication.start(Ee)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==va.NOT_PUBLISHED&&this.publishState!==va.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=ue=>lu(this,void 0,void 0,(function*(){yield this.publication.onIncompatibleCodecs(ue)})),this.sendSeiMessage=(ue,Ee=0)=>this.publication.sendSeiMessage(ue,Ee),this.sendSeiMessageString=(ue,Ee=0)=>{const w=new TextEncoder().encode(ue);return this.publication.sendSeiMessage(w,Ee)},this.connection=X,this.createPublication=()=>{const ue=new ff(P,X,H,te);return ue.on(nc.STATE_CHANGE,this.onPublicationStateChange),ue.on(nc.ERROR,this.onPublicationError),ue.on(nc.TRANSFORM_ERROR,this.onPublicationError),ue},this.publication=this.createPublication()}setupStreamListeners(C){C.on(Jr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),C.streamType===Gr.VIDEO&&C.on(Jr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleInsertSeiMsgRequest)}removeTrack(C){var P,H,X;C.streamType===Gr.AUDIO?((P=this.audioStream)===null||P===void 0||P.off(Jr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):C.streamType===Gr.VIDEO&&((H=this.videoStream)===null||H===void 0||H.off(Jr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),(X=this.videoStream)===null||X===void 0||X.off(Jr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(C.streamType)}replaceOrAddTrack(C){return lu(this,void 0,void 0,(function*(){this.setupStreamListeners(C),C.setGetStats(this.publication.requestRTCStats),C.streamType===Gr.AUDIO?(this.audioStream=C,this.audioMuted=!C.mediaStreamTrack.enabled):C.streamType===Gr.VIDEO&&(this.videoStream=C,this.videoStopped=!C.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const P=cm(C);yield this.publication.replaceOrUpdateStream(P)}))}unpublish(){if(this.publishState===va.NOT_PUBLISHED||this.publishState===va.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(nc.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(nc.ERROR,this.onPublicationError),this.publication.off(nc.TRANSFORM_ERROR,this.onPublicationError);const C=[this.audioStream,this.videoStream].filter((P=>!!P));C.forEach((P=>{P.cleanup()})),this.audioStream=void 0,this.videoStream=void 0,this.emit(Yo.MEDIA_STREAM_REMOVED,C),this.updatePublishState(va.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(j){j.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",j.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",j.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",j.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",j.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",j.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",j.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",j.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",j.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",j.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",j.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",j.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",j.ERROR="error",j.STAGE_LEFT="stageLeft"})(hi||(hi={}));var fd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(d){try{w(H.next(d))}catch(b){te(b)}}function Ee(d){try{w(H.throw(d))}catch(b){te(b)}}function w(d){var b;d.done?X(d.value):(b=d.value,b instanceof P?b:new P((function(O){O(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const hm=j=>!!j;class ya extends uc{constructor(C,P){super(),this.connectionState=Ms.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(X,te)=>{var ue,Ee;if(this.connectionState=X,X===Ms.ERRORED&&(this.connectionStateErrored=!0),X===Ms.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==va.NOT_PUBLISHED&&this.stageConnection.emitStageState((ue=this.localParticipant)===null||ue===void 0?void 0:ue.audioMuted,(Ee=this.localParticipant)===null||Ee===void 0?void 0:Ee.videoStopped),X===Ms.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),X===Ms.DISCONNECTED){if(te&&te!==tc.CLIENT_RECONNECT&&te!==tc.USER_INITIATED){let w=jf.UNKNOWN;(function(d){return Object.values(jf).includes(d)})(te)?w=te:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${te}`}),this.cleanup(w)}}else this.emit(hi.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var X;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new Co(this.token,(X=this.joinTraceId)!==null&&X!==void 0?X:new Qg,"reusing local participant from repeat join",Fn.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const X=(function(te){var ue,Ee;const w=new Set;return te.token.claims.capabilities.allow_publish&&w.add(yl.PUBLISH),te.token.claims.capabilities.allow_subscribe&&w.add(yl.SUBSCRIBE),{id:te.token.participantID,userId:(ue=te.token.userID)!==null&&ue!==void 0?ue:"",attributes:(Ee=te.token.claims.attributes)!==null&&Ee!==void 0?Ee:{},capabilities:w,isLocal:!0,userInfo:{},videoStopped:te.videoStopped,audioMuted:te.audioMuted,isPublishing:te.isPublishing}})({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new Sh(X,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on(Yo.PUBLICATION_STATE_CHANGE,(te=>{this.onPublishStateChanged(this.localParticipant.info,te)})),this.localParticipant.on(Yo.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on(Yo.MEDIA_STREAM_MUTE_CHANGED,(te=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,te):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})})),this.localParticipant.on(Yo.ERROR,(te=>{this.errorManager.handleError(te,fr.PUBLISH_ERROR)})),this.emit(hi.STAGE_PARTICIPANT_JOINED,X)},this.onRemoteParticipantJoined=X=>{if(X.id!==this.token.participantID){const te=(function(d){return{id:d.id,userId:d.userId,attributes:d.attributes,capabilities:new Set([yl.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:d.videoStopped,audioMuted:d.audioMuted,isPublishing:d.isPublishing}})(X);if(this.participants.has(te.id))return void this.logger.warn({msg:"Remote participant already tracked"});let ue=so.NONE;te.capabilities.has(yl.SUBSCRIBE)&&(ue=Jn.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(te),ue),this.updateManagerWithExternalSubscribeConfig(te,"joined"));const Ee=this.configManager.getSubscribeConfigSnapshot(te.id),w=new bh(te,this.token,this.stageConnection,this.logger.unwrap(),ue,Ee,this.analyticsTracker,X.isPublishing);this.participants.set(te.id,w),this.setupRemoteParticipantListeners(w),this.emit(hi.STAGE_PARTICIPANT_JOINED,w.info),w.updateSubscribeStateIfNecessary(ue)}},this.setupRemoteParticipantListeners=X=>{X.on(ar.SUBSCRIPTION_STATE_CHANGE,(te=>{this.onParticipantSubscribeStateChanged(X.info.id,te)})),X.on(ar.MEDIA_STREAM_ADDED,(te=>{const ue=this.participants.get(X.info.id);if(ue){for(const Ee of te)this.setupRemoteParticipantStreamEvents(ue.info,Ee);this.emit(hi.STAGE_PARTICIPANT_STREAMS_ADDED,ue.info,yh(te)),this.updateStreamLayerForParticipantInfo(X.info,X.streams)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})})),X.on(ar.MEDIA_STREAM_REMOVED,(te=>{const ue=this.participants.get(X.info.id);ue?this.emit(hi.STAGE_PARTICIPANT_STREAMS_REMOVED,ue.info,yh(te)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})})),X.on(ar.MEDIA_STREAM_MUTE_CHANGED,(te=>{this.onStreamMuteChange(X.info,te.remote)})),X.on(ar.ERROR,(te=>{this.errorManager.handleError(te,fr.SUBSCRIBE_ERROR)})),X.on(ar.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,(te=>{this.onSeiMessageReceived(X.info,te)}))},this.onRemoteParticipantLeft=X=>{if(this.connectionState!==Ms.CONNECTED)return;const te=this.participants.get(X);te?(te.participantLeave(),te.unsubscribe(),te.cleanup(),this.participants.delete(X),this.emitParticipantLeave(te.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=X=>{this.emit(hi.STAGE_PARTICIPANT_LEFT,X)},this.onRemoteParticipantStateChanged=X=>{const te=this.participants.get(X.id);if(!te)return void this.logger.warn({msg:"Remote participant updated but not tracked"});te.updatePublishState(X.isPublishing)&&this.onPublishStateChanged(te.info,te.publishState),te.updateStreamState(X.audioMuted,X.videoStopped);const ue=this.strategyWrapper.shouldSubscribeToParticipant(te.info);if(Jn.isNotOk(ue))return;this.updateManagerWithExternalSubscribeConfig(te.info,"updated");const Ee=this.configManager.getSubscribeConfigSnapshot(te.info.id),w=Jn.getOk_or(ue,so.NONE);te.updateSubscribeStateIfNecessary(w,Ee)},this.onPublishStateChanged=(X,te)=>{this.emit(hi.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,X,te)},this.onParticipantSubscribeStateChanged=(X,te)=>{const ue=this.participants.get(X);ue?this.emit(hi.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,ue.info,te):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=X=>{this.localParticipant&&this.emit(hi.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,X)},this.onLocalStreamsRemoved=X=>{this.localParticipant&&this.emit(hi.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,X)},this.onStreamMuteChange=(X,te)=>{this.emit(hi.STAGE_STREAM_MUTE_CHANGED,X,te)},this.onSeiMessageReceived=(X,te)=>{this.emit(hi.STAGE_STREAM_SEI_MESSAGE_RECEIVED,X,te)},this.leave=()=>{this.cleanup(jf.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var X;this.participants.forEach((te=>{te.quickUnsubscribe()})),(X=this.localParticipant)===null||X===void 0||X.quickUnpublish(),this.stageConnection.disconnect(),this.emit(hi.STAGE_CONNECTION_STATE_CHANGED,Ms.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=X=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new Ju({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:X})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const te=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(te);const ue=this.participants.entries();for(const[Ee,w]of ue)w.unsubscribe(),this.participants.delete(Ee),w.cleanup(),this.emitParticipantLeave(w.info);gl.destroy(this.analyticsTracker.getSessionId()),this.stageConnection.disconnect(),this.emit(hi.STAGE_CONNECTION_STATE_CHANGED,Ms.DISCONNECTED),this.emit(hi.STAGE_LEFT,X),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach((X=>{if(X.info.capabilities.has(yl.SUBSCRIBE)){const te=this.strategyWrapper.shouldSubscribeToParticipant(X.info);if(Jn.isNotOk(te))return;const ue=Jn.getOk_or(te,so.NONE);this.updateManagerWithExternalSubscribeConfig(X.info,"updated");const Ee=this.configManager.getSubscribeConfigSnapshot(X.info.id);X.updateSubscribeStateIfNecessary(ue,Ee),this.updateStreamLayerForParticipantInfo(X.info,X.streams)}})),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var X;if(!this.localParticipant||!(!((X=this.localParticipant)===null||X===void 0)&&X.info.capabilities.has(yl.PUBLISH)))return;const te=this.localParticipant.publishState!==va.NOT_PUBLISHED&&this.localParticipant.publishState!==va.ERRORED,ue=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(Jn.isNotOk(ue))return;let Ee=Jn.getOk_or(ue,!1);if(!te&&!Ee)return;if(te&&!Ee)return void this.localParticipant.unpublish();const w=this.strategyWrapper.stageStreamsToPublish();if(Jn.isNotOk(w)){const b=Jn.getErr(w);if(b instanceof Error&&b.cause==="UserStrategy")throw b;return}const d=Jn.getOk_or(w,[]);Ee=Ee&&d.length>0,!te&&Ee?(this.localParticipant.publish(d),this.onLocalStreamsAdded(d)):this.syncTracksToPublish(d)},this.syncTracksToPublish=X=>{var te;if(!this.localParticipant)return;const ue=this.localParticipant.audioStream,Ee=this.localParticipant.videoStream,{updates:w,streamsToAdd:d,streamsToRemove:b}=this.determineStreamUpdates(ue,Ee,X);if(w.length){for(const O of w)O.newStream?(te=this.localParticipant)===null||te===void 0||te.replaceOrAddTrack(O.newStream):O.oldStream&&this.localParticipant.removeTrack(O.oldStream);b.length!==0&&this.onLocalStreamsRemoved(b),d.length!==0&&this.onLocalStreamsAdded(d)}},this.determineStreamUpdates=(X,te,ue=[])=>{const Ee=[],w=ue.slice(0,2);if(w.sort(((O,F)=>O.streamType===Gr.AUDIO?-1:1)),w.length===0)X&&Ee.push({oldStream:X}),te&&Ee.push({oldStream:te});else if(w.length===1){const O=w[0];O.streamType===Gr.AUDIO?te&&Ee.push({oldStream:te}):O.streamType===Gr.VIDEO&&X&&Ee.push({oldStream:X})}w.forEach((O=>{var F,ie;O.streamType===Gr.AUDIO?X?X.id===O.id&&(0,js.isEqual)(X.mediaConfig,O.mediaConfig)||(!!(!((F=X.mediaConfig)===null||F===void 0)&&F.stereo)!=!!(!((ie=O.mediaConfig)===null||ie===void 0)&&ie.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),Ee.push({oldStream:X,newStream:O})):Ee.push({newStream:O}):O.streamType===Gr.VIDEO&&(te?te.id===O.id&&(0,js.isEqual)(te.mediaConfig,O.mediaConfig)||Ee.push({oldStream:te,newStream:O}):Ee.push({newStream:O}))}));const d=Ee.map((O=>O.newStream)).filter(hm),b=Ee.map((O=>O.oldStream)).filter(hm);return{updates:Ee,streamsToAdd:d,streamsToRemove:b}},this.onReassignmentMessage=X=>fd(this,void 0,void 0,(function*(){if(ma("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!gp.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const te=Ks();this.trackReassignmentRequest(X,te);const ue=this.participants.get(X.remoteParticipantId),Ee=this.token.participantID,w=(function(d,{localParticipantId:b,remoteParticipant:O}){const{participantId:F}=d;if(b!==F)return Jn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${F}`}));if(!O)return Jn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${O}`}));if(O.isReassigning())return Jn.err(hn.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const ie=O.subscription.peerClient.getConnectionState();return[sr.CONNECTED,sr.DISCONNECTED].includes(ie)?Jn.ok(O):Jn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${ie}`}))})(X,{localParticipantId:Ee,remoteParticipant:ue});if(!w.ok)this.trackReassignmentRequestRejected(w.error,te);else try{const{token:d,nodeOverride:b}=X;yield w.value.triggerIceRestart({assignmentToken:d,traceId:te,nodeOverride:b})}catch(d){this.logger.error({msg:"Reassignment failed.",err:d})}})),this.onIncompatibleCodecsMessage=X=>fd(this,void 0,void 0,(function*(){var te;yield(te=this.localParticipant)===null||te===void 0?void 0:te.onIncompatibleCodecs(X.codecs)})),this.analyticsTracker=new sh;const H=op();this.logger=new wn(new tn(H),_e.STAGE),this.strategyWrapper=new su(P,this.logger),this.configManager=new ca({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:ll.DEFAULT,minDelayWhenSubscribeOnly:ll.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:mh.LOWEST_QUALITY,layerPollingEnabled:!0,layerPollingIntervalMs:3e3}}}),this.errorManager=new Sp(this.logger.unwrap());try{this.token=Cd(C,this.analyticsTracker)}catch(X){const te=new Fr(Object.assign({action:Fn.JOIN,token:C,traceId:Ks(),tag:ve,location:"Stage.constructor"},hn.MALFORMED_TOKEN));throw X instanceof Error&&(te.details=X.message),this.errorManager.handleError(te,fr.JOIN_ERROR)||X}this.stageConnection=new _h(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(hp,((C,P)=>{this.onConnectionStateChanged(C,P)})),this.stageConnection.on(kf,(C=>{this.onRemoteParticipantJoined(C)})),this.stageConnection.on(If,(C=>{this.onRemoteParticipantLeft(C.id)})),this.stageConnection.on(wo,(C=>{var P;C.id!==((P=this.localParticipant)===null||P===void 0?void 0:P.info.id)&&this.onRemoteParticipantStateChanged(C)})),this.stageConnection.on(Na,(C=>fd(this,void 0,void 0,(function*(){yield this.onReassignmentMessage(C)})))),this.stageConnection.on(dh,(C=>fd(this,void 0,void 0,(function*(){yield this.onIncompatibleCodecsMessage(C)})))),this.stageConnection.on(Ro,(C=>{C instanceof Fr&&this.analyticsTracker.trackError(C),this.errorManager.handleError(C,fr.JOIN_ERROR)})),this.errorManager.on(iu.ERROR,(C=>{this.emit(hi.ERROR,C)}))}setupRemoteParticipantStreamEvents(C,P){const H=P.remote;P.on(vl.ADAPTION_CHANGED,(X=>{this.emit(hi.STAGE_STREAM_ADAPTION_CHANGED,C,H,X)})),P.on(vl.LAYERS_CHANGED,(X=>{this.emit(hi.STAGE_STREAM_LAYERS_CHANGED,C,H,X),this.updateStreamLayerForParticipantInfo(C,[P])})),P.on(vl.LAYER_SELECTED,((X,te)=>{this.emit(hi.STAGE_STREAM_LAYER_SELECTED,C,H,X,te)})),P.layers.length>0&&(this.emit(hi.STAGE_STREAM_LAYERS_CHANGED,C,H,H.getLayers()),this.emit(hi.STAGE_STREAM_LAYER_SELECTED,C,H,H.getSelectedLayer(),Ji.SELECTED))}join(){return fd(this,void 0,void 0,(function*(){this.analyticsTracker.start(),this.joinTraceId=Ks(),this.analyticsTracker.trackEvent(new sd({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(Ks(),ve,"join")}catch(C){throw this.errorManager.handleError(C,fr.JOIN_ERROR)||C}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===Ms.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(C){throw this.logger.error({err:C,msg:"error joining stage"}),this.errorManager.handleError(C,fr.JOIN_ERROR,!1)||C}}))}replaceStrategy(C){this.strategyWrapper.setStrategy(C),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(C,P){var H;const X=Jn.getOk(this.strategyWrapper.subscribeConfiguration(C)),te=Jn.getOk(this.getRemoteSubscribeConfiguration()),ue=this.getInternalSubscribeOverrides(),Ee=C.id;let w=!1;X&&(w=this.configManager.handleExternalSubscribeConfigUpdate(Ee,X,ko.API));let d=!1;te&&(d=this.configManager.handleSubscribeConfigUpdate(Ee,te,ko.REMOTE));let b=!1;if(ue&&(b=this.configManager.handleSubscribeConfigUpdate(Ee,ue,ko.INTERNAL)),w||d||b){const O=this.configManager.getSubscribeConfigSnapshot(Ee);this.analyticsTracker.trackEventNoSharedProps(new Pu(this.token,(H=this.joinTraceId)!==null&&H!==void 0?H:Ks(),P==="joined"?"initial":"ad-hoc",Ee,O))}}getRemoteSubscribeConfiguration(){return Jn.err("todo")}getInternalSubscribeOverrides(){const C=this.strategyWrapper.hasStrategy("preferredLayerForStream"),P=this.hasListenersFor(hi.STAGE_STREAM_LAYERS_CHANGED)||this.hasListenersFor(hi.STAGE_STREAM_ADAPTION_CHANGED)||this.hasListenersFor(hi.STAGE_STREAM_LAYER_SELECTED);return{simulcast:{layerPollingEnabled:C||P}}}updateStreamLayerForParticipantInfo(C,P){P.forEach((H=>{if(H.streamType==="audio")return;const X=this.strategyWrapper.preferredLayerForStream(C,H.remote),te=Jn.getOk_or(X,void 0);H.setLayer(te)}))}trackReassignmentRequestRejected(C,P){const{token:H}=this,X=new Fr(Object.assign(Object.assign({},C),{token:H,action:Fn.JOIN,traceId:P,tag:Mi,location:"publish"}));this.logger.error({err:X,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(X)}trackReassignmentRequest(C,P){const{token:H}=this;this.analyticsTracker.trackEvent(new Ep({token:H,traceId:P,targetLocalParticipantId:C.participantId,targetRemoteParticipantId:C.remoteParticipantId}))}}var jf;(function(j){j.UNKNOWN="unknown",j.USER_INITIATED="user-initiated",j.TOKEN_REUSED="token-reused",j.PARTICIPANT_DISCONNECTED="participant-disconnected",j.STAGE_DELETED="stage-deleted"})(jf||(jf={}));const Uu=f})(),s})()))})(g7)),g7.exports}var _yt=gyt();const US=Bh(_yt),hSe="0123456789abcdefABCDEF";hSe.split("").map(n=>n.codePointAt(0));Array(256).fill(!0).map((n,e)=>{const t=String.fromCodePoint(e),r=hSe.indexOf(t);return r<0?void 0:r<16?r:r-6});new TextEncoder;new TextDecoder;function uT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;++r)if(n[r]!==e[r])return n[r]<e[r]?-1:1;return n.length===e.length?0:n.length>e.length?1:-1}var vyt=(n,e,t=Math.min(n.byteLength,e.byteLength))=>{for(let r=0;r<t;r++){const i=n[r],s=e[r];if(i!==s)return 8*t-(r*8+Math.clz32(i^s)-24)}return 0},yae=class{constructor(n,e){this.id=n,this.bucketSize=e.bucketSize||20,this.buckets=new Array(n.length*8+1).fill(void 0).map(()=>[]),this.compare=e.compare||(()=>0),this.getId=e.getId}get length(){return this.buckets.reduce((n,e)=>n+e.length,0)}*[Symbol.iterator](){for(const n of this.buckets)for(const e of n)yield e}add(n,e=this.getBitwiseDistance(this.getId(n))){if(this.has(this.getId(n),e))return!1;if(this.buckets[e].length<this.bucketSize)return this.buckets[e].push(n),!0;const t=this.buckets[e].slice(0);t.push(n);const r=t.sort(this.compare);this.buckets[e]=r.slice(0,this.bucketSize);const i=r.at(-1);return uT(this.getId(n),this.getId(i))!==0}clear(){for(let n=0;n<this.buckets.length;n++)this.buckets[n]=[]}*iterateClosestToId(n){return this.iterateNodes(n)}listClosestToId(n,e=this.buckets.length*this.bucketSize){return this.getNodes(n,void 0,e)}get(n){const e=this.buckets[n].shift();return e&&this.buckets[n].push(e),e}getById(n,e=this.getBitwiseDistance(n)){const t=this.buckets[e].findIndex(i=>uT(this.getId(i),n)===0);if(t===-1)return;const r=this.buckets[e][t];return this.buckets[e].splice(t,1),this.buckets[e].push(r),r}getBitwiseDistance(n){return vyt(this.id,n)}getNodes(n,e=this.getBitwiseDistance(n),t=this.buckets.length*this.bucketSize){if(!t)return[];const r=[];for(const i of this.iterateNodes(n,e))if(r.push(i),r.length>=t)return r;return r}*iterateNodes(n,e=this.getBitwiseDistance(n)){const t=Math.max(e,this.buckets.length-1-e);let r=0,i=(r%2===0?1:-1)*Math.ceil(r/2);for(;Math.abs(i)<=t;){const s=e+i;if(0<=s&&s<this.buckets.length){const a=this.buckets[s];if(a){const o=a.map(l=>this.getId(l));for(const l of o){const c=this.getById(l,s);c&&(yield c)}}}r++,i=(r%2===0?1:-1)*Math.ceil(r/2)}}has(n,e=this.getBitwiseDistance(n)){return!!this.buckets[e].find(t=>uT(this.getId(t),n)===0)}peek(n){return this.buckets[n].at(0)}peekById(n,e=this.getBitwiseDistance(n)){return this.buckets[e].find(t=>uT(this.getId(t),n)===0)}update(n,e=this.getBitwiseDistance(this.getId(n))){const t=this.buckets[e].findIndex(r=>uT(this.getId(r),this.getId(n))===0);return t===-1?!1:(this.buckets[e][t]=n,!0)}remove(n,e=this.getBitwiseDistance(n)){const t=this.buckets[e].findIndex(r=>uT(this.getId(r),n)===0);return t===-1?!1:(this.buckets[e].splice(t,1),!0)}};class yyt{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return byt(e).buffer}}function byt(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n){const s=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);t.set(s,r),r+=i.byteLength}return t}function dSe(n){return new Syt(n).unpack()}function pSe(n){const e=new Eyt,t=e.pack(n);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class Syt{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let r=0,i="",s,a;for(;r<e;)s=t[r],s<160?(a=s,r++):(s^192)<32?(a=(s&31)<<6|t[r+1]&63,r+=2):(s^224)<16?(a=(s&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,r+=3):(a=(s&7)<<18|(t[r+1]&63)<<12|(t[r+2]&63)<<6|t[r+3]&63,r+=4),i+=String.fromCodePoint(a);return this.index+=e,i}unpack_array(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]=this.unpack();return t}unpack_map(e){const t={};for(let r=0;r<e;r++){const i=this.unpack();t[i]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,i=e&8388607|8388608;return(t===0?1:-1)*i*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,i=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(i-20)+t*2**(i-52);return(r===0?1:-1)*a}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class Eyt{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),r=t.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const r=i=>{if(i<t){const s=this.pack(e[i]);return s instanceof Promise?s.then(()=>r(i+1)):r(i+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),i=e/2**r-1,s=Math.floor(i*2**52),a=2**32,o=t<<31|r+1023<<20|s/a&1048575,l=s%a;this._bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(l)}pack_object(e){const t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const i=s=>{if(s<t.length){const a=t[s];if(e.hasOwnProperty(a)){this.pack(a);const o=this.pack(e[a]);if(o instanceof Promise)return o.then(()=>i(s+1))}return i(s+1)}};return i(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new yyt,this._textEncoder=new TextEncoder}}let mSe=!0,gSe=!0;function A2(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function xx(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(a,o){if(a!==e)return i.apply(this,arguments);const l=c=>{const u=t(c);u&&(o.handleEvent?o.handleEvent(u):o(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,l),i.apply(this,[a,l])};const s=r.removeEventListener;r.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const l=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function xyt(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(mSe=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function Tyt(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(gSe=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function _Se(){if(typeof window=="object"){if(mSe)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function JG(n,e){gSe&&console.warn(n+" is deprecated, please use "+e+" instead.")}function wyt(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(A2(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(A2(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(A2(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=A2(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function bae(n){return Object.prototype.toString.call(n)==="[object Object]"}function vSe(n){return bae(n)?Object.keys(n).reduce(function(e,t){const r=bae(n[t]),i=r?vSe(n[t]):n[t],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[t]:i})},{}):n}function Gz(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Gz(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{Gz(n,n.get(i),t)})}))}function Sae(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return n.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{n.forEach(o=>{o.type===r&&o.trackId===a.id&&Gz(n,o,i)})}),i}const Eae=_Se;function ySe(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const l={};return Object.keys(o).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof o[c]=="object"?o[c]:{ideal:o[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const f=function(h,g){return h?h+g.charAt(0).toUpperCase()+g.slice(1):g==="deviceId"?"sourceId":g};if(u.ideal!==void 0){l.optional=l.optional||[];let h={};typeof u.ideal=="number"?(h[f("min",c)]=u.ideal,l.optional.push(h),h={},h[f("max",c)]=u.ideal,l.optional.push(h)):(h[f("",c)]=u.ideal,l.optional.push(h))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[f("",c)]=u.exact):["min","max"].forEach(h=>{u[h]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[f(h,c)]=u[h])})}),o.advanced&&(l.optional=(l.optional||[]).concat(o.advanced)),l},i=function(o,l){if(e.version>=61)return l(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const c=function(u,f,h){f in u&&!(h in u)&&(u[h]=u[f],delete u[f])};o=JSON.parse(JSON.stringify(o)),c(o.audio,"autoGainControl","googAutoGainControl"),c(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=r(o.audio)}if(o&&typeof o.video=="object"){let c=o.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete o.video.facingMode;let f;if(c.exact==="environment"||c.ideal==="environment"?f=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(f=["front"]),f)return t.mediaDevices.enumerateDevices().then(h=>{h=h.filter(p=>p.kind==="videoinput");let g=h.find(p=>f.some(_=>p.label.toLowerCase().includes(_)));return!g&&h.length&&f.includes("back")&&(g=h[h.length-1]),g&&(o.video.deviceId=c.exact?{exact:g.deviceId}:{ideal:g.deviceId}),o.video=r(o.video),Eae("chrome: "+JSON.stringify(o)),l(o)})}o.video=r(o.video)}return Eae("chrome: "+JSON.stringify(o)),l(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,l,c){i(o,u=>{t.webkitGetUserMedia(u,l,f=>{c&&c(s(f))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return i(l,c=>o(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function bSe(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function SSe(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===i.track.id):s={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===i.id):s={track:i};const a=new Event("track");a.track=i,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else xx(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ESe(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(o,l){let c=i.apply(this,arguments);return c||(c=e(this,o),this._senders.push(c)),c};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const l=this._senders.indexOf(o);l!==-1&&this._senders.splice(l,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(l=>l.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function xSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(a=>a._pc=this),s});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>Sae(a,s.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(s=>s._pc=this),i}),xx(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>Sae(s,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,s,a;return this.getSenders().forEach(o=>{o.track===r&&(i?a=!0:i=o)}),this.getReceivers().forEach(o=>(o.track===r&&(s?a=!0:s=o),o.track===r)),a||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function TSe(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(l)===-1&&this._shimmedLocalStreams[o.id].push(l):this._shimmedLocalStreams[o.id]=[o,l],l};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(c=>{if(this.getSenders().find(f=>f.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();t.apply(this,arguments);const l=this.getSenders().filter(c=>o.indexOf(c)===-1);this._shimmedLocalStreams[a.id]=[a].concat(l)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const l=this._shimmedLocalStreams[o].indexOf(a);l!==-1&&this._shimmedLocalStreams[o].splice(l,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),i.apply(this,arguments)}}function wSe(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return TSe(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const u=t.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(f=>this._reverseStreams[f.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(f=>{if(this.getSenders().find(g=>g.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const f=new n.MediaStream(u.getTracks());this._streams[u.id]=f,this._reverseStreams[f.id]=u,u=f}r.apply(this,[u])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},n.RTCPeerConnection.prototype.addTrack=function(u,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(_=>_===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(_=>_.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[f.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const _=new n.MediaStream([u]);this._streams[f.id]=_,this._reverseStreams[_.id]=f,this.addStream(_)}return this.getSenders().find(_=>_.track===u)};function s(c,u){let f=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(h=>{const g=c._reverseStreams[h],p=c._streams[g.id];f=f.replace(new RegExp(p.id,"g"),g.id)}),new RTCSessionDescription({type:u.type,sdp:f})}function a(c,u){let f=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(h=>{const g=c._reverseStreams[h],p=c._streams[g.id];f=f.replace(new RegExp(g.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:f})}["createOffer","createAnswer"].forEach(function(c){const u=n.RTCPeerConnection.prototype[c],f={[c](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const _=s(this,p);h[0].apply(null,[_])},p=>{h[1]&&h[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};n.RTCPeerConnection.prototype[c]=f[c]});const o=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:s(this,c)}}),n.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(g=>{this._streams[g].getTracks().find(_=>u.track===_)&&(h=this._streams[g])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function $z(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function RSe(n,e){xx(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const xae=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:RSe,shimAddTrackRemoveTrack:wSe,shimAddTrackRemoveTrackWithNative:TSe,shimGetSendersWithDtmf:ESe,shimGetUserMedia:ySe,shimMediaStream:bSe,shimOnTrack:SSe,shimPeerConnection:$z,shimSenderReceiverGetStats:xSe},Symbol.toStringTag,{value:"Module"}));function ASe(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,s,a){JG("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(s,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,o,l){o in a&&!(l in a)&&(a[l]=a[o],delete a[o])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const o=a.apply(this,arguments);return i(o,"mozAutoGainControl","autoGainControl"),i(o,"mozNoiseSuppression","noiseSuppression"),o}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o,"autoGainControl","mozAutoGainControl"),i(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function Ryt(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function CSe(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Wz(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=n.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return r.apply(this,[s||null]).then(l=>{if(e.version<53&&!a)try{l.forEach(c=>{c.type=t[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,f)=>{l.set(f,Object.assign({},u,{type:t[u.type]||u.type}))})}return l}).then(a,o)}}function MSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function OSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),xx(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function kSe(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){JG("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function ISe(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function NSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function PSe(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function DSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function LSe(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Tae=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:NSe,shimCreateAnswer:LSe,shimCreateOffer:DSe,shimGetDisplayMedia:Ryt,shimGetParameters:PSe,shimGetUserMedia:ASe,shimOnTrack:CSe,shimPeerConnection:Wz,shimRTCDataChannel:ISe,shimReceiverGetStats:OSe,shimRemoveStream:kSe,shimSenderGetStats:MSe},Symbol.toStringTag,{value:"Module"}));function USe(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function BSe(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function FSe(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(c,u){const f=arguments.length>=2?arguments[2]:arguments[0],h=t.apply(this,[f]);return u?(h.then(c,u),Promise.resolve()):h},e.createAnswer=function(c,u){const f=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[f]);return u?(h.then(c,u),Promise.resolve()):h};let o=function(l,c,u){const f=i.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f};e.setLocalDescription=o,o=function(l,c,u){const f=s.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f},e.setRemoteDescription=o,o=function(l,c,u){const f=a.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f},e.addIceCandidate=o}function zSe(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(jSe(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function jSe(n){return n&&n.video!==void 0?Object.assign({},n,{video:vSe(n.video)}):n}function HSe(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let a=0;a<r.iceServers.length;a++){let o=r.iceServers[a];o.urls===void 0&&o.url?(JG("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(r.iceServers[a])}r.iceServers=s}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function qSe(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function VSe(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function GSe(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}const wae=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:GSe,shimCallbacksAPI:FSe,shimConstraints:jSe,shimCreateOfferLegacy:VSe,shimGetUserMedia:zSe,shimLocalStreamsAPI:USe,shimRTCIceServerUrls:HSe,shimRemoteStreamsAPI:BSe,shimTrackEventTransceiver:qSe},Symbol.toStringTag,{value:"Module"}));var _7={exports:{}},Rae;function Ayt(){return Rae||(Rae=1,(function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const s=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)i=s[a].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?s.push(a+"="+t.parameters[a]):s.push(a)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(i.attribute=t.substring(r+1,s),i.value=t.substring(s+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(t)[0].split(" ");r.profile=s[2];for(let o=3;o<s.length;o++){const l=s[o],c=e.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(c){const u=e.parseRtpMap(c),f=e.matchPrefix(t,"a=fmtp:"+l+" ");switch(u.parameters=f.length?e.parseFmtp(f[0]):{},u.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(o=>{r.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(o=>{a.forEach(l=>{o.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||o.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{i+=e.writeRtpMap(a),i+=e.writeFmtp(a),i+=e.writeRtcpFb(a)});let s=0;return r.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{i+=e.writeExtmap(a)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),s=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(t,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),l=o.length>0&&o[0].ssrc;let c;const u=e.matchPrefix(t,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let g={ssrc:l,codecPayloadType:parseInt(h.parameters.apt,10)};l&&c&&(g.rtx={ssrc:c}),r.push(g),s&&(g=JSON.parse(JSON.stringify(g)),g.fec={ssrc:l,mechanism:a?"red+ulpfec":"red"},r.push(g))}}),r.length===0&&l&&r.push({ssrc:l});let f=e.matchPrefix(t,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substring(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substring(5),10)*1e3*.95-2e3*8:f=void 0,r.forEach(h=>{h.maxBitrate=f})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const o=e.matchPrefix(t,"a=sctpmap:");if(o.length>0){const l=o[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let s;const a=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})(_7)),_7.exports}var $Se=Ayt();const WT=Bh($Se),Cyt=XEe({__proto__:null,default:WT},[$Se]);function GP(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=WT.parseCandidate(r.candidate);for(const a in s)a in i||Object.defineProperty(i,a,{value:s[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,xx(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Yz(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||xx(n,"icecandidate",e=>{if(e.candidate){const t=WT.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function $P(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(o){if(!o||!o.sdp)return!1;const l=WT.splitSections(o.sdp);return l.shift(),l.some(c=>{const u=WT.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(o){const l=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(o){let l=65536;return e.browser==="firefox"&&(e.version<57?o===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},s=function(o,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const u=WT.matchPrefix(o.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const l=r(arguments[0]),c=i(l),u=s(arguments[0],l);let f;c===0&&u===0?f=Number.POSITIVE_INFINITY:c===0||u===0?f=Math.max(c,u):f=Math.min(c,u);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return f}}),this._sctp=h}return a.apply(this,arguments)}}function WP(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const o=arguments[0],l=o.length||o.size||o.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},xx(n,"datachannel",r=>(e(r.channel,r.target),r))}function Xz(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",i);s.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Kz(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return t.apply(this,arguments)}}function YP(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function XP(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}const Myt=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:Kz,shimAddIceCandidateNullOrEmpty:YP,shimConnectionState:Xz,shimMaxMessageSize:$P,shimParameterlessSetLocalDescription:XP,shimRTCIceCandidate:GP,shimRTCIceCandidateRelayProtocol:Yz,shimSendThrowTypeError:WP},Symbol.toStringTag,{value:"Module"}));function Oyt({window:n}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=_Se,r=wyt(n),i={browserDetails:r,commonShim:Myt,extractVersion:A2,disableLog:xyt,disableWarnings:Tyt,sdp:Cyt};switch(r.browser){case"chrome":if(!xae||!$z||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=xae,YP(n,r),XP(n),ySe(n,r),bSe(n),$z(n,r),SSe(n),wSe(n,r),ESe(n),xSe(n),RSe(n,r),GP(n),Yz(n),Xz(n),$P(n,r),WP(n),Kz(n,r);break;case"firefox":if(!Tae||!Wz||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=Tae,YP(n,r),XP(n),ASe(n,r),Wz(n,r),CSe(n),kSe(n),MSe(n),OSe(n),ISe(n),NSe(n),PSe(n),DSe(n),LSe(n),GP(n),Xz(n),$P(n,r),WP(n);break;case"safari":if(!wae||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=wae,YP(n,r),XP(n),HSe(n),VSe(n),FSe(n),USe(n),BSe(n),qSe(n),zSe(n),GSe(n),GP(n),Yz(n),$P(n,r),WP(n),Kz(n,r);break;default:t("Unsupported browser!");break}return i}const Aae=Oyt({window:typeof window>"u"?void 0:window});function Tx(n,e,t,r){Object.defineProperty(n,e,{get:t,set:r,enumerable:!0,configurable:!0})}class WSe{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],r=e.byteLength,i=Math.ceil(r/this.chunkedMTU);let s=0,a=0;for(;a<r;){const o=Math.min(r,a+this.chunkedMTU),l=e.slice(a,o),c={__peerData:this._dataCount,n:s,data:l,total:i};t.push(c),a=o,s++}return this._dataCount++,t}}}function kyt(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n)t.set(i,r),r+=i.byteLength;return t}const v7=Aae.default||Aae,f2=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const n=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(n)?n==="chrome"?e>=this.minChromeVersion:n==="firefox"?e>=this.minFirefoxVersion:n==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return v7.browserDetails.browser}getVersion(){return v7.browserDetails.version||0}isUnifiedPlanSupported(){const n=this.getBrowser(),e=v7.browserDetails.version||0;if(n==="chrome"&&e<this.minChromeVersion)return!1;if(n==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,r=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),r=!0}catch{}finally{t&&t.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Iyt=n=>!n||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(n),YSe=()=>Math.random().toString(36).slice(2),Cae={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Nyt extends WSe{noop(){}blobToArrayBuffer(e,t){const r=new FileReader;return r.onload=function(i){i.target&&t(i.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Cae,this.browser=f2.getBrowser(),this.browserVersion=f2.getVersion(),this.pack=pSe,this.unpack=dSe,this.supports=(function(){const t={browser:f2.isBrowserSupported(),webRTC:f2.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let r;try{r=new RTCPeerConnection(Cae),t.audioVideo=!0;let i;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!i.ordered;try{i.binaryType="blob",t.binaryBlob=!f2.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return t})(),this.validateId=Iyt,this.randomToken=YSe}}const ym=new Nyt,Pyt="PeerJS: ";class Dyt{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const r=[Pyt,...t];for(const i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var Pr=new Dyt,QG={},Lyt=Object.prototype.hasOwnProperty,Hp="~";function fk(){}Object.create&&(fk.prototype=Object.create(null),new fk().__proto__||(Hp=!1));function Uyt(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function XSe(n,e,t,r,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new Uyt(t,r||n,i),a=Hp?Hp+e:e;return n._events[a]?n._events[a].fn?n._events[a]=[n._events[a],s]:n._events[a].push(s):(n._events[a]=s,n._eventsCount++),n}function KP(n,e){--n._eventsCount===0?n._events=new fk:delete n._events[e]}function rp(){this._events=new fk,this._eventsCount=0}rp.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)Lyt.call(t,r)&&e.push(Hp?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};rp.prototype.listeners=function(e){var t=Hp?Hp+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,a=new Array(s);i<s;i++)a[i]=r[i].fn;return a};rp.prototype.listenerCount=function(e){var t=Hp?Hp+e:e,r=this._events[t];return r?r.fn?1:r.length:0};rp.prototype.emit=function(e,t,r,i,s,a){var o=Hp?Hp+e:e;if(!this._events[o])return!1;var l=this._events[o],c=arguments.length,u,f;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,a),!0}for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];l.fn.apply(l.context,u)}else{var h=l.length,g;for(f=0;f<h;f++)switch(l[f].once&&this.removeListener(e,l[f].fn,void 0,!0),c){case 1:l[f].fn.call(l[f].context);break;case 2:l[f].fn.call(l[f].context,t);break;case 3:l[f].fn.call(l[f].context,t,r);break;case 4:l[f].fn.call(l[f].context,t,r,i);break;default:if(!u)for(g=1,u=new Array(c-1);g<c;g++)u[g-1]=arguments[g];l[f].fn.apply(l[f].context,u)}}return!0};rp.prototype.on=function(e,t,r){return XSe(this,e,t,r,!1)};rp.prototype.once=function(e,t,r){return XSe(this,e,t,r,!0)};rp.prototype.removeListener=function(e,t,r,i){var s=Hp?Hp+e:e;if(!this._events[s])return this;if(!t)return KP(this,s),this;var a=this._events[s];if(a.fn)a.fn===t&&(!i||a.once)&&(!r||a.context===r)&&KP(this,s);else{for(var o=0,l=[],c=a.length;o<c;o++)(a[o].fn!==t||i&&!a[o].once||r&&a[o].context!==r)&&l.push(a[o]);l.length?this._events[s]=l.length===1?l[0]:l:KP(this,s)}return this};rp.prototype.removeAllListeners=function(e){var t;return e?(t=Hp?Hp+e:e,this._events[t]&&KP(this,t)):(this._events=new fk,this._eventsCount=0),this};rp.prototype.off=rp.prototype.removeListener;rp.prototype.addListener=rp.prototype.on;rp.prefixed=Hp;rp.EventEmitter=rp;QG=rp;var wx={};Tx(wx,"ConnectionType",()=>A1);Tx(wx,"PeerErrorType",()=>gf);Tx(wx,"BaseConnectionErrorType",()=>Zz);Tx(wx,"DataConnectionErrorType",()=>e$);Tx(wx,"SerializationType",()=>B6);Tx(wx,"SocketEventType",()=>v1);Tx(wx,"ServerMessageType",()=>Kd);var A1=(function(n){return n.Data="data",n.Media="media",n})({}),gf=(function(n){return n.BrowserIncompatible="browser-incompatible",n.Disconnected="disconnected",n.InvalidID="invalid-id",n.InvalidKey="invalid-key",n.Network="network",n.PeerUnavailable="peer-unavailable",n.SslUnavailable="ssl-unavailable",n.ServerError="server-error",n.SocketError="socket-error",n.SocketClosed="socket-closed",n.UnavailableID="unavailable-id",n.WebRTC="webrtc",n})({}),Zz=(function(n){return n.NegotiationFailed="negotiation-failed",n.ConnectionClosed="connection-closed",n})({}),e$=(function(n){return n.NotOpenYet="not-open-yet",n.MessageToBig="message-too-big",n})({}),B6=(function(n){return n.Binary="binary",n.BinaryUTF8="binary-utf8",n.JSON="json",n.None="raw",n})({}),v1=(function(n){return n.Message="message",n.Disconnected="disconnected",n.Error="error",n.Close="close",n})({}),Kd=(function(n){return n.Heartbeat="HEARTBEAT",n.Candidate="CANDIDATE",n.Offer="OFFER",n.Answer="ANSWER",n.Open="OPEN",n.Error="ERROR",n.IdTaken="ID-TAKEN",n.InvalidKey="INVALID-KEY",n.Leave="LEAVE",n.Expire="EXPIRE",n})({});const KSe="1.5.5";class Byt extends QG.EventEmitter{constructor(e,t,r,i,s,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const o=e?"wss://":"ws://";this._baseUrl=o+t+":"+r+i+"peerjs?key="+s}start(e,t){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+KSe),this._disconnected=!1,this._socket.onmessage=i=>{let s;try{s=JSON.parse(i.data),Pr.log("Server message received:",s)}catch{Pr.log("Invalid server message",i.data);return}this.emit(v1.Message,s)},this._socket.onclose=i=>{this._disconnected||(Pr.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(v1.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Pr.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Pr.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:Kd.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(v1.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class ZSe{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===A1.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const r=this.connection,i={ordered:!!e.reliable},s=t.createDataChannel(r.label,i);r._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Pr.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,s=this.connection.provider;Pr.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(Pr.log(`Received ICE candidates for ${t}:`,a.candidate),s.socket.send({type:Kd.Candidate,payload:{candidate:a.candidate,type:i,connectionId:r},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Pr.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(Zz.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":Pr.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(Zz.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":Pr.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Pr.log("Listening for data channel"),e.ondatachannel=a=>{Pr.log("Received data channel");const o=a.channel;s.getConnection(t,r)._initializeDataChannel(o)},Pr.log("Listening for remote stream"),e.ontrack=a=>{Pr.log("Received remote stream");const o=a.streams[0],l=s.getConnection(t,r);if(l.type===A1.Media){const c=l;this._addStreamToMediaConnection(o,c)}}}cleanup(){Pr.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let r=!1;const i=this.connection.dataChannel;i&&(r=!!i.readyState&&i.readyState!=="closed"),(t||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);Pr.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Pr.log("Set localDescription:",r,`for:${this.connection.peer}`);let i={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===A1.Data){const s=this.connection;i={...i,label:s.label,reliable:s.reliable,serialization:s.serialization}}t.socket.send({type:Kd.Offer,payload:i,dst:this.connection.peer})}catch(i){i!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(gf.WebRTC,i),Pr.log("Failed to setLocalDescription, ",i))}}catch(r){t.emitError(gf.WebRTC,r),Pr.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createAnswer();Pr.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Pr.log("Set localDescription:",r,`for:${this.connection.peer}`),t.socket.send({type:Kd.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(i){t.emitError(gf.WebRTC,i),Pr.log("Failed to setLocalDescription, ",i)}}catch(r){t.emitError(gf.WebRTC,r),Pr.log("Failed to create answer, ",r)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const r=this.connection.peerConnection,i=this.connection.provider;Pr.log("Setting remote description",t);const s=this;try{await r.setRemoteDescription(t),Pr.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(a){i.emitError(gf.WebRTC,a),Pr.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){Pr.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Pr.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(gf.WebRTC,t),Pr.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(Pr.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return Pr.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{t.addTrack(r,e)})}_addStreamToMediaConnection(e,t){Pr.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class JSe extends QG.EventEmitter{emitError(e,t){Pr.error("Error:",t),this.emit("error",new Fyt(`${e}`,t))}}class Fyt extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class QSe extends JSe{get open(){return this._open}constructor(e,t,r){super(),this.peer=e,this.provider=t,this.options=r,this._open=!1,this.metadata=r.metadata}}class y4 extends QSe{static#e=this.ID_PREFIX="mc_";get type(){return A1.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,r){super(e,t,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||y4.ID_PREFIX+ym.randomToken(),this._negotiator=new ZSe(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Pr.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Pr.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Pr.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,r=e.payload;switch(e.type){case Kd.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case Kd.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:Pr.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){Pr.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const i of r)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class zyt{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:r,port:i,path:s,key:a}=this._options,o=new URL(`${t}://${r}:${i}${s}${a}/${e}`);return o.searchParams.set("ts",`${Date.now()}${Math.random()}`),o.searchParams.set("version",KSe),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Pr.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==ym.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===ym.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Pr.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class b4 extends QSe{static#e=this.ID_PREFIX="dc_";static#t=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return A1.Data}constructor(e,t,r){super(e,t,r),this.connectionId=this.options.connectionId||b4.ID_PREFIX+YSe(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new ZSe(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Pr.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{Pr.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{Pr.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(e$.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case Kd.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case Kd.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:Pr.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class t$ extends b4{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>b4.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return Pr.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class y7 extends t${close(e){super.close(e),this._chunkedData={}}constructor(e,t,r){super(e,t,r),this.chunker=new WSe,this.serialization=B6.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=dSe(e),r=t.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];const i=kyt(r.data);this._handleDataMessage({data:i})}}_send(e,t){const r=pSe(e);if(r instanceof Promise)return this._send_blob(r);if(!t&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);Pr.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const r of t)this.send(r,!0)}}class jyt extends t${_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=B6.None}}class Hyt extends t${_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),r=t.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=ym.chunkedMTU){this.emitError(e$.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=B6.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class n$ extends JSe{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,r]of this._connections)e[t]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:jyt,json:Hyt,binary:y7,"binary-utf8":y7,default:y7},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?t=e:e&&(r=e.toString()),t={debug:0,host:ym.CLOUD_HOST,port:ym.CLOUD_PORT,path:"/",key:n$.DEFAULT_KEY,token:ym.randomToken(),config:ym.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==ym.CLOUD_HOST?this._options.secure=ym.isSecure():this._options.host==ym.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Pr.setLogFunction(this._options.logFunction),Pr.logLevel=this._options.debug||0,this._api=new zyt(t),this._socket=this._createServerConnection(),!ym.supports.audioVideo&&!ym.supports.data){this._delayedAbort(gf.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!ym.validateId(r)){this._delayedAbort(gf.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(gf.ServerError,i))}_createServerConnection(){const e=new Byt(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(v1.Message,t=>{this._handleMessage(t)}),e.on(v1.Error,t=>{this._abort(gf.SocketError,t)}),e.on(v1.Disconnected,()=>{this.disconnected||(this.emitError(gf.Network,"Lost connection to server."),this.disconnect())}),e.on(v1.Close,()=>{this.disconnected||this._abort(gf.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,r=e.payload,i=e.src;switch(t){case Kd.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Kd.Error:this._abort(gf.ServerError,r.msg);break;case Kd.IdTaken:this._abort(gf.UnavailableID,`ID "${this.id}" is taken`);break;case Kd.InvalidKey:this._abort(gf.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Kd.Leave:Pr.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case Kd.Expire:this.emitError(gf.PeerUnavailable,`Could not connect to peer ${i}`);break;case Kd.Offer:{const s=r.connectionId;let a=this.getConnection(i,s);if(a&&(a.close(),Pr.warn(`Offer received for existing Connection ID:${s}`)),r.type===A1.Media){const l=new y4(i,this,{connectionId:s,_payload:r,metadata:r.metadata});a=l,this._addConnection(i,a),this.emit("call",l)}else if(r.type===A1.Data){const l=new this._serializers[r.serialization](i,this,{connectionId:s,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});a=l,this._addConnection(i,a),this.emit("connection",l)}else{Pr.warn(`Received malformed connection type:${r.type}`);return}const o=this._getMessages(s);for(const l of o)a.handleMessage(l);break}default:{if(!r){Pr.warn(`You received a malformed message from ${i} of type ${t}`);return}const s=r.connectionId,a=this.getConnection(i,s);a&&a.peerConnection?a.handleMessage(e):s?this._storeMessage(s,e):Pr.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){Pr.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(gf.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,r),r}call(e,t,r={}){if(this.disconnected){Pr.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(gf.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){Pr.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const i=new y4(e,this,{...r,_stream:t});return this._addConnection(e,i),i}_addConnection(e,t){Pr.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const r=t.indexOf(e);r!==-1&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const r=this._connections.get(e);if(!r)return null;for(const i of r)if(i.connectionId===t)return i;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){Pr.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Pr.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const r of t)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;Pr.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Pr.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Pr.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(gf.ServerError,t))}}var qyt=n$;let Ig="",Ps,hk,kv,Sd;const Mae={},r$=new Map,S4=new Map;function eEe(n){return xe(Sd)?Sd.listClosestToId(Pg(n),1).filter(e=>e.peer!==Ps?.id):[]}function i$(n){return FIe(n)}let E4;function Vyt(){if(xe(E4)||Ps?.id===Ig)return;oEe=128;function n(){const e=as();nIe(St,e),Ts(St,e,"uplinking....")}n(),E4=setInterval(n,5*1e3)}function tEe(){clearInterval(E4),E4=void 0}function nEe(n,e){if(!xe(Ps)||!xe(Sd))return;const t=eEe(n);for(let r=0;r<t.length;++r){const i=t[r];i.peer!==Ps.id&&i.dataconnection?.open&&i.dataconnection?.send(e)?.catch(a=>console.error(a))}}function rEe(n){if(!xe(Ps)||!xe(Sd))return;const e=Date.now(),t=S4.get(Ig)??new Map;for(const[r,i]of t)e-i>1e3*60?t.delete(r):nEe(r,n)}function Oae(n){hk?.forward({...n,session:St.session()}),n.target.includes("acklogin")&&tEe()}const Gyt=5e3;function iEe(n){const e=as();Mae[n.peer]=setTimeout(()=>{kv?.remove(Pg(n.peer)),r$.set(n.peer,!0),Ts(St,e,`failed to connect to ${n.peer}`)},Gyt);function t(){if(n.open&&xe(Sd)&&xe(Ps)){Ts(St,e,`connection ${n.peer} open`),Sd.add({peer:n.peer,id:Pg(n.peer),dataconnection:n});const i={id:Sc(),topic:Ig,ping:Ps.id};n.send(i)?.catch(a=>console.error(a)),Vyt()}}n.on("open",t),n.on("close",()=>{xe(Ps)&&xe(Sd)&&(Ts(St,e,`disconnection from ${n.peer}`),Sd.remove(Pg(n.peer)))});const r=new Set;n.on("data",i=>{const s=i;if(r.has(s.id)||!xe(Ps)||!xe(kv)||!xe(Sd))return;r.add(s.id);const a=Date.now(),o=S4.get(Ig)??new Map;if("ping"in s){if(s.topic===Ig&&s.ping!==Ps.id){const l={id:Sc(),topic:Ig,pong:Ps.id};n.send(l)?.catch(u=>console.error(u))}}else if("pong"in s)clearTimeout(Mae[s.pong]),Ts(St,e,`connected to ${n.peer}`);else if("pub"in s)s.topic===Ig&&Oae(s.gme),rEe(s);else if("sub"in s){o.set(s.sub,a);const l=Pg(s.sub);kv.has(l)||kv.add({peer:s.sub,id:l,dataconnection:void 0}),s.topic===Ps.id?xe(s.gme)&&Oae(s.gme):nEe(s.topic,s)}S4.set(s.topic,o)}),n.on("error",i=>{xi(St,e,"netterminal",`dataconnection ${n.peer} - ${JSON.stringify(i)}`)}),t()}function sEe(n){Ig=n;const e=as(),t=i$(e);Ps=new qyt(t,{debug:2}),window.addEventListener("unload",()=>{Ps?.disconnect(),Ps=void 0}),Ts(St,e,`netterminal for ${t}`),Ts(St,e,`session topic ${Ig}`),kv=new yae(Pg(Ps.id),{getId(r){return r.id}}),Sd=new yae(Pg(Ps.id),{getId(r){return r.id}}),Ps.on("open",()=>{Ts(St,as(),"connected to netterminal"),lEe()}),Ps.on("connection",iEe),Ps.on("call",()=>{}),Ps.on("disconnected",()=>{xi(St,as(),"netterminal","lost connection to netterminal"),Wyt()}),Ps.on("error",r=>{switch(r.type){case"peer-unavailable":return}xi(St,as(),"netterminal",`${Ps?.id} - ${JSON.stringify(r)}`)})}function kae(){const n=as();if(xe(Ps)){Ts(St,n,"netterminal already active");return}sEe(i$(n)),hk=mG(e=>{if(xe(Ps)&&xe(Sd)&&Ppt(e)&&Npt(e)===!1){const t={id:Sc(),topic:Ig,pub:Ps.id,gme:e};rEe(t)}})}function $yt(n){if(xe(Ps)){Ts(St,as(),"netterminal already active");return}sEe(n),hk=mG(e=>{if(xe(Ps)&&xe(Sd)&&jye(e)&&Dpt(e)===!1){const t=eEe(Ig);for(let r=0;r<t.length;++r){const i=t[r];if(i.dataconnection?.open){const s={id:Sc(),topic:Ig,sub:Ps.id,gme:e};i.dataconnection.send(s,!0)?.catch(o=>console.error(o))}}}})}let aEe,oEe=16;function lEe(){ic(St,as(),async()=>{if(!xe(Ps)||!xe(kv)||!xe(Sd))return;const n=as(),e=new FormData;e.append("peer",`pid_${Ps.id}`);const t=new Request("https://terminal.zed.cafe",{method:"POST",body:e}),i=await(await fetch(t)).json();if(ui(i))for(let u=0;u<i.length;++u){const f=i[u].replace("pid_",""),h=Pg(f);Ps.id!=f&&kv.has(h)===!1&&r$.has(f)===!1&&(Ts(St,n,`adding ${f}`),kv.add({peer:f,id:h,dataconnection:void 0}))}const s=Pg(Ps.id),a=7,o=kv.listClosestToId(s,a).filter(u=>u.peer!==Ps?.id),l=new Set;for(let u=0;u<o.length;++u){const f=o[u];l.add(f.peer),Sd.has(f.id)||iEe(Ps.connect(f.peer,{reliable:!0}))}const c=Sd.listClosestToId(s,a*2).filter(u=>u.peer!==Ps?.id);for(let u=0;u<c.length;++u){const f=c[u];l.has(f.peer)===!1&&(f.dataconnection?.close(),Sd.remove(f.id))}}),aEe=setTimeout(lEe,oEe*1e3)}function Wyt(){xe(Ps)&&(Ig="",S4.clear(),r$.clear(),clearTimeout(aEe),Ps.destroy(),Ps=void 0,kv=void 0,Sd=void 0,hk?.disconnect(),hk=void 0,tEe())}let lv,Yd;async function Yyt(n,e,t,r,i,s){let a;switch(Vr(i)){case"get":{a=await fetch(r);break}case"post:json":{const c=[];for(let u=0;u<s.length;u+=2)c.push([s[u],s[u+1]]);a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f3e(c))});break}}if(!a?.ok)return;const o=`fetch:${t}`,[l]=(a.headers.get("content-type")??"").split(";");switch(l){case"text/plain":{const c=await a.text();Ts(St,n,JSON.stringify(c)),U0(St,n,e,"text",o,c);break}case"application/json":{const c=await a.json();Ts(St,n,JSON.stringify(c)),U0(St,n,e,"json",o,c);break}case"application/octet-stream":{const c=await a.arrayBuffer();U0(St,n,e,"binary",o,new Uint8Array(c));break}}}function Iae(n){const e=`${location.origin}/join/#${i$(n)}`;return xe(el())&&el().writeText(e).catch(t=>console.error(t)),e}function Xyt(n){const e=/(?:https?|ftp):\/\/[\n\S]+/g;return n.replace(e,"")}function Nae(n){let e=n.text;const t=[...n.emoteOffsets.values()];for(let r=0;r<t.length;++r){const i=t[r].reverse();for(let s=0;s<i.length;++s){const[a,o]=i[s].split("-").map(parseFloat);e=e.substring(0,a)+e.substring(o+1)}}return Xyt(e)}const bl=Y1("bridge",[],n=>{if(!bl.session(n))return;const e=as();switch(n.target){default:if(n.player!==e)return;break}switch(n.target){case"fetch":if(ui(n.data)){const[t,r,i,s,a]=n.data;ic(St,n.player,async()=>{await Yyt(n.player,t,r,i,s,a)})}break;case"start":kae(),R3e(St,n.player,!!n.data);break;case"tab":kae(),w3e(St,n.player);break;case"tabopen":ic(bl,n.player,async()=>{await Ch(1e3);const t=Iae(n.player);window.open(t,"_blank","noopener,noreferrer")});break;case"join":Vn(n.data)&&$yt(n.data);break;case"showjoincode":ic(bl,n.player,async()=>{const t=Iae(n.player),r=await N0e(t);n.data?_9(bl,n.player,r,"secret join url",!1):_9(bl,n.player,r,r)});break;case"chatstart":xe(lv)?xi(bl,n.player,"bridge","chat is already started"):Vn(n.data)&&(Ts(bl,n.player,`connecting to ${n.data}`),lv=new v4({channels:[n.data]}),lv.connect(),lv.onConnect(()=>{Ts(bl,n.player,"connected")}),lv.onDisconnect(()=>{Ts(bl,n.player,"disconnected")}),lv.onMessage((t,r,i,s)=>{const a=Nae(s);U0(bl,n.player,void 0,"text",`chat:message:${n.data}`,`${r}:${a}`)}),lv.onAction((t,r,i,s)=>{const a=Nae(s);U0(bl,n.player,void 0,"text",`chat:action:${n.data}`,`${r}:${a}`)}));break;case"chatstop":xe(lv)?(lv.quit(),lv=void 0,Ts(bl,n.player,"chat stopped")):xi(bl,n.player,"bridge","chat is already stoped");break;case"streamstart":ic(bl,n.player,async()=>{if(xe(Yd))xi(bl,n.player,"bridge","stream is already open");else{const t=window.innerHeight>window.innerWidth;Yd=US.create({streamConfig:t?US.STANDARD_PORTRAIT:US.STANDARD_LANDSCAPE,logLevel:US.LOG_LEVEL.DEBUG}),Yd.on(US.BroadcastClientEvents.ACTIVE_STATE_CHANGE,function(s){console.info({activestate:s})}),Yd.on(US.BroadcastClientEvents.CONNECTION_STATE_CHANGE,function(s){Ts(bl,n.player,s)}),Yd.on(US.BroadcastClientEvents.ERROR,function(s){xi(bl,n.player,"bridge",s),Yd=void 0});const r=document.querySelector("canvas");if(xe(r))await Yd.addImageSource(r,"video",{index:1});else{xi(bl,n.player,"video","unabled to find canvas element"),Yd=void 0;return}const i=Sht();if(xe(i))await Yd.addAudioInputDevice(i.stream,"audio");else{xi(bl,n.player,"video","unable create media audio node destination"),Yd=void 0;return}Ts(bl,n.player,"created client")}Vn(n.data)&&xe(Yd)&&(T_(bl,n.player,"broadcasting in"),Tm(bl,n.player,"3","..."),await Ch(1e3),Tm(bl,n.player,"2","..."),await Ch(1e3),Tm(bl,n.player,"1","..."),await Ch(1e3),T_(bl,n.player,"GOING LIVE"),await Yd.startBroadcast(n.data,"https://g.webrtc.live-video.net:4443"))});break;case"streamstop":xe(Yd)?(Yd.stopBroadcast(),Yd.delete(),Yd=void 0,Ts(bl,n.player,"stream stopped")):xi(bl,n.player,"bridge","stream already stopped");break}});function Kyt(){const{viewport:n}=Nm(),{width:e,height:t}=n.getCurrentViewport();it.useEffect(()=>(Bpt(P0e()),()=>{Fpt()}),[]);const[r]=it.useState(()=>new kht);it.useEffect(()=>{if(!Z8e)return;document.body.appendChild(r.dom),r.showPanel(0),r.dom.style.cssText="position:fixed;bottom:0;left:0;";const v=yke(()=>r.begin()),x=bke(()=>r.end());return()=>{document.body.removeChild(r.dom),v(),x()}},[r]);const i=Uht({benchmarksURL:"/benchmarks-min"}),[s,a]=it.useState(!1),[o,l]=it.useState(!1),[c,u]=it.useState(!1);it.useLayoutEffect(()=>{ic(St,as(),async()=>{await OP("lowrez")==="on"&&a(!0),await OP("crt")==="on"&&!nmt&&l(!0),await OP("scanlines")==="on"&&u(!0)})},[]);const f=Math.min(e,t),h=s||f<600;Gn.DRAW_CHAR_SCALE=h?1:2;const g=e>t,p=Iz==="touchOnly"||wpt==="touch",_=!h&&!p&&o===!0&&i&&i.tier>2&&!i.isMobile;it.useEffect(()=>{km.setState(v=>({...v,islowrez:h,islandscape:g,showtouchcontrols:p}))},[h,g,p]);const y=it.useRef(null);return Le.jsxs(Le.Fragment,{children:[Le.jsx(Aht,{ref:y,makeDefault:!0,near:1,far:2e3,position:[0,0,1e3]}),Le.jsx(sS,{children:Le.jsxs(Mmt,{children:[Le.jsx($gt,{}),Le.jsx(U0t,{}),Le.jsx(q0t,{}),Le.jsx(G0t,{})]})}),Le.jsx(j0t,{width:e,height:t,children:Le.jsx(Le.Fragment,{children:_&&Le.jsxs(Le.Fragment,{children:[c&&Le.jsx(z0t,{}),Le.jsx(ypt,{technique:_T.ESKIL,offset:.89,darkness:.911}),Le.jsx(Ipt,{viewheight:t})]})})})]})}document.addEventListener("keydown",()=>{E3()});window.addEventListener("click",()=>{E3()});window.addEventListener("dragover",n=>{n.preventDefault()});window.addEventListener("contextmenu",n=>{E3(),n.preventDefault()});window.addEventListener("paste",n=>{if(!n.clipboardData?.files.length)return;E3(),n.preventDefault(),[...n.clipboardData.files].forEach(t=>U0(St,as(),void 0,"file",`file:${t.name}`,t))});window.addEventListener("drop",n=>{E3(),n.preventDefault(),n.dataTransfer?.items?[...n.dataTransfer.items].forEach(t=>{if(t.kind==="file"){const r=t.getAsFile();xe(r)&&U0(St,as(),void 0,"file",r.name,r)}}):[...n.dataTransfer?.files??[]].forEach(t=>U0(St,as(),void 0,"file",t.name,t))});document.addEventListener("DOMContentLoaded",()=>{let n,e=!1;document.body.style.cursor="none",document.body.addEventListener("mousemove",()=>{e||(document.body.style.cursor="",clearTimeout(n),n=setTimeout(()=>{document.body.style.cursor="none",e=!0,setTimeout(()=>{e=!1},200)},3e3))})});function Zyt(){return km(e=>e.active)&&Le.jsx(Kyt,{})}const Jyt=n=>({...hce(n),filter:e=>{const t=e.filter(a=>!!a.object.visible),r=t.findIndex(a=>a.object.userData.blocking),i=r===-1?t:t.slice(0,r+1);let s="default";return i.some(a=>a.object.userData.cursor?(s=a.object.userData.cursor,!0):!1),document.querySelectorAll("html, body").forEach(a=>{a.style.cursor=s}),i}});let b7;function Qyt(n,e){const t=document.getElementById("frame");if(!xe(t))return;const r=KY(n),i=KY(e);t.style.width=`${r}px`,t.style.height=`${i}px`,xe(b7)||(b7=Uke.createRoot(t),b7.render(Le.jsx(Ake,{flat:!0,linear:!0,dpr:1,shadows:!1,events:Jyt,gl:{alpha:!0,stencil:!1,antialias:!1,preserveDrawingBuffer:!0},children:Le.jsx(Zyt,{})})))}const cEe=Oke(Qyt,256);window.addEventListener("resize",()=>cEe(window.innerWidth,window.innerHeight));cEe(window.innerWidth,window.innerHeight)});export default ebt();
